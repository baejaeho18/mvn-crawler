Compiled from "DigestAuthenticator.java"
public class org.mobicents.servlet.sip.catalina.security.authentication.DigestAuthenticator extends org.mobicents.servlet.sip.catalina.security.authentication.AuthenticatorBase implements org.mobicents.servlet.sip.core.security.SipDigestAuthenticator {
  private static final org.apache.log4j.Logger log;

  protected static final java.lang.String INFO;

  private javax.sip.header.HeaderFactory headerFactory;

  protected static volatile java.security.MessageDigest md5Helper;

  protected java.lang.String key;

  private org.mobicents.servlet.sip.core.security.SipPrincipal principal;

  public org.mobicents.servlet.sip.catalina.security.authentication.DigestAuthenticator(javax.sip.header.HeaderFactory);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/mobicents/servlet/sip/catalina/security/authentication/AuthenticatorBase."<init>":()V
       4: aload_0
       5: ldc           #2                  // String Catalina
       7: putfield      #3                  // Field key:Ljava/lang/String;
      10: aload_0
      11: aload_1
      12: putfield      #4                  // Field headerFactory:Ljavax/sip/header/HeaderFactory;
      15: return

  public java.lang.String getInfo();
    Code:
       0: ldc           #6                  // String org.apache.catalina.authenticator.DigestAuthenticator/1.0
       2: areturn

  public boolean authenticate(org.mobicents.servlet.sip.core.message.MobicentsSipServletRequest, org.mobicents.servlet.sip.core.message.MobicentsSipServletResponse, org.mobicents.servlet.sip.core.security.MobicentsSipLoginConfig) throws java.io.IOException;
    Code:
       0: aload_0
       1: aconst_null
       2: putfield      #7                  // Field principal:Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
       5: aload_0
       6: aload_1
       7: invokeinterface #8,  1            // InterfaceMethod org/mobicents/servlet/sip/core/message/MobicentsSipServletRequest.getUserPrincipal:()Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
      12: putfield      #7                  // Field principal:Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
      15: aload_0
      16: getfield      #7                  // Field principal:Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
      19: ifnull        71
      22: getstatic     #9                  // Field log:Lorg/apache/log4j/Logger;
      25: invokevirtual #10                 // Method org/apache/log4j/Logger.isDebugEnabled:()Z
      28: ifeq          69
      31: getstatic     #9                  // Field log:Lorg/apache/log4j/Logger;
      34: new           #11                 // class java/lang/StringBuilder
      37: dup
      38: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      41: ldc           #13                 // String Already authenticated \'
      43: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      46: aload_0
      47: getfield      #7                  // Field principal:Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
      50: invokeinterface #15,  1           // InterfaceMethod org/mobicents/servlet/sip/core/security/SipPrincipal.getName:()Ljava/lang/String;
      55: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      58: ldc           #16                 // String \'
      60: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      63: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      66: invokevirtual #18                 // Method org/apache/log4j/Logger.debug:(Ljava/lang/Object;)V
      69: iconst_1
      70: ireturn
      71: aload_1
      72: ldc           #19                 // String authorization
      74: invokeinterface #20,  2           // InterfaceMethod org/mobicents/servlet/sip/core/message/MobicentsSipServletRequest.getHeader:(Ljava/lang/String;)Ljava/lang/String;
      79: astore        4
      81: aload         4
      83: ifnull        149
      86: aload_0
      87: aload_1
      88: aload         4
      90: aload_0
      91: getfield      #21                 // Field context:Lorg/apache/catalina/Context;
      94: invokeinterface #22,  1           // InterfaceMethod org/apache/catalina/Context.getRealm:()Lorg/apache/catalina/Realm;
      99: invokestatic  #23                 // Method findPrincipal:(Lorg/mobicents/servlet/sip/core/message/MobicentsSipServletRequest;Ljava/lang/String;Lorg/apache/catalina/Realm;)Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
     102: putfield      #7                  // Field principal:Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
     105: aload_0
     106: getfield      #7                  // Field principal:Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
     109: ifnull        149
     112: aload_0
     113: getfield      #7                  // Field principal:Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
     116: invokeinterface #24,  1           // InterfaceMethod org/mobicents/servlet/sip/core/security/SipPrincipal.getPrincipal:()Ljava/security/Principal;
     121: ifnull        149
     124: aload_0
     125: aload         4
     127: invokevirtual #25                 // Method parseUsername:(Ljava/lang/String;)Ljava/lang/String;
     130: astore        5
     132: aload_0
     133: aload_1
     134: aload_2
     135: aload_0
     136: getfield      #7                  // Field principal:Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
     139: ldc           #27                 // String DIGEST
     141: aload         5
     143: aconst_null
     144: invokevirtual #28                 // Method register:(Lorg/mobicents/servlet/sip/core/message/MobicentsSipServletRequest;Lorg/mobicents/servlet/sip/core/message/MobicentsSipServletResponse;Lorg/mobicents/servlet/sip/core/security/SipPrincipal;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     147: iconst_1
     148: ireturn
     149: aload_0
     150: aload_1
     151: invokevirtual #29                 // Method generateNOnce:(Lorg/mobicents/servlet/sip/core/message/MobicentsSipServletRequest;)Ljava/lang/String;
     154: astore        5
     156: aload_0
     157: aload_1
     158: aload_2
     159: aload_3
     160: aload         5
     162: invokevirtual #30                 // Method setAuthenticateHeader:(Lorg/mobicents/servlet/sip/core/message/MobicentsSipServletRequest;Lorg/mobicents/servlet/sip/core/message/MobicentsSipServletResponse;Lorg/mobicents/servlet/sip/core/security/MobicentsSipLoginConfig;Ljava/lang/String;)V
     165: aload_2
     166: invokeinterface #31,  1           // InterfaceMethod org/mobicents/servlet/sip/core/message/MobicentsSipServletResponse.send:()V
     171: iconst_0
     172: ireturn

  protected static org.mobicents.servlet.sip.core.security.SipPrincipal findPrincipal(org.mobicents.servlet.sip.core.message.MobicentsSipServletRequest, java.lang.String, org.apache.catalina.Realm);
    Code:
       0: aload_1
       1: ifnonnull     6
       4: aconst_null
       5: areturn
       6: aload_1
       7: ldc           #32                 // String Digest
       9: invokevirtual #33                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      12: ifne          17
      15: aconst_null
      16: areturn
      17: aload_1
      18: bipush        7
      20: invokevirtual #34                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      23: invokevirtual #35                 // Method java/lang/String.trim:()Ljava/lang/String;
      26: astore_3
      27: aload_3
      28: ldc           #36                 // String ,
      30: invokevirtual #37                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
      33: astore        4
      35: aconst_null
      36: astore        5
      38: aconst_null
      39: astore        6
      41: aconst_null
      42: astore        7
      44: aconst_null
      45: astore        8
      47: aconst_null
      48: astore        9
      50: aconst_null
      51: astore        10
      53: aconst_null
      54: astore        11
      56: aconst_null
      57: astore        12
      59: aload_0
      60: invokeinterface #38,  1           // InterfaceMethod org/mobicents/servlet/sip/core/message/MobicentsSipServletRequest.getMethod:()Ljava/lang/String;
      65: astore        13
      67: iconst_0
      68: istore        14
      70: iload         14
      72: aload         4
      74: arraylength
      75: if_icmpge     282
      78: aload         4
      80: iload         14
      82: aaload
      83: astore        15
      85: aload         15
      87: invokevirtual #39                 // Method java/lang/String.length:()I
      90: ifne          96
      93: goto          276
      96: aload         15
      98: bipush        61
     100: invokevirtual #40                 // Method java/lang/String.indexOf:(I)I
     103: istore        16
     105: iload         16
     107: ifge          112
     110: aconst_null
     111: areturn
     112: aload         15
     114: iconst_0
     115: iload         16
     117: invokevirtual #41                 // Method java/lang/String.substring:(II)Ljava/lang/String;
     120: invokevirtual #35                 // Method java/lang/String.trim:()Ljava/lang/String;
     123: astore        17
     125: aload         15
     127: iload         16
     129: iconst_1
     130: iadd
     131: invokevirtual #34                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     134: invokevirtual #35                 // Method java/lang/String.trim:()Ljava/lang/String;
     137: astore        18
     139: ldc           #42                 // String username
     141: aload         17
     143: invokevirtual #43                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     146: ifeq          156
     149: aload         18
     151: invokestatic  #44                 // Method removeQuotes:(Ljava/lang/String;)Ljava/lang/String;
     154: astore        5
     156: ldc           #45                 // String realm
     158: aload         17
     160: invokevirtual #43                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     163: ifeq          174
     166: aload         18
     168: iconst_1
     169: invokestatic  #46                 // Method removeQuotes:(Ljava/lang/String;Z)Ljava/lang/String;
     172: astore        6
     174: ldc           #47                 // String nonce
     176: aload         17
     178: invokevirtual #43                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     181: ifeq          191
     184: aload         18
     186: invokestatic  #44                 // Method removeQuotes:(Ljava/lang/String;)Ljava/lang/String;
     189: astore        7
     191: ldc           #48                 // String nc
     193: aload         17
     195: invokevirtual #43                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     198: ifeq          208
     201: aload         18
     203: invokestatic  #44                 // Method removeQuotes:(Ljava/lang/String;)Ljava/lang/String;
     206: astore        8
     208: ldc           #49                 // String cnonce
     210: aload         17
     212: invokevirtual #43                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     215: ifeq          225
     218: aload         18
     220: invokestatic  #44                 // Method removeQuotes:(Ljava/lang/String;)Ljava/lang/String;
     223: astore        9
     225: ldc           #50                 // String qop
     227: aload         17
     229: invokevirtual #43                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     232: ifeq          242
     235: aload         18
     237: invokestatic  #44                 // Method removeQuotes:(Ljava/lang/String;)Ljava/lang/String;
     240: astore        10
     242: ldc           #51                 // String uri
     244: aload         17
     246: invokevirtual #43                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     249: ifeq          259
     252: aload         18
     254: invokestatic  #44                 // Method removeQuotes:(Ljava/lang/String;)Ljava/lang/String;
     257: astore        11
     259: ldc           #52                 // String response
     261: aload         17
     263: invokevirtual #43                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     266: ifeq          276
     269: aload         18
     271: invokestatic  #44                 // Method removeQuotes:(Ljava/lang/String;)Ljava/lang/String;
     274: astore        12
     276: iinc          14, 1
     279: goto          70
     282: aload         5
     284: ifnull        307
     287: aload         6
     289: ifnull        307
     292: aload         7
     294: ifnull        307
     297: aload         11
     299: ifnull        307
     302: aload         12
     304: ifnonnull     309
     307: aconst_null
     308: areturn
     309: new           #11                 // class java/lang/StringBuilder
     312: dup
     313: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
     316: aload         13
     318: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     321: ldc           #53                 // String :
     323: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     326: aload         11
     328: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     331: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     334: astore        14
     336: aconst_null
     337: astore        15
     339: getstatic     #54                 // Field md5Helper:Ljava/security/MessageDigest;
     342: dup
     343: astore        16
     345: monitorenter
     346: getstatic     #54                 // Field md5Helper:Ljava/security/MessageDigest;
     349: aload         14
     351: invokevirtual #55                 // Method java/lang/String.getBytes:()[B
     354: invokevirtual #56                 // Method java/security/MessageDigest.digest:([B)[B
     357: astore        15
     359: aload         16
     361: monitorexit
     362: goto          373
     365: astore        19
     367: aload         16
     369: monitorexit
     370: aload         19
     372: athrow
     373: aload         15
     375: invokestatic  #57                 // Method org/apache/tomcat/util/security/MD5Encoder.encode:([B)Ljava/lang/String;
     378: astore        16
     380: new           #58                 // class org/mobicents/servlet/sip/catalina/security/CatalinaSipPrincipal
     383: dup
     384: aload_2
     385: aload         5
     387: aload         12
     389: aload         7
     391: aload         8
     393: aload         9
     395: aload         10
     397: aload         6
     399: aload         16
     401: invokeinterface #59,  9           // InterfaceMethod org/apache/catalina/Realm.authenticate:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/security/Principal;
     406: invokespecial #60                 // Method org/mobicents/servlet/sip/catalina/security/CatalinaSipPrincipal."<init>":(Ljava/security/Principal;)V
     409: areturn
    Exception table:
       from    to  target type
         346   362   365   any
         365   370   365   any

  protected java.lang.String parseUsername(java.lang.String);
    Code:
       0: aload_1
       1: ifnonnull     6
       4: aconst_null
       5: areturn
       6: aload_1
       7: ldc           #32                 // String Digest
       9: invokevirtual #33                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      12: ifne          17
      15: aconst_null
      16: areturn
      17: aload_1
      18: bipush        7
      20: invokevirtual #34                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      23: invokevirtual #35                 // Method java/lang/String.trim:()Ljava/lang/String;
      26: astore_2
      27: new           #61                 // class java/util/StringTokenizer
      30: dup
      31: aload_2
      32: ldc           #36                 // String ,
      34: invokespecial #62                 // Method java/util/StringTokenizer."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      37: astore_3
      38: aload_3
      39: invokevirtual #63                 // Method java/util/StringTokenizer.hasMoreTokens:()Z
      42: ifeq          113
      45: aload_3
      46: invokevirtual #64                 // Method java/util/StringTokenizer.nextToken:()Ljava/lang/String;
      49: astore        4
      51: aload         4
      53: bipush        61
      55: invokevirtual #40                 // Method java/lang/String.indexOf:(I)I
      58: istore        5
      60: iload         5
      62: ifge          67
      65: aconst_null
      66: areturn
      67: aload         4
      69: iconst_0
      70: iload         5
      72: invokevirtual #41                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      75: invokevirtual #35                 // Method java/lang/String.trim:()Ljava/lang/String;
      78: astore        6
      80: aload         4
      82: iload         5
      84: iconst_1
      85: iadd
      86: invokevirtual #34                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      89: invokevirtual #35                 // Method java/lang/String.trim:()Ljava/lang/String;
      92: astore        7
      94: ldc           #42                 // String username
      96: aload         6
      98: invokevirtual #43                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     101: ifeq          110
     104: aload         7
     106: invokestatic  #44                 // Method removeQuotes:(Ljava/lang/String;)Ljava/lang/String;
     109: areturn
     110: goto          38
     113: aconst_null
     114: areturn

  protected static java.lang.String removeQuotes(java.lang.String, boolean);
    Code:
       0: aload_0
       1: invokevirtual #39                 // Method java/lang/String.length:()I
       4: ifle          23
       7: aload_0
       8: iconst_0
       9: invokevirtual #65                 // Method java/lang/String.charAt:(I)C
      12: bipush        34
      14: if_icmpeq     23
      17: iload_1
      18: ifne          23
      21: aload_0
      22: areturn
      23: aload_0
      24: invokevirtual #39                 // Method java/lang/String.length:()I
      27: iconst_2
      28: if_icmple     43
      31: aload_0
      32: iconst_1
      33: aload_0
      34: invokevirtual #39                 // Method java/lang/String.length:()I
      37: iconst_1
      38: isub
      39: invokevirtual #41                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      42: areturn
      43: ldc           #66                 // String
      45: areturn

  protected static java.lang.String removeQuotes(java.lang.String);
    Code:
       0: aload_0
       1: iconst_0
       2: invokestatic  #46                 // Method removeQuotes:(Ljava/lang/String;Z)Ljava/lang/String;
       5: areturn

  protected java.lang.String generateNOnce(org.mobicents.servlet.sip.core.message.MobicentsSipServletRequest);
    Code:
       0: invokestatic  #67                 // Method java/lang/System.currentTimeMillis:()J
       3: lstore_2
       4: new           #11                 // class java/lang/StringBuilder
       7: dup
       8: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      11: aload_1
      12: invokeinterface #68,  1           // InterfaceMethod org/mobicents/servlet/sip/core/message/MobicentsSipServletRequest.getRemoteAddr:()Ljava/lang/String;
      17: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      20: ldc           #53                 // String :
      22: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      25: lload_2
      26: invokevirtual #69                 // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
      29: ldc           #53                 // String :
      31: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      34: aload_0
      35: getfield      #3                  // Field key:Ljava/lang/String;
      38: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      41: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      44: astore        4
      46: aconst_null
      47: astore        5
      49: getstatic     #54                 // Field md5Helper:Ljava/security/MessageDigest;
      52: dup
      53: astore        6
      55: monitorenter
      56: getstatic     #54                 // Field md5Helper:Ljava/security/MessageDigest;
      59: aload         4
      61: invokevirtual #55                 // Method java/lang/String.getBytes:()[B
      64: invokevirtual #56                 // Method java/security/MessageDigest.digest:([B)[B
      67: astore        5
      69: aload         6
      71: monitorexit
      72: goto          83
      75: astore        7
      77: aload         6
      79: monitorexit
      80: aload         7
      82: athrow
      83: aload         5
      85: invokestatic  #57                 // Method org/apache/tomcat/util/security/MD5Encoder.encode:([B)Ljava/lang/String;
      88: astore        4
      90: aload         4
      92: areturn
    Exception table:
       from    to  target type
          56    72    75   any
          75    80    75   any

  protected void setAuthenticateHeader(org.mobicents.servlet.sip.core.message.MobicentsSipServletRequest, org.mobicents.servlet.sip.core.message.MobicentsSipServletResponse, org.mobicents.servlet.sip.core.security.MobicentsSipLoginConfig, java.lang.String);
    Code:
       0: aload_3
       1: checkcast     #70                 // class org/mobicents/servlet/sip/catalina/SipLoginConfig
       4: invokevirtual #71                 // Method org/mobicents/servlet/sip/catalina/SipLoginConfig.getRealmName:()Ljava/lang/String;
       7: astore        5
       9: aload         5
      11: ifnonnull     49
      14: new           #11                 // class java/lang/StringBuilder
      17: dup
      18: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      21: aload_1
      22: invokeinterface #72,  1           // InterfaceMethod org/mobicents/servlet/sip/core/message/MobicentsSipServletRequest.getServerName:()Ljava/lang/String;
      27: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      30: ldc           #53                 // String :
      32: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      35: aload_1
      36: invokeinterface #73,  1           // InterfaceMethod org/mobicents/servlet/sip/core/message/MobicentsSipServletRequest.getServerPort:()I
      41: invokevirtual #74                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      44: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      47: astore        5
      49: aconst_null
      50: astore        6
      52: getstatic     #54                 // Field md5Helper:Ljava/security/MessageDigest;
      55: dup
      56: astore        7
      58: monitorenter
      59: getstatic     #54                 // Field md5Helper:Ljava/security/MessageDigest;
      62: aload         4
      64: invokevirtual #55                 // Method java/lang/String.getBytes:()[B
      67: invokevirtual #56                 // Method java/security/MessageDigest.digest:([B)[B
      70: astore        6
      72: aload         7
      74: monitorexit
      75: goto          86
      78: astore        8
      80: aload         7
      82: monitorexit
      83: aload         8
      85: athrow
      86: new           #11                 // class java/lang/StringBuilder
      89: dup
      90: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      93: ldc           #75                 // String Digest realm=\"
      95: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      98: aload         5
     100: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     103: ldc           #76                 // String \",
     105: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     108: ldc           #77                 // String qop=\"auth\", nonce=\"
     110: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     113: aload         4
     115: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     118: ldc           #76                 // String \",
     120: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     123: ldc           #78                 // String opaque=\"
     125: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     128: aload         6
     130: invokestatic  #57                 // Method org/apache/tomcat/util/security/MD5Encoder.encode:([B)Ljava/lang/String;
     133: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     136: ldc           #79                 // String \"
     138: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     141: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     144: astore        7
     146: aload_2
     147: invokeinterface #80,  1           // InterfaceMethod org/mobicents/servlet/sip/core/message/MobicentsSipServletResponse.getStatus:()I
     152: sipush        407
     155: if_icmpne     171
     158: aload_2
     159: ldc           #82                 // String Proxy-Authenticate
     161: aload         7
     163: invokeinterface #83,  3           // InterfaceMethod org/mobicents/servlet/sip/core/message/MobicentsSipServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
     168: goto          181
     171: aload_2
     172: ldc           #84                 // String WWW-Authenticate
     174: aload         7
     176: invokeinterface #83,  3           // InterfaceMethod org/mobicents/servlet/sip/core/message/MobicentsSipServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
     181: return
    Exception table:
       from    to  target type
          59    75    78   any
          78    83    78   any

  public javax.sip.header.AuthorizationHeader getAuthorizationHeader(java.lang.String, java.lang.String, java.lang.String, javax.sip.header.Header, java.lang.String, java.lang.String, java.lang.String, int);
    Code:
       0: aconst_null
       1: astore        9
       3: iconst_1
       4: istore        10
       6: aconst_null
       7: astore        11
       9: aload         4
      11: instanceof    #85                 // class javax/sip/header/WWWAuthenticateHeader
      14: ifeq          24
      17: aload         4
      19: checkcast     #85                 // class javax/sip/header/WWWAuthenticateHeader
      22: astore        11
      24: aconst_null
      25: astore        12
      27: aload         4
      29: instanceof    #86                 // class javax/sip/header/AuthorizationHeader
      32: ifeq          45
      35: aload         4
      37: checkcast     #86                 // class javax/sip/header/AuthorizationHeader
      40: astore        12
      42: iconst_0
      43: istore        10
      45: aconst_null
      46: astore        13
      48: iload         10
      50: ifeq          65
      53: aload         11
      55: invokeinterface #87,  1           // InterfaceMethod javax/sip/header/WWWAuthenticateHeader.getQop:()Ljava/lang/String;
      60: astore        13
      62: goto          74
      65: aload         12
      67: invokeinterface #88,  1           // InterfaceMethod javax/sip/header/AuthorizationHeader.getQop:()Ljava/lang/String;
      72: astore        13
      74: aconst_null
      75: astore        14
      77: iload         10
      79: ifeq          94
      82: aload         11
      84: invokeinterface #89,  1           // InterfaceMethod javax/sip/header/WWWAuthenticateHeader.getAlgorithm:()Ljava/lang/String;
      89: astore        14
      91: goto          103
      94: aload         12
      96: invokeinterface #90,  1           // InterfaceMethod javax/sip/header/AuthorizationHeader.getAlgorithm:()Ljava/lang/String;
     101: astore        14
     103: aconst_null
     104: astore        15
     106: iload         10
     108: ifeq          123
     111: aload         11
     113: invokeinterface #91,  1           // InterfaceMethod javax/sip/header/WWWAuthenticateHeader.getRealm:()Ljava/lang/String;
     118: astore        15
     120: goto          132
     123: aload         12
     125: invokeinterface #92,  1           // InterfaceMethod javax/sip/header/AuthorizationHeader.getRealm:()Ljava/lang/String;
     130: astore        15
     132: aconst_null
     133: astore        16
     135: iload         10
     137: ifeq          152
     140: aload         11
     142: invokeinterface #93,  1           // InterfaceMethod javax/sip/header/WWWAuthenticateHeader.getScheme:()Ljava/lang/String;
     147: astore        16
     149: goto          161
     152: aload         12
     154: invokeinterface #94,  1           // InterfaceMethod javax/sip/header/AuthorizationHeader.getScheme:()Ljava/lang/String;
     159: astore        16
     161: aconst_null
     162: astore        17
     164: iload         10
     166: ifeq          181
     169: aload         11
     171: invokeinterface #95,  1           // InterfaceMethod javax/sip/header/WWWAuthenticateHeader.getOpaque:()Ljava/lang/String;
     176: astore        17
     178: goto          190
     181: aload         12
     183: invokeinterface #96,  1           // InterfaceMethod javax/sip/header/AuthorizationHeader.getOpaque:()Ljava/lang/String;
     188: astore        17
     190: aload         13
     192: ifnull        200
     195: ldc           #97                 // String auth
     197: goto          201
     200: aconst_null
     201: astore        18
     203: ldc           #98                 // String %08x
     205: iconst_1
     206: anewarray     #99                 // class java/lang/Object
     209: dup
     210: iconst_0
     211: iload         8
     213: invokestatic  #100                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     216: aastore
     217: invokestatic  #101                // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     220: astore        19
     222: invokestatic  #67                 // Method java/lang/System.currentTimeMillis:()J
     225: lstore        20
     227: new           #11                 // class java/lang/StringBuilder
     230: dup
     231: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
     234: lload         20
     236: invokevirtual #69                 // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
     239: ldc           #53                 // String :
     241: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     244: ldc           #102                // String mobicents
     246: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     249: aload         9
     251: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     254: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     257: astore        22
     259: aconst_null
     260: astore        23
     262: getstatic     #54                 // Field md5Helper:Ljava/security/MessageDigest;
     265: dup
     266: astore        24
     268: monitorenter
     269: getstatic     #54                 // Field md5Helper:Ljava/security/MessageDigest;
     272: aload         22
     274: invokevirtual #55                 // Method java/lang/String.getBytes:()[B
     277: invokevirtual #56                 // Method java/security/MessageDigest.digest:([B)[B
     280: astore        23
     282: aload         24
     284: monitorexit
     285: goto          296
     288: astore        25
     290: aload         24
     292: monitorexit
     293: aload         25
     295: athrow
     296: aload         23
     298: invokestatic  #57                 // Method org/apache/tomcat/util/security/MD5Encoder.encode:([B)Ljava/lang/String;
     301: astore        24
     303: aload         14
     305: aload         5
     307: aload         15
     309: aload         6
     311: aload         7
     313: aload         19
     315: aload         24
     317: aload_1
     318: aload_2
     319: aload_3
     320: aload         18
     322: invokestatic  #103                // Method org/mobicents/servlet/sip/catalina/security/authentication/MessageDigestResponseAlgorithm.calculateResponse:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     325: astore        9
     327: goto          344
     330: astore        25
     332: new           #105                // class java/lang/IllegalStateException
     335: dup
     336: ldc           #106                // String The authenticate header was malformatted
     338: aload         25
     340: invokespecial #107                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     343: athrow
     344: aconst_null
     345: astore        25
     347: aload         4
     349: instanceof    #108                // class javax/sip/header/ProxyAuthenticateHeader
     352: ifne          363
     355: aload         4
     357: instanceof    #109                // class javax/sip/header/ProxyAuthorizationHeader
     360: ifeq          379
     363: aload_0
     364: getfield      #4                  // Field headerFactory:Ljavax/sip/header/HeaderFactory;
     367: aload         16
     369: invokeinterface #110,  2          // InterfaceMethod javax/sip/header/HeaderFactory.createProxyAuthorizationHeader:(Ljava/lang/String;)Ljavax/sip/header/ProxyAuthorizationHeader;
     374: astore        25
     376: goto          392
     379: aload_0
     380: getfield      #4                  // Field headerFactory:Ljavax/sip/header/HeaderFactory;
     383: aload         16
     385: invokeinterface #111,  2          // InterfaceMethod javax/sip/header/HeaderFactory.createAuthorizationHeader:(Ljava/lang/String;)Ljavax/sip/header/AuthorizationHeader;
     390: astore        25
     392: aload         25
     394: aload         5
     396: invokeinterface #112,  2          // InterfaceMethod javax/sip/header/AuthorizationHeader.setUsername:(Ljava/lang/String;)V
     401: aload         25
     403: aload         15
     405: invokeinterface #113,  2          // InterfaceMethod javax/sip/header/AuthorizationHeader.setRealm:(Ljava/lang/String;)V
     410: aload         25
     412: aload         7
     414: invokeinterface #114,  2          // InterfaceMethod javax/sip/header/AuthorizationHeader.setNonce:(Ljava/lang/String;)V
     419: aload         25
     421: ldc           #51                 // String uri
     423: aload_2
     424: invokeinterface #115,  3          // InterfaceMethod javax/sip/header/AuthorizationHeader.setParameter:(Ljava/lang/String;Ljava/lang/String;)V
     429: aload         25
     431: aload         9
     433: invokeinterface #116,  2          // InterfaceMethod javax/sip/header/AuthorizationHeader.setResponse:(Ljava/lang/String;)V
     438: aload         14
     440: ifnull        452
     443: aload         25
     445: aload         14
     447: invokeinterface #117,  2          // InterfaceMethod javax/sip/header/AuthorizationHeader.setAlgorithm:(Ljava/lang/String;)V
     452: aload         17
     454: ifnull        474
     457: aload         17
     459: invokevirtual #39                 // Method java/lang/String.length:()I
     462: ifle          474
     465: aload         25
     467: aload         17
     469: invokeinterface #118,  2          // InterfaceMethod javax/sip/header/AuthorizationHeader.setOpaque:(Ljava/lang/String;)V
     474: aload         18
     476: ifnull        511
     479: aload         25
     481: aload         18
     483: invokeinterface #119,  2          // InterfaceMethod javax/sip/header/AuthorizationHeader.setQop:(Ljava/lang/String;)V
     488: aload         25
     490: aload         24
     492: invokeinterface #120,  2          // InterfaceMethod javax/sip/header/AuthorizationHeader.setCNonce:(Ljava/lang/String;)V
     497: aload         25
     499: aload         19
     501: bipush        16
     503: invokestatic  #121                // Method java/lang/Integer.parseInt:(Ljava/lang/String;I)I
     506: invokeinterface #122,  2          // InterfaceMethod javax/sip/header/AuthorizationHeader.setNonceCount:(I)V
     511: aload         25
     513: aload         9
     515: invokeinterface #116,  2          // InterfaceMethod javax/sip/header/AuthorizationHeader.setResponse:(Ljava/lang/String;)V
     520: goto          537
     523: astore        26
     525: new           #124                // class java/lang/SecurityException
     528: dup
     529: ldc           #125                // String Failed to create an authorization header!
     531: aload         26
     533: invokespecial #126                // Method java/lang/SecurityException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     536: athrow
     537: aload         25
     539: areturn
    Exception table:
       from    to  target type
         269   285   288   any
         288   293   288   any
         303   327   330   Class java/lang/NullPointerException
         347   520   523   Class java/text/ParseException

  public org.mobicents.servlet.sip.core.security.SipPrincipal getPrincipal();
    Code:
       0: aload_0
       1: getfield      #7                  // Field principal:Lorg/mobicents/servlet/sip/core/security/SipPrincipal;
       4: areturn

  public boolean authenticate(org.apache.catalina.connector.Request, javax.servlet.http.HttpServletResponse) throws java.io.IOException;
    Code:
       0: iconst_0
       1: ireturn

  public void login(java.lang.String, java.lang.String, org.apache.catalina.connector.Request) throws javax.servlet.ServletException;
    Code:
       0: return

  public void logout(org.apache.catalina.connector.Request);
    Code:
       0: return

  static {};
    Code:
       0: ldc           #5                  // class org/mobicents/servlet/sip/catalina/security/authentication/DigestAuthenticator
       2: invokestatic  #127                // Method org/apache/log4j/Logger.getLogger:(Ljava/lang/Class;)Lorg/apache/log4j/Logger;
       5: putstatic     #9                  // Field log:Lorg/apache/log4j/Logger;
       8: ldc           #128                // String MD5
      10: invokestatic  #129                // Method java/security/MessageDigest.getInstance:(Ljava/lang/String;)Ljava/security/MessageDigest;
      13: putstatic     #54                 // Field md5Helper:Ljava/security/MessageDigest;
      16: goto          29
      19: astore_0
      20: new           #105                // class java/lang/IllegalStateException
      23: dup
      24: aload_0
      25: invokespecial #131                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/Throwable;)V
      28: athrow
      29: return
    Exception table:
       from    to  target type
           8    16    19   Class java/security/NoSuchAlgorithmException
}
