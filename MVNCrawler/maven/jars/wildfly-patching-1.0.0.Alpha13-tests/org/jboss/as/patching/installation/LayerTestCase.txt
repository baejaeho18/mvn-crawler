Compiled from "LayerTestCase.java"
public class org.jboss.as.patching.installation.LayerTestCase extends org.jboss.as.patching.runner.AbstractTaskTestCase {
  public org.jboss.as.patching.installation.LayerTestCase();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jboss/as/patching/runner/AbstractTaskTestCase."<init>":()V
       4: return

  public void layerNotInLayersConf() throws java.lang.Exception;
    Code:
       0: invokestatic  #2                  // Method org/jboss/as/patching/runner/TestUtils.randomString:()Ljava/lang/String;
       3: astore_1
       4: aload_0
       5: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
       8: invokevirtual #4                  // Method org/jboss/as/patching/DirectoryStructure.getModuleRoot:()Ljava/io/File;
      11: aconst_null
      12: iconst_1
      13: anewarray     #5                  // class java/lang/String
      16: dup
      17: iconst_0
      18: aload_1
      19: aastore
      20: invokestatic  #6                  // Method installLayer:(Ljava/io/File;Ljava/io/File;[Ljava/lang/String;)V
      23: aload_0
      24: invokevirtual #7                  // Method loadInstalledIdentity:()Lorg/jboss/as/patching/installation/InstalledIdentity;
      27: astore_2
      28: aload_2
      29: invokevirtual #8                  // Method org/jboss/as/patching/installation/InstalledIdentity.getLayers:()Ljava/util/List;
      32: astore_3
      33: iconst_1
      34: aload_3
      35: invokeinterface #9,  1            // InterfaceMethod java/util/List.size:()I
      40: invokestatic  #10                 // Method junit/framework/Assert.assertEquals:(II)V
      43: ldc           #11                 // String base
      45: aload_3
      46: iconst_0
      47: invokeinterface #12,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      52: checkcast     #13                 // class org/jboss/as/patching/installation/Layer
      55: invokeinterface #14,  1           // InterfaceMethod org/jboss/as/patching/installation/Layer.getName:()Ljava/lang/String;
      60: invokestatic  #15                 // Method junit/framework/Assert.assertEquals:(Ljava/lang/String;Ljava/lang/String;)V
      63: return

  public void installedLayer() throws java.lang.Exception;
    Code:
       0: invokestatic  #2                  // Method org/jboss/as/patching/runner/TestUtils.randomString:()Ljava/lang/String;
       3: astore_1
       4: aload_0
       5: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
       8: invokevirtual #4                  // Method org/jboss/as/patching/DirectoryStructure.getModuleRoot:()Ljava/io/File;
      11: aload_0
      12: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
      15: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
      18: invokeinterface #17,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getLayersConf:()Ljava/io/File;
      23: iconst_1
      24: anewarray     #5                  // class java/lang/String
      27: dup
      28: iconst_0
      29: aload_1
      30: aastore
      31: invokestatic  #6                  // Method installLayer:(Ljava/io/File;Ljava/io/File;[Ljava/lang/String;)V
      34: aload_0
      35: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
      38: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
      41: invokeinterface #18,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getJbossHome:()Ljava/io/File;
      46: invokestatic  #19                 // Method org/jboss/as/patching/runner/TestUtils.tree:(Ljava/io/File;)V
      49: aload_0
      50: invokevirtual #7                  // Method loadInstalledIdentity:()Lorg/jboss/as/patching/installation/InstalledIdentity;
      53: astore_2
      54: aload_2
      55: invokevirtual #20                 // Method org/jboss/as/patching/installation/InstalledIdentity.getIdentity:()Lorg/jboss/as/patching/installation/Identity;
      58: astore_3
      59: aload_0
      60: getfield      #21                 // Field productConfig:Lorg/jboss/as/version/ProductConfig;
      63: invokevirtual #22                 // Method org/jboss/as/version/ProductConfig.getProductName:()Ljava/lang/String;
      66: aload_3
      67: invokeinterface #23,  1           // InterfaceMethod org/jboss/as/patching/installation/Identity.getName:()Ljava/lang/String;
      72: invokestatic  #15                 // Method junit/framework/Assert.assertEquals:(Ljava/lang/String;Ljava/lang/String;)V
      75: aload_0
      76: getfield      #21                 // Field productConfig:Lorg/jboss/as/version/ProductConfig;
      79: invokevirtual #24                 // Method org/jboss/as/version/ProductConfig.resolveVersion:()Ljava/lang/String;
      82: aload_3
      83: invokeinterface #25,  1           // InterfaceMethod org/jboss/as/patching/installation/Identity.getVersion:()Ljava/lang/String;
      88: invokestatic  #15                 // Method junit/framework/Assert.assertEquals:(Ljava/lang/String;Ljava/lang/String;)V
      91: aload_2
      92: invokevirtual #8                  // Method org/jboss/as/patching/installation/InstalledIdentity.getLayers:()Ljava/util/List;
      95: astore        4
      97: iconst_2
      98: aload         4
     100: invokeinterface #9,  1            // InterfaceMethod java/util/List.size:()I
     105: invokestatic  #10                 // Method junit/framework/Assert.assertEquals:(II)V
     108: aload         4
     110: iconst_0
     111: invokeinterface #12,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     116: checkcast     #13                 // class org/jboss/as/patching/installation/Layer
     119: astore        5
     121: aload_1
     122: aload         5
     124: invokeinterface #14,  1           // InterfaceMethod org/jboss/as/patching/installation/Layer.getName:()Ljava/lang/String;
     129: invokestatic  #15                 // Method junit/framework/Assert.assertEquals:(Ljava/lang/String;Ljava/lang/String;)V
     132: ldc           #11                 // String base
     134: aload         4
     136: iconst_1
     137: invokeinterface #12,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     142: checkcast     #13                 // class org/jboss/as/patching/installation/Layer
     145: invokeinterface #14,  1           // InterfaceMethod org/jboss/as/patching/installation/Layer.getName:()Ljava/lang/String;
     150: invokestatic  #15                 // Method junit/framework/Assert.assertEquals:(Ljava/lang/String;Ljava/lang/String;)V
     153: aload         5
     155: invokeinterface #26,  1           // InterfaceMethod org/jboss/as/patching/installation/Layer.loadTargetInfo:()Lorg/jboss/as/patching/installation/PatchableTarget$TargetInfo;
     160: astore        6
     162: ldc           #11                 // String base
     164: aload         6
     166: invokeinterface #27,  1           // InterfaceMethod org/jboss/as/patching/installation/PatchableTarget$TargetInfo.getCumulativePatchID:()Ljava/lang/String;
     171: invokestatic  #15                 // Method junit/framework/Assert.assertEquals:(Ljava/lang/String;Ljava/lang/String;)V
     174: aload         6
     176: invokeinterface #28,  1           // InterfaceMethod org/jboss/as/patching/installation/PatchableTarget$TargetInfo.getPatchIDs:()Ljava/util/List;
     181: invokeinterface #29,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     186: invokestatic  #30                 // Method junit/framework/Assert.assertTrue:(Z)V
     189: aload         6
     191: invokeinterface #31,  1           // InterfaceMethod org/jboss/as/patching/installation/PatchableTarget$TargetInfo.getDirectoryStructure:()Lorg/jboss/as/patching/DirectoryStructure;
     196: astore        7
     198: aload_0
     199: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
     202: invokevirtual #4                  // Method org/jboss/as/patching/DirectoryStructure.getModuleRoot:()Ljava/io/File;
     205: iconst_3
     206: anewarray     #5                  // class java/lang/String
     209: dup
     210: iconst_0
     211: ldc           #32                 // String system
     213: aastore
     214: dup
     215: iconst_1
     216: ldc           #33                 // String layers
     218: aastore
     219: dup
     220: iconst_2
     221: aload_1
     222: aastore
     223: invokestatic  #34                 // Method org/jboss/as/patching/IoUtils.newFile:(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;
     226: aload         7
     228: invokevirtual #4                  // Method org/jboss/as/patching/DirectoryStructure.getModuleRoot:()Ljava/io/File;
     231: invokestatic  #35                 // Method junit/framework/Assert.assertEquals:(Ljava/lang/Object;Ljava/lang/Object;)V
     234: aload         7
     236: invokevirtual #36                 // Method org/jboss/as/patching/DirectoryStructure.getBundleRepositoryRoot:()Ljava/io/File;
     239: invokestatic  #37                 // Method junit/framework/Assert.assertNull:(Ljava/lang/Object;)V
     242: return

  public void patchLayer() throws java.lang.Exception;
    Code:
       0: ldc           #38                 // String mylayer
       2: astore_1
       3: aload_0
       4: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
       7: invokevirtual #4                  // Method org/jboss/as/patching/DirectoryStructure.getModuleRoot:()Ljava/io/File;
      10: aload_0
      11: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
      14: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
      17: invokeinterface #17,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getLayersConf:()Ljava/io/File;
      22: iconst_1
      23: anewarray     #5                  // class java/lang/String
      26: dup
      27: iconst_0
      28: aload_1
      29: aastore
      30: invokestatic  #6                  // Method installLayer:(Ljava/io/File;Ljava/io/File;[Ljava/lang/String;)V
      33: aload_0
      34: invokevirtual #7                  // Method loadInstalledIdentity:()Lorg/jboss/as/patching/installation/InstalledIdentity;
      37: astore_2
      38: invokestatic  #2                  // Method org/jboss/as/patching/runner/TestUtils.randomString:()Ljava/lang/String;
      41: astore_3
      42: aload_0
      43: getfield      #39                 // Field tempDir:Ljava/io/File;
      46: iconst_1
      47: anewarray     #5                  // class java/lang/String
      50: dup
      51: iconst_0
      52: aload_3
      53: aastore
      54: invokestatic  #40                 // Method org/jboss/as/patching/IoUtils.mkdir:(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;
      57: astore        4
      59: ldc           #41                 // String mylayerPatchID
      61: astore        5
      63: invokestatic  #2                  // Method org/jboss/as/patching/runner/TestUtils.randomString:()Ljava/lang/String;
      66: astore        6
      68: aload         4
      70: aload         5
      72: aload         6
      74: invokestatic  #42                 // Method org/jboss/as/patching/runner/ContentModificationUtils.addModule:(Ljava/io/File;Ljava/lang/String;Ljava/lang/String;)Lorg/jboss/as/patching/metadata/ContentModification;
      77: astore        7
      79: aload         4
      81: aload_3
      82: ldc           #43                 // String new file resource
      84: iconst_2
      85: anewarray     #5                  // class java/lang/String
      88: dup
      89: iconst_0
      90: ldc           #44                 // String bin
      92: aastore
      93: dup
      94: iconst_1
      95: ldc           #45                 // String my-new-standalone.sh
      97: aastore
      98: invokestatic  #46                 // Method org/jboss/as/patching/runner/ContentModificationUtils.addMisc:(Ljava/io/File;Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Lorg/jboss/as/patching/metadata/ContentModification;
     101: astore        8
     103: invokestatic  #47                 // Method org/jboss/as/patching/metadata/PatchBuilder.create:()Lorg/jboss/as/patching/metadata/PatchBuilder;
     106: aload_3
     107: invokevirtual #48                 // Method org/jboss/as/patching/metadata/PatchBuilder.setPatchId:(Ljava/lang/String;)Lorg/jboss/as/patching/metadata/PatchBuilder;
     110: aload_2
     111: invokevirtual #20                 // Method org/jboss/as/patching/installation/InstalledIdentity.getIdentity:()Lorg/jboss/as/patching/installation/Identity;
     114: invokeinterface #23,  1           // InterfaceMethod org/jboss/as/patching/installation/Identity.getName:()Ljava/lang/String;
     119: aload_2
     120: invokevirtual #20                 // Method org/jboss/as/patching/installation/InstalledIdentity.getIdentity:()Lorg/jboss/as/patching/installation/Identity;
     123: invokeinterface #25,  1           // InterfaceMethod org/jboss/as/patching/installation/Identity.getVersion:()Ljava/lang/String;
     128: invokevirtual #49                 // Method org/jboss/as/patching/metadata/PatchBuilder.oneOffPatchIdentity:(Ljava/lang/String;Ljava/lang/String;)Lorg/jboss/as/patching/metadata/PatchIdentityBuilder;
     131: invokevirtual #50                 // Method org/jboss/as/patching/metadata/PatchIdentityBuilder.getParent:()Lorg/jboss/as/patching/metadata/PatchBuilder;
     134: aload         5
     136: aload_1
     137: iconst_0
     138: invokevirtual #51                 // Method org/jboss/as/patching/metadata/PatchBuilder.oneOffPatchElement:(Ljava/lang/String;Ljava/lang/String;Z)Lorg/jboss/as/patching/metadata/PatchElementBuilder;
     141: aload         7
     143: invokevirtual #52                 // Method org/jboss/as/patching/metadata/PatchElementBuilder.addContentModification:(Lorg/jboss/as/patching/metadata/ContentModification;)Ljava/lang/Object;
     146: checkcast     #53                 // class org/jboss/as/patching/metadata/PatchElementBuilder
     149: invokevirtual #54                 // Method org/jboss/as/patching/metadata/PatchElementBuilder.getParent:()Lorg/jboss/as/patching/metadata/PatchBuilder;
     152: aload         8
     154: invokevirtual #55                 // Method org/jboss/as/patching/metadata/PatchBuilder.addContentModification:(Lorg/jboss/as/patching/metadata/ContentModification;)Ljava/lang/Object;
     157: checkcast     #56                 // class org/jboss/as/patching/metadata/PatchBuilder
     160: invokevirtual #57                 // Method org/jboss/as/patching/metadata/PatchBuilder.build:()Lorg/jboss/as/patching/metadata/Patch;
     163: astore        9
     165: aload         4
     167: aload         9
     169: invokestatic  #58                 // Method org/jboss/as/patching/runner/TestUtils.createPatchXMLFile:(Ljava/io/File;Lorg/jboss/as/patching/metadata/Patch;)V
     172: aload         4
     174: aload_3
     175: invokestatic  #59                 // Method org/jboss/as/patching/runner/TestUtils.createZippedPatchFile:(Ljava/io/File;Ljava/lang/String;)Ljava/io/File;
     178: astore        10
     180: aload_0
     181: aload         10
     183: invokevirtual #60                 // Method executePatch:(Ljava/io/File;)Lorg/jboss/as/patching/tool/PatchingResult;
     186: astore        11
     188: aload         11
     190: aload         9
     192: invokestatic  #61                 // Method org/jboss/as/patching/runner/PatchingAssert.assertPatchHasBeenApplied:(Lorg/jboss/as/patching/tool/PatchingResult;Lorg/jboss/as/patching/metadata/Patch;)V
     195: aload_0
     196: invokevirtual #7                  // Method loadInstalledIdentity:()Lorg/jboss/as/patching/installation/InstalledIdentity;
     199: astore        12
     201: aload         9
     203: aload         12
     205: invokevirtual #20                 // Method org/jboss/as/patching/installation/InstalledIdentity.getIdentity:()Lorg/jboss/as/patching/installation/Identity;
     208: invokeinterface #62,  1           // InterfaceMethod org/jboss/as/patching/installation/Identity.loadTargetInfo:()Lorg/jboss/as/patching/installation/PatchableTarget$TargetInfo;
     213: invokestatic  #63                 // Method org/jboss/as/patching/runner/PatchingAssert.assertInstallationIsPatched:(Lorg/jboss/as/patching/metadata/Patch;Lorg/jboss/as/patching/installation/PatchableTarget$TargetInfo;)V
     216: aload_0
     217: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
     220: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
     223: invokeinterface #18,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getJbossHome:()Ljava/io/File;
     228: iconst_2
     229: anewarray     #5                  // class java/lang/String
     232: dup
     233: iconst_0
     234: ldc           #44                 // String bin
     236: aastore
     237: dup
     238: iconst_1
     239: aload         8
     241: invokevirtual #64                 // Method org/jboss/as/patching/metadata/ContentModification.getItem:()Lorg/jboss/as/patching/metadata/ContentItem;
     244: invokevirtual #65                 // Method org/jboss/as/patching/metadata/ContentItem.getName:()Ljava/lang/String;
     247: aastore
     248: invokestatic  #66                 // Method org/jboss/as/patching/runner/PatchingAssert.assertFileExists:(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;
     251: pop
     252: aload_2
     253: invokevirtual #8                  // Method org/jboss/as/patching/installation/InstalledIdentity.getLayers:()Ljava/util/List;
     256: iconst_0
     257: invokeinterface #12,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     262: checkcast     #13                 // class org/jboss/as/patching/installation/Layer
     265: invokeinterface #26,  1           // InterfaceMethod org/jboss/as/patching/installation/Layer.loadTargetInfo:()Lorg/jboss/as/patching/installation/PatchableTarget$TargetInfo;
     270: invokeinterface #31,  1           // InterfaceMethod org/jboss/as/patching/installation/PatchableTarget$TargetInfo.getDirectoryStructure:()Lorg/jboss/as/patching/DirectoryStructure;
     275: astore        13
     277: aload         13
     279: aload         5
     281: invokevirtual #67                 // Method org/jboss/as/patching/DirectoryStructure.getModulePatchDirectory:(Ljava/lang/String;)Ljava/io/File;
     284: astore        14
     286: aload         14
     288: iconst_0
     289: anewarray     #5                  // class java/lang/String
     292: invokestatic  #68                 // Method org/jboss/as/patching/runner/PatchingAssert.assertDirExists:(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;
     295: pop
     296: aload         14
     298: aload         6
     300: aload         7
     302: invokevirtual #64                 // Method org/jboss/as/patching/metadata/ContentModification.getItem:()Lorg/jboss/as/patching/metadata/ContentItem;
     305: invokevirtual #69                 // Method org/jboss/as/patching/metadata/ContentItem.getContentHash:()[B
     308: invokestatic  #70                 // Method org/jboss/as/patching/runner/PatchingAssert.assertDefinedModule:(Ljava/io/File;Ljava/lang/String;[B)V
     311: return

  public void patchAndRollbackLayer() throws java.lang.Exception;
    Code:
       0: invokestatic  #2                  // Method org/jboss/as/patching/runner/TestUtils.randomString:()Ljava/lang/String;
       3: astore_1
       4: aload_0
       5: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
       8: invokevirtual #4                  // Method org/jboss/as/patching/DirectoryStructure.getModuleRoot:()Ljava/io/File;
      11: aload_0
      12: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
      15: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
      18: invokeinterface #17,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getLayersConf:()Ljava/io/File;
      23: iconst_1
      24: anewarray     #5                  // class java/lang/String
      27: dup
      28: iconst_0
      29: aload_1
      30: aastore
      31: invokestatic  #6                  // Method installLayer:(Ljava/io/File;Ljava/io/File;[Ljava/lang/String;)V
      34: aload_0
      35: invokevirtual #7                  // Method loadInstalledIdentity:()Lorg/jboss/as/patching/installation/InstalledIdentity;
      38: astore_2
      39: aload_2
      40: invokevirtual #20                 // Method org/jboss/as/patching/installation/InstalledIdentity.getIdentity:()Lorg/jboss/as/patching/installation/Identity;
      43: invokeinterface #62,  1           // InterfaceMethod org/jboss/as/patching/installation/Identity.loadTargetInfo:()Lorg/jboss/as/patching/installation/PatchableTarget$TargetInfo;
      48: astore_3
      49: ldc           #11                 // String base
      51: aload_3
      52: invokeinterface #27,  1           // InterfaceMethod org/jboss/as/patching/installation/PatchableTarget$TargetInfo.getCumulativePatchID:()Ljava/lang/String;
      57: invokestatic  #15                 // Method junit/framework/Assert.assertEquals:(Ljava/lang/String;Ljava/lang/String;)V
      60: aload_3
      61: invokeinterface #28,  1           // InterfaceMethod org/jboss/as/patching/installation/PatchableTarget$TargetInfo.getPatchIDs:()Ljava/util/List;
      66: invokeinterface #29,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      71: invokestatic  #30                 // Method junit/framework/Assert.assertTrue:(Z)V
      74: invokestatic  #2                  // Method org/jboss/as/patching/runner/TestUtils.randomString:()Ljava/lang/String;
      77: astore        4
      79: aload_0
      80: getfield      #39                 // Field tempDir:Ljava/io/File;
      83: iconst_1
      84: anewarray     #5                  // class java/lang/String
      87: dup
      88: iconst_0
      89: aload         4
      91: aastore
      92: invokestatic  #40                 // Method org/jboss/as/patching/IoUtils.mkdir:(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;
      95: astore        5
      97: ldc           #41                 // String mylayerPatchID
      99: astore        6
     101: invokestatic  #2                  // Method org/jboss/as/patching/runner/TestUtils.randomString:()Ljava/lang/String;
     104: astore        7
     106: aload         5
     108: aload         6
     110: aload         7
     112: invokestatic  #42                 // Method org/jboss/as/patching/runner/ContentModificationUtils.addModule:(Ljava/io/File;Ljava/lang/String;Ljava/lang/String;)Lorg/jboss/as/patching/metadata/ContentModification;
     115: astore        8
     117: aload         5
     119: aload         4
     121: ldc           #43                 // String new file resource
     123: iconst_2
     124: anewarray     #5                  // class java/lang/String
     127: dup
     128: iconst_0
     129: ldc           #44                 // String bin
     131: aastore
     132: dup
     133: iconst_1
     134: ldc           #45                 // String my-new-standalone.sh
     136: aastore
     137: invokestatic  #46                 // Method org/jboss/as/patching/runner/ContentModificationUtils.addMisc:(Ljava/io/File;Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Lorg/jboss/as/patching/metadata/ContentModification;
     140: astore        9
     142: invokestatic  #47                 // Method org/jboss/as/patching/metadata/PatchBuilder.create:()Lorg/jboss/as/patching/metadata/PatchBuilder;
     145: aload         4
     147: invokevirtual #48                 // Method org/jboss/as/patching/metadata/PatchBuilder.setPatchId:(Ljava/lang/String;)Lorg/jboss/as/patching/metadata/PatchBuilder;
     150: aload_2
     151: invokevirtual #20                 // Method org/jboss/as/patching/installation/InstalledIdentity.getIdentity:()Lorg/jboss/as/patching/installation/Identity;
     154: invokeinterface #23,  1           // InterfaceMethod org/jboss/as/patching/installation/Identity.getName:()Ljava/lang/String;
     159: aload_2
     160: invokevirtual #20                 // Method org/jboss/as/patching/installation/InstalledIdentity.getIdentity:()Lorg/jboss/as/patching/installation/Identity;
     163: invokeinterface #25,  1           // InterfaceMethod org/jboss/as/patching/installation/Identity.getVersion:()Ljava/lang/String;
     168: invokevirtual #49                 // Method org/jboss/as/patching/metadata/PatchBuilder.oneOffPatchIdentity:(Ljava/lang/String;Ljava/lang/String;)Lorg/jboss/as/patching/metadata/PatchIdentityBuilder;
     171: invokevirtual #50                 // Method org/jboss/as/patching/metadata/PatchIdentityBuilder.getParent:()Lorg/jboss/as/patching/metadata/PatchBuilder;
     174: aload         6
     176: aload_1
     177: iconst_0
     178: invokevirtual #51                 // Method org/jboss/as/patching/metadata/PatchBuilder.oneOffPatchElement:(Ljava/lang/String;Ljava/lang/String;Z)Lorg/jboss/as/patching/metadata/PatchElementBuilder;
     181: aload         8
     183: invokevirtual #52                 // Method org/jboss/as/patching/metadata/PatchElementBuilder.addContentModification:(Lorg/jboss/as/patching/metadata/ContentModification;)Ljava/lang/Object;
     186: checkcast     #53                 // class org/jboss/as/patching/metadata/PatchElementBuilder
     189: invokevirtual #54                 // Method org/jboss/as/patching/metadata/PatchElementBuilder.getParent:()Lorg/jboss/as/patching/metadata/PatchBuilder;
     192: aload         9
     194: invokevirtual #55                 // Method org/jboss/as/patching/metadata/PatchBuilder.addContentModification:(Lorg/jboss/as/patching/metadata/ContentModification;)Ljava/lang/Object;
     197: checkcast     #56                 // class org/jboss/as/patching/metadata/PatchBuilder
     200: invokevirtual #57                 // Method org/jboss/as/patching/metadata/PatchBuilder.build:()Lorg/jboss/as/patching/metadata/Patch;
     203: astore        10
     205: aload         5
     207: aload         10
     209: invokestatic  #58                 // Method org/jboss/as/patching/runner/TestUtils.createPatchXMLFile:(Ljava/io/File;Lorg/jboss/as/patching/metadata/Patch;)V
     212: aload         5
     214: aload         4
     216: invokestatic  #59                 // Method org/jboss/as/patching/runner/TestUtils.createZippedPatchFile:(Ljava/io/File;Ljava/lang/String;)Ljava/io/File;
     219: astore        11
     221: aload_0
     222: invokevirtual #7                  // Method loadInstalledIdentity:()Lorg/jboss/as/patching/installation/InstalledIdentity;
     225: invokevirtual #20                 // Method org/jboss/as/patching/installation/InstalledIdentity.getIdentity:()Lorg/jboss/as/patching/installation/Identity;
     228: astore        12
     230: aload_0
     231: aload         11
     233: invokevirtual #60                 // Method executePatch:(Ljava/io/File;)Lorg/jboss/as/patching/tool/PatchingResult;
     236: astore        13
     238: aload         13
     240: aload         10
     242: invokestatic  #61                 // Method org/jboss/as/patching/runner/PatchingAssert.assertPatchHasBeenApplied:(Lorg/jboss/as/patching/tool/PatchingResult;Lorg/jboss/as/patching/metadata/Patch;)V
     245: aload_0
     246: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
     249: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
     252: invokeinterface #18,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getJbossHome:()Ljava/io/File;
     257: aload_0
     258: getfield      #21                 // Field productConfig:Lorg/jboss/as/version/ProductConfig;
     261: iconst_1
     262: anewarray     #71                 // class java/io/File
     265: dup
     266: iconst_0
     267: aload_0
     268: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
     271: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
     274: invokeinterface #72,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getModulesDir:()Ljava/io/File;
     279: aastore
     280: invokestatic  #73                 // Method org/jboss/as/patching/installation/InstalledIdentity.load:(Ljava/io/File;Lorg/jboss/as/version/ProductConfig;[Ljava/io/File;)Lorg/jboss/as/patching/installation/InstalledIdentity;
     283: astore        14
     285: aload         10
     287: aload         14
     289: invokevirtual #20                 // Method org/jboss/as/patching/installation/InstalledIdentity.getIdentity:()Lorg/jboss/as/patching/installation/Identity;
     292: invokeinterface #62,  1           // InterfaceMethod org/jboss/as/patching/installation/Identity.loadTargetInfo:()Lorg/jboss/as/patching/installation/PatchableTarget$TargetInfo;
     297: invokestatic  #63                 // Method org/jboss/as/patching/runner/PatchingAssert.assertInstallationIsPatched:(Lorg/jboss/as/patching/metadata/Patch;Lorg/jboss/as/patching/installation/PatchableTarget$TargetInfo;)V
     300: aload_0
     301: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
     304: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
     307: invokeinterface #18,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getJbossHome:()Ljava/io/File;
     312: iconst_2
     313: anewarray     #5                  // class java/lang/String
     316: dup
     317: iconst_0
     318: ldc           #44                 // String bin
     320: aastore
     321: dup
     322: iconst_1
     323: aload         9
     325: invokevirtual #64                 // Method org/jboss/as/patching/metadata/ContentModification.getItem:()Lorg/jboss/as/patching/metadata/ContentItem;
     328: invokevirtual #65                 // Method org/jboss/as/patching/metadata/ContentItem.getName:()Ljava/lang/String;
     331: aastore
     332: invokestatic  #66                 // Method org/jboss/as/patching/runner/PatchingAssert.assertFileExists:(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;
     335: pop
     336: aload         14
     338: invokevirtual #8                  // Method org/jboss/as/patching/installation/InstalledIdentity.getLayers:()Ljava/util/List;
     341: iconst_0
     342: invokeinterface #12,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     347: checkcast     #13                 // class org/jboss/as/patching/installation/Layer
     350: invokeinterface #26,  1           // InterfaceMethod org/jboss/as/patching/installation/Layer.loadTargetInfo:()Lorg/jboss/as/patching/installation/PatchableTarget$TargetInfo;
     355: invokeinterface #31,  1           // InterfaceMethod org/jboss/as/patching/installation/PatchableTarget$TargetInfo.getDirectoryStructure:()Lorg/jboss/as/patching/DirectoryStructure;
     360: astore        15
     362: aload         15
     364: aload         6
     366: invokevirtual #67                 // Method org/jboss/as/patching/DirectoryStructure.getModulePatchDirectory:(Ljava/lang/String;)Ljava/io/File;
     369: astore        16
     371: aload         16
     373: iconst_0
     374: anewarray     #5                  // class java/lang/String
     377: invokestatic  #68                 // Method org/jboss/as/patching/runner/PatchingAssert.assertDirExists:(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;
     380: pop
     381: aload         16
     383: aload         7
     385: aload         8
     387: invokevirtual #64                 // Method org/jboss/as/patching/metadata/ContentModification.getItem:()Lorg/jboss/as/patching/metadata/ContentItem;
     390: invokevirtual #69                 // Method org/jboss/as/patching/metadata/ContentItem.getContentHash:()[B
     393: invokestatic  #70                 // Method org/jboss/as/patching/runner/PatchingAssert.assertDefinedModule:(Ljava/io/File;Ljava/lang/String;[B)V
     396: aload_0
     397: aload         4
     399: invokevirtual #74                 // Method rollback:(Ljava/lang/String;)Lorg/jboss/as/patching/tool/PatchingResult;
     402: astore        17
     404: aload         17
     406: aload         12
     408: invokestatic  #75                 // Method org/jboss/as/patching/runner/PatchingAssert.assertPatchHasBeenRolledBack:(Lorg/jboss/as/patching/tool/PatchingResult;Lorg/jboss/as/patching/installation/Identity;)V
     411: aload_0
     412: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
     415: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
     418: invokeinterface #18,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getJbossHome:()Ljava/io/File;
     423: aload_0
     424: getfield      #21                 // Field productConfig:Lorg/jboss/as/version/ProductConfig;
     427: iconst_1
     428: anewarray     #71                 // class java/io/File
     431: dup
     432: iconst_0
     433: aload_0
     434: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
     437: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
     440: invokeinterface #72,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getModulesDir:()Ljava/io/File;
     445: aastore
     446: invokestatic  #73                 // Method org/jboss/as/patching/installation/InstalledIdentity.load:(Ljava/io/File;Lorg/jboss/as/version/ProductConfig;[Ljava/io/File;)Lorg/jboss/as/patching/installation/InstalledIdentity;
     449: astore        18
     451: aload_0
     452: getfield      #3                  // Field env:Lorg/jboss/as/patching/DirectoryStructure;
     455: invokevirtual #16                 // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
     458: invokeinterface #18,  1           // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getJbossHome:()Ljava/io/File;
     463: iconst_2
     464: anewarray     #5                  // class java/lang/String
     467: dup
     468: iconst_0
     469: ldc           #44                 // String bin
     471: aastore
     472: dup
     473: iconst_1
     474: aload         9
     476: invokevirtual #64                 // Method org/jboss/as/patching/metadata/ContentModification.getItem:()Lorg/jboss/as/patching/metadata/ContentItem;
     479: invokevirtual #65                 // Method org/jboss/as/patching/metadata/ContentItem.getName:()Ljava/lang/String;
     482: aastore
     483: invokestatic  #76                 // Method org/jboss/as/patching/runner/PatchingAssert.assertFileDoesNotExist:(Ljava/io/File;[Ljava/lang/String;)V
     486: getstatic     #77                 // Field java/io/File.separatorChar:C
     489: bipush        92
     491: if_icmpeq     530
     494: aload         18
     496: invokevirtual #8                  // Method org/jboss/as/patching/installation/InstalledIdentity.getLayers:()Ljava/util/List;
     499: iconst_0
     500: invokeinterface #12,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     505: checkcast     #13                 // class org/jboss/as/patching/installation/Layer
     508: invokeinterface #26,  1           // InterfaceMethod org/jboss/as/patching/installation/Layer.loadTargetInfo:()Lorg/jboss/as/patching/installation/PatchableTarget$TargetInfo;
     513: invokeinterface #31,  1           // InterfaceMethod org/jboss/as/patching/installation/PatchableTarget$TargetInfo.getDirectoryStructure:()Lorg/jboss/as/patching/DirectoryStructure;
     518: aload         6
     520: invokevirtual #67                 // Method org/jboss/as/patching/DirectoryStructure.getModulePatchDirectory:(Ljava/lang/String;)Ljava/io/File;
     523: iconst_0
     524: anewarray     #5                  // class java/lang/String
     527: invokestatic  #78                 // Method org/jboss/as/patching/runner/PatchingAssert.assertDirDoesNotExist:(Ljava/io/File;[Ljava/lang/String;)V
     530: return

  private static void installLayer(java.io.File, java.io.File, java.lang.String...) throws java.lang.Exception;
    Code:
       0: aload_2
       1: astore_3
       2: aload_3
       3: arraylength
       4: istore        4
       6: iconst_0
       7: istore        5
       9: iload         5
      11: iload         4
      13: if_icmpge     52
      16: aload_3
      17: iload         5
      19: aaload
      20: astore        6
      22: aload_0
      23: iconst_3
      24: anewarray     #5                  // class java/lang/String
      27: dup
      28: iconst_0
      29: ldc           #32                 // String system
      31: aastore
      32: dup
      33: iconst_1
      34: ldc           #33                 // String layers
      36: aastore
      37: dup
      38: iconst_2
      39: aload         6
      41: aastore
      42: invokestatic  #40                 // Method org/jboss/as/patching/IoUtils.mkdir:(Ljava/io/File;[Ljava/lang/String;)Ljava/io/File;
      45: pop
      46: iinc          5, 1
      49: goto          9
      52: aload_1
      53: ifnull        169
      56: new           #79                 // class java/util/Properties
      59: dup
      60: invokespecial #80                 // Method java/util/Properties."<init>":()V
      63: astore_3
      64: new           #81                 // class java/lang/StringBuilder
      67: dup
      68: invokespecial #82                 // Method java/lang/StringBuilder."<init>":()V
      71: astore        4
      73: iconst_0
      74: istore        5
      76: iload         5
      78: aload_2
      79: arraylength
      80: if_icmpge     112
      83: iload         5
      85: ifle          96
      88: aload         4
      90: bipush        44
      92: invokevirtual #83                 // Method java/lang/StringBuilder.append:(C)Ljava/lang/StringBuilder;
      95: pop
      96: aload         4
      98: aload_2
      99: iload         5
     101: aaload
     102: invokevirtual #84                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     105: pop
     106: iinc          5, 1
     109: goto          76
     112: aload_3
     113: ldc           #33                 // String layers
     115: aload         4
     117: invokevirtual #85                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     120: invokevirtual #86                 // Method java/util/Properties.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     123: pop
     124: aload_3
     125: ldc           #87                 // String exclude.base.layer
     127: ldc           #88                 // String true
     129: invokevirtual #86                 // Method java/util/Properties.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     132: pop
     133: new           #89                 // class java/io/FileOutputStream
     136: dup
     137: aload_1
     138: invokespecial #90                 // Method java/io/FileOutputStream."<init>":(Ljava/io/File;)V
     141: astore        5
     143: aload_3
     144: aload         5
     146: ldc           #91                 // String
     148: invokevirtual #92                 // Method java/util/Properties.store:(Ljava/io/OutputStream;Ljava/lang/String;)V
     151: aload         5
     153: invokestatic  #93                 // Method org/jboss/as/patching/IoUtils.safeClose:(Ljava/io/Closeable;)V
     156: goto          169
     159: astore        7
     161: aload         5
     163: invokestatic  #93                 // Method org/jboss/as/patching/IoUtils.safeClose:(Ljava/io/Closeable;)V
     166: aload         7
     168: athrow
     169: return
    Exception table:
       from    to  target type
         143   151   159   any
         159   161   159   any
}
