Compiled from "TraceStorageTopology.java"
class zipkin2.storage.kafka.streams.TraceStorageTopology$1 implements org.apache.kafka.streams.processor.Processor<java.lang.String, java.util.List<zipkin2.Span>> {
  org.apache.kafka.streams.state.KeyValueStore tracesStore;

  org.apache.kafka.streams.state.KeyValueStore spanIdsByTsStore;

  final zipkin2.storage.kafka.streams.TraceStorageTopology this$0;

  zipkin2.storage.kafka.streams.TraceStorageTopology$1(zipkin2.storage.kafka.streams.TraceStorageTopology);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #2                  // Field this$0:Lzipkin2/storage/kafka/streams/TraceStorageTopology;
       5: aload_0
       6: invokespecial #3                  // Method java/lang/Object."<init>":()V
       9: return

  public void init(org.apache.kafka.streams.processor.ProcessorContext);
    Code:
       0: aload_0
       1: aload_1
       2: ldc           #4                  // String zipkin-traces
       4: invokeinterface #5,  2            // InterfaceMethod org/apache/kafka/streams/processor/ProcessorContext.getStateStore:(Ljava/lang/String;)Lorg/apache/kafka/streams/processor/StateStore;
       9: checkcast     #6                  // class org/apache/kafka/streams/state/KeyValueStore
      12: putfield      #7                  // Field tracesStore:Lorg/apache/kafka/streams/state/KeyValueStore;
      15: aload_0
      16: aload_1
      17: ldc           #8                  // String zipkin-traces-by-timestamp
      19: invokeinterface #5,  2            // InterfaceMethod org/apache/kafka/streams/processor/ProcessorContext.getStateStore:(Ljava/lang/String;)Lorg/apache/kafka/streams/processor/StateStore;
      24: checkcast     #6                  // class org/apache/kafka/streams/state/KeyValueStore
      27: putfield      #9                  // Field spanIdsByTsStore:Lorg/apache/kafka/streams/state/KeyValueStore;
      30: aload_1
      31: aload_0
      32: getfield      #2                  // Field this$0:Lzipkin2/storage/kafka/streams/TraceStorageTopology;
      35: getfield      #10                 // Field zipkin2/storage/kafka/streams/TraceStorageTopology.traceTtlCheckInterval:Ljava/time/Duration;
      38: getstatic     #11                 // Field org/apache/kafka/streams/processor/PunctuationType.STREAM_TIME:Lorg/apache/kafka/streams/processor/PunctuationType;
      41: aload_0
      42: invokedynamic #12,  0             // InvokeDynamic #0:punctuate:(Lzipkin2/storage/kafka/streams/TraceStorageTopology$1;)Lorg/apache/kafka/streams/processor/Punctuator;
      47: invokeinterface #13,  4           // InterfaceMethod org/apache/kafka/streams/processor/ProcessorContext.schedule:(Ljava/time/Duration;Lorg/apache/kafka/streams/processor/PunctuationType;Lorg/apache/kafka/streams/processor/Punctuator;)Lorg/apache/kafka/streams/processor/Cancellable;
      52: pop
      53: return

  public void process(java.lang.String, java.util.List<zipkin2.Span>);
    Code:
       0: aload_2
       1: invokeinterface #14,  1           // InterfaceMethod java/util/List.isEmpty:()Z
       6: ifne          145
       9: aload_0
      10: getfield      #7                  // Field tracesStore:Lorg/apache/kafka/streams/state/KeyValueStore;
      13: aload_1
      14: invokeinterface #15,  2           // InterfaceMethod org/apache/kafka/streams/state/KeyValueStore.get:(Ljava/lang/Object;)Ljava/lang/Object;
      19: checkcast     #16                 // class java/util/List
      22: astore_3
      23: aload_3
      24: ifnonnull     38
      27: new           #17                 // class java/util/ArrayList
      30: dup
      31: invokespecial #18                 // Method java/util/ArrayList."<init>":()V
      34: astore_3
      35: goto          50
      38: aload_0
      39: getfield      #2                  // Field this$0:Lzipkin2/storage/kafka/streams/TraceStorageTopology;
      42: getfield      #19                 // Field zipkin2/storage/kafka/streams/TraceStorageTopology.brokenTracesTotal:Lio/micrometer/core/instrument/Counter;
      45: invokeinterface #20,  1           // InterfaceMethod io/micrometer/core/instrument/Counter.increment:()V
      50: aload_3
      51: aload_2
      52: invokeinterface #21,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
      57: pop
      58: aload_0
      59: getfield      #7                  // Field tracesStore:Lorg/apache/kafka/streams/state/KeyValueStore;
      62: aload_1
      63: aload_3
      64: invokeinterface #22,  3           // InterfaceMethod org/apache/kafka/streams/state/KeyValueStore.put:(Ljava/lang/Object;Ljava/lang/Object;)V
      69: aload_2
      70: iconst_0
      71: invokeinterface #23,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      76: checkcast     #24                 // class zipkin2/Span
      79: invokevirtual #25                 // Method zipkin2/Span.timestamp:()Ljava/lang/Long;
      82: invokevirtual #26                 // Method java/lang/Long.longValue:()J
      85: lstore        4
      87: aload_0
      88: getfield      #9                  // Field spanIdsByTsStore:Lorg/apache/kafka/streams/state/KeyValueStore;
      91: lload         4
      93: invokestatic  #27                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      96: invokeinterface #15,  2           // InterfaceMethod org/apache/kafka/streams/state/KeyValueStore.get:(Ljava/lang/Object;)Ljava/lang/Object;
     101: checkcast     #28                 // class java/util/Set
     104: astore        6
     106: aload         6
     108: ifnonnull     120
     111: new           #29                 // class java/util/LinkedHashSet
     114: dup
     115: invokespecial #30                 // Method java/util/LinkedHashSet."<init>":()V
     118: astore        6
     120: aload         6
     122: aload_1
     123: invokeinterface #31,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     128: pop
     129: aload_0
     130: getfield      #9                  // Field spanIdsByTsStore:Lorg/apache/kafka/streams/state/KeyValueStore;
     133: lload         4
     135: invokestatic  #27                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     138: aload         6
     140: invokeinterface #22,  3           // InterfaceMethod org/apache/kafka/streams/state/KeyValueStore.put:(Ljava/lang/Object;Ljava/lang/Object;)V
     145: return

  public void close();
    Code:
       0: return

  public void process(java.lang.Object, java.lang.Object);
    Code:
       0: aload_0
       1: aload_1
       2: checkcast     #32                 // class java/lang/String
       5: aload_2
       6: checkcast     #16                 // class java/util/List
       9: invokevirtual #33                 // Method process:(Ljava/lang/String;Ljava/util/List;)V
      12: return

  private void lambda$init$1(long);
    Code:
       0: aload_0
       1: getfield      #2                  // Field this$0:Lzipkin2/storage/kafka/streams/TraceStorageTopology;
       4: getfield      #34                 // Field zipkin2/storage/kafka/streams/TraceStorageTopology.traceTtl:Ljava/time/Duration;
       7: invokevirtual #35                 // Method java/time/Duration.toMillis:()J
      10: lconst_0
      11: lcmp
      12: ifle          167
      15: aload_0
      16: getfield      #36                 // Field tracesStore:Lorg/apache/kafka/streams/state/KeyValueStore;
      19: invokeinterface #37,  1           // InterfaceMethod org/apache/kafka/streams/state/KeyValueStore.approximateNumEntries:()J
      24: aload_0
      25: getfield      #2                  // Field this$0:Lzipkin2/storage/kafka/streams/TraceStorageTopology;
      28: getfield      #38                 // Field zipkin2/storage/kafka/streams/TraceStorageTopology.minTracesStored:J
      31: lcmp
      32: ifle          167
      35: lconst_0
      36: lstore_3
      37: lload_1
      38: aload_0
      39: getfield      #2                  // Field this$0:Lzipkin2/storage/kafka/streams/TraceStorageTopology;
      42: getfield      #34                 // Field zipkin2/storage/kafka/streams/TraceStorageTopology.traceTtl:Ljava/time/Duration;
      45: invokevirtual #35                 // Method java/time/Duration.toMillis:()J
      48: lsub
      49: lstore        5
      51: aload_0
      52: getfield      #39                 // Field spanIdsByTsStore:Lorg/apache/kafka/streams/state/KeyValueStore;
      55: lload_3
      56: invokestatic  #27                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      59: getstatic     #40                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
      62: lload         5
      64: invokevirtual #41                 // Method java/util/concurrent/TimeUnit.toMicros:(J)J
      67: invokestatic  #27                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      70: invokeinterface #42,  3           // InterfaceMethod org/apache/kafka/streams/state/KeyValueStore.range:(Ljava/lang/Object;Ljava/lang/Object;)Lorg/apache/kafka/streams/state/KeyValueIterator;
      75: astore        7
      77: aload         7
      79: aload_0
      80: invokedynamic #43,  0             // InvokeDynamic #1:accept:(Lzipkin2/storage/kafka/streams/TraceStorageTopology$1;)Ljava/util/function/Consumer;
      85: invokeinterface #44,  2           // InterfaceMethod org/apache/kafka/streams/state/KeyValueIterator.forEachRemaining:(Ljava/util/function/Consumer;)V
      90: getstatic     #45                 // Field zipkin2/storage/kafka/streams/TraceStorageTopology.LOG:Lorg/slf4j/Logger;
      93: ldc           #46                 // String Traces deletion emitted at {}, approx. number of traces stored {}
      95: lload         5
      97: invokestatic  #47                 // Method java/time/Instant.ofEpochMilli:(J)Ljava/time/Instant;
     100: invokestatic  #48                 // Method java/time/ZoneId.systemDefault:()Ljava/time/ZoneId;
     103: invokevirtual #49                 // Method java/time/Instant.atZone:(Ljava/time/ZoneId;)Ljava/time/ZonedDateTime;
     106: aload_0
     107: getfield      #36                 // Field tracesStore:Lorg/apache/kafka/streams/state/KeyValueStore;
     110: invokeinterface #37,  1           // InterfaceMethod org/apache/kafka/streams/state/KeyValueStore.approximateNumEntries:()J
     115: invokestatic  #27                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     118: invokeinterface #50,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     123: aload         7
     125: ifnull        167
     128: aload         7
     130: invokeinterface #51,  1           // InterfaceMethod org/apache/kafka/streams/state/KeyValueIterator.close:()V
     135: goto          167
     138: astore        8
     140: aload         7
     142: ifnull        164
     145: aload         7
     147: invokeinterface #51,  1           // InterfaceMethod org/apache/kafka/streams/state/KeyValueIterator.close:()V
     152: goto          164
     155: astore        9
     157: aload         8
     159: aload         9
     161: invokevirtual #53                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     164: aload         8
     166: athrow
     167: return
    Exception table:
       from    to  target type
          77   123   138   Class java/lang/Throwable
         145   152   155   Class java/lang/Throwable

  private void lambda$init$0(org.apache.kafka.streams.KeyValue);
    Code:
       0: aload_0
       1: getfield      #39                 // Field spanIdsByTsStore:Lorg/apache/kafka/streams/state/KeyValueStore;
       4: aload_1
       5: getfield      #54                 // Field org/apache/kafka/streams/KeyValue.key:Ljava/lang/Object;
       8: checkcast     #55                 // class java/lang/Long
      11: invokeinterface #56,  2           // InterfaceMethod org/apache/kafka/streams/state/KeyValueStore.delete:(Ljava/lang/Object;)Ljava/lang/Object;
      16: pop
      17: aload_1
      18: getfield      #57                 // Field org/apache/kafka/streams/KeyValue.value:Ljava/lang/Object;
      21: checkcast     #28                 // class java/util/Set
      24: invokeinterface #58,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      29: astore_2
      30: aload_2
      31: invokeinterface #59,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      36: ifeq          63
      39: aload_2
      40: invokeinterface #60,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      45: checkcast     #32                 // class java/lang/String
      48: astore_3
      49: aload_0
      50: getfield      #36                 // Field tracesStore:Lorg/apache/kafka/streams/state/KeyValueStore;
      53: aload_3
      54: invokeinterface #56,  2           // InterfaceMethod org/apache/kafka/streams/state/KeyValueStore.delete:(Ljava/lang/Object;)Ljava/lang/Object;
      59: pop
      60: goto          30
      63: return
}
