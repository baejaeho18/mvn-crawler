Compiled from "SSLValve.java"
public class org.apache.catalina.valves.SSLValve extends org.apache.catalina.valves.ValveBase {
  private static final org.apache.juli.logging.Log log;

  private java.lang.String sslClientCertHeader;

  private java.lang.String sslCipherHeader;

  private java.lang.String sslSessionIdHeader;

  private java.lang.String sslCipherUserKeySizeHeader;

  public org.apache.catalina.valves.SSLValve();
    Code:
       0: aload_0
       1: iconst_1
       2: invokespecial #1                  // Method org/apache/catalina/valves/ValveBase."<init>":(Z)V
       5: aload_0
       6: ldc           #2                  // String ssl_client_cert
       8: putfield      #3                  // Field sslClientCertHeader:Ljava/lang/String;
      11: aload_0
      12: ldc           #4                  // String ssl_cipher
      14: putfield      #5                  // Field sslCipherHeader:Ljava/lang/String;
      17: aload_0
      18: ldc           #6                  // String ssl_session_id
      20: putfield      #7                  // Field sslSessionIdHeader:Ljava/lang/String;
      23: aload_0
      24: ldc           #8                  // String ssl_cipher_usekeysize
      26: putfield      #9                  // Field sslCipherUserKeySizeHeader:Ljava/lang/String;
      29: return

  public java.lang.String getSslClientCertHeader();
    Code:
       0: aload_0
       1: getfield      #3                  // Field sslClientCertHeader:Ljava/lang/String;
       4: areturn

  public void setSslClientCertHeader(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #3                  // Field sslClientCertHeader:Ljava/lang/String;
       5: return

  public java.lang.String getSslCipherHeader();
    Code:
       0: aload_0
       1: getfield      #5                  // Field sslCipherHeader:Ljava/lang/String;
       4: areturn

  public void setSslCipherHeader(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #5                  // Field sslCipherHeader:Ljava/lang/String;
       5: return

  public java.lang.String getSslSessionIdHeader();
    Code:
       0: aload_0
       1: getfield      #7                  // Field sslSessionIdHeader:Ljava/lang/String;
       4: areturn

  public void setSslSessionIdHeader(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #7                  // Field sslSessionIdHeader:Ljava/lang/String;
       5: return

  public java.lang.String getSslCipherUserKeySizeHeader();
    Code:
       0: aload_0
       1: getfield      #9                  // Field sslCipherUserKeySizeHeader:Ljava/lang/String;
       4: areturn

  public void setSslCipherUserKeySizeHeader(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #9                  // Field sslCipherUserKeySizeHeader:Ljava/lang/String;
       5: return

  public java.lang.String mygetHeader(org.apache.catalina.connector.Request, java.lang.String);
    Code:
       0: aload_1
       1: aload_2
       2: invokevirtual #10                 // Method org/apache/catalina/connector/Request.getHeader:(Ljava/lang/String;)Ljava/lang/String;
       5: astore_3
       6: aload_3
       7: ifnonnull     12
      10: aconst_null
      11: areturn
      12: ldc           #11                 // String (null)
      14: aload_3
      15: invokevirtual #12                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      18: ifeq          23
      21: aconst_null
      22: areturn
      23: aload_3
      24: areturn

  public void invoke(org.apache.catalina.connector.Request, org.apache.catalina.connector.Response) throws java.io.IOException, javax.servlet.ServletException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_0
       3: getfield      #3                  // Field sslClientCertHeader:Ljava/lang/String;
       6: invokevirtual #13                 // Method mygetHeader:(Lorg/apache/catalina/connector/Request;Ljava/lang/String;)Ljava/lang/String;
       9: astore_3
      10: aload_3
      11: ifnull        241
      14: aload_3
      15: invokevirtual #14                 // Method java/lang/String.trim:()Ljava/lang/String;
      18: astore_3
      19: aload_3
      20: invokevirtual #15                 // Method java/lang/String.length:()I
      23: bipush        27
      25: if_icmple     241
      28: aload_3
      29: bipush        27
      31: aload_3
      32: invokevirtual #15                 // Method java/lang/String.length:()I
      35: bipush        25
      37: isub
      38: invokevirtual #16                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      41: astore        4
      43: aload         4
      45: bipush        32
      47: bipush        10
      49: invokevirtual #17                 // Method java/lang/String.replace:(CC)Ljava/lang/String;
      52: astore        4
      54: aload         4
      56: bipush        9
      58: bipush        10
      60: invokevirtual #17                 // Method java/lang/String.replace:(CC)Ljava/lang/String;
      63: astore        4
      65: ldc           #18                 // String -----BEGIN CERTIFICATE-----\n
      67: astore        5
      69: ldc           #19                 // String \n-----END CERTIFICATE-----\n
      71: astore        6
      73: aload         5
      75: aload         4
      77: invokevirtual #20                 // Method java/lang/String.concat:(Ljava/lang/String;)Ljava/lang/String;
      80: aload         6
      82: invokevirtual #20                 // Method java/lang/String.concat:(Ljava/lang/String;)Ljava/lang/String;
      85: astore        7
      87: new           #21                 // class java/io/ByteArrayInputStream
      90: dup
      91: aload         7
      93: getstatic     #22                 // Field java/nio/charset/StandardCharsets.ISO_8859_1:Ljava/nio/charset/Charset;
      96: invokevirtual #23                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
      99: invokespecial #24                 // Method java/io/ByteArrayInputStream."<init>":([B)V
     102: astore        8
     104: aconst_null
     105: astore        9
     107: aload_1
     108: invokevirtual #25                 // Method org/apache/catalina/connector/Request.getConnector:()Lorg/apache/catalina/connector/Connector;
     111: ldc           #26                 // String clientCertProvider
     113: invokevirtual #27                 // Method org/apache/catalina/connector/Connector.getProperty:(Ljava/lang/String;)Ljava/lang/Object;
     116: checkcast     #28                 // class java/lang/String
     119: astore        10
     121: aload         10
     123: ifnonnull     136
     126: ldc           #29                 // String X.509
     128: invokestatic  #30                 // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
     131: astore        11
     133: goto          145
     136: ldc           #29                 // String X.509
     138: aload         10
     140: invokestatic  #31                 // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
     143: astore        11
     145: aload         11
     147: aload         8
     149: invokevirtual #32                 // Method java/security/cert/CertificateFactory.generateCertificate:(Ljava/io/InputStream;)Ljava/security/cert/Certificate;
     152: checkcast     #33                 // class java/security/cert/X509Certificate
     155: astore        12
     157: iconst_1
     158: anewarray     #33                 // class java/security/cert/X509Certificate
     161: astore        9
     163: aload         9
     165: iconst_0
     166: aload         12
     168: aastore
     169: goto          233
     172: astore        11
     174: getstatic     #35                 // Field log:Lorg/apache/juli/logging/Log;
     177: getstatic     #36                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     180: ldc           #37                 // String sslValve.certError
     182: iconst_1
     183: anewarray     #38                 // class java/lang/Object
     186: dup
     187: iconst_0
     188: aload         7
     190: aastore
     191: invokevirtual #39                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     194: aload         11
     196: invokeinterface #40,  3           // InterfaceMethod org/apache/juli/logging/Log.warn:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     201: goto          233
     204: astore        11
     206: getstatic     #35                 // Field log:Lorg/apache/juli/logging/Log;
     209: getstatic     #36                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     212: ldc           #42                 // String sslValve.invalidProvider
     214: iconst_1
     215: anewarray     #38                 // class java/lang/Object
     218: dup
     219: iconst_0
     220: aload         10
     222: aastore
     223: invokevirtual #39                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     226: aload         11
     228: invokeinterface #43,  3           // InterfaceMethod org/apache/juli/logging/Log.error:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     233: aload_1
     234: ldc           #44                 // String javax.servlet.request.X509Certificate
     236: aload         9
     238: invokevirtual #45                 // Method org/apache/catalina/connector/Request.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
     241: aload_0
     242: aload_1
     243: aload_0
     244: getfield      #5                  // Field sslCipherHeader:Ljava/lang/String;
     247: invokevirtual #13                 // Method mygetHeader:(Lorg/apache/catalina/connector/Request;Ljava/lang/String;)Ljava/lang/String;
     250: astore_3
     251: aload_3
     252: ifnull        262
     255: aload_1
     256: ldc           #46                 // String javax.servlet.request.cipher_suite
     258: aload_3
     259: invokevirtual #45                 // Method org/apache/catalina/connector/Request.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
     262: aload_0
     263: aload_1
     264: aload_0
     265: getfield      #7                  // Field sslSessionIdHeader:Ljava/lang/String;
     268: invokevirtual #13                 // Method mygetHeader:(Lorg/apache/catalina/connector/Request;Ljava/lang/String;)Ljava/lang/String;
     271: astore_3
     272: aload_3
     273: ifnull        283
     276: aload_1
     277: ldc           #47                 // String javax.servlet.request.ssl_session_id
     279: aload_3
     280: invokevirtual #45                 // Method org/apache/catalina/connector/Request.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
     283: aload_0
     284: aload_1
     285: aload_0
     286: getfield      #9                  // Field sslCipherUserKeySizeHeader:Ljava/lang/String;
     289: invokevirtual #13                 // Method mygetHeader:(Lorg/apache/catalina/connector/Request;Ljava/lang/String;)Ljava/lang/String;
     292: astore_3
     293: aload_3
     294: ifnull        307
     297: aload_1
     298: ldc           #48                 // String javax.servlet.request.key_size
     300: aload_3
     301: invokestatic  #49                 // Method java/lang/Integer.valueOf:(Ljava/lang/String;)Ljava/lang/Integer;
     304: invokevirtual #45                 // Method org/apache/catalina/connector/Request.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
     307: aload_0
     308: invokevirtual #50                 // Method getNext:()Lorg/apache/catalina/Valve;
     311: aload_1
     312: aload_2
     313: invokeinterface #51,  3           // InterfaceMethod org/apache/catalina/Valve.invoke:(Lorg/apache/catalina/connector/Request;Lorg/apache/catalina/connector/Response;)V
     318: return
    Exception table:
       from    to  target type
         121   169   172   Class java/security/cert/CertificateException
         121   169   204   Class java/security/NoSuchProviderException

  static {};
    Code:
       0: ldc_w         #52                 // class org/apache/catalina/valves/SSLValve
       3: invokestatic  #53                 // Method org/apache/juli/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/juli/logging/Log;
       6: putstatic     #35                 // Field log:Lorg/apache/juli/logging/Log;
       9: return
}
