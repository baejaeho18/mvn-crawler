Compiled from "SecurityListener.java"
public class org.apache.catalina.security.SecurityListener implements org.apache.catalina.LifecycleListener {
  private static final org.apache.juli.logging.Log log;

  private static final org.apache.tomcat.util.res.StringManager sm;

  private static final java.lang.String UMASK_PROPERTY_NAME;

  private static final java.lang.String UMASK_FORMAT;

  private final java.util.Set<java.lang.String> checkedOsUsers;

  private java.lang.Integer minimumUmask;

  public org.apache.catalina.security.SecurityListener();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/HashSet
       8: dup
       9: invokespecial #3                  // Method java/util/HashSet."<init>":()V
      12: putfield      #4                  // Field checkedOsUsers:Ljava/util/Set;
      15: aload_0
      16: bipush        7
      18: invokestatic  #5                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      21: putfield      #6                  // Field minimumUmask:Ljava/lang/Integer;
      24: aload_0
      25: getfield      #4                  // Field checkedOsUsers:Ljava/util/Set;
      28: ldc           #7                  // String root
      30: invokeinterface #8,  2            // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      35: pop
      36: return

  public void lifecycleEvent(org.apache.catalina.LifecycleEvent);
    Code:
       0: aload_1
       1: invokevirtual #9                  // Method org/apache/catalina/LifecycleEvent.getType:()Ljava/lang/String;
       4: ldc           #10                 // String before_init
       6: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       9: ifeq          16
      12: aload_0
      13: invokevirtual #12                 // Method doChecks:()V
      16: return

  public void setCheckedOsUsers(java.lang.String);
    Code:
       0: aload_1
       1: ifnull        11
       4: aload_1
       5: invokevirtual #13                 // Method java/lang/String.length:()I
       8: ifne          23
      11: aload_0
      12: getfield      #4                  // Field checkedOsUsers:Ljava/util/Set;
      15: invokeinterface #14,  1           // InterfaceMethod java/util/Set.clear:()V
      20: goto          84
      23: aload_1
      24: ldc           #15                 // String ,
      26: invokevirtual #16                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
      29: astore_2
      30: aload_2
      31: astore_3
      32: aload_3
      33: arraylength
      34: istore        4
      36: iconst_0
      37: istore        5
      39: iload         5
      41: iload         4
      43: if_icmpge     84
      46: aload_3
      47: iload         5
      49: aaload
      50: astore        6
      52: aload         6
      54: invokevirtual #13                 // Method java/lang/String.length:()I
      57: ifle          78
      60: aload_0
      61: getfield      #4                  // Field checkedOsUsers:Ljava/util/Set;
      64: aload         6
      66: invokestatic  #17                 // Method java/util/Locale.getDefault:()Ljava/util/Locale;
      69: invokevirtual #18                 // Method java/lang/String.toLowerCase:(Ljava/util/Locale;)Ljava/lang/String;
      72: invokeinterface #8,  2            // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      77: pop
      78: iinc          5, 1
      81: goto          39
      84: return

  public java.lang.String getCheckedOsUsers();
    Code:
       0: aload_0
       1: getfield      #4                  // Field checkedOsUsers:Ljava/util/Set;
       4: invokestatic  #19                 // Method org/apache/tomcat/util/buf/StringUtils.join:(Ljava/util/Collection;)Ljava/lang/String;
       7: areturn

  public void setMinimumUmask(java.lang.String);
    Code:
       0: aload_1
       1: ifnull        11
       4: aload_1
       5: invokevirtual #13                 // Method java/lang/String.length:()I
       8: ifne          22
      11: aload_0
      12: iconst_0
      13: invokestatic  #5                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      16: putfield      #6                  // Field minimumUmask:Ljava/lang/Integer;
      19: goto          32
      22: aload_0
      23: aload_1
      24: bipush        8
      26: invokestatic  #20                 // Method java/lang/Integer.valueOf:(Ljava/lang/String;I)Ljava/lang/Integer;
      29: putfield      #6                  // Field minimumUmask:Ljava/lang/Integer;
      32: return

  public java.lang.String getMinimumUmask();
    Code:
       0: ldc           #21                 // String %04o
       2: iconst_1
       3: anewarray     #22                 // class java/lang/Object
       6: dup
       7: iconst_0
       8: aload_0
       9: getfield      #6                  // Field minimumUmask:Ljava/lang/Integer;
      12: aastore
      13: invokestatic  #23                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      16: areturn

  protected void doChecks();
    Code:
       0: aload_0
       1: invokevirtual #24                 // Method checkOsUser:()V
       4: aload_0
       5: invokevirtual #25                 // Method checkUmask:()V
       8: return

  protected void checkOsUser();
    Code:
       0: ldc           #26                 // String user.name
       2: invokestatic  #27                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       5: astore_1
       6: aload_1
       7: ifnull        55
      10: aload_1
      11: invokestatic  #17                 // Method java/util/Locale.getDefault:()Ljava/util/Locale;
      14: invokevirtual #18                 // Method java/lang/String.toLowerCase:(Ljava/util/Locale;)Ljava/lang/String;
      17: astore_2
      18: aload_0
      19: getfield      #4                  // Field checkedOsUsers:Ljava/util/Set;
      22: aload_2
      23: invokeinterface #28,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      28: ifeq          55
      31: new           #29                 // class java/lang/Error
      34: dup
      35: getstatic     #30                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      38: ldc           #31                 // String SecurityListener.checkUserWarning
      40: iconst_1
      41: anewarray     #22                 // class java/lang/Object
      44: dup
      45: iconst_0
      46: aload_1
      47: aastore
      48: invokevirtual #32                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      51: invokespecial #33                 // Method java/lang/Error."<init>":(Ljava/lang/String;)V
      54: athrow
      55: return

  protected void checkUmask();
    Code:
       0: ldc           #34                 // String org.apache.catalina.security.SecurityListener.UMASK
       2: invokestatic  #27                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       5: astore_1
       6: aconst_null
       7: astore_2
       8: aload_1
       9: ifnull        47
      12: aload_1
      13: bipush        8
      15: invokestatic  #20                 // Method java/lang/Integer.valueOf:(Ljava/lang/String;I)Ljava/lang/Integer;
      18: astore_2
      19: goto          47
      22: astore_3
      23: getstatic     #36                 // Field log:Lorg/apache/juli/logging/Log;
      26: getstatic     #30                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      29: ldc           #37                 // String SecurityListener.checkUmaskParseFail
      31: iconst_1
      32: anewarray     #22                 // class java/lang/Object
      35: dup
      36: iconst_0
      37: aload_1
      38: aastore
      39: invokevirtual #32                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      42: invokeinterface #38,  2           // InterfaceMethod org/apache/juli/logging/Log.warn:(Ljava/lang/Object;)V
      47: aload_2
      48: ifnonnull     133
      51: ldc           #39                 // String \r\n
      53: invokestatic  #40                 // Method java/lang/System.lineSeparator:()Ljava/lang/String;
      56: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      59: ifeq          90
      62: getstatic     #36                 // Field log:Lorg/apache/juli/logging/Log;
      65: invokeinterface #41,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
      70: ifeq          89
      73: getstatic     #36                 // Field log:Lorg/apache/juli/logging/Log;
      76: getstatic     #30                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      79: ldc           #42                 // String SecurityListener.checkUmaskSkip
      81: invokevirtual #43                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      84: invokeinterface #44,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
      89: return
      90: aload_0
      91: getfield      #6                  // Field minimumUmask:Ljava/lang/Integer;
      94: invokevirtual #45                 // Method java/lang/Integer.intValue:()I
      97: ifle          132
     100: getstatic     #36                 // Field log:Lorg/apache/juli/logging/Log;
     103: getstatic     #30                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     106: ldc           #46                 // String SecurityListener.checkUmaskNone
     108: iconst_2
     109: anewarray     #22                 // class java/lang/Object
     112: dup
     113: iconst_0
     114: ldc           #34                 // String org.apache.catalina.security.SecurityListener.UMASK
     116: aastore
     117: dup
     118: iconst_1
     119: aload_0
     120: invokevirtual #47                 // Method getMinimumUmask:()Ljava/lang/String;
     123: aastore
     124: invokevirtual #32                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     127: invokeinterface #38,  2           // InterfaceMethod org/apache/juli/logging/Log.warn:(Ljava/lang/Object;)V
     132: return
     133: aload_2
     134: invokevirtual #45                 // Method java/lang/Integer.intValue:()I
     137: aload_0
     138: getfield      #6                  // Field minimumUmask:Ljava/lang/Integer;
     141: invokevirtual #45                 // Method java/lang/Integer.intValue:()I
     144: iand
     145: aload_0
     146: getfield      #6                  // Field minimumUmask:Ljava/lang/Integer;
     149: invokevirtual #45                 // Method java/lang/Integer.intValue:()I
     152: if_icmpeq     198
     155: new           #29                 // class java/lang/Error
     158: dup
     159: getstatic     #30                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     162: ldc           #48                 // String SecurityListener.checkUmaskFail
     164: iconst_2
     165: anewarray     #22                 // class java/lang/Object
     168: dup
     169: iconst_0
     170: ldc           #21                 // String %04o
     172: iconst_1
     173: anewarray     #22                 // class java/lang/Object
     176: dup
     177: iconst_0
     178: aload_2
     179: aastore
     180: invokestatic  #23                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     183: aastore
     184: dup
     185: iconst_1
     186: aload_0
     187: invokevirtual #47                 // Method getMinimumUmask:()Ljava/lang/String;
     190: aastore
     191: invokevirtual #32                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     194: invokespecial #33                 // Method java/lang/Error."<init>":(Ljava/lang/String;)V
     197: athrow
     198: return
    Exception table:
       from    to  target type
          12    19    22   Class java/lang/NumberFormatException

  static {};
    Code:
       0: ldc_w         #49                 // class org/apache/catalina/security/SecurityListener
       3: invokestatic  #50                 // Method org/apache/juli/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/juli/logging/Log;
       6: putstatic     #36                 // Field log:Lorg/apache/juli/logging/Log;
       9: ldc           #51                 // String org.apache.catalina.security
      11: invokestatic  #52                 // Method org/apache/tomcat/util/res/StringManager.getManager:(Ljava/lang/String;)Lorg/apache/tomcat/util/res/StringManager;
      14: putstatic     #30                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      17: return
}
