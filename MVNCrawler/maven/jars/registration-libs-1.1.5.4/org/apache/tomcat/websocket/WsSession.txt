Compiled from "WsSession.java"
public class org.apache.tomcat.websocket.WsSession implements javax.websocket.Session {
  private static final byte[] ELLIPSIS_BYTES;

  private static final int ELLIPSIS_BYTES_LEN;

  private static final org.apache.tomcat.util.res.StringManager sm;

  private static java.util.concurrent.atomic.AtomicLong ids;

  private final org.apache.juli.logging.Log log;

  private final javax.websocket.Endpoint localEndpoint;

  private final org.apache.tomcat.websocket.WsRemoteEndpointImplBase wsRemoteEndpoint;

  private final javax.websocket.RemoteEndpoint$Async remoteEndpointAsync;

  private final javax.websocket.RemoteEndpoint$Basic remoteEndpointBasic;

  private final java.lang.ClassLoader applicationClassLoader;

  private final org.apache.tomcat.websocket.WsWebSocketContainer webSocketContainer;

  private final java.net.URI requestUri;

  private final java.util.Map<java.lang.String, java.util.List<java.lang.String>> requestParameterMap;

  private final java.lang.String queryString;

  private final java.security.Principal userPrincipal;

  private final javax.websocket.EndpointConfig endpointConfig;

  private final java.util.List<javax.websocket.Extension> negotiatedExtensions;

  private final java.lang.String subProtocol;

  private final java.util.Map<java.lang.String, java.lang.String> pathParameters;

  private final boolean secure;

  private final java.lang.String httpSessionId;

  private final java.lang.String id;

  private volatile javax.websocket.MessageHandler textMessageHandler;

  private volatile javax.websocket.MessageHandler binaryMessageHandler;

  private volatile javax.websocket.MessageHandler$Whole<javax.websocket.PongMessage> pongMessageHandler;

  private volatile org.apache.tomcat.websocket.WsSession$State state;

  private final java.lang.Object stateLock;

  private final java.util.Map<java.lang.String, java.lang.Object> userProperties;

  private volatile int maxBinaryMessageBufferSize;

  private volatile int maxTextMessageBufferSize;

  private volatile long maxIdleTimeout;

  private volatile long lastActive;

  private java.util.Map<org.apache.tomcat.websocket.FutureToSendHandler, org.apache.tomcat.websocket.FutureToSendHandler> futures;

  private org.apache.tomcat.websocket.WsFrameBase wsFrame;

  public org.apache.tomcat.websocket.WsSession(javax.websocket.Endpoint, org.apache.tomcat.websocket.WsRemoteEndpointImplBase, org.apache.tomcat.websocket.WsWebSocketContainer, java.net.URI, java.util.Map<java.lang.String, java.util.List<java.lang.String>>, java.lang.String, java.security.Principal, java.lang.String, java.util.List<javax.websocket.Extension>, java.lang.String, java.util.Map<java.lang.String, java.lang.String>, boolean, javax.websocket.EndpointConfig) throws javax.websocket.DeploymentException;
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc_w         #2                  // class org/apache/tomcat/websocket/WsSession
       8: invokestatic  #3                  // Method org/apache/juli/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/juli/logging/Log;
      11: putfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      14: aload_0
      15: aconst_null
      16: putfield      #5                  // Field textMessageHandler:Ljavax/websocket/MessageHandler;
      19: aload_0
      20: aconst_null
      21: putfield      #6                  // Field binaryMessageHandler:Ljavax/websocket/MessageHandler;
      24: aload_0
      25: aconst_null
      26: putfield      #7                  // Field pongMessageHandler:Ljavax/websocket/MessageHandler$Whole;
      29: aload_0
      30: getstatic     #8                  // Field org/apache/tomcat/websocket/WsSession$State.OPEN:Lorg/apache/tomcat/websocket/WsSession$State;
      33: putfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
      36: aload_0
      37: new           #10                 // class java/lang/Object
      40: dup
      41: invokespecial #1                  // Method java/lang/Object."<init>":()V
      44: putfield      #11                 // Field stateLock:Ljava/lang/Object;
      47: aload_0
      48: new           #12                 // class java/util/concurrent/ConcurrentHashMap
      51: dup
      52: invokespecial #13                 // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      55: putfield      #14                 // Field userProperties:Ljava/util/Map;
      58: aload_0
      59: getstatic     #15                 // Field org/apache/tomcat/websocket/Constants.DEFAULT_BUFFER_SIZE:I
      62: putfield      #16                 // Field maxBinaryMessageBufferSize:I
      65: aload_0
      66: getstatic     #15                 // Field org/apache/tomcat/websocket/Constants.DEFAULT_BUFFER_SIZE:I
      69: putfield      #17                 // Field maxTextMessageBufferSize:I
      72: aload_0
      73: lconst_0
      74: putfield      #18                 // Field maxIdleTimeout:J
      77: aload_0
      78: invokestatic  #19                 // Method java/lang/System.currentTimeMillis:()J
      81: putfield      #20                 // Field lastActive:J
      84: aload_0
      85: new           #12                 // class java/util/concurrent/ConcurrentHashMap
      88: dup
      89: invokespecial #13                 // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      92: putfield      #21                 // Field futures:Ljava/util/Map;
      95: aload_0
      96: aload_1
      97: putfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
     100: aload_0
     101: aload_2
     102: putfield      #23                 // Field wsRemoteEndpoint:Lorg/apache/tomcat/websocket/WsRemoteEndpointImplBase;
     105: aload_0
     106: getfield      #23                 // Field wsRemoteEndpoint:Lorg/apache/tomcat/websocket/WsRemoteEndpointImplBase;
     109: aload_0
     110: invokevirtual #24                 // Method org/apache/tomcat/websocket/WsRemoteEndpointImplBase.setSession:(Lorg/apache/tomcat/websocket/WsSession;)V
     113: aload_0
     114: new           #25                 // class org/apache/tomcat/websocket/WsRemoteEndpointAsync
     117: dup
     118: aload_2
     119: invokespecial #26                 // Method org/apache/tomcat/websocket/WsRemoteEndpointAsync."<init>":(Lorg/apache/tomcat/websocket/WsRemoteEndpointImplBase;)V
     122: putfield      #27                 // Field remoteEndpointAsync:Ljavax/websocket/RemoteEndpoint$Async;
     125: aload_0
     126: new           #28                 // class org/apache/tomcat/websocket/WsRemoteEndpointBasic
     129: dup
     130: aload_2
     131: invokespecial #29                 // Method org/apache/tomcat/websocket/WsRemoteEndpointBasic."<init>":(Lorg/apache/tomcat/websocket/WsRemoteEndpointImplBase;)V
     134: putfield      #30                 // Field remoteEndpointBasic:Ljavax/websocket/RemoteEndpoint$Basic;
     137: aload_0
     138: aload_3
     139: putfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
     142: aload_0
     143: invokestatic  #32                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     146: invokevirtual #33                 // Method java/lang/Thread.getContextClassLoader:()Ljava/lang/ClassLoader;
     149: putfield      #34                 // Field applicationClassLoader:Ljava/lang/ClassLoader;
     152: aload_2
     153: aload_3
     154: invokevirtual #35                 // Method org/apache/tomcat/websocket/WsWebSocketContainer.getDefaultAsyncSendTimeout:()J
     157: invokevirtual #36                 // Method org/apache/tomcat/websocket/WsRemoteEndpointImplBase.setSendTimeout:(J)V
     160: aload_0
     161: aload_0
     162: getfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
     165: invokevirtual #37                 // Method org/apache/tomcat/websocket/WsWebSocketContainer.getDefaultMaxBinaryMessageBufferSize:()I
     168: putfield      #16                 // Field maxBinaryMessageBufferSize:I
     171: aload_0
     172: aload_0
     173: getfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
     176: invokevirtual #38                 // Method org/apache/tomcat/websocket/WsWebSocketContainer.getDefaultMaxTextMessageBufferSize:()I
     179: putfield      #17                 // Field maxTextMessageBufferSize:I
     182: aload_0
     183: aload_0
     184: getfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
     187: invokevirtual #39                 // Method org/apache/tomcat/websocket/WsWebSocketContainer.getDefaultMaxSessionIdleTimeout:()J
     190: putfield      #18                 // Field maxIdleTimeout:J
     193: aload_0
     194: aload         4
     196: putfield      #40                 // Field requestUri:Ljava/net/URI;
     199: aload         5
     201: ifnonnull     214
     204: aload_0
     205: invokestatic  #41                 // Method java/util/Collections.emptyMap:()Ljava/util/Map;
     208: putfield      #42                 // Field requestParameterMap:Ljava/util/Map;
     211: goto          220
     214: aload_0
     215: aload         5
     217: putfield      #42                 // Field requestParameterMap:Ljava/util/Map;
     220: aload_0
     221: aload         6
     223: putfield      #43                 // Field queryString:Ljava/lang/String;
     226: aload_0
     227: aload         7
     229: putfield      #44                 // Field userPrincipal:Ljava/security/Principal;
     232: aload_0
     233: aload         8
     235: putfield      #45                 // Field httpSessionId:Ljava/lang/String;
     238: aload_0
     239: aload         9
     241: putfield      #46                 // Field negotiatedExtensions:Ljava/util/List;
     244: aload         10
     246: ifnonnull     258
     249: aload_0
     250: ldc           #47                 // String
     252: putfield      #48                 // Field subProtocol:Ljava/lang/String;
     255: goto          264
     258: aload_0
     259: aload         10
     261: putfield      #48                 // Field subProtocol:Ljava/lang/String;
     264: aload_0
     265: aload         11
     267: putfield      #49                 // Field pathParameters:Ljava/util/Map;
     270: aload_0
     271: iload         12
     273: putfield      #50                 // Field secure:Z
     276: aload_0
     277: getfield      #23                 // Field wsRemoteEndpoint:Lorg/apache/tomcat/websocket/WsRemoteEndpointImplBase;
     280: aload         13
     282: invokevirtual #51                 // Method org/apache/tomcat/websocket/WsRemoteEndpointImplBase.setEncoders:(Ljavax/websocket/EndpointConfig;)V
     285: aload_0
     286: aload         13
     288: putfield      #52                 // Field endpointConfig:Ljavax/websocket/EndpointConfig;
     291: aload_0
     292: getfield      #14                 // Field userProperties:Ljava/util/Map;
     295: aload         13
     297: invokeinterface #53,  1           // InterfaceMethod javax/websocket/EndpointConfig.getUserProperties:()Ljava/util/Map;
     302: invokeinterface #54,  2           // InterfaceMethod java/util/Map.putAll:(Ljava/util/Map;)V
     307: aload_0
     308: getstatic     #55                 // Field ids:Ljava/util/concurrent/atomic/AtomicLong;
     311: invokevirtual #56                 // Method java/util/concurrent/atomic/AtomicLong.getAndIncrement:()J
     314: invokestatic  #57                 // Method java/lang/Long.toHexString:(J)Ljava/lang/String;
     317: putfield      #58                 // Field id:Ljava/lang/String;
     320: aload_0
     321: getfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
     324: invokevirtual #59                 // Method org/apache/tomcat/websocket/WsWebSocketContainer.getInstanceManager:()Lorg/apache/tomcat/InstanceManager;
     327: astore        14
     329: aload         14
     331: ifnonnull     343
     334: aload_0
     335: getfield      #34                 // Field applicationClassLoader:Ljava/lang/ClassLoader;
     338: invokestatic  #60                 // Method org/apache/tomcat/InstanceManagerBindings.get:(Ljava/lang/ClassLoader;)Lorg/apache/tomcat/InstanceManager;
     341: astore        14
     343: aload         14
     345: ifnull        379
     348: aload         14
     350: aload_1
     351: invokeinterface #61,  2           // InterfaceMethod org/apache/tomcat/InstanceManager.newInstance:(Ljava/lang/Object;)V
     356: goto          379
     359: astore        15
     361: new           #63                 // class javax/websocket/DeploymentException
     364: dup
     365: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     368: ldc           #65                 // String wsSession.instanceNew
     370: invokevirtual #66                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     373: aload         15
     375: invokespecial #67                 // Method javax/websocket/DeploymentException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     378: athrow
     379: aload_0
     380: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     383: invokeinterface #68,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     388: ifeq          419
     391: aload_0
     392: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     395: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     398: ldc           #69                 // String wsSession.created
     400: iconst_1
     401: anewarray     #10                 // class java/lang/Object
     404: dup
     405: iconst_0
     406: aload_0
     407: getfield      #58                 // Field id:Ljava/lang/String;
     410: aastore
     411: invokevirtual #70                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     414: invokeinterface #71,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     419: return
    Exception table:
       from    to  target type
         348   356   359   Class java/lang/Exception

  public javax.websocket.WebSocketContainer getContainer();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
       8: areturn

  public void addMessageHandler(javax.websocket.MessageHandler);
    Code:
       0: aload_1
       1: invokestatic  #73                 // Method org/apache/tomcat/websocket/Util.getMessageType:(Ljavax/websocket/MessageHandler;)Ljava/lang/Class;
       4: astore_2
       5: aload_0
       6: aload_2
       7: aload_1
       8: invokespecial #74                 // Method doAddMessageHandler:(Ljava/lang/Class;Ljavax/websocket/MessageHandler;)V
      11: return

  public <T> void addMessageHandler(java.lang.Class<T>, javax.websocket.MessageHandler$Partial<T>) throws java.lang.IllegalStateException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #74                 // Method doAddMessageHandler:(Ljava/lang/Class;Ljavax/websocket/MessageHandler;)V
       6: return

  public <T> void addMessageHandler(java.lang.Class<T>, javax.websocket.MessageHandler$Whole<T>) throws java.lang.IllegalStateException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #74                 // Method doAddMessageHandler:(Ljava/lang/Class;Ljavax/websocket/MessageHandler;)V
       6: return

  private void doAddMessageHandler(java.lang.Class<?>, javax.websocket.MessageHandler);
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_1
       5: aload_2
       6: aload_0
       7: getfield      #52                 // Field endpointConfig:Ljavax/websocket/EndpointConfig;
      10: aload_0
      11: invokestatic  #75                 // Method org/apache/tomcat/websocket/Util.getMessageHandlers:(Ljava/lang/Class;Ljavax/websocket/MessageHandler;Ljavax/websocket/EndpointConfig;Ljavax/websocket/Session;)Ljava/util/Set;
      14: astore_3
      15: aload_3
      16: invokeinterface #76,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      21: astore        4
      23: aload         4
      25: invokeinterface #77,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      30: ifeq          255
      33: aload         4
      35: invokeinterface #78,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      40: checkcast     #79                 // class org/apache/tomcat/websocket/MessageHandlerResult
      43: astore        5
      45: getstatic     #80                 // Field org/apache/tomcat/websocket/WsSession$1.$SwitchMap$org$apache$tomcat$websocket$MessageHandlerResultType:[I
      48: aload         5
      50: invokevirtual #81                 // Method org/apache/tomcat/websocket/MessageHandlerResult.getType:()Lorg/apache/tomcat/websocket/MessageHandlerResultType;
      53: invokevirtual #82                 // Method org/apache/tomcat/websocket/MessageHandlerResultType.ordinal:()I
      56: iaload
      57: tableswitch   { // 1 to 3
                     1: 84
                     2: 119
                     3: 154
               default: 220
          }
      84: aload_0
      85: getfield      #5                  // Field textMessageHandler:Ljavax/websocket/MessageHandler;
      88: ifnull        107
      91: new           #83                 // class java/lang/IllegalStateException
      94: dup
      95: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      98: ldc           #84                 // String wsSession.duplicateHandlerText
     100: invokevirtual #66                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     103: invokespecial #85                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     106: athrow
     107: aload_0
     108: aload         5
     110: invokevirtual #86                 // Method org/apache/tomcat/websocket/MessageHandlerResult.getHandler:()Ljavax/websocket/MessageHandler;
     113: putfield      #5                  // Field textMessageHandler:Ljavax/websocket/MessageHandler;
     116: goto          252
     119: aload_0
     120: getfield      #6                  // Field binaryMessageHandler:Ljavax/websocket/MessageHandler;
     123: ifnull        142
     126: new           #83                 // class java/lang/IllegalStateException
     129: dup
     130: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     133: ldc           #87                 // String wsSession.duplicateHandlerBinary
     135: invokevirtual #66                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     138: invokespecial #85                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     141: athrow
     142: aload_0
     143: aload         5
     145: invokevirtual #86                 // Method org/apache/tomcat/websocket/MessageHandlerResult.getHandler:()Ljavax/websocket/MessageHandler;
     148: putfield      #6                  // Field binaryMessageHandler:Ljavax/websocket/MessageHandler;
     151: goto          252
     154: aload_0
     155: getfield      #7                  // Field pongMessageHandler:Ljavax/websocket/MessageHandler$Whole;
     158: ifnull        177
     161: new           #83                 // class java/lang/IllegalStateException
     164: dup
     165: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     168: ldc           #88                 // String wsSession.duplicateHandlerPong
     170: invokevirtual #66                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     173: invokespecial #85                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     176: athrow
     177: aload         5
     179: invokevirtual #86                 // Method org/apache/tomcat/websocket/MessageHandlerResult.getHandler:()Ljavax/websocket/MessageHandler;
     182: astore        6
     184: aload         6
     186: instanceof    #89                 // class javax/websocket/MessageHandler$Whole
     189: ifeq          204
     192: aload_0
     193: aload         6
     195: checkcast     #89                 // class javax/websocket/MessageHandler$Whole
     198: putfield      #7                  // Field pongMessageHandler:Ljavax/websocket/MessageHandler$Whole;
     201: goto          252
     204: new           #83                 // class java/lang/IllegalStateException
     207: dup
     208: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     211: ldc           #90                 // String wsSession.invalidHandlerTypePong
     213: invokevirtual #66                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     216: invokespecial #85                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     219: athrow
     220: new           #91                 // class java/lang/IllegalArgumentException
     223: dup
     224: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     227: ldc           #92                 // String wsSession.unknownHandlerType
     229: iconst_2
     230: anewarray     #10                 // class java/lang/Object
     233: dup
     234: iconst_0
     235: aload_2
     236: aastore
     237: dup
     238: iconst_1
     239: aload         5
     241: invokevirtual #81                 // Method org/apache/tomcat/websocket/MessageHandlerResult.getType:()Lorg/apache/tomcat/websocket/MessageHandlerResultType;
     244: aastore
     245: invokevirtual #70                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     248: invokespecial #93                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     251: athrow
     252: goto          23
     255: return

  public java.util.Set<javax.websocket.MessageHandler> getMessageHandlers();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: new           #94                 // class java/util/HashSet
       7: dup
       8: invokespecial #95                 // Method java/util/HashSet."<init>":()V
      11: astore_1
      12: aload_0
      13: getfield      #6                  // Field binaryMessageHandler:Ljavax/websocket/MessageHandler;
      16: ifnull        30
      19: aload_1
      20: aload_0
      21: getfield      #6                  // Field binaryMessageHandler:Ljavax/websocket/MessageHandler;
      24: invokeinterface #96,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      29: pop
      30: aload_0
      31: getfield      #5                  // Field textMessageHandler:Ljavax/websocket/MessageHandler;
      34: ifnull        48
      37: aload_1
      38: aload_0
      39: getfield      #5                  // Field textMessageHandler:Ljavax/websocket/MessageHandler;
      42: invokeinterface #96,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      47: pop
      48: aload_0
      49: getfield      #7                  // Field pongMessageHandler:Ljavax/websocket/MessageHandler$Whole;
      52: ifnull        66
      55: aload_1
      56: aload_0
      57: getfield      #7                  // Field pongMessageHandler:Ljavax/websocket/MessageHandler$Whole;
      60: invokeinterface #96,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      65: pop
      66: aload_1
      67: areturn

  public void removeMessageHandler(javax.websocket.MessageHandler);
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_1
       5: ifnonnull     9
       8: return
       9: aconst_null
      10: astore_2
      11: aload_1
      12: instanceof    #97                 // class org/apache/tomcat/websocket/WrappedMessageHandler
      15: ifeq          28
      18: aload_1
      19: checkcast     #97                 // class org/apache/tomcat/websocket/WrappedMessageHandler
      22: invokeinterface #98,  1           // InterfaceMethod org/apache/tomcat/websocket/WrappedMessageHandler.getWrappedHandler:()Ljavax/websocket/MessageHandler;
      27: astore_2
      28: aload_2
      29: ifnonnull     34
      32: aload_1
      33: astore_2
      34: iconst_0
      35: istore_3
      36: aload_2
      37: aload_0
      38: getfield      #5                  // Field textMessageHandler:Ljavax/websocket/MessageHandler;
      41: invokevirtual #99                 // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
      44: ifne          58
      47: aload_1
      48: aload_0
      49: getfield      #5                  // Field textMessageHandler:Ljavax/websocket/MessageHandler;
      52: invokevirtual #99                 // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
      55: ifeq          65
      58: aload_0
      59: aconst_null
      60: putfield      #5                  // Field textMessageHandler:Ljavax/websocket/MessageHandler;
      63: iconst_1
      64: istore_3
      65: aload_2
      66: aload_0
      67: getfield      #6                  // Field binaryMessageHandler:Ljavax/websocket/MessageHandler;
      70: invokevirtual #99                 // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
      73: ifne          87
      76: aload_1
      77: aload_0
      78: getfield      #6                  // Field binaryMessageHandler:Ljavax/websocket/MessageHandler;
      81: invokevirtual #99                 // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
      84: ifeq          94
      87: aload_0
      88: aconst_null
      89: putfield      #6                  // Field binaryMessageHandler:Ljavax/websocket/MessageHandler;
      92: iconst_1
      93: istore_3
      94: aload_2
      95: aload_0
      96: getfield      #7                  // Field pongMessageHandler:Ljavax/websocket/MessageHandler$Whole;
      99: invokevirtual #99                 // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
     102: ifne          116
     105: aload_1
     106: aload_0
     107: getfield      #7                  // Field pongMessageHandler:Ljavax/websocket/MessageHandler$Whole;
     110: invokevirtual #99                 // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
     113: ifeq          123
     116: aload_0
     117: aconst_null
     118: putfield      #7                  // Field pongMessageHandler:Ljavax/websocket/MessageHandler$Whole;
     121: iconst_1
     122: istore_3
     123: iload_3
     124: ifne          151
     127: new           #83                 // class java/lang/IllegalStateException
     130: dup
     131: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     134: ldc           #100                // String wsSession.removeHandlerFailed
     136: iconst_1
     137: anewarray     #10                 // class java/lang/Object
     140: dup
     141: iconst_0
     142: aload_1
     143: aastore
     144: invokevirtual #70                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     147: invokespecial #85                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     150: athrow
     151: return

  public java.lang.String getProtocolVersion();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: ldc           #101                // String 13
       6: areturn

  public java.lang.String getNegotiatedSubprotocol();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #48                 // Field subProtocol:Ljava/lang/String;
       8: areturn

  public java.util.List<javax.websocket.Extension> getNegotiatedExtensions();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #46                 // Field negotiatedExtensions:Ljava/util/List;
       8: areturn

  public boolean isSecure();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #50                 // Field secure:Z
       8: ireturn

  public boolean isOpen();
    Code:
       0: aload_0
       1: getfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
       4: getstatic     #8                  // Field org/apache/tomcat/websocket/WsSession$State.OPEN:Lorg/apache/tomcat/websocket/WsSession$State;
       7: if_acmpne     14
      10: iconst_1
      11: goto          15
      14: iconst_0
      15: ireturn

  public long getMaxIdleTimeout();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #18                 // Field maxIdleTimeout:J
       8: lreturn

  public void setMaxIdleTimeout(long);
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: lload_1
       6: putfield      #18                 // Field maxIdleTimeout:J
       9: return

  public void setMaxBinaryMessageBufferSize(int);
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: iload_1
       6: putfield      #16                 // Field maxBinaryMessageBufferSize:I
       9: return

  public int getMaxBinaryMessageBufferSize();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #16                 // Field maxBinaryMessageBufferSize:I
       8: ireturn

  public void setMaxTextMessageBufferSize(int);
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: iload_1
       6: putfield      #17                 // Field maxTextMessageBufferSize:I
       9: return

  public int getMaxTextMessageBufferSize();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #17                 // Field maxTextMessageBufferSize:I
       8: ireturn

  public java.util.Set<javax.websocket.Session> getOpenSessions();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
       8: aload_0
       9: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
      12: invokevirtual #102                // Method org/apache/tomcat/websocket/WsWebSocketContainer.getOpenSessions:(Ljavax/websocket/Endpoint;)Ljava/util/Set;
      15: areturn

  public javax.websocket.RemoteEndpoint$Async getAsyncRemote();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #27                 // Field remoteEndpointAsync:Ljavax/websocket/RemoteEndpoint$Async;
       8: areturn

  public javax.websocket.RemoteEndpoint$Basic getBasicRemote();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #30                 // Field remoteEndpointBasic:Ljavax/websocket/RemoteEndpoint$Basic;
       8: areturn

  public void close() throws java.io.IOException;
    Code:
       0: aload_0
       1: new           #103                // class javax/websocket/CloseReason
       4: dup
       5: getstatic     #104                // Field javax/websocket/CloseReason$CloseCodes.NORMAL_CLOSURE:Ljavax/websocket/CloseReason$CloseCodes;
       8: ldc           #47                 // String
      10: invokespecial #105                // Method javax/websocket/CloseReason."<init>":(Ljavax/websocket/CloseReason$CloseCode;Ljava/lang/String;)V
      13: invokevirtual #106                // Method close:(Ljavax/websocket/CloseReason;)V
      16: return

  public void close(javax.websocket.CloseReason) throws java.io.IOException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_1
       3: invokevirtual #107                // Method doClose:(Ljavax/websocket/CloseReason;Ljavax/websocket/CloseReason;)V
       6: return

  public void doClose(javax.websocket.CloseReason, javax.websocket.CloseReason);
    Code:
       0: aload_0
       1: getfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
       4: getstatic     #8                  // Field org/apache/tomcat/websocket/WsSession$State.OPEN:Lorg/apache/tomcat/websocket/WsSession$State;
       7: if_acmpeq     11
      10: return
      11: aload_0
      12: getfield      #11                 // Field stateLock:Ljava/lang/Object;
      15: dup
      16: astore_3
      17: monitorenter
      18: aload_0
      19: getfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
      22: getstatic     #8                  // Field org/apache/tomcat/websocket/WsSession$State.OPEN:Lorg/apache/tomcat/websocket/WsSession$State;
      25: if_acmpeq     31
      28: aload_3
      29: monitorexit
      30: return
      31: aload_0
      32: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      35: invokeinterface #68,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
      40: ifeq          71
      43: aload_0
      44: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      47: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      50: ldc           #108                // String wsSession.doClose
      52: iconst_1
      53: anewarray     #10                 // class java/lang/Object
      56: dup
      57: iconst_0
      58: aload_0
      59: getfield      #58                 // Field id:Ljava/lang/String;
      62: aastore
      63: invokevirtual #70                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      66: invokeinterface #71,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
      71: aload_0
      72: getfield      #23                 // Field wsRemoteEndpoint:Lorg/apache/tomcat/websocket/WsRemoteEndpointImplBase;
      75: iconst_0
      76: invokevirtual #109                // Method org/apache/tomcat/websocket/WsRemoteEndpointImplBase.setBatchingAllowed:(Z)V
      79: goto          109
      82: astore        4
      84: aload_0
      85: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      88: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      91: ldc           #111                // String wsSession.flushFailOnClose
      93: invokevirtual #66                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      96: aload         4
      98: invokeinterface #112,  3          // InterfaceMethod org/apache/juli/logging/Log.warn:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     103: aload_0
     104: aload         4
     106: invokespecial #113                // Method fireEndpointOnError:(Ljava/lang/Throwable;)V
     109: aload_0
     110: getstatic     #114                // Field org/apache/tomcat/websocket/WsSession$State.OUTPUT_CLOSED:Lorg/apache/tomcat/websocket/WsSession$State;
     113: putfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
     116: aload_0
     117: aload_1
     118: invokespecial #115                // Method sendCloseMessage:(Ljavax/websocket/CloseReason;)V
     121: aload_0
     122: aload_2
     123: invokespecial #116                // Method fireEndpointOnClose:(Ljavax/websocket/CloseReason;)V
     126: aload_3
     127: monitorexit
     128: goto          138
     131: astore        5
     133: aload_3
     134: monitorexit
     135: aload         5
     137: athrow
     138: new           #110                // class java/io/IOException
     141: dup
     142: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     145: ldc           #117                // String wsSession.messageFailed
     147: invokevirtual #66                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     150: invokespecial #118                // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     153: astore_3
     154: new           #119                // class javax/websocket/SendResult
     157: dup
     158: aload_3
     159: invokespecial #120                // Method javax/websocket/SendResult."<init>":(Ljava/lang/Throwable;)V
     162: astore        4
     164: aload_0
     165: getfield      #21                 // Field futures:Ljava/util/Map;
     168: invokeinterface #121,  1          // InterfaceMethod java/util/Map.keySet:()Ljava/util/Set;
     173: invokeinterface #76,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     178: astore        5
     180: aload         5
     182: invokeinterface #77,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     187: ifeq          212
     190: aload         5
     192: invokeinterface #78,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     197: checkcast     #122                // class org/apache/tomcat/websocket/FutureToSendHandler
     200: astore        6
     202: aload         6
     204: aload         4
     206: invokevirtual #123                // Method org/apache/tomcat/websocket/FutureToSendHandler.onResult:(Ljavax/websocket/SendResult;)V
     209: goto          180
     212: return
    Exception table:
       from    to  target type
          71    79    82   Class java/io/IOException
          18    30   131   any
          31   128   131   any
         131   135   131   any

  public void onClose(javax.websocket.CloseReason);
    Code:
       0: aload_0
       1: getfield      #11                 // Field stateLock:Ljava/lang/Object;
       4: dup
       5: astore_2
       6: monitorenter
       7: aload_0
       8: getfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
      11: getstatic     #124                // Field org/apache/tomcat/websocket/WsSession$State.CLOSED:Lorg/apache/tomcat/websocket/WsSession$State;
      14: if_acmpeq     93
      17: aload_0
      18: getfield      #23                 // Field wsRemoteEndpoint:Lorg/apache/tomcat/websocket/WsRemoteEndpointImplBase;
      21: iconst_0
      22: invokevirtual #109                // Method org/apache/tomcat/websocket/WsRemoteEndpointImplBase.setBatchingAllowed:(Z)V
      25: goto          52
      28: astore_3
      29: aload_0
      30: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      33: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      36: ldc           #111                // String wsSession.flushFailOnClose
      38: invokevirtual #66                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      41: aload_3
      42: invokeinterface #112,  3          // InterfaceMethod org/apache/juli/logging/Log.warn:(Ljava/lang/Object;Ljava/lang/Throwable;)V
      47: aload_0
      48: aload_3
      49: invokespecial #113                // Method fireEndpointOnError:(Ljava/lang/Throwable;)V
      52: aload_0
      53: getfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
      56: getstatic     #8                  // Field org/apache/tomcat/websocket/WsSession$State.OPEN:Lorg/apache/tomcat/websocket/WsSession$State;
      59: if_acmpne     79
      62: aload_0
      63: getstatic     #114                // Field org/apache/tomcat/websocket/WsSession$State.OUTPUT_CLOSED:Lorg/apache/tomcat/websocket/WsSession$State;
      66: putfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
      69: aload_0
      70: aload_1
      71: invokespecial #115                // Method sendCloseMessage:(Ljavax/websocket/CloseReason;)V
      74: aload_0
      75: aload_1
      76: invokespecial #116                // Method fireEndpointOnClose:(Ljavax/websocket/CloseReason;)V
      79: aload_0
      80: getstatic     #124                // Field org/apache/tomcat/websocket/WsSession$State.CLOSED:Lorg/apache/tomcat/websocket/WsSession$State;
      83: putfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
      86: aload_0
      87: getfield      #23                 // Field wsRemoteEndpoint:Lorg/apache/tomcat/websocket/WsRemoteEndpointImplBase;
      90: invokevirtual #125                // Method org/apache/tomcat/websocket/WsRemoteEndpointImplBase.close:()V
      93: aload_2
      94: monitorexit
      95: goto          105
      98: astore        4
     100: aload_2
     101: monitorexit
     102: aload         4
     104: athrow
     105: return
    Exception table:
       from    to  target type
          17    25    28   Class java/io/IOException
           7    95    98   any
          98   102    98   any

  private void fireEndpointOnClose(javax.websocket.CloseReason);
    Code:
       0: aconst_null
       1: astore_2
       2: aload_0
       3: getfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
       6: invokevirtual #59                 // Method org/apache/tomcat/websocket/WsWebSocketContainer.getInstanceManager:()Lorg/apache/tomcat/InstanceManager;
       9: astore_3
      10: aload_3
      11: ifnonnull     22
      14: aload_0
      15: getfield      #34                 // Field applicationClassLoader:Ljava/lang/ClassLoader;
      18: invokestatic  #60                 // Method org/apache/tomcat/InstanceManagerBindings.get:(Ljava/lang/ClassLoader;)Lorg/apache/tomcat/InstanceManager;
      21: astore_3
      22: invokestatic  #32                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
      25: astore        4
      27: aload         4
      29: invokevirtual #33                 // Method java/lang/Thread.getContextClassLoader:()Ljava/lang/ClassLoader;
      32: astore        5
      34: aload         4
      36: aload_0
      37: getfield      #34                 // Field applicationClassLoader:Ljava/lang/ClassLoader;
      40: invokevirtual #126                // Method java/lang/Thread.setContextClassLoader:(Ljava/lang/ClassLoader;)V
      43: aload_0
      44: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
      47: aload_0
      48: aload_1
      49: invokevirtual #127                // Method javax/websocket/Endpoint.onClose:(Ljavax/websocket/Session;Ljavax/websocket/CloseReason;)V
      52: aload_3
      53: ifnull        83
      56: aload_3
      57: aload_0
      58: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
      61: invokeinterface #128,  2          // InterfaceMethod org/apache/tomcat/InstanceManager.destroyInstance:(Ljava/lang/Object;)V
      66: goto          83
      69: astore        6
      71: aload         6
      73: invokestatic  #130                // Method org/apache/tomcat/util/ExceptionUtils.handleThrowable:(Ljava/lang/Throwable;)V
      76: aload_2
      77: ifnonnull     83
      80: aload         6
      82: astore_2
      83: aload         4
      85: aload         5
      87: invokevirtual #126                // Method java/lang/Thread.setContextClassLoader:(Ljava/lang/ClassLoader;)V
      90: goto          187
      93: astore        6
      95: aload         6
      97: invokestatic  #130                // Method org/apache/tomcat/util/ExceptionUtils.handleThrowable:(Ljava/lang/Throwable;)V
     100: aload         6
     102: astore_2
     103: aload_3
     104: ifnull        134
     107: aload_3
     108: aload_0
     109: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
     112: invokeinterface #128,  2          // InterfaceMethod org/apache/tomcat/InstanceManager.destroyInstance:(Ljava/lang/Object;)V
     117: goto          134
     120: astore        6
     122: aload         6
     124: invokestatic  #130                // Method org/apache/tomcat/util/ExceptionUtils.handleThrowable:(Ljava/lang/Throwable;)V
     127: aload_2
     128: ifnonnull     134
     131: aload         6
     133: astore_2
     134: aload         4
     136: aload         5
     138: invokevirtual #126                // Method java/lang/Thread.setContextClassLoader:(Ljava/lang/ClassLoader;)V
     141: goto          187
     144: astore        7
     146: aload_3
     147: ifnull        177
     150: aload_3
     151: aload_0
     152: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
     155: invokeinterface #128,  2          // InterfaceMethod org/apache/tomcat/InstanceManager.destroyInstance:(Ljava/lang/Object;)V
     160: goto          177
     163: astore        8
     165: aload         8
     167: invokestatic  #130                // Method org/apache/tomcat/util/ExceptionUtils.handleThrowable:(Ljava/lang/Throwable;)V
     170: aload_2
     171: ifnonnull     177
     174: aload         8
     176: astore_2
     177: aload         4
     179: aload         5
     181: invokevirtual #126                // Method java/lang/Thread.setContextClassLoader:(Ljava/lang/ClassLoader;)V
     184: aload         7
     186: athrow
     187: aload_2
     188: ifnull        196
     191: aload_0
     192: aload_2
     193: invokespecial #113                // Method fireEndpointOnError:(Ljava/lang/Throwable;)V
     196: return
    Exception table:
       from    to  target type
          56    66    69   Class java/lang/Throwable
          43    52    93   Class java/lang/Throwable
         107   117   120   Class java/lang/Throwable
          43    52   144   any
          93   103   144   any
         150   160   163   Class java/lang/Throwable
         144   146   144   any

  private void fireEndpointOnError(java.lang.Throwable);
    Code:
       0: invokestatic  #32                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
       3: astore_2
       4: aload_2
       5: invokevirtual #33                 // Method java/lang/Thread.getContextClassLoader:()Ljava/lang/ClassLoader;
       8: astore_3
       9: aload_2
      10: aload_0
      11: getfield      #34                 // Field applicationClassLoader:Ljava/lang/ClassLoader;
      14: invokevirtual #126                // Method java/lang/Thread.setContextClassLoader:(Ljava/lang/ClassLoader;)V
      17: aload_0
      18: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
      21: aload_0
      22: aload_1
      23: invokevirtual #131                // Method javax/websocket/Endpoint.onError:(Ljavax/websocket/Session;Ljava/lang/Throwable;)V
      26: aload_2
      27: aload_3
      28: invokevirtual #126                // Method java/lang/Thread.setContextClassLoader:(Ljava/lang/ClassLoader;)V
      31: goto          44
      34: astore        4
      36: aload_2
      37: aload_3
      38: invokevirtual #126                // Method java/lang/Thread.setContextClassLoader:(Ljava/lang/ClassLoader;)V
      41: aload         4
      43: athrow
      44: return
    Exception table:
       from    to  target type
          17    26    34   any
          34    36    34   any

  private void sendCloseMessage(javax.websocket.CloseReason);
    Code:
       0: bipush        125
       2: invokestatic  #132                // Method java/nio/ByteBuffer.allocate:(I)Ljava/nio/ByteBuffer;
       5: astore_2
       6: aload_1
       7: invokevirtual #133                // Method javax/websocket/CloseReason.getCloseCode:()Ljavax/websocket/CloseReason$CloseCode;
      10: astore_3
      11: aload_3
      12: getstatic     #134                // Field javax/websocket/CloseReason$CloseCodes.CLOSED_ABNORMALLY:Ljavax/websocket/CloseReason$CloseCodes;
      15: if_acmpne     33
      18: aload_2
      19: getstatic     #135                // Field javax/websocket/CloseReason$CloseCodes.PROTOCOL_ERROR:Ljavax/websocket/CloseReason$CloseCodes;
      22: invokevirtual #136                // Method javax/websocket/CloseReason$CloseCodes.getCode:()I
      25: i2s
      26: invokevirtual #137                // Method java/nio/ByteBuffer.putShort:(S)Ljava/nio/ByteBuffer;
      29: pop
      30: goto          45
      33: aload_2
      34: aload_3
      35: invokeinterface #138,  1          // InterfaceMethod javax/websocket/CloseReason$CloseCode.getCode:()I
      40: i2s
      41: invokevirtual #137                // Method java/nio/ByteBuffer.putShort:(S)Ljava/nio/ByteBuffer;
      44: pop
      45: aload_1
      46: invokevirtual #139                // Method javax/websocket/CloseReason.getReasonPhrase:()Ljava/lang/String;
      49: astore        4
      51: aload         4
      53: ifnull        70
      56: aload         4
      58: invokevirtual #140                // Method java/lang/String.length:()I
      61: ifle          70
      64: aload_2
      65: aload         4
      67: invokestatic  #141                // Method appendCloseReasonWithTruncation:(Ljava/nio/ByteBuffer;Ljava/lang/String;)V
      70: aload_2
      71: invokevirtual #142                // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
      74: pop
      75: aload_0
      76: getfield      #23                 // Field wsRemoteEndpoint:Lorg/apache/tomcat/websocket/WsRemoteEndpointImplBase;
      79: bipush        8
      81: aload_2
      82: iconst_1
      83: invokevirtual #143                // Method org/apache/tomcat/websocket/WsRemoteEndpointImplBase.sendMessageBlock:(BLjava/nio/ByteBuffer;Z)V
      86: aload_0
      87: getfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
      90: aload_0
      91: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
      94: aload_0
      95: invokevirtual #144                // Method org/apache/tomcat/websocket/WsWebSocketContainer.unregisterSession:(Ljavax/websocket/Endpoint;Lorg/apache/tomcat/websocket/WsSession;)V
      98: goto          201
     101: astore        5
     103: aload_0
     104: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     107: invokeinterface #68,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     112: ifeq          145
     115: aload_0
     116: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     119: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     122: ldc           #146                // String wsSession.sendCloseFail
     124: iconst_1
     125: anewarray     #10                 // class java/lang/Object
     128: dup
     129: iconst_0
     130: aload_0
     131: getfield      #58                 // Field id:Ljava/lang/String;
     134: aastore
     135: invokevirtual #70                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     138: aload         5
     140: invokeinterface #147,  3          // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     145: aload_0
     146: getfield      #23                 // Field wsRemoteEndpoint:Lorg/apache/tomcat/websocket/WsRemoteEndpointImplBase;
     149: invokevirtual #125                // Method org/apache/tomcat/websocket/WsRemoteEndpointImplBase.close:()V
     152: aload_3
     153: getstatic     #134                // Field javax/websocket/CloseReason$CloseCodes.CLOSED_ABNORMALLY:Ljavax/websocket/CloseReason$CloseCodes;
     156: if_acmpeq     169
     159: aload_0
     160: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
     163: aload_0
     164: aload         5
     166: invokevirtual #131                // Method javax/websocket/Endpoint.onError:(Ljavax/websocket/Session;Ljava/lang/Throwable;)V
     169: aload_0
     170: getfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
     173: aload_0
     174: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
     177: aload_0
     178: invokevirtual #144                // Method org/apache/tomcat/websocket/WsWebSocketContainer.unregisterSession:(Ljavax/websocket/Endpoint;Lorg/apache/tomcat/websocket/WsSession;)V
     181: goto          201
     184: astore        6
     186: aload_0
     187: getfield      #31                 // Field webSocketContainer:Lorg/apache/tomcat/websocket/WsWebSocketContainer;
     190: aload_0
     191: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
     194: aload_0
     195: invokevirtual #144                // Method org/apache/tomcat/websocket/WsWebSocketContainer.unregisterSession:(Ljavax/websocket/Endpoint;Lorg/apache/tomcat/websocket/WsSession;)V
     198: aload         6
     200: athrow
     201: return
    Exception table:
       from    to  target type
          75    86   101   Class java/io/IOException
          75    86   101   Class java/nio/channels/WritePendingException
          75    86   184   any
         101   169   184   any
         184   186   184   any

  protected static void appendCloseReasonWithTruncation(java.nio.ByteBuffer, java.lang.String);
    Code:
       0: aload_1
       1: getstatic     #148                // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
       4: invokevirtual #149                // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
       7: astore_2
       8: aload_2
       9: arraylength
      10: bipush        123
      12: if_icmpgt     24
      15: aload_0
      16: aload_2
      17: invokevirtual #150                // Method java/nio/ByteBuffer.put:([B)Ljava/nio/ByteBuffer;
      20: pop
      21: goto          104
      24: bipush        123
      26: getstatic     #151                // Field ELLIPSIS_BYTES_LEN:I
      29: isub
      30: istore_3
      31: iconst_0
      32: istore        4
      34: aload_1
      35: iload         4
      37: iload         4
      39: iconst_1
      40: iadd
      41: invokevirtual #152                // Method java/lang/String.substring:(II)Ljava/lang/String;
      44: getstatic     #148                // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
      47: invokevirtual #149                // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
      50: astore        5
      52: iload_3
      53: aload         5
      55: arraylength
      56: if_icmplt     96
      59: aload_0
      60: aload         5
      62: invokevirtual #150                // Method java/nio/ByteBuffer.put:([B)Ljava/nio/ByteBuffer;
      65: pop
      66: iload_3
      67: aload         5
      69: arraylength
      70: isub
      71: istore_3
      72: iinc          4, 1
      75: aload_1
      76: iload         4
      78: iload         4
      80: iconst_1
      81: iadd
      82: invokevirtual #152                // Method java/lang/String.substring:(II)Ljava/lang/String;
      85: getstatic     #148                // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
      88: invokevirtual #149                // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
      91: astore        5
      93: goto          52
      96: aload_0
      97: getstatic     #153                // Field ELLIPSIS_BYTES:[B
     100: invokevirtual #150                // Method java/nio/ByteBuffer.put:([B)Ljava/nio/ByteBuffer;
     103: pop
     104: return

  protected void registerFuture(org.apache.tomcat.websocket.FutureToSendHandler);
    Code:
       0: aload_0
       1: getfield      #21                 // Field futures:Ljava/util/Map;
       4: aload_1
       5: aload_1
       6: invokeinterface #154,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      11: pop
      12: aload_0
      13: getfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
      16: getstatic     #8                  // Field org/apache/tomcat/websocket/WsSession$State.OPEN:Lorg/apache/tomcat/websocket/WsSession$State;
      19: if_acmpne     23
      22: return
      23: aload_1
      24: invokevirtual #155                // Method org/apache/tomcat/websocket/FutureToSendHandler.isDone:()Z
      27: ifeq          31
      30: return
      31: new           #110                // class java/io/IOException
      34: dup
      35: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      38: ldc           #117                // String wsSession.messageFailed
      40: invokevirtual #66                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      43: invokespecial #118                // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      46: astore_2
      47: new           #119                // class javax/websocket/SendResult
      50: dup
      51: aload_2
      52: invokespecial #120                // Method javax/websocket/SendResult."<init>":(Ljava/lang/Throwable;)V
      55: astore_3
      56: aload_1
      57: aload_3
      58: invokevirtual #123                // Method org/apache/tomcat/websocket/FutureToSendHandler.onResult:(Ljavax/websocket/SendResult;)V
      61: return

  protected void unregisterFuture(org.apache.tomcat.websocket.FutureToSendHandler);
    Code:
       0: aload_0
       1: getfield      #21                 // Field futures:Ljava/util/Map;
       4: aload_1
       5: invokeinterface #156,  2          // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      10: pop
      11: return

  public java.net.URI getRequestURI();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #40                 // Field requestUri:Ljava/net/URI;
       8: areturn

  public java.util.Map<java.lang.String, java.util.List<java.lang.String>> getRequestParameterMap();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #42                 // Field requestParameterMap:Ljava/util/Map;
       8: areturn

  public java.lang.String getQueryString();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #43                 // Field queryString:Ljava/lang/String;
       8: areturn

  public java.security.Principal getUserPrincipal();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #44                 // Field userPrincipal:Ljava/security/Principal;
       8: areturn

  public java.util.Map<java.lang.String, java.lang.String> getPathParameters();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #49                 // Field pathParameters:Ljava/util/Map;
       8: areturn

  public java.lang.String getId();
    Code:
       0: aload_0
       1: getfield      #58                 // Field id:Ljava/lang/String;
       4: areturn

  public java.util.Map<java.lang.String, java.lang.Object> getUserProperties();
    Code:
       0: aload_0
       1: invokespecial #72                 // Method checkState:()V
       4: aload_0
       5: getfield      #14                 // Field userProperties:Ljava/util/Map;
       8: areturn

  public javax.websocket.Endpoint getLocal();
    Code:
       0: aload_0
       1: getfield      #22                 // Field localEndpoint:Ljavax/websocket/Endpoint;
       4: areturn

  public java.lang.String getHttpSessionId();
    Code:
       0: aload_0
       1: getfield      #45                 // Field httpSessionId:Ljava/lang/String;
       4: areturn

  protected javax.websocket.MessageHandler getTextMessageHandler();
    Code:
       0: aload_0
       1: getfield      #5                  // Field textMessageHandler:Ljavax/websocket/MessageHandler;
       4: areturn

  protected javax.websocket.MessageHandler getBinaryMessageHandler();
    Code:
       0: aload_0
       1: getfield      #6                  // Field binaryMessageHandler:Ljavax/websocket/MessageHandler;
       4: areturn

  protected javax.websocket.MessageHandler$Whole<javax.websocket.PongMessage> getPongMessageHandler();
    Code:
       0: aload_0
       1: getfield      #7                  // Field pongMessageHandler:Ljavax/websocket/MessageHandler$Whole;
       4: areturn

  protected void updateLastActive();
    Code:
       0: aload_0
       1: invokestatic  #19                 // Method java/lang/System.currentTimeMillis:()J
       4: putfield      #20                 // Field lastActive:J
       7: return

  protected void checkExpiration();
    Code:
       0: aload_0
       1: getfield      #18                 // Field maxIdleTimeout:J
       4: lstore_1
       5: lload_1
       6: lconst_1
       7: lcmp
       8: ifge          12
      11: return
      12: invokestatic  #19                 // Method java/lang/System.currentTimeMillis:()J
      15: aload_0
      16: getfield      #20                 // Field lastActive:J
      19: lsub
      20: lload_1
      21: lcmp
      22: ifle          93
      25: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      28: ldc           #157                // String wsSession.timeout
      30: iconst_1
      31: anewarray     #10                 // class java/lang/Object
      34: dup
      35: iconst_0
      36: aload_0
      37: invokevirtual #158                // Method getId:()Ljava/lang/String;
      40: aastore
      41: invokevirtual #70                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      44: astore_3
      45: aload_0
      46: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      49: invokeinterface #68,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
      54: ifeq          67
      57: aload_0
      58: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      61: aload_3
      62: invokeinterface #71,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
      67: aload_0
      68: new           #103                // class javax/websocket/CloseReason
      71: dup
      72: getstatic     #159                // Field javax/websocket/CloseReason$CloseCodes.GOING_AWAY:Ljavax/websocket/CloseReason$CloseCodes;
      75: aload_3
      76: invokespecial #105                // Method javax/websocket/CloseReason."<init>":(Ljavax/websocket/CloseReason$CloseCode;Ljava/lang/String;)V
      79: new           #103                // class javax/websocket/CloseReason
      82: dup
      83: getstatic     #134                // Field javax/websocket/CloseReason$CloseCodes.CLOSED_ABNORMALLY:Ljavax/websocket/CloseReason$CloseCodes;
      86: aload_3
      87: invokespecial #105                // Method javax/websocket/CloseReason."<init>":(Ljavax/websocket/CloseReason$CloseCode;Ljava/lang/String;)V
      90: invokevirtual #107                // Method doClose:(Ljavax/websocket/CloseReason;Ljavax/websocket/CloseReason;)V
      93: return

  private void checkState();
    Code:
       0: aload_0
       1: getfield      #9                  // Field state:Lorg/apache/tomcat/websocket/WsSession$State;
       4: getstatic     #124                // Field org/apache/tomcat/websocket/WsSession$State.CLOSED:Lorg/apache/tomcat/websocket/WsSession$State;
       7: if_acmpne     37
      10: new           #83                 // class java/lang/IllegalStateException
      13: dup
      14: getstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      17: ldc           #160                // String wsSession.closed
      19: iconst_1
      20: anewarray     #10                 // class java/lang/Object
      23: dup
      24: iconst_0
      25: aload_0
      26: getfield      #58                 // Field id:Ljava/lang/String;
      29: aastore
      30: invokevirtual #70                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      33: invokespecial #85                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      36: athrow
      37: return

  void setWsFrame(org.apache.tomcat.websocket.WsFrameBase);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #161                // Field wsFrame:Lorg/apache/tomcat/websocket/WsFrameBase;
       5: return

  public void suspend();
    Code:
       0: aload_0
       1: getfield      #161                // Field wsFrame:Lorg/apache/tomcat/websocket/WsFrameBase;
       4: invokevirtual #162                // Method org/apache/tomcat/websocket/WsFrameBase.suspend:()V
       7: return

  public void resume();
    Code:
       0: aload_0
       1: getfield      #161                // Field wsFrame:Lorg/apache/tomcat/websocket/WsFrameBase;
       4: invokevirtual #163                // Method org/apache/tomcat/websocket/WsFrameBase.resume:()V
       7: return

  static {};
    Code:
       0: ldc           #164                // String …
       2: getstatic     #148                // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
       5: invokevirtual #149                // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
       8: putstatic     #153                // Field ELLIPSIS_BYTES:[B
      11: getstatic     #153                // Field ELLIPSIS_BYTES:[B
      14: arraylength
      15: putstatic     #151                // Field ELLIPSIS_BYTES_LEN:I
      18: ldc_w         #2                  // class org/apache/tomcat/websocket/WsSession
      21: invokestatic  #165                // Method org/apache/tomcat/util/res/StringManager.getManager:(Ljava/lang/Class;)Lorg/apache/tomcat/util/res/StringManager;
      24: putstatic     #64                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      27: new           #166                // class java/util/concurrent/atomic/AtomicLong
      30: dup
      31: lconst_0
      32: invokespecial #167                // Method java/util/concurrent/atomic/AtomicLong."<init>":(J)V
      35: putstatic     #55                 // Field ids:Ljava/util/concurrent/atomic/AtomicLong;
      38: return
}
