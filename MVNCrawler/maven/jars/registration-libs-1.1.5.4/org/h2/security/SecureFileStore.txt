Compiled from "SecureFileStore.java"
public class org.h2.security.SecureFileStore extends org.h2.store.FileStore {
  private byte[] key;

  private final org.h2.security.BlockCipher cipher;

  private final org.h2.security.BlockCipher cipherForInitVector;

  private byte[] buffer;

  private long pos;

  private final byte[] bufferForInitVector;

  private final int keyIterations;

  public org.h2.security.SecureFileStore(org.h2.store.DataHandler, java.lang.String, java.lang.String, java.lang.String, byte[], int);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: invokespecial #1                  // Method org/h2/store/FileStore."<init>":(Lorg/h2/store/DataHandler;Ljava/lang/String;Ljava/lang/String;)V
       7: aload_0
       8: iconst_4
       9: newarray       byte
      11: putfield      #2                  // Field buffer:[B
      14: aload_0
      15: aload         5
      17: putfield      #3                  // Field key:[B
      20: aload_0
      21: aload         4
      23: invokestatic  #4                  // Method org/h2/security/CipherFactory.getBlockCipher:(Ljava/lang/String;)Lorg/h2/security/BlockCipher;
      26: putfield      #5                  // Field cipher:Lorg/h2/security/BlockCipher;
      29: aload_0
      30: aload         4
      32: invokestatic  #4                  // Method org/h2/security/CipherFactory.getBlockCipher:(Ljava/lang/String;)Lorg/h2/security/BlockCipher;
      35: putfield      #6                  // Field cipherForInitVector:Lorg/h2/security/BlockCipher;
      38: aload_0
      39: iload         6
      41: putfield      #7                  // Field keyIterations:I
      44: aload_0
      45: bipush        16
      47: newarray       byte
      49: putfield      #8                  // Field bufferForInitVector:[B
      52: return

  protected byte[] generateSalt();
    Code:
       0: bipush        16
       2: invokestatic  #9                  // Method org/h2/util/MathUtils.secureRandomBytes:(I)[B
       5: areturn

  protected void initKey(byte[]);
    Code:
       0: aload_0
       1: aload_0
       2: getfield      #3                  // Field key:[B
       5: aload_1
       6: invokestatic  #10                 // Method org/h2/security/SHA256.getHashWithSalt:([B[B)[B
       9: putfield      #3                  // Field key:[B
      12: iconst_0
      13: istore_2
      14: iload_2
      15: aload_0
      16: getfield      #7                  // Field keyIterations:I
      19: if_icmpge     40
      22: aload_0
      23: aload_0
      24: getfield      #3                  // Field key:[B
      27: iconst_1
      28: invokestatic  #11                 // Method org/h2/security/SHA256.getHash:([BZ)[B
      31: putfield      #3                  // Field key:[B
      34: iinc          2, 1
      37: goto          14
      40: aload_0
      41: getfield      #5                  // Field cipher:Lorg/h2/security/BlockCipher;
      44: aload_0
      45: getfield      #3                  // Field key:[B
      48: invokeinterface #12,  2           // InterfaceMethod org/h2/security/BlockCipher.setKey:([B)V
      53: aload_0
      54: aload_0
      55: getfield      #3                  // Field key:[B
      58: iconst_1
      59: invokestatic  #11                 // Method org/h2/security/SHA256.getHash:([BZ)[B
      62: putfield      #3                  // Field key:[B
      65: aload_0
      66: getfield      #6                  // Field cipherForInitVector:Lorg/h2/security/BlockCipher;
      69: aload_0
      70: getfield      #3                  // Field key:[B
      73: invokeinterface #12,  2           // InterfaceMethod org/h2/security/BlockCipher.setKey:([B)V
      78: return

  protected void writeDirect(byte[], int, int);
    Code:
       0: aload_0
       1: aload_1
       2: iload_2
       3: iload_3
       4: invokespecial #13                 // Method org/h2/store/FileStore.write:([BII)V
       7: aload_0
       8: dup
       9: getfield      #14                 // Field pos:J
      12: iload_3
      13: i2l
      14: ladd
      15: putfield      #14                 // Field pos:J
      18: return

  public void write(byte[], int, int);
    Code:
       0: aload_0
       1: getfield      #2                  // Field buffer:[B
       4: arraylength
       5: aload_1
       6: arraylength
       7: if_icmpge     17
      10: aload_0
      11: iload_3
      12: newarray       byte
      14: putfield      #2                  // Field buffer:[B
      17: aload_1
      18: iload_2
      19: aload_0
      20: getfield      #2                  // Field buffer:[B
      23: iconst_0
      24: iload_3
      25: invokestatic  #15                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      28: aload_0
      29: aload_0
      30: getfield      #2                  // Field buffer:[B
      33: iconst_0
      34: iload_3
      35: aload_0
      36: getfield      #14                 // Field pos:J
      39: invokespecial #16                 // Method xorInitVector:([BIIJ)V
      42: aload_0
      43: getfield      #5                  // Field cipher:Lorg/h2/security/BlockCipher;
      46: aload_0
      47: getfield      #2                  // Field buffer:[B
      50: iconst_0
      51: iload_3
      52: invokeinterface #17,  4           // InterfaceMethod org/h2/security/BlockCipher.encrypt:([BII)V
      57: aload_0
      58: aload_0
      59: getfield      #2                  // Field buffer:[B
      62: iconst_0
      63: iload_3
      64: invokespecial #13                 // Method org/h2/store/FileStore.write:([BII)V
      67: aload_0
      68: dup
      69: getfield      #14                 // Field pos:J
      72: iload_3
      73: i2l
      74: ladd
      75: putfield      #14                 // Field pos:J
      78: return

  protected void readFullyDirect(byte[], int, int);
    Code:
       0: aload_0
       1: aload_1
       2: iload_2
       3: iload_3
       4: invokespecial #18                 // Method org/h2/store/FileStore.readFully:([BII)V
       7: aload_0
       8: dup
       9: getfield      #14                 // Field pos:J
      12: iload_3
      13: i2l
      14: ladd
      15: putfield      #14                 // Field pos:J
      18: return

  public void readFully(byte[], int, int);
    Code:
       0: aload_0
       1: aload_1
       2: iload_2
       3: iload_3
       4: invokespecial #18                 // Method org/h2/store/FileStore.readFully:([BII)V
       7: iconst_0
       8: istore        4
      10: iload         4
      12: iload_3
      13: if_icmpge     55
      16: aload_1
      17: iload         4
      19: baload
      20: ifeq          49
      23: aload_0
      24: getfield      #5                  // Field cipher:Lorg/h2/security/BlockCipher;
      27: aload_1
      28: iload_2
      29: iload_3
      30: invokeinterface #19,  4           // InterfaceMethod org/h2/security/BlockCipher.decrypt:([BII)V
      35: aload_0
      36: aload_1
      37: iload_2
      38: iload_3
      39: aload_0
      40: getfield      #14                 // Field pos:J
      43: invokespecial #16                 // Method xorInitVector:([BIIJ)V
      46: goto          55
      49: iinc          4, 1
      52: goto          10
      55: aload_0
      56: dup
      57: getfield      #14                 // Field pos:J
      60: iload_3
      61: i2l
      62: ladd
      63: putfield      #14                 // Field pos:J
      66: return

  public void seek(long);
    Code:
       0: aload_0
       1: lload_1
       2: putfield      #14                 // Field pos:J
       5: aload_0
       6: lload_1
       7: invokespecial #20                 // Method org/h2/store/FileStore.seek:(J)V
      10: return

  private void xorInitVector(byte[], int, int, long);
    Code:
       0: aload_0
       1: getfield      #8                  // Field bufferForInitVector:[B
       4: astore        6
       6: iload_3
       7: ifle          103
      10: iconst_0
      11: istore        7
      13: iload         7
      15: bipush        16
      17: if_icmpge     41
      20: aload         6
      22: iload         7
      24: lload         4
      26: iload         7
      28: i2l
      29: ladd
      30: iconst_3
      31: lushr
      32: invokestatic  #21                 // Method org/h2/util/Bits.writeLong:([BIJ)V
      35: iinc          7, 8
      38: goto          13
      41: aload_0
      42: getfield      #6                  // Field cipherForInitVector:Lorg/h2/security/BlockCipher;
      45: aload         6
      47: iconst_0
      48: bipush        16
      50: invokeinterface #17,  4           // InterfaceMethod org/h2/security/BlockCipher.encrypt:([BII)V
      55: iconst_0
      56: istore        7
      58: iload         7
      60: bipush        16
      62: if_icmpge     86
      65: aload_1
      66: iload_2
      67: iload         7
      69: iadd
      70: dup2
      71: baload
      72: aload         6
      74: iload         7
      76: baload
      77: ixor
      78: i2b
      79: bastore
      80: iinc          7, 1
      83: goto          58
      86: lload         4
      88: ldc2_w        #22                 // long 16l
      91: ladd
      92: lstore        4
      94: iinc          2, 16
      97: iinc          3, -16
     100: goto          6
     103: return
}
