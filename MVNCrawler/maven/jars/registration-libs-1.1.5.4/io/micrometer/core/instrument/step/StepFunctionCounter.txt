Compiled from "StepFunctionCounter.java"
public class io.micrometer.core.instrument.step.StepFunctionCounter<T> extends io.micrometer.core.instrument.AbstractMeter implements io.micrometer.core.instrument.FunctionCounter {
  private final java.lang.ref.WeakReference<T> ref;

  private final java.util.function.ToDoubleFunction<T> f;

  private volatile double last;

  private io.micrometer.core.instrument.step.StepDouble count;

  public io.micrometer.core.instrument.step.StepFunctionCounter(io.micrometer.core.instrument.Meter$Id, io.micrometer.core.instrument.Clock, long, T, java.util.function.ToDoubleFunction<T>);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #1                  // Method io/micrometer/core/instrument/AbstractMeter."<init>":(Lio/micrometer/core/instrument/Meter$Id;)V
       5: aload_0
       6: new           #7                  // class java/lang/ref/WeakReference
       9: dup
      10: aload         5
      12: invokespecial #9                  // Method java/lang/ref/WeakReference."<init>":(Ljava/lang/Object;)V
      15: putfield      #12                 // Field ref:Ljava/lang/ref/WeakReference;
      18: aload_0
      19: aload         6
      21: putfield      #18                 // Field f:Ljava/util/function/ToDoubleFunction;
      24: aload_0
      25: new           #22                 // class io/micrometer/core/instrument/step/StepDouble
      28: dup
      29: aload_2
      30: lload_3
      31: invokespecial #24                 // Method io/micrometer/core/instrument/step/StepDouble."<init>":(Lio/micrometer/core/instrument/Clock;J)V
      34: putfield      #27                 // Field count:Lio/micrometer/core/instrument/step/StepDouble;
      37: return

  public double count();
    Code:
       0: aload_0
       1: getfield      #12                 // Field ref:Ljava/lang/ref/WeakReference;
       4: invokevirtual #31                 // Method java/lang/ref/WeakReference.get:()Ljava/lang/Object;
       7: astore_1
       8: aload_1
       9: ifnull        47
      12: aload_0
      13: getfield      #35                 // Field last:D
      16: dstore_2
      17: aload_0
      18: aload_0
      19: getfield      #18                 // Field f:Ljava/util/function/ToDoubleFunction;
      22: aload_1
      23: invokeinterface #39,  2           // InterfaceMethod java/util/function/ToDoubleFunction.applyAsDouble:(Ljava/lang/Object;)D
      28: putfield      #35                 // Field last:D
      31: aload_0
      32: getfield      #27                 // Field count:Lio/micrometer/core/instrument/step/StepDouble;
      35: invokevirtual #45                 // Method io/micrometer/core/instrument/step/StepDouble.getCurrent:()Ljava/util/concurrent/atomic/DoubleAdder;
      38: aload_0
      39: getfield      #35                 // Field last:D
      42: dload_2
      43: dsub
      44: invokevirtual #49                 // Method java/util/concurrent/atomic/DoubleAdder.add:(D)V
      47: aload_0
      48: getfield      #27                 // Field count:Lio/micrometer/core/instrument/step/StepDouble;
      51: invokevirtual #55                 // Method io/micrometer/core/instrument/step/StepDouble.poll:()Ljava/lang/Object;
      54: checkcast     #58                 // class java/lang/Double
      57: invokevirtual #60                 // Method java/lang/Double.doubleValue:()D
      60: dreturn
}
