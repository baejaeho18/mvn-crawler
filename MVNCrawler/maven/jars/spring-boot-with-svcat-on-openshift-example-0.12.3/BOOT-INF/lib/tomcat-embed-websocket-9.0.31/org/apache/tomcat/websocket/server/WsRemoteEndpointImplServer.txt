Compiled from "WsRemoteEndpointImplServer.java"
public class org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer extends org.apache.tomcat.websocket.WsRemoteEndpointImplBase {
  private static final org.apache.tomcat.util.res.StringManager sm;

  private final org.apache.juli.logging.Log log;

  private final org.apache.tomcat.util.net.SocketWrapperBase<?> socketWrapper;

  private final org.apache.tomcat.websocket.server.WsWriteTimeout wsWriteTimeout;

  private volatile javax.websocket.SendHandler handler;

  private volatile java.nio.ByteBuffer[] buffers;

  private volatile long timeoutExpiry;

  public org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer(org.apache.tomcat.util.net.SocketWrapperBase<?>, org.apache.tomcat.websocket.server.WsServerContainer);
    Code:
       0: aload_0
       1: invokespecial #4                  // Method org/apache/tomcat/websocket/WsRemoteEndpointImplBase."<init>":()V
       4: aload_0
       5: ldc           #5                  // class org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer
       7: invokestatic  #6                  // Method org/apache/juli/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/juli/logging/Log;
      10: putfield      #7                  // Field log:Lorg/apache/juli/logging/Log;
      13: aload_0
      14: aconst_null
      15: putfield      #8                  // Field handler:Ljavax/websocket/SendHandler;
      18: aload_0
      19: aconst_null
      20: putfield      #9                  // Field buffers:[Ljava/nio/ByteBuffer;
      23: aload_0
      24: ldc2_w        #10                 // long -1l
      27: putfield      #12                 // Field timeoutExpiry:J
      30: aload_0
      31: aload_1
      32: putfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
      35: aload_0
      36: aload_2
      37: invokevirtual #14                 // Method org/apache/tomcat/websocket/server/WsServerContainer.getTimeout:()Lorg/apache/tomcat/websocket/server/WsWriteTimeout;
      40: putfield      #2                  // Field wsWriteTimeout:Lorg/apache/tomcat/websocket/server/WsWriteTimeout;
      43: return

  protected final boolean isMasked();
    Code:
       0: iconst_0
       1: ireturn

  protected void doWrite(javax.websocket.SendHandler, long, java.nio.ByteBuffer...);
    Code:
       0: aload_0
       1: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
       4: invokevirtual #15                 // Method org/apache/tomcat/util/net/SocketWrapperBase.hasAsyncIO:()Z
       7: ifeq          158
      10: lload_2
      11: ldc2_w        #10                 // long -1l
      14: lcmp
      15: ifeq          22
      18: iconst_1
      19: goto          23
      22: iconst_0
      23: istore        5
      25: ldc2_w        #10                 // long -1l
      28: lstore        6
      30: iload         5
      32: ifeq          74
      35: lload_2
      36: invokestatic  #16                 // Method java/lang/System.currentTimeMillis:()J
      39: lsub
      40: lstore        6
      42: lload         6
      44: lconst_0
      45: lcmp
      46: ifgt          110
      49: new           #17                 // class javax/websocket/SendResult
      52: dup
      53: new           #18                 // class java/net/SocketTimeoutException
      56: dup
      57: invokespecial #19                 // Method java/net/SocketTimeoutException."<init>":()V
      60: invokespecial #20                 // Method javax/websocket/SendResult."<init>":(Ljava/lang/Throwable;)V
      63: astore        8
      65: aload_1
      66: aload         8
      68: invokeinterface #21,  2           // InterfaceMethod javax/websocket/SendHandler.onResult:(Ljavax/websocket/SendResult;)V
      73: return
      74: aload_0
      75: aload_1
      76: putfield      #8                  // Field handler:Ljavax/websocket/SendHandler;
      79: aload_0
      80: invokevirtual #22                 // Method getSendTimeout:()J
      83: lstore        6
      85: lload         6
      87: lconst_0
      88: lcmp
      89: ifle          110
      92: aload_0
      93: lload         6
      95: invokestatic  #16                 // Method java/lang/System.currentTimeMillis:()J
      98: ladd
      99: putfield      #12                 // Field timeoutExpiry:J
     102: aload_0
     103: getfield      #2                  // Field wsWriteTimeout:Lorg/apache/tomcat/websocket/server/WsWriteTimeout;
     106: aload_0
     107: invokevirtual #23                 // Method org/apache/tomcat/websocket/server/WsWriteTimeout.register:(Lorg/apache/tomcat/websocket/server/WsRemoteEndpointImplServer;)V
     110: aload_0
     111: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
     114: iload         5
     116: ifeq          125
     119: getstatic     #24                 // Field org/apache/tomcat/util/net/SocketWrapperBase$BlockingMode.BLOCK:Lorg/apache/tomcat/util/net/SocketWrapperBase$BlockingMode;
     122: goto          128
     125: getstatic     #25                 // Field org/apache/tomcat/util/net/SocketWrapperBase$BlockingMode.SEMI_BLOCK:Lorg/apache/tomcat/util/net/SocketWrapperBase$BlockingMode;
     128: lload         6
     130: getstatic     #26                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
     133: aconst_null
     134: getstatic     #27                 // Field org/apache/tomcat/util/net/SocketWrapperBase.COMPLETE_WRITE_WITH_COMPLETION:Lorg/apache/tomcat/util/net/SocketWrapperBase$CompletionCheck;
     137: new           #28                 // class org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer$1
     140: dup
     141: aload_0
     142: iload         5
     144: lload_2
     145: aload_1
     146: invokespecial #29                 // Method org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer$1."<init>":(Lorg/apache/tomcat/websocket/server/WsRemoteEndpointImplServer;ZJLjavax/websocket/SendHandler;)V
     149: aload         4
     151: invokevirtual #30                 // Method org/apache/tomcat/util/net/SocketWrapperBase.write:(Lorg/apache/tomcat/util/net/SocketWrapperBase$BlockingMode;JLjava/util/concurrent/TimeUnit;Ljava/lang/Object;Lorg/apache/tomcat/util/net/SocketWrapperBase$CompletionCheck;Ljava/nio/channels/CompletionHandler;[Ljava/nio/ByteBuffer;)Lorg/apache/tomcat/util/net/SocketWrapperBase$CompletionState;
     154: pop
     155: goto          365
     158: lload_2
     159: ldc2_w        #10                 // long -1l
     162: lcmp
     163: ifne          185
     166: aload_0
     167: aload_1
     168: putfield      #8                  // Field handler:Ljavax/websocket/SendHandler;
     171: aload_0
     172: aload         4
     174: putfield      #9                  // Field buffers:[Ljava/nio/ByteBuffer;
     177: aload_0
     178: iconst_1
     179: invokevirtual #31                 // Method onWritePossible:(Z)V
     182: goto          365
     185: aload         4
     187: astore        5
     189: aload         5
     191: arraylength
     192: istore        6
     194: iconst_0
     195: istore        7
     197: iload         7
     199: iload         6
     201: if_icmpge     275
     204: aload         5
     206: iload         7
     208: aaload
     209: astore        8
     211: lload_2
     212: invokestatic  #16                 // Method java/lang/System.currentTimeMillis:()J
     215: lsub
     216: lstore        9
     218: lload         9
     220: lconst_0
     221: lcmp
     222: ifgt          250
     225: new           #17                 // class javax/websocket/SendResult
     228: dup
     229: new           #18                 // class java/net/SocketTimeoutException
     232: dup
     233: invokespecial #19                 // Method java/net/SocketTimeoutException."<init>":()V
     236: invokespecial #20                 // Method javax/websocket/SendResult."<init>":(Ljava/lang/Throwable;)V
     239: astore        11
     241: aload_1
     242: aload         11
     244: invokeinterface #21,  2           // InterfaceMethod javax/websocket/SendHandler.onResult:(Ljavax/websocket/SendResult;)V
     249: return
     250: aload_0
     251: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
     254: lload         9
     256: invokevirtual #32                 // Method org/apache/tomcat/util/net/SocketWrapperBase.setWriteTimeout:(J)V
     259: aload_0
     260: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
     263: iconst_1
     264: aload         8
     266: invokevirtual #33                 // Method org/apache/tomcat/util/net/SocketWrapperBase.write:(ZLjava/nio/ByteBuffer;)V
     269: iinc          7, 1
     272: goto          197
     275: lload_2
     276: invokestatic  #16                 // Method java/lang/System.currentTimeMillis:()J
     279: lsub
     280: lstore        5
     282: lload         5
     284: lconst_0
     285: lcmp
     286: ifgt          314
     289: new           #17                 // class javax/websocket/SendResult
     292: dup
     293: new           #18                 // class java/net/SocketTimeoutException
     296: dup
     297: invokespecial #19                 // Method java/net/SocketTimeoutException."<init>":()V
     300: invokespecial #20                 // Method javax/websocket/SendResult."<init>":(Ljava/lang/Throwable;)V
     303: astore        7
     305: aload_1
     306: aload         7
     308: invokeinterface #21,  2           // InterfaceMethod javax/websocket/SendHandler.onResult:(Ljavax/websocket/SendResult;)V
     313: return
     314: aload_0
     315: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
     318: lload         5
     320: invokevirtual #32                 // Method org/apache/tomcat/util/net/SocketWrapperBase.setWriteTimeout:(J)V
     323: aload_0
     324: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
     327: iconst_1
     328: invokevirtual #34                 // Method org/apache/tomcat/util/net/SocketWrapperBase.flush:(Z)Z
     331: pop
     332: aload_1
     333: getstatic     #3                  // Field SENDRESULT_OK:Ljavax/websocket/SendResult;
     336: invokeinterface #21,  2           // InterfaceMethod javax/websocket/SendHandler.onResult:(Ljavax/websocket/SendResult;)V
     341: goto          365
     344: astore        5
     346: new           #17                 // class javax/websocket/SendResult
     349: dup
     350: aload         5
     352: invokespecial #20                 // Method javax/websocket/SendResult."<init>":(Ljava/lang/Throwable;)V
     355: astore        6
     357: aload_1
     358: aload         6
     360: invokeinterface #21,  2           // InterfaceMethod javax/websocket/SendHandler.onResult:(Ljavax/websocket/SendResult;)V
     365: return
    Exception table:
       from    to  target type
         185   249   344   Class java/io/IOException
         250   313   344   Class java/io/IOException
         314   341   344   Class java/io/IOException

  public void onWritePossible(boolean);
    Code:
       0: aload_0
       1: getfield      #9                  // Field buffers:[Ljava/nio/ByteBuffer;
       4: astore_2
       5: aload_2
       6: ifnonnull     10
       9: return
      10: iconst_0
      11: istore_3
      12: aload_0
      13: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
      16: iconst_0
      17: invokevirtual #34                 // Method org/apache/tomcat/util/net/SocketWrapperBase.flush:(Z)Z
      20: pop
      21: aload_0
      22: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
      25: invokevirtual #36                 // Method org/apache/tomcat/util/net/SocketWrapperBase.isReadyForWrite:()Z
      28: ifeq          129
      31: iconst_1
      32: istore_3
      33: aload_2
      34: astore        4
      36: aload         4
      38: arraylength
      39: istore        5
      41: iconst_0
      42: istore        6
      44: iload         6
      46: iload         5
      48: if_icmpge     87
      51: aload         4
      53: iload         6
      55: aaload
      56: astore        7
      58: aload         7
      60: invokevirtual #37                 // Method java/nio/ByteBuffer.hasRemaining:()Z
      63: ifeq          81
      66: iconst_0
      67: istore_3
      68: aload_0
      69: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
      72: iconst_0
      73: aload         7
      75: invokevirtual #33                 // Method org/apache/tomcat/util/net/SocketWrapperBase.write:(ZLjava/nio/ByteBuffer;)V
      78: goto          87
      81: iinc          6, 1
      84: goto          44
      87: iload_3
      88: ifeq          21
      91: aload_0
      92: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
      95: iconst_0
      96: invokevirtual #34                 // Method org/apache/tomcat/util/net/SocketWrapperBase.flush:(Z)Z
      99: pop
     100: aload_0
     101: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
     104: invokevirtual #36                 // Method org/apache/tomcat/util/net/SocketWrapperBase.isReadyForWrite:()Z
     107: istore_3
     108: iload_3
     109: ifeq          129
     112: aload_0
     113: getfield      #2                  // Field wsWriteTimeout:Lorg/apache/tomcat/websocket/server/WsWriteTimeout;
     116: aload_0
     117: invokevirtual #38                 // Method org/apache/tomcat/websocket/server/WsWriteTimeout.unregister:(Lorg/apache/tomcat/websocket/server/WsRemoteEndpointImplServer;)V
     120: aload_0
     121: aconst_null
     122: iload_1
     123: invokespecial #1                  // Method clearHandler:(Ljava/lang/Throwable;Z)V
     126: goto          129
     129: goto          153
     132: astore        4
     134: aload_0
     135: getfield      #2                  // Field wsWriteTimeout:Lorg/apache/tomcat/websocket/server/WsWriteTimeout;
     138: aload_0
     139: invokevirtual #38                 // Method org/apache/tomcat/websocket/server/WsWriteTimeout.unregister:(Lorg/apache/tomcat/websocket/server/WsRemoteEndpointImplServer;)V
     142: aload_0
     143: aload         4
     145: iload_1
     146: invokespecial #1                  // Method clearHandler:(Ljava/lang/Throwable;Z)V
     149: aload_0
     150: invokevirtual #40                 // Method close:()V
     153: iload_3
     154: ifne          188
     157: aload_0
     158: invokevirtual #22                 // Method getSendTimeout:()J
     161: lstore        4
     163: lload         4
     165: lconst_0
     166: lcmp
     167: ifle          188
     170: aload_0
     171: lload         4
     173: invokestatic  #16                 // Method java/lang/System.currentTimeMillis:()J
     176: ladd
     177: putfield      #12                 // Field timeoutExpiry:J
     180: aload_0
     181: getfield      #2                  // Field wsWriteTimeout:Lorg/apache/tomcat/websocket/server/WsWriteTimeout;
     184: aload_0
     185: invokevirtual #23                 // Method org/apache/tomcat/websocket/server/WsWriteTimeout.register:(Lorg/apache/tomcat/websocket/server/WsRemoteEndpointImplServer;)V
     188: return
    Exception table:
       from    to  target type
          12   129   132   Class java/io/IOException
          12   129   132   Class java/lang/IllegalStateException

  protected void doClose();
    Code:
       0: aload_0
       1: getfield      #8                  // Field handler:Ljavax/websocket/SendHandler;
       4: ifnull        19
       7: aload_0
       8: new           #41                 // class java/io/EOFException
      11: dup
      12: invokespecial #42                 // Method java/io/EOFException."<init>":()V
      15: iconst_1
      16: invokespecial #1                  // Method clearHandler:(Ljava/lang/Throwable;Z)V
      19: aload_0
      20: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
      23: invokevirtual #43                 // Method org/apache/tomcat/util/net/SocketWrapperBase.close:()V
      26: goto          60
      29: astore_1
      30: aload_0
      31: getfield      #7                  // Field log:Lorg/apache/juli/logging/Log;
      34: invokeinterface #45,  1           // InterfaceMethod org/apache/juli/logging/Log.isInfoEnabled:()Z
      39: ifeq          60
      42: aload_0
      43: getfield      #7                  // Field log:Lorg/apache/juli/logging/Log;
      46: getstatic     #46                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      49: ldc           #47                 // String wsRemoteEndpointServer.closeFailed
      51: invokevirtual #48                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      54: aload_1
      55: invokeinterface #49,  3           // InterfaceMethod org/apache/juli/logging/Log.info:(Ljava/lang/Object;Ljava/lang/Throwable;)V
      60: aload_0
      61: getfield      #2                  // Field wsWriteTimeout:Lorg/apache/tomcat/websocket/server/WsWriteTimeout;
      64: aload_0
      65: invokevirtual #38                 // Method org/apache/tomcat/websocket/server/WsWriteTimeout.unregister:(Lorg/apache/tomcat/websocket/server/WsRemoteEndpointImplServer;)V
      68: return
    Exception table:
       from    to  target type
          19    26    29   Class java/lang/Exception

  protected long getTimeoutExpiry();
    Code:
       0: aload_0
       1: getfield      #12                 // Field timeoutExpiry:J
       4: lreturn

  protected void onTimeout(boolean);
    Code:
       0: aload_0
       1: getfield      #8                  // Field handler:Ljavax/websocket/SendHandler;
       4: ifnull        19
       7: aload_0
       8: new           #18                 // class java/net/SocketTimeoutException
      11: dup
      12: invokespecial #19                 // Method java/net/SocketTimeoutException."<init>":()V
      15: iload_1
      16: invokespecial #1                  // Method clearHandler:(Ljava/lang/Throwable;Z)V
      19: aload_0
      20: invokevirtual #40                 // Method close:()V
      23: return

  protected void setTransformation(org.apache.tomcat.websocket.Transformation);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #50                 // Method org/apache/tomcat/websocket/WsRemoteEndpointImplBase.setTransformation:(Lorg/apache/tomcat/websocket/Transformation;)V
       5: return

  private void clearHandler(java.lang.Throwable, boolean);
    Code:
       0: aload_0
       1: getfield      #8                  // Field handler:Ljavax/websocket/SendHandler;
       4: astore_3
       5: aload_0
       6: aconst_null
       7: putfield      #8                  // Field handler:Ljavax/websocket/SendHandler;
      10: aload_0
      11: aconst_null
      12: putfield      #9                  // Field buffers:[Ljava/nio/ByteBuffer;
      15: aload_3
      16: ifnull        91
      19: iload_2
      20: ifeq          57
      23: new           #51                 // class org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer$OnResultRunnable
      26: dup
      27: aload_3
      28: aload_1
      29: aconst_null
      30: invokespecial #52                 // Method org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer$OnResultRunnable."<init>":(Ljavax/websocket/SendHandler;Ljava/lang/Throwable;Lorg/apache/tomcat/websocket/server/WsRemoteEndpointImplServer$1;)V
      33: astore        4
      35: aload_0
      36: getfield      #13                 // Field socketWrapper:Lorg/apache/tomcat/util/net/SocketWrapperBase;
      39: aload         4
      41: invokevirtual #53                 // Method org/apache/tomcat/util/net/SocketWrapperBase.execute:(Ljava/lang/Runnable;)V
      44: goto          54
      47: astore        5
      49: aload         4
      51: invokevirtual #55                 // Method org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer$OnResultRunnable.run:()V
      54: goto          91
      57: aload_1
      58: ifnonnull     77
      61: aload_3
      62: new           #17                 // class javax/websocket/SendResult
      65: dup
      66: invokespecial #56                 // Method javax/websocket/SendResult."<init>":()V
      69: invokeinterface #21,  2           // InterfaceMethod javax/websocket/SendHandler.onResult:(Ljavax/websocket/SendResult;)V
      74: goto          91
      77: aload_3
      78: new           #17                 // class javax/websocket/SendResult
      81: dup
      82: aload_1
      83: invokespecial #20                 // Method javax/websocket/SendResult."<init>":(Ljava/lang/Throwable;)V
      86: invokeinterface #21,  2           // InterfaceMethod javax/websocket/SendHandler.onResult:(Ljavax/websocket/SendResult;)V
      91: return
    Exception table:
       from    to  target type
          35    44    47   Class java/util/concurrent/RejectedExecutionException

  static javax.websocket.SendResult access$000();
    Code:
       0: getstatic     #3                  // Field SENDRESULT_OK:Ljavax/websocket/SendResult;
       3: areturn

  static org.apache.tomcat.websocket.server.WsWriteTimeout access$100(org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer);
    Code:
       0: aload_0
       1: getfield      #2                  // Field wsWriteTimeout:Lorg/apache/tomcat/websocket/server/WsWriteTimeout;
       4: areturn

  static void access$200(org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer, java.lang.Throwable, boolean);
    Code:
       0: aload_0
       1: aload_1
       2: iload_2
       3: invokespecial #1                  // Method clearHandler:(Ljava/lang/Throwable;Z)V
       6: return

  static {};
    Code:
       0: ldc           #5                  // class org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer
       2: invokestatic  #57                 // Method org/apache/tomcat/util/res/StringManager.getManager:(Ljava/lang/Class;)Lorg/apache/tomcat/util/res/StringManager;
       5: putstatic     #46                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
       8: return
}
