Compiled from "CsrfPreventionFilter.java"
public class org.apache.catalina.filters.CsrfPreventionFilter extends org.apache.catalina.filters.CsrfPreventionFilterBase {
  private final org.apache.juli.logging.Log log;

  private final java.util.Set<java.lang.String> entryPoints;

  private int nonceCacheSize;

  private java.lang.String nonceRequestParameterName;

  public org.apache.catalina.filters.CsrfPreventionFilter();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/catalina/filters/CsrfPreventionFilterBase."<init>":()V
       4: aload_0
       5: ldc           #2                  // class org/apache/catalina/filters/CsrfPreventionFilter
       7: invokestatic  #3                  // Method org/apache/juli/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/juli/logging/Log;
      10: putfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      13: aload_0
      14: new           #5                  // class java/util/HashSet
      17: dup
      18: invokespecial #6                  // Method java/util/HashSet."<init>":()V
      21: putfield      #7                  // Field entryPoints:Ljava/util/Set;
      24: aload_0
      25: iconst_5
      26: putfield      #8                  // Field nonceCacheSize:I
      29: aload_0
      30: ldc           #10                 // String org.apache.catalina.filters.CSRF_NONCE
      32: putfield      #11                 // Field nonceRequestParameterName:Ljava/lang/String;
      35: return

  public void setEntryPoints(java.lang.String);
    Code:
       0: aload_1
       1: ldc           #12                 // String ,
       3: invokevirtual #13                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
       6: astore_2
       7: aload_2
       8: astore_3
       9: aload_3
      10: arraylength
      11: istore        4
      13: iconst_0
      14: istore        5
      16: iload         5
      18: iload         4
      20: if_icmpge     50
      23: aload_3
      24: iload         5
      26: aaload
      27: astore        6
      29: aload_0
      30: getfield      #7                  // Field entryPoints:Ljava/util/Set;
      33: aload         6
      35: invokevirtual #14                 // Method java/lang/String.trim:()Ljava/lang/String;
      38: invokeinterface #15,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      43: pop
      44: iinc          5, 1
      47: goto          16
      50: return

  public void setNonceCacheSize(int);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #8                  // Field nonceCacheSize:I
       5: return

  public void setNonceRequestParameterName(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #11                 // Field nonceRequestParameterName:Ljava/lang/String;
       5: return

  public void init(javax.servlet.FilterConfig) throws javax.servlet.ServletException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #16                 // Method org/apache/catalina/filters/CsrfPreventionFilterBase.init:(Ljavax/servlet/FilterConfig;)V
       5: aload_1
       6: invokeinterface #17,  1           // InterfaceMethod javax/servlet/FilterConfig.getServletContext:()Ljavax/servlet/ServletContext;
      11: ldc           #18                 // String org.apache.catalina.filters.CSRF_NONCE_PARAM_NAME
      13: aload_0
      14: getfield      #11                 // Field nonceRequestParameterName:Ljava/lang/String;
      17: invokeinterface #19,  3           // InterfaceMethod javax/servlet/ServletContext.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
      22: return

  public void doFilter(javax.servlet.ServletRequest, javax.servlet.ServletResponse, javax.servlet.FilterChain) throws java.io.IOException, javax.servlet.ServletException;
    Code:
       0: aconst_null
       1: astore        4
       3: aload_1
       4: instanceof    #20                 // class javax/servlet/http/HttpServletRequest
       7: ifeq          687
      10: aload_2
      11: instanceof    #21                 // class javax/servlet/http/HttpServletResponse
      14: ifeq          687
      17: aload_1
      18: checkcast     #20                 // class javax/servlet/http/HttpServletRequest
      21: astore        5
      23: aload_2
      24: checkcast     #21                 // class javax/servlet/http/HttpServletResponse
      27: astore        6
      29: iconst_0
      30: istore        7
      32: ldc           #22                 // String GET
      34: aload         5
      36: invokeinterface #23,  1           // InterfaceMethod javax/servlet/http/HttpServletRequest.getMethod:()Ljava/lang/String;
      41: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      44: ifeq          113
      47: aload_0
      48: getfield      #7                  // Field entryPoints:Ljava/util/Set;
      51: aload_0
      52: aload         5
      54: invokevirtual #25                 // Method getRequestedPath:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
      57: invokeinterface #26,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      62: ifeq          113
      65: aload_0
      66: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      69: invokeinterface #27,  1           // InterfaceMethod org/apache/juli/logging/Log.isTraceEnabled:()Z
      74: ifeq          110
      77: aload_0
      78: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      81: new           #28                 // class java/lang/StringBuilder
      84: dup
      85: invokespecial #29                 // Method java/lang/StringBuilder."<init>":()V
      88: ldc           #30                 // String Skipping CSRF nonce-check for GET request to entry point
      90: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      93: aload_0
      94: aload         5
      96: invokevirtual #25                 // Method getRequestedPath:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
      99: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     102: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     105: invokeinterface #33,  2           // InterfaceMethod org/apache/juli/logging/Log.trace:(Ljava/lang/Object;)V
     110: iconst_1
     111: istore        7
     113: aload         5
     115: iconst_0
     116: invokeinterface #34,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getSession:(Z)Ljavax/servlet/http/HttpSession;
     121: astore        8
     123: aload         8
     125: ifnonnull     132
     128: aconst_null
     129: goto          144
     132: aload         8
     134: ldc           #10                 // String org.apache.catalina.filters.CSRF_NONCE
     136: invokeinterface #35,  2           // InterfaceMethod javax/servlet/http/HttpSession.getAttribute:(Ljava/lang/String;)Ljava/lang/Object;
     141: checkcast     #36                 // class org/apache/catalina/filters/CsrfPreventionFilter$LruCache
     144: astore        9
     146: iload         7
     148: ifne          508
     151: aload         5
     153: aload_0
     154: getfield      #11                 // Field nonceRequestParameterName:Ljava/lang/String;
     157: invokeinterface #37,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameter:(Ljava/lang/String;)Ljava/lang/String;
     162: astore        10
     164: aload         10
     166: ifnonnull     257
     169: aload_0
     170: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     173: invokeinterface #38,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     178: ifeq          245
     181: aload_0
     182: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     185: new           #28                 // class java/lang/StringBuilder
     188: dup
     189: invokespecial #29                 // Method java/lang/StringBuilder."<init>":()V
     192: ldc           #39                 // String Rejecting request for
     194: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     197: aload_0
     198: aload         5
     200: invokevirtual #25                 // Method getRequestedPath:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
     203: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     206: ldc           #40                 // String , session
     208: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     211: aconst_null
     212: aload         8
     214: if_acmpne     222
     217: ldc           #41                 // String (none)
     219: goto          229
     222: aload         8
     224: invokeinterface #42,  1           // InterfaceMethod javax/servlet/http/HttpSession.getId:()Ljava/lang/String;
     229: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     232: ldc           #43                 // String  with no CSRF nonce found in request
     234: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     237: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     240: invokeinterface #44,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     245: aload         6
     247: aload_0
     248: invokevirtual #45                 // Method getDenyStatus:()I
     251: invokeinterface #46,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     256: return
     257: aload         9
     259: ifnonnull     350
     262: aload_0
     263: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     266: invokeinterface #38,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     271: ifeq          338
     274: aload_0
     275: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     278: new           #28                 // class java/lang/StringBuilder
     281: dup
     282: invokespecial #29                 // Method java/lang/StringBuilder."<init>":()V
     285: ldc           #39                 // String Rejecting request for
     287: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     290: aload_0
     291: aload         5
     293: invokevirtual #25                 // Method getRequestedPath:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
     296: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     299: ldc           #40                 // String , session
     301: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     304: aconst_null
     305: aload         8
     307: if_acmpne     315
     310: ldc           #41                 // String (none)
     312: goto          322
     315: aload         8
     317: invokeinterface #42,  1           // InterfaceMethod javax/servlet/http/HttpSession.getId:()Ljava/lang/String;
     322: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     325: ldc           #47                 // String  due to empty / missing nonce cache
     327: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     330: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     333: invokeinterface #44,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     338: aload         6
     340: aload_0
     341: invokevirtual #45                 // Method getDenyStatus:()I
     344: invokeinterface #46,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     349: return
     350: aload         9
     352: aload         10
     354: invokevirtual #48                 // Method org/apache/catalina/filters/CsrfPreventionFilter$LruCache.contains:(Ljava/lang/Object;)Z
     357: ifne          453
     360: aload_0
     361: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     364: invokeinterface #38,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     369: ifeq          441
     372: aload_0
     373: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     376: new           #28                 // class java/lang/StringBuilder
     379: dup
     380: invokespecial #29                 // Method java/lang/StringBuilder."<init>":()V
     383: ldc           #39                 // String Rejecting request for
     385: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     388: aload_0
     389: aload         5
     391: invokevirtual #25                 // Method getRequestedPath:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
     394: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     397: ldc           #40                 // String , session
     399: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     402: aconst_null
     403: aload         8
     405: if_acmpne     413
     408: ldc           #41                 // String (none)
     410: goto          420
     413: aload         8
     415: invokeinterface #42,  1           // InterfaceMethod javax/servlet/http/HttpSession.getId:()Ljava/lang/String;
     420: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     423: ldc           #49                 // String  due to invalid nonce
     425: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     428: aload         10
     430: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     433: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     436: invokeinterface #44,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     441: aload         6
     443: aload_0
     444: invokevirtual #45                 // Method getDenyStatus:()I
     447: invokeinterface #46,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     452: return
     453: aload_0
     454: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     457: invokeinterface #27,  1           // InterfaceMethod org/apache/juli/logging/Log.isTraceEnabled:()Z
     462: ifeq          508
     465: aload_0
     466: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     469: new           #28                 // class java/lang/StringBuilder
     472: dup
     473: invokespecial #29                 // Method java/lang/StringBuilder."<init>":()V
     476: ldc           #50                 // String Allowing request to
     478: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     481: aload_0
     482: aload         5
     484: invokevirtual #25                 // Method getRequestedPath:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
     487: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     490: ldc           #51                 // String  with valid CSRF nonce
     492: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     495: aload         10
     497: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     500: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     503: invokeinterface #33,  2           // InterfaceMethod org/apache/juli/logging/Log.trace:(Ljava/lang/Object;)V
     508: aload         9
     510: ifnonnull     644
     513: aload_0
     514: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     517: invokeinterface #38,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     522: ifeq          582
     525: aload_0
     526: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     529: new           #28                 // class java/lang/StringBuilder
     532: dup
     533: invokespecial #29                 // Method java/lang/StringBuilder."<init>":()V
     536: ldc           #52                 // String Creating new CSRF nonce cache with size=
     538: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     541: aload_0
     542: getfield      #8                  // Field nonceCacheSize:I
     545: invokevirtual #53                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     548: ldc           #54                 // String  for session
     550: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     553: aconst_null
     554: aload         8
     556: if_acmpne     564
     559: ldc           #55                 // String (will create)
     561: goto          571
     564: aload         8
     566: invokeinterface #42,  1           // InterfaceMethod javax/servlet/http/HttpSession.getId:()Ljava/lang/String;
     571: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     574: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     577: invokeinterface #44,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     582: new           #36                 // class org/apache/catalina/filters/CsrfPreventionFilter$LruCache
     585: dup
     586: aload_0
     587: getfield      #8                  // Field nonceCacheSize:I
     590: invokespecial #56                 // Method org/apache/catalina/filters/CsrfPreventionFilter$LruCache."<init>":(I)V
     593: astore        9
     595: aload         8
     597: ifnonnull     633
     600: aload_0
     601: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     604: invokeinterface #38,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     609: ifeq          623
     612: aload_0
     613: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     616: ldc           #57                 // String Creating new session to store CSRF nonce cache
     618: invokeinterface #44,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     623: aload         5
     625: iconst_1
     626: invokeinterface #34,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getSession:(Z)Ljavax/servlet/http/HttpSession;
     631: astore        8
     633: aload         8
     635: ldc           #10                 // String org.apache.catalina.filters.CSRF_NONCE
     637: aload         9
     639: invokeinterface #58,  3           // InterfaceMethod javax/servlet/http/HttpSession.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
     644: aload_0
     645: invokevirtual #59                 // Method generateNonce:()Ljava/lang/String;
     648: astore        10
     650: aload         9
     652: aload         10
     654: invokevirtual #60                 // Method org/apache/catalina/filters/CsrfPreventionFilter$LruCache.add:(Ljava/lang/Object;)V
     657: aload_1
     658: ldc           #61                 // String org.apache.catalina.filters.CSRF_REQUEST_NONCE
     660: aload         10
     662: invokeinterface #62,  3           // InterfaceMethod javax/servlet/ServletRequest.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
     667: new           #63                 // class org/apache/catalina/filters/CsrfPreventionFilter$CsrfResponseWrapper
     670: dup
     671: aload         6
     673: aload_0
     674: getfield      #11                 // Field nonceRequestParameterName:Ljava/lang/String;
     677: aload         10
     679: invokespecial #64                 // Method org/apache/catalina/filters/CsrfPreventionFilter$CsrfResponseWrapper."<init>":(Ljavax/servlet/http/HttpServletResponse;Ljava/lang/String;Ljava/lang/String;)V
     682: astore        4
     684: goto          690
     687: aload_2
     688: astore        4
     690: aload_3
     691: aload_1
     692: aload         4
     694: invokeinterface #65,  3           // InterfaceMethod javax/servlet/FilterChain.doFilter:(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V
     699: return
}
