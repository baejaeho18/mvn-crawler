Compiled from "SpnegoAuthenticator.java"
public class org.apache.catalina.authenticator.SpnegoAuthenticator extends org.apache.catalina.authenticator.AuthenticatorBase {
  private final org.apache.juli.logging.Log log;

  private static final java.lang.String AUTH_HEADER_VALUE_NEGOTIATE;

  private java.lang.String loginConfigName;

  private boolean storeDelegatedCredential;

  private java.util.regex.Pattern noKeepAliveUserAgents;

  private boolean applyJava8u40Fix;

  public org.apache.catalina.authenticator.SpnegoAuthenticator();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/catalina/authenticator/AuthenticatorBase."<init>":()V
       4: aload_0
       5: ldc           #2                  // class org/apache/catalina/authenticator/SpnegoAuthenticator
       7: invokestatic  #3                  // Method org/apache/juli/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/juli/logging/Log;
      10: putfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      13: aload_0
      14: ldc           #6                  // String com.sun.security.jgss.krb5.accept
      16: putfield      #7                  // Field loginConfigName:Ljava/lang/String;
      19: aload_0
      20: iconst_1
      21: putfield      #8                  // Field storeDelegatedCredential:Z
      24: aload_0
      25: aconst_null
      26: putfield      #9                  // Field noKeepAliveUserAgents:Ljava/util/regex/Pattern;
      29: aload_0
      30: iconst_1
      31: putfield      #10                 // Field applyJava8u40Fix:Z
      34: return

  public java.lang.String getLoginConfigName();
    Code:
       0: aload_0
       1: getfield      #7                  // Field loginConfigName:Ljava/lang/String;
       4: areturn

  public void setLoginConfigName(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #7                  // Field loginConfigName:Ljava/lang/String;
       5: return

  public boolean isStoreDelegatedCredential();
    Code:
       0: aload_0
       1: getfield      #8                  // Field storeDelegatedCredential:Z
       4: ireturn

  public void setStoreDelegatedCredential(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #8                  // Field storeDelegatedCredential:Z
       5: return

  public java.lang.String getNoKeepAliveUserAgents();
    Code:
       0: aload_0
       1: getfield      #9                  // Field noKeepAliveUserAgents:Ljava/util/regex/Pattern;
       4: astore_1
       5: aload_1
       6: ifnonnull     11
       9: aconst_null
      10: areturn
      11: aload_1
      12: invokevirtual #11                 // Method java/util/regex/Pattern.pattern:()Ljava/lang/String;
      15: areturn

  public void setNoKeepAliveUserAgents(java.lang.String);
    Code:
       0: aload_1
       1: ifnull        11
       4: aload_1
       5: invokevirtual #12                 // Method java/lang/String.length:()I
       8: ifne          19
      11: aload_0
      12: aconst_null
      13: putfield      #9                  // Field noKeepAliveUserAgents:Ljava/util/regex/Pattern;
      16: goto          27
      19: aload_0
      20: aload_1
      21: invokestatic  #13                 // Method java/util/regex/Pattern.compile:(Ljava/lang/String;)Ljava/util/regex/Pattern;
      24: putfield      #9                  // Field noKeepAliveUserAgents:Ljava/util/regex/Pattern;
      27: return

  public boolean getApplyJava8u40Fix();
    Code:
       0: aload_0
       1: getfield      #10                 // Field applyJava8u40Fix:Z
       4: ireturn

  public void setApplyJava8u40Fix(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #10                 // Field applyJava8u40Fix:Z
       5: return

  protected java.lang.String getAuthMethod();
    Code:
       0: ldc           #14                 // String SPNEGO
       2: areturn

  protected void initInternal() throws org.apache.catalina.LifecycleException;
    Code:
       0: aload_0
       1: invokespecial #15                 // Method org/apache/catalina/authenticator/AuthenticatorBase.initInternal:()V
       4: ldc           #16                 // String java.security.krb5.conf
       6: invokestatic  #17                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       9: astore_1
      10: aload_1
      11: ifnonnull     43
      14: new           #18                 // class java/io/File
      17: dup
      18: aload_0
      19: getfield      #19                 // Field container:Lorg/apache/catalina/Container;
      22: invokeinterface #20,  1           // InterfaceMethod org/apache/catalina/Container.getCatalinaBase:()Ljava/io/File;
      27: ldc           #21                 // String conf/krb5.ini
      29: invokespecial #22                 // Method java/io/File."<init>":(Ljava/io/File;Ljava/lang/String;)V
      32: astore_2
      33: ldc           #16                 // String java.security.krb5.conf
      35: aload_2
      36: invokevirtual #23                 // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
      39: invokestatic  #24                 // Method java/lang/System.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      42: pop
      43: ldc           #25                 // String java.security.auth.login.config
      45: invokestatic  #17                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      48: astore_2
      49: aload_2
      50: ifnonnull     82
      53: new           #18                 // class java/io/File
      56: dup
      57: aload_0
      58: getfield      #19                 // Field container:Lorg/apache/catalina/Container;
      61: invokeinterface #20,  1           // InterfaceMethod org/apache/catalina/Container.getCatalinaBase:()Ljava/io/File;
      66: ldc           #26                 // String conf/jaas.conf
      68: invokespecial #22                 // Method java/io/File."<init>":(Ljava/io/File;Ljava/lang/String;)V
      71: astore_3
      72: ldc           #25                 // String java.security.auth.login.config
      74: aload_3
      75: invokevirtual #23                 // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
      78: invokestatic  #24                 // Method java/lang/System.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      81: pop
      82: return

  protected boolean doAuthenticate(org.apache.catalina.connector.Request, javax.servlet.http.HttpServletResponse) throws java.io.IOException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: iconst_1
       4: invokevirtual #27                 // Method checkForCachedAuthentication:(Lorg/apache/catalina/connector/Request;Ljavax/servlet/http/HttpServletResponse;Z)Z
       7: ifeq          12
      10: iconst_1
      11: ireturn
      12: aload_1
      13: invokevirtual #28                 // Method org/apache/catalina/connector/Request.getCoyoteRequest:()Lorg/apache/coyote/Request;
      16: invokevirtual #29                 // Method org/apache/coyote/Request.getMimeHeaders:()Lorg/apache/tomcat/util/http/MimeHeaders;
      19: ldc           #30                 // String authorization
      21: invokevirtual #31                 // Method org/apache/tomcat/util/http/MimeHeaders.getValue:(Ljava/lang/String;)Lorg/apache/tomcat/util/buf/MessageBytes;
      24: astore_3
      25: aload_3
      26: ifnonnull     79
      29: aload_0
      30: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      33: invokeinterface #32,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
      38: ifeq          58
      41: aload_0
      42: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
      45: getstatic     #33                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      48: ldc           #34                 // String authenticator.noAuthHeader
      50: invokevirtual #35                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      53: invokeinterface #36,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
      58: aload_2
      59: ldc           #38                 // String WWW-Authenticate
      61: ldc           #39                 // String Negotiate
      63: invokeinterface #40,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
      68: aload_2
      69: sipush        401
      72: invokeinterface #42,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
      77: iconst_0
      78: ireturn
      79: aload_3
      80: invokevirtual #43                 // Method org/apache/tomcat/util/buf/MessageBytes.toBytes:()V
      83: aload_3
      84: invokevirtual #44                 // Method org/apache/tomcat/util/buf/MessageBytes.getByteChunk:()Lorg/apache/tomcat/util/buf/ByteChunk;
      87: astore        4
      89: aload         4
      91: ldc           #45                 // String negotiate
      93: iconst_0
      94: invokevirtual #46                 // Method org/apache/tomcat/util/buf/ByteChunk.startsWithIgnoreCase:(Ljava/lang/String;I)Z
      97: ifne          150
     100: aload_0
     101: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     104: invokeinterface #32,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     109: ifeq          129
     112: aload_0
     113: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     116: getstatic     #33                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     119: ldc           #47                 // String spnegoAuthenticator.authHeaderNotNego
     121: invokevirtual #35                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     124: invokeinterface #36,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     129: aload_2
     130: ldc           #38                 // String WWW-Authenticate
     132: ldc           #39                 // String Negotiate
     134: invokeinterface #40,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
     139: aload_2
     140: sipush        401
     143: invokeinterface #42,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     148: iconst_0
     149: ireturn
     150: aload         4
     152: aload         4
     154: invokevirtual #48                 // Method org/apache/tomcat/util/buf/ByteChunk.getOffset:()I
     157: bipush        10
     159: iadd
     160: invokevirtual #49                 // Method org/apache/tomcat/util/buf/ByteChunk.setOffset:(I)V
     163: aload         4
     165: invokevirtual #50                 // Method org/apache/tomcat/util/buf/ByteChunk.getBuffer:()[B
     168: aload         4
     170: invokevirtual #48                 // Method org/apache/tomcat/util/buf/ByteChunk.getOffset:()I
     173: aload         4
     175: invokevirtual #51                 // Method org/apache/tomcat/util/buf/ByteChunk.getLength:()I
     178: invokestatic  #52                 // Method org/apache/tomcat/util/codec/binary/Base64.decodeBase64:([BII)[B
     181: astore        5
     183: aload_0
     184: invokevirtual #53                 // Method getApplyJava8u40Fix:()Z
     187: ifeq          195
     190: aload         5
     192: invokestatic  #54                 // Method org/apache/catalina/authenticator/SpnegoAuthenticator$SpnegoTokenFixer.fix:([B)V
     195: aload         5
     197: arraylength
     198: ifne          251
     201: aload_0
     202: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     205: invokeinterface #32,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     210: ifeq          230
     213: aload_0
     214: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     217: getstatic     #33                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     220: ldc           #55                 // String spnegoAuthenticator.authHeaderNoToken
     222: invokevirtual #35                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     225: invokeinterface #36,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     230: aload_2
     231: ldc           #38                 // String WWW-Authenticate
     233: ldc           #39                 // String Negotiate
     235: invokeinterface #40,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
     240: aload_2
     241: sipush        401
     244: invokeinterface #42,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     249: iconst_0
     250: ireturn
     251: aconst_null
     252: astore        6
     254: aconst_null
     255: astore        7
     257: aconst_null
     258: astore        8
     260: aconst_null
     261: astore        9
     263: new           #56                 // class javax/security/auth/login/LoginContext
     266: dup
     267: aload_0
     268: invokevirtual #57                 // Method getLoginConfigName:()Ljava/lang/String;
     271: invokespecial #58                 // Method javax/security/auth/login/LoginContext."<init>":(Ljava/lang/String;)V
     274: astore        6
     276: aload         6
     278: invokevirtual #59                 // Method javax/security/auth/login/LoginContext.login:()V
     281: goto          352
     284: astore        10
     286: aload_0
     287: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     290: getstatic     #33                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     293: ldc           #61                 // String spnegoAuthenticator.serviceLoginFail
     295: invokevirtual #35                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     298: aload         10
     300: invokeinterface #62,  3           // InterfaceMethod org/apache/juli/logging/Log.error:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     305: aload_2
     306: sipush        500
     309: invokeinterface #42,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     314: iconst_0
     315: istore        11
     317: aload         7
     319: ifnull        334
     322: aload         7
     324: invokeinterface #63,  1           // InterfaceMethod org/ietf/jgss/GSSContext.dispose:()V
     329: goto          334
     332: astore        12
     334: aload         6
     336: ifnull        349
     339: aload         6
     341: invokevirtual #65                 // Method javax/security/auth/login/LoginContext.logout:()V
     344: goto          349
     347: astore        12
     349: iload         11
     351: ireturn
     352: aload         6
     354: invokevirtual #66                 // Method javax/security/auth/login/LoginContext.getSubject:()Ljavax/security/auth/Subject;
     357: astore        10
     359: invokestatic  #67                 // Method org/ietf/jgss/GSSManager.getInstance:()Lorg/ietf/jgss/GSSManager;
     362: astore        11
     364: getstatic     #68                 // Field org/apache/tomcat/util/compat/JreVendor.IS_IBM_JVM:Z
     367: ifeq          377
     370: ldc           #70                 // int 2147483647
     372: istore        12
     374: goto          380
     377: iconst_0
     378: istore        12
     380: new           #71                 // class org/apache/catalina/authenticator/SpnegoAuthenticator$1
     383: dup
     384: aload_0
     385: aload         11
     387: iload         12
     389: invokespecial #72                 // Method org/apache/catalina/authenticator/SpnegoAuthenticator$1."<init>":(Lorg/apache/catalina/authenticator/SpnegoAuthenticator;Lorg/ietf/jgss/GSSManager;I)V
     392: astore        13
     394: aload         11
     396: aload         10
     398: aload         13
     400: invokestatic  #73                 // Method javax/security/auth/Subject.doAs:(Ljavax/security/auth/Subject;Ljava/security/PrivilegedExceptionAction;)Ljava/lang/Object;
     403: checkcast     #69                 // class org/ietf/jgss/GSSCredential
     406: invokevirtual #74                 // Method org/ietf/jgss/GSSManager.createContext:(Lorg/ietf/jgss/GSSCredential;)Lorg/ietf/jgss/GSSContext;
     409: astore        7
     411: aload         6
     413: invokevirtual #66                 // Method javax/security/auth/login/LoginContext.getSubject:()Ljavax/security/auth/Subject;
     416: new           #75                 // class org/apache/catalina/authenticator/SpnegoAuthenticator$AcceptAction
     419: dup
     420: aload         7
     422: aload         5
     424: invokespecial #76                 // Method org/apache/catalina/authenticator/SpnegoAuthenticator$AcceptAction."<init>":(Lorg/ietf/jgss/GSSContext;[B)V
     427: invokestatic  #73                 // Method javax/security/auth/Subject.doAs:(Ljavax/security/auth/Subject;Ljava/security/PrivilegedExceptionAction;)Ljava/lang/Object;
     430: checkcast     #77                 // class "[B"
     433: astore        8
     435: aload         8
     437: ifnonnull     526
     440: aload_0
     441: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     444: invokeinterface #32,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     449: ifeq          469
     452: aload_0
     453: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     456: getstatic     #33                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     459: ldc           #78                 // String spnegoAuthenticator.ticketValidateFail
     461: invokevirtual #35                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     464: invokeinterface #36,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     469: aload_2
     470: ldc           #38                 // String WWW-Authenticate
     472: ldc           #39                 // String Negotiate
     474: invokeinterface #40,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
     479: aload_2
     480: sipush        401
     483: invokeinterface #42,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     488: iconst_0
     489: istore        14
     491: aload         7
     493: ifnull        508
     496: aload         7
     498: invokeinterface #63,  1           // InterfaceMethod org/ietf/jgss/GSSContext.dispose:()V
     503: goto          508
     506: astore        15
     508: aload         6
     510: ifnull        523
     513: aload         6
     515: invokevirtual #65                 // Method javax/security/auth/login/LoginContext.logout:()V
     518: goto          523
     521: astore        15
     523: iload         14
     525: ireturn
     526: aload         10
     528: new           #79                 // class org/apache/catalina/authenticator/SpnegoAuthenticator$AuthenticateAction
     531: dup
     532: aload_0
     533: getfield      #80                 // Field context:Lorg/apache/catalina/Context;
     536: invokeinterface #81,  1           // InterfaceMethod org/apache/catalina/Context.getRealm:()Lorg/apache/catalina/Realm;
     541: aload         7
     543: aload_0
     544: getfield      #8                  // Field storeDelegatedCredential:Z
     547: invokespecial #82                 // Method org/apache/catalina/authenticator/SpnegoAuthenticator$AuthenticateAction."<init>":(Lorg/apache/catalina/Realm;Lorg/ietf/jgss/GSSContext;Z)V
     550: invokestatic  #83                 // Method javax/security/auth/Subject.doAs:(Ljavax/security/auth/Subject;Ljava/security/PrivilegedAction;)Ljava/lang/Object;
     553: checkcast     #84                 // class java/security/Principal
     556: astore        9
     558: aload         7
     560: ifnull        575
     563: aload         7
     565: invokeinterface #63,  1           // InterfaceMethod org/ietf/jgss/GSSContext.dispose:()V
     570: goto          575
     573: astore        10
     575: aload         6
     577: ifnull        847
     580: aload         6
     582: invokevirtual #65                 // Method javax/security/auth/login/LoginContext.logout:()V
     585: goto          847
     588: astore        10
     590: goto          847
     593: astore        10
     595: aload_0
     596: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     599: invokeinterface #32,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     604: ifeq          626
     607: aload_0
     608: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     611: getstatic     #33                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     614: ldc           #78                 // String spnegoAuthenticator.ticketValidateFail
     616: invokevirtual #35                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     619: aload         10
     621: invokeinterface #85,  3           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     626: aload_2
     627: ldc           #38                 // String WWW-Authenticate
     629: ldc           #39                 // String Negotiate
     631: invokeinterface #40,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
     636: aload_2
     637: sipush        401
     640: invokeinterface #42,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     645: iconst_0
     646: istore        11
     648: aload         7
     650: ifnull        665
     653: aload         7
     655: invokeinterface #63,  1           // InterfaceMethod org/ietf/jgss/GSSContext.dispose:()V
     660: goto          665
     663: astore        12
     665: aload         6
     667: ifnull        680
     670: aload         6
     672: invokevirtual #65                 // Method javax/security/auth/login/LoginContext.logout:()V
     675: goto          680
     678: astore        12
     680: iload         11
     682: ireturn
     683: astore        10
     685: aload         10
     687: invokevirtual #87                 // Method java/security/PrivilegedActionException.getCause:()Ljava/lang/Throwable;
     690: astore        11
     692: aload         11
     694: instanceof    #64                 // class org/ietf/jgss/GSSException
     697: ifeq          734
     700: aload_0
     701: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     704: invokeinterface #32,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     709: ifeq          753
     712: aload_0
     713: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     716: getstatic     #33                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     719: ldc           #61                 // String spnegoAuthenticator.serviceLoginFail
     721: invokevirtual #35                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     724: aload         10
     726: invokeinterface #85,  3           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     731: goto          753
     734: aload_0
     735: getfield      #4                  // Field log:Lorg/apache/juli/logging/Log;
     738: getstatic     #33                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     741: ldc           #61                 // String spnegoAuthenticator.serviceLoginFail
     743: invokevirtual #35                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     746: aload         10
     748: invokeinterface #62,  3           // InterfaceMethod org/apache/juli/logging/Log.error:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     753: aload_2
     754: ldc           #38                 // String WWW-Authenticate
     756: ldc           #39                 // String Negotiate
     758: invokeinterface #40,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
     763: aload_2
     764: sipush        401
     767: invokeinterface #42,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     772: iconst_0
     773: istore        12
     775: aload         7
     777: ifnull        792
     780: aload         7
     782: invokeinterface #63,  1           // InterfaceMethod org/ietf/jgss/GSSContext.dispose:()V
     787: goto          792
     790: astore        13
     792: aload         6
     794: ifnull        807
     797: aload         6
     799: invokevirtual #65                 // Method javax/security/auth/login/LoginContext.logout:()V
     802: goto          807
     805: astore        13
     807: iload         12
     809: ireturn
     810: astore        16
     812: aload         7
     814: ifnull        829
     817: aload         7
     819: invokeinterface #63,  1           // InterfaceMethod org/ietf/jgss/GSSContext.dispose:()V
     824: goto          829
     827: astore        17
     829: aload         6
     831: ifnull        844
     834: aload         6
     836: invokevirtual #65                 // Method javax/security/auth/login/LoginContext.logout:()V
     839: goto          844
     842: astore        17
     844: aload         16
     846: athrow
     847: aload_2
     848: ldc           #38                 // String WWW-Authenticate
     850: new           #88                 // class java/lang/StringBuilder
     853: dup
     854: invokespecial #89                 // Method java/lang/StringBuilder."<init>":()V
     857: ldc           #90                 // String Negotiate
     859: invokevirtual #91                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     862: aload         8
     864: invokestatic  #92                 // Method org/apache/tomcat/util/codec/binary/Base64.encodeBase64String:([B)Ljava/lang/String;
     867: invokevirtual #91                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     870: invokevirtual #93                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     873: invokeinterface #40,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
     878: aload         9
     880: ifnull        959
     883: aload_0
     884: aload_1
     885: aload_2
     886: aload         9
     888: ldc           #14                 // String SPNEGO
     890: aload         9
     892: invokeinterface #94,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
     897: aconst_null
     898: invokevirtual #95                 // Method register:(Lorg/apache/catalina/connector/Request;Ljavax/servlet/http/HttpServletResponse;Ljava/security/Principal;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     901: aload_0
     902: getfield      #9                  // Field noKeepAliveUserAgents:Ljava/util/regex/Pattern;
     905: astore        10
     907: aload         10
     909: ifnull        957
     912: aload_1
     913: invokevirtual #28                 // Method org/apache/catalina/connector/Request.getCoyoteRequest:()Lorg/apache/coyote/Request;
     916: invokevirtual #29                 // Method org/apache/coyote/Request.getMimeHeaders:()Lorg/apache/tomcat/util/http/MimeHeaders;
     919: ldc           #96                 // String user-agent
     921: invokevirtual #31                 // Method org/apache/tomcat/util/http/MimeHeaders.getValue:(Ljava/lang/String;)Lorg/apache/tomcat/util/buf/MessageBytes;
     924: astore        11
     926: aload         11
     928: ifnull        957
     931: aload         10
     933: aload         11
     935: invokevirtual #97                 // Method org/apache/tomcat/util/buf/MessageBytes.toString:()Ljava/lang/String;
     938: invokevirtual #98                 // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
     941: invokevirtual #99                 // Method java/util/regex/Matcher.matches:()Z
     944: ifeq          957
     947: aload_2
     948: ldc           #100                // String Connection
     950: ldc           #101                // String close
     952: invokeinterface #40,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
     957: iconst_1
     958: ireturn
     959: aload_2
     960: sipush        401
     963: invokeinterface #42,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     968: iconst_0
     969: ireturn
    Exception table:
       from    to  target type
         263   281   284   Class javax/security/auth/login/LoginException
         322   329   332   Class org/ietf/jgss/GSSException
         339   344   347   Class javax/security/auth/login/LoginException
         496   503   506   Class org/ietf/jgss/GSSException
         513   518   521   Class javax/security/auth/login/LoginException
         563   570   573   Class org/ietf/jgss/GSSException
         580   585   588   Class javax/security/auth/login/LoginException
         263   317   593   Class org/ietf/jgss/GSSException
         352   491   593   Class org/ietf/jgss/GSSException
         526   558   593   Class org/ietf/jgss/GSSException
         653   660   663   Class org/ietf/jgss/GSSException
         670   675   678   Class javax/security/auth/login/LoginException
         263   317   683   Class java/security/PrivilegedActionException
         352   491   683   Class java/security/PrivilegedActionException
         526   558   683   Class java/security/PrivilegedActionException
         780   787   790   Class org/ietf/jgss/GSSException
         797   802   805   Class javax/security/auth/login/LoginException
         263   317   810   any
         352   491   810   any
         526   558   810   any
         593   648   810   any
         683   775   810   any
         817   824   827   Class org/ietf/jgss/GSSException
         834   839   842   Class javax/security/auth/login/LoginException
         810   812   810   any
}
