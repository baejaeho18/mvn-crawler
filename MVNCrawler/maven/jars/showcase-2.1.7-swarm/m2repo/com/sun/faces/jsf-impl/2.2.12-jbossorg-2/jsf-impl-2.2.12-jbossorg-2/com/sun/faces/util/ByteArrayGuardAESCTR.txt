Compiled from "ByteArrayGuardAESCTR.java"
public final class com.sun.faces.util.ByteArrayGuardAESCTR {
  private static final java.util.logging.Logger LOGGER;

  private static final int KEY_LENGTH;

  private static final int IV_LENGTH;

  private static final java.lang.String KEY_ALGORITHM;

  private static final java.lang.String CIPHER_CODE;

  private javax.crypto.SecretKey sk;

  private javax.crypto.spec.IvParameterSpec ivspec;

  private java.nio.charset.Charset utf8;

  public com.sun.faces.util.ByteArrayGuardAESCTR();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: invokespecial #2                  // Method setupKeyAndCharset:()V
       8: goto          44
      11: astore_1
      12: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
      15: getstatic     #5                  // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
      18: invokevirtual #6                  // Method java/util/logging/Logger.isLoggable:(Ljava/util/logging/Level;)Z
      21: ifeq          36
      24: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
      27: getstatic     #5                  // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
      30: ldc           #7                  // String Unexpected exception initializing encryption.  No encryption will be performed.
      32: aload_1
      33: invokevirtual #8                  // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
      36: getstatic     #9                  // Field java/lang/System.err:Ljava/io/PrintStream;
      39: ldc           #10                 // String ERROR: Initializing Ciphers
      41: invokevirtual #11                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
      44: return
    Exception table:
       from    to  target type
           4     8    11   Class java/lang/Exception

  public java.lang.String encrypt(java.lang.String);
    Code:
       0: aconst_null
       1: astore_2
       2: aload_1
       3: aload_0
       4: getfield      #12                 // Field utf8:Ljava/nio/charset/Charset;
       7: invokevirtual #13                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
      10: astore_3
      11: ldc           #14                 // String AES/CTR/NoPadding
      13: invokestatic  #15                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
      16: astore        4
      18: aload         4
      20: iconst_1
      21: aload_0
      22: getfield      #16                 // Field sk:Ljavax/crypto/SecretKey;
      25: aload_0
      26: getfield      #17                 // Field ivspec:Ljavax/crypto/spec/IvParameterSpec;
      29: invokevirtual #18                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
      32: aload         4
      34: aload_3
      35: invokevirtual #19                 // Method javax/crypto/Cipher.doFinal:([B)[B
      38: astore        5
      40: aload         5
      42: invokestatic  #20                 // Method javax/xml/bind/DatatypeConverter.printBase64Binary:([B)Ljava/lang/String;
      45: astore_2
      46: goto          78
      49: astore        4
      51: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
      54: getstatic     #5                  // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
      57: invokevirtual #6                  // Method java/util/logging/Logger.isLoggable:(Ljava/util/logging/Level;)Z
      60: ifeq          76
      63: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
      66: getstatic     #5                  // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
      69: ldc           #7                  // String Unexpected exception initializing encryption.  No encryption will be performed.
      71: aload         4
      73: invokevirtual #8                  // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
      76: aconst_null
      77: areturn
      78: aload_2
      79: areturn
    Exception table:
       from    to  target type
          11    46    49   Class java/lang/Exception

  public java.lang.String decrypt(java.lang.String) throws java.security.InvalidKeyException;
    Code:
       0: aload_1
       1: invokestatic  #21                 // Method javax/xml/bind/DatatypeConverter.parseBase64Binary:(Ljava/lang/String;)[B
       4: astore_2
       5: ldc           #14                 // String AES/CTR/NoPadding
       7: invokestatic  #15                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
      10: astore_3
      11: aload_3
      12: iconst_2
      13: aload_0
      14: getfield      #16                 // Field sk:Ljavax/crypto/SecretKey;
      17: aload_0
      18: getfield      #17                 // Field ivspec:Ljavax/crypto/spec/IvParameterSpec;
      21: invokevirtual #18                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
      24: aload_3
      25: aload_2
      26: invokevirtual #19                 // Method javax/crypto/Cipher.doFinal:([B)[B
      29: astore        4
      31: aload         4
      33: astore        5
      35: aload         5
      37: arraylength
      38: istore        6
      40: iconst_0
      41: istore        7
      43: iload         7
      45: iload         6
      47: if_icmpge     85
      50: aload         5
      52: iload         7
      54: baload
      55: istore        8
      57: iload         8
      59: iflt          69
      62: iload         8
      64: bipush        127
      66: if_icmple     79
      69: new           #22                 // class java/security/InvalidKeyException
      72: dup
      73: ldc           #23                 // String Invalid characters in decrypted value
      75: invokespecial #24                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      78: athrow
      79: iinc          7, 1
      82: goto          43
      85: new           #25                 // class java/lang/String
      88: dup
      89: aload         4
      91: aload_0
      92: getfield      #12                 // Field utf8:Ljava/nio/charset/Charset;
      95: invokespecial #26                 // Method java/lang/String."<init>":([BLjava/nio/charset/Charset;)V
      98: areturn
      99: astore_3
     100: new           #22                 // class java/security/InvalidKeyException
     103: dup
     104: aload_3
     105: invokespecial #28                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/Throwable;)V
     108: athrow
     109: astore_3
     110: new           #22                 // class java/security/InvalidKeyException
     113: dup
     114: aload_3
     115: invokespecial #28                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/Throwable;)V
     118: athrow
     119: astore_3
     120: new           #22                 // class java/security/InvalidKeyException
     123: dup
     124: aload_3
     125: invokespecial #28                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/Throwable;)V
     128: athrow
     129: astore_3
     130: new           #22                 // class java/security/InvalidKeyException
     133: dup
     134: aload_3
     135: invokespecial #28                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/Throwable;)V
     138: athrow
     139: astore_3
     140: new           #22                 // class java/security/InvalidKeyException
     143: dup
     144: aload_3
     145: invokespecial #28                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/Throwable;)V
     148: athrow
    Exception table:
       from    to  target type
           5    98    99   Class java/security/NoSuchAlgorithmException
           5    98   109   Class javax/crypto/NoSuchPaddingException
           5    98   119   Class java/security/InvalidAlgorithmParameterException
           5    98   129   Class javax/crypto/IllegalBlockSizeException
           5    98   139   Class javax/crypto/BadPaddingException

  private void setupKeyAndCharset();
    Code:
       0: new           #33                 // class javax/naming/InitialContext
       3: dup
       4: invokespecial #34                 // Method javax/naming/InitialContext."<init>":()V
       7: astore_1
       8: aload_1
       9: ldc           #35                 // String java:comp/env/jsf/FlashSecretKey
      11: invokevirtual #36                 // Method javax/naming/InitialContext.lookup:(Ljava/lang/String;)Ljava/lang/Object;
      14: checkcast     #25                 // class java/lang/String
      17: astore_2
      18: aconst_null
      19: aload_2
      20: if_acmpeq     88
      23: aload_2
      24: invokestatic  #21                 // Method javax/xml/bind/DatatypeConverter.parseBase64Binary:(Ljava/lang/String;)[B
      27: astore_3
      28: aload_3
      29: arraylength
      30: bipush        17
      32: if_icmpge     45
      35: new           #37                 // class javax/faces/FacesException
      38: dup
      39: ldc           #38                 // String key must be at least 16 bytes long.
      41: invokespecial #39                 // Method javax/faces/FacesException."<init>":(Ljava/lang/String;)V
      44: athrow
      45: aload_0
      46: new           #40                 // class javax/crypto/spec/SecretKeySpec
      49: dup
      50: aload_3
      51: ldc           #41                 // String AES
      53: invokespecial #42                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      56: putfield      #16                 // Field sk:Ljavax/crypto/SecretKey;
      59: bipush        16
      61: newarray       byte
      63: astore        4
      65: aload_3
      66: iconst_0
      67: aload         4
      69: iconst_0
      70: bipush        16
      72: invokestatic  #43                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      75: aload_0
      76: new           #44                 // class javax/crypto/spec/IvParameterSpec
      79: dup
      80: aload         4
      82: invokespecial #45                 // Method javax/crypto/spec/IvParameterSpec."<init>":([B)V
      85: putfield      #17                 // Field ivspec:Ljavax/crypto/spec/IvParameterSpec;
      88: goto          129
      91: astore_1
      92: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
      95: getstatic     #47                 // Field java/util/logging/Level.FINEST:Ljava/util/logging/Level;
      98: invokevirtual #6                  // Method java/util/logging/Logger.isLoggable:(Ljava/util/logging/Level;)Z
     101: ifeq          116
     104: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
     107: getstatic     #47                 // Field java/util/logging/Level.FINEST:Ljava/util/logging/Level;
     110: ldc           #48                 // String Unable to find the encoded key.
     112: aload_1
     113: invokevirtual #8                  // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     116: goto          129
     119: astore_1
     120: new           #37                 // class javax/faces/FacesException
     123: dup
     124: aload_1
     125: invokespecial #49                 // Method javax/faces/FacesException."<init>":(Ljava/lang/Throwable;)V
     128: athrow
     129: aconst_null
     130: aload_0
     131: getfield      #16                 // Field sk:Ljavax/crypto/SecretKey;
     134: if_acmpne     201
     137: ldc           #41                 // String AES
     139: invokestatic  #50                 // Method javax/crypto/KeyGenerator.getInstance:(Ljava/lang/String;)Ljavax/crypto/KeyGenerator;
     142: astore_1
     143: aload_1
     144: sipush        128
     147: invokevirtual #51                 // Method javax/crypto/KeyGenerator.init:(I)V
     150: aload_0
     151: aload_1
     152: invokevirtual #52                 // Method javax/crypto/KeyGenerator.generateKey:()Ljavax/crypto/SecretKey;
     155: putfield      #16                 // Field sk:Ljavax/crypto/SecretKey;
     158: new           #53                 // class java/security/SecureRandom
     161: dup
     162: invokespecial #54                 // Method java/security/SecureRandom."<init>":()V
     165: astore_2
     166: bipush        16
     168: newarray       byte
     170: astore_3
     171: aload_2
     172: aload_3
     173: invokevirtual #55                 // Method java/security/SecureRandom.nextBytes:([B)V
     176: aload_0
     177: new           #44                 // class javax/crypto/spec/IvParameterSpec
     180: dup
     181: aload_3
     182: invokespecial #45                 // Method javax/crypto/spec/IvParameterSpec."<init>":([B)V
     185: putfield      #17                 // Field ivspec:Ljavax/crypto/spec/IvParameterSpec;
     188: goto          201
     191: astore_1
     192: new           #37                 // class javax/faces/FacesException
     195: dup
     196: aload_1
     197: invokespecial #49                 // Method javax/faces/FacesException."<init>":(Ljava/lang/Throwable;)V
     200: athrow
     201: invokestatic  #56                 // Method java/nio/charset/Charset.availableCharsets:()Ljava/util/SortedMap;
     204: astore_1
     205: aload_1
     206: ldc           #57                 // String UTF-8
     208: invokeinterface #58,  2           // InterfaceMethod java/util/SortedMap.containsKey:(Ljava/lang/Object;)Z
     213: ifeq          234
     216: aload_0
     217: aload_1
     218: ldc           #57                 // String UTF-8
     220: invokeinterface #59,  2           // InterfaceMethod java/util/SortedMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
     225: checkcast     #60                 // class java/nio/charset/Charset
     228: putfield      #12                 // Field utf8:Ljava/nio/charset/Charset;
     231: goto          273
     234: aload_1
     235: ldc           #61                 // String UTF8
     237: invokeinterface #58,  2           // InterfaceMethod java/util/SortedMap.containsKey:(Ljava/lang/Object;)Z
     242: ifeq          263
     245: aload_0
     246: aload_1
     247: ldc           #61                 // String UTF8
     249: invokeinterface #59,  2           // InterfaceMethod java/util/SortedMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
     254: checkcast     #60                 // class java/nio/charset/Charset
     257: putfield      #12                 // Field utf8:Ljava/nio/charset/Charset;
     260: goto          273
     263: new           #37                 // class javax/faces/FacesException
     266: dup
     267: ldc           #62                 // String Unable to get UTF-8 Charset.
     269: invokespecial #39                 // Method javax/faces/FacesException."<init>":(Ljava/lang/String;)V
     272: athrow
     273: return
    Exception table:
       from    to  target type
           0    88    91   Class javax/naming/NamingException
           0    88   119   Class java/lang/Exception
         137   188   191   Class java/lang/Exception

  static {};
    Code:
       0: getstatic     #63                 // Field com/sun/faces/util/FacesLogger.RENDERKIT:Lcom/sun/faces/util/FacesLogger;
       3: invokevirtual #64                 // Method com/sun/faces/util/FacesLogger.getLogger:()Ljava/util/logging/Logger;
       6: putstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
       9: return
}
