Compiled from "ByteArrayGuard.java"
public final class com.sun.faces.renderkit.ByteArrayGuard {
  private static final java.util.logging.Logger LOGGER;

  private static final int MAC_LENGTH;

  private static final int KEY_LENGTH;

  private static final int IV_LENGTH;

  private static final java.lang.String KEY_ALGORITHM;

  private static final java.lang.String CIPHER_CODE;

  private static final java.lang.String MAC_CODE;

  private javax.crypto.SecretKey sk;

  public com.sun.faces.renderkit.ByteArrayGuard();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: invokespecial #2                  // Method setupKeyAndMac:()V
       8: goto          44
      11: astore_1
      12: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
      15: getstatic     #5                  // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
      18: invokevirtual #6                  // Method java/util/logging/Logger.isLoggable:(Ljava/util/logging/Level;)Z
      21: ifeq          36
      24: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
      27: getstatic     #5                  // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
      30: ldc           #7                  // String Unexpected exception initializing encryption.  No encryption will be performed.
      32: aload_1
      33: invokevirtual #8                  // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
      36: getstatic     #9                  // Field java/lang/System.err:Ljava/io/PrintStream;
      39: ldc           #10                 // String ERROR: Initializing Ciphers
      41: invokevirtual #11                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
      44: return
    Exception table:
       from    to  target type
           4     8    11   Class java/lang/Exception

  public byte[] encrypt(byte[]);
    Code:
       0: aconst_null
       1: astore_2
       2: new           #12                 // class java/security/SecureRandom
       5: dup
       6: invokespecial #13                 // Method java/security/SecureRandom."<init>":()V
       9: astore_3
      10: bipush        16
      12: newarray       byte
      14: astore        4
      16: aload_3
      17: aload         4
      19: invokevirtual #14                 // Method java/security/SecureRandom.nextBytes:([B)V
      22: new           #15                 // class javax/crypto/spec/IvParameterSpec
      25: dup
      26: aload         4
      28: invokespecial #16                 // Method javax/crypto/spec/IvParameterSpec."<init>":([B)V
      31: astore        5
      33: ldc           #17                 // String AES/CBC/PKCS5Padding
      35: invokestatic  #18                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
      38: astore        6
      40: aload         6
      42: iconst_1
      43: aload_0
      44: getfield      #19                 // Field sk:Ljavax/crypto/SecretKey;
      47: aload         5
      49: invokevirtual #20                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
      52: ldc           #21                 // String HmacSHA256
      54: invokestatic  #22                 // Method javax/crypto/Mac.getInstance:(Ljava/lang/String;)Ljavax/crypto/Mac;
      57: astore        7
      59: aload         7
      61: aload_0
      62: getfield      #19                 // Field sk:Ljavax/crypto/SecretKey;
      65: invokevirtual #23                 // Method javax/crypto/Mac.init:(Ljava/security/Key;)V
      68: aload         7
      70: aload         4
      72: invokevirtual #24                 // Method javax/crypto/Mac.update:([B)V
      75: aload         6
      77: aload_1
      78: invokevirtual #25                 // Method javax/crypto/Cipher.doFinal:([B)[B
      81: astore        8
      83: aload         7
      85: aload         8
      87: invokevirtual #26                 // Method javax/crypto/Mac.doFinal:([B)[B
      90: astore        9
      92: aload         9
      94: aload         4
      96: invokestatic  #27                 // Method concatBytes:([B[B)[B
      99: astore        10
     101: aload         10
     103: aload         8
     105: invokestatic  #27                 // Method concatBytes:([B[B)[B
     108: astore_2
     109: goto          139
     112: astore_3
     113: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
     116: getstatic     #5                  // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
     119: invokevirtual #6                  // Method java/util/logging/Logger.isLoggable:(Ljava/util/logging/Level;)Z
     122: ifeq          137
     125: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
     128: getstatic     #5                  // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
     131: ldc           #7                  // String Unexpected exception initializing encryption.  No encryption will be performed.
     133: aload_3
     134: invokevirtual #8                  // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     137: aconst_null
     138: areturn
     139: aload_2
     140: areturn
    Exception table:
       from    to  target type
           2   109   112   Class java/lang/Exception

  public byte[] decrypt(byte[]);
    Code:
       0: bipush        32
       2: newarray       byte
       4: astore_2
       5: aload_1
       6: iconst_0
       7: aload_2
       8: iconst_0
       9: aload_2
      10: arraylength
      11: invokestatic  #28                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      14: bipush        16
      16: newarray       byte
      18: astore_3
      19: aload_1
      20: aload_2
      21: arraylength
      22: aload_3
      23: iconst_0
      24: aload_3
      25: arraylength
      26: invokestatic  #28                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      29: aload_1
      30: arraylength
      31: aload_2
      32: arraylength
      33: isub
      34: aload_3
      35: arraylength
      36: isub
      37: newarray       byte
      39: astore        4
      41: aload_1
      42: aload_2
      43: arraylength
      44: aload_3
      45: arraylength
      46: iadd
      47: aload         4
      49: iconst_0
      50: aload         4
      52: arraylength
      53: invokestatic  #28                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      56: new           #15                 // class javax/crypto/spec/IvParameterSpec
      59: dup
      60: aload_3
      61: invokespecial #16                 // Method javax/crypto/spec/IvParameterSpec."<init>":([B)V
      64: astore        5
      66: ldc           #17                 // String AES/CBC/PKCS5Padding
      68: invokestatic  #18                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
      71: astore        6
      73: aload         6
      75: iconst_2
      76: aload_0
      77: getfield      #19                 // Field sk:Ljavax/crypto/SecretKey;
      80: aload         5
      82: invokevirtual #20                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
      85: ldc           #21                 // String HmacSHA256
      87: invokestatic  #22                 // Method javax/crypto/Mac.getInstance:(Ljava/lang/String;)Ljavax/crypto/Mac;
      90: astore        7
      92: aload         7
      94: aload_0
      95: getfield      #19                 // Field sk:Ljavax/crypto/SecretKey;
      98: invokevirtual #23                 // Method javax/crypto/Mac.init:(Ljava/security/Key;)V
     101: aload         7
     103: aload_3
     104: invokevirtual #24                 // Method javax/crypto/Mac.update:([B)V
     107: aload         7
     109: aload         4
     111: invokevirtual #24                 // Method javax/crypto/Mac.update:([B)V
     114: aload         7
     116: invokevirtual #29                 // Method javax/crypto/Mac.doFinal:()[B
     119: astore        8
     121: aload_0
     122: aload_2
     123: aload         8
     125: invokespecial #30                 // Method areArrayEqualsConstantTime:([B[B)Z
     128: ifeq          143
     131: aload         6
     133: aload         4
     135: invokevirtual #25                 // Method javax/crypto/Cipher.doFinal:([B)[B
     138: astore        9
     140: aload         9
     142: areturn
     143: getstatic     #9                  // Field java/lang/System.err:Ljava/io/PrintStream;
     146: ldc           #31                 // String ERROR: MAC did not verify!
     148: invokevirtual #11                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
     151: aconst_null
     152: areturn
     153: astore_2
     154: getstatic     #9                  // Field java/lang/System.err:Ljava/io/PrintStream;
     157: new           #32                 // class java/lang/StringBuilder
     160: dup
     161: invokespecial #33                 // Method java/lang/StringBuilder."<init>":()V
     164: ldc           #34                 // String ERROR: Decrypting:
     166: invokevirtual #35                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     169: aload_2
     170: invokevirtual #36                 // Method java/lang/Exception.getCause:()Ljava/lang/Throwable;
     173: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     176: invokevirtual #38                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     179: invokevirtual #11                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
     182: aconst_null
     183: areturn
    Exception table:
       from    to  target type
           0   142   153   Class java/lang/Exception
         143   152   153   Class java/lang/Exception

  private boolean areArrayEqualsConstantTime(byte[], byte[]);
    Code:
       0: iconst_1
       1: istore_3
       2: iconst_0
       3: istore        4
       5: iload         4
       7: aload_1
       8: arraylength
       9: if_icmpge     31
      12: aload_1
      13: iload         4
      15: baload
      16: aload_2
      17: iload         4
      19: baload
      20: if_icmpeq     25
      23: iconst_0
      24: istore_3
      25: iinc          4, 1
      28: goto          5
      31: iload_3
      32: ireturn

  private void setupKeyAndMac();
    Code:
       0: new           #39                 // class javax/naming/InitialContext
       3: dup
       4: invokespecial #40                 // Method javax/naming/InitialContext."<init>":()V
       7: astore_1
       8: aload_1
       9: ldc           #41                 // String java:comp/env/jsf/ClientSideSecretKey
      11: invokevirtual #42                 // Method javax/naming/InitialContext.lookup:(Ljava/lang/String;)Ljava/lang/Object;
      14: checkcast     #43                 // class java/lang/String
      17: astore_2
      18: aload_2
      19: invokestatic  #44                 // Method javax/xml/bind/DatatypeConverter.parseBase64Binary:(Ljava/lang/String;)[B
      22: astore_3
      23: aload_0
      24: new           #45                 // class javax/crypto/spec/SecretKeySpec
      27: dup
      28: aload_3
      29: ldc           #46                 // String AES
      31: invokespecial #47                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      34: putfield      #19                 // Field sk:Ljavax/crypto/SecretKey;
      37: goto          65
      40: astore_1
      41: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
      44: getstatic     #49                 // Field java/util/logging/Level.FINEST:Ljava/util/logging/Level;
      47: invokevirtual #6                  // Method java/util/logging/Logger.isLoggable:(Ljava/util/logging/Level;)Z
      50: ifeq          65
      53: getstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
      56: getstatic     #49                 // Field java/util/logging/Level.FINEST:Ljava/util/logging/Level;
      59: ldc           #50                 // String Unable to find the encoded key.
      61: aload_1
      62: invokevirtual #8                  // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
      65: aload_0
      66: getfield      #19                 // Field sk:Ljavax/crypto/SecretKey;
      69: ifnonnull     106
      72: ldc           #46                 // String AES
      74: invokestatic  #51                 // Method javax/crypto/KeyGenerator.getInstance:(Ljava/lang/String;)Ljavax/crypto/KeyGenerator;
      77: astore_1
      78: aload_1
      79: sipush        128
      82: invokevirtual #52                 // Method javax/crypto/KeyGenerator.init:(I)V
      85: aload_0
      86: aload_1
      87: invokevirtual #53                 // Method javax/crypto/KeyGenerator.generateKey:()Ljavax/crypto/SecretKey;
      90: putfield      #19                 // Field sk:Ljavax/crypto/SecretKey;
      93: goto          106
      96: astore_1
      97: new           #54                 // class javax/faces/FacesException
     100: dup
     101: aload_1
     102: invokespecial #55                 // Method javax/faces/FacesException."<init>":(Ljava/lang/Throwable;)V
     105: athrow
     106: return
    Exception table:
       from    to  target type
           0    37    40   Class javax/naming/NamingException
          72    93    96   Class java/lang/Exception

  private static byte[] concatBytes(byte[], byte[]);
    Code:
       0: aload_0
       1: arraylength
       2: aload_1
       3: arraylength
       4: iadd
       5: newarray       byte
       7: astore_2
       8: aload_0
       9: iconst_0
      10: aload_2
      11: iconst_0
      12: aload_0
      13: arraylength
      14: invokestatic  #28                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      17: aload_1
      18: iconst_0
      19: aload_2
      20: aload_0
      21: arraylength
      22: aload_1
      23: arraylength
      24: invokestatic  #28                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      27: goto          40
      30: astore_3
      31: new           #54                 // class javax/faces/FacesException
      34: dup
      35: aload_3
      36: invokespecial #55                 // Method javax/faces/FacesException."<init>":(Ljava/lang/Throwable;)V
      39: athrow
      40: aload_2
      41: areturn
    Exception table:
       from    to  target type
           8    27    30   Class java/lang/Exception

  static {};
    Code:
       0: getstatic     #56                 // Field com/sun/faces/util/FacesLogger.RENDERKIT:Lcom/sun/faces/util/FacesLogger;
       3: invokevirtual #57                 // Method com/sun/faces/util/FacesLogger.getLogger:()Ljava/util/logging/Logger;
       6: putstatic     #4                  // Field LOGGER:Ljava/util/logging/Logger;
       9: return
}
