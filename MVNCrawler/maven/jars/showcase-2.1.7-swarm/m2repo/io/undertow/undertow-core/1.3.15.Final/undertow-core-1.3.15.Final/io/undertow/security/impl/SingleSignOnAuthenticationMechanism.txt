Compiled from "SingleSignOnAuthenticationMechanism.java"
public class io.undertow.security.impl.SingleSignOnAuthenticationMechanism implements io.undertow.security.api.AuthenticationMechanism {
  private static final java.lang.String SSO_SESSION_ATTRIBUTE;

  private final java.util.Set<io.undertow.server.session.SessionManager> seenSessionManagers;

  private java.lang.String cookieName;

  private boolean httpOnly;

  private boolean secure;

  private java.lang.String domain;

  private java.lang.String path;

  private final io.undertow.security.impl.SingleSignOnAuthenticationMechanism$SessionInvalidationListener listener;

  private final io.undertow.security.impl.SingleSignOnAuthenticationMechanism$ResponseListener responseListener;

  private final io.undertow.security.impl.SingleSignOnManager singleSignOnManager;

  private final io.undertow.security.idm.IdentityManager identityManager;

  public io.undertow.security.impl.SingleSignOnAuthenticationMechanism(io.undertow.security.impl.SingleSignOnManager);
    Code:
       0: aload_0
       1: aload_1
       2: aconst_null
       3: invokespecial #9                  // Method "<init>":(Lio/undertow/security/impl/SingleSignOnManager;Lio/undertow/security/idm/IdentityManager;)V
       6: return

  public io.undertow.security.impl.SingleSignOnAuthenticationMechanism(io.undertow.security.impl.SingleSignOnManager, io.undertow.security.idm.IdentityManager);
    Code:
       0: aload_0
       1: invokespecial #10                 // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #11                 // class java/util/WeakHashMap
       8: dup
       9: invokespecial #12                 // Method java/util/WeakHashMap."<init>":()V
      12: invokestatic  #13                 // Method java/util/Collections.newSetFromMap:(Ljava/util/Map;)Ljava/util/Set;
      15: invokestatic  #14                 // Method java/util/Collections.synchronizedSet:(Ljava/util/Set;)Ljava/util/Set;
      18: putfield      #15                 // Field seenSessionManagers:Ljava/util/Set;
      21: aload_0
      22: ldc           #16                 // String JSESSIONIDSSO
      24: putfield      #6                  // Field cookieName:Ljava/lang/String;
      27: aload_0
      28: new           #17                 // class io/undertow/security/impl/SingleSignOnAuthenticationMechanism$SessionInvalidationListener
      31: dup
      32: aload_0
      33: invokespecial #18                 // Method io/undertow/security/impl/SingleSignOnAuthenticationMechanism$SessionInvalidationListener."<init>":(Lio/undertow/security/impl/SingleSignOnAuthenticationMechanism;)V
      36: putfield      #19                 // Field listener:Lio/undertow/security/impl/SingleSignOnAuthenticationMechanism$SessionInvalidationListener;
      39: aload_0
      40: new           #20                 // class io/undertow/security/impl/SingleSignOnAuthenticationMechanism$ResponseListener
      43: dup
      44: aload_0
      45: invokespecial #21                 // Method io/undertow/security/impl/SingleSignOnAuthenticationMechanism$ResponseListener."<init>":(Lio/undertow/security/impl/SingleSignOnAuthenticationMechanism;)V
      48: putfield      #22                 // Field responseListener:Lio/undertow/security/impl/SingleSignOnAuthenticationMechanism$ResponseListener;
      51: aload_0
      52: aload_1
      53: putfield      #8                  // Field singleSignOnManager:Lio/undertow/security/impl/SingleSignOnManager;
      56: aload_0
      57: aload_2
      58: putfield      #23                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
      61: return

  private io.undertow.security.idm.IdentityManager getIdentityManager(io.undertow.security.api.SecurityContext);
    Code:
       0: aload_0
       1: getfield      #23                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
       4: ifnull        14
       7: aload_0
       8: getfield      #23                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
      11: goto          20
      14: aload_1
      15: invokeinterface #24,  1           // InterfaceMethod io/undertow/security/api/SecurityContext.getIdentityManager:()Lio/undertow/security/idm/IdentityManager;
      20: areturn

  public io.undertow.security.api.AuthenticationMechanism$AuthenticationMechanismOutcome authenticate(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_1
       1: invokevirtual #25                 // Method io/undertow/server/HttpServerExchange.getRequestCookies:()Ljava/util/Map;
       4: aload_0
       5: getfield      #6                  // Field cookieName:Ljava/lang/String;
       8: invokeinterface #26,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      13: checkcast     #27                 // class io/undertow/server/handlers/Cookie
      16: astore_3
      17: aload_3
      18: ifnull        315
      21: aload_3
      22: invokeinterface #28,  1           // InterfaceMethod io/undertow/server/handlers/Cookie.getValue:()Ljava/lang/String;
      27: astore        4
      29: aload_0
      30: getfield      #8                  // Field singleSignOnManager:Lio/undertow/security/impl/SingleSignOnManager;
      33: aload         4
      35: invokeinterface #29,  2           // InterfaceMethod io/undertow/security/impl/SingleSignOnManager.findSingleSignOn:(Ljava/lang/String;)Lio/undertow/security/impl/SingleSignOn;
      40: astore        5
      42: aconst_null
      43: astore        6
      45: aload         5
      47: ifnull        215
      50: aload_0
      51: aload_2
      52: invokespecial #30                 // Method getIdentityManager:(Lio/undertow/security/api/SecurityContext;)Lio/undertow/security/idm/IdentityManager;
      55: aload         5
      57: invokeinterface #31,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.getAccount:()Lio/undertow/security/idm/Account;
      62: invokeinterface #32,  2           // InterfaceMethod io/undertow/security/idm/IdentityManager.verify:(Lio/undertow/security/idm/Account;)Lio/undertow/security/idm/Account;
      67: astore        7
      69: aload         7
      71: ifnonnull     121
      74: getstatic     #33                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_ATTEMPTED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
      77: astore        8
      79: aload         5
      81: ifnull        118
      84: aload         6
      86: ifnull        111
      89: aload         5
      91: invokeinterface #34,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.close:()V
      96: goto          118
      99: astore        9
     101: aload         6
     103: aload         9
     105: invokevirtual #36                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     108: goto          118
     111: aload         5
     113: invokeinterface #34,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.close:()V
     118: aload         8
     120: areturn
     121: aload_0
     122: aload_1
     123: invokevirtual #37                 // Method getSession:(Lio/undertow/server/HttpServerExchange;)Lio/undertow/server/session/Session;
     126: astore        8
     128: aload_0
     129: aload         5
     131: aload         8
     133: invokespecial #7                  // Method registerSessionIfRequired:(Lio/undertow/security/impl/SingleSignOn;Lio/undertow/server/session/Session;)V
     136: aload_2
     137: aload         7
     139: aload         5
     141: invokeinterface #38,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.getMechanismName:()Ljava/lang/String;
     146: iconst_0
     147: invokeinterface #39,  4           // InterfaceMethod io/undertow/security/api/SecurityContext.authenticationComplete:(Lio/undertow/security/idm/Account;Ljava/lang/String;Z)V
     152: aload_2
     153: new           #40                 // class io/undertow/security/impl/SingleSignOnAuthenticationMechanism$1
     156: dup
     157: aload_0
     158: aload         5
     160: invokespecial #41                 // Method io/undertow/security/impl/SingleSignOnAuthenticationMechanism$1."<init>":(Lio/undertow/security/impl/SingleSignOnAuthenticationMechanism;Lio/undertow/security/impl/SingleSignOn;)V
     163: invokeinterface #42,  2           // InterfaceMethod io/undertow/security/api/SecurityContext.registerNotificationReceiver:(Lio/undertow/security/api/NotificationReceiver;)V
     168: getstatic     #43                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     171: astore        9
     173: aload         5
     175: ifnull        212
     178: aload         6
     180: ifnull        205
     183: aload         5
     185: invokeinterface #34,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.close:()V
     190: goto          212
     193: astore        10
     195: aload         6
     197: aload         10
     199: invokevirtual #36                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     202: goto          212
     205: aload         5
     207: invokeinterface #34,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.close:()V
     212: aload         9
     214: areturn
     215: aload         5
     217: ifnull        310
     220: aload         6
     222: ifnull        247
     225: aload         5
     227: invokeinterface #34,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.close:()V
     232: goto          310
     235: astore        7
     237: aload         6
     239: aload         7
     241: invokevirtual #36                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     244: goto          310
     247: aload         5
     249: invokeinterface #34,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.close:()V
     254: goto          310
     257: astore        7
     259: aload         7
     261: astore        6
     263: aload         7
     265: athrow
     266: astore        11
     268: aload         5
     270: ifnull        307
     273: aload         6
     275: ifnull        300
     278: aload         5
     280: invokeinterface #34,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.close:()V
     285: goto          307
     288: astore        12
     290: aload         6
     292: aload         12
     294: invokevirtual #36                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     297: goto          307
     300: aload         5
     302: invokeinterface #34,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.close:()V
     307: aload         11
     309: athrow
     310: aload_0
     311: aload_1
     312: invokespecial #44                 // Method clearSsoCookie:(Lio/undertow/server/HttpServerExchange;)V
     315: aload_1
     316: aload_0
     317: getfield      #22                 // Field responseListener:Lio/undertow/security/impl/SingleSignOnAuthenticationMechanism$ResponseListener;
     320: invokevirtual #45                 // Method io/undertow/server/HttpServerExchange.addResponseWrapper:(Lio/undertow/server/ConduitWrapper;)Lio/undertow/server/HttpServerExchange;
     323: pop
     324: getstatic     #33                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_ATTEMPTED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     327: areturn
    Exception table:
       from    to  target type
          89    96    99   Class java/lang/Throwable
         183   190   193   Class java/lang/Throwable
         225   232   235   Class java/lang/Throwable
          45    79   257   Class java/lang/Throwable
         121   173   257   Class java/lang/Throwable
          45    79   266   any
         121   173   266   any
         278   285   288   Class java/lang/Throwable
         257   268   266   any

  private void registerSessionIfRequired(io.undertow.security.impl.SingleSignOn, io.undertow.server.session.Session);
    Code:
       0: aload_1
       1: aload_2
       2: invokeinterface #46,  2           // InterfaceMethod io/undertow/security/impl/SingleSignOn.contains:(Lio/undertow/server/session/Session;)Z
       7: ifne          63
      10: aload_1
      11: aload_2
      12: invokeinterface #47,  2           // InterfaceMethod io/undertow/security/impl/SingleSignOn.add:(Lio/undertow/server/session/Session;)V
      17: aload_2
      18: getstatic     #1                  // Field SSO_SESSION_ATTRIBUTE:Ljava/lang/String;
      21: aload_1
      22: invokeinterface #48,  1           // InterfaceMethod io/undertow/security/impl/SingleSignOn.getId:()Ljava/lang/String;
      27: invokeinterface #49,  3           // InterfaceMethod io/undertow/server/session/Session.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
      32: pop
      33: aload_2
      34: invokeinterface #50,  1           // InterfaceMethod io/undertow/server/session/Session.getSessionManager:()Lio/undertow/server/session/SessionManager;
      39: astore_3
      40: aload_0
      41: getfield      #15                 // Field seenSessionManagers:Ljava/util/Set;
      44: aload_3
      45: invokeinterface #51,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      50: ifeq          63
      53: aload_3
      54: aload_0
      55: getfield      #19                 // Field listener:Lio/undertow/security/impl/SingleSignOnAuthenticationMechanism$SessionInvalidationListener;
      58: invokeinterface #52,  2           // InterfaceMethod io/undertow/server/session/SessionManager.registerSessionListener:(Lio/undertow/server/session/SessionListener;)V
      63: return

  private void clearSsoCookie(io.undertow.server.HttpServerExchange);
    Code:
       0: aload_1
       1: invokevirtual #53                 // Method io/undertow/server/HttpServerExchange.getResponseCookies:()Ljava/util/Map;
       4: aload_0
       5: getfield      #6                  // Field cookieName:Ljava/lang/String;
       8: new           #54                 // class io/undertow/server/handlers/CookieImpl
      11: dup
      12: aload_0
      13: getfield      #6                  // Field cookieName:Ljava/lang/String;
      16: invokespecial #55                 // Method io/undertow/server/handlers/CookieImpl."<init>":(Ljava/lang/String;)V
      19: iconst_0
      20: invokestatic  #56                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      23: invokevirtual #57                 // Method io/undertow/server/handlers/CookieImpl.setMaxAge:(Ljava/lang/Integer;)Lio/undertow/server/handlers/CookieImpl;
      26: aload_0
      27: getfield      #2                  // Field httpOnly:Z
      30: invokevirtual #58                 // Method io/undertow/server/handlers/CookieImpl.setHttpOnly:(Z)Lio/undertow/server/handlers/CookieImpl;
      33: aload_0
      34: getfield      #3                  // Field secure:Z
      37: invokevirtual #59                 // Method io/undertow/server/handlers/CookieImpl.setSecure:(Z)Lio/undertow/server/handlers/CookieImpl;
      40: aload_0
      41: getfield      #4                  // Field domain:Ljava/lang/String;
      44: invokevirtual #60                 // Method io/undertow/server/handlers/CookieImpl.setDomain:(Ljava/lang/String;)Lio/undertow/server/handlers/CookieImpl;
      47: invokeinterface #61,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      52: pop
      53: return

  public io.undertow.security.api.AuthenticationMechanism$ChallengeResult sendChallenge(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: new           #62                 // class io/undertow/security/api/AuthenticationMechanism$ChallengeResult
       3: dup
       4: iconst_0
       5: invokespecial #63                 // Method io/undertow/security/api/AuthenticationMechanism$ChallengeResult."<init>":(Z)V
       8: areturn

  protected io.undertow.server.session.Session getSession(io.undertow.server.HttpServerExchange);
    Code:
       0: aload_1
       1: invokestatic  #64                 // Method io/undertow/util/Sessions.getOrCreateSession:(Lio/undertow/server/HttpServerExchange;)Lio/undertow/server/session/Session;
       4: areturn

  public java.lang.String getCookieName();
    Code:
       0: aload_0
       1: getfield      #6                  // Field cookieName:Ljava/lang/String;
       4: areturn

  public io.undertow.security.impl.SingleSignOnAuthenticationMechanism setCookieName(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #6                  // Field cookieName:Ljava/lang/String;
       5: aload_0
       6: areturn

  public boolean isHttpOnly();
    Code:
       0: aload_0
       1: getfield      #2                  // Field httpOnly:Z
       4: ireturn

  public io.undertow.security.impl.SingleSignOnAuthenticationMechanism setHttpOnly(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #2                  // Field httpOnly:Z
       5: aload_0
       6: areturn

  public boolean isSecure();
    Code:
       0: aload_0
       1: getfield      #3                  // Field secure:Z
       4: ireturn

  public io.undertow.security.impl.SingleSignOnAuthenticationMechanism setSecure(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #3                  // Field secure:Z
       5: aload_0
       6: areturn

  public java.lang.String getDomain();
    Code:
       0: aload_0
       1: getfield      #4                  // Field domain:Ljava/lang/String;
       4: areturn

  public io.undertow.security.impl.SingleSignOnAuthenticationMechanism setDomain(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #4                  // Field domain:Ljava/lang/String;
       5: aload_0
       6: areturn

  public java.lang.String getPath();
    Code:
       0: aload_0
       1: getfield      #5                  // Field path:Ljava/lang/String;
       4: areturn

  public io.undertow.security.impl.SingleSignOnAuthenticationMechanism setPath(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #5                  // Field path:Ljava/lang/String;
       5: aload_0
       6: areturn

  static io.undertow.security.impl.SingleSignOnManager access$000(io.undertow.security.impl.SingleSignOnAuthenticationMechanism);
    Code:
       0: aload_0
       1: getfield      #8                  // Field singleSignOnManager:Lio/undertow/security/impl/SingleSignOnManager;
       4: areturn

  static void access$100(io.undertow.security.impl.SingleSignOnAuthenticationMechanism, io.undertow.security.impl.SingleSignOn, io.undertow.server.session.Session);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #7                  // Method registerSessionIfRequired:(Lio/undertow/security/impl/SingleSignOn;Lio/undertow/server/session/Session;)V
       6: return

  static java.lang.String access$200(io.undertow.security.impl.SingleSignOnAuthenticationMechanism);
    Code:
       0: aload_0
       1: getfield      #6                  // Field cookieName:Ljava/lang/String;
       4: areturn

  static java.lang.String access$300(io.undertow.security.impl.SingleSignOnAuthenticationMechanism);
    Code:
       0: aload_0
       1: getfield      #5                  // Field path:Ljava/lang/String;
       4: areturn

  static java.lang.String access$400(io.undertow.security.impl.SingleSignOnAuthenticationMechanism);
    Code:
       0: aload_0
       1: getfield      #4                  // Field domain:Ljava/lang/String;
       4: areturn

  static boolean access$500(io.undertow.security.impl.SingleSignOnAuthenticationMechanism);
    Code:
       0: aload_0
       1: getfield      #3                  // Field secure:Z
       4: ireturn

  static boolean access$600(io.undertow.security.impl.SingleSignOnAuthenticationMechanism);
    Code:
       0: aload_0
       1: getfield      #2                  // Field httpOnly:Z
       4: ireturn

  static java.lang.String access$700();
    Code:
       0: getstatic     #1                  // Field SSO_SESSION_ATTRIBUTE:Ljava/lang/String;
       3: areturn

  static {};
    Code:
       0: new           #65                 // class java/lang/StringBuilder
       3: dup
       4: invokespecial #66                 // Method java/lang/StringBuilder."<init>":()V
       7: ldc           #67                 // class io/undertow/security/impl/SingleSignOnAuthenticationMechanism
       9: invokevirtual #68                 // Method java/lang/Class.getName:()Ljava/lang/String;
      12: invokevirtual #69                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      15: ldc           #70                 // String .SSOID
      17: invokevirtual #69                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      20: invokevirtual #71                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      23: putstatic     #1                  // Field SSO_SESSION_ATTRIBUTE:Ljava/lang/String;
      26: return
}
