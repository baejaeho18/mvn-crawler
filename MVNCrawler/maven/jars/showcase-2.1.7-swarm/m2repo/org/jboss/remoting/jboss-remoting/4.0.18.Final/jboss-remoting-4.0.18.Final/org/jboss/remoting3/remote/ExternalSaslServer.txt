Compiled from "ExternalSaslServer.java"
final class org.jboss.remoting3.remote.ExternalSaslServer implements javax.security.sasl.SaslServer {
  private final java.util.concurrent.atomic.AtomicBoolean complete;

  private java.lang.String authorizationID;

  private final java.security.Principal peerPrincipal;

  private final javax.security.auth.callback.CallbackHandler callbackHandler;

  private static final byte[] EMPTY;

  org.jboss.remoting3.remote.ExternalSaslServer(javax.security.auth.callback.CallbackHandler, java.security.Principal);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/concurrent/atomic/AtomicBoolean
       8: dup
       9: invokespecial #3                  // Method java/util/concurrent/atomic/AtomicBoolean."<init>":()V
      12: putfield      #4                  // Field complete:Ljava/util/concurrent/atomic/AtomicBoolean;
      15: aload_0
      16: aload_1
      17: putfield      #5                  // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      20: aload_0
      21: aload_2
      22: putfield      #6                  // Field peerPrincipal:Ljava/security/Principal;
      25: return

  public java.lang.String getMechanismName();
    Code:
       0: ldc           #7                  // String EXTERNAL
       2: areturn

  public byte[] evaluateResponse(byte[]) throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: getfield      #4                  // Field complete:Ljava/util/concurrent/atomic/AtomicBoolean;
       4: iconst_1
       5: invokevirtual #8                  // Method java/util/concurrent/atomic/AtomicBoolean.getAndSet:(Z)Z
       8: ifeq          21
      11: new           #9                  // class javax/security/sasl/SaslException
      14: dup
      15: ldc           #10                 // String Received response after complete
      17: invokespecial #11                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      20: athrow
      21: new           #12                 // class java/lang/String
      24: dup
      25: aload_1
      26: ldc           #13                 // String UTF-8
      28: invokespecial #14                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
      31: astore_2
      32: goto          47
      35: astore_3
      36: new           #9                  // class javax/security/sasl/SaslException
      39: dup
      40: ldc           #16                 // String Cannot convert user name from UTF-8
      42: aload_3
      43: invokespecial #17                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      46: athrow
      47: aload_2
      48: invokevirtual #18                 // Method java/lang/String.length:()I
      51: ifne          64
      54: aload_0
      55: getfield      #6                  // Field peerPrincipal:Ljava/security/Principal;
      58: invokeinterface #19,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      63: astore_2
      64: new           #20                 // class javax/security/sasl/AuthorizeCallback
      67: dup
      68: aload_0
      69: getfield      #6                  // Field peerPrincipal:Ljava/security/Principal;
      72: invokeinterface #19,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      77: aload_2
      78: invokespecial #21                 // Method javax/security/sasl/AuthorizeCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      81: astore_3
      82: aload_0
      83: getfield      #5                  // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      86: aload_3
      87: invokestatic  #22                 // Method handleCallback:(Ljavax/security/auth/callback/CallbackHandler;Ljavax/security/auth/callback/Callback;)V
      90: aload_3
      91: invokevirtual #23                 // Method javax/security/sasl/AuthorizeCallback.isAuthorized:()Z
      94: ifeq          108
      97: aload_0
      98: aload_3
      99: invokevirtual #24                 // Method javax/security/sasl/AuthorizeCallback.getAuthorizedID:()Ljava/lang/String;
     102: putfield      #25                 // Field authorizationID:Ljava/lang/String;
     105: goto          152
     108: new           #9                  // class javax/security/sasl/SaslException
     111: dup
     112: new           #26                 // class java/lang/StringBuilder
     115: dup
     116: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     119: ldc           #28                 // String EXTERNAL:
     121: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     124: aload_0
     125: getfield      #6                  // Field peerPrincipal:Ljava/security/Principal;
     128: invokeinterface #19,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
     133: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     136: ldc           #30                 // String  is not authorized to act as
     138: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     141: aload_2
     142: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     145: invokevirtual #31                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     148: invokespecial #11                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     151: athrow
     152: getstatic     #32                 // Field EMPTY:[B
     155: areturn
    Exception table:
       from    to  target type
          21    32    35   Class java/io/UnsupportedEncodingException

  private static void handleCallback(javax.security.auth.callback.CallbackHandler, javax.security.auth.callback.Callback) throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: iconst_1
       2: anewarray     #33                 // class javax/security/auth/callback/Callback
       5: dup
       6: iconst_0
       7: aload_1
       8: aastore
       9: invokeinterface #34,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      14: goto          44
      17: astore_2
      18: aload_2
      19: athrow
      20: astore_2
      21: new           #9                  // class javax/security/sasl/SaslException
      24: dup
      25: ldc           #36                 // String Failed to authenticate due to callback exception
      27: aload_2
      28: invokespecial #17                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      31: athrow
      32: astore_2
      33: new           #9                  // class javax/security/sasl/SaslException
      36: dup
      37: ldc           #38                 // String Failed to authenticate due to unsupported callback
      39: aload_2
      40: invokespecial #17                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      43: athrow
      44: return
    Exception table:
       from    to  target type
           0    14    17   Class javax/security/sasl/SaslException
           0    14    20   Class java/io/IOException
           0    14    32   Class javax/security/auth/callback/UnsupportedCallbackException

  public boolean isComplete();
    Code:
       0: aload_0
       1: getfield      #4                  // Field complete:Ljava/util/concurrent/atomic/AtomicBoolean;
       4: invokevirtual #39                 // Method java/util/concurrent/atomic/AtomicBoolean.get:()Z
       7: ireturn

  public java.lang.String getAuthorizationID();
    Code:
       0: aload_0
       1: getfield      #25                 // Field authorizationID:Ljava/lang/String;
       4: areturn

  public byte[] unwrap(byte[], int, int) throws javax.security.sasl.SaslException;
    Code:
       0: new           #40                 // class java/lang/IllegalStateException
       3: dup
       4: invokespecial #41                 // Method java/lang/IllegalStateException."<init>":()V
       7: athrow

  public byte[] wrap(byte[], int, int) throws javax.security.sasl.SaslException;
    Code:
       0: new           #40                 // class java/lang/IllegalStateException
       3: dup
       4: invokespecial #41                 // Method java/lang/IllegalStateException."<init>":()V
       7: athrow

  public java.lang.Object getNegotiatedProperty(java.lang.String);
    Code:
       0: aconst_null
       1: areturn

  public void dispose() throws javax.security.sasl.SaslException;
    Code:
       0: return

  static {};
    Code:
       0: iconst_0
       1: newarray       byte
       3: putstatic     #32                 // Field EMPTY:[B
       6: return
}
