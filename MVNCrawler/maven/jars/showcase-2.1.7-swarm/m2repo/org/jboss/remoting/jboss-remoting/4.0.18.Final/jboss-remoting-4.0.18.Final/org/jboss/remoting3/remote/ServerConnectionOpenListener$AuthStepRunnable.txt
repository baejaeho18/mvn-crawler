Compiled from "ServerConnectionOpenListener.java"
final class org.jboss.remoting3.remote.ServerConnectionOpenListener$AuthStepRunnable implements java.lang.Runnable {
  private final boolean isInitial;

  private final javax.security.sasl.SaslServer saslServer;

  private final org.jboss.remoting3.security.AuthorizingCallbackHandler authorizingCallbackHandler;

  private final org.xnio.Pooled<java.nio.ByteBuffer> buffer;

  private final java.lang.String remoteEndpointName;

  private final int behavior;

  private final int maxInboundChannels;

  private final int maxOutboundChannels;

  final org.jboss.remoting3.remote.ServerConnectionOpenListener this$0;

  org.jboss.remoting3.remote.ServerConnectionOpenListener$AuthStepRunnable(boolean, javax.security.sasl.SaslServer, org.jboss.remoting3.security.AuthorizingCallbackHandler, org.xnio.Pooled<java.nio.ByteBuffer>, java.lang.String, int, int, int);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
       5: aload_0
       6: invokespecial #8                  // Method java/lang/Object."<init>":()V
       9: aload_0
      10: iload_2
      11: putfield      #5                  // Field isInitial:Z
      14: aload_0
      15: aload_3
      16: putfield      #6                  // Field saslServer:Ljavax/security/sasl/SaslServer;
      19: aload_0
      20: aload         4
      22: putfield      #9                  // Field authorizingCallbackHandler:Lorg/jboss/remoting3/security/AuthorizingCallbackHandler;
      25: aload_0
      26: aload         5
      28: putfield      #10                 // Field buffer:Lorg/xnio/Pooled;
      31: aload_0
      32: aload         6
      34: putfield      #2                  // Field remoteEndpointName:Ljava/lang/String;
      37: aload_0
      38: iload         7
      40: putfield      #1                  // Field behavior:I
      43: aload_0
      44: iload         8
      46: putfield      #4                  // Field maxInboundChannels:I
      49: aload_0
      50: iload         9
      52: putfield      #3                  // Field maxOutboundChannels:I
      55: return

  public void run();
    Code:
       0: iconst_0
       1: istore_1
       2: iconst_0
       3: istore_2
       4: aload_0
       5: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
       8: invokestatic  #11                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener.access$000:(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;)Lorg/jboss/remoting3/remote/RemoteConnection;
      11: invokevirtual #12                 // Method org/jboss/remoting3/remote/RemoteConnection.allocate:()Lorg/xnio/Pooled;
      14: astore_3
      15: aload_3
      16: invokeinterface #13,  1           // InterfaceMethod org/xnio/Pooled.getResource:()Ljava/lang/Object;
      21: checkcast     #14                 // class java/nio/ByteBuffer
      24: astore        4
      26: aload         4
      28: invokevirtual #15                 // Method java/nio/ByteBuffer.position:()I
      31: istore        5
      33: aload         4
      35: iconst_5
      36: invokevirtual #17                 // Method java/nio/ByteBuffer.put:(B)Ljava/nio/ByteBuffer;
      39: pop
      40: aload_0
      41: getfield      #6                  // Field saslServer:Ljavax/security/sasl/SaslServer;
      44: aload         4
      46: aload_0
      47: getfield      #10                 // Field buffer:Lorg/xnio/Pooled;
      50: invokeinterface #13,  1           // InterfaceMethod org/xnio/Pooled.getResource:()Ljava/lang/Object;
      55: checkcast     #14                 // class java/nio/ByteBuffer
      58: invokestatic  #18                 // Method org/xnio/sasl/SaslUtils.evaluateResponse:(Ljavax/security/sasl/SaslServer;Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Z
      61: ifeq          124
      64: getstatic     #19                 // Field org/jboss/remoting3/remote/RemoteLogger.server:Lorg/jboss/remoting3/remote/RemoteLogger;
      67: ldc           #20                 // String Server sending authentication complete
      69: iconst_0
      70: anewarray     #21                 // class java/lang/Object
      73: invokeinterface #22,  3           // InterfaceMethod org/jboss/remoting3/remote/RemoteLogger.tracef:(Ljava/lang/String;[Ljava/lang/Object;)V
      78: aload_0
      79: invokespecial #23                 // Method createPrincipals:()Ljava/util/Collection;
      82: astore        6
      84: aload_0
      85: getfield      #9                  // Field authorizingCallbackHandler:Lorg/jboss/remoting3/security/AuthorizingCallbackHandler;
      88: aload         6
      90: invokeinterface #24,  2           // InterfaceMethod org/jboss/remoting3/security/AuthorizingCallbackHandler.createUserInfo:(Ljava/util/Collection;)Lorg/jboss/remoting3/security/UserInfo;
      95: astore        7
      97: aload_0
      98: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
     101: invokestatic  #25                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener.access$700:(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;)Lorg/jboss/remoting3/spi/ConnectionProviderContext;
     104: new           #26                 // class org/jboss/remoting3/remote/ServerConnectionOpenListener$AuthStepRunnable$1
     107: dup
     108: aload_0
     109: aload         6
     111: aload         7
     113: invokespecial #27                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener$AuthStepRunnable$1."<init>":(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener$AuthStepRunnable;Ljava/util/Collection;Lorg/jboss/remoting3/security/UserInfo;)V
     116: invokeinterface #28,  2           // InterfaceMethod org/jboss/remoting3/spi/ConnectionProviderContext.accept:(Lorg/jboss/remoting3/spi/ConnectionHandlerFactory;)V
     121: goto          200
     124: getstatic     #19                 // Field org/jboss/remoting3/remote/RemoteLogger.server:Lorg/jboss/remoting3/remote/RemoteLogger;
     127: ldc           #29                 // String Server sending authentication challenge
     129: iconst_0
     130: anewarray     #21                 // class java/lang/Object
     133: invokeinterface #22,  3           // InterfaceMethod org/jboss/remoting3/remote/RemoteLogger.tracef:(Ljava/lang/String;[Ljava/lang/Object;)V
     138: aload         4
     140: iload         5
     142: iconst_3
     143: invokevirtual #30                 // Method java/nio/ByteBuffer.put:(IB)Ljava/nio/ByteBuffer;
     146: pop
     147: aload_0
     148: getfield      #5                  // Field isInitial:Z
     151: ifeq          200
     154: aload_0
     155: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
     158: invokestatic  #11                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener.access$000:(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;)Lorg/jboss/remoting3/remote/RemoteConnection;
     161: new           #31                 // class org/jboss/remoting3/remote/ServerConnectionOpenListener$Authentication
     164: dup
     165: aload_0
     166: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
     169: aload_0
     170: getfield      #6                  // Field saslServer:Ljavax/security/sasl/SaslServer;
     173: aload_0
     174: getfield      #9                  // Field authorizingCallbackHandler:Lorg/jboss/remoting3/security/AuthorizingCallbackHandler;
     177: aload_0
     178: getfield      #2                  // Field remoteEndpointName:Ljava/lang/String;
     181: aload_0
     182: getfield      #1                  // Field behavior:I
     185: aload_0
     186: getfield      #4                  // Field maxInboundChannels:I
     189: aload_0
     190: getfield      #3                  // Field maxOutboundChannels:I
     193: invokespecial #32                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener$Authentication."<init>":(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;Ljavax/security/sasl/SaslServer;Lorg/jboss/remoting3/security/AuthorizingCallbackHandler;Ljava/lang/String;III)V
     196: iconst_0
     197: invokevirtual #33                 // Method org/jboss/remoting3/remote/RemoteConnection.setReadListener:(Lorg/xnio/ChannelListener;Z)V
     200: goto          289
     203: astore        6
     205: getstatic     #19                 // Field org/jboss/remoting3/remote/RemoteLogger.server:Lorg/jboss/remoting3/remote/RemoteLogger;
     208: aload         6
     210: ldc           #35                 // String Server sending authentication rejected
     212: iconst_0
     213: anewarray     #21                 // class java/lang/Object
     216: invokeinterface #36,  4           // InterfaceMethod org/jboss/remoting3/remote/RemoteLogger.tracef:(Ljava/lang/Throwable;Ljava/lang/String;[Ljava/lang/Object;)V
     221: aload         4
     223: iload         5
     225: bipush        6
     227: invokevirtual #30                 // Method java/nio/ByteBuffer.put:(IB)Ljava/nio/ByteBuffer;
     230: pop
     231: aload_0
     232: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
     235: aload_0
     236: getfield      #6                  // Field saslServer:Ljavax/security/sasl/SaslServer;
     239: invokestatic  #37                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener.access$1400:(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;Ljavax/security/sasl/SaslServer;)V
     242: aload_0
     243: getfield      #5                  // Field isInitial:Z
     246: ifeq          267
     249: aload_0
     250: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
     253: invokestatic  #38                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener.access$200:(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;)Ljava/util/concurrent/atomic/AtomicInteger;
     256: invokevirtual #39                 // Method java/util/concurrent/atomic/AtomicInteger.decrementAndGet:()I
     259: ifgt          289
     262: iconst_1
     263: istore_2
     264: goto          289
     267: aload_0
     268: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
     271: invokestatic  #11                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener.access$000:(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;)Lorg/jboss/remoting3/remote/RemoteConnection;
     274: new           #40                 // class org/jboss/remoting3/remote/ServerConnectionOpenListener$Initial
     277: dup
     278: aload_0
     279: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
     282: invokespecial #41                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener$Initial."<init>":(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;)V
     285: iconst_0
     286: invokevirtual #33                 // Method org/jboss/remoting3/remote/RemoteConnection.setReadListener:(Lorg/xnio/ChannelListener;Z)V
     289: aload         4
     291: invokevirtual #42                 // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
     294: pop
     295: aload_0
     296: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
     299: invokestatic  #11                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener.access$000:(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;)Lorg/jboss/remoting3/remote/RemoteConnection;
     302: aload_3
     303: iload_2
     304: invokevirtual #43                 // Method org/jboss/remoting3/remote/RemoteConnection.send:(Lorg/xnio/Pooled;Z)V
     307: iconst_1
     308: istore_1
     309: aload_0
     310: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
     313: invokestatic  #11                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener.access$000:(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;)Lorg/jboss/remoting3/remote/RemoteConnection;
     316: invokevirtual #44                 // Method org/jboss/remoting3/remote/RemoteConnection.getChannel:()Lorg/xnio/channels/ConnectedMessageChannel;
     319: invokeinterface #45,  1           // InterfaceMethod org/xnio/channels/ConnectedMessageChannel.resumeReads:()V
     324: iload_1
     325: ifne          334
     328: aload_3
     329: invokeinterface #46,  1           // InterfaceMethod org/xnio/Pooled.free:()V
     334: aload_0
     335: getfield      #10                 // Field buffer:Lorg/xnio/Pooled;
     338: invokeinterface #46,  1           // InterfaceMethod org/xnio/Pooled.free:()V
     343: return
     344: astore        8
     346: iload_1
     347: ifne          356
     350: aload_3
     351: invokeinterface #46,  1           // InterfaceMethod org/xnio/Pooled.free:()V
     356: aload         8
     358: athrow
     359: astore        9
     361: aload_0
     362: getfield      #10                 // Field buffer:Lorg/xnio/Pooled;
     365: invokeinterface #46,  1           // InterfaceMethod org/xnio/Pooled.free:()V
     370: aload         9
     372: athrow
    Exception table:
       from    to  target type
          33   200   203   Class java/lang/Throwable
          15   324   344   any
         344   346   344   any
           4   334   359   any
         344   361   359   any

  private java.util.Collection<java.security.Principal> createPrincipals();
    Code:
       0: new           #47                 // class java/util/LinkedHashSet
       3: dup
       4: invokespecial #48                 // Method java/util/LinkedHashSet."<init>":()V
       7: astore_1
       8: aload_0
       9: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
      12: invokestatic  #11                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener.access$000:(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;)Lorg/jboss/remoting3/remote/RemoteConnection;
      15: invokevirtual #49                 // Method org/jboss/remoting3/remote/RemoteConnection.getSslChannel:()Lorg/xnio/channels/SslChannel;
      18: astore_2
      19: aload_2
      20: ifnull        52
      23: aload_2
      24: invokeinterface #50,  1           // InterfaceMethod org/xnio/channels/SslChannel.getSslSession:()Ljavax/net/ssl/SSLSession;
      29: astore_3
      30: aload_3
      31: ifnull        52
      34: aload_1
      35: aload_3
      36: invokeinterface #51,  1           // InterfaceMethod javax/net/ssl/SSLSession.getPeerPrincipal:()Ljava/security/Principal;
      41: invokeinterface #52,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      46: pop
      47: goto          52
      50: astore        4
      52: aload_0
      53: getfield      #6                  // Field saslServer:Ljavax/security/sasl/SaslServer;
      56: invokeinterface #54,  1           // InterfaceMethod javax/security/sasl/SaslServer.getAuthorizationID:()Ljava/lang/String;
      61: astore_3
      62: aload_3
      63: ifnull        81
      66: aload_1
      67: new           #55                 // class org/jboss/remoting3/security/UserPrincipal
      70: dup
      71: aload_3
      72: invokespecial #56                 // Method org/jboss/remoting3/security/UserPrincipal."<init>":(Ljava/lang/String;)V
      75: invokeinterface #52,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      80: pop
      81: aload_0
      82: getfield      #7                  // Field this$0:Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;
      85: invokestatic  #11                 // Method org/jboss/remoting3/remote/ServerConnectionOpenListener.access$000:(Lorg/jboss/remoting3/remote/ServerConnectionOpenListener;)Lorg/jboss/remoting3/remote/RemoteConnection;
      88: invokevirtual #44                 // Method org/jboss/remoting3/remote/RemoteConnection.getChannel:()Lorg/xnio/channels/ConnectedMessageChannel;
      91: astore        4
      93: aload         4
      95: ldc           #57                 // class java/net/InetSocketAddress
      97: invokeinterface #58,  2           // InterfaceMethod org/xnio/channels/ConnectedMessageChannel.getPeerAddress:(Ljava/lang/Class;)Ljava/net/SocketAddress;
     102: checkcast     #57                 // class java/net/InetSocketAddress
     105: astore        5
     107: aload         5
     109: ifnull        131
     112: aload_1
     113: new           #59                 // class org/jboss/remoting3/security/InetAddressPrincipal
     116: dup
     117: aload         5
     119: invokevirtual #60                 // Method java/net/InetSocketAddress.getAddress:()Ljava/net/InetAddress;
     122: invokespecial #61                 // Method org/jboss/remoting3/security/InetAddressPrincipal."<init>":(Ljava/net/InetAddress;)V
     125: invokeinterface #52,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     130: pop
     131: aload_1
     132: invokestatic  #62                 // Method java/util/Collections.unmodifiableCollection:(Ljava/util/Collection;)Ljava/util/Collection;
     135: areturn
    Exception table:
       from    to  target type
          34    47    50   Class javax/net/ssl/SSLPeerUnverifiedException

  static javax.security.sasl.SaslServer access$800(org.jboss.remoting3.remote.ServerConnectionOpenListener$AuthStepRunnable);
    Code:
       0: aload_0
       1: getfield      #6                  // Field saslServer:Ljavax/security/sasl/SaslServer;
       4: areturn

  static boolean access$900(org.jboss.remoting3.remote.ServerConnectionOpenListener$AuthStepRunnable);
    Code:
       0: aload_0
       1: getfield      #5                  // Field isInitial:Z
       4: ireturn

  static int access$1000(org.jboss.remoting3.remote.ServerConnectionOpenListener$AuthStepRunnable);
    Code:
       0: aload_0
       1: getfield      #4                  // Field maxInboundChannels:I
       4: ireturn

  static int access$1100(org.jboss.remoting3.remote.ServerConnectionOpenListener$AuthStepRunnable);
    Code:
       0: aload_0
       1: getfield      #3                  // Field maxOutboundChannels:I
       4: ireturn

  static java.lang.String access$1200(org.jboss.remoting3.remote.ServerConnectionOpenListener$AuthStepRunnable);
    Code:
       0: aload_0
       1: getfield      #2                  // Field remoteEndpointName:Ljava/lang/String;
       4: areturn

  static int access$1300(org.jboss.remoting3.remote.ServerConnectionOpenListener$AuthStepRunnable);
    Code:
       0: aload_0
       1: getfield      #1                  // Field behavior:I
       4: ireturn
}
