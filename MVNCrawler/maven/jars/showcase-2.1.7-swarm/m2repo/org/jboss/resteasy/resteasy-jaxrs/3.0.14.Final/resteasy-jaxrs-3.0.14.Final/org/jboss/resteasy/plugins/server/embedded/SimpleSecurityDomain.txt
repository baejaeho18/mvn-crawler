Compiled from "SimpleSecurityDomain.java"
public class org.jboss.resteasy.plugins.server.embedded.SimpleSecurityDomain implements org.jboss.resteasy.plugins.server.embedded.SecurityDomain {
  private java.util.concurrent.ConcurrentHashMap<java.lang.String, java.lang.String> users;

  private java.util.concurrent.ConcurrentHashMap<java.lang.String, java.util.Set<java.lang.String>> roles;

  public org.jboss.resteasy.plugins.server.embedded.SimpleSecurityDomain();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/concurrent/ConcurrentHashMap
       8: dup
       9: invokespecial #3                  // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      12: putfield      #4                  // Field users:Ljava/util/concurrent/ConcurrentHashMap;
      15: aload_0
      16: new           #2                  // class java/util/concurrent/ConcurrentHashMap
      19: dup
      20: invokespecial #3                  // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      23: putfield      #5                  // Field roles:Ljava/util/concurrent/ConcurrentHashMap;
      26: return

  public void addRole(java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: getfield      #5                  // Field roles:Ljava/util/concurrent/ConcurrentHashMap;
       4: aload_2
       5: invokevirtual #6                  // Method java/util/concurrent/ConcurrentHashMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
       8: checkcast     #7                  // class java/util/Set
      11: astore_3
      12: aload_3
      13: ifnonnull     46
      16: new           #8                  // class java/util/concurrent/CopyOnWriteArraySet
      19: dup
      20: invokespecial #9                  // Method java/util/concurrent/CopyOnWriteArraySet."<init>":()V
      23: astore_3
      24: aload_0
      25: getfield      #5                  // Field roles:Ljava/util/concurrent/ConcurrentHashMap;
      28: aload_2
      29: aload_3
      30: invokevirtual #10                 // Method java/util/concurrent/ConcurrentHashMap.putIfAbsent:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      33: pop
      34: aload_0
      35: getfield      #5                  // Field roles:Ljava/util/concurrent/ConcurrentHashMap;
      38: aload_2
      39: invokevirtual #6                  // Method java/util/concurrent/ConcurrentHashMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
      42: checkcast     #7                  // class java/util/Set
      45: astore_3
      46: aload_3
      47: aload_1
      48: invokeinterface #11,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      53: pop
      54: return

  public void addUser(java.lang.String, java.lang.String, java.lang.String[]);
    Code:
       0: aload_0
       1: getfield      #4                  // Field users:Ljava/util/concurrent/ConcurrentHashMap;
       4: aload_1
       5: aload_2
       6: invokevirtual #12                 // Method java/util/concurrent/ConcurrentHashMap.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
       9: pop
      10: aload_3
      11: astore        4
      13: aload         4
      15: arraylength
      16: istore        5
      18: iconst_0
      19: istore        6
      21: iload         6
      23: iload         5
      25: if_icmpge     48
      28: aload         4
      30: iload         6
      32: aaload
      33: astore        7
      35: aload_0
      36: aload_1
      37: aload         7
      39: invokevirtual #13                 // Method addRole:(Ljava/lang/String;Ljava/lang/String;)V
      42: iinc          6, 1
      45: goto          21
      48: return

  public void addRoles(java.lang.String, java.lang.String[]);
    Code:
       0: aload_2
       1: astore_3
       2: aload_3
       3: arraylength
       4: istore        4
       6: iconst_0
       7: istore        5
       9: iload         5
      11: iload         4
      13: if_icmpge     35
      16: aload_3
      17: iload         5
      19: aaload
      20: astore        6
      22: aload_0
      23: aload         6
      25: aload_1
      26: invokevirtual #13                 // Method addRole:(Ljava/lang/String;Ljava/lang/String;)V
      29: iinc          5, 1
      32: goto          9
      35: return

  public java.security.Principal authenticate(java.lang.String, java.lang.String) throws java.lang.SecurityException;
    Code:
       0: aload_0
       1: getfield      #4                  // Field users:Ljava/util/concurrent/ConcurrentHashMap;
       4: aload_1
       5: invokevirtual #6                  // Method java/util/concurrent/ConcurrentHashMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
       8: checkcast     #14                 // class java/lang/String
      11: astore_3
      12: aload_3
      13: ifnonnull     33
      16: new           #15                 // class java/lang/SecurityException
      19: dup
      20: getstatic     #16                 // Field org/jboss/resteasy/resteasy_jaxrs/i18n/Messages.MESSAGES:Lorg/jboss/resteasy/resteasy_jaxrs/i18n/Messages;
      23: aload_1
      24: invokeinterface #17,  2           // InterfaceMethod org/jboss/resteasy/resteasy_jaxrs/i18n/Messages.userIsNotRegistered:(Ljava/lang/String;)Ljava/lang/String;
      29: invokespecial #18                 // Method java/lang/SecurityException."<init>":(Ljava/lang/String;)V
      32: athrow
      33: aload_3
      34: aload_2
      35: invokevirtual #19                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      38: ifne          58
      41: new           #15                 // class java/lang/SecurityException
      44: dup
      45: getstatic     #16                 // Field org/jboss/resteasy/resteasy_jaxrs/i18n/Messages.MESSAGES:Lorg/jboss/resteasy/resteasy_jaxrs/i18n/Messages;
      48: aload_1
      49: invokeinterface #20,  2           // InterfaceMethod org/jboss/resteasy/resteasy_jaxrs/i18n/Messages.wrongPassword:(Ljava/lang/String;)Ljava/lang/String;
      54: invokespecial #18                 // Method java/lang/SecurityException."<init>":(Ljava/lang/String;)V
      57: athrow
      58: new           #21                 // class org/jboss/resteasy/plugins/server/embedded/SimplePrincipal
      61: dup
      62: aload_1
      63: invokespecial #22                 // Method org/jboss/resteasy/plugins/server/embedded/SimplePrincipal."<init>":(Ljava/lang/String;)V
      66: areturn

  public boolean isUserInRole(java.security.Principal, java.lang.String);
    Code:
       0: aload_0
       1: getfield      #5                  // Field roles:Ljava/util/concurrent/ConcurrentHashMap;
       4: aload_2
       5: invokevirtual #6                  // Method java/util/concurrent/ConcurrentHashMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
       8: checkcast     #7                  // class java/util/Set
      11: astore_3
      12: aload_3
      13: ifnonnull     18
      16: iconst_0
      17: ireturn
      18: aload_3
      19: aload_1
      20: invokeinterface #23,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      25: invokeinterface #24,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      30: istore        4
      32: iload         4
      34: ireturn
}
