Compiled from "DigestMD5Server.java"
public final class org.jboss.sasl.digest.DigestMD5Server extends org.jboss.sasl.digest.DigestMD5Base implements javax.security.sasl.SaslServer {
  private static final java.lang.String MY_CLASS_NAME;

  private static final java.lang.String UTF8_DIRECTIVE;

  private static final java.lang.String ALGORITHM_DIRECTIVE;

  private static final org.jboss.logging.Logger log;

  private static final int NONCE_COUNT_VALUE;

  private static final java.lang.String UTF8_PROPERTY;

  private static final java.lang.String REALM_PROPERTY;

  private static final java.lang.String ALTERNATIVE_PROTOCOLS_PROPERTY;

  private static final java.lang.String[] DIRECTIVE_KEY;

  private static final int USERNAME;

  private static final int REALM;

  private static final int NONCE;

  private static final int CNONCE;

  private static final int NONCE_COUNT;

  private static final int QOP;

  private static final int DIGEST_URI;

  private static final int RESPONSE;

  private static final int MAXBUF;

  private static final int CHARSET;

  private static final int CIPHER;

  private static final int AUTHZID;

  private java.lang.String specifiedQops;

  private byte[] myCiphers;

  private final java.util.List<java.lang.String> serverRealms;

  private boolean preDigestedPasswords;

  private final java.util.List<java.lang.String> digestUris;

  org.jboss.sasl.digest.DigestMD5Server(java.lang.String, java.lang.String, java.util.Map<java.lang.String, ?>, javax.security.auth.callback.CallbackHandler) throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: aload_3
       2: getstatic     #1                  // Field MY_CLASS_NAME:Ljava/lang/String;
       5: iconst_1
       6: aload         4
       8: invokespecial #2                  // Method org/jboss/sasl/digest/DigestMD5Base."<init>":(Ljava/util/Map;Ljava/lang/String;ILjavax/security/auth/callback/CallbackHandler;)V
      11: aload_0
      12: new           #3                  // class java/util/ArrayList
      15: dup
      16: invokespecial #4                  // Method java/util/ArrayList."<init>":()V
      19: putfield      #5                  // Field serverRealms:Ljava/util/List;
      22: aload_0
      23: iconst_1
      24: putfield      #6                  // Field useUTF8:Z
      27: aload_0
      28: iconst_0
      29: putfield      #7                  // Field preDigestedPasswords:Z
      32: new           #3                  // class java/util/ArrayList
      35: dup
      36: invokespecial #4                  // Method java/util/ArrayList."<init>":()V
      39: astore        5
      41: aload         5
      43: new           #8                  // class java/lang/StringBuilder
      46: dup
      47: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
      50: aload_1
      51: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      54: ldc           #11                 // String /
      56: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      59: aload_2
      60: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      63: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      66: invokeinterface #13,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      71: pop
      72: aload_3
      73: ifnull        347
      76: aload_0
      77: aload_3
      78: ldc           #14                 // String javax.security.sasl.qop
      80: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      85: checkcast     #16                 // class java/lang/String
      88: putfield      #17                 // Field specifiedQops:Ljava/lang/String;
      91: ldc           #18                 // String false
      93: aload_3
      94: ldc           #19                 // String com.sun.security.sasl.digest.utf8
      96: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     101: checkcast     #16                 // class java/lang/String
     104: invokevirtual #20                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     107: ifeq          123
     110: aload_0
     111: iconst_0
     112: putfield      #6                  // Field useUTF8:Z
     115: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
     118: ldc           #22                 // String Server supports ISO-Latin-1
     120: invokevirtual #23                 // Method org/jboss/logging/Logger.trace:(Ljava/lang/Object;)V
     123: aload_3
     124: ldc           #24                 // String com.sun.security.sasl.digest.realm
     126: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     131: checkcast     #16                 // class java/lang/String
     134: astore        6
     136: aload         6
     138: ifnull        209
     141: new           #25                 // class java/util/StringTokenizer
     144: dup
     145: aload         6
     147: ldc           #26                 // String , \t\n
     149: invokespecial #27                 // Method java/util/StringTokenizer."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     152: astore        7
     154: aload         7
     156: invokevirtual #28                 // Method java/util/StringTokenizer.countTokens:()I
     159: istore        8
     161: aconst_null
     162: astore        9
     164: iconst_0
     165: istore        10
     167: iload         10
     169: iload         8
     171: if_icmpge     209
     174: aload         7
     176: invokevirtual #29                 // Method java/util/StringTokenizer.nextToken:()Ljava/lang/String;
     179: astore        9
     181: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
     184: ldc           #30                 // String Server supports realm %s
     186: aload         9
     188: invokevirtual #31                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     191: aload_0
     192: getfield      #5                  // Field serverRealms:Ljava/util/List;
     195: aload         9
     197: invokeinterface #13,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     202: pop
     203: iinc          10, 1
     206: goto          167
     209: aload_3
     210: ldc           #32                 // String org.jboss.sasl.digest.alternative_protocols
     212: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     217: checkcast     #16                 // class java/lang/String
     220: astore        7
     222: aload         7
     224: ifnull        303
     227: new           #25                 // class java/util/StringTokenizer
     230: dup
     231: aload         7
     233: ldc           #26                 // String , \t\n
     235: invokespecial #27                 // Method java/util/StringTokenizer."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     238: astore        8
     240: aload         8
     242: invokevirtual #33                 // Method java/util/StringTokenizer.hasMoreTokens:()Z
     245: ifeq          303
     248: new           #8                  // class java/lang/StringBuilder
     251: dup
     252: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
     255: aload         8
     257: invokevirtual #29                 // Method java/util/StringTokenizer.nextToken:()Ljava/lang/String;
     260: invokevirtual #34                 // Method java/lang/String.trim:()Ljava/lang/String;
     263: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     266: ldc           #11                 // String /
     268: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     271: aload_2
     272: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     275: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     278: astore        9
     280: aload         5
     282: aload         9
     284: invokeinterface #13,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     289: pop
     290: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
     293: ldc           #35                 // String Server supports digestUri %s
     295: aload         9
     297: invokevirtual #31                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     300: goto          240
     303: aload_3
     304: ldc           #36                 // String org.jboss.sasl.digest.pre_digested
     306: invokeinterface #37,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     311: ifeq          347
     314: aload_0
     315: aload_3
     316: ldc           #36                 // String org.jboss.sasl.digest.pre_digested
     318: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     323: invokestatic  #38                 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;
     326: invokestatic  #39                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
     329: putfield      #7                  // Field preDigestedPasswords:Z
     332: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
     335: ldc           #40                 // String Server using pre-digested hashes (%B)
     337: aload_0
     338: getfield      #7                  // Field preDigestedPasswords:Z
     341: invokestatic  #41                 // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
     344: invokevirtual #31                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     347: aload_0
     348: aload         5
     350: invokestatic  #42                 // Method java/util/Collections.unmodifiableList:(Ljava/util/List;)Ljava/util/List;
     353: putfield      #43                 // Field digestUris:Ljava/util/List;
     356: aload_0
     357: aload_0
     358: getfield      #6                  // Field useUTF8:Z
     361: ifeq          369
     364: ldc           #44                 // String UTF8
     366: goto          371
     369: ldc           #45                 // String 8859_1
     371: putfield      #46                 // Field encoding:Ljava/lang/String;
     374: aload_0
     375: getfield      #5                  // Field serverRealms:Ljava/util/List;
     378: invokeinterface #47,  1           // InterfaceMethod java/util/List.size:()I
     383: ifne          397
     386: aload_0
     387: getfield      #5                  // Field serverRealms:Ljava/util/List;
     390: aload_2
     391: invokeinterface #13,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     396: pop
     397: return

  public byte[] evaluateResponse(byte[]) throws javax.security.sasl.SaslException;
    Code:
       0: aload_1
       1: arraylength
       2: sipush        4096
       5: if_icmple     47
       8: new           #48                 // class javax/security/sasl/SaslException
      11: dup
      12: new           #8                  // class java/lang/StringBuilder
      15: dup
      16: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
      19: ldc           #49                 // String DIGEST-MD5: Invalid digest response length. Got:
      21: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      24: aload_1
      25: arraylength
      26: invokevirtual #50                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      29: ldc           #51                 // String  Expected <
      31: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      34: sipush        4096
      37: invokevirtual #50                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      40: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      43: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      46: athrow
      47: aload_0
      48: getfield      #53                 // Field step:I
      51: lookupswitch  { // 2
                     1: 76
                     3: 229
               default: 336
          }
      76: aload_1
      77: arraylength
      78: ifeq          91
      81: new           #48                 // class javax/security/sasl/SaslException
      84: dup
      85: ldc           #54                 // String DIGEST-MD5 must not have an initial response
      87: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      90: athrow
      91: aconst_null
      92: astore_3
      93: aload_0
      94: getfield      #55                 // Field allQop:B
      97: iconst_4
      98: iand
      99: ifeq          180
     102: aload_0
     103: invokestatic  #56                 // Method getPlatformCiphers:()[B
     106: putfield      #57                 // Field myCiphers:[B
     109: new           #8                  // class java/lang/StringBuilder
     112: dup
     113: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
     116: astore        4
     118: iconst_0
     119: istore        5
     121: iload         5
     123: getstatic     #58                 // Field CIPHER_TOKENS:[Ljava/lang/String;
     126: arraylength
     127: if_icmpge     174
     130: aload_0
     131: getfield      #57                 // Field myCiphers:[B
     134: iload         5
     136: baload
     137: ifeq          168
     140: aload         4
     142: invokevirtual #59                 // Method java/lang/StringBuilder.length:()I
     145: ifle          156
     148: aload         4
     150: bipush        44
     152: invokevirtual #60                 // Method java/lang/StringBuilder.append:(C)Ljava/lang/StringBuilder;
     155: pop
     156: aload         4
     158: getstatic     #58                 // Field CIPHER_TOKENS:[Ljava/lang/String;
     161: iload         5
     163: aaload
     164: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     167: pop
     168: iinc          5, 1
     171: goto          121
     174: aload         4
     176: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     179: astore_3
     180: aload_0
     181: aload_0
     182: getfield      #5                  // Field serverRealms:Ljava/util/List;
     185: aload_0
     186: getfield      #17                 // Field specifiedQops:Ljava/lang/String;
     189: aload_3
     190: invokespecial #61                 // Method generateChallenge:(Ljava/util/List;Ljava/lang/String;Ljava/lang/String;)[B
     193: astore_2
     194: aload_0
     195: iconst_3
     196: putfield      #53                 // Field step:I
     199: aload_2
     200: areturn
     201: astore        4
     203: new           #48                 // class javax/security/sasl/SaslException
     206: dup
     207: ldc           #63                 // String DIGEST-MD5: Error encoding challenge
     209: aload         4
     211: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     214: athrow
     215: astore        4
     217: new           #48                 // class javax/security/sasl/SaslException
     220: dup
     221: ldc           #66                 // String DIGEST-MD5: Error generating challenge
     223: aload         4
     225: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     228: athrow
     229: aload_1
     230: getstatic     #67                 // Field DIRECTIVE_KEY:[Ljava/lang/String;
     233: aconst_null
     234: iconst_1
     235: invokestatic  #68                 // Method parseDirectives:([B[Ljava/lang/String;Ljava/util/List;I)[[B
     238: astore        4
     240: aload_0
     241: aload         4
     243: invokespecial #69                 // Method validateClientResponse:([[B)[B
     246: astore_2
     247: aload_0
     248: iconst_0
     249: putfield      #53                 // Field step:I
     252: goto          279
     255: astore        4
     257: new           #48                 // class javax/security/sasl/SaslException
     260: dup
     261: ldc           #70                 // String DIGEST-MD5: Error validating client response
     263: aload         4
     265: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     268: athrow
     269: astore        6
     271: aload_0
     272: iconst_0
     273: putfield      #53                 // Field step:I
     276: aload         6
     278: athrow
     279: aload_0
     280: iconst_1
     281: putfield      #71                 // Field completed:Z
     284: aload_0
     285: getfield      #72                 // Field integrity:Z
     288: ifeq          314
     291: aload_0
     292: getfield      #73                 // Field privacy:Z
     295: ifeq          314
     298: aload_0
     299: new           #74                 // class org/jboss/sasl/digest/DigestMD5Base$DigestPrivacy
     302: dup
     303: aload_0
     304: iconst_0
     305: invokespecial #75                 // Method org/jboss/sasl/digest/DigestMD5Base$DigestPrivacy."<init>":(Lorg/jboss/sasl/digest/DigestMD5Base;Z)V
     308: putfield      #76                 // Field secCtx:Lorg/jboss/sasl/digest/SecurityCtx;
     311: goto          334
     314: aload_0
     315: getfield      #72                 // Field integrity:Z
     318: ifeq          334
     321: aload_0
     322: new           #77                 // class org/jboss/sasl/digest/DigestMD5Base$DigestIntegrity
     325: dup
     326: aload_0
     327: iconst_0
     328: invokespecial #78                 // Method org/jboss/sasl/digest/DigestMD5Base$DigestIntegrity."<init>":(Lorg/jboss/sasl/digest/DigestMD5Base;Z)V
     331: putfield      #76                 // Field secCtx:Lorg/jboss/sasl/digest/SecurityCtx;
     334: aload_2
     335: areturn
     336: new           #48                 // class javax/security/sasl/SaslException
     339: dup
     340: ldc           #79                 // String DIGEST-MD5: Server at illegal state
     342: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     345: athrow
    Exception table:
       from    to  target type
         180   200   201   Class java/io/UnsupportedEncodingException
         180   200   215   Class java/io/IOException
         229   247   255   Class java/io/UnsupportedEncodingException
         229   247   269   any
         255   271   269   any

  private byte[] generateChallenge(java.util.List<java.lang.String>, java.lang.String, java.lang.String) throws java.io.IOException;
    Code:
       0: new           #80                 // class java/io/ByteArrayOutputStream
       3: dup
       4: invokespecial #81                 // Method java/io/ByteArrayOutputStream."<init>":()V
       7: astore        4
       9: iconst_0
      10: istore        5
      12: aload_1
      13: ifnull        84
      16: iload         5
      18: aload_1
      19: invokeinterface #47,  1           // InterfaceMethod java/util/List.size:()I
      24: if_icmpge     84
      27: aload         4
      29: ldc           #82                 // String realm=\"
      31: aload_0
      32: getfield      #46                 // Field encoding:Ljava/lang/String;
      35: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      38: invokevirtual #84                 // Method java/io/ByteArrayOutputStream.write:([B)V
      41: aload         4
      43: aload_1
      44: iload         5
      46: invokeinterface #85,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      51: checkcast     #16                 // class java/lang/String
      54: aload_0
      55: getfield      #46                 // Field encoding:Ljava/lang/String;
      58: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      61: invokestatic  #86                 // Method writeQuotedStringValue:(Ljava/io/ByteArrayOutputStream;[B)V
      64: aload         4
      66: bipush        34
      68: invokevirtual #87                 // Method java/io/ByteArrayOutputStream.write:(I)V
      71: aload         4
      73: bipush        44
      75: invokevirtual #87                 // Method java/io/ByteArrayOutputStream.write:(I)V
      78: iinc          5, 1
      81: goto          12
      84: aload         4
      86: ldc           #88                 // String nonce=\"
      88: aload_0
      89: getfield      #46                 // Field encoding:Ljava/lang/String;
      92: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      95: invokevirtual #84                 // Method java/io/ByteArrayOutputStream.write:([B)V
      98: aload_0
      99: invokestatic  #89                 // Method generateNonce:()[B
     102: putfield      #90                 // Field nonce:[B
     105: aload         4
     107: aload_0
     108: getfield      #90                 // Field nonce:[B
     111: invokestatic  #86                 // Method writeQuotedStringValue:(Ljava/io/ByteArrayOutputStream;[B)V
     114: aload         4
     116: bipush        34
     118: invokevirtual #87                 // Method java/io/ByteArrayOutputStream.write:(I)V
     121: aload         4
     123: bipush        44
     125: invokevirtual #87                 // Method java/io/ByteArrayOutputStream.write:(I)V
     128: aload_2
     129: ifnull        173
     132: aload         4
     134: ldc           #91                 // String qop=\"
     136: aload_0
     137: getfield      #46                 // Field encoding:Ljava/lang/String;
     140: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     143: invokevirtual #84                 // Method java/io/ByteArrayOutputStream.write:([B)V
     146: aload         4
     148: aload_2
     149: aload_0
     150: getfield      #46                 // Field encoding:Ljava/lang/String;
     153: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     156: invokestatic  #86                 // Method writeQuotedStringValue:(Ljava/io/ByteArrayOutputStream;[B)V
     159: aload         4
     161: bipush        34
     163: invokevirtual #87                 // Method java/io/ByteArrayOutputStream.write:(I)V
     166: aload         4
     168: bipush        44
     170: invokevirtual #87                 // Method java/io/ByteArrayOutputStream.write:(I)V
     173: aload_0
     174: getfield      #92                 // Field recvMaxBufSize:I
     177: ldc           #93                 // int 65536
     179: if_icmpeq     221
     182: aload         4
     184: new           #8                  // class java/lang/StringBuilder
     187: dup
     188: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
     191: ldc           #94                 // String maxbuf=\"
     193: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     196: aload_0
     197: getfield      #92                 // Field recvMaxBufSize:I
     200: invokevirtual #50                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     203: ldc           #95                 // String \",
     205: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     208: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     211: aload_0
     212: getfield      #46                 // Field encoding:Ljava/lang/String;
     215: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     218: invokevirtual #84                 // Method java/io/ByteArrayOutputStream.write:([B)V
     221: aload_0
     222: getfield      #6                  // Field useUTF8:Z
     225: ifeq          242
     228: aload         4
     230: ldc           #96                 // String charset=utf-8,
     232: aload_0
     233: getfield      #46                 // Field encoding:Ljava/lang/String;
     236: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     239: invokevirtual #84                 // Method java/io/ByteArrayOutputStream.write:([B)V
     242: aload_3
     243: ifnull        287
     246: aload         4
     248: ldc           #97                 // String cipher=\"
     250: aload_0
     251: getfield      #46                 // Field encoding:Ljava/lang/String;
     254: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     257: invokevirtual #84                 // Method java/io/ByteArrayOutputStream.write:([B)V
     260: aload         4
     262: aload_3
     263: aload_0
     264: getfield      #46                 // Field encoding:Ljava/lang/String;
     267: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     270: invokestatic  #86                 // Method writeQuotedStringValue:(Ljava/io/ByteArrayOutputStream;[B)V
     273: aload         4
     275: bipush        34
     277: invokevirtual #87                 // Method java/io/ByteArrayOutputStream.write:(I)V
     280: aload         4
     282: bipush        44
     284: invokevirtual #87                 // Method java/io/ByteArrayOutputStream.write:(I)V
     287: aload         4
     289: ldc           #98                 // String algorithm=md5-sess
     291: aload_0
     292: getfield      #46                 // Field encoding:Ljava/lang/String;
     295: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     298: invokevirtual #84                 // Method java/io/ByteArrayOutputStream.write:([B)V
     301: aload         4
     303: invokevirtual #99                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     306: areturn

  private byte[] validateClientResponse(byte[][]) throws javax.security.sasl.SaslException, java.io.UnsupportedEncodingException;
    Code:
       0: aload_1
       1: bipush        9
       3: aaload
       4: ifnull        74
       7: aload_0
       8: getfield      #6                  // Field useUTF8:Z
      11: ifeq          37
      14: ldc           #100                // String utf-8
      16: new           #16                 // class java/lang/String
      19: dup
      20: aload_1
      21: bipush        9
      23: aaload
      24: aload_0
      25: getfield      #46                 // Field encoding:Ljava/lang/String;
      28: invokespecial #101                // Method java/lang/String."<init>":([BLjava/lang/String;)V
      31: invokevirtual #20                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      34: ifne          74
      37: new           #48                 // class javax/security/sasl/SaslException
      40: dup
      41: new           #8                  // class java/lang/StringBuilder
      44: dup
      45: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
      48: ldc           #102                // String DIGEST-MD5: digest response format violation. Incompatible charset value:
      50: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      53: new           #16                 // class java/lang/String
      56: dup
      57: aload_1
      58: bipush        9
      60: aaload
      61: invokespecial #103                // Method java/lang/String."<init>":([B)V
      64: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      67: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      70: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      73: athrow
      74: aload_1
      75: bipush        8
      77: aaload
      78: ifnonnull     86
      81: ldc           #93                 // int 65536
      83: goto          104
      86: new           #16                 // class java/lang/String
      89: dup
      90: aload_1
      91: bipush        8
      93: aaload
      94: aload_0
      95: getfield      #46                 // Field encoding:Ljava/lang/String;
      98: invokespecial #101                // Method java/lang/String."<init>":([BLjava/lang/String;)V
     101: invokestatic  #104                // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
     104: istore_2
     105: aload_0
     106: aload_0
     107: getfield      #105                // Field sendMaxBufSize:I
     110: ifne          117
     113: iload_2
     114: goto          125
     117: aload_0
     118: getfield      #105                // Field sendMaxBufSize:I
     121: iload_2
     122: invokestatic  #106                // Method java/lang/Math.min:(II)I
     125: putfield      #105                // Field sendMaxBufSize:I
     128: aload_1
     129: iconst_0
     130: aaload
     131: ifnull        161
     134: new           #16                 // class java/lang/String
     137: dup
     138: aload_1
     139: iconst_0
     140: aaload
     141: aload_0
     142: getfield      #46                 // Field encoding:Ljava/lang/String;
     145: invokespecial #101                // Method java/lang/String."<init>":([BLjava/lang/String;)V
     148: astore_3
     149: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
     152: ldc           #107                // String Username: %s
     154: aload_3
     155: invokevirtual #31                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     158: goto          171
     161: new           #48                 // class javax/security/sasl/SaslException
     164: dup
     165: ldc           #108                // String DIGEST-MD5: digest response format violation. Missing username.
     167: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     170: athrow
     171: aload_0
     172: aload_1
     173: iconst_1
     174: aaload
     175: ifnull        195
     178: new           #16                 // class java/lang/String
     181: dup
     182: aload_1
     183: iconst_1
     184: aaload
     185: aload_0
     186: getfield      #46                 // Field encoding:Ljava/lang/String;
     189: invokespecial #101                // Method java/lang/String."<init>":([BLjava/lang/String;)V
     192: goto          197
     195: ldc           #109                // String
     197: putfield      #110                // Field negotiatedRealm:Ljava/lang/String;
     200: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
     203: ldc           #111                // String Client negotiated realm: %s
     205: aload_0
     206: getfield      #110                // Field negotiatedRealm:Ljava/lang/String;
     209: invokevirtual #31                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     212: aload_0
     213: getfield      #5                  // Field serverRealms:Ljava/util/List;
     216: aload_0
     217: getfield      #110                // Field negotiatedRealm:Ljava/lang/String;
     220: invokeinterface #112,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
     225: ifne          258
     228: new           #48                 // class javax/security/sasl/SaslException
     231: dup
     232: new           #8                  // class java/lang/StringBuilder
     235: dup
     236: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
     239: ldc           #113                // String DIGEST-MD5: digest response format violation. Nonexistent realm:
     241: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     244: aload_0
     245: getfield      #110                // Field negotiatedRealm:Ljava/lang/String;
     248: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     251: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     254: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     257: athrow
     258: aload_1
     259: iconst_2
     260: aaload
     261: ifnonnull     274
     264: new           #48                 // class javax/security/sasl/SaslException
     267: dup
     268: ldc           #114                // String DIGEST-MD5: digest response format violation. Missing nonce.
     270: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     273: athrow
     274: aload_1
     275: iconst_2
     276: aaload
     277: astore        4
     279: aload         4
     281: aload_0
     282: getfield      #90                 // Field nonce:[B
     285: invokestatic  #115                // Method java/util/Arrays.equals:([B[B)Z
     288: ifne          301
     291: new           #48                 // class javax/security/sasl/SaslException
     294: dup
     295: ldc           #116                // String DIGEST-MD5: digest response format violation. Mismatched nonce.
     297: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     300: athrow
     301: aload_1
     302: iconst_3
     303: aaload
     304: ifnonnull     317
     307: new           #48                 // class javax/security/sasl/SaslException
     310: dup
     311: ldc           #117                // String DIGEST-MD5: digest response format violation. Missing cnonce.
     313: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     316: athrow
     317: aload_1
     318: iconst_3
     319: aaload
     320: astore        5
     322: aload_1
     323: iconst_4
     324: aaload
     325: ifnull        387
     328: iconst_1
     329: new           #16                 // class java/lang/String
     332: dup
     333: aload_1
     334: iconst_4
     335: aaload
     336: aload_0
     337: getfield      #46                 // Field encoding:Ljava/lang/String;
     340: invokespecial #101                // Method java/lang/String."<init>":([BLjava/lang/String;)V
     343: bipush        16
     345: invokestatic  #118                // Method java/lang/Integer.parseInt:(Ljava/lang/String;I)I
     348: if_icmpeq     387
     351: new           #48                 // class javax/security/sasl/SaslException
     354: dup
     355: new           #8                  // class java/lang/StringBuilder
     358: dup
     359: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
     362: ldc           #119                // String DIGEST-MD5: digest response format violation. Nonce count does not match:
     364: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     367: new           #16                 // class java/lang/String
     370: dup
     371: aload_1
     372: iconst_4
     373: aaload
     374: invokespecial #103                // Method java/lang/String."<init>":([B)V
     377: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     380: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     383: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     386: athrow
     387: aload_0
     388: aload_1
     389: iconst_5
     390: aaload
     391: ifnull        411
     394: new           #16                 // class java/lang/String
     397: dup
     398: aload_1
     399: iconst_5
     400: aaload
     401: aload_0
     402: getfield      #46                 // Field encoding:Ljava/lang/String;
     405: invokespecial #101                // Method java/lang/String."<init>":([BLjava/lang/String;)V
     408: goto          413
     411: ldc           #120                // String auth
     413: putfield      #121                // Field negotiatedQop:Ljava/lang/String;
     416: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
     419: ldc           #122                // String Client negotiated qop: %s
     421: aload_0
     422: getfield      #121                // Field negotiatedQop:Ljava/lang/String;
     425: invokevirtual #31                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     428: aload_0
     429: getfield      #121                // Field negotiatedQop:Ljava/lang/String;
     432: ldc           #120                // String auth
     434: invokevirtual #20                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     437: ifeq          446
     440: iconst_1
     441: istore        6
     443: goto          549
     446: aload_0
     447: getfield      #121                // Field negotiatedQop:Ljava/lang/String;
     450: ldc           #123                // String auth-int
     452: invokevirtual #20                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     455: ifeq          480
     458: iconst_2
     459: istore        6
     461: aload_0
     462: iconst_1
     463: putfield      #72                 // Field integrity:Z
     466: aload_0
     467: aload_0
     468: getfield      #105                // Field sendMaxBufSize:I
     471: bipush        16
     473: isub
     474: putfield      #124                // Field rawSendSize:I
     477: goto          549
     480: aload_0
     481: getfield      #121                // Field negotiatedQop:Ljava/lang/String;
     484: ldc           #125                // String auth-conf
     486: invokevirtual #20                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     489: ifeq          519
     492: iconst_4
     493: istore        6
     495: aload_0
     496: aload_0
     497: iconst_1
     498: dup_x1
     499: putfield      #73                 // Field privacy:Z
     502: putfield      #72                 // Field integrity:Z
     505: aload_0
     506: aload_0
     507: getfield      #105                // Field sendMaxBufSize:I
     510: bipush        26
     512: isub
     513: putfield      #124                // Field rawSendSize:I
     516: goto          549
     519: new           #48                 // class javax/security/sasl/SaslException
     522: dup
     523: new           #8                  // class java/lang/StringBuilder
     526: dup
     527: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
     530: ldc           #126                // String DIGEST-MD5: digest response format violation. Invalid QOP:
     532: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     535: aload_0
     536: getfield      #121                // Field negotiatedQop:Ljava/lang/String;
     539: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     542: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     545: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     548: athrow
     549: iload         6
     551: aload_0
     552: getfield      #55                 // Field allQop:B
     555: iand
     556: ifne          589
     559: new           #48                 // class javax/security/sasl/SaslException
     562: dup
     563: new           #8                  // class java/lang/StringBuilder
     566: dup
     567: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
     570: ldc           #127                // String DIGEST-MD5: server does not support  qop:
     572: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     575: aload_0
     576: getfield      #121                // Field negotiatedQop:Ljava/lang/String;
     579: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     582: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     585: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     588: athrow
     589: aload_0
     590: getfield      #73                 // Field privacy:Z
     593: ifeq          803
     596: aload_0
     597: aload_1
     598: bipush        10
     600: aaload
     601: ifnull        622
     604: new           #16                 // class java/lang/String
     607: dup
     608: aload_1
     609: bipush        10
     611: aaload
     612: aload_0
     613: getfield      #46                 // Field encoding:Ljava/lang/String;
     616: invokespecial #101                // Method java/lang/String."<init>":([BLjava/lang/String;)V
     619: goto          623
     622: aconst_null
     623: putfield      #128                // Field negotiatedCipher:Ljava/lang/String;
     626: aload_0
     627: getfield      #128                // Field negotiatedCipher:Ljava/lang/String;
     630: ifnonnull     643
     633: new           #48                 // class javax/security/sasl/SaslException
     636: dup
     637: ldc           #129                // String DIGEST-MD5: digest response format violation. No cipher specified.
     639: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     642: athrow
     643: iconst_m1
     644: istore        7
     646: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
     649: ldc           #130                // String Client negotiated cipher: %s
     651: aload_0
     652: getfield      #128                // Field negotiatedCipher:Ljava/lang/String;
     655: invokevirtual #31                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     658: iconst_0
     659: istore        8
     661: iload         8
     663: getstatic     #58                 // Field CIPHER_TOKENS:[Ljava/lang/String;
     666: arraylength
     667: if_icmpge     709
     670: aload_0
     671: getfield      #128                // Field negotiatedCipher:Ljava/lang/String;
     674: getstatic     #58                 // Field CIPHER_TOKENS:[Ljava/lang/String;
     677: iload         8
     679: aaload
     680: invokevirtual #20                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     683: ifeq          703
     686: aload_0
     687: getfield      #57                 // Field myCiphers:[B
     690: iload         8
     692: baload
     693: ifeq          703
     696: iload         8
     698: istore        7
     700: goto          709
     703: iinc          8, 1
     706: goto          661
     709: iload         7
     711: iconst_m1
     712: if_icmpne     745
     715: new           #48                 // class javax/security/sasl/SaslException
     718: dup
     719: new           #8                  // class java/lang/StringBuilder
     722: dup
     723: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
     726: ldc           #131                // String DIGEST-MD5: server does not support cipher:
     728: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     731: aload_0
     732: getfield      #128                // Field negotiatedCipher:Ljava/lang/String;
     735: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     738: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     741: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     744: athrow
     745: getstatic     #132                // Field CIPHER_MASKS:[B
     748: iload         7
     750: baload
     751: iconst_4
     752: iand
     753: ifeq          765
     756: aload_0
     757: ldc           #133                // String high
     759: putfield      #134                // Field negotiatedStrength:Ljava/lang/String;
     762: goto          791
     765: getstatic     #132                // Field CIPHER_MASKS:[B
     768: iload         7
     770: baload
     771: iconst_2
     772: iand
     773: ifeq          785
     776: aload_0
     777: ldc           #135                // String medium
     779: putfield      #134                // Field negotiatedStrength:Ljava/lang/String;
     782: goto          791
     785: aload_0
     786: ldc           #136                // String low
     788: putfield      #134                // Field negotiatedStrength:Ljava/lang/String;
     791: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
     794: ldc           #137                // String Negotiated strength: %s
     796: aload_0
     797: getfield      #134                // Field negotiatedStrength:Ljava/lang/String;
     800: invokevirtual #31                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     803: aload_1
     804: bipush        6
     806: aaload
     807: ifnull        828
     810: new           #16                 // class java/lang/String
     813: dup
     814: aload_1
     815: bipush        6
     817: aaload
     818: aload_0
     819: getfield      #46                 // Field encoding:Ljava/lang/String;
     822: invokespecial #101                // Method java/lang/String."<init>":([BLjava/lang/String;)V
     825: goto          829
     828: aconst_null
     829: astore        7
     831: aload         7
     833: ifnull        846
     836: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
     839: ldc           #138                // String DIGEST87:digest URI: %s
     841: aload         7
     843: invokevirtual #31                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     846: aconst_null
     847: astore        8
     849: aload_0
     850: getfield      #43                 // Field digestUris:Ljava/util/List;
     853: invokeinterface #139,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     858: astore        9
     860: aload         9
     862: invokeinterface #140,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     867: ifeq          899
     870: aload         9
     872: invokeinterface #141,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     877: checkcast     #16                 // class java/lang/String
     880: astore        10
     882: aload         10
     884: aload         7
     886: invokevirtual #142                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     889: ifeq          896
     892: aload         7
     894: astore        8
     896: goto          860
     899: aload         8
     901: ifnonnull     1003
     904: new           #8                  // class java/lang/StringBuilder
     907: dup
     908: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
     911: astore        9
     913: aload_0
     914: getfield      #43                 // Field digestUris:Ljava/util/List;
     917: invokeinterface #139,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     922: astore        10
     924: aload         10
     926: invokeinterface #140,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     931: ifeq          962
     934: aload         10
     936: invokeinterface #141,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     941: checkcast     #16                 // class java/lang/String
     944: astore        11
     946: aload         9
     948: aload         11
     950: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     953: ldc           #143                // String
     955: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     958: pop
     959: goto          924
     962: new           #48                 // class javax/security/sasl/SaslException
     965: dup
     966: new           #8                  // class java/lang/StringBuilder
     969: dup
     970: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
     973: ldc           #144                // String DIGEST-MD5: digest response format violation. Mismatched URI:
     975: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     978: aload         7
     980: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     983: ldc           #145                // String ; expecting one of:
     985: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     988: aload         9
     990: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     993: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     996: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     999: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
    1002: athrow
    1003: aload_1
    1004: bipush        7
    1006: aaload
    1007: astore        9
    1009: aload         9
    1011: ifnonnull     1024
    1014: new           #48                 // class javax/security/sasl/SaslException
    1017: dup
    1018: ldc           #146                // String DIGEST-MD5: digest response format  violation. Missing response.
    1020: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
    1023: athrow
    1024: aload_1
    1025: bipush        11
    1027: aaload
    1028: dup
    1029: astore        10
    1031: ifnull        1050
    1034: new           #16                 // class java/lang/String
    1037: dup
    1038: aload         10
    1040: aload_0
    1041: getfield      #46                 // Field encoding:Ljava/lang/String;
    1044: invokespecial #101                // Method java/lang/String."<init>":([BLjava/lang/String;)V
    1047: goto          1051
    1050: aload_3
    1051: astore        11
    1053: aload         10
    1055: ifnull        1075
    1058: getstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
    1061: ldc           #147                // String Authzid: %s
    1063: new           #16                 // class java/lang/String
    1066: dup
    1067: aload         10
    1069: invokespecial #103                // Method java/lang/String."<init>":([B)V
    1072: invokevirtual #31                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
    1075: aconst_null
    1076: astore        12
    1078: aconst_null
    1079: astore        13
    1081: new           #148                // class javax/security/sasl/RealmCallback
    1084: dup
    1085: ldc           #149                // String DIGEST-MD5 realm:
    1087: aload_0
    1088: getfield      #110                // Field negotiatedRealm:Ljava/lang/String;
    1091: invokespecial #150                // Method javax/security/sasl/RealmCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
    1094: astore        14
    1096: new           #151                // class javax/security/auth/callback/NameCallback
    1099: dup
    1100: ldc           #152                // String DIGEST-MD5 authentication ID:
    1102: aload_3
    1103: invokespecial #153                // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
    1106: astore        15
    1108: aload_0
    1109: getfield      #7                  // Field preDigestedPasswords:Z
    1112: ifeq          1170
    1115: new           #154                // class org/jboss/sasl/callback/DigestHashCallback
    1118: dup
    1119: ldc           #155                // String DIGEST-MD5 { username : realm : password } hash.
    1121: invokespecial #156                // Method org/jboss/sasl/callback/DigestHashCallback."<init>":(Ljava/lang/String;)V
    1124: astore        16
    1126: aload_0
    1127: getfield      #157                // Field cbh:Ljavax/security/auth/callback/CallbackHandler;
    1130: iconst_3
    1131: anewarray     #158                // class javax/security/auth/callback/Callback
    1134: dup
    1135: iconst_0
    1136: aload         14
    1138: aastore
    1139: dup
    1140: iconst_1
    1141: aload         15
    1143: aastore
    1144: dup
    1145: iconst_2
    1146: aload         16
    1148: aastore
    1149: invokeinterface #159,  2          // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
    1154: aload         16
    1156: invokevirtual #160                // Method org/jboss/sasl/callback/DigestHashCallback.getHash:()[B
    1159: astore        13
    1161: aload         16
    1163: aconst_null
    1164: invokevirtual #161                // Method org/jboss/sasl/callback/DigestHashCallback.setHash:([B)V
    1167: goto          1222
    1170: new           #162                // class javax/security/auth/callback/PasswordCallback
    1173: dup
    1174: ldc           #163                // String DIGEST-MD5 password:
    1176: iconst_0
    1177: invokespecial #164                // Method javax/security/auth/callback/PasswordCallback."<init>":(Ljava/lang/String;Z)V
    1180: astore        16
    1182: aload_0
    1183: getfield      #157                // Field cbh:Ljavax/security/auth/callback/CallbackHandler;
    1186: iconst_3
    1187: anewarray     #158                // class javax/security/auth/callback/Callback
    1190: dup
    1191: iconst_0
    1192: aload         14
    1194: aastore
    1195: dup
    1196: iconst_1
    1197: aload         15
    1199: aastore
    1200: dup
    1201: iconst_2
    1202: aload         16
    1204: aastore
    1205: invokeinterface #159,  2          // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
    1210: aload         16
    1212: invokevirtual #165                // Method javax/security/auth/callback/PasswordCallback.getPassword:()[C
    1215: astore        12
    1217: aload         16
    1219: invokevirtual #166                // Method javax/security/auth/callback/PasswordCallback.clearPassword:()V
    1222: goto          1253
    1225: astore        14
    1227: new           #48                 // class javax/security/sasl/SaslException
    1230: dup
    1231: ldc           #168                // String DIGEST-MD5: Cannot perform callback to acquire password
    1233: aload         14
    1235: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
    1238: athrow
    1239: astore        14
    1241: new           #48                 // class javax/security/sasl/SaslException
    1244: dup
    1245: ldc           #169                // String DIGEST-MD5: IO error acquiring password
    1247: aload         14
    1249: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
    1252: athrow
    1253: aload_0
    1254: getfield      #7                  // Field preDigestedPasswords:Z
    1257: ifne          1304
    1260: aload         12
    1262: ifnonnull     1304
    1265: new           #48                 // class javax/security/sasl/SaslException
    1268: dup
    1269: new           #8                  // class java/lang/StringBuilder
    1272: dup
    1273: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
    1276: ldc           #170                // String DIGEST-MD5: cannot acquire password for
    1278: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1281: aload_3
    1282: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1285: ldc           #171                // String  in realm :
    1287: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1290: aload_0
    1291: getfield      #110                // Field negotiatedRealm:Ljava/lang/String;
    1294: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1297: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1300: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
    1303: athrow
    1304: aload_0
    1305: getfield      #7                  // Field preDigestedPasswords:Z
    1308: ifeq          1355
    1311: aload         13
    1313: ifnonnull     1355
    1316: new           #48                 // class javax/security/sasl/SaslException
    1319: dup
    1320: new           #8                  // class java/lang/StringBuilder
    1323: dup
    1324: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
    1327: ldc           #172                // String DIGEST-MD5: cannot acquire hash for
    1329: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1332: aload_3
    1333: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1336: ldc           #171                // String  in realm :
    1338: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1341: aload_0
    1342: getfield      #110                // Field negotiatedRealm:Ljava/lang/String;
    1345: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1348: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1351: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
    1354: athrow
    1355: aload_0
    1356: getfield      #7                  // Field preDigestedPasswords:Z
    1359: ifeq          1390
    1362: aload_0
    1363: ldc           #173                // String AUTHENTICATE
    1365: aload         8
    1367: aload_0
    1368: getfield      #121                // Field negotiatedQop:Ljava/lang/String;
    1371: aload         13
    1373: aload_0
    1374: getfield      #90                 // Field nonce:[B
    1377: aload         5
    1379: iconst_1
    1380: aload         10
    1382: invokevirtual #174                // Method generateResponseValue:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[B[B[BI[B)[B
    1385: astore        14
    1387: goto          1420
    1390: aload_0
    1391: ldc           #173                // String AUTHENTICATE
    1393: aload         8
    1395: aload_0
    1396: getfield      #121                // Field negotiatedQop:Ljava/lang/String;
    1399: aload_3
    1400: aload_0
    1401: getfield      #110                // Field negotiatedRealm:Ljava/lang/String;
    1404: aload         12
    1406: aload_0
    1407: getfield      #90                 // Field nonce:[B
    1410: aload         5
    1412: iconst_1
    1413: aload         10
    1415: invokevirtual #175                // Method generateResponseValue:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[C[B[BI[B)[B
    1418: astore        14
    1420: goto          1451
    1423: astore        15
    1425: new           #48                 // class javax/security/sasl/SaslException
    1428: dup
    1429: ldc           #177                // String DIGEST-MD5: problem duplicating client response
    1431: aload         15
    1433: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
    1436: athrow
    1437: astore        15
    1439: new           #48                 // class javax/security/sasl/SaslException
    1442: dup
    1443: ldc           #177                // String DIGEST-MD5: problem duplicating client response
    1445: aload         15
    1447: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
    1450: athrow
    1451: aload         9
    1453: aload         14
    1455: invokestatic  #115                // Method java/util/Arrays.equals:([B[B)Z
    1458: ifne          1471
    1461: new           #48                 // class javax/security/sasl/SaslException
    1464: dup
    1465: ldc           #178                // String DIGEST-MD5: digest response format violation. Mismatched response.
    1467: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
    1470: athrow
    1471: new           #179                // class javax/security/sasl/AuthorizeCallback
    1474: dup
    1475: aload_3
    1476: aload         11
    1478: invokespecial #180                // Method javax/security/sasl/AuthorizeCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
    1481: astore        15
    1483: aload_0
    1484: getfield      #157                // Field cbh:Ljavax/security/auth/callback/CallbackHandler;
    1487: iconst_1
    1488: anewarray     #158                // class javax/security/auth/callback/Callback
    1491: dup
    1492: iconst_0
    1493: aload         15
    1495: aastore
    1496: invokeinterface #159,  2          // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
    1501: aload         15
    1503: invokevirtual #181                // Method javax/security/sasl/AuthorizeCallback.isAuthorized:()Z
    1506: ifeq          1521
    1509: aload_0
    1510: aload         15
    1512: invokevirtual #182                // Method javax/security/sasl/AuthorizeCallback.getAuthorizedID:()Ljava/lang/String;
    1515: putfield      #183                // Field authzid:Ljava/lang/String;
    1518: goto          1558
    1521: new           #48                 // class javax/security/sasl/SaslException
    1524: dup
    1525: new           #8                  // class java/lang/StringBuilder
    1528: dup
    1529: invokespecial #9                  // Method java/lang/StringBuilder."<init>":()V
    1532: ldc           #184                // String DIGEST-MD5:
    1534: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1537: aload_3
    1538: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1541: ldc           #185                // String  is not authorized to act as
    1543: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1546: aload         11
    1548: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1551: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1554: invokespecial #52                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
    1557: athrow
    1558: goto          1594
    1561: astore        15
    1563: aload         15
    1565: athrow
    1566: astore        15
    1568: new           #48                 // class javax/security/sasl/SaslException
    1571: dup
    1572: ldc           #186                // String DIGEST-MD5: Cannot perform callback to check authzid
    1574: aload         15
    1576: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
    1579: athrow
    1580: astore        15
    1582: new           #48                 // class javax/security/sasl/SaslException
    1585: dup
    1586: ldc           #187                // String DIGEST-MD5: IO error checking authzid
    1588: aload         15
    1590: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
    1593: athrow
    1594: aload_0
    1595: getfield      #7                  // Field preDigestedPasswords:Z
    1598: ifeq          1678
    1601: aload_0
    1602: aload         8
    1604: aload         13
    1606: aload         5
    1608: iconst_1
    1609: aload         10
    1611: invokespecial #188                // Method generateResponseAuth:(Ljava/lang/String;[B[BI[B)[B
    1614: astore        15
    1616: aload         12
    1618: ifnull        1647
    1621: iconst_0
    1622: istore        16
    1624: iload         16
    1626: aload         12
    1628: arraylength
    1629: if_icmpge     1644
    1632: aload         12
    1634: iload         16
    1636: iconst_0
    1637: castore
    1638: iinc          16, 1
    1641: goto          1624
    1644: goto          1675
    1647: aload         13
    1649: ifnull        1675
    1652: iconst_0
    1653: istore        16
    1655: iload         16
    1657: aload         13
    1659: arraylength
    1660: if_icmpge     1675
    1663: aload         13
    1665: iload         16
    1667: iconst_0
    1668: bastore
    1669: iinc          16, 1
    1672: goto          1655
    1675: aload         15
    1677: areturn
    1678: aload_0
    1679: aload         8
    1681: aload_3
    1682: aload         12
    1684: aload         5
    1686: iconst_1
    1687: aload         10
    1689: invokespecial #189                // Method generateResponseAuth:(Ljava/lang/String;Ljava/lang/String;[C[BI[B)[B
    1692: astore        15
    1694: aload         12
    1696: ifnull        1725
    1699: iconst_0
    1700: istore        16
    1702: iload         16
    1704: aload         12
    1706: arraylength
    1707: if_icmpge     1722
    1710: aload         12
    1712: iload         16
    1714: iconst_0
    1715: castore
    1716: iinc          16, 1
    1719: goto          1702
    1722: goto          1753
    1725: aload         13
    1727: ifnull        1753
    1730: iconst_0
    1731: istore        16
    1733: iload         16
    1735: aload         13
    1737: arraylength
    1738: if_icmpge     1753
    1741: aload         13
    1743: iload         16
    1745: iconst_0
    1746: bastore
    1747: iinc          16, 1
    1750: goto          1733
    1753: aload         15
    1755: areturn
    1756: astore        17
    1758: aload         12
    1760: ifnull        1789
    1763: iconst_0
    1764: istore        18
    1766: iload         18
    1768: aload         12
    1770: arraylength
    1771: if_icmpge     1786
    1774: aload         12
    1776: iload         18
    1778: iconst_0
    1779: castore
    1780: iinc          18, 1
    1783: goto          1766
    1786: goto          1817
    1789: aload         13
    1791: ifnull        1817
    1794: iconst_0
    1795: istore        18
    1797: iload         18
    1799: aload         13
    1801: arraylength
    1802: if_icmpge     1817
    1805: aload         13
    1807: iload         18
    1809: iconst_0
    1810: bastore
    1811: iinc          18, 1
    1814: goto          1797
    1817: aload         17
    1819: athrow
    Exception table:
       from    to  target type
        1081  1222  1225   Class javax/security/auth/callback/UnsupportedCallbackException
        1081  1222  1239   Class java/io/IOException
        1355  1420  1423   Class java/security/NoSuchAlgorithmException
        1355  1420  1437   Class java/io/IOException
        1471  1558  1561   Class javax/security/sasl/SaslException
        1471  1558  1566   Class javax/security/auth/callback/UnsupportedCallbackException
        1471  1558  1580   Class java/io/IOException
        1355  1616  1756   any
        1678  1694  1756   any
        1756  1758  1756   any

  private byte[] generateResponseAuth(java.lang.String, java.lang.String, char[], byte[], int, byte[]) throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: ldc           #109                // String
       3: aload_1
       4: aload_0
       5: getfield      #121                // Field negotiatedQop:Ljava/lang/String;
       8: aload_2
       9: aload_0
      10: getfield      #110                // Field negotiatedRealm:Ljava/lang/String;
      13: aload_3
      14: aload_0
      15: getfield      #90                 // Field nonce:[B
      18: aload         4
      20: iload         5
      22: aload         6
      24: invokevirtual #175                // Method generateResponseValue:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[C[B[BI[B)[B
      27: astore        7
      29: aload_0
      30: aload         7
      32: invokespecial #190                // Method generateChallenge:([B)[B
      35: areturn
      36: astore        7
      38: new           #48                 // class javax/security/sasl/SaslException
      41: dup
      42: ldc           #191                // String DIGEST-MD5: problem generating response
      44: aload         7
      46: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      49: athrow
      50: astore        7
      52: new           #48                 // class javax/security/sasl/SaslException
      55: dup
      56: ldc           #191                // String DIGEST-MD5: problem generating response
      58: aload         7
      60: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      63: athrow
    Exception table:
       from    to  target type
           0    35    36   Class java/security/NoSuchAlgorithmException
           0    35    50   Class java/io/IOException

  private byte[] generateResponseAuth(java.lang.String, byte[], byte[], int, byte[]) throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: ldc           #109                // String
       3: aload_1
       4: aload_0
       5: getfield      #121                // Field negotiatedQop:Ljava/lang/String;
       8: aload_2
       9: aload_0
      10: getfield      #90                 // Field nonce:[B
      13: aload_3
      14: iload         4
      16: aload         5
      18: invokevirtual #174                // Method generateResponseValue:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[B[B[BI[B)[B
      21: astore        6
      23: aload_0
      24: aload         6
      26: invokespecial #190                // Method generateChallenge:([B)[B
      29: areturn
      30: astore        6
      32: new           #48                 // class javax/security/sasl/SaslException
      35: dup
      36: ldc           #191                // String DIGEST-MD5: problem generating response
      38: aload         6
      40: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      43: athrow
      44: astore        6
      46: new           #48                 // class javax/security/sasl/SaslException
      49: dup
      50: ldc           #191                // String DIGEST-MD5: problem generating response
      52: aload         6
      54: invokespecial #64                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      57: athrow
    Exception table:
       from    to  target type
           0    29    30   Class java/security/NoSuchAlgorithmException
           0    29    44   Class java/io/IOException

  private byte[] generateChallenge(byte[]) throws java.io.UnsupportedEncodingException;
    Code:
       0: aload_1
       1: arraylength
       2: bipush        8
       4: iadd
       5: newarray       byte
       7: astore_2
       8: ldc           #192                // String rspauth=
      10: aload_0
      11: getfield      #46                 // Field encoding:Ljava/lang/String;
      14: invokevirtual #83                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      17: iconst_0
      18: aload_2
      19: iconst_0
      20: bipush        8
      22: invokestatic  #193                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      25: aload_1
      26: iconst_0
      27: aload_2
      28: bipush        8
      30: aload_1
      31: arraylength
      32: invokestatic  #193                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      35: aload_2
      36: areturn

  public java.lang.String getAuthorizationID();
    Code:
       0: aload_0
       1: getfield      #71                 // Field completed:Z
       4: ifeq          12
       7: aload_0
       8: getfield      #183                // Field authzid:Ljava/lang/String;
      11: areturn
      12: new           #194                // class java/lang/IllegalStateException
      15: dup
      16: ldc           #195                // String DIGEST-MD5 server negotiation not complete
      18: invokespecial #196                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      21: athrow

  public java.lang.Object getNegotiatedProperty(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #197                // Method org/jboss/sasl/digest/DigestMD5Base.getNegotiatedProperty:(Ljava/lang/String;)Ljava/lang/Object;
       5: areturn

  public void dispose() throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: invokespecial #198                // Method org/jboss/sasl/digest/DigestMD5Base.dispose:()V
       4: return

  public byte[] wrap(byte[], int, int) throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: aload_1
       2: iload_2
       3: iload_3
       4: invokespecial #199                // Method org/jboss/sasl/digest/DigestMD5Base.wrap:([BII)[B
       7: areturn

  public byte[] unwrap(byte[], int, int) throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: aload_1
       2: iload_2
       3: iload_3
       4: invokespecial #200                // Method org/jboss/sasl/digest/DigestMD5Base.unwrap:([BII)[B
       7: areturn

  public java.lang.String getMechanismName();
    Code:
       0: aload_0
       1: invokespecial #201                // Method org/jboss/sasl/digest/DigestMD5Base.getMechanismName:()Ljava/lang/String;
       4: areturn

  public boolean isComplete();
    Code:
       0: aload_0
       1: invokespecial #202                // Method org/jboss/sasl/digest/DigestMD5Base.isComplete:()Z
       4: ireturn

  static {};
    Code:
       0: ldc_w         #203                // class org/jboss/sasl/digest/DigestMD5Server
       3: invokevirtual #204                // Method java/lang/Class.getName:()Ljava/lang/String;
       6: putstatic     #1                  // Field MY_CLASS_NAME:Ljava/lang/String;
       9: ldc           #205                // String org.jboss.sasl.digest.server
      11: invokestatic  #206                // Method org/jboss/logging/Logger.getLogger:(Ljava/lang/String;)Lorg/jboss/logging/Logger;
      14: putstatic     #21                 // Field log:Lorg/jboss/logging/Logger;
      17: bipush        13
      19: anewarray     #16                 // class java/lang/String
      22: dup
      23: iconst_0
      24: ldc           #207                // String username
      26: aastore
      27: dup
      28: iconst_1
      29: ldc           #208                // String realm
      31: aastore
      32: dup
      33: iconst_2
      34: ldc           #209                // String nonce
      36: aastore
      37: dup
      38: iconst_3
      39: ldc           #210                // String cnonce
      41: aastore
      42: dup
      43: iconst_4
      44: ldc           #211                // String nonce-count
      46: aastore
      47: dup
      48: iconst_5
      49: ldc           #212                // String qop
      51: aastore
      52: dup
      53: bipush        6
      55: ldc           #213                // String digest-uri
      57: aastore
      58: dup
      59: bipush        7
      61: ldc           #214                // String response
      63: aastore
      64: dup
      65: bipush        8
      67: ldc           #215                // String maxbuf
      69: aastore
      70: dup
      71: bipush        9
      73: ldc           #216                // String charset
      75: aastore
      76: dup
      77: bipush        10
      79: ldc           #217                // String cipher
      81: aastore
      82: dup
      83: bipush        11
      85: ldc           #218                // String authzid
      87: aastore
      88: dup
      89: bipush        12
      91: ldc           #219                // String auth-param
      93: aastore
      94: putstatic     #67                 // Field DIRECTIVE_KEY:[Ljava/lang/String;
      97: return
}
