Compiled from "PlainSaslServer.java"
class org.jboss.sasl.plain.PlainSaslServer$1 implements org.jboss.sasl.util.SaslState {
  private static final byte UTF8NUL;

  final org.jboss.sasl.plain.PlainSaslServer this$0;

  org.jboss.sasl.plain.PlainSaslServer$1(org.jboss.sasl.plain.PlainSaslServer);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #1                  // Field this$0:Lorg/jboss/sasl/plain/PlainSaslServer;
       5: aload_0
       6: invokespecial #2                  // Method java/lang/Object."<init>":()V
       9: return

  public byte[] evaluateMessage(org.jboss.sasl.util.SaslStateContext, byte[]) throws javax.security.sasl.SaslException;
    Code:
       0: aload_2
       1: arraylength
       2: istore_3
       3: iload_3
       4: ifne          11
       7: getstatic     #3                  // Field org/jboss/sasl/util/AbstractSaslParticipant.NO_BYTES:[B
      10: areturn
      11: iload_3
      12: ldc           #4                  // int 65536
      14: if_icmple     27
      17: new           #5                  // class javax/security/sasl/SaslException
      20: dup
      21: ldc           #6                  // String Authentication message is too long
      23: invokespecial #7                  // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      26: athrow
      27: aload_0
      28: aload_2
      29: invokespecial #8                  // Method split:([B)[Ljava/lang/String;
      32: astore        4
      34: aload         4
      36: arraylength
      37: iconst_2
      38: if_icmpne     60
      41: aload         4
      43: iconst_0
      44: aaload
      45: astore        5
      47: aload         5
      49: astore        6
      51: aload         4
      53: iconst_1
      54: aaload
      55: astore        7
      57: goto          122
      60: aload         4
      62: arraylength
      63: iconst_3
      64: if_icmpne     88
      67: aload         4
      69: iconst_0
      70: aaload
      71: astore        6
      73: aload         4
      75: iconst_1
      76: aaload
      77: astore        5
      79: aload         4
      81: iconst_2
      82: aaload
      83: astore        7
      85: goto          122
      88: new           #5                  // class javax/security/sasl/SaslException
      91: dup
      92: new           #9                  // class java/lang/StringBuilder
      95: dup
      96: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
      99: ldc           #11                 // String Invalid number of message parts (
     101: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     104: aload         4
     106: arraylength
     107: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     110: ldc           #14                 // String )
     112: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     115: invokevirtual #15                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     118: invokespecial #7                  // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     121: athrow
     122: new           #16                 // class javax/security/auth/callback/NameCallback
     125: dup
     126: ldc           #17                 // String PLAIN authentication identity
     128: aload         5
     130: invokespecial #18                 // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     133: astore        8
     135: new           #19                 // class org/jboss/sasl/callback/VerifyPasswordCallback
     138: dup
     139: aload         7
     141: invokespecial #20                 // Method org/jboss/sasl/callback/VerifyPasswordCallback."<init>":(Ljava/lang/String;)V
     144: astore        9
     146: aload_0
     147: getfield      #1                  // Field this$0:Lorg/jboss/sasl/plain/PlainSaslServer;
     150: iconst_2
     151: anewarray     #21                 // class javax/security/auth/callback/Callback
     154: dup
     155: iconst_0
     156: aload         8
     158: aastore
     159: dup
     160: iconst_1
     161: aload         9
     163: aastore
     164: invokestatic  #22                 // Method org/jboss/sasl/plain/PlainSaslServer.access$000:(Lorg/jboss/sasl/plain/PlainSaslServer;[Ljavax/security/auth/callback/Callback;)V
     167: aload         9
     169: invokevirtual #23                 // Method org/jboss/sasl/callback/VerifyPasswordCallback.isVerified:()Z
     172: ifne          185
     175: new           #5                  // class javax/security/sasl/SaslException
     178: dup
     179: ldc           #24                 // String PLAIN password not verified by CallbackHandler
     181: invokespecial #7                  // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     184: athrow
     185: new           #25                 // class javax/security/sasl/AuthorizeCallback
     188: dup
     189: aload         5
     191: aload         6
     193: invokespecial #26                 // Method javax/security/sasl/AuthorizeCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     196: astore        10
     198: aload_0
     199: getfield      #1                  // Field this$0:Lorg/jboss/sasl/plain/PlainSaslServer;
     202: iconst_1
     203: anewarray     #21                 // class javax/security/auth/callback/Callback
     206: dup
     207: iconst_0
     208: aload         10
     210: aastore
     211: invokestatic  #27                 // Method org/jboss/sasl/plain/PlainSaslServer.access$100:(Lorg/jboss/sasl/plain/PlainSaslServer;[Ljavax/security/auth/callback/Callback;)V
     214: aload         10
     216: invokevirtual #28                 // Method javax/security/sasl/AuthorizeCallback.isAuthorized:()Z
     219: iconst_1
     220: if_icmpne     238
     223: aload_0
     224: getfield      #1                  // Field this$0:Lorg/jboss/sasl/plain/PlainSaslServer;
     227: aload         10
     229: invokevirtual #29                 // Method javax/security/sasl/AuthorizeCallback.getAuthorizedID:()Ljava/lang/String;
     232: putfield      #30                 // Field org/jboss/sasl/plain/PlainSaslServer.authorizedId:Ljava/lang/String;
     235: goto          276
     238: new           #5                  // class javax/security/sasl/SaslException
     241: dup
     242: new           #9                  // class java/lang/StringBuilder
     245: dup
     246: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     249: ldc           #31                 // String PLAIN:
     251: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     254: aload         5
     256: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     259: ldc           #32                 // String  is not authorized to act as
     261: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     264: aload         6
     266: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     269: invokevirtual #15                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     272: invokespecial #7                  // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     275: athrow
     276: aload_1
     277: invokeinterface #33,  1           // InterfaceMethod org/jboss/sasl/util/SaslStateContext.negotiationComplete:()V
     282: aconst_null
     283: areturn

  private java.lang.String[] split(byte[]) throws javax.security.sasl.SaslException;
    Code:
       0: aconst_null
       1: astore_2
       2: iconst_0
       3: istore        5
       5: aload_0
       6: aload_1
       7: iload         5
       9: iconst_1
      10: invokespecial #34                 // Method nextNul:([BIZ)I
      13: istore        6
      15: iload         6
      17: ifle          60
      20: aload_0
      21: iload         6
      23: aload_1
      24: arraylength
      25: iload         5
      27: invokespecial #35                 // Method length:(III)I
      30: istore        7
      32: new           #36                 // class java/lang/String
      35: dup
      36: aload_1
      37: iload         5
      39: iload         7
      41: getstatic     #37                 // Field org/jboss/sasl/util/Charsets.UTF_8:Ljava/nio/charset/Charset;
      44: invokespecial #38                 // Method java/lang/String."<init>":([BIILjava/nio/charset/Charset;)V
      47: astore_2
      48: iload         5
      50: iload         7
      52: iconst_1
      53: iadd
      54: iadd
      55: istore        5
      57: goto          63
      60: iinc          5, 1
      63: aload_0
      64: aload_1
      65: iload         5
      67: iconst_1
      68: invokespecial #34                 // Method nextNul:([BIZ)I
      71: istore        6
      73: aload_0
      74: iload         6
      76: aload_1
      77: arraylength
      78: iload         5
      80: invokespecial #35                 // Method length:(III)I
      83: istore        7
      85: new           #36                 // class java/lang/String
      88: dup
      89: aload_1
      90: iload         5
      92: iload         7
      94: getstatic     #37                 // Field org/jboss/sasl/util/Charsets.UTF_8:Ljava/nio/charset/Charset;
      97: invokespecial #38                 // Method java/lang/String."<init>":([BIILjava/nio/charset/Charset;)V
     100: astore_3
     101: iload         5
     103: iload         7
     105: iconst_1
     106: iadd
     107: iadd
     108: istore        5
     110: aload_0
     111: aload_1
     112: iload         5
     114: iconst_0
     115: invokespecial #34                 // Method nextNul:([BIZ)I
     118: istore        6
     120: iload         6
     122: iconst_m1
     123: if_icmple     136
     126: new           #5                  // class javax/security/sasl/SaslException
     129: dup
     130: ldc           #39                 // String PLAIN: Invalid message format. (Too many delimiters)
     132: invokespecial #7                  // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     135: athrow
     136: aload_0
     137: iload         6
     139: aload_1
     140: arraylength
     141: iload         5
     143: invokespecial #35                 // Method length:(III)I
     146: istore        7
     148: new           #36                 // class java/lang/String
     151: dup
     152: aload_1
     153: iload         5
     155: iload         7
     157: getstatic     #37                 // Field org/jboss/sasl/util/Charsets.UTF_8:Ljava/nio/charset/Charset;
     160: invokespecial #38                 // Method java/lang/String."<init>":([BIILjava/nio/charset/Charset;)V
     163: astore        4
     165: iload         5
     167: iload         7
     169: iconst_1
     170: iadd
     171: iadd
     172: istore        5
     174: aload_2
     175: ifnonnull     192
     178: iconst_2
     179: anewarray     #36                 // class java/lang/String
     182: dup
     183: iconst_0
     184: aload_3
     185: aastore
     186: dup
     187: iconst_1
     188: aload         4
     190: aastore
     191: areturn
     192: iconst_3
     193: anewarray     #36                 // class java/lang/String
     196: dup
     197: iconst_0
     198: aload_2
     199: aastore
     200: dup
     201: iconst_1
     202: aload_3
     203: aastore
     204: dup
     205: iconst_2
     206: aload         4
     208: aastore
     209: areturn

  private int nextNul(byte[], int, boolean) throws javax.security.sasl.SaslException;
    Code:
       0: iconst_m1
       1: istore        4
       3: iload_2
       4: istore        5
       6: iload         5
       8: aload_1
       9: arraylength
      10: if_icmpge     35
      13: iload         4
      15: ifge          35
      18: aload_1
      19: iload         5
      21: baload
      22: ifne          29
      25: iload         5
      27: istore        4
      29: iinc          5, 1
      32: goto          6
      35: iload_3
      36: ifeq          54
      39: iload         4
      41: ifge          54
      44: new           #5                  // class javax/security/sasl/SaslException
      47: dup
      48: ldc           #40                 // String PLAIN: Invalid message format. (Missing delimiter)
      50: invokespecial #7                  // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      53: athrow
      54: iload         4
      56: ireturn

  private int length(int, int, int);
    Code:
       0: iload_1
       1: ifge          10
       4: iload_2
       5: iload_3
       6: isub
       7: goto          13
      10: iload_1
      11: iload_3
      12: isub
      13: ireturn
}
