Compiled from "DigestMD5Client.java"
final class org.jboss.sasl.digest.DigestMD5Client extends org.jboss.sasl.digest.DigestMD5Base implements javax.security.sasl.SaslClient {
  private static final java.lang.String MY_CLASS_NAME;

  private static final java.lang.String CIPHER_PROPERTY;

  private static final java.lang.String[] DIRECTIVE_KEY;

  private static final int REALM;

  private static final int QOP;

  private static final int ALGORITHM;

  private static final int NONCE;

  private static final int MAXBUF;

  private static final int CHARSET;

  private static final int CIPHER;

  private static final int RESPONSE_AUTH;

  private static final int STALE;

  private static final org.jboss.logging.Logger log;

  private int nonceCount;

  private java.lang.String specifiedCipher;

  private byte[] cnonce;

  private java.lang.String username;

  private char[] passwd;

  private byte[] preDigested;

  private byte[] authzidBytes;

  private boolean preDigestedPasswords;

  private final java.lang.String digestUri;

  org.jboss.sasl.digest.DigestMD5Client(java.lang.String, java.lang.String, java.lang.String, java.util.Map, javax.security.auth.callback.CallbackHandler) throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: aload         4
       3: getstatic     #1                  // Field MY_CLASS_NAME:Ljava/lang/String;
       6: iconst_2
       7: aload         5
       9: invokespecial #2                  // Method org/jboss/sasl/digest/DigestMD5Base."<init>":(Ljava/util/Map;Ljava/lang/String;ILjavax/security/auth/callback/CallbackHandler;)V
      12: aload_0
      13: new           #3                  // class java/lang/StringBuilder
      16: dup
      17: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
      20: aload_2
      21: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      24: ldc           #6                  // String /
      26: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      29: aload_3
      30: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      33: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      36: putfield      #8                  // Field digestUri:Ljava/lang/String;
      39: aload_1
      40: ifnull        75
      43: aload_0
      44: aload_1
      45: putfield      #9                  // Field authzid:Ljava/lang/String;
      48: aload_0
      49: aload_1
      50: ldc           #10                 // String UTF8
      52: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      55: putfield      #12                 // Field authzidBytes:[B
      58: goto          75
      61: astore        6
      63: new           #14                 // class javax/security/sasl/SaslException
      66: dup
      67: ldc           #15                 // String DIGEST-MD5: Error encoding authzid value into UTF-8
      69: aload         6
      71: invokespecial #16                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      74: athrow
      75: aload_0
      76: iconst_0
      77: putfield      #17                 // Field preDigestedPasswords:Z
      80: aload         4
      82: ifnull        159
      85: aload_0
      86: aload         4
      88: ldc           #18                 // String com.sun.security.sasl.digest.cipher
      90: invokeinterface #19,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      95: checkcast     #20                 // class java/lang/String
      98: putfield      #21                 // Field specifiedCipher:Ljava/lang/String;
     101: getstatic     #22                 // Field log:Lorg/jboss/logging/Logger;
     104: ldc           #23                 // String DIGEST60:Explicitly specified cipher: %s
     106: aload_0
     107: getfield      #21                 // Field specifiedCipher:Ljava/lang/String;
     110: invokevirtual #24                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     113: aload         4
     115: ldc           #25                 // String org.jboss.sasl.digest.pre_digested
     117: invokeinterface #26,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     122: ifeq          159
     125: aload_0
     126: aload         4
     128: ldc           #25                 // String org.jboss.sasl.digest.pre_digested
     130: invokeinterface #19,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     135: invokestatic  #27                 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;
     138: invokestatic  #28                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
     141: putfield      #17                 // Field preDigestedPasswords:Z
     144: getstatic     #22                 // Field log:Lorg/jboss/logging/Logger;
     147: ldc           #29                 // String Server using pre-digested hashes (%B)
     149: aload_0
     150: getfield      #17                 // Field preDigestedPasswords:Z
     153: invokestatic  #30                 // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
     156: invokevirtual #24                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     159: return
    Exception table:
       from    to  target type
          48    58    61   Class java/io/UnsupportedEncodingException

  public boolean hasInitialResponse();
    Code:
       0: iconst_0
       1: ireturn

  public byte[] evaluateChallenge(byte[]) throws javax.security.sasl.SaslException;
    Code:
       0: aload_1
       1: arraylength
       2: sipush        2048
       5: if_icmple     47
       8: new           #14                 // class javax/security/sasl/SaslException
      11: dup
      12: new           #3                  // class java/lang/StringBuilder
      15: dup
      16: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
      19: ldc           #31                 // String DIGEST-MD5: Invalid digest-challenge length. Got:
      21: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      24: aload_1
      25: arraylength
      26: invokevirtual #32                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      29: ldc           #33                 // String  Expected <
      31: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      34: sipush        2048
      37: invokevirtual #32                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      40: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      43: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      46: athrow
      47: aload_0
      48: getfield      #35                 // Field step:I
      51: lookupswitch  { // 2
                     2: 76
                     3: 167
               default: 274
          }
      76: new           #36                 // class java/util/ArrayList
      79: dup
      80: iconst_3
      81: invokespecial #37                 // Method java/util/ArrayList."<init>":(I)V
      84: astore_3
      85: aload_1
      86: getstatic     #38                 // Field DIRECTIVE_KEY:[Ljava/lang/String;
      89: aload_3
      90: iconst_0
      91: invokestatic  #39                 // Method parseDirectives:([B[Ljava/lang/String;Ljava/util/List;I)[[B
      94: astore_2
      95: aload_0
      96: aload_2
      97: aload_3
      98: invokespecial #40                 // Method processChallenge:([[BLjava/util/List;)V
     101: aload_0
     102: aload_2
     103: iconst_1
     104: aaload
     105: aload_2
     106: bipush        6
     108: aaload
     109: invokespecial #41                 // Method checkQopSupport:([B[B)V
     112: aload_0
     113: dup
     114: getfield      #35                 // Field step:I
     117: iconst_1
     118: iadd
     119: putfield      #35                 // Field step:I
     122: aload_0
     123: aload_2
     124: iconst_5
     125: aaload
     126: invokespecial #42                 // Method generateClientResponse:([B)[B
     129: areturn
     130: astore        4
     132: aload_0
     133: iconst_0
     134: putfield      #35                 // Field step:I
     137: aload_0
     138: invokespecial #43                 // Method clearPassword:()V
     141: aload         4
     143: athrow
     144: astore        4
     146: aload_0
     147: iconst_0
     148: putfield      #35                 // Field step:I
     151: aload_0
     152: invokespecial #43                 // Method clearPassword:()V
     155: new           #14                 // class javax/security/sasl/SaslException
     158: dup
     159: ldc           #45                 // String DIGEST-MD5: Error generating digest response-value
     161: aload         4
     163: invokespecial #16                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     166: athrow
     167: aload_1
     168: getstatic     #38                 // Field DIRECTIVE_KEY:[Ljava/lang/String;
     171: aconst_null
     172: iconst_0
     173: invokestatic  #39                 // Method parseDirectives:([B[Ljava/lang/String;Ljava/util/List;I)[[B
     176: astore_2
     177: aload_0
     178: aload_2
     179: bipush        7
     181: aaload
     182: invokespecial #46                 // Method validateResponseValue:([B)V
     185: aload_0
     186: getfield      #47                 // Field integrity:Z
     189: ifeq          215
     192: aload_0
     193: getfield      #48                 // Field privacy:Z
     196: ifeq          215
     199: aload_0
     200: new           #49                 // class org/jboss/sasl/digest/DigestMD5Base$DigestPrivacy
     203: dup
     204: aload_0
     205: iconst_1
     206: invokespecial #50                 // Method org/jboss/sasl/digest/DigestMD5Base$DigestPrivacy."<init>":(Lorg/jboss/sasl/digest/DigestMD5Base;Z)V
     209: putfield      #51                 // Field secCtx:Lorg/jboss/sasl/digest/SecurityCtx;
     212: goto          235
     215: aload_0
     216: getfield      #47                 // Field integrity:Z
     219: ifeq          235
     222: aload_0
     223: new           #52                 // class org/jboss/sasl/digest/DigestMD5Base$DigestIntegrity
     226: dup
     227: aload_0
     228: iconst_1
     229: invokespecial #53                 // Method org/jboss/sasl/digest/DigestMD5Base$DigestIntegrity."<init>":(Lorg/jboss/sasl/digest/DigestMD5Base;Z)V
     232: putfield      #51                 // Field secCtx:Lorg/jboss/sasl/digest/SecurityCtx;
     235: aconst_null
     236: astore        4
     238: aload_0
     239: invokespecial #43                 // Method clearPassword:()V
     242: aload_0
     243: iconst_0
     244: putfield      #35                 // Field step:I
     247: aload_0
     248: iconst_1
     249: putfield      #54                 // Field completed:Z
     252: aload         4
     254: areturn
     255: astore        5
     257: aload_0
     258: invokespecial #43                 // Method clearPassword:()V
     261: aload_0
     262: iconst_0
     263: putfield      #35                 // Field step:I
     266: aload_0
     267: iconst_1
     268: putfield      #54                 // Field completed:Z
     271: aload         5
     273: athrow
     274: new           #14                 // class javax/security/sasl/SaslException
     277: dup
     278: ldc           #55                 // String DIGEST-MD5: Client at illegal state
     280: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     283: athrow
    Exception table:
       from    to  target type
          95   129   130   Class javax/security/sasl/SaslException
          95   129   144   Class java/io/IOException
         167   238   255   any
         255   257   255   any

  private void processChallenge(byte[][], java.util.List<byte[]>) throws javax.security.sasl.SaslException, java.io.UnsupportedEncodingException;
    Code:
       0: aload_1
       1: iconst_5
       2: aaload
       3: ifnull        75
       6: ldc           #56                 // String utf-8
       8: new           #20                 // class java/lang/String
      11: dup
      12: aload_1
      13: iconst_5
      14: aaload
      15: aload_0
      16: getfield      #57                 // Field encoding:Ljava/lang/String;
      19: invokespecial #58                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
      22: invokevirtual #59                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      25: ifne          64
      28: new           #14                 // class javax/security/sasl/SaslException
      31: dup
      32: new           #3                  // class java/lang/StringBuilder
      35: dup
      36: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
      39: ldc           #60                 // String DIGEST-MD5: digest-challenge format violation. Unrecognised charset value:
      41: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      44: new           #20                 // class java/lang/String
      47: dup
      48: aload_1
      49: iconst_5
      50: aaload
      51: invokespecial #61                 // Method java/lang/String."<init>":([B)V
      54: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      57: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      60: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      63: athrow
      64: aload_0
      65: ldc           #10                 // String UTF8
      67: putfield      #57                 // Field encoding:Ljava/lang/String;
      70: aload_0
      71: iconst_1
      72: putfield      #62                 // Field useUTF8:Z
      75: aload_1
      76: iconst_2
      77: aaload
      78: ifnonnull     91
      81: new           #14                 // class javax/security/sasl/SaslException
      84: dup
      85: ldc           #63                 // String DIGEST-MD5: Digest-challenge format violation: algorithm directive missing
      87: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      90: athrow
      91: ldc           #64                 // String md5-sess
      93: new           #20                 // class java/lang/String
      96: dup
      97: aload_1
      98: iconst_2
      99: aaload
     100: aload_0
     101: getfield      #57                 // Field encoding:Ljava/lang/String;
     104: invokespecial #58                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
     107: invokevirtual #59                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     110: ifne          142
     113: new           #14                 // class javax/security/sasl/SaslException
     116: dup
     117: new           #3                  // class java/lang/StringBuilder
     120: dup
     121: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     124: ldc           #65                 // String DIGEST-MD5: Digest-challenge format violation. Invalid value for \'algorithm\' directive:
     126: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     129: aload_1
     130: iconst_2
     131: aaload
     132: invokevirtual #66                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     135: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     138: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     141: athrow
     142: aload_1
     143: iconst_3
     144: aaload
     145: ifnonnull     158
     148: new           #14                 // class javax/security/sasl/SaslException
     151: dup
     152: ldc           #67                 // String DIGEST-MD5: Digest-challenge format violation: nonce directive missing
     154: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     157: athrow
     158: aload_0
     159: aload_1
     160: iconst_3
     161: aaload
     162: putfield      #68                 // Field nonce:[B
     165: aconst_null
     166: astore_3
     167: aload_1
     168: iconst_0
     169: aaload
     170: ifnull        260
     173: aload_2
     174: ifnull        187
     177: aload_2
     178: invokeinterface #69,  1           // InterfaceMethod java/util/List.size:()I
     183: iconst_1
     184: if_icmpgt     208
     187: aload_0
     188: new           #20                 // class java/lang/String
     191: dup
     192: aload_1
     193: iconst_0
     194: aaload
     195: aload_0
     196: getfield      #57                 // Field encoding:Ljava/lang/String;
     199: invokespecial #58                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
     202: putfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
     205: goto          260
     208: aload_2
     209: invokeinterface #69,  1           // InterfaceMethod java/util/List.size:()I
     214: anewarray     #20                 // class java/lang/String
     217: astore_3
     218: iconst_0
     219: istore        4
     221: iload         4
     223: aload_3
     224: arraylength
     225: if_icmpge     260
     228: aload_3
     229: iload         4
     231: new           #20                 // class java/lang/String
     234: dup
     235: aload_2
     236: iload         4
     238: invokeinterface #71,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     243: checkcast     #72                 // class "[B"
     246: aload_0
     247: getfield      #57                 // Field encoding:Ljava/lang/String;
     250: invokespecial #58                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
     253: aastore
     254: iinc          4, 1
     257: goto          221
     260: aload_0
     261: getfield      #9                  // Field authzid:Ljava/lang/String;
     264: ifnonnull     279
     267: new           #73                 // class javax/security/auth/callback/NameCallback
     270: dup
     271: ldc           #74                 // String DIGEST-MD5 authentication ID:
     273: invokespecial #75                 // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;)V
     276: goto          292
     279: new           #73                 // class javax/security/auth/callback/NameCallback
     282: dup
     283: ldc           #74                 // String DIGEST-MD5 authentication ID:
     285: aload_0
     286: getfield      #9                  // Field authzid:Ljava/lang/String;
     289: invokespecial #76                 // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     292: astore        4
     294: aload_0
     295: getfield      #17                 // Field preDigestedPasswords:Z
     298: ifeq          313
     301: new           #77                 // class org/jboss/sasl/callback/DigestHashCallback
     304: dup
     305: ldc           #78                 // String DIGEST-MD5 hash:
     307: invokespecial #79                 // Method org/jboss/sasl/callback/DigestHashCallback."<init>":(Ljava/lang/String;)V
     310: goto          323
     313: new           #80                 // class javax/security/auth/callback/PasswordCallback
     316: dup
     317: ldc           #81                 // String DIGEST-MD5 password:
     319: iconst_0
     320: invokespecial #82                 // Method javax/security/auth/callback/PasswordCallback."<init>":(Ljava/lang/String;Z)V
     323: astore        5
     325: aload_3
     326: ifnonnull     416
     329: aload_0
     330: getfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
     333: ifnonnull     348
     336: new           #83                 // class javax/security/sasl/RealmCallback
     339: dup
     340: ldc           #84                 // String DIGEST-MD5 realm:
     342: invokespecial #85                 // Method javax/security/sasl/RealmCallback."<init>":(Ljava/lang/String;)V
     345: goto          361
     348: new           #83                 // class javax/security/sasl/RealmCallback
     351: dup
     352: ldc           #84                 // String DIGEST-MD5 realm:
     354: aload_0
     355: getfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
     358: invokespecial #86                 // Method javax/security/sasl/RealmCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     361: astore        6
     363: aload_0
     364: getfield      #87                 // Field cbh:Ljavax/security/auth/callback/CallbackHandler;
     367: iconst_3
     368: anewarray     #88                 // class javax/security/auth/callback/Callback
     371: dup
     372: iconst_0
     373: aload         6
     375: aastore
     376: dup
     377: iconst_1
     378: aload         4
     380: aastore
     381: dup
     382: iconst_2
     383: aload         5
     385: aastore
     386: invokeinterface #89,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     391: aload_0
     392: aload         6
     394: invokevirtual #90                 // Method javax/security/sasl/RealmCallback.getText:()Ljava/lang/String;
     397: putfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
     400: aload_0
     401: getfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
     404: ifnonnull     413
     407: aload_0
     408: ldc           #91                 // String
     410: putfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
     413: goto          471
     416: new           #92                 // class javax/security/sasl/RealmChoiceCallback
     419: dup
     420: ldc           #84                 // String DIGEST-MD5 realm:
     422: aload_3
     423: iconst_0
     424: iconst_0
     425: invokespecial #93                 // Method javax/security/sasl/RealmChoiceCallback."<init>":(Ljava/lang/String;[Ljava/lang/String;IZ)V
     428: astore        6
     430: aload_0
     431: getfield      #87                 // Field cbh:Ljavax/security/auth/callback/CallbackHandler;
     434: iconst_3
     435: anewarray     #88                 // class javax/security/auth/callback/Callback
     438: dup
     439: iconst_0
     440: aload         6
     442: aastore
     443: dup
     444: iconst_1
     445: aload         4
     447: aastore
     448: dup
     449: iconst_2
     450: aload         5
     452: aastore
     453: invokeinterface #89,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     458: aload_0
     459: aload_3
     460: aload         6
     462: invokevirtual #94                 // Method javax/security/sasl/RealmChoiceCallback.getSelectedIndexes:()[I
     465: iconst_0
     466: iaload
     467: aaload
     468: putfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
     471: aload_0
     472: getfield      #17                 // Field preDigestedPasswords:Z
     475: ifeq          503
     478: aload         5
     480: checkcast     #77                 // class org/jboss/sasl/callback/DigestHashCallback
     483: astore        6
     485: aload_0
     486: aload         6
     488: invokevirtual #95                 // Method org/jboss/sasl/callback/DigestHashCallback.getHash:()[B
     491: putfield      #96                 // Field preDigested:[B
     494: aload         6
     496: aconst_null
     497: invokevirtual #97                 // Method org/jboss/sasl/callback/DigestHashCallback.setHash:([B)V
     500: goto          524
     503: aload         5
     505: checkcast     #80                 // class javax/security/auth/callback/PasswordCallback
     508: astore        6
     510: aload_0
     511: aload         6
     513: invokevirtual #98                 // Method javax/security/auth/callback/PasswordCallback.getPassword:()[C
     516: putfield      #99                 // Field passwd:[C
     519: aload         6
     521: invokevirtual #100                // Method javax/security/auth/callback/PasswordCallback.clearPassword:()V
     524: aload_0
     525: aload         4
     527: invokevirtual #101                // Method javax/security/auth/callback/NameCallback.getName:()Ljava/lang/String;
     530: putfield      #102                // Field username:Ljava/lang/String;
     533: goto          560
     536: astore_3
     537: new           #14                 // class javax/security/sasl/SaslException
     540: dup
     541: ldc           #104                // String DIGEST-MD5: Cannot perform callback to acquire realm, authentication ID or password
     543: aload_3
     544: invokespecial #16                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     547: athrow
     548: astore_3
     549: new           #14                 // class javax/security/sasl/SaslException
     552: dup
     553: ldc           #105                // String DIGEST-MD5: Error acquiring realm, authentication ID or password
     555: aload_3
     556: invokespecial #16                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     559: athrow
     560: aload_0
     561: getfield      #102                // Field username:Ljava/lang/String;
     564: ifnull        581
     567: aload_0
     568: getfield      #99                 // Field passwd:[C
     571: ifnonnull     591
     574: aload_0
     575: getfield      #96                 // Field preDigested:[B
     578: ifnonnull     591
     581: new           #14                 // class javax/security/sasl/SaslException
     584: dup
     585: ldc           #106                // String DIGEST-MD5: authentication ID and password must be specified
     587: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     590: athrow
     591: aload_1
     592: iconst_4
     593: aaload
     594: ifnonnull     602
     597: ldc           #107                // int 65536
     599: goto          619
     602: new           #20                 // class java/lang/String
     605: dup
     606: aload_1
     607: iconst_4
     608: aaload
     609: aload_0
     610: getfield      #57                 // Field encoding:Ljava/lang/String;
     613: invokespecial #58                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
     616: invokestatic  #108                // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
     619: istore_3
     620: aload_0
     621: aload_0
     622: getfield      #109                // Field sendMaxBufSize:I
     625: ifne          632
     628: iload_3
     629: goto          640
     632: aload_0
     633: getfield      #109                // Field sendMaxBufSize:I
     636: iload_3
     637: invokestatic  #110                // Method java/lang/Math.min:(II)I
     640: putfield      #109                // Field sendMaxBufSize:I
     643: return
    Exception table:
       from    to  target type
         165   533   536   Class javax/security/auth/callback/UnsupportedCallbackException
         165   533   548   Class java/io/IOException

  private void checkQopSupport(byte[], byte[]) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnonnull     10
       4: ldc           #111                // String auth
       6: astore_3
       7: goto          23
      10: new           #20                 // class java/lang/String
      13: dup
      14: aload_1
      15: aload_0
      16: getfield      #57                 // Field encoding:Ljava/lang/String;
      19: invokespecial #58                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
      22: astore_3
      23: iconst_3
      24: anewarray     #20                 // class java/lang/String
      27: astore        4
      29: aload_3
      30: aload         4
      32: iconst_1
      33: invokestatic  #112                // Method parseQop:(Ljava/lang/String;[Ljava/lang/String;Z)[B
      36: astore        5
      38: aload         5
      40: invokestatic  #113                // Method combineMasks:([B)B
      43: istore        6
      45: iload         6
      47: aload_0
      48: getfield      #114                // Field qop:[B
      51: invokestatic  #115                // Method findPreferredMask:(B[B)B
      54: tableswitch   { // 0 to 4
                     0: 88
                     1: 98
                     2: 107
                     3: 164
                     4: 132
               default: 164
          }
      88: new           #14                 // class javax/security/sasl/SaslException
      91: dup
      92: ldc           #116                // String DIGEST-MD5: No common protection layer between client and server
      94: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      97: athrow
      98: aload_0
      99: ldc           #111                // String auth
     101: putfield      #117                // Field negotiatedQop:Ljava/lang/String;
     104: goto          164
     107: aload_0
     108: ldc           #118                // String auth-int
     110: putfield      #117                // Field negotiatedQop:Ljava/lang/String;
     113: aload_0
     114: iconst_1
     115: putfield      #47                 // Field integrity:Z
     118: aload_0
     119: aload_0
     120: getfield      #109                // Field sendMaxBufSize:I
     123: bipush        16
     125: isub
     126: putfield      #119                // Field rawSendSize:I
     129: goto          164
     132: aload_0
     133: ldc           #120                // String auth-conf
     135: putfield      #117                // Field negotiatedQop:Ljava/lang/String;
     138: aload_0
     139: aload_0
     140: iconst_1
     141: dup_x1
     142: putfield      #47                 // Field integrity:Z
     145: putfield      #48                 // Field privacy:Z
     148: aload_0
     149: aload_0
     150: getfield      #109                // Field sendMaxBufSize:I
     153: bipush        26
     155: isub
     156: putfield      #119                // Field rawSendSize:I
     159: aload_0
     160: aload_2
     161: invokespecial #121                // Method checkStrengthSupport:([B)V
     164: getstatic     #22                 // Field log:Lorg/jboss/logging/Logger;
     167: ldc           #122                // String DIGEST61:Raw send size: %d
     169: aload_0
     170: getfield      #119                // Field rawSendSize:I
     173: invokestatic  #123                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     176: invokevirtual #24                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     179: return

  private void checkStrengthSupport(byte[]) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #14                 // class javax/security/sasl/SaslException
       7: dup
       8: ldc           #124                // String DIGEST-MD5: server did not specify cipher to use for \'auth-conf\'
      10: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      13: athrow
      14: new           #20                 // class java/lang/String
      17: dup
      18: aload_1
      19: aload_0
      20: getfield      #57                 // Field encoding:Ljava/lang/String;
      23: invokespecial #58                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
      26: astore_2
      27: new           #125                // class java/util/StringTokenizer
      30: dup
      31: aload_2
      32: ldc           #126                // String , \t\n
      34: invokespecial #127                // Method java/util/StringTokenizer."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      37: astore_3
      38: aload_3
      39: invokevirtual #128                // Method java/util/StringTokenizer.countTokens:()I
      42: istore        4
      44: aconst_null
      45: astore        5
      47: iconst_5
      48: newarray       byte
      50: dup
      51: iconst_0
      52: iconst_0
      53: bastore
      54: dup
      55: iconst_1
      56: iconst_0
      57: bastore
      58: dup
      59: iconst_2
      60: iconst_0
      61: bastore
      62: dup
      63: iconst_3
      64: iconst_0
      65: bastore
      66: dup
      67: iconst_4
      68: iconst_0
      69: bastore
      70: astore        6
      72: aload         6
      74: arraylength
      75: anewarray     #20                 // class java/lang/String
      78: astore        7
      80: iconst_0
      81: istore        8
      83: iload         8
      85: iload         4
      87: if_icmpge     166
      90: aload_3
      91: invokevirtual #129                // Method java/util/StringTokenizer.nextToken:()Ljava/lang/String;
      94: astore        5
      96: iconst_0
      97: istore        9
      99: iload         9
     101: getstatic     #130                // Field CIPHER_TOKENS:[Ljava/lang/String;
     104: arraylength
     105: if_icmpge     160
     108: aload         5
     110: getstatic     #130                // Field CIPHER_TOKENS:[Ljava/lang/String;
     113: iload         9
     115: aaload
     116: invokevirtual #59                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     119: ifeq          154
     122: aload         6
     124: iload         9
     126: dup2
     127: baload
     128: getstatic     #131                // Field CIPHER_MASKS:[B
     131: iload         9
     133: baload
     134: ior
     135: i2b
     136: bastore
     137: aload         7
     139: iload         9
     141: aload         5
     143: aastore
     144: getstatic     #22                 // Field log:Lorg/jboss/logging/Logger;
     147: ldc           #132                // String DIGEST62:Server supports %s
     149: aload         5
     151: invokevirtual #24                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     154: iinc          9, 1
     157: goto          99
     160: iinc          8, 1
     163: goto          83
     166: invokestatic  #133                // Method getPlatformCiphers:()[B
     169: astore        8
     171: iconst_0
     172: istore        9
     174: iconst_0
     175: istore        10
     177: iload         10
     179: aload         6
     181: arraylength
     182: if_icmpge     216
     185: aload         6
     187: iload         10
     189: dup2
     190: baload
     191: aload         8
     193: iload         10
     195: baload
     196: iand
     197: i2b
     198: bastore
     199: iload         9
     201: aload         6
     203: iload         10
     205: baload
     206: ior
     207: i2b
     208: istore        9
     210: iinc          10, 1
     213: goto          177
     216: iload         9
     218: ifne          248
     221: new           #14                 // class javax/security/sasl/SaslException
     224: dup
     225: new           #3                  // class java/lang/StringBuilder
     228: dup
     229: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     232: ldc           #134                // String DIGEST-MD5: Client supports none of these cipher suites:
     234: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     237: aload_2
     238: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     241: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     244: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     247: athrow
     248: aload_0
     249: aload_0
     250: aload         6
     252: aload         7
     254: invokespecial #135                // Method findCipherAndStrength:([B[Ljava/lang/String;)Ljava/lang/String;
     257: putfield      #136                // Field negotiatedCipher:Ljava/lang/String;
     260: aload_0
     261: getfield      #136                // Field negotiatedCipher:Ljava/lang/String;
     264: ifnonnull     277
     267: new           #14                 // class javax/security/sasl/SaslException
     270: dup
     271: ldc           #137                // String DIGEST-MD5: Unable to negotiate a strength level for \'auth-conf\'
     273: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     276: athrow
     277: getstatic     #22                 // Field log:Lorg/jboss/logging/Logger;
     280: ldc           #138                // String DIGEST63:Cipher suite: %s
     282: aload_0
     283: getfield      #136                // Field negotiatedCipher:Ljava/lang/String;
     286: invokevirtual #24                 // Method org/jboss/logging/Logger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
     289: return

  private java.lang.String findCipherAndStrength(byte[], java.lang.String[]);
    Code:
       0: iconst_0
       1: istore        4
       3: iload         4
       5: aload_0
       6: getfield      #139                // Field strength:[B
       9: arraylength
      10: if_icmpge     137
      13: aload_0
      14: getfield      #139                // Field strength:[B
      17: iload         4
      19: baload
      20: dup
      21: istore_3
      22: ifeq          131
      25: iconst_0
      26: istore        5
      28: iload         5
      30: aload_1
      31: arraylength
      32: if_icmpge     131
      35: iload_3
      36: aload_1
      37: iload         5
      39: baload
      40: if_icmpne     125
      43: aload_0
      44: getfield      #21                 // Field specifiedCipher:Ljava/lang/String;
      47: ifnull        64
      50: aload_0
      51: getfield      #21                 // Field specifiedCipher:Ljava/lang/String;
      54: aload_2
      55: iload         5
      57: aaload
      58: invokevirtual #59                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      61: ifeq          125
      64: iload_3
      65: tableswitch   { // 1 to 4
                     1: 114
                     2: 105
                     3: 120
                     4: 96
               default: 120
          }
      96: aload_0
      97: ldc           #140                // String high
      99: putfield      #141                // Field negotiatedStrength:Ljava/lang/String;
     102: goto          120
     105: aload_0
     106: ldc           #142                // String medium
     108: putfield      #141                // Field negotiatedStrength:Ljava/lang/String;
     111: goto          120
     114: aload_0
     115: ldc           #143                // String low
     117: putfield      #141                // Field negotiatedStrength:Ljava/lang/String;
     120: aload_2
     121: iload         5
     123: aaload
     124: areturn
     125: iinc          5, 1
     128: goto          28
     131: iinc          4, 1
     134: goto          3
     137: aconst_null
     138: areturn

  private byte[] generateClientResponse(byte[]) throws java.io.IOException;
    Code:
       0: new           #144                // class java/io/ByteArrayOutputStream
       3: dup
       4: invokespecial #145                // Method java/io/ByteArrayOutputStream."<init>":()V
       7: astore_2
       8: aload_0
       9: getfield      #62                 // Field useUTF8:Z
      12: ifeq          39
      15: aload_2
      16: ldc           #146                // String charset=
      18: aload_0
      19: getfield      #57                 // Field encoding:Ljava/lang/String;
      22: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      25: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
      28: aload_2
      29: aload_1
      30: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
      33: aload_2
      34: bipush        44
      36: invokevirtual #148                // Method java/io/ByteArrayOutputStream.write:(I)V
      39: aload_2
      40: new           #3                  // class java/lang/StringBuilder
      43: dup
      44: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
      47: ldc           #149                // String username=\"
      49: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      52: aload_0
      53: getfield      #102                // Field username:Ljava/lang/String;
      56: invokestatic  #150                // Method quotedStringValue:(Ljava/lang/String;)Ljava/lang/String;
      59: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      62: ldc           #151                // String \",
      64: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      67: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      70: aload_0
      71: getfield      #57                 // Field encoding:Ljava/lang/String;
      74: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      77: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
      80: aload_0
      81: getfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
      84: invokevirtual #152                // Method java/lang/String.length:()I
      87: ifle          131
      90: aload_2
      91: new           #3                  // class java/lang/StringBuilder
      94: dup
      95: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
      98: ldc           #153                // String realm=\"
     100: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     103: aload_0
     104: getfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
     107: invokestatic  #150                // Method quotedStringValue:(Ljava/lang/String;)Ljava/lang/String;
     110: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     113: ldc           #151                // String \",
     115: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     118: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     121: aload_0
     122: getfield      #57                 // Field encoding:Ljava/lang/String;
     125: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     128: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     131: aload_2
     132: ldc           #154                // String nonce=\"
     134: aload_0
     135: getfield      #57                 // Field encoding:Ljava/lang/String;
     138: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     141: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     144: aload_2
     145: aload_0
     146: getfield      #68                 // Field nonce:[B
     149: invokestatic  #155                // Method writeQuotedStringValue:(Ljava/io/ByteArrayOutputStream;[B)V
     152: aload_2
     153: bipush        34
     155: invokevirtual #148                // Method java/io/ByteArrayOutputStream.write:(I)V
     158: aload_2
     159: bipush        44
     161: invokevirtual #148                // Method java/io/ByteArrayOutputStream.write:(I)V
     164: aload_0
     165: aload_0
     166: getfield      #68                 // Field nonce:[B
     169: invokestatic  #156                // Method getNonceCount:([B)I
     172: putfield      #157                // Field nonceCount:I
     175: aload_2
     176: new           #3                  // class java/lang/StringBuilder
     179: dup
     180: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     183: ldc           #158                // String nc=
     185: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     188: aload_0
     189: getfield      #157                // Field nonceCount:I
     192: invokestatic  #159                // Method nonceCountToHex:(I)Ljava/lang/String;
     195: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     198: ldc           #160                // String ,
     200: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     203: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     206: aload_0
     207: getfield      #57                 // Field encoding:Ljava/lang/String;
     210: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     213: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     216: aload_0
     217: invokestatic  #161                // Method generateNonce:()[B
     220: putfield      #162                // Field cnonce:[B
     223: aload_2
     224: ldc           #163                // String cnonce=\"
     226: aload_0
     227: getfield      #57                 // Field encoding:Ljava/lang/String;
     230: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     233: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     236: aload_2
     237: aload_0
     238: getfield      #162                // Field cnonce:[B
     241: invokestatic  #155                // Method writeQuotedStringValue:(Ljava/io/ByteArrayOutputStream;[B)V
     244: aload_2
     245: ldc           #151                // String \",
     247: aload_0
     248: getfield      #57                 // Field encoding:Ljava/lang/String;
     251: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     254: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     257: aload_2
     258: new           #3                  // class java/lang/StringBuilder
     261: dup
     262: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     265: ldc           #164                // String digest-uri=\"
     267: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     270: aload_0
     271: getfield      #8                  // Field digestUri:Ljava/lang/String;
     274: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     277: ldc           #151                // String \",
     279: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     282: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     285: aload_0
     286: getfield      #57                 // Field encoding:Ljava/lang/String;
     289: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     292: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     295: aload_2
     296: ldc           #165                // String maxbuf=
     298: aload_0
     299: getfield      #57                 // Field encoding:Ljava/lang/String;
     302: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     305: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     308: aload_2
     309: aload_0
     310: getfield      #166                // Field recvMaxBufSize:I
     313: invokestatic  #167                // Method java/lang/String.valueOf:(I)Ljava/lang/String;
     316: aload_0
     317: getfield      #57                 // Field encoding:Ljava/lang/String;
     320: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     323: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     326: aload_2
     327: bipush        44
     329: invokevirtual #148                // Method java/io/ByteArrayOutputStream.write:(I)V
     332: aload_2
     333: ldc           #168                // String response=
     335: aload_0
     336: getfield      #57                 // Field encoding:Ljava/lang/String;
     339: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     342: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     345: aload_0
     346: getfield      #17                 // Field preDigestedPasswords:Z
     349: ifeq          393
     352: aload_2
     353: aload_0
     354: ldc           #169                // String AUTHENTICATE
     356: aload_0
     357: getfield      #8                  // Field digestUri:Ljava/lang/String;
     360: aload_0
     361: getfield      #117                // Field negotiatedQop:Ljava/lang/String;
     364: aload_0
     365: getfield      #96                 // Field preDigested:[B
     368: aload_0
     369: getfield      #68                 // Field nonce:[B
     372: aload_0
     373: getfield      #162                // Field cnonce:[B
     376: aload_0
     377: getfield      #157                // Field nonceCount:I
     380: aload_0
     381: getfield      #12                 // Field authzidBytes:[B
     384: invokevirtual #170                // Method generateResponseValue:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[B[B[BI[B)[B
     387: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     390: goto          439
     393: aload_2
     394: aload_0
     395: ldc           #169                // String AUTHENTICATE
     397: aload_0
     398: getfield      #8                  // Field digestUri:Ljava/lang/String;
     401: aload_0
     402: getfield      #117                // Field negotiatedQop:Ljava/lang/String;
     405: aload_0
     406: getfield      #102                // Field username:Ljava/lang/String;
     409: aload_0
     410: getfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
     413: aload_0
     414: getfield      #99                 // Field passwd:[C
     417: aload_0
     418: getfield      #68                 // Field nonce:[B
     421: aload_0
     422: getfield      #162                // Field cnonce:[B
     425: aload_0
     426: getfield      #157                // Field nonceCount:I
     429: aload_0
     430: getfield      #12                 // Field authzidBytes:[B
     433: invokevirtual #171                // Method generateResponseValue:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[C[B[BI[B)[B
     436: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     439: aload_2
     440: bipush        44
     442: invokevirtual #148                // Method java/io/ByteArrayOutputStream.write:(I)V
     445: goto          460
     448: astore_3
     449: new           #14                 // class javax/security/sasl/SaslException
     452: dup
     453: ldc           #173                // String DIGEST-MD5: Error generating response value
     455: aload_3
     456: invokespecial #16                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     459: athrow
     460: aload_2
     461: new           #3                  // class java/lang/StringBuilder
     464: dup
     465: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     468: ldc           #174                // String qop=
     470: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     473: aload_0
     474: getfield      #117                // Field negotiatedQop:Ljava/lang/String;
     477: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     480: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     483: aload_0
     484: getfield      #57                 // Field encoding:Ljava/lang/String;
     487: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     490: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     493: aload_0
     494: getfield      #136                // Field negotiatedCipher:Ljava/lang/String;
     497: ifnull        538
     500: aload_2
     501: new           #3                  // class java/lang/StringBuilder
     504: dup
     505: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     508: ldc           #175                // String ,cipher=\"
     510: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     513: aload_0
     514: getfield      #136                // Field negotiatedCipher:Ljava/lang/String;
     517: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     520: ldc           #176                // String \"
     522: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     525: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     528: aload_0
     529: getfield      #57                 // Field encoding:Ljava/lang/String;
     532: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     535: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     538: aload_0
     539: getfield      #12                 // Field authzidBytes:[B
     542: ifnull        579
     545: aload_2
     546: ldc           #177                // String ,authzid=\"
     548: aload_0
     549: getfield      #57                 // Field encoding:Ljava/lang/String;
     552: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     555: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     558: aload_2
     559: aload_0
     560: getfield      #12                 // Field authzidBytes:[B
     563: invokestatic  #155                // Method writeQuotedStringValue:(Ljava/io/ByteArrayOutputStream;[B)V
     566: aload_2
     567: ldc           #176                // String \"
     569: aload_0
     570: getfield      #57                 // Field encoding:Ljava/lang/String;
     573: invokevirtual #11                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     576: invokevirtual #147                // Method java/io/ByteArrayOutputStream.write:([B)V
     579: aload_2
     580: invokevirtual #178                // Method java/io/ByteArrayOutputStream.size:()I
     583: sipush        4096
     586: if_icmple     619
     589: new           #14                 // class javax/security/sasl/SaslException
     592: dup
     593: new           #3                  // class java/lang/StringBuilder
     596: dup
     597: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     600: ldc           #179                // String DIGEST-MD5: digest-response size too large. Length:
     602: invokevirtual #5                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     605: aload_2
     606: invokevirtual #178                // Method java/io/ByteArrayOutputStream.size:()I
     609: invokevirtual #32                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     612: invokevirtual #7                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     615: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     618: athrow
     619: aload_2
     620: invokevirtual #180                // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     623: areturn
    Exception table:
       from    to  target type
         332   445   448   Class java/lang/Exception

  private void validateResponseValue(byte[]) throws javax.security.sasl.SaslException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #14                 // class javax/security/sasl/SaslException
       7: dup
       8: ldc           #181                // String DIGEST-MD5: Authenication failed. Expecting \'rspauth\' authentication success message
      10: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      13: athrow
      14: aload_0
      15: getfield      #17                 // Field preDigestedPasswords:Z
      18: ifeq          59
      21: aload_0
      22: ldc           #91                 // String
      24: aload_0
      25: getfield      #8                  // Field digestUri:Ljava/lang/String;
      28: aload_0
      29: getfield      #117                // Field negotiatedQop:Ljava/lang/String;
      32: aload_0
      33: getfield      #96                 // Field preDigested:[B
      36: aload_0
      37: getfield      #68                 // Field nonce:[B
      40: aload_0
      41: getfield      #162                // Field cnonce:[B
      44: aload_0
      45: getfield      #157                // Field nonceCount:I
      48: aload_0
      49: getfield      #12                 // Field authzidBytes:[B
      52: invokevirtual #170                // Method generateResponseValue:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[B[B[BI[B)[B
      55: astore_2
      56: goto          102
      59: aload_0
      60: ldc           #91                 // String
      62: aload_0
      63: getfield      #8                  // Field digestUri:Ljava/lang/String;
      66: aload_0
      67: getfield      #117                // Field negotiatedQop:Ljava/lang/String;
      70: aload_0
      71: getfield      #102                // Field username:Ljava/lang/String;
      74: aload_0
      75: getfield      #70                 // Field negotiatedRealm:Ljava/lang/String;
      78: aload_0
      79: getfield      #99                 // Field passwd:[C
      82: aload_0
      83: getfield      #68                 // Field nonce:[B
      86: aload_0
      87: getfield      #162                // Field cnonce:[B
      90: aload_0
      91: getfield      #157                // Field nonceCount:I
      94: aload_0
      95: getfield      #12                 // Field authzidBytes:[B
      98: invokevirtual #171                // Method generateResponseValue:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[C[B[BI[B)[B
     101: astore_2
     102: aload_2
     103: aload_1
     104: invokestatic  #182                // Method java/util/Arrays.equals:([B[B)Z
     107: ifne          120
     110: new           #14                 // class javax/security/sasl/SaslException
     113: dup
     114: ldc           #183                // String Server\'s rspauth value does not match what client expects
     116: invokespecial #34                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     119: athrow
     120: goto          147
     123: astore_2
     124: new           #14                 // class javax/security/sasl/SaslException
     127: dup
     128: ldc           #185                // String Problem generating response value for verification
     130: aload_2
     131: invokespecial #16                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     134: athrow
     135: astore_2
     136: new           #14                 // class javax/security/sasl/SaslException
     139: dup
     140: ldc           #185                // String Problem generating response value for verification
     142: aload_2
     143: invokespecial #16                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     146: athrow
     147: return
    Exception table:
       from    to  target type
          14   120   123   Class java/security/NoSuchAlgorithmException
          14   120   135   Class java/io/IOException

  private static int getNonceCount(byte[]);
    Code:
       0: iconst_1
       1: ireturn

  private void clearPassword();
    Code:
       0: aload_0
       1: getfield      #99                 // Field passwd:[C
       4: ifnull        36
       7: iconst_0
       8: istore_1
       9: iload_1
      10: aload_0
      11: getfield      #99                 // Field passwd:[C
      14: arraylength
      15: if_icmpge     31
      18: aload_0
      19: getfield      #99                 // Field passwd:[C
      22: iload_1
      23: iconst_0
      24: castore
      25: iinc          1, 1
      28: goto          9
      31: aload_0
      32: aconst_null
      33: putfield      #99                 // Field passwd:[C
      36: aload_0
      37: getfield      #96                 // Field preDigested:[B
      40: ifnull        72
      43: iconst_0
      44: istore_1
      45: iload_1
      46: aload_0
      47: getfield      #96                 // Field preDigested:[B
      50: arraylength
      51: if_icmpge     67
      54: aload_0
      55: getfield      #96                 // Field preDigested:[B
      58: iload_1
      59: iconst_0
      60: bastore
      61: iinc          1, 1
      64: goto          45
      67: aload_0
      68: aconst_null
      69: putfield      #96                 // Field preDigested:[B
      72: return

  static {};
    Code:
       0: ldc_w         #186                // class org/jboss/sasl/digest/DigestMD5Client
       3: invokevirtual #187                // Method java/lang/Class.getName:()Ljava/lang/String;
       6: putstatic     #1                  // Field MY_CLASS_NAME:Ljava/lang/String;
       9: bipush        9
      11: anewarray     #20                 // class java/lang/String
      14: dup
      15: iconst_0
      16: ldc           #188                // String realm
      18: aastore
      19: dup
      20: iconst_1
      21: ldc           #189                // String qop
      23: aastore
      24: dup
      25: iconst_2
      26: ldc           #190                // String algorithm
      28: aastore
      29: dup
      30: iconst_3
      31: ldc           #191                // String nonce
      33: aastore
      34: dup
      35: iconst_4
      36: ldc           #192                // String maxbuf
      38: aastore
      39: dup
      40: iconst_5
      41: ldc           #193                // String charset
      43: aastore
      44: dup
      45: bipush        6
      47: ldc           #194                // String cipher
      49: aastore
      50: dup
      51: bipush        7
      53: ldc           #195                // String rspauth
      55: aastore
      56: dup
      57: bipush        8
      59: ldc           #196                // String stale
      61: aastore
      62: putstatic     #38                 // Field DIRECTIVE_KEY:[Ljava/lang/String;
      65: ldc           #197                // String org.jboss.sasl.digest.client
      67: invokestatic  #198                // Method org/jboss/logging/Logger.getLogger:(Ljava/lang/String;)Lorg/jboss/logging/Logger;
      70: putstatic     #22                 // Field log:Lorg/jboss/logging/Logger;
      73: return
}
