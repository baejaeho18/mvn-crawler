Compiled from "DigestMD5Base.java"
class org.jboss.sasl.digest.DigestMD5Base$DigestIntegrity implements org.jboss.sasl.digest.SecurityCtx {
  private static final java.lang.String CLIENT_INT_MAGIC;

  private static final java.lang.String SVR_INT_MAGIC;

  protected byte[] myKi;

  protected byte[] peerKi;

  protected int mySeqNum;

  protected int peerSeqNum;

  protected final byte[] messageType;

  protected final byte[] sequenceNum;

  final org.jboss.sasl.digest.DigestMD5Base this$0;

  org.jboss.sasl.digest.DigestMD5Base$DigestIntegrity(org.jboss.sasl.digest.DigestMD5Base, boolean) throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #1                  // Field this$0:Lorg/jboss/sasl/digest/DigestMD5Base;
       5: aload_0
       6: invokespecial #2                  // Method java/lang/Object."<init>":()V
       9: aload_0
      10: iconst_0
      11: putfield      #3                  // Field mySeqNum:I
      14: aload_0
      15: iconst_0
      16: putfield      #4                  // Field peerSeqNum:I
      19: aload_0
      20: iconst_2
      21: newarray       byte
      23: putfield      #5                  // Field messageType:[B
      26: aload_0
      27: iconst_4
      28: newarray       byte
      30: putfield      #6                  // Field sequenceNum:[B
      33: aload_0
      34: iload_2
      35: invokespecial #7                  // Method generateIntegrityKeyPair:(Z)V
      38: goto          77
      41: astore_3
      42: new           #9                  // class javax/security/sasl/SaslException
      45: dup
      46: ldc           #10                 // String DIGEST-MD5: Error encoding strings into UTF-8
      48: aload_3
      49: invokespecial #11                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      52: athrow
      53: astore_3
      54: new           #9                  // class javax/security/sasl/SaslException
      57: dup
      58: ldc           #13                 // String DIGEST-MD5: Error accessing buffers required to create integrity key pairs
      60: aload_3
      61: invokespecial #11                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      64: athrow
      65: astore_3
      66: new           #9                  // class javax/security/sasl/SaslException
      69: dup
      70: ldc           #15                 // String DIGEST-MD5: Unsupported digest algorithm used to create integrity key pairs
      72: aload_3
      73: invokespecial #11                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      76: athrow
      77: iconst_1
      78: aload_0
      79: getfield      #5                  // Field messageType:[B
      82: iconst_0
      83: iconst_2
      84: invokestatic  #16                 // Method org/jboss/sasl/digest/AbstractSaslImpl.intToNetworkByteOrder:(I[BII)V
      87: return
    Exception table:
       from    to  target type
          33    38    41   Class java/io/UnsupportedEncodingException
          33    38    53   Class java/io/IOException
          33    38    65   Class java/security/NoSuchAlgorithmException

  private void generateIntegrityKeyPair(boolean) throws java.io.IOException, java.security.NoSuchAlgorithmException;
    Code:
       0: ldc           #17                 // String Digest session key to client-to-server signing key magic constant
       2: aload_0
       3: getfield      #1                  // Field this$0:Lorg/jboss/sasl/digest/DigestMD5Base;
       6: getfield      #18                 // Field org/jboss/sasl/digest/DigestMD5Base.encoding:Ljava/lang/String;
       9: invokevirtual #19                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      12: astore_2
      13: ldc           #20                 // String Digest session key to server-to-client signing key magic constant
      15: aload_0
      16: getfield      #1                  // Field this$0:Lorg/jboss/sasl/digest/DigestMD5Base;
      19: getfield      #18                 // Field org/jboss/sasl/digest/DigestMD5Base.encoding:Ljava/lang/String;
      22: invokevirtual #19                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      25: astore_3
      26: ldc           #21                 // String MD5
      28: invokestatic  #22                 // Method java/security/MessageDigest.getInstance:(Ljava/lang/String;)Ljava/security/MessageDigest;
      31: astore        4
      33: aload_0
      34: getfield      #1                  // Field this$0:Lorg/jboss/sasl/digest/DigestMD5Base;
      37: getfield      #23                 // Field org/jboss/sasl/digest/DigestMD5Base.H_A1:[B
      40: arraylength
      41: aload_2
      42: arraylength
      43: iadd
      44: newarray       byte
      46: astore        5
      48: aload_0
      49: getfield      #1                  // Field this$0:Lorg/jboss/sasl/digest/DigestMD5Base;
      52: getfield      #23                 // Field org/jboss/sasl/digest/DigestMD5Base.H_A1:[B
      55: iconst_0
      56: aload         5
      58: iconst_0
      59: aload_0
      60: getfield      #1                  // Field this$0:Lorg/jboss/sasl/digest/DigestMD5Base;
      63: getfield      #23                 // Field org/jboss/sasl/digest/DigestMD5Base.H_A1:[B
      66: arraylength
      67: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      70: aload_2
      71: iconst_0
      72: aload         5
      74: aload_0
      75: getfield      #1                  // Field this$0:Lorg/jboss/sasl/digest/DigestMD5Base;
      78: getfield      #23                 // Field org/jboss/sasl/digest/DigestMD5Base.H_A1:[B
      81: arraylength
      82: aload_2
      83: arraylength
      84: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      87: aload         4
      89: aload         5
      91: invokevirtual #25                 // Method java/security/MessageDigest.update:([B)V
      94: aload         4
      96: invokevirtual #26                 // Method java/security/MessageDigest.digest:()[B
      99: astore        6
     101: aload_3
     102: iconst_0
     103: aload         5
     105: aload_0
     106: getfield      #1                  // Field this$0:Lorg/jboss/sasl/digest/DigestMD5Base;
     109: getfield      #23                 // Field org/jboss/sasl/digest/DigestMD5Base.H_A1:[B
     112: arraylength
     113: aload_3
     114: arraylength
     115: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     118: aload         4
     120: aload         5
     122: invokevirtual #25                 // Method java/security/MessageDigest.update:([B)V
     125: aload         4
     127: invokevirtual #26                 // Method java/security/MessageDigest.digest:()[B
     130: astore        7
     132: iload_1
     133: ifeq          151
     136: aload_0
     137: aload         6
     139: putfield      #27                 // Field myKi:[B
     142: aload_0
     143: aload         7
     145: putfield      #28                 // Field peerKi:[B
     148: goto          163
     151: aload_0
     152: aload         7
     154: putfield      #27                 // Field myKi:[B
     157: aload_0
     158: aload         6
     160: putfield      #28                 // Field peerKi:[B
     163: return

  public byte[] wrap(byte[], int, int) throws javax.security.sasl.SaslException;
    Code:
       0: iload_3
       1: ifne          8
       4: getstatic     #29                 // Field org/jboss/sasl/digest/DigestMD5Base.EMPTY_BYTE_ARRAY:[B
       7: areturn
       8: iload_3
       9: bipush        10
      11: iadd
      12: iconst_2
      13: iadd
      14: iconst_4
      15: iadd
      16: newarray       byte
      18: astore        4
      20: aload_1
      21: iload_2
      22: aload         4
      24: iconst_0
      25: iload_3
      26: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      29: aload_0
      30: invokevirtual #30                 // Method incrementSeqNum:()V
      33: aload_0
      34: aload_0
      35: getfield      #27                 // Field myKi:[B
      38: aload_0
      39: getfield      #6                  // Field sequenceNum:[B
      42: aload_1
      43: iload_2
      44: iload_3
      45: invokevirtual #31                 // Method getHMAC:([B[B[BII)[B
      48: astore        5
      50: aload         5
      52: iconst_0
      53: aload         4
      55: iload_3
      56: bipush        10
      58: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      61: aload_0
      62: getfield      #5                  // Field messageType:[B
      65: iconst_0
      66: aload         4
      68: iload_3
      69: bipush        10
      71: iadd
      72: iconst_2
      73: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      76: aload_0
      77: getfield      #6                  // Field sequenceNum:[B
      80: iconst_0
      81: aload         4
      83: iload_3
      84: bipush        12
      86: iadd
      87: iconst_4
      88: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      91: aload         4
      93: areturn

  public byte[] unwrap(byte[], int, int) throws javax.security.sasl.SaslException;
    Code:
       0: iload_3
       1: ifne          8
       4: getstatic     #29                 // Field org/jboss/sasl/digest/DigestMD5Base.EMPTY_BYTE_ARRAY:[B
       7: areturn
       8: bipush        10
      10: newarray       byte
      12: astore        4
      14: iload_3
      15: bipush        16
      17: isub
      18: newarray       byte
      20: astore        5
      22: iconst_2
      23: newarray       byte
      25: astore        6
      27: iconst_4
      28: newarray       byte
      30: astore        7
      32: aload_1
      33: iload_2
      34: aload         5
      36: iconst_0
      37: aload         5
      39: arraylength
      40: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      43: aload_1
      44: iload_2
      45: aload         5
      47: arraylength
      48: iadd
      49: aload         4
      51: iconst_0
      52: bipush        10
      54: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      57: aload_1
      58: iload_2
      59: aload         5
      61: arraylength
      62: iadd
      63: bipush        10
      65: iadd
      66: aload         6
      68: iconst_0
      69: iconst_2
      70: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      73: aload_1
      74: iload_2
      75: aload         5
      77: arraylength
      78: iadd
      79: bipush        12
      81: iadd
      82: aload         7
      84: iconst_0
      85: iconst_4
      86: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      89: aload_0
      90: aload_0
      91: getfield      #28                 // Field peerKi:[B
      94: aload         7
      96: aload         5
      98: iconst_0
      99: aload         5
     101: arraylength
     102: invokevirtual #31                 // Method getHMAC:([B[B[BII)[B
     105: astore        8
     107: aload         4
     109: aload         8
     111: invokestatic  #32                 // Method java/util/Arrays.equals:([B[B)Z
     114: ifne          129
     117: invokestatic  #33                 // Method org/jboss/sasl/digest/DigestMD5Base.access$000:()Lorg/jboss/logging/Logger;
     120: ldc           #34                 // String Unmatched MACs
     122: invokevirtual #35                 // Method org/jboss/logging/Logger.trace:(Ljava/lang/Object;)V
     125: getstatic     #29                 // Field org/jboss/sasl/digest/DigestMD5Base.EMPTY_BYTE_ARRAY:[B
     128: areturn
     129: aload_0
     130: getfield      #4                  // Field peerSeqNum:I
     133: aload         7
     135: iconst_0
     136: iconst_4
     137: invokestatic  #36                 // Method org/jboss/sasl/digest/AbstractSaslImpl.networkByteOrderToInt:([BII)I
     140: if_icmpeq     188
     143: new           #9                  // class javax/security/sasl/SaslException
     146: dup
     147: new           #37                 // class java/lang/StringBuilder
     150: dup
     151: invokespecial #38                 // Method java/lang/StringBuilder."<init>":()V
     154: ldc           #39                 // String DIGEST-MD5: Out of order sequencing of messages from server. Got:
     156: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     159: aload         7
     161: iconst_0
     162: iconst_4
     163: invokestatic  #36                 // Method org/jboss/sasl/digest/AbstractSaslImpl.networkByteOrderToInt:([BII)I
     166: invokevirtual #41                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     169: ldc           #42                 // String  Expected:
     171: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     174: aload_0
     175: getfield      #4                  // Field peerSeqNum:I
     178: invokevirtual #41                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     181: invokevirtual #43                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     184: invokespecial #44                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     187: athrow
     188: aload_0
     189: getfield      #5                  // Field messageType:[B
     192: aload         6
     194: invokestatic  #32                 // Method java/util/Arrays.equals:([B[B)Z
     197: ifne          233
     200: new           #9                  // class javax/security/sasl/SaslException
     203: dup
     204: new           #37                 // class java/lang/StringBuilder
     207: dup
     208: invokespecial #38                 // Method java/lang/StringBuilder."<init>":()V
     211: ldc           #45                 // String DIGEST-MD5: invalid message type:
     213: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     216: aload         6
     218: iconst_0
     219: iconst_2
     220: invokestatic  #36                 // Method org/jboss/sasl/digest/AbstractSaslImpl.networkByteOrderToInt:([BII)I
     223: invokevirtual #41                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     226: invokevirtual #43                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     229: invokespecial #44                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     232: athrow
     233: aload_0
     234: dup
     235: getfield      #4                  // Field peerSeqNum:I
     238: iconst_1
     239: iadd
     240: putfield      #4                  // Field peerSeqNum:I
     243: aload         5
     245: areturn

  protected byte[] getHMAC(byte[], byte[], byte[], int, int) throws javax.security.sasl.SaslException;
    Code:
       0: iconst_4
       1: iload         5
       3: iadd
       4: newarray       byte
       6: astore        6
       8: aload_2
       9: iconst_0
      10: aload         6
      12: iconst_0
      13: iconst_4
      14: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      17: aload_3
      18: iload         4
      20: aload         6
      22: iconst_4
      23: iload         5
      25: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      28: new           #46                 // class javax/crypto/spec/SecretKeySpec
      31: dup
      32: aload_1
      33: ldc           #47                 // String HmacMD5
      35: invokespecial #48                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      38: astore        7
      40: ldc           #47                 // String HmacMD5
      42: invokestatic  #49                 // Method javax/crypto/Mac.getInstance:(Ljava/lang/String;)Ljavax/crypto/Mac;
      45: astore        8
      47: aload         8
      49: aload         7
      51: invokevirtual #50                 // Method javax/crypto/Mac.init:(Ljava/security/Key;)V
      54: aload         8
      56: aload         6
      58: invokevirtual #51                 // Method javax/crypto/Mac.update:([B)V
      61: aload         8
      63: invokevirtual #52                 // Method javax/crypto/Mac.doFinal:()[B
      66: astore        9
      68: bipush        10
      70: newarray       byte
      72: astore        10
      74: aload         9
      76: iconst_0
      77: aload         10
      79: iconst_0
      80: bipush        10
      82: invokestatic  #24                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      85: aload         10
      87: areturn
      88: astore        7
      90: new           #9                  // class javax/security/sasl/SaslException
      93: dup
      94: ldc           #54                 // String DIGEST-MD5: Invalid bytes used for key of HMAC-MD5 hash.
      96: aload         7
      98: invokespecial #11                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     101: athrow
     102: astore        7
     104: new           #9                  // class javax/security/sasl/SaslException
     107: dup
     108: ldc           #55                 // String DIGEST-MD5: Error creating instance of MD5 digest algorithm
     110: aload         7
     112: invokespecial #11                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     115: athrow
    Exception table:
       from    to  target type
          28    87    88   Class java/security/InvalidKeyException
          28    87   102   Class java/security/NoSuchAlgorithmException

  protected void incrementSeqNum();
    Code:
       0: aload_0
       1: dup
       2: getfield      #3                  // Field mySeqNum:I
       5: dup_x1
       6: iconst_1
       7: iadd
       8: putfield      #3                  // Field mySeqNum:I
      11: aload_0
      12: getfield      #6                  // Field sequenceNum:[B
      15: iconst_0
      16: iconst_4
      17: invokestatic  #16                 // Method org/jboss/sasl/digest/AbstractSaslImpl.intToNetworkByteOrder:(I[BII)V
      20: return
}
