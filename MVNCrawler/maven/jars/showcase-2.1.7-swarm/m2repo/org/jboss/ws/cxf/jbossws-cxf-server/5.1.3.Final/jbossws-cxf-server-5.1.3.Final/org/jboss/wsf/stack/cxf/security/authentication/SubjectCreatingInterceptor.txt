Compiled from "SubjectCreatingInterceptor.java"
public class org.jboss.wsf.stack.cxf.security.authentication.SubjectCreatingInterceptor extends org.apache.cxf.ws.security.wss4j.WSS4JInInterceptor {
  protected final org.jboss.wsf.stack.cxf.security.authentication.SubjectCreator helper;

  private static final java.util.logging.Logger LOG;

  private final java.lang.ThreadLocal<org.jboss.wsf.spi.security.SecurityDomainContext> sdc;

  private boolean supportDigestPasswords;

  public org.jboss.wsf.stack.cxf.security.authentication.SubjectCreatingInterceptor();
    Code:
       0: aload_0
       1: new           #2                  // class java/util/HashMap
       4: dup
       5: invokespecial #3                  // Method java/util/HashMap."<init>":()V
       8: invokespecial #4                  // Method "<init>":(Ljava/util/Map;)V
      11: return

  public org.jboss.wsf.stack.cxf.security.authentication.SubjectCreatingInterceptor(java.util.Map<java.lang.String, java.lang.Object>);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #5                  // Method org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor."<init>":(Ljava/util/Map;)V
       5: aload_0
       6: new           #6                  // class org/jboss/wsf/stack/cxf/security/authentication/SubjectCreator
       9: dup
      10: invokespecial #7                  // Method org/jboss/wsf/stack/cxf/security/authentication/SubjectCreator."<init>":()V
      13: putfield      #8                  // Field helper:Lorg/jboss/wsf/stack/cxf/security/authentication/SubjectCreator;
      16: aload_0
      17: new           #9                  // class java/lang/ThreadLocal
      20: dup
      21: invokespecial #10                 // Method java/lang/ThreadLocal."<init>":()V
      24: putfield      #11                 // Field sdc:Ljava/lang/ThreadLocal;
      27: aload_0
      28: invokevirtual #12                 // Method getAfter:()Ljava/util/Set;
      31: ldc           #13                 // class org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JInInterceptor
      33: invokevirtual #14                 // Method java/lang/Class.getName:()Ljava/lang/String;
      36: invokeinterface #15,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      41: pop
      42: return

  public void setSupportDigestPasswords(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #1                  // Field supportDigestPasswords:Z
       5: return

  public boolean getSupportDigestPasswords();
    Code:
       0: aload_0
       1: getfield      #1                  // Field supportDigestPasswords:Z
       4: ireturn

  public void handleMessage(org.apache.cxf.binding.soap.SoapMessage) throws org.apache.cxf.interceptor.Fault;
    Code:
       0: aload_1
       1: invokevirtual #16                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
       4: ldc           #17                 // class org/jboss/wsf/spi/deployment/Endpoint
       6: invokeinterface #18,  2           // InterfaceMethod org/apache/cxf/message/Exchange.get:(Ljava/lang/Class;)Ljava/lang/Object;
      11: checkcast     #17                 // class org/jboss/wsf/spi/deployment/Endpoint
      14: astore_2
      15: aload_0
      16: getfield      #11                 // Field sdc:Ljava/lang/ThreadLocal;
      19: aload_2
      20: invokeinterface #19,  1           // InterfaceMethod org/jboss/wsf/spi/deployment/Endpoint.getSecurityDomainContext:()Lorg/jboss/wsf/spi/security/SecurityDomainContext;
      25: invokevirtual #20                 // Method java/lang/ThreadLocal.set:(Ljava/lang/Object;)V
      28: aload_1
      29: ldc           #21                 // class org/apache/cxf/common/security/SecurityToken
      31: invokevirtual #22                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      34: checkcast     #21                 // class org/apache/cxf/common/security/SecurityToken
      37: astore_3
      38: aload_1
      39: ldc           #23                 // class org/apache/cxf/security/SecurityContext
      41: invokevirtual #22                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      44: checkcast     #23                 // class org/apache/cxf/security/SecurityContext
      47: astore        4
      49: aload_3
      50: ifnull        68
      53: aload         4
      55: ifnull        68
      58: aload         4
      60: invokeinterface #24,  1           // InterfaceMethod org/apache/cxf/security/SecurityContext.getUserPrincipal:()Ljava/security/Principal;
      65: ifnonnull     88
      68: aload_0
      69: aload_1
      70: invokespecial #25                 // Method org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor.handleMessage:(Lorg/apache/cxf/binding/soap/SoapMessage;)V
      73: aload_0
      74: getfield      #11                 // Field sdc:Ljava/lang/ThreadLocal;
      77: ifnull        87
      80: aload_0
      81: getfield      #11                 // Field sdc:Ljava/lang/ThreadLocal;
      84: invokevirtual #26                 // Method java/lang/ThreadLocal.remove:()V
      87: return
      88: aload_3
      89: checkcast     #27                 // class org/apache/cxf/common/security/UsernameToken
      92: astore        5
      94: aload_0
      95: aload         5
      97: invokevirtual #28                 // Method org/apache/cxf/common/security/UsernameToken.getName:()Ljava/lang/String;
     100: aload         5
     102: invokevirtual #29                 // Method org/apache/cxf/common/security/UsernameToken.getPassword:()Ljava/lang/String;
     105: aload         5
     107: invokevirtual #30                 // Method org/apache/cxf/common/security/UsernameToken.isHashed:()Z
     110: aload         5
     112: invokevirtual #31                 // Method org/apache/cxf/common/security/UsernameToken.getNonce:()Ljava/lang/String;
     115: aload         5
     117: invokevirtual #32                 // Method org/apache/cxf/common/security/UsernameToken.getCreatedTime:()Ljava/lang/String;
     120: invokevirtual #33                 // Method createSubject:(Ljava/lang/String;Ljava/lang/String;ZLjava/lang/String;Ljava/lang/String;)Ljavax/security/auth/Subject;
     123: astore        6
     125: aload_0
     126: aload         4
     128: invokeinterface #24,  1           // InterfaceMethod org/apache/cxf/security/SecurityContext.getUserPrincipal:()Ljava/security/Principal;
     133: aload         6
     135: invokevirtual #34                 // Method doCreateSecurityContext:(Ljava/security/Principal;Ljavax/security/auth/Subject;)Lorg/apache/cxf/security/SecurityContext;
     138: astore        7
     140: aload_1
     141: ldc           #23                 // class org/apache/cxf/security/SecurityContext
     143: aload         7
     145: invokevirtual #35                 // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/Class;Ljava/lang/Object;)V
     148: aload_0
     149: getfield      #11                 // Field sdc:Ljava/lang/ThreadLocal;
     152: ifnull        184
     155: aload_0
     156: getfield      #11                 // Field sdc:Ljava/lang/ThreadLocal;
     159: invokevirtual #26                 // Method java/lang/ThreadLocal.remove:()V
     162: goto          184
     165: astore        8
     167: aload_0
     168: getfield      #11                 // Field sdc:Ljava/lang/ThreadLocal;
     171: ifnull        181
     174: aload_0
     175: getfield      #11                 // Field sdc:Ljava/lang/ThreadLocal;
     178: invokevirtual #26                 // Method java/lang/ThreadLocal.remove:()V
     181: aload         8
     183: athrow
     184: return
    Exception table:
       from    to  target type
          28    73   165   any
          88   148   165   any
         165   167   165   any

  protected org.apache.cxf.security.SecurityContext createSecurityContext(java.security.Principal);
    Code:
       0: invokestatic  #36                 // Method org/apache/cxf/phase/PhaseInterceptorChain.getCurrentMessage:()Lorg/apache/cxf/message/Message;
       3: astore_2
       4: aload_2
       5: ifnonnull     18
       8: new           #37                 // class java/lang/IllegalStateException
      11: dup
      12: ldc           #38                 // String Current message is not available
      14: invokespecial #39                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      17: athrow
      18: aload_0
      19: aload_1
      20: aload_2
      21: ldc           #40                 // class javax/security/auth/Subject
      23: invokeinterface #41,  2           // InterfaceMethod org/apache/cxf/message/Message.get:(Ljava/lang/Class;)Ljava/lang/Object;
      28: checkcast     #40                 // class javax/security/auth/Subject
      31: invokevirtual #34                 // Method doCreateSecurityContext:(Ljava/security/Principal;Ljavax/security/auth/Subject;)Lorg/apache/cxf/security/SecurityContext;
      34: areturn

  protected org.apache.cxf.security.SecurityContext doCreateSecurityContext(java.security.Principal, javax.security.auth.Subject);
    Code:
       0: new           #42                 // class org/apache/cxf/interceptor/security/DefaultSecurityContext
       3: dup
       4: aload_1
       5: aload_2
       6: invokespecial #43                 // Method org/apache/cxf/interceptor/security/DefaultSecurityContext."<init>":(Ljava/security/Principal;Ljavax/security/auth/Subject;)V
       9: areturn

  protected void setSubject(java.lang.String, java.lang.String, boolean, java.lang.String, java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: invokestatic  #36                 // Method org/apache/cxf/phase/PhaseInterceptorChain.getCurrentMessage:()Lorg/apache/cxf/message/Message;
       3: astore        6
       5: aload         6
       7: ifnonnull     20
      10: new           #37                 // class java/lang/IllegalStateException
      13: dup
      14: ldc           #38                 // String Current message is not available
      16: invokespecial #39                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      19: athrow
      20: aconst_null
      21: astore        7
      23: aload_0
      24: aload_1
      25: aload_2
      26: iload_3
      27: aload         4
      29: aload         5
      31: invokevirtual #33                 // Method createSubject:(Ljava/lang/String;Ljava/lang/String;ZLjava/lang/String;Ljava/lang/String;)Ljavax/security/auth/Subject;
      34: astore        7
      36: goto          64
      39: astore        8
      41: ldc           #45                 // String Failed Authentication : Subject has not been created
      43: astore        9
      45: getstatic     #46                 // Field LOG:Ljava/util/logging/Logger;
      48: aload         9
      50: invokevirtual #47                 // Method java/util/logging/Logger.severe:(Ljava/lang/String;)V
      53: new           #48                 // class org/apache/wss4j/common/ext/WSSecurityException
      56: dup
      57: getstatic     #49                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      60: invokespecial #50                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      63: athrow
      64: aload         7
      66: ifnull        95
      69: aload         7
      71: invokevirtual #51                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      74: invokeinterface #52,  1           // InterfaceMethod java/util/Set.size:()I
      79: ifeq          95
      82: aload_0
      83: aload         7
      85: invokevirtual #51                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      88: aload_1
      89: invokespecial #53                 // Method checkUserPrincipal:(Ljava/util/Set;Ljava/lang/String;)Z
      92: ifne          118
      95: ldc           #54                 // String Failed Authentication : Invalid Subject
      97: astore        8
      99: getstatic     #46                 // Field LOG:Ljava/util/logging/Logger;
     102: aload         8
     104: invokevirtual #47                 // Method java/util/logging/Logger.severe:(Ljava/lang/String;)V
     107: new           #48                 // class org/apache/wss4j/common/ext/WSSecurityException
     110: dup
     111: getstatic     #49                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     114: invokespecial #50                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     117: athrow
     118: aload         6
     120: ldc           #40                 // class javax/security/auth/Subject
     122: aload         7
     124: invokeinterface #55,  3           // InterfaceMethod org/apache/cxf/message/Message.put:(Ljava/lang/Class;Ljava/lang/Object;)V
     129: return
    Exception table:
       from    to  target type
          23    36    39   Class java/lang/Exception

  private boolean checkUserPrincipal(java.util.Set<java.security.Principal>, java.lang.String);
    Code:
       0: aload_1
       1: invokeinterface #56,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
       6: astore_3
       7: aload_3
       8: invokeinterface #57,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      13: ifeq          50
      16: aload_3
      17: invokeinterface #58,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      22: checkcast     #59                 // class java/security/Principal
      25: astore        4
      27: aload         4
      29: instanceof    #60                 // class java/security/acl/Group
      32: ifne          47
      35: aload         4
      37: invokeinterface #61,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      42: aload_2
      43: invokevirtual #62                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      46: ireturn
      47: goto          7
      50: iconst_0
      51: ireturn

  protected org.apache.wss4j.dom.engine.WSSecurityEngine getSecurityEngine(boolean);
    Code:
       0: new           #2                  // class java/util/HashMap
       3: dup
       4: iconst_1
       5: invokespecial #63                 // Method java/util/HashMap."<init>":(I)V
       8: astore_2
       9: new           #64                 // class org/jboss/wsf/stack/cxf/security/authentication/SubjectCreatingInterceptor$CustomValidator
      12: dup
      13: aload_0
      14: invokespecial #65                 // Method org/jboss/wsf/stack/cxf/security/authentication/SubjectCreatingInterceptor$CustomValidator."<init>":(Lorg/jboss/wsf/stack/cxf/security/authentication/SubjectCreatingInterceptor;)V
      17: astore_3
      18: aload_2
      19: getstatic     #66                 // Field org/apache/wss4j/dom/WSConstants.USERNAME_TOKEN:Ljavax/xml/namespace/QName;
      22: aload_3
      23: invokeinterface #67,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      28: pop
      29: aload_2
      30: invokestatic  #68                 // Method createSecurityEngine:(Ljava/util/Map;)Lorg/apache/wss4j/dom/engine/WSSecurityEngine;
      33: areturn

  public javax.security.auth.Subject createSubject(java.lang.String, java.lang.String, boolean, java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: getfield      #8                  // Field helper:Lorg/jboss/wsf/stack/cxf/security/authentication/SubjectCreator;
       4: aload_0
       5: getfield      #11                 // Field sdc:Ljava/lang/ThreadLocal;
       8: invokevirtual #69                 // Method java/lang/ThreadLocal.get:()Ljava/lang/Object;
      11: checkcast     #70                 // class org/jboss/wsf/spi/security/SecurityDomainContext
      14: aload_1
      15: aload_2
      16: iload_3
      17: aload         4
      19: aload         5
      21: invokevirtual #71                 // Method org/jboss/wsf/stack/cxf/security/authentication/SubjectCreator.createSubject:(Lorg/jboss/wsf/spi/security/SecurityDomainContext;Ljava/lang/String;Ljava/lang/String;ZLjava/lang/String;Ljava/lang/String;)Ljavax/security/auth/Subject;
      24: areturn

  public void setPropagateContext(boolean);
    Code:
       0: aload_0
       1: getfield      #8                  // Field helper:Lorg/jboss/wsf/stack/cxf/security/authentication/SubjectCreator;
       4: iload_1
       5: invokevirtual #72                 // Method org/jboss/wsf/stack/cxf/security/authentication/SubjectCreator.setPropagateContext:(Z)V
       8: return

  public void setTimestampThreshold(int);
    Code:
       0: aload_0
       1: getfield      #8                  // Field helper:Lorg/jboss/wsf/stack/cxf/security/authentication/SubjectCreator;
       4: iload_1
       5: invokevirtual #73                 // Method org/jboss/wsf/stack/cxf/security/authentication/SubjectCreator.setTimestampThreshold:(I)V
       8: return

  public void setNonceStore(org.jboss.wsf.stack.cxf.security.nonce.NonceStore);
    Code:
       0: aload_0
       1: getfield      #8                  // Field helper:Lorg/jboss/wsf/stack/cxf/security/authentication/SubjectCreator;
       4: aload_1
       5: invokevirtual #74                 // Method org/jboss/wsf/stack/cxf/security/authentication/SubjectCreator.setNonceStore:(Lorg/jboss/wsf/stack/cxf/security/nonce/NonceStore;)V
       8: return

  public void setDecodeNonce(boolean);
    Code:
       0: aload_0
       1: getfield      #8                  // Field helper:Lorg/jboss/wsf/stack/cxf/security/authentication/SubjectCreator;
       4: iload_1
       5: invokevirtual #75                 // Method org/jboss/wsf/stack/cxf/security/authentication/SubjectCreator.setDecodeNonce:(Z)V
       8: return

  public void handleMessage(org.apache.cxf.message.Message) throws org.apache.cxf.interceptor.Fault;
    Code:
       0: aload_0
       1: aload_1
       2: checkcast     #76                 // class org/apache/cxf/binding/soap/SoapMessage
       5: invokevirtual #77                 // Method handleMessage:(Lorg/apache/cxf/binding/soap/SoapMessage;)V
       8: return

  static boolean access$000(org.jboss.wsf.stack.cxf.security.authentication.SubjectCreatingInterceptor);
    Code:
       0: aload_0
       1: getfield      #1                  // Field supportDigestPasswords:Z
       4: ireturn

  static {};
    Code:
       0: ldc           #78                 // class org/jboss/wsf/stack/cxf/security/authentication/SubjectCreatingInterceptor
       2: invokestatic  #79                 // Method org/apache/cxf/common/logging/LogUtils.getL7dLogger:(Ljava/lang/Class;)Ljava/util/logging/Logger;
       5: putstatic     #46                 // Field LOG:Ljava/util/logging/Logger;
       8: return
}
