Compiled from "SPNEGOLoginModule.java"
public class org.jboss.security.negotiation.spnego.SPNEGOLoginModule extends org.jboss.security.negotiation.common.CommonLoginModule {
  private static final java.lang.String REMOVE_REALM_FROM_PRINCIPAL;

  private static final java.lang.String SERVER_SECURITY_DOMAIN;

  private static final java.lang.String USERNAME_PASSWORD_DOMAIN;

  private static final java.lang.String[] ALL_VALID_OPTIONS;

  private static final java.lang.String SPNEGO;

  private static final org.ietf.jgss.Oid kerberos;

  private boolean removeRealmFromPrincipal;

  private java.lang.String serverSecurityDomain;

  private java.lang.String usernamePasswordDomain;

  private javax.security.auth.login.LoginContext serverLoginContext;

  private org.ietf.jgss.GSSCredential delegatedCredential;

  public org.jboss.security.negotiation.spnego.SPNEGOLoginModule();
    Code:
       0: aload_0
       1: invokespecial #5                  // Method org/jboss/security/negotiation/common/CommonLoginModule."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #6                  // Field serverLoginContext:Ljavax/security/auth/login/LoginContext;
       9: aload_0
      10: aconst_null
      11: putfield      #1                  // Field delegatedCredential:Lorg/ietf/jgss/GSSCredential;
      14: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map, java.util.Map);
    Code:
       0: aload_0
       1: getstatic     #7                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
       4: invokevirtual #8                  // Method addValidOptions:([Ljava/lang/String;)V
       7: aload_0
       8: aload_1
       9: aload_2
      10: aload_3
      11: aload         4
      13: invokespecial #9                  // Method org/jboss/security/negotiation/common/CommonLoginModule.initialize:(Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;Ljava/util/Map;Ljava/util/Map;)V
      16: aload_0
      17: aload         4
      19: ldc           #11                 // String serverSecurityDomain
      21: invokeinterface #12,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      26: checkcast     #13                 // class java/lang/String
      29: putfield      #14                 // Field serverSecurityDomain:Ljava/lang/String;
      32: aload_0
      33: aload         4
      35: ldc           #15                 // String usernamePasswordDomain
      37: invokeinterface #12,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      42: checkcast     #13                 // class java/lang/String
      45: putfield      #16                 // Field usernamePasswordDomain:Ljava/lang/String;
      48: aload         4
      50: ldc           #17                 // String removeRealmFromPrincipal
      52: invokeinterface #12,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      57: checkcast     #13                 // class java/lang/String
      60: astore        5
      62: aload_0
      63: aload         5
      65: invokestatic  #18                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
      68: invokevirtual #19                 // Method java/lang/Boolean.booleanValue:()Z
      71: putfield      #20                 // Field removeRealmFromPrincipal:Z
      74: aload_0
      75: getfield      #20                 // Field removeRealmFromPrincipal:Z
      78: ifne          97
      81: aload_0
      82: getfield      #21                 // Field principalClassName:Ljava/lang/String;
      85: ifnonnull     97
      88: aload_0
      89: ldc           #22                 // class javax/security/auth/kerberos/KerberosPrincipal
      91: invokevirtual #23                 // Method java/lang/Class.getName:()Ljava/lang/String;
      94: putfield      #21                 // Field principalClassName:Ljava/lang/String;
      97: aload_0
      98: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
     101: invokevirtual #24                 // Method org/jboss/logging/Logger.isDebugEnabled:()Z
     104: ifeq          194
     107: aload_0
     108: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
     111: new           #25                 // class java/lang/StringBuilder
     114: dup
     115: invokespecial #26                 // Method java/lang/StringBuilder."<init>":()V
     118: ldc           #27                 // String removeRealmFromPrincipal=
     120: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     123: aload_0
     124: getfield      #20                 // Field removeRealmFromPrincipal:Z
     127: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Z)Ljava/lang/StringBuilder;
     130: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     133: invokevirtual #31                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
     136: aload_0
     137: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
     140: new           #25                 // class java/lang/StringBuilder
     143: dup
     144: invokespecial #26                 // Method java/lang/StringBuilder."<init>":()V
     147: ldc           #32                 // String serverSecurityDomain=
     149: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     152: aload_0
     153: getfield      #14                 // Field serverSecurityDomain:Ljava/lang/String;
     156: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     159: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     162: invokevirtual #31                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
     165: aload_0
     166: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
     169: new           #25                 // class java/lang/StringBuilder
     172: dup
     173: invokespecial #26                 // Method java/lang/StringBuilder."<init>":()V
     176: ldc           #33                 // String usernamePasswordDomain=
     178: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     181: aload_0
     182: getfield      #16                 // Field usernamePasswordDomain:Ljava/lang/String;
     185: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     188: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     191: invokevirtual #31                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
     194: return

  public boolean login() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
       4: invokevirtual #34                 // Method org/jboss/logging/Logger.isTraceEnabled:()Z
       7: istore_1
       8: aload_0
       9: invokespecial #35                 // Method org/jboss/security/negotiation/common/CommonLoginModule.login:()Z
      12: iconst_1
      13: if_icmpne     27
      16: aload_0
      17: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
      20: ldc           #36                 // String super.login()==true
      22: invokevirtual #31                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
      25: iconst_1
      26: ireturn
      27: aload_0
      28: iconst_0
      29: putfield      #37                 // Field org/jboss/security/negotiation/common/CommonLoginModule.loginOk:Z
      32: aload_0
      33: invokevirtual #38                 // Method innerLogin:()Ljava/lang/Object;
      36: astore_2
      37: iload_1
      38: ifeq          67
      41: aload_0
      42: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
      45: new           #25                 // class java/lang/StringBuilder
      48: dup
      49: invokespecial #26                 // Method java/lang/StringBuilder."<init>":()V
      52: ldc           #39                 // String Result -
      54: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      57: aload_2
      58: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      61: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      64: invokevirtual #41                 // Method org/jboss/logging/Logger.trace:(Ljava/lang/Object;)V
      67: aload_2
      68: instanceof    #42                 // class java/lang/Boolean
      71: ifeq          182
      74: getstatic     #43                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
      77: aload_2
      78: invokevirtual #44                 // Method java/lang/Boolean.equals:(Ljava/lang/Object;)Z
      81: ifeq          234
      84: aload_0
      85: iconst_1
      86: putfield      #37                 // Field org/jboss/security/negotiation/common/CommonLoginModule.loginOk:Z
      89: aload_0
      90: invokevirtual #45                 // Method getUseFirstPass:()Z
      93: iconst_1
      94: if_icmpne     234
      97: aload_0
      98: invokevirtual #46                 // Method getIdentity:()Ljava/security/Principal;
     101: astore_3
     102: aload_3
     103: invokeinterface #47,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
     108: astore        4
     110: aload_0
     111: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
     114: invokevirtual #24                 // Method org/jboss/logging/Logger.isDebugEnabled:()Z
     117: ifeq          152
     120: aload_0
     121: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
     124: new           #25                 // class java/lang/StringBuilder
     127: dup
     128: invokespecial #26                 // Method java/lang/StringBuilder."<init>":()V
     131: ldc           #48                 // String Storing username \'
     133: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     136: aload         4
     138: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     141: ldc           #49                 // String \' and empty password
     143: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     146: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     149: invokevirtual #31                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
     152: aload_0
     153: getfield      #50                 // Field sharedState:Ljava/util/Map;
     156: ldc           #51                 // String javax.security.auth.login.name
     158: aload_3
     159: invokeinterface #52,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     164: pop
     165: aload_0
     166: getfield      #50                 // Field sharedState:Ljava/util/Map;
     169: ldc           #53                 // String javax.security.auth.login.password
     171: ldc           #54                 // String
     173: invokeinterface #52,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     178: pop
     179: goto          234
     182: aload_2
     183: instanceof    #55                 // class java/lang/Exception
     186: ifeq          234
     189: aload_2
     190: checkcast     #55                 // class java/lang/Exception
     193: astore_3
     194: aload_0
     195: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
     198: ldc           #56                 // String Unable to authenticate
     200: aload_3
     201: invokevirtual #57                 // Method org/jboss/logging/Logger.error:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     204: new           #58                 // class javax/security/auth/login/LoginException
     207: dup
     208: new           #25                 // class java/lang/StringBuilder
     211: dup
     212: invokespecial #26                 // Method java/lang/StringBuilder."<init>":()V
     215: ldc           #59                 // String Unable to authenticate -
     217: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     220: aload_3
     221: invokevirtual #60                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     224: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     227: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     230: invokespecial #61                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
     233: athrow
     234: iload_1
     235: ifeq          267
     238: aload_0
     239: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
     242: new           #25                 // class java/lang/StringBuilder
     245: dup
     246: invokespecial #26                 // Method java/lang/StringBuilder."<init>":()V
     249: ldc           #62                 // String super.loginOk
     251: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     254: aload_0
     255: getfield      #37                 // Field org/jboss/security/negotiation/common/CommonLoginModule.loginOk:Z
     258: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Z)Ljava/lang/StringBuilder;
     261: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     264: invokevirtual #41                 // Method org/jboss/logging/Logger.trace:(Ljava/lang/Object;)V
     267: aload_0
     268: getfield      #37                 // Field org/jboss/security/negotiation/common/CommonLoginModule.loginOk:Z
     271: iconst_1
     272: if_icmpne     277
     275: iconst_1
     276: ireturn
     277: invokestatic  #63                 // Method org/jboss/security/negotiation/common/NegotiationContext.getCurrentNegotiationContext:()Lorg/jboss/security/negotiation/common/NegotiationContext;
     280: astore_3
     281: aload_3
     282: ifnull        315
     285: aload_3
     286: invokevirtual #64                 // Method org/jboss/security/negotiation/common/NegotiationContext.getResponseMessage:()Lorg/jboss/security/negotiation/NegotiationMessage;
     289: checkcast     #65                 // class org/jboss/security/negotiation/spnego/encoding/NegTokenTarg
     292: invokevirtual #66                 // Method org/jboss/security/negotiation/spnego/encoding/NegTokenTarg.getNegResult:()Ljava/lang/Integer;
     295: getstatic     #67                 // Field org/jboss/security/negotiation/spnego/encoding/NegTokenTarg.REJECTED:Ljava/lang/Integer;
     298: if_acmpeq     315
     301: aload_0
     302: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
     305: ldc           #68                 // String NegotiationContext.setContinuationRequired(true)
     307: invokevirtual #31                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
     310: aload_3
     311: iconst_1
     312: invokevirtual #69                 // Method org/jboss/security/negotiation/common/NegotiationContext.setContinuationRequired:(Z)V
     315: new           #58                 // class javax/security/auth/login/LoginException
     318: dup
     319: ldc           #70                 // String Continuation Required.
     321: invokespecial #61                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
     324: athrow

  public boolean commit() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: invokespecial #71                 // Method org/jboss/security/negotiation/common/CommonLoginModule.commit:()Z
       4: istore_1
       5: iload_1
       6: ifeq          27
       9: aload_0
      10: getfield      #1                  // Field delegatedCredential:Lorg/ietf/jgss/GSSCredential;
      13: ifnull        27
      16: aload_0
      17: getfield      #72                 // Field subject:Ljavax/security/auth/Subject;
      20: aload_0
      21: getfield      #1                  // Field delegatedCredential:Lorg/ietf/jgss/GSSCredential;
      24: invokestatic  #73                 // Method org/jboss/security/negotiation/spnego/SecurityActions.addPrivateCredential:(Ljavax/security/auth/Subject;Ljava/lang/Object;)V
      27: iload_1
      28: ireturn

  public boolean logout() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #1                  // Field delegatedCredential:Lorg/ietf/jgss/GSSCredential;
       4: ifnull        18
       7: aload_0
       8: getfield      #72                 // Field subject:Ljavax/security/auth/Subject;
      11: aload_0
      12: getfield      #1                  // Field delegatedCredential:Lorg/ietf/jgss/GSSCredential;
      15: invokestatic  #74                 // Method org/jboss/security/negotiation/spnego/SecurityActions.removePrivateCredential:(Ljavax/security/auth/Subject;Ljava/lang/Object;)V
      18: aload_0
      19: invokespecial #75                 // Method org/jboss/security/negotiation/common/CommonLoginModule.logout:()Z
      22: ireturn

  protected java.lang.Object innerLogin() throws javax.security.auth.login.LoginException;
    Code:
       0: invokestatic  #63                 // Method org/jboss/security/negotiation/common/NegotiationContext.getCurrentNegotiationContext:()Lorg/jboss/security/negotiation/common/NegotiationContext;
       3: astore_1
       4: aload_1
       5: ifnonnull     30
       8: aload_0
       9: getfield      #16                 // Field usernamePasswordDomain:Ljava/lang/String;
      12: ifnonnull     25
      15: new           #58                 // class javax/security/auth/login/LoginException
      18: dup
      19: ldc           #76                 // String No NegotiationContext and no usernamePasswordDomain defined.
      21: invokespecial #61                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      24: athrow
      25: aload_0
      26: invokespecial #77                 // Method usernamePasswordLogin:()Ljava/lang/Object;
      29: areturn
      30: aload_0
      31: aload_1
      32: invokespecial #78                 // Method spnegoLogin:(Lorg/jboss/security/negotiation/common/NegotiationContext;)Ljava/lang/Object;
      35: areturn

  private java.lang.Object usernamePasswordLogin() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
       4: ldc           #79                 // String Falling back to username/password authentication
       6: invokevirtual #31                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
       9: new           #80                 // class javax/security/auth/login/LoginContext
      12: dup
      13: aload_0
      14: getfield      #16                 // Field usernamePasswordDomain:Ljava/lang/String;
      17: aload_0
      18: getfield      #81                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      21: invokespecial #82                 // Method javax/security/auth/login/LoginContext."<init>":(Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)V
      24: astore_1
      25: aload_1
      26: invokevirtual #83                 // Method javax/security/auth/login/LoginContext.login:()V
      29: aload_1
      30: invokevirtual #84                 // Method javax/security/auth/login/LoginContext.getSubject:()Ljavax/security/auth/Subject;
      33: astore_2
      34: aload_0
      35: aload_2
      36: invokevirtual #85                 // Method getIdentityFromSubject:(Ljavax/security/auth/Subject;)Ljava/security/Principal;
      39: astore_3
      40: aload_0
      41: aload_3
      42: invokevirtual #3                  // Method setIdentity:(Ljava/security/Principal;)V
      45: getstatic     #43                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
      48: areturn

  protected java.security.Principal getIdentityFromSubject(javax.security.auth.Subject) throws javax.security.auth.login.LoginException;
    Code:
       0: aload_1
       1: invokevirtual #86                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
       4: astore_2
       5: aload_2
       6: invokeinterface #87,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
      11: ifeq          24
      14: new           #58                 // class javax/security/auth/login/LoginException
      17: dup
      18: ldc           #88                 // String No principal returned after login.
      20: invokespecial #61                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      23: athrow
      24: aload_2
      25: invokeinterface #89,  1           // InterfaceMethod java/util/Set.size:()I
      30: iconst_1
      31: if_icmple     43
      34: aload_0
      35: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
      38: ldc           #90                 // String Multiple principals returned, using first principal in set.
      40: invokevirtual #91                 // Method org/jboss/logging/Logger.warn:(Ljava/lang/Object;)V
      43: aload_2
      44: invokeinterface #92,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      49: invokeinterface #93,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      54: checkcast     #94                 // class java/security/Principal
      57: astore_3
      58: aload_3
      59: areturn

  private java.lang.Object spnegoLogin(org.jboss.security.negotiation.common.NegotiationContext) throws javax.security.auth.login.LoginException;
    Code:
       0: aload_1
       1: invokevirtual #95                 // Method org/jboss/security/negotiation/common/NegotiationContext.getRequestMessage:()Lorg/jboss/security/negotiation/NegotiationMessage;
       4: astore_2
       5: aload_2
       6: instanceof    #96                 // class org/jboss/security/negotiation/spnego/encoding/SPNEGOMessage
       9: ifne          64
      12: aload_2
      13: instanceof    #97                 // class org/jboss/security/negotiation/spnego/KerberosMessage
      16: ifne          64
      19: new           #25                 // class java/lang/StringBuilder
      22: dup
      23: invokespecial #26                 // Method java/lang/StringBuilder."<init>":()V
      26: ldc           #98                 // String Unsupported negotiation mechanism \'
      28: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      31: aload_2
      32: invokevirtual #99                 // Method org/jboss/security/negotiation/NegotiationMessage.getMessageType:()Ljava/lang/String;
      35: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      38: ldc           #100                // String \'.
      40: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      43: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      46: astore_3
      47: aload_0
      48: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
      51: aload_3
      52: invokevirtual #91                 // Method org/jboss/logging/Logger.warn:(Ljava/lang/Object;)V
      55: new           #58                 // class javax/security/auth/login/LoginException
      58: dup
      59: aload_3
      60: invokespecial #61                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      63: athrow
      64: aload_0
      65: invokevirtual #101                // Method getServerSubject:()Ljavax/security/auth/Subject;
      68: astore_3
      69: new           #102                // class org/jboss/security/negotiation/spnego/SPNEGOLoginModule$AcceptSecContext
      72: dup
      73: aload_0
      74: aload_1
      75: invokespecial #103                // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule$AcceptSecContext."<init>":(Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;Lorg/jboss/security/negotiation/common/NegotiationContext;)V
      78: astore        4
      80: aload_3
      81: aload         4
      83: invokestatic  #104                // Method javax/security/auth/Subject.doAs:(Ljavax/security/auth/Subject;Ljava/security/PrivilegedAction;)Ljava/lang/Object;
      86: astore        5
      88: aload         5
      90: astore        6
      92: aload_0
      93: getfield      #6                  // Field serverLoginContext:Ljavax/security/auth/login/LoginContext;
      96: ifnull        106
      99: aload_0
     100: getfield      #6                  // Field serverLoginContext:Ljavax/security/auth/login/LoginContext;
     103: invokevirtual #105                // Method javax/security/auth/login/LoginContext.logout:()V
     106: aload         6
     108: areturn
     109: astore        7
     111: aload_0
     112: getfield      #6                  // Field serverLoginContext:Ljavax/security/auth/login/LoginContext;
     115: ifnull        125
     118: aload_0
     119: getfield      #6                  // Field serverLoginContext:Ljavax/security/auth/login/LoginContext;
     122: invokevirtual #105                // Method javax/security/auth/login/LoginContext.logout:()V
     125: aload         7
     127: athrow
    Exception table:
       from    to  target type
          64    92   109   any
         109   111   109   any

  protected java.security.Principal createIdentity(java.lang.String) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #20                 // Field removeRealmFromPrincipal:Z
       4: ifeq          23
       7: aload_0
       8: aload_1
       9: iconst_0
      10: aload_1
      11: ldc           #106                // String @
      13: invokevirtual #107                // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      16: invokevirtual #108                // Method java/lang/String.substring:(II)Ljava/lang/String;
      19: invokespecial #109                // Method org/jboss/security/negotiation/common/CommonLoginModule.createIdentity:(Ljava/lang/String;)Ljava/security/Principal;
      22: areturn
      23: aload_0
      24: aload_1
      25: invokespecial #109                // Method org/jboss/security/negotiation/common/CommonLoginModule.createIdentity:(Ljava/lang/String;)Ljava/security/Principal;
      28: areturn

  protected java.security.acl.Group[] getRoleSets() throws javax.security.auth.login.LoginException;
    Code:
       0: new           #110                // class org/jboss/security/SimpleGroup
       3: dup
       4: ldc           #111                // String Roles
       6: invokespecial #112                // Method org/jboss/security/SimpleGroup."<init>":(Ljava/lang/String;)V
       9: astore_1
      10: new           #110                // class org/jboss/security/SimpleGroup
      13: dup
      14: ldc           #113                // String CallerPrincipal
      16: invokespecial #112                // Method org/jboss/security/SimpleGroup."<init>":(Ljava/lang/String;)V
      19: astore_2
      20: iconst_2
      21: anewarray     #114                // class java/security/acl/Group
      24: dup
      25: iconst_0
      26: aload_1
      27: aastore
      28: dup
      29: iconst_1
      30: aload_2
      31: aastore
      32: astore_3
      33: aload_2
      34: aload_0
      35: invokevirtual #46                 // Method getIdentity:()Ljava/security/Principal;
      38: invokeinterface #115,  2          // InterfaceMethod java/security/acl/Group.addMember:(Ljava/security/Principal;)Z
      43: pop
      44: aload_3
      45: areturn

  protected javax.security.auth.Subject getServerSubject() throws javax.security.auth.login.LoginException;
    Code:
       0: new           #80                 // class javax/security/auth/login/LoginContext
       3: dup
       4: aload_0
       5: getfield      #14                 // Field serverSecurityDomain:Ljava/lang/String;
       8: invokespecial #116                // Method javax/security/auth/login/LoginContext."<init>":(Ljava/lang/String;)V
      11: astore_1
      12: aload_1
      13: invokevirtual #83                 // Method javax/security/auth/login/LoginContext.login:()V
      16: aload_0
      17: aload_1
      18: putfield      #6                  // Field serverLoginContext:Ljavax/security/auth/login/LoginContext;
      21: aload_0
      22: getfield      #6                  // Field serverLoginContext:Ljavax/security/auth/login/LoginContext;
      25: invokevirtual #84                 // Method javax/security/auth/login/LoginContext.getSubject:()Ljavax/security/auth/Subject;
      28: astore_2
      29: aload_0
      30: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
      33: invokevirtual #24                 // Method org/jboss/logging/Logger.isDebugEnabled:()Z
      36: ifeq          99
      39: aload_0
      40: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
      43: new           #25                 // class java/lang/StringBuilder
      46: dup
      47: invokespecial #26                 // Method java/lang/StringBuilder."<init>":()V
      50: ldc           #117                // String Subject =
      52: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      55: aload_2
      56: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      59: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      62: invokevirtual #31                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
      65: aload_0
      66: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
      69: new           #25                 // class java/lang/StringBuilder
      72: dup
      73: invokespecial #26                 // Method java/lang/StringBuilder."<init>":()V
      76: ldc           #118                // String Logged in \'
      78: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      81: aload_0
      82: getfield      #14                 // Field serverSecurityDomain:Ljava/lang/String;
      85: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      88: ldc           #119                // String \' LoginContext
      90: invokevirtual #28                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      93: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      96: invokevirtual #31                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
      99: aload_2
     100: areturn

  static org.jboss.logging.Logger access$000(org.jboss.security.negotiation.spnego.SPNEGOLoginModule);
    Code:
       0: aload_0
       1: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
       4: areturn

  static org.ietf.jgss.Oid access$100();
    Code:
       0: getstatic     #4                  // Field kerberos:Lorg/ietf/jgss/Oid;
       3: areturn

  static org.jboss.logging.Logger access$200(org.jboss.security.negotiation.spnego.SPNEGOLoginModule);
    Code:
       0: aload_0
       1: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
       4: areturn

  static org.jboss.logging.Logger access$300(org.jboss.security.negotiation.spnego.SPNEGOLoginModule);
    Code:
       0: aload_0
       1: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
       4: areturn

  static void access$400(org.jboss.security.negotiation.spnego.SPNEGOLoginModule, java.security.Principal);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #3                  // Method setIdentity:(Ljava/security/Principal;)V
       5: return

  static org.jboss.logging.Logger access$500(org.jboss.security.negotiation.spnego.SPNEGOLoginModule);
    Code:
       0: aload_0
       1: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
       4: areturn

  static org.jboss.logging.Logger access$600(org.jboss.security.negotiation.spnego.SPNEGOLoginModule);
    Code:
       0: aload_0
       1: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
       4: areturn

  static org.jboss.logging.Logger access$700(org.jboss.security.negotiation.spnego.SPNEGOLoginModule);
    Code:
       0: aload_0
       1: getfield      #2                  // Field log:Lorg/jboss/logging/Logger;
       4: areturn

  static org.ietf.jgss.GSSCredential access$802(org.jboss.security.negotiation.spnego.SPNEGOLoginModule, org.ietf.jgss.GSSCredential);
    Code:
       0: aload_0
       1: aload_1
       2: dup_x1
       3: putfield      #1                  // Field delegatedCredential:Lorg/ietf/jgss/GSSCredential;
       6: areturn

  static {};
    Code:
       0: iconst_3
       1: anewarray     #13                 // class java/lang/String
       4: dup
       5: iconst_0
       6: ldc           #17                 // String removeRealmFromPrincipal
       8: aastore
       9: dup
      10: iconst_1
      11: ldc           #11                 // String serverSecurityDomain
      13: aastore
      14: dup
      15: iconst_2
      16: ldc           #15                 // String usernamePasswordDomain
      18: aastore
      19: putstatic     #7                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
      22: getstatic     #120                // Field org/jboss/security/negotiation/Constants.KERBEROS_V5:Lorg/ietf/jgss/Oid;
      25: putstatic     #4                  // Field kerberos:Lorg/ietf/jgss/Oid;
      28: return
}
