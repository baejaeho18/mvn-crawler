Compiled from "SPNEGOLoginModule.java"
class org.jboss.security.negotiation.spnego.SPNEGOLoginModule$AcceptSecContext implements java.security.PrivilegedAction {
  private final org.jboss.security.negotiation.common.NegotiationContext negotiationContext;

  private boolean DEBUG;

  final org.jboss.security.negotiation.spnego.SPNEGOLoginModule this$0;

  public org.jboss.security.negotiation.spnego.SPNEGOLoginModule$AcceptSecContext(org.jboss.security.negotiation.spnego.SPNEGOLoginModule, org.jboss.security.negotiation.common.NegotiationContext);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #2                  // Field this$0:Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;
       5: aload_0
       6: invokespecial #3                  // Method java/lang/Object."<init>":()V
       9: aload_0
      10: aload_0
      11: getfield      #2                  // Field this$0:Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;
      14: invokestatic  #4                  // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$000:(Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;)Lorg/jboss/logging/Logger;
      17: invokevirtual #5                  // Method org/jboss/logging/Logger.isDebugEnabled:()Z
      20: putfield      #6                  // Field DEBUG:Z
      23: aload_0
      24: aload_2
      25: putfield      #7                  // Field negotiationContext:Lorg/jboss/security/negotiation/common/NegotiationContext;
      28: return

  public java.lang.Object run();
    Code:
       0: aload_0
       1: getfield      #7                  // Field negotiationContext:Lorg/jboss/security/negotiation/common/NegotiationContext;
       4: invokevirtual #8                  // Method org/jboss/security/negotiation/common/NegotiationContext.getRequestMessage:()Lorg/jboss/security/negotiation/NegotiationMessage;
       7: astore_1
       8: aconst_null
       9: astore_2
      10: aload_1
      11: instanceof    #9                  // class org/jboss/security/negotiation/spnego/encoding/NegTokenInit
      14: ifeq          161
      17: aload_1
      18: checkcast     #9                  // class org/jboss/security/negotiation/spnego/encoding/NegTokenInit
      21: astore_3
      22: aload_3
      23: invokevirtual #10                 // Method org/jboss/security/negotiation/spnego/encoding/NegTokenInit.getMechTypes:()Ljava/util/List;
      26: astore        4
      28: aload         4
      30: iconst_0
      31: invokeinterface #11,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      36: checkcast     #12                 // class org/ietf/jgss/Oid
      39: invokestatic  #13                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$100:()Lorg/ietf/jgss/Oid;
      42: invokevirtual #14                 // Method org/ietf/jgss/Oid.equals:(Ljava/lang/Object;)Z
      45: ifeq          56
      48: aload_3
      49: invokevirtual #15                 // Method org/jboss/security/negotiation/spnego/encoding/NegTokenInit.getMechToken:()[B
      52: astore_2
      53: goto          158
      56: iconst_0
      57: istore        5
      59: aload         4
      61: invokeinterface #16,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      66: astore        6
      68: aload         6
      70: invokeinterface #17,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      75: ifeq          104
      78: iload         5
      80: ifne          104
      83: aload         6
      85: invokeinterface #18,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      90: checkcast     #12                 // class org/ietf/jgss/Oid
      93: invokestatic  #13                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$100:()Lorg/ietf/jgss/Oid;
      96: invokevirtual #14                 // Method org/ietf/jgss/Oid.equals:(Ljava/lang/Object;)Z
      99: istore        5
     101: goto          68
     104: new           #19                 // class org/jboss/security/negotiation/spnego/encoding/NegTokenTarg
     107: dup
     108: invokespecial #20                 // Method org/jboss/security/negotiation/spnego/encoding/NegTokenTarg."<init>":()V
     111: astore        7
     113: iload         5
     115: ifeq          137
     118: aload         7
     120: getstatic     #21                 // Field org/jboss/security/negotiation/spnego/encoding/NegTokenTarg.ACCEPT_INCOMPLETE:Ljava/lang/Integer;
     123: invokevirtual #22                 // Method org/jboss/security/negotiation/spnego/encoding/NegTokenTarg.setNegResult:(Ljava/lang/Integer;)V
     126: aload         7
     128: invokestatic  #13                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$100:()Lorg/ietf/jgss/Oid;
     131: invokevirtual #23                 // Method org/jboss/security/negotiation/spnego/encoding/NegTokenTarg.setSupportedMech:(Lorg/ietf/jgss/Oid;)V
     134: goto          145
     137: aload         7
     139: getstatic     #24                 // Field org/jboss/security/negotiation/spnego/encoding/NegTokenTarg.REJECTED:Ljava/lang/Integer;
     142: invokevirtual #22                 // Method org/jboss/security/negotiation/spnego/encoding/NegTokenTarg.setNegResult:(Ljava/lang/Integer;)V
     145: aload_0
     146: getfield      #7                  // Field negotiationContext:Lorg/jboss/security/negotiation/common/NegotiationContext;
     149: aload         7
     151: invokevirtual #25                 // Method org/jboss/security/negotiation/common/NegotiationContext.setResponseMessage:(Lorg/jboss/security/negotiation/NegotiationMessage;)V
     154: getstatic     #26                 // Field java/lang/Boolean.FALSE:Ljava/lang/Boolean;
     157: areturn
     158: goto          198
     161: aload_1
     162: instanceof    #19                 // class org/jboss/security/negotiation/spnego/encoding/NegTokenTarg
     165: ifeq          181
     168: aload_1
     169: checkcast     #19                 // class org/jboss/security/negotiation/spnego/encoding/NegTokenTarg
     172: astore_3
     173: aload_3
     174: invokevirtual #27                 // Method org/jboss/security/negotiation/spnego/encoding/NegTokenTarg.getResponseToken:()[B
     177: astore_2
     178: goto          198
     181: aload_1
     182: instanceof    #28                 // class org/jboss/security/negotiation/spnego/KerberosMessage
     185: ifeq          198
     188: aload_1
     189: checkcast     #28                 // class org/jboss/security/negotiation/spnego/KerberosMessage
     192: astore_3
     193: aload_3
     194: invokevirtual #29                 // Method org/jboss/security/negotiation/spnego/KerberosMessage.getToken:()[B
     197: astore_2
     198: aload_0
     199: getfield      #7                  // Field negotiationContext:Lorg/jboss/security/negotiation/common/NegotiationContext;
     202: invokevirtual #30                 // Method org/jboss/security/negotiation/common/NegotiationContext.getSchemeContext:()Ljava/lang/Object;
     205: astore_3
     206: aload_3
     207: ifnull        227
     210: aload_3
     211: instanceof    #31                 // class org/ietf/jgss/GSSContext
     214: ifne          227
     217: new           #32                 // class java/lang/IllegalStateException
     220: dup
     221: ldc           #33                 // String The schemeContext is not a GSSContext
     223: invokespecial #34                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     226: athrow
     227: aload_3
     228: checkcast     #31                 // class org/ietf/jgss/GSSContext
     231: astore        4
     233: aload         4
     235: ifnonnull     275
     238: aload_0
     239: getfield      #2                  // Field this$0:Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;
     242: invokestatic  #35                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$200:(Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;)Lorg/jboss/logging/Logger;
     245: ldc           #36                 // String Creating new GSSContext.
     247: invokevirtual #37                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
     250: invokestatic  #38                 // Method org/ietf/jgss/GSSManager.getInstance:()Lorg/ietf/jgss/GSSManager;
     253: astore        5
     255: aload         5
     257: aconst_null
     258: checkcast     #39                 // class org/ietf/jgss/GSSCredential
     261: invokevirtual #40                 // Method org/ietf/jgss/GSSManager.createContext:(Lorg/ietf/jgss/GSSCredential;)Lorg/ietf/jgss/GSSContext;
     264: astore        4
     266: aload_0
     267: getfield      #7                  // Field negotiationContext:Lorg/jboss/security/negotiation/common/NegotiationContext;
     270: aload         4
     272: invokevirtual #41                 // Method org/jboss/security/negotiation/common/NegotiationContext.setSchemeContext:(Ljava/lang/Object;)V
     275: aload         4
     277: invokeinterface #42,  1           // InterfaceMethod org/ietf/jgss/GSSContext.isEstablished:()Z
     282: ifeq          307
     285: aload_0
     286: getfield      #2                  // Field this$0:Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;
     289: invokestatic  #43                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$300:(Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;)Lorg/jboss/logging/Logger;
     292: ldc           #44                 // String Authentication was performed despite already being authenticated!
     294: invokevirtual #45                 // Method org/jboss/logging/Logger.warn:(Ljava/lang/Object;)V
     297: aload_0
     298: aload         4
     300: invokespecial #46                 // Method processIdentity:(Lorg/ietf/jgss/GSSContext;)V
     303: getstatic     #47                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
     306: areturn
     307: aload_2
     308: ifnull        382
     311: aload         4
     313: aload_2
     314: iconst_0
     315: aload_2
     316: arraylength
     317: invokeinterface #48,  4           // InterfaceMethod org/ietf/jgss/GSSContext.acceptSecContext:([BII)[B
     322: astore        5
     324: aload         5
     326: ifnull        382
     329: aload_1
     330: instanceof    #28                 // class org/jboss/security/negotiation/spnego/KerberosMessage
     333: ifeq          353
     336: new           #28                 // class org/jboss/security/negotiation/spnego/KerberosMessage
     339: dup
     340: getstatic     #49                 // Field org/jboss/security/negotiation/Constants.KERBEROS_V5:Lorg/ietf/jgss/Oid;
     343: aload         5
     345: invokespecial #50                 // Method org/jboss/security/negotiation/spnego/KerberosMessage."<init>":(Lorg/ietf/jgss/Oid;[B)V
     348: astore        6
     350: goto          373
     353: new           #19                 // class org/jboss/security/negotiation/spnego/encoding/NegTokenTarg
     356: dup
     357: invokespecial #20                 // Method org/jboss/security/negotiation/spnego/encoding/NegTokenTarg."<init>":()V
     360: astore        7
     362: aload         7
     364: aload         5
     366: invokevirtual #51                 // Method org/jboss/security/negotiation/spnego/encoding/NegTokenTarg.setResponseToken:([B)V
     369: aload         7
     371: astore        6
     373: aload_0
     374: getfield      #7                  // Field negotiationContext:Lorg/jboss/security/negotiation/common/NegotiationContext;
     377: aload         6
     379: invokevirtual #25                 // Method org/jboss/security/negotiation/common/NegotiationContext.setResponseMessage:(Lorg/jboss/security/negotiation/NegotiationMessage;)V
     382: aload         4
     384: invokeinterface #42,  1           // InterfaceMethod org/ietf/jgss/GSSContext.isEstablished:()Z
     389: ifne          396
     392: getstatic     #26                 // Field java/lang/Boolean.FALSE:Ljava/lang/Boolean;
     395: areturn
     396: aload_0
     397: aload         4
     399: invokespecial #46                 // Method processIdentity:(Lorg/ietf/jgss/GSSContext;)V
     402: getstatic     #47                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
     405: areturn
     406: astore_1
     407: aload_1
     408: areturn
    Exception table:
       from    to  target type
           0   157   406   Class java/lang/Exception
         158   306   406   Class java/lang/Exception
         307   395   406   Class java/lang/Exception
         396   405   406   Class java/lang/Exception

  private void processIdentity(org.ietf.jgss.GSSContext) throws org.ietf.jgss.GSSException, java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #2                  // Field this$0:Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;
       4: aload_0
       5: getfield      #2                  // Field this$0:Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;
       8: aload_1
       9: invokeinterface #53,  1           // InterfaceMethod org/ietf/jgss/GSSContext.getSrcName:()Lorg/ietf/jgss/GSSName;
      14: invokeinterface #54,  1           // InterfaceMethod org/ietf/jgss/GSSName.toString:()Ljava/lang/String;
      19: invokevirtual #55                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.createIdentity:(Ljava/lang/String;)Ljava/security/Principal;
      22: invokestatic  #56                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$400:(Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;Ljava/security/Principal;)V
      25: aload_0
      26: getfield      #6                  // Field DEBUG:Z
      29: ifeq          139
      32: aload_0
      33: getfield      #2                  // Field this$0:Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;
      36: invokestatic  #57                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$500:(Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;)Lorg/jboss/logging/Logger;
      39: new           #58                 // class java/lang/StringBuilder
      42: dup
      43: invokespecial #59                 // Method java/lang/StringBuilder."<init>":()V
      46: ldc           #60                 // String context.getCredDelegState() =
      48: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      51: aload_1
      52: invokeinterface #62,  1           // InterfaceMethod org/ietf/jgss/GSSContext.getCredDelegState:()Z
      57: invokevirtual #63                 // Method java/lang/StringBuilder.append:(Z)Ljava/lang/StringBuilder;
      60: invokevirtual #64                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      63: invokevirtual #37                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
      66: aload_0
      67: getfield      #2                  // Field this$0:Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;
      70: invokestatic  #65                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$600:(Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;)Lorg/jboss/logging/Logger;
      73: new           #58                 // class java/lang/StringBuilder
      76: dup
      77: invokespecial #59                 // Method java/lang/StringBuilder."<init>":()V
      80: ldc           #66                 // String context.getMutualAuthState() =
      82: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      85: aload_1
      86: invokeinterface #67,  1           // InterfaceMethod org/ietf/jgss/GSSContext.getMutualAuthState:()Z
      91: invokevirtual #63                 // Method java/lang/StringBuilder.append:(Z)Ljava/lang/StringBuilder;
      94: invokevirtual #64                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      97: invokevirtual #37                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
     100: aload_0
     101: getfield      #2                  // Field this$0:Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;
     104: invokestatic  #68                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$700:(Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;)Lorg/jboss/logging/Logger;
     107: new           #58                 // class java/lang/StringBuilder
     110: dup
     111: invokespecial #59                 // Method java/lang/StringBuilder."<init>":()V
     114: ldc           #69                 // String context.getSrcName() =
     116: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     119: aload_1
     120: invokeinterface #53,  1           // InterfaceMethod org/ietf/jgss/GSSContext.getSrcName:()Lorg/ietf/jgss/GSSName;
     125: invokeinterface #54,  1           // InterfaceMethod org/ietf/jgss/GSSName.toString:()Ljava/lang/String;
     130: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     133: invokevirtual #64                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     136: invokevirtual #37                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
     139: aload_1
     140: invokeinterface #62,  1           // InterfaceMethod org/ietf/jgss/GSSContext.getCredDelegState:()Z
     145: ifeq          162
     148: aload_0
     149: getfield      #2                  // Field this$0:Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;
     152: aload_1
     153: invokeinterface #70,  1           // InterfaceMethod org/ietf/jgss/GSSContext.getDelegCred:()Lorg/ietf/jgss/GSSCredential;
     158: invokestatic  #71                 // Method org/jboss/security/negotiation/spnego/SPNEGOLoginModule.access$802:(Lorg/jboss/security/negotiation/spnego/SPNEGOLoginModule;Lorg/ietf/jgss/GSSCredential;)Lorg/ietf/jgss/GSSCredential;
     161: pop
     162: aload_0
     163: getfield      #7                  // Field negotiationContext:Lorg/jboss/security/negotiation/common/NegotiationContext;
     166: ldc           #72                 // String SPNEGO
     168: invokevirtual #73                 // Method org/jboss/security/negotiation/common/NegotiationContext.setAuthenticationMethod:(Ljava/lang/String;)V
     171: aload_0
     172: getfield      #7                  // Field negotiationContext:Lorg/jboss/security/negotiation/common/NegotiationContext;
     175: iconst_1
     176: invokevirtual #74                 // Method org/jboss/security/negotiation/common/NegotiationContext.setAuthenticated:(Z)V
     179: return
}
