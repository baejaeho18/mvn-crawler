Compiled from "AdvancedADLoginModule.java"
public class org.jboss.security.negotiation.AdvancedADLoginModule extends org.jboss.security.negotiation.AdvancedLdapLoginModule {
  private static final java.lang.String PRIMARY_GROUP_ID;

  private static final java.lang.String OBJECT_SID;

  private boolean skipPrimaryGroupSearch;

  public org.jboss.security.negotiation.AdvancedADLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jboss/security/negotiation/AdvancedLdapLoginModule."<init>":()V
       4: aload_0
       5: iconst_0
       6: putfield      #2                  // Field skipPrimaryGroupSearch:Z
       9: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map, java.util.Map);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: invokespecial #3                  // Method org/jboss/security/negotiation/AdvancedLdapLoginModule.initialize:(Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;Ljava/util/Map;Ljava/util/Map;)V
       9: return

  protected java.util.Properties createBaseProperties();
    Code:
       0: aload_0
       1: invokespecial #4                  // Method org/jboss/security/negotiation/AdvancedLdapLoginModule.createBaseProperties:()Ljava/util/Properties;
       4: astore_1
       5: aload_1
       6: ldc           #5                  // String java.naming.ldap.attributes.binary
       8: ldc           #7                  // String objectSid
      10: invokevirtual #8                  // Method java/util/Properties.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      13: pop
      14: aload_1
      15: areturn

  protected void rolesSearch(javax.naming.ldap.LdapContext, java.lang.String) throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #9                  // Field log:Lorg/jboss/logging/Logger;
       4: invokevirtual #10                 // Method org/jboss/logging/Logger.isTraceEnabled:()Z
       7: istore_3
       8: aload_0
       9: getfield      #2                  // Field skipPrimaryGroupSearch:Z
      12: ifne          430
      15: aload_0
      16: iconst_1
      17: putfield      #2                  // Field skipPrimaryGroupSearch:Z
      20: iconst_2
      21: anewarray     #11                 // class java/lang/String
      24: dup
      25: iconst_0
      26: ldc           #7                  // String objectSid
      28: aastore
      29: dup
      30: iconst_1
      31: ldc           #12                 // String primaryGroupID
      33: aastore
      34: astore        4
      36: aload_1
      37: aload_2
      38: aload         4
      40: invokeinterface #13,  3           // InterfaceMethod javax/naming/ldap/LdapContext.getAttributes:(Ljava/lang/String;[Ljava/lang/String;)Ljavax/naming/directory/Attributes;
      45: astore        5
      47: aload         5
      49: ldc           #12                 // String primaryGroupID
      51: invokeinterface #14,  2           // InterfaceMethod javax/naming/directory/Attributes.get:(Ljava/lang/String;)Ljavax/naming/directory/Attribute;
      56: astore        6
      58: aload         5
      60: ldc           #7                  // String objectSid
      62: invokeinterface #14,  2           // InterfaceMethod javax/naming/directory/Attributes.get:(Ljava/lang/String;)Ljavax/naming/directory/Attribute;
      67: astore        7
      69: aload         6
      71: ifnull        369
      74: aload         7
      76: ifnull        369
      79: aload         6
      81: invokeinterface #15,  1           // InterfaceMethod javax/naming/directory/Attribute.get:()Ljava/lang/Object;
      86: checkcast     #11                 // class java/lang/String
      89: invokestatic  #16                 // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
      92: istore        8
      94: aload         7
      96: invokeinterface #15,  1           // InterfaceMethod javax/naming/directory/Attribute.get:()Ljava/lang/Object;
     101: checkcast     #17                 // class "[B"
     104: checkcast     #17                 // class "[B"
     107: astore        9
     109: aload         9
     111: arraylength
     112: newarray       byte
     114: astore        10
     116: aload         9
     118: iconst_0
     119: aload         10
     121: iconst_0
     122: aload         9
     124: arraylength
     125: iconst_4
     126: isub
     127: invokestatic  #18                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     130: aload         10
     132: aload         9
     134: arraylength
     135: iconst_4
     136: isub
     137: iconst_4
     138: invokestatic  #19                 // Method java/nio/ByteBuffer.wrap:([BII)Ljava/nio/ByteBuffer;
     141: astore        11
     143: aload         11
     145: getstatic     #20                 // Field java/nio/ByteOrder.LITTLE_ENDIAN:Ljava/nio/ByteOrder;
     148: invokevirtual #21                 // Method java/nio/ByteBuffer.order:(Ljava/nio/ByteOrder;)Ljava/nio/ByteBuffer;
     151: pop
     152: aload         11
     154: iload         8
     156: invokevirtual #22                 // Method java/nio/ByteBuffer.putInt:(I)Ljava/nio/ByteBuffer;
     159: pop
     160: iload_3
     161: ifeq          225
     164: aload         9
     166: invokestatic  #23                 // Method org/picketbox/commons/cipher/Base64.encodeBytes:([B)Ljava/lang/String;
     169: astore        12
     171: aload         10
     173: invokestatic  #23                 // Method org/picketbox/commons/cipher/Base64.encodeBytes:([B)Ljava/lang/String;
     176: astore        13
     178: aload_0
     179: getfield      #9                  // Field log:Lorg/jboss/logging/Logger;
     182: new           #24                 // class java/lang/StringBuilder
     185: dup
     186: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
     189: ldc           #26                 // String Using base objectSid
     191: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     194: aload         12
     196: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     199: ldc           #28                 // String  and replaced with primary group id
     201: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     204: iload         8
     206: invokevirtual #29                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     209: ldc           #30                 // String  to create new search objectSid
     211: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     214: aload         13
     216: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     219: invokevirtual #31                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     222: invokevirtual #32                 // Method org/jboss/logging/Logger.trace:(Ljava/lang/Object;)V
     225: ldc           #33                 // String (objectSid={0})
     227: astore        12
     229: iconst_1
     230: anewarray     #34                 // class java/lang/Object
     233: dup
     234: iconst_0
     235: aload         10
     237: aastore
     238: astore        13
     240: aload_1
     241: aload_0
     242: getfield      #35                 // Field baseCtxDN:Ljava/lang/String;
     245: aload         12
     247: aload         13
     249: aload_0
     250: getfield      #36                 // Field roleSearchControls:Ljavax/naming/directory/SearchControls;
     253: invokeinterface #37,  5           // InterfaceMethod javax/naming/ldap/LdapContext.search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;Ljavax/naming/directory/SearchControls;)Ljavax/naming/NamingEnumeration;
     258: astore        14
     260: aload         14
     262: invokeinterface #38,  1           // InterfaceMethod javax/naming/NamingEnumeration.hasMore:()Z
     267: iconst_1
     268: if_icmpne     366
     271: aload         14
     273: invokeinterface #39,  1           // InterfaceMethod javax/naming/NamingEnumeration.next:()Ljava/lang/Object;
     278: checkcast     #40                 // class javax/naming/directory/SearchResult
     281: astore        15
     283: aload_0
     284: aload         15
     286: invokevirtual #41                 // Method javax/naming/directory/SearchResult.getName:()Ljava/lang/String;
     289: invokevirtual #42                 // Method canonicalize:(Ljava/lang/String;)Ljava/lang/String;
     292: astore        16
     294: new           #24                 // class java/lang/StringBuilder
     297: dup
     298: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
     301: ldc           #43                 // String \"
     303: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     306: aload         16
     308: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     311: ldc           #43                 // String \"
     313: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     316: invokevirtual #31                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     319: astore        17
     321: iload_3
     322: ifeq          352
     325: aload_0
     326: getfield      #9                  // Field log:Lorg/jboss/logging/Logger;
     329: new           #24                 // class java/lang/StringBuilder
     332: dup
     333: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
     336: ldc           #44                 // String Search found primary group
     338: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     341: aload         17
     343: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     346: invokevirtual #31                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     349: invokevirtual #32                 // Method org/jboss/logging/Logger.trace:(Ljava/lang/Object;)V
     352: aload_0
     353: aload_1
     354: aload         17
     356: invokevirtual #45                 // Method loadRoleByRoleNameAttributeID:(Ljavax/naming/ldap/LdapContext;Ljava/lang/String;)V
     359: aload_0
     360: aload_1
     361: aload         16
     363: invokevirtual #46                 // Method recurseRolesSearch:(Ljavax/naming/ldap/LdapContext;Ljava/lang/String;)V
     366: goto          378
     369: aload_0
     370: getfield      #9                  // Field log:Lorg/jboss/logging/Logger;
     373: ldc           #47                 // String primaryGroupIdAttribute or objectSidAttribute was null, skipping primary group search.
     375: invokevirtual #32                 // Method org/jboss/logging/Logger.trace:(Ljava/lang/Object;)V
     378: aload_0
     379: aload_1
     380: aload_2
     381: invokespecial #48                 // Method org/jboss/security/negotiation/AdvancedLdapLoginModule.rolesSearch:(Ljavax/naming/ldap/LdapContext;Ljava/lang/String;)V
     384: aload_0
     385: iconst_0
     386: putfield      #2                  // Field skipPrimaryGroupSearch:Z
     389: goto          427
     392: astore        4
     394: iload_3
     395: ifeq          409
     398: aload_0
     399: getfield      #9                  // Field log:Lorg/jboss/logging/Logger;
     402: ldc           #50                 // String Failed to load primary group
     404: aload         4
     406: invokevirtual #51                 // Method org/jboss/logging/Logger.trace:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     409: aload_0
     410: iconst_0
     411: putfield      #2                  // Field skipPrimaryGroupSearch:Z
     414: goto          427
     417: astore        18
     419: aload_0
     420: iconst_0
     421: putfield      #2                  // Field skipPrimaryGroupSearch:Z
     424: aload         18
     426: athrow
     427: goto          436
     430: aload_0
     431: aload_1
     432: aload_2
     433: invokespecial #48                 // Method org/jboss/security/negotiation/AdvancedLdapLoginModule.rolesSearch:(Ljavax/naming/ldap/LdapContext;Ljava/lang/String;)V
     436: return
    Exception table:
       from    to  target type
          20   384   392   Class javax/naming/NamingException
          20   384   417   any
         392   409   417   any
         417   419   417   any
}
