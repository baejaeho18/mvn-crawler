Compiled from "UsernameTokenProcessor.java"
public class org.apache.wss4j.dom.processor.UsernameTokenProcessor implements org.apache.wss4j.dom.processor.Processor {
  private static final org.slf4j.Logger LOG;

  public org.apache.wss4j.dom.processor.UsernameTokenProcessor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult> handleToken(org.w3c.dom.Element, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
       3: invokeinterface #3,  1            // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
       8: ifeq          21
      11: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
      14: ldc           #4                  // String Found UsernameToken list element
      16: invokeinterface #5,  2            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      21: aload_1
      22: ldc           #6                  // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      24: ldc           #7                  // String Id
      26: invokeinterface #8,  3            // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      31: astore        4
      33: ldc           #9                  // String
      35: aload         4
      37: invokevirtual #10                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      40: ifne          92
      43: aload_3
      44: aload         4
      46: invokevirtual #11                 // Method org/apache/wss4j/dom/WSDocInfo.getTokenElement:(Ljava/lang/String;)Lorg/w3c/dom/Element;
      49: astore        5
      51: aload_1
      52: aload         5
      54: invokevirtual #12                 // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
      57: ifeq          74
      60: aload_3
      61: aload         4
      63: invokevirtual #13                 // Method org/apache/wss4j/dom/WSDocInfo.getResult:(Ljava/lang/String;)Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;
      66: astore        6
      68: aload         6
      70: invokestatic  #14                 // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
      73: areturn
      74: aload         5
      76: ifnull        92
      79: new           #15                 // class org/apache/wss4j/common/ext/WSSecurityException
      82: dup
      83: getstatic     #16                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      86: ldc           #17                 // String duplicateError
      88: invokespecial #18                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      91: athrow
      92: aload_2
      93: getstatic     #19                 // Field org/apache/wss4j/dom/WSConstants.USERNAME_TOKEN:Ljavax/xml/namespace/QName;
      96: invokevirtual #20                 // Method org/apache/wss4j/dom/handler/RequestData.getValidator:(Ljavax/xml/namespace/QName;)Lorg/apache/wss4j/dom/validate/Validator;
      99: astore        5
     101: aload_0
     102: aload_1
     103: aload         5
     105: aload_2
     106: invokespecial #21                 // Method handleUsernameToken:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/validate/Validator;Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/apache/wss4j/dom/validate/Credential;
     109: astore        6
     111: aload         6
     113: invokevirtual #22                 // Method org/apache/wss4j/dom/validate/Credential.getUsernametoken:()Lorg/apache/wss4j/dom/message/token/UsernameToken;
     116: astore        7
     118: iconst_1
     119: istore        8
     121: aconst_null
     122: astore        9
     124: aload         7
     126: invokevirtual #23                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getPassword:()Ljava/lang/String;
     129: ifnonnull     165
     132: sipush        8192
     135: istore        8
     137: aload         7
     139: invokevirtual #24                 // Method org/apache/wss4j/dom/message/token/UsernameToken.isDerivedKey:()Z
     142: ifeq          165
     145: aload         7
     147: aload_2
     148: invokevirtual #25                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     151: invokevirtual #26                 // Method org/apache/wss4j/dom/message/token/UsernameToken.setRawPassword:(Ljavax/security/auth/callback/CallbackHandler;)V
     154: aload         7
     156: aload_2
     157: invokevirtual #27                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     160: invokevirtual #28                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getDerivedKey:(Lorg/apache/wss4j/common/bsp/BSPEnforcer;)[B
     163: astore        9
     165: new           #29                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     168: dup
     169: iload         8
     171: aload         7
     173: invokespecial #30                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult."<init>":(ILorg/apache/wss4j/dom/message/token/UsernameToken;)V
     176: astore        10
     178: aload         7
     180: invokevirtual #31                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getID:()Ljava/lang/String;
     183: astore        11
     185: ldc           #9                  // String
     187: aload         11
     189: invokevirtual #10                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     192: ifne          205
     195: aload         10
     197: ldc           #32                 // String id
     199: aload         11
     201: invokevirtual #33                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     204: pop
     205: aload         10
     207: ldc           #34                 // String secret
     209: aload         9
     211: invokevirtual #33                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     214: pop
     215: aload         5
     217: ifnull        412
     220: aload         10
     222: ldc           #35                 // String validated-token
     224: getstatic     #36                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
     227: invokevirtual #33                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     230: pop
     231: aload         6
     233: invokevirtual #37                 // Method org/apache/wss4j/dom/validate/Credential.getTransformedToken:()Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
     236: ifnull        303
     239: aload         10
     241: ldc           #38                 // String transformed-token
     243: aload         6
     245: invokevirtual #37                 // Method org/apache/wss4j/dom/validate/Credential.getTransformedToken:()Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
     248: invokevirtual #33                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     251: pop
     252: aload         6
     254: invokevirtual #39                 // Method org/apache/wss4j/dom/validate/Credential.getPrincipal:()Ljava/security/Principal;
     257: ifnull        276
     260: aload         10
     262: ldc           #40                 // String principal
     264: aload         6
     266: invokevirtual #39                 // Method org/apache/wss4j/dom/validate/Credential.getPrincipal:()Ljava/security/Principal;
     269: invokevirtual #33                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     272: pop
     273: goto          399
     276: new           #41                 // class org/apache/wss4j/common/principal/SAMLTokenPrincipalImpl
     279: dup
     280: aload         6
     282: invokevirtual #37                 // Method org/apache/wss4j/dom/validate/Credential.getTransformedToken:()Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
     285: invokespecial #42                 // Method org/apache/wss4j/common/principal/SAMLTokenPrincipalImpl."<init>":(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)V
     288: astore        12
     290: aload         10
     292: ldc           #40                 // String principal
     294: aload         12
     296: invokevirtual #33                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     299: pop
     300: goto          399
     303: aload         6
     305: invokevirtual #39                 // Method org/apache/wss4j/dom/validate/Credential.getPrincipal:()Ljava/security/Principal;
     308: ifnull        327
     311: aload         10
     313: ldc           #40                 // String principal
     315: aload         6
     317: invokevirtual #39                 // Method org/apache/wss4j/dom/validate/Credential.getPrincipal:()Ljava/security/Principal;
     320: invokevirtual #33                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     323: pop
     324: goto          399
     327: new           #43                 // class org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl
     330: dup
     331: aload         7
     333: invokevirtual #44                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getName:()Ljava/lang/String;
     336: aload         7
     338: invokevirtual #45                 // Method org/apache/wss4j/dom/message/token/UsernameToken.isHashed:()Z
     341: invokespecial #46                 // Method org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl."<init>":(Ljava/lang/String;Z)V
     344: astore        12
     346: aload         12
     348: aload         7
     350: invokevirtual #47                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getNonce:()Ljava/lang/String;
     353: invokestatic  #48                 // Method org/apache/commons/codec/binary/Base64.decodeBase64:(Ljava/lang/String;)[B
     356: invokevirtual #49                 // Method org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl.setNonce:([B)V
     359: aload         12
     361: aload         7
     363: invokevirtual #23                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getPassword:()Ljava/lang/String;
     366: invokevirtual #50                 // Method org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl.setPassword:(Ljava/lang/String;)V
     369: aload         12
     371: aload         7
     373: invokevirtual #51                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getCreated:()Ljava/lang/String;
     376: invokevirtual #52                 // Method org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl.setCreatedTime:(Ljava/lang/String;)V
     379: aload         12
     381: aload         7
     383: invokevirtual #53                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getPasswordType:()Ljava/lang/String;
     386: invokevirtual #54                 // Method org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl.setPasswordType:(Ljava/lang/String;)V
     389: aload         10
     391: ldc           #40                 // String principal
     393: aload         12
     395: invokevirtual #33                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     398: pop
     399: aload         10
     401: ldc           #55                 // String subject
     403: aload         6
     405: invokevirtual #56                 // Method org/apache/wss4j/dom/validate/Credential.getSubject:()Ljavax/security/auth/Subject;
     408: invokevirtual #33                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     411: pop
     412: aload_3
     413: aload_1
     414: invokevirtual #57                 // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;)V
     417: aload_3
     418: aload         10
     420: invokevirtual #58                 // Method org/apache/wss4j/dom/WSDocInfo.addResult:(Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;)V
     423: aload         10
     425: invokestatic  #14                 // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
     428: areturn

  private org.apache.wss4j.dom.validate.Credential handleUsernameToken(org.w3c.dom.Element, org.apache.wss4j.dom.validate.Validator, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_3
       1: invokevirtual #59                 // Method org/apache/wss4j/dom/handler/RequestData.isAllowNamespaceQualifiedPasswordTypes:()Z
       4: istore        4
       6: aload_3
       7: invokevirtual #60                 // Method org/apache/wss4j/dom/handler/RequestData.getUtTTL:()I
      10: istore        5
      12: aload_3
      13: invokevirtual #61                 // Method org/apache/wss4j/dom/handler/RequestData.getUtFutureTTL:()I
      16: istore        6
      18: new           #62                 // class org/apache/wss4j/dom/message/token/UsernameToken
      21: dup
      22: aload_1
      23: iload         4
      25: aload_3
      26: invokevirtual #27                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
      29: invokespecial #63                 // Method org/apache/wss4j/dom/message/token/UsernameToken."<init>":(Lorg/w3c/dom/Element;ZLorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      32: astore        7
      34: aload_3
      35: invokevirtual #64                 // Method org/apache/wss4j/dom/handler/RequestData.getNonceReplayCache:()Lorg/apache/wss4j/common/cache/ReplayCache;
      38: astore        8
      40: aload         8
      42: ifnull        139
      45: aload         7
      47: invokevirtual #47                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getNonce:()Ljava/lang/String;
      50: ifnull        139
      53: aload         8
      55: aload         7
      57: invokevirtual #47                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getNonce:()Ljava/lang/String;
      60: invokeinterface #65,  2           // InterfaceMethod org/apache/wss4j/common/cache/ReplayCache.contains:(Ljava/lang/String;)Z
      65: ifeq          90
      68: new           #15                 // class org/apache/wss4j/common/ext/WSSecurityException
      71: dup
      72: getstatic     #66                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      75: ldc           #67                 // String badUsernameToken
      77: iconst_1
      78: anewarray     #68                 // class java/lang/Object
      81: dup
      82: iconst_0
      83: ldc           #69                 // String A replay attack has been detected
      85: aastore
      86: invokespecial #70                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
      89: athrow
      90: aload         7
      92: invokevirtual #71                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getCreatedDate:()Ljava/util/Date;
      95: astore        9
      97: aload         9
      99: ifnull        107
     102: iload         5
     104: ifgt          122
     107: aload         8
     109: aload         7
     111: invokevirtual #47                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getNonce:()Ljava/lang/String;
     114: invokeinterface #72,  2           // InterfaceMethod org/apache/wss4j/common/cache/ReplayCache.add:(Ljava/lang/String;)V
     119: goto          139
     122: aload         8
     124: aload         7
     126: invokevirtual #47                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getNonce:()Ljava/lang/String;
     129: iload         5
     131: i2l
     132: lconst_1
     133: ladd
     134: invokeinterface #73,  4           // InterfaceMethod org/apache/wss4j/common/cache/ReplayCache.add:(Ljava/lang/String;J)V
     139: aload         7
     141: iload         5
     143: iload         6
     145: invokevirtual #74                 // Method org/apache/wss4j/dom/message/token/UsernameToken.verifyCreated:(II)Z
     148: ifne          162
     151: new           #15                 // class org/apache/wss4j/common/ext/WSSecurityException
     154: dup
     155: getstatic     #75                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.MESSAGE_EXPIRED:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     158: invokespecial #76                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     161: athrow
     162: new           #77                 // class org/apache/wss4j/dom/validate/Credential
     165: dup
     166: invokespecial #78                 // Method org/apache/wss4j/dom/validate/Credential."<init>":()V
     169: astore        9
     171: aload         9
     173: aload         7
     175: invokevirtual #79                 // Method org/apache/wss4j/dom/validate/Credential.setUsernametoken:(Lorg/apache/wss4j/dom/message/token/UsernameToken;)V
     178: aload_2
     179: ifnull        192
     182: aload_2
     183: aload         9
     185: aload_3
     186: invokeinterface #80,  3           // InterfaceMethod org/apache/wss4j/dom/validate/Validator.validate:(Lorg/apache/wss4j/dom/validate/Credential;Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/apache/wss4j/dom/validate/Credential;
     191: areturn
     192: aload         9
     194: areturn

  static {};
    Code:
       0: ldc_w         #81                 // class org/apache/wss4j/dom/processor/UsernameTokenProcessor
       3: invokestatic  #82                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
       9: return
}
