Compiled from "SecurityContextTokenProcessor.java"
public class org.apache.wss4j.dom.processor.SecurityContextTokenProcessor implements org.apache.wss4j.dom.processor.Processor {
  public org.apache.wss4j.dom.processor.SecurityContextTokenProcessor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult> handleToken(org.w3c.dom.Element, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #2                  // class org/apache/wss4j/dom/message/token/SecurityContextToken
       3: dup
       4: aload_1
       5: invokespecial #3                  // Method org/apache/wss4j/dom/message/token/SecurityContextToken."<init>":(Lorg/w3c/dom/Element;)V
       8: astore        4
      10: aload_2
      11: new           #4                  // class javax/xml/namespace/QName
      14: dup
      15: aload_1
      16: invokeinterface #5,  1            // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      21: aload_1
      22: invokeinterface #6,  1            // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      27: invokespecial #7                  // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      30: invokevirtual #8                  // Method org/apache/wss4j/dom/handler/RequestData.getValidator:(Ljavax/xml/namespace/QName;)Lorg/apache/wss4j/dom/validate/Validator;
      33: astore        5
      35: new           #9                  // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
      38: dup
      39: sipush        1024
      42: aload         4
      44: invokespecial #10                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult."<init>":(ILorg/apache/wss4j/dom/message/token/SecurityContextToken;)V
      47: astore        6
      49: aload         5
      51: ifnull        136
      54: new           #11                 // class org/apache/wss4j/dom/validate/Credential
      57: dup
      58: invokespecial #12                 // Method org/apache/wss4j/dom/validate/Credential."<init>":()V
      61: astore        7
      63: aload         7
      65: aload         4
      67: invokevirtual #13                 // Method org/apache/wss4j/dom/validate/Credential.setSecurityContextToken:(Lorg/apache/wss4j/dom/message/token/SecurityContextToken;)V
      70: aload         5
      72: aload         7
      74: aload_2
      75: invokeinterface #14,  3           // InterfaceMethod org/apache/wss4j/dom/validate/Validator.validate:(Lorg/apache/wss4j/dom/validate/Credential;Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/apache/wss4j/dom/validate/Credential;
      80: astore        8
      82: aload         6
      84: ldc           #15                 // String validated-token
      86: getstatic     #16                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
      89: invokevirtual #17                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      92: pop
      93: aload         4
      95: invokevirtual #18                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getID:()Ljava/lang/String;
      98: astore        9
     100: ldc           #19                 // String
     102: aload         9
     104: invokevirtual #20                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     107: ifne          120
     110: aload         6
     112: ldc           #21                 // String id
     114: aload         9
     116: invokevirtual #17                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     119: pop
     120: aload         6
     122: ldc           #22                 // String secret
     124: aload         8
     126: invokevirtual #23                 // Method org/apache/wss4j/dom/validate/Credential.getSecretKey:()[B
     129: invokevirtual #17                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     132: pop
     133: goto          231
     136: aload         4
     138: invokevirtual #18                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getID:()Ljava/lang/String;
     141: astore        7
     143: aload         7
     145: invokestatic  #24                 // Method org/apache/wss4j/common/util/XMLUtils.getIDFromReference:(Ljava/lang/String;)Ljava/lang/String;
     148: astore        7
     150: aconst_null
     151: astore        8
     153: aload_0
     154: aload_2
     155: invokevirtual #25                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     158: aload         4
     160: invokevirtual #26                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getIdentifier:()Ljava/lang/String;
     163: invokespecial #27                 // Method getSecret:(Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;)[B
     166: astore        8
     168: goto          185
     171: astore        9
     173: aload_0
     174: aload_2
     175: invokevirtual #25                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     178: aload         7
     180: invokespecial #27                 // Method getSecret:(Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;)[B
     183: astore        8
     185: aload         8
     187: ifnull        196
     190: aload         8
     192: arraylength
     193: ifne          208
     196: aload_0
     197: aload_2
     198: invokevirtual #25                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     201: aload         7
     203: invokespecial #27                 // Method getSecret:(Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;)[B
     206: astore        8
     208: aload         6
     210: ldc           #21                 // String id
     212: aload         4
     214: invokevirtual #18                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getID:()Ljava/lang/String;
     217: invokevirtual #17                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     220: pop
     221: aload         6
     223: ldc           #22                 // String secret
     225: aload         8
     227: invokevirtual #17                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     230: pop
     231: aload_3
     232: aload_1
     233: invokevirtual #29                 // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;)V
     236: aload_3
     237: aload         6
     239: invokevirtual #30                 // Method org/apache/wss4j/dom/WSDocInfo.addResult:(Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;)V
     242: aload         6
     244: invokestatic  #31                 // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
     247: areturn
    Exception table:
       from    to  target type
         153   168   171   Class org/apache/wss4j/common/ext/WSSecurityException

  private byte[] getSecret(javax.security.auth.callback.CallbackHandler, java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnonnull     17
       4: new           #28                 // class org/apache/wss4j/common/ext/WSSecurityException
       7: dup
       8: getstatic     #32                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      11: ldc           #33                 // String noCallback
      13: invokespecial #34                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      16: athrow
      17: new           #35                 // class org/apache/wss4j/common/ext/WSPasswordCallback
      20: dup
      21: aload_2
      22: bipush        6
      24: invokespecial #36                 // Method org/apache/wss4j/common/ext/WSPasswordCallback."<init>":(Ljava/lang/String;I)V
      27: astore_3
      28: iconst_1
      29: anewarray     #37                 // class javax/security/auth/callback/Callback
      32: dup
      33: iconst_0
      34: aload_3
      35: aastore
      36: astore        4
      38: aload_1
      39: aload         4
      41: invokeinterface #38,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      46: goto          74
      49: astore        4
      51: new           #28                 // class org/apache/wss4j/common/ext/WSSecurityException
      54: dup
      55: getstatic     #32                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      58: aload         4
      60: ldc           #41                 // String noKey
      62: iconst_1
      63: anewarray     #42                 // class java/lang/Object
      66: dup
      67: iconst_0
      68: aload_2
      69: aastore
      70: invokespecial #43                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
      73: athrow
      74: aload_3
      75: invokevirtual #44                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getKey:()[B
      78: areturn
    Exception table:
       from    to  target type
          28    46    49   Class java/io/IOException
          28    46    49   Class javax/security/auth/callback/UnsupportedCallbackException
}
