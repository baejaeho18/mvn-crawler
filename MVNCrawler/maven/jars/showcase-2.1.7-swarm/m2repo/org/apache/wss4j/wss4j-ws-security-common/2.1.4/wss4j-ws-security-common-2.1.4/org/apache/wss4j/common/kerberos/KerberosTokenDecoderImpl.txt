Compiled from "KerberosTokenDecoderImpl.java"
public class org.apache.wss4j.common.kerberos.KerberosTokenDecoderImpl implements org.apache.wss4j.common.kerberos.KerberosTokenDecoder {
  private static final java.lang.String KERBEROS_OID;

  private byte[] serviceTicket;

  private javax.security.auth.Subject subject;

  private boolean decoded;

  private org.apache.directory.shared.kerberos.components.EncTicketPart encTicketPart;

  public org.apache.wss4j.common.kerberos.KerberosTokenDecoderImpl();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iconst_0
       6: putfield      #2                  // Field decoded:Z
       9: return

  public void clear();
    Code:
       0: aload_0
       1: aconst_null
       2: putfield      #3                  // Field serviceTicket:[B
       5: aload_0
       6: aconst_null
       7: putfield      #4                  // Field subject:Ljavax/security/auth/Subject;
      10: aload_0
      11: iconst_0
      12: putfield      #2                  // Field decoded:Z
      15: aload_0
      16: aconst_null
      17: putfield      #5                  // Field encTicketPart:Lorg/apache/directory/shared/kerberos/components/EncTicketPart;
      20: return

  public void setToken(byte[]);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #3                  // Field serviceTicket:[B
       5: return

  public void setSubject(javax.security.auth.Subject);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #4                  // Field subject:Ljavax/security/auth/Subject;
       5: return

  public byte[] getSessionKey() throws org.apache.wss4j.common.kerberos.KerberosTokenDecoderException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field decoded:Z
       4: ifne          11
       7: aload_0
       8: invokespecial #6                  // Method decodeServiceTicket:()V
      11: aload_0
      12: getfield      #5                  // Field encTicketPart:Lorg/apache/directory/shared/kerberos/components/EncTicketPart;
      15: ifnull        39
      18: aload_0
      19: getfield      #5                  // Field encTicketPart:Lorg/apache/directory/shared/kerberos/components/EncTicketPart;
      22: invokevirtual #7                  // Method org/apache/directory/shared/kerberos/components/EncTicketPart.getKey:()Lorg/apache/directory/shared/kerberos/components/EncryptionKey;
      25: ifnull        39
      28: aload_0
      29: getfield      #5                  // Field encTicketPart:Lorg/apache/directory/shared/kerberos/components/EncTicketPart;
      32: invokevirtual #7                  // Method org/apache/directory/shared/kerberos/components/EncTicketPart.getKey:()Lorg/apache/directory/shared/kerberos/components/EncryptionKey;
      35: invokevirtual #8                  // Method org/apache/directory/shared/kerberos/components/EncryptionKey.getKeyValue:()[B
      38: areturn
      39: aconst_null
      40: areturn

  public java.lang.String getClientPrincipalName() throws org.apache.wss4j.common.kerberos.KerberosTokenDecoderException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field decoded:Z
       4: ifne          11
       7: aload_0
       8: invokespecial #6                  // Method decodeServiceTicket:()V
      11: aload_0
      12: getfield      #5                  // Field encTicketPart:Lorg/apache/directory/shared/kerberos/components/EncTicketPart;
      15: invokevirtual #9                  // Method org/apache/directory/shared/kerberos/components/EncTicketPart.getCName:()Lorg/apache/directory/shared/kerberos/components/PrincipalName;
      18: invokevirtual #10                 // Method org/apache/directory/shared/kerberos/components/PrincipalName.toString:()Ljava/lang/String;
      21: areturn

  private synchronized void decodeServiceTicket() throws org.apache.wss4j.common.kerberos.KerberosTokenDecoderException;
    Code:
       0: aload_0
       1: aload_0
       2: getfield      #3                  // Field serviceTicket:[B
       5: invokespecial #11                 // Method parseServiceTicket:([B)V
       8: aload_0
       9: iconst_1
      10: putfield      #2                  // Field decoded:Z
      13: return

  private void parseServiceTicket(byte[]) throws org.apache.wss4j.common.kerberos.KerberosTokenDecoderException;
    Code:
       0: new           #12                 // class org/bouncycastle/asn1/ASN1InputStream
       3: dup
       4: new           #13                 // class java/io/ByteArrayInputStream
       7: dup
       8: aload_1
       9: invokespecial #14                 // Method java/io/ByteArrayInputStream."<init>":([B)V
      12: invokespecial #15                 // Method org/bouncycastle/asn1/ASN1InputStream."<init>":(Ljava/io/InputStream;)V
      15: astore_2
      16: aload_2
      17: invokevirtual #16                 // Method org/bouncycastle/asn1/ASN1InputStream.readObject:()Lorg/bouncycastle/asn1/ASN1Primitive;
      20: checkcast     #17                 // class org/bouncycastle/asn1/DERApplicationSpecific
      23: astore_3
      24: aload_3
      25: ifnull        35
      28: aload_3
      29: invokevirtual #18                 // Method org/bouncycastle/asn1/DERApplicationSpecific.isConstructed:()Z
      32: ifne          49
      35: aload_2
      36: invokevirtual #19                 // Method org/bouncycastle/asn1/ASN1InputStream.close:()V
      39: new           #20                 // class org/apache/wss4j/common/kerberos/KerberosTokenDecoderException
      42: dup
      43: ldc           #21                 // String invalid kerberos token
      45: invokespecial #22                 // Method org/apache/wss4j/common/kerberos/KerberosTokenDecoderException."<init>":(Ljava/lang/String;)V
      48: athrow
      49: aload_2
      50: invokevirtual #19                 // Method org/bouncycastle/asn1/ASN1InputStream.close:()V
      53: new           #12                 // class org/bouncycastle/asn1/ASN1InputStream
      56: dup
      57: new           #13                 // class java/io/ByteArrayInputStream
      60: dup
      61: aload_3
      62: invokevirtual #23                 // Method org/bouncycastle/asn1/DERApplicationSpecific.getContents:()[B
      65: invokespecial #14                 // Method java/io/ByteArrayInputStream."<init>":([B)V
      68: invokespecial #15                 // Method org/bouncycastle/asn1/ASN1InputStream."<init>":(Ljava/io/InputStream;)V
      71: astore_2
      72: aload_2
      73: invokevirtual #16                 // Method org/bouncycastle/asn1/ASN1InputStream.readObject:()Lorg/bouncycastle/asn1/ASN1Primitive;
      76: checkcast     #24                 // class org/bouncycastle/asn1/ASN1ObjectIdentifier
      79: astore        4
      81: aload         4
      83: invokevirtual #25                 // Method org/bouncycastle/asn1/ASN1ObjectIdentifier.getId:()Ljava/lang/String;
      86: ldc           #26                 // String 1.2.840.113554.1.2.2
      88: invokevirtual #27                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      91: ifne          108
      94: aload_2
      95: invokevirtual #19                 // Method org/bouncycastle/asn1/ASN1InputStream.close:()V
      98: new           #20                 // class org/apache/wss4j/common/kerberos/KerberosTokenDecoderException
     101: dup
     102: ldc           #21                 // String invalid kerberos token
     104: invokespecial #22                 // Method org/apache/wss4j/common/kerberos/KerberosTokenDecoderException."<init>":(Ljava/lang/String;)V
     107: athrow
     108: aload_2
     109: invokevirtual #28                 // Method org/bouncycastle/asn1/ASN1InputStream.read:()I
     112: sipush        255
     115: iand
     116: istore        5
     118: aload_2
     119: invokevirtual #28                 // Method org/bouncycastle/asn1/ASN1InputStream.read:()I
     122: sipush        255
     125: iand
     126: istore        6
     128: iload         6
     130: bipush        8
     132: ishl
     133: iload         5
     135: iadd
     136: istore        7
     138: iload         7
     140: iconst_1
     141: if_icmpeq     154
     144: new           #20                 // class org/apache/wss4j/common/kerberos/KerberosTokenDecoderException
     147: dup
     148: ldc           #21                 // String invalid kerberos token
     150: invokespecial #22                 // Method org/apache/wss4j/common/kerberos/KerberosTokenDecoderException."<init>":(Ljava/lang/String;)V
     153: athrow
     154: aload_2
     155: invokestatic  #29                 // Method toByteArray:(Ljava/io/InputStream;)[B
     158: invokestatic  #30                 // Method org/apache/directory/shared/kerberos/codec/KerberosDecoder.decodeApReq:([B)Lorg/apache/directory/shared/kerberos/messages/ApReq;
     161: astore        8
     163: aload         8
     165: invokevirtual #31                 // Method org/apache/directory/shared/kerberos/messages/ApReq.getTicket:()Lorg/apache/directory/shared/kerberos/messages/Ticket;
     168: invokevirtual #32                 // Method org/apache/directory/shared/kerberos/messages/Ticket.getEncPart:()Lorg/apache/directory/shared/kerberos/components/EncryptedData;
     171: invokevirtual #33                 // Method org/apache/directory/shared/kerberos/components/EncryptedData.getEType:()Lorg/apache/directory/shared/kerberos/codec/types/EncryptionType;
     174: invokevirtual #34                 // Method org/apache/directory/shared/kerberos/codec/types/EncryptionType.getValue:()I
     177: istore        9
     179: aload_0
     180: aload_0
     181: getfield      #4                  // Field subject:Ljavax/security/auth/Subject;
     184: iload         9
     186: invokespecial #35                 // Method getKrbKey:(Ljavax/security/auth/Subject;I)Ljavax/security/auth/kerberos/KerberosKey;
     189: astore        10
     191: new           #36                 // class org/apache/directory/shared/kerberos/components/EncryptionKey
     194: dup
     195: iload         9
     197: invokestatic  #37                 // Method org/apache/directory/shared/kerberos/codec/types/EncryptionType.getTypeByValue:(I)Lorg/apache/directory/shared/kerberos/codec/types/EncryptionType;
     200: aload         10
     202: invokevirtual #38                 // Method javax/security/auth/kerberos/KerberosKey.getEncoded:()[B
     205: invokespecial #39                 // Method org/apache/directory/shared/kerberos/components/EncryptionKey."<init>":(Lorg/apache/directory/shared/kerberos/codec/types/EncryptionType;[B)V
     208: astore        11
     210: new           #40                 // class org/apache/directory/server/kerberos/shared/crypto/encryption/CipherTextHandler
     213: dup
     214: invokespecial #41                 // Method org/apache/directory/server/kerberos/shared/crypto/encryption/CipherTextHandler."<init>":()V
     217: astore        12
     219: aload         12
     221: aload         11
     223: aload         8
     225: invokevirtual #31                 // Method org/apache/directory/shared/kerberos/messages/ApReq.getTicket:()Lorg/apache/directory/shared/kerberos/messages/Ticket;
     228: invokevirtual #32                 // Method org/apache/directory/shared/kerberos/messages/Ticket.getEncPart:()Lorg/apache/directory/shared/kerberos/components/EncryptedData;
     231: iconst_2
     232: invokestatic  #42                 // Method org/apache/directory/server/kerberos/shared/crypto/encryption/KeyUsage.getTypeByOrdinal:(I)Lorg/apache/directory/server/kerberos/shared/crypto/encryption/KeyUsage;
     235: invokevirtual #43                 // Method org/apache/directory/server/kerberos/shared/crypto/encryption/CipherTextHandler.decrypt:(Lorg/apache/directory/shared/kerberos/components/EncryptionKey;Lorg/apache/directory/shared/kerberos/components/EncryptedData;Lorg/apache/directory/server/kerberos/shared/crypto/encryption/KeyUsage;)[B
     238: astore        13
     240: aload_0
     241: aload         13
     243: invokestatic  #44                 // Method org/apache/directory/shared/kerberos/codec/KerberosDecoder.decodeEncTicketPart:([B)Lorg/apache/directory/shared/kerberos/components/EncTicketPart;
     246: putfield      #5                  // Field encTicketPart:Lorg/apache/directory/shared/kerberos/components/EncTicketPart;
     249: goto          262
     252: astore_2
     253: new           #20                 // class org/apache/wss4j/common/kerberos/KerberosTokenDecoderException
     256: dup
     257: aload_2
     258: invokespecial #47                 // Method org/apache/wss4j/common/kerberos/KerberosTokenDecoderException."<init>":(Ljava/lang/Throwable;)V
     261: athrow
     262: return
    Exception table:
       from    to  target type
           0   249   252   Class org/apache/directory/shared/kerberos/exceptions/KerberosException
           0   249   252   Class java/io/IOException

  private javax.security.auth.kerberos.KerberosKey getKrbKey(javax.security.auth.Subject, int);
    Code:
       0: aload_1
       1: ldc_w         #48                 // class java/lang/Object
       4: invokevirtual #49                 // Method javax/security/auth/Subject.getPrivateCredentials:(Ljava/lang/Class;)Ljava/util/Set;
       7: astore_3
       8: aload_3
       9: invokeinterface #50,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      14: astore        4
      16: aload         4
      18: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      23: ifeq          68
      26: aload         4
      28: invokeinterface #52,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      33: astore        5
      35: aload         5
      37: instanceof    #53                 // class javax/security/auth/kerberos/KerberosKey
      40: ifeq          65
      43: aload         5
      45: checkcast     #53                 // class javax/security/auth/kerberos/KerberosKey
      48: astore        6
      50: aload         6
      52: invokevirtual #54                 // Method javax/security/auth/kerberos/KerberosKey.getKeyType:()I
      55: iload_2
      56: if_icmpne     65
      59: aload         5
      61: checkcast     #53                 // class javax/security/auth/kerberos/KerberosKey
      64: areturn
      65: goto          16
      68: aconst_null
      69: areturn

  private static byte[] toByteArray(java.io.InputStream) throws java.io.IOException;
    Code:
       0: new           #55                 // class java/io/ByteArrayOutputStream
       3: dup
       4: invokespecial #56                 // Method java/io/ByteArrayOutputStream."<init>":()V
       7: astore_1
       8: aconst_null
       9: astore_2
      10: sipush        1024
      13: newarray       byte
      15: astore        4
      17: aload_0
      18: aload         4
      20: invokevirtual #57                 // Method java/io/InputStream.read:([B)I
      23: dup
      24: istore_3
      25: iconst_m1
      26: if_icmpeq     40
      29: aload_1
      30: aload         4
      32: iconst_0
      33: iload_3
      34: invokevirtual #58                 // Method java/io/ByteArrayOutputStream.write:([BII)V
      37: goto          17
      40: aload_1
      41: invokevirtual #59                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
      44: astore        5
      46: aload_1
      47: ifnull        76
      50: aload_2
      51: ifnull        72
      54: aload_1
      55: invokevirtual #60                 // Method java/io/ByteArrayOutputStream.close:()V
      58: goto          76
      61: astore        6
      63: aload_2
      64: aload         6
      66: invokevirtual #62                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
      69: goto          76
      72: aload_1
      73: invokevirtual #60                 // Method java/io/ByteArrayOutputStream.close:()V
      76: aload         5
      78: areturn
      79: astore_3
      80: aload_3
      81: astore_2
      82: aload_3
      83: athrow
      84: astore        7
      86: aload_1
      87: ifnull        116
      90: aload_2
      91: ifnull        112
      94: aload_1
      95: invokevirtual #60                 // Method java/io/ByteArrayOutputStream.close:()V
      98: goto          116
     101: astore        8
     103: aload_2
     104: aload         8
     106: invokevirtual #62                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     109: goto          116
     112: aload_1
     113: invokevirtual #60                 // Method java/io/ByteArrayOutputStream.close:()V
     116: aload         7
     118: athrow
    Exception table:
       from    to  target type
          54    58    61   Class java/lang/Throwable
          10    46    79   Class java/lang/Throwable
          10    46    84   any
          94    98   101   Class java/lang/Throwable
          79    86    84   any
}
