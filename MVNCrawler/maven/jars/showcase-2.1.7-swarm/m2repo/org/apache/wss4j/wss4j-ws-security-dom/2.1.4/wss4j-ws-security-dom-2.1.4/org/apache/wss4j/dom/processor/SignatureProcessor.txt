Compiled from "SignatureProcessor.java"
public class org.apache.wss4j.dom.processor.SignatureProcessor implements org.apache.wss4j.dom.processor.Processor {
  private static final org.slf4j.Logger LOG;

  private javax.xml.crypto.dsig.XMLSignatureFactory signatureFactory;

  public org.apache.wss4j.dom.processor.SignatureProcessor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc           #2                  // String DOM
       7: ldc           #3                  // String ApacheXMLDSig
       9: invokestatic  #4                  // Method javax/xml/crypto/dsig/XMLSignatureFactory.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      12: putfield      #5                  // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      15: goto          28
      18: astore_1
      19: aload_0
      20: ldc           #2                  // String DOM
      22: invokestatic  #7                  // Method javax/xml/crypto/dsig/XMLSignatureFactory.getInstance:(Ljava/lang/String;)Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      25: putfield      #5                  // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      28: return
    Exception table:
       from    to  target type
           4    15    18   Class java/security/NoSuchProviderException

  public java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult> handleToken(org.w3c.dom.Element, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
       3: invokeinterface #9,  1            // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
       8: ifeq          21
      11: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
      14: ldc           #10                 // String Found signature element
      16: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      21: aload_1
      22: ldc           #12                 // String KeyInfo
      24: ldc           #13                 // String http://www.w3.org/2000/09/xmldsig#
      26: invokestatic  #14                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      29: astore        4
      31: aconst_null
      32: astore        5
      34: aconst_null
      35: astore        6
      37: aconst_null
      38: astore        7
      40: aconst_null
      41: astore        8
      43: aload_1
      44: invokestatic  #15                 // Method getSignatureMethod:(Lorg/w3c/dom/Element;)Ljava/lang/String;
      47: astore        9
      49: aconst_null
      50: astore        10
      52: new           #16                 // class org/apache/wss4j/dom/validate/Credential
      55: dup
      56: invokespecial #17                 // Method org/apache/wss4j/dom/validate/Credential."<init>":()V
      59: astore        11
      61: aload_2
      62: getstatic     #18                 // Field org/apache/wss4j/dom/WSConstants.SIGNATURE:Ljavax/xml/namespace/QName;
      65: invokevirtual #19                 // Method org/apache/wss4j/dom/handler/RequestData.getValidator:(Ljavax/xml/namespace/QName;)Lorg/apache/wss4j/dom/validate/Validator;
      68: astore        12
      70: aload         4
      72: ifnonnull     97
      75: aload_0
      76: aload_2
      77: invokevirtual #20                 // Method org/apache/wss4j/dom/handler/RequestData.getSigVerCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
      80: invokespecial #21                 // Method getDefaultCerts:(Lorg/apache/wss4j/common/crypto/Crypto;)[Ljava/security/cert/X509Certificate;
      83: astore        5
      85: aload         5
      87: iconst_0
      88: aaload
      89: invokevirtual #22                 // Method java/security/cert/X509Certificate.getSubjectX500Principal:()Ljavax/security/auth/x500/X500Principal;
      92: astore        6
      94: goto          443
      97: iconst_0
      98: istore        13
     100: aload         4
     102: invokeinterface #23,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
     107: astore        14
     109: aconst_null
     110: astore        15
     112: aload         14
     114: ifnull        150
     117: iconst_1
     118: aload         14
     120: invokeinterface #24,  1           // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
     125: if_icmpne     138
     128: iinc          13, 1
     131: aload         14
     133: checkcast     #25                 // class org/w3c/dom/Element
     136: astore        15
     138: aload         14
     140: invokeinterface #26,  1           // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
     145: astore        14
     147: goto          112
     150: iload         13
     152: iconst_1
     153: if_icmpeq     166
     156: aload_2
     157: invokevirtual #27                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     160: getstatic     #28                 // Field org/apache/wss4j/common/bsp/BSPRule.R5402:Lorg/apache/wss4j/common/bsp/BSPRule;
     163: invokevirtual #29                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     166: ldc           #30                 // String SecurityTokenReference
     168: aload         15
     170: invokeinterface #31,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
     175: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     178: ifeq          196
     181: ldc           #33                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
     183: aload         15
     185: invokeinterface #34,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
     190: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     193: ifne          259
     196: aload_2
     197: invokevirtual #27                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     200: getstatic     #35                 // Field org/apache/wss4j/common/bsp/BSPRule.R5417:Lorg/apache/wss4j/common/bsp/BSPRule;
     203: invokevirtual #29                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     206: aload_0
     207: aload         4
     209: invokespecial #36                 // Method parseKeyValue:(Lorg/w3c/dom/Element;)Ljava/security/PublicKey;
     212: astore        7
     214: aload         12
     216: ifnull        443
     219: aload         11
     221: aload         7
     223: invokevirtual #37                 // Method org/apache/wss4j/dom/validate/Credential.setPublicKey:(Ljava/security/PublicKey;)V
     226: new           #38                 // class org/apache/wss4j/common/principal/PublicKeyPrincipalImpl
     229: dup
     230: aload         7
     232: invokespecial #39                 // Method org/apache/wss4j/common/principal/PublicKeyPrincipalImpl."<init>":(Ljava/security/PublicKey;)V
     235: astore        6
     237: aload         11
     239: aload         6
     241: invokevirtual #40                 // Method org/apache/wss4j/dom/validate/Credential.setPrincipal:(Ljava/security/Principal;)V
     244: aload         12
     246: aload         11
     248: aload_2
     249: invokeinterface #41,  3           // InterfaceMethod org/apache/wss4j/dom/validate/Validator.validate:(Lorg/apache/wss4j/dom/validate/Credential;Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/apache/wss4j/dom/validate/Credential;
     254: astore        11
     256: goto          443
     259: new           #42                 // class org/apache/wss4j/dom/str/STRParserParameters
     262: dup
     263: invokespecial #43                 // Method org/apache/wss4j/dom/str/STRParserParameters."<init>":()V
     266: astore        16
     268: aload         16
     270: aload_2
     271: invokevirtual #44                 // Method org/apache/wss4j/dom/str/STRParserParameters.setData:(Lorg/apache/wss4j/dom/handler/RequestData;)V
     274: aload         16
     276: aload_3
     277: invokevirtual #45                 // Method org/apache/wss4j/dom/str/STRParserParameters.setWsDocInfo:(Lorg/apache/wss4j/dom/WSDocInfo;)V
     280: aload         16
     282: aload         15
     284: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserParameters.setStrElement:(Lorg/w3c/dom/Element;)V
     287: aload         9
     289: ifnull        302
     292: aload         16
     294: aload         9
     296: invokestatic  #47                 // Method org/apache/wss4j/common/util/KeyUtils.getKeyLength:(Ljava/lang/String;)I
     299: invokevirtual #48                 // Method org/apache/wss4j/dom/str/STRParserParameters.setDerivationKeyLength:(I)V
     302: new           #49                 // class org/apache/wss4j/dom/str/SignatureSTRParser
     305: dup
     306: invokespecial #50                 // Method org/apache/wss4j/dom/str/SignatureSTRParser."<init>":()V
     309: astore        17
     311: aload         17
     313: aload         16
     315: invokeinterface #51,  2           // InterfaceMethod org/apache/wss4j/dom/str/STRParser.parseSecurityTokenReference:(Lorg/apache/wss4j/dom/str/STRParserParameters;)Lorg/apache/wss4j/dom/str/STRParserResult;
     320: astore        18
     322: aload         18
     324: invokevirtual #52                 // Method org/apache/wss4j/dom/str/STRParserResult.getPrincipal:()Ljava/security/Principal;
     327: astore        6
     329: aload         18
     331: invokevirtual #53                 // Method org/apache/wss4j/dom/str/STRParserResult.getCertificates:()[Ljava/security/cert/X509Certificate;
     334: astore        5
     336: aload         18
     338: invokevirtual #54                 // Method org/apache/wss4j/dom/str/STRParserResult.getPublicKey:()Ljava/security/PublicKey;
     341: astore        7
     343: aload         18
     345: invokevirtual #55                 // Method org/apache/wss4j/dom/str/STRParserResult.getSecretKey:()[B
     348: astore        8
     350: aload         18
     352: invokevirtual #56                 // Method org/apache/wss4j/dom/str/STRParserResult.getCertificatesReferenceType:()Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;
     355: astore        10
     357: aload         18
     359: invokevirtual #57                 // Method org/apache/wss4j/dom/str/STRParserResult.isTrustedCredential:()Z
     362: istore        19
     364: iload         19
     366: ifeq          390
     369: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     372: invokeinterface #9,  1            // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     377: ifeq          390
     380: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     383: ldc           #58                 // String Direct Trust for SAML/BST credential
     385: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     390: iload         19
     392: ifne          443
     395: aload         7
     397: ifnonnull     405
     400: aload         5
     402: ifnull        443
     405: aload         12
     407: ifnull        443
     410: aload         11
     412: aload         7
     414: invokevirtual #37                 // Method org/apache/wss4j/dom/validate/Credential.setPublicKey:(Ljava/security/PublicKey;)V
     417: aload         11
     419: aload         5
     421: invokevirtual #59                 // Method org/apache/wss4j/dom/validate/Credential.setCertificates:([Ljava/security/cert/X509Certificate;)V
     424: aload         11
     426: aload         6
     428: invokevirtual #40                 // Method org/apache/wss4j/dom/validate/Credential.setPrincipal:(Ljava/security/Principal;)V
     431: aload         12
     433: aload         11
     435: aload_2
     436: invokeinterface #41,  3           // InterfaceMethod org/apache/wss4j/dom/validate/Validator.validate:(Lorg/apache/wss4j/dom/validate/Credential;Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/apache/wss4j/dom/validate/Credential;
     441: astore        11
     443: aload         5
     445: ifnull        461
     448: aload         5
     450: arraylength
     451: ifeq          461
     454: aload         5
     456: iconst_0
     457: aaload
     458: ifnonnull     482
     461: aload         8
     463: ifnonnull     482
     466: aload         7
     468: ifnonnull     482
     471: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
     474: dup
     475: getstatic     #61                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     478: invokespecial #62                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     481: athrow
     482: aload_2
     483: invokevirtual #63                 // Method org/apache/wss4j/dom/handler/RequestData.getAlgorithmSuite:()Lorg/apache/wss4j/common/crypto/AlgorithmSuite;
     486: astore        13
     488: aload         13
     490: ifnull        590
     493: new           #64                 // class org/apache/wss4j/common/crypto/AlgorithmSuiteValidator
     496: dup
     497: aload         13
     499: invokespecial #65                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator."<init>":(Lorg/apache/wss4j/common/crypto/AlgorithmSuite;)V
     502: astore        14
     504: aload         6
     506: instanceof    #66                 // class org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal
     509: ifeq          541
     512: aload         14
     514: aload         6
     516: checkcast     #66                 // class org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal
     519: invokevirtual #67                 // Method org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal.getAlgorithm:()Ljava/lang/String;
     522: invokevirtual #68                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkDerivedKeyAlgorithm:(Ljava/lang/String;)V
     525: aload         14
     527: aload         6
     529: checkcast     #66                 // class org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal
     532: invokevirtual #69                 // Method org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal.getLength:()I
     535: invokevirtual #70                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkSignatureDerivedKeyLength:(I)V
     538: goto          590
     541: aload         5
     543: ifnull        562
     546: aload         5
     548: arraylength
     549: ifle          562
     552: aload         14
     554: aload         5
     556: invokevirtual #71                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkAsymmetricKeyLength:([Ljava/security/cert/X509Certificate;)V
     559: goto          590
     562: aload         7
     564: ifnull        577
     567: aload         14
     569: aload         7
     571: invokevirtual #72                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkAsymmetricKeyLength:(Ljava/security/PublicKey;)V
     574: goto          590
     577: aload         8
     579: ifnull        590
     582: aload         14
     584: aload         8
     586: arraylength
     587: invokevirtual #73                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkSymmetricKeyLength:(I)V
     590: aload_0
     591: aload_1
     592: aload         5
     594: aload         7
     596: aload         8
     598: aload         9
     600: aload_2
     601: aload_3
     602: invokespecial #74                 // Method verifyXMLSignature:(Lorg/w3c/dom/Element;[Ljava/security/cert/X509Certificate;Ljava/security/PublicKey;[BLjava/lang/String;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Ljavax/xml/crypto/dsig/XMLSignature;
     605: astore        14
     607: aload         14
     609: invokeinterface #75,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignatureValue:()Ljavax/xml/crypto/dsig/XMLSignature$SignatureValue;
     614: invokeinterface #76,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature$SignatureValue.getValue:()[B
     619: astore        15
     621: aload         14
     623: invokeinterface #77,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignedInfo:()Ljavax/xml/crypto/dsig/SignedInfo;
     628: invokeinterface #78,  1           // InterfaceMethod javax/xml/crypto/dsig/SignedInfo.getCanonicalizationMethod:()Ljavax/xml/crypto/dsig/CanonicalizationMethod;
     633: invokeinterface #79,  1           // InterfaceMethod javax/xml/crypto/dsig/CanonicalizationMethod.getAlgorithm:()Ljava/lang/String;
     638: astore        16
     640: aload_0
     641: aload_1
     642: invokeinterface #80,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     647: aload         14
     649: invokeinterface #77,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignedInfo:()Ljavax/xml/crypto/dsig/SignedInfo;
     654: aload_2
     655: aload_3
     656: invokespecial #81                 // Method buildProtectedRefs:(Lorg/w3c/dom/Document;Ljavax/xml/crypto/dsig/SignedInfo;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Ljava/util/List;
     659: astore        17
     661: aload         17
     663: invokeinterface #82,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     668: ifeq          682
     671: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
     674: dup
     675: getstatic     #61                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     678: invokespecial #62                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     681: athrow
     682: iconst_2
     683: istore        18
     685: aload         6
     687: instanceof    #83                 // class org/apache/wss4j/common/principal/UsernameTokenPrincipal
     690: ifeq          697
     693: bipush        64
     695: istore        18
     697: new           #84                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     700: dup
     701: iload         18
     703: aload         6
     705: aload         5
     707: aload         17
     709: aload         15
     711: invokespecial #85                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult."<init>":(ILjava/security/Principal;[Ljava/security/cert/X509Certificate;Ljava/util/List;[B)V
     714: astore        19
     716: aload         19
     718: ldc           #86                 // String signature-method
     720: aload         9
     722: invokevirtual #87                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     725: pop
     726: aload         19
     728: ldc           #88                 // String canonicalization-method
     730: aload         16
     732: invokevirtual #87                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     735: pop
     736: aload_1
     737: aconst_null
     738: ldc           #89                 // String Id
     740: invokeinterface #90,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     745: astore        20
     747: ldc           #91                 // String
     749: aload         20
     751: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     754: ifne          767
     757: aload         19
     759: ldc           #92                 // String id
     761: aload         20
     763: invokevirtual #87                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     766: pop
     767: aload         19
     769: ldc           #93                 // String secret
     771: aload         8
     773: invokevirtual #87                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     776: pop
     777: aload         19
     779: ldc           #94                 // String public-key
     781: aload         7
     783: invokevirtual #87                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     786: pop
     787: aload         19
     789: ldc           #95                 // String x509-reference-type
     791: aload         10
     793: invokevirtual #87                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     796: pop
     797: aload         19
     799: ldc           #96                 // String token-element
     801: aload_1
     802: invokevirtual #87                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     805: pop
     806: aload         12
     808: ifnull        840
     811: aload         19
     813: ldc           #97                 // String validated-token
     815: getstatic     #98                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
     818: invokevirtual #87                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     821: pop
     822: aload         11
     824: ifnull        840
     827: aload         19
     829: ldc           #99                 // String subject
     831: aload         11
     833: invokevirtual #100                // Method org/apache/wss4j/dom/validate/Credential.getSubject:()Ljavax/security/auth/Subject;
     836: invokevirtual #87                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     839: pop
     840: aload_3
     841: aload         19
     843: invokevirtual #101                // Method org/apache/wss4j/dom/WSDocInfo.addResult:(Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;)V
     846: aload_3
     847: aload_1
     848: invokevirtual #102                // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;)V
     851: aload         19
     853: invokestatic  #103                // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
     856: areturn

  private java.security.cert.X509Certificate[] getDefaultCerts(org.apache.wss4j.common.crypto.Crypto) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnonnull     17
       4: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
       7: dup
       8: getstatic     #104                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      11: ldc           #105                // String noSigCryptoFile
      13: invokespecial #106                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      16: athrow
      17: aload_1
      18: invokeinterface #107,  1          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getDefaultX509Identifier:()Ljava/lang/String;
      23: ifnull        55
      26: new           #108                // class org/apache/wss4j/common/crypto/CryptoType
      29: dup
      30: getstatic     #109                // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ALIAS:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
      33: invokespecial #110                // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
      36: astore_2
      37: aload_2
      38: aload_1
      39: invokeinterface #107,  1          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getDefaultX509Identifier:()Ljava/lang/String;
      44: invokevirtual #111                // Method org/apache/wss4j/common/crypto/CryptoType.setAlias:(Ljava/lang/String;)V
      47: aload_1
      48: aload_2
      49: invokeinterface #112,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
      54: areturn
      55: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
      58: dup
      59: getstatic     #113                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      62: ldc           #114                // String unsupportedKeyInfo
      64: invokespecial #106                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      67: athrow

  private java.security.PublicKey parseKeyValue(org.w3c.dom.Element) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aconst_null
       1: astore_2
       2: aload_0
       3: aload_1
       4: invokespecial #115                // Method getKeyValue:(Lorg/w3c/dom/Element;)Ljavax/xml/crypto/dsig/keyinfo/KeyValue;
       7: astore_2
       8: goto          24
      11: astore_3
      12: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
      15: dup
      16: getstatic     #61                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      19: aload_3
      20: invokespecial #117                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      23: athrow
      24: aload_2
      25: ifnull        61
      28: aload_2
      29: invokeinterface #118,  1          // InterfaceMethod javax/xml/crypto/dsig/keyinfo/KeyValue.getPublicKey:()Ljava/security/PublicKey;
      34: areturn
      35: astore_3
      36: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
      39: aload_3
      40: invokevirtual #120                // Method java/security/KeyException.getMessage:()Ljava/lang/String;
      43: aload_3
      44: invokeinterface #121,  3          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
      49: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
      52: dup
      53: getstatic     #61                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      56: aload_3
      57: invokespecial #117                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      60: athrow
      61: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
      64: dup
      65: getstatic     #113                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      68: ldc           #114                // String unsupportedKeyInfo
      70: invokespecial #106                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      73: athrow
    Exception table:
       from    to  target type
           2     8    11   Class javax/xml/crypto/MarshalException
          28    34    35   Class java/security/KeyException

  private javax.xml.crypto.dsig.keyinfo.KeyValue getKeyValue(org.w3c.dom.Element) throws javax.xml.crypto.MarshalException;
    Code:
       0: new           #122                // class javax/xml/crypto/dom/DOMStructure
       3: dup
       4: aload_1
       5: invokespecial #123                // Method javax/xml/crypto/dom/DOMStructure."<init>":(Lorg/w3c/dom/Node;)V
       8: astore_2
       9: aload_0
      10: getfield      #5                  // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      13: invokevirtual #124                // Method javax/xml/crypto/dsig/XMLSignatureFactory.getKeyInfoFactory:()Ljavax/xml/crypto/dsig/keyinfo/KeyInfoFactory;
      16: astore_3
      17: aload_3
      18: aload_2
      19: invokevirtual #125                // Method javax/xml/crypto/dsig/keyinfo/KeyInfoFactory.unmarshalKeyInfo:(Ljavax/xml/crypto/XMLStructure;)Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
      22: astore        4
      24: aload         4
      26: invokeinterface #126,  1          // InterfaceMethod javax/xml/crypto/dsig/keyinfo/KeyInfo.getContent:()Ljava/util/List;
      31: astore        5
      33: iconst_0
      34: istore        6
      36: iload         6
      38: aload         5
      40: invokeinterface #127,  1          // InterfaceMethod java/util/List.size:()I
      45: if_icmpge     82
      48: aload         5
      50: iload         6
      52: invokeinterface #128,  2          // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      57: checkcast     #129                // class javax/xml/crypto/XMLStructure
      60: astore        7
      62: aload         7
      64: instanceof    #130                // class javax/xml/crypto/dsig/keyinfo/KeyValue
      67: ifeq          76
      70: aload         7
      72: checkcast     #130                // class javax/xml/crypto/dsig/keyinfo/KeyValue
      75: areturn
      76: iinc          6, 1
      79: goto          36
      82: aconst_null
      83: areturn

  private javax.xml.crypto.dsig.XMLSignature verifyXMLSignature(org.w3c.dom.Element, java.security.cert.X509Certificate[], java.security.PublicKey, byte[], java.lang.String, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
       3: invokeinterface #9,  1            // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
       8: ifeq          21
      11: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
      14: ldc           #131                // String Verify XML Signature
      16: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      21: aconst_null
      22: astore        8
      24: aload_2
      25: ifnull        45
      28: aload_2
      29: iconst_0
      30: aaload
      31: ifnull        45
      34: aload_2
      35: iconst_0
      36: aaload
      37: invokevirtual #132                // Method java/security/cert/X509Certificate.getPublicKey:()Ljava/security/PublicKey;
      40: astore        8
      42: goto          64
      45: aload_3
      46: ifnull        55
      49: aload_3
      50: astore        8
      52: goto          64
      55: aload         5
      57: aload         4
      59: invokestatic  #133                // Method org/apache/wss4j/common/util/KeyUtils.prepareSecretKey:(Ljava/lang/String;[B)Ljavax/crypto/SecretKey;
      62: astore        8
      64: new           #134                // class javax/xml/crypto/dsig/dom/DOMValidateContext
      67: dup
      68: aload         8
      70: aload_1
      71: invokespecial #135                // Method javax/xml/crypto/dsig/dom/DOMValidateContext."<init>":(Ljava/security/Key;Lorg/w3c/dom/Node;)V
      74: astore        9
      76: aload         9
      78: ldc           #136                // String javax.xml.crypto.dsig.cacheReference
      80: getstatic     #98                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
      83: invokeinterface #137,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLValidateContext.setProperty:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
      88: pop
      89: aload         9
      91: ldc           #138                // String org.apache.jcp.xml.dsig.secureValidation
      93: getstatic     #98                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
      96: invokeinterface #137,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLValidateContext.setProperty:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     101: pop
     102: aload         9
     104: ldc           #139                // String org.jcp.xml.dsig.secureValidation
     106: getstatic     #98                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
     109: invokeinterface #137,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLValidateContext.setProperty:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     114: pop
     115: aload         9
     117: ldc           #140                // String transform_ws_doc_info
     119: aload         7
     121: invokeinterface #137,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLValidateContext.setProperty:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     126: pop
     127: aload         9
     129: ldc           #141                // String AttachmentContentTransform.attachmentCallbackHandler
     131: aload         6
     133: invokevirtual #142                // Method org/apache/wss4j/dom/handler/RequestData.getAttachmentCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     136: invokeinterface #137,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLValidateContext.setProperty:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     141: pop
     142: aload_0
     143: getfield      #5                  // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
     146: aload         9
     148: invokevirtual #143                // Method javax/xml/crypto/dsig/XMLSignatureFactory.unmarshalXMLSignature:(Ljavax/xml/crypto/dsig/XMLValidateContext;)Ljavax/xml/crypto/dsig/XMLSignature;
     151: astore        10
     153: aload_0
     154: aload         10
     156: aload         6
     158: invokevirtual #27                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     161: invokespecial #144                // Method checkBSPCompliance:(Ljavax/xml/crypto/dsig/XMLSignature;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     164: aload         6
     166: invokevirtual #63                 // Method org/apache/wss4j/dom/handler/RequestData.getAlgorithmSuite:()Lorg/apache/wss4j/common/crypto/AlgorithmSuite;
     169: astore        11
     171: aload         11
     173: ifnull        194
     176: new           #64                 // class org/apache/wss4j/common/crypto/AlgorithmSuiteValidator
     179: dup
     180: aload         11
     182: invokespecial #65                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator."<init>":(Lorg/apache/wss4j/common/crypto/AlgorithmSuite;)V
     185: astore        12
     187: aload         12
     189: aload         10
     191: invokevirtual #145                // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkSignatureAlgorithms:(Ljavax/xml/crypto/dsig/XMLSignature;)V
     194: aload_0
     195: aload_1
     196: aload         10
     198: invokeinterface #75,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignatureValue:()Ljavax/xml/crypto/dsig/XMLSignature$SignatureValue;
     203: invokeinterface #76,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature$SignatureValue.getValue:()[B
     208: aload         8
     210: aload         6
     212: aload         7
     214: invokespecial #146                // Method testMessageReplay:(Lorg/w3c/dom/Element;[BLjava/security/Key;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)V
     217: aload_0
     218: aload         10
     220: aload         9
     222: checkcast     #134                // class javax/xml/crypto/dsig/dom/DOMValidateContext
     225: aload         6
     227: aload         7
     229: invokespecial #147                // Method setElementsOnContext:(Ljavax/xml/crypto/dsig/XMLSignature;Ljavax/xml/crypto/dsig/dom/DOMValidateContext;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)V
     232: aload         10
     234: aload         9
     236: invokeinterface #148,  2          // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.validate:(Ljavax/xml/crypto/dsig/XMLValidateContext;)Z
     241: istore        12
     243: iload         12
     245: ifeq          251
     248: aload         10
     250: areturn
     251: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     254: invokeinterface #9,  1            // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     259: ifeq          432
     262: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     265: ldc           #149                // String XML Signature verification has failed
     267: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     272: aload         10
     274: invokeinterface #75,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignatureValue:()Ljavax/xml/crypto/dsig/XMLSignature$SignatureValue;
     279: aload         9
     281: invokeinterface #150,  2          // InterfaceMethod javax/xml/crypto/dsig/XMLSignature$SignatureValue.validate:(Ljavax/xml/crypto/dsig/XMLValidateContext;)Z
     286: istore        13
     288: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     291: new           #151                // class java/lang/StringBuilder
     294: dup
     295: invokespecial #152                // Method java/lang/StringBuilder."<init>":()V
     298: ldc           #153                // String Signature Validation check:
     300: invokevirtual #154                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     303: iload         13
     305: invokevirtual #155                // Method java/lang/StringBuilder.append:(Z)Ljava/lang/StringBuilder;
     308: invokevirtual #156                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     311: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     316: aload         10
     318: invokeinterface #77,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignedInfo:()Ljavax/xml/crypto/dsig/SignedInfo;
     323: invokeinterface #157,  1          // InterfaceMethod javax/xml/crypto/dsig/SignedInfo.getReferences:()Ljava/util/List;
     328: invokeinterface #158,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     333: astore        14
     335: aload         14
     337: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     342: ifeq          432
     345: aload         14
     347: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     352: checkcast     #161                // class javax/xml/crypto/dsig/Reference
     355: astore        15
     357: aload         15
     359: aload         9
     361: invokeinterface #162,  2          // InterfaceMethod javax/xml/crypto/dsig/Reference.validate:(Ljavax/xml/crypto/dsig/XMLValidateContext;)Z
     366: istore        16
     368: aload         15
     370: invokeinterface #163,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getId:()Ljava/lang/String;
     375: astore        17
     377: aload         17
     379: ifnonnull     391
     382: aload         15
     384: invokeinterface #164,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getURI:()Ljava/lang/String;
     389: astore        17
     391: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     394: new           #151                // class java/lang/StringBuilder
     397: dup
     398: invokespecial #152                // Method java/lang/StringBuilder."<init>":()V
     401: ldc           #165                // String Reference
     403: invokevirtual #154                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     406: aload         17
     408: invokevirtual #154                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     411: ldc           #166                // String  check:
     413: invokevirtual #154                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     416: iload         16
     418: invokevirtual #155                // Method java/lang/StringBuilder.append:(Z)Ljava/lang/StringBuilder;
     421: invokevirtual #156                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     424: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     429: goto          335
     432: goto          455
     435: astore        10
     437: aload         10
     439: athrow
     440: astore        10
     442: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
     445: dup
     446: getstatic     #61                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     449: aload         10
     451: invokespecial #117                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     454: athrow
     455: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
     458: dup
     459: getstatic     #61                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     462: invokespecial #62                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     465: athrow
    Exception table:
       from    to  target type
         142   250   435   Class org/apache/wss4j/common/ext/WSSecurityException
         251   432   435   Class org/apache/wss4j/common/ext/WSSecurityException
         142   250   440   Class java/lang/Exception
         251   432   440   Class java/lang/Exception

  private void setElementsOnContext(javax.xml.crypto.dsig.XMLSignature, javax.xml.crypto.dsig.dom.DOMValidateContext, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: invokeinterface #77,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignedInfo:()Ljavax/xml/crypto/dsig/SignedInfo;
       6: invokeinterface #157,  1          // InterfaceMethod javax/xml/crypto/dsig/SignedInfo.getReferences:()Ljava/util/List;
      11: invokeinterface #158,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      16: astore        5
      18: aload         4
      20: invokevirtual #168                // Method org/apache/wss4j/dom/WSDocInfo.getCallbackLookup:()Lorg/apache/wss4j/dom/callback/CallbackLookup;
      23: astore        6
      25: aload         5
      27: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      32: ifeq          271
      35: aload         5
      37: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      42: checkcast     #161                // class javax/xml/crypto/dsig/Reference
      45: astore        7
      47: aload         7
      49: invokeinterface #164,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getURI:()Ljava/lang/String;
      54: astore        8
      56: aload         6
      58: aload         8
      60: aconst_null
      61: iconst_1
      62: aload_2
      63: invokeinterface #169,  5          // InterfaceMethod org/apache/wss4j/dom/callback/CallbackLookup.getAndRegisterElement:(Ljava/lang/String;Ljava/lang/String;ZLjavax/xml/crypto/dom/DOMCryptoContext;)Lorg/w3c/dom/Element;
      68: astore        9
      70: aload         9
      72: ifnonnull     86
      75: aload         4
      77: aload         8
      79: aload_2
      80: invokevirtual #170                // Method org/apache/wss4j/dom/WSDocInfo.setTokenOnContext:(Ljava/lang/String;Ljavax/xml/crypto/dom/DOMCryptoContext;)V
      83: goto          268
      86: ldc           #171                // String BinarySecurityToken
      88: aload         9
      90: invokeinterface #31,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      95: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      98: ifeq          136
     101: ldc           #33                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
     103: aload         9
     105: invokeinterface #34,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
     110: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     113: ifeq          136
     116: aload_0
     117: aload         9
     119: invokespecial #172                // Method isXopInclude:(Lorg/w3c/dom/Element;)Z
     122: ifeq          136
     125: aload_0
     126: aload         9
     128: aload         4
     130: invokespecial #173                // Method handleXopInclude:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/WSDocInfo;)V
     133: goto          268
     136: aload_3
     137: invokevirtual #174                // Method org/apache/wss4j/dom/handler/RequestData.isExpandXopIncludeForSignature:()Z
     140: ifeq          268
     143: aload         9
     145: invokeinterface #23,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
     150: ifnull        268
     153: aload         9
     155: invokeinterface #23,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
     160: ldc           #175                // String Include
     162: ldc           #176                // String http://www.w3.org/2004/08/xop/include
     164: invokestatic  #177                // Method org/apache/wss4j/common/util/XMLUtils.findElements:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Ljava/util/List;
     167: astore        10
     169: aload         10
     171: invokeinterface #178,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     176: astore        11
     178: aload         11
     180: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     185: ifeq          268
     188: aload         11
     190: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     195: checkcast     #25                 // class org/w3c/dom/Element
     198: astore        12
     200: aload         12
     202: aconst_null
     203: ldc           #179                // String href
     205: invokeinterface #90,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     210: astore        13
     212: aload         13
     214: ifnull        265
     217: aload         13
     219: aload_3
     220: invokestatic  #180                // Method org/apache/wss4j/dom/util/WSSecurityUtil.getBytesFromAttachment:(Ljava/lang/String;Lorg/apache/wss4j/dom/handler/RequestData;)[B
     223: astore        14
     225: aload         14
     227: invokestatic  #181                // Method org/apache/xml/security/utils/Base64.encode:([B)Ljava/lang/String;
     230: astore        15
     232: aload         12
     234: invokeinterface #80,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     239: aload         15
     241: invokeinterface #182,  2          // InterfaceMethod org/w3c/dom/Document.createTextNode:(Ljava/lang/String;)Lorg/w3c/dom/Text;
     246: astore        16
     248: aload         12
     250: invokeinterface #183,  1          // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
     255: aload         16
     257: aload         12
     259: invokeinterface #184,  3          // InterfaceMethod org/w3c/dom/Node.replaceChild:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     264: pop
     265: goto          178
     268: goto          25
     271: return

  private boolean isXopInclude(org.w3c.dom.Element);
    Code:
       0: aload_1
       1: ldc           #175                // String Include
       3: ldc           #176                // String http://www.w3.org/2004/08/xop/include
       5: invokestatic  #14                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
       8: astore_2
       9: aload_2
      10: ifnull        50
      13: aload_2
      14: aconst_null
      15: ldc           #179                // String href
      17: invokeinterface #185,  3          // InterfaceMethod org/w3c/dom/Element.hasAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Z
      22: ifeq          50
      25: aload_2
      26: aconst_null
      27: ldc           #179                // String href
      29: invokeinterface #90,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      34: astore_3
      35: aload_3
      36: ifnull        50
      39: aload_3
      40: ldc           #186                // String cid:
      42: invokevirtual #187                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      45: ifeq          50
      48: iconst_1
      49: ireturn
      50: iconst_0
      51: ireturn

  private void handleXopInclude(org.w3c.dom.Element, org.apache.wss4j.dom.WSDocInfo);
    Code:
       0: aload_2
       1: invokevirtual #188                // Method org/apache/wss4j/dom/WSDocInfo.getActionResults:()Ljava/util/Map;
       4: astore_3
       5: aload_3
       6: ifnull        110
       9: aload_3
      10: sipush        4096
      13: invokestatic  #189                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      16: invokeinterface #190,  2          // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
      21: ifeq          110
      24: aload_3
      25: sipush        4096
      28: invokestatic  #189                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      31: invokeinterface #191,  2          // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      36: checkcast     #192                // class java/util/List
      39: invokeinterface #178,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      44: astore        4
      46: aload         4
      48: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      53: ifeq          110
      56: aload         4
      58: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      63: checkcast     #84                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
      66: astore        5
      68: aload         5
      70: ldc           #96                 // String token-element
      72: invokevirtual #193                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      75: checkcast     #25                 // class org/w3c/dom/Element
      78: astore        6
      80: aload_1
      81: aload         6
      83: invokevirtual #194                // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
      86: ifeq          107
      89: aload         5
      91: ldc           #195                // String binary-security-token
      93: invokevirtual #193                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      96: checkcast     #196                // class org/apache/wss4j/common/token/BinarySecurity
      99: astore        7
     101: aload         7
     103: invokevirtual #197                // Method org/apache/wss4j/common/token/BinarySecurity.encodeRawToken:()V
     106: return
     107: goto          46
     110: return

  private static java.lang.String getSignatureMethod(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: ldc           #198                // String SignedInfo
       3: ldc           #13                 // String http://www.w3.org/2000/09/xmldsig#
       5: invokestatic  #14                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
       8: astore_1
       9: aload_1
      10: ifnull        36
      13: aload_1
      14: ldc           #199                // String SignatureMethod
      16: ldc           #13                 // String http://www.w3.org/2000/09/xmldsig#
      18: invokestatic  #14                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      21: astore_2
      22: aload_2
      23: ifnull        36
      26: aload_2
      27: aconst_null
      28: ldc           #200                // String Algorithm
      30: invokeinterface #90,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      35: areturn
      36: aconst_null
      37: areturn

  private java.util.List<org.apache.wss4j.dom.WSDataRef> buildProtectedRefs(org.w3c.dom.Document, javax.xml.crypto.dsig.SignedInfo, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #201                // class java/util/ArrayList
       3: dup
       4: aload_2
       5: invokeinterface #157,  1          // InterfaceMethod javax/xml/crypto/dsig/SignedInfo.getReferences:()Ljava/util/List;
      10: invokeinterface #127,  1          // InterfaceMethod java/util/List.size:()I
      15: invokespecial #202                // Method java/util/ArrayList."<init>":(I)V
      18: astore        5
      20: aload_2
      21: invokeinterface #157,  1          // InterfaceMethod javax/xml/crypto/dsig/SignedInfo.getReferences:()Ljava/util/List;
      26: invokeinterface #178,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      31: astore        6
      33: aload         6
      35: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      40: ifeq          395
      43: aload         6
      45: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      50: astore        7
      52: aload         7
      54: checkcast     #161                // class javax/xml/crypto/dsig/Reference
      57: astore        8
      59: aload         8
      61: invokeinterface #164,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getURI:()Ljava/lang/String;
      66: astore        9
      68: ldc           #91                 // String
      70: aload         9
      72: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      75: ifne          392
      78: aload_0
      79: aload_1
      80: aload         8
      82: aload_3
      83: aload         4
      85: invokespecial #203                // Method dereferenceSTR:(Lorg/w3c/dom/Document;Ljavax/xml/crypto/dsig/Reference;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Lorg/w3c/dom/Element;
      88: astore        10
      90: iconst_0
      91: istore        11
      93: aload         10
      95: ifnonnull     200
      98: aload         8
     100: invokeinterface #204,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getDereferencedData:()Ljavax/xml/crypto/Data;
     105: astore        12
     107: aload         12
     109: instanceof    #205                // class javax/xml/crypto/NodeSetData
     112: ifeq          177
     115: aload         12
     117: checkcast     #205                // class javax/xml/crypto/NodeSetData
     120: astore        13
     122: aload         13
     124: invokeinterface #206,  1          // InterfaceMethod javax/xml/crypto/NodeSetData.iterator:()Ljava/util/Iterator;
     129: astore        14
     131: aload         14
     133: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     138: ifeq          174
     141: aload         14
     143: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     148: checkcast     #207                // class org/w3c/dom/Node
     151: astore        15
     153: aload         15
     155: instanceof    #25                 // class org/w3c/dom/Element
     158: ifeq          171
     161: aload         15
     163: checkcast     #25                 // class org/w3c/dom/Element
     166: astore        10
     168: goto          174
     171: goto          131
     174: goto          200
     177: aload         12
     179: instanceof    #208                // class javax/xml/crypto/OctetStreamData
     182: ifeq          200
     185: aload_1
     186: ldc           #209                // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1
     188: ldc           #210                // String attachment
     190: invokeinterface #211,  3          // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     195: astore        10
     197: iconst_1
     198: istore        11
     200: aload         10
     202: ifnonnull     216
     205: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
     208: dup
     209: getstatic     #61                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     212: invokespecial #62                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     215: athrow
     216: new           #212                // class org/apache/wss4j/dom/WSDataRef
     219: dup
     220: invokespecial #213                // Method org/apache/wss4j/dom/WSDataRef."<init>":()V
     223: astore        12
     225: aload         12
     227: aload         9
     229: invokevirtual #214                // Method org/apache/wss4j/dom/WSDataRef.setWsuId:(Ljava/lang/String;)V
     232: aload         12
     234: aload         10
     236: invokevirtual #215                // Method org/apache/wss4j/dom/WSDataRef.setProtectedElement:(Lorg/w3c/dom/Element;)V
     239: aload         12
     241: aload_2
     242: invokeinterface #216,  1          // InterfaceMethod javax/xml/crypto/dsig/SignedInfo.getSignatureMethod:()Ljavax/xml/crypto/dsig/SignatureMethod;
     247: invokeinterface #217,  1          // InterfaceMethod javax/xml/crypto/dsig/SignatureMethod.getAlgorithm:()Ljava/lang/String;
     252: invokevirtual #218                // Method org/apache/wss4j/dom/WSDataRef.setAlgorithm:(Ljava/lang/String;)V
     255: aload         12
     257: aload         8
     259: invokeinterface #219,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getDigestMethod:()Ljavax/xml/crypto/dsig/DigestMethod;
     264: invokeinterface #220,  1          // InterfaceMethod javax/xml/crypto/dsig/DigestMethod.getAlgorithm:()Ljava/lang/String;
     269: invokevirtual #221                // Method org/apache/wss4j/dom/WSDataRef.setDigestAlgorithm:(Ljava/lang/String;)V
     272: aload         12
     274: aload         8
     276: invokeinterface #222,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getDigestValue:()[B
     281: invokevirtual #223                // Method org/apache/wss4j/dom/WSDataRef.setDigestValue:([B)V
     284: aload         12
     286: iload         11
     288: invokevirtual #224                // Method org/apache/wss4j/dom/WSDataRef.setAttachment:(Z)V
     291: aload         8
     293: invokeinterface #225,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getTransforms:()Ljava/util/List;
     298: astore        13
     300: new           #201                // class java/util/ArrayList
     303: dup
     304: aload         13
     306: invokeinterface #127,  1          // InterfaceMethod java/util/List.size:()I
     311: invokespecial #202                // Method java/util/ArrayList."<init>":(I)V
     314: astore        14
     316: aload         13
     318: invokeinterface #178,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     323: astore        15
     325: aload         15
     327: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     332: ifeq          365
     335: aload         15
     337: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     342: checkcast     #226                // class javax/xml/crypto/dsig/Transform
     345: astore        16
     347: aload         14
     349: aload         16
     351: invokeinterface #227,  1          // InterfaceMethod javax/xml/crypto/dsig/Transform.getAlgorithm:()Ljava/lang/String;
     356: invokeinterface #228,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     361: pop
     362: goto          325
     365: aload         12
     367: aload         14
     369: invokevirtual #229                // Method org/apache/wss4j/dom/WSDataRef.setTransformAlgorithms:(Ljava/util/List;)V
     372: aload         12
     374: aload         10
     376: invokestatic  #230                // Method org/apache/wss4j/dom/util/EncryptionUtils.getXPath:(Lorg/w3c/dom/Node;)Ljava/lang/String;
     379: invokevirtual #231                // Method org/apache/wss4j/dom/WSDataRef.setXpath:(Ljava/lang/String;)V
     382: aload         5
     384: aload         12
     386: invokeinterface #228,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     391: pop
     392: goto          33
     395: aload         5
     397: areturn

  private org.w3c.dom.Element dereferenceSTR(org.w3c.dom.Document, javax.xml.crypto.dsig.Reference, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_2
       1: invokeinterface #225,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getTransforms:()Ljava/util/List;
       6: invokeinterface #178,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      11: astore        5
      13: aload         5
      15: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      20: ifeq          173
      23: aload         5
      25: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      30: astore        6
      32: aload         6
      34: checkcast     #226                // class javax/xml/crypto/dsig/Transform
      37: astore        7
      39: ldc           #232                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform
      41: aload         7
      43: invokeinterface #227,  1          // InterfaceMethod javax/xml/crypto/dsig/Transform.getAlgorithm:()Ljava/lang/String;
      48: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      51: ifeq          170
      54: aload_2
      55: invokeinterface #204,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getDereferencedData:()Ljavax/xml/crypto/Data;
      60: checkcast     #205                // class javax/xml/crypto/NodeSetData
      63: astore        8
      65: aload         8
      67: ifnull        170
      70: aload         8
      72: invokeinterface #206,  1          // InterfaceMethod javax/xml/crypto/NodeSetData.iterator:()Ljava/util/Iterator;
      77: astore        9
      79: aconst_null
      80: astore        10
      82: aload         9
      84: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      89: ifeq          129
      92: aload         9
      94: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      99: checkcast     #207                // class org/w3c/dom/Node
     102: astore        11
     104: ldc           #30                 // String SecurityTokenReference
     106: aload         11
     108: invokeinterface #233,  1          // InterfaceMethod org/w3c/dom/Node.getLocalName:()Ljava/lang/String;
     113: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     116: ifeq          126
     119: aload         11
     121: astore        10
     123: goto          129
     126: goto          82
     129: aload         10
     131: ifnull        170
     134: new           #234                // class org/apache/wss4j/common/token/SecurityTokenReference
     137: dup
     138: aload         10
     140: checkcast     #25                 // class org/w3c/dom/Element
     143: aload_3
     144: invokevirtual #27                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     147: invokespecial #235                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     150: astore        11
     152: aload_1
     153: aload         11
     155: aload         4
     157: invokestatic  #236                // Method org/apache/wss4j/dom/transform/STRTransformUtil.dereferenceSTR:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/dom/WSDocInfo;)Lorg/w3c/dom/Element;
     160: astore        12
     162: aload         12
     164: ifnull        170
     167: aload         12
     169: areturn
     170: goto          13
     173: aconst_null
     174: areturn

  private void testMessageReplay(org.w3c.dom.Element, byte[], java.security.Key, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload         4
       2: invokevirtual #237                // Method org/apache/wss4j/dom/handler/RequestData.getTimestampReplayCache:()Lorg/apache/wss4j/common/cache/ReplayCache;
       5: astore        6
       7: aload         6
       9: ifnonnull     13
      12: return
      13: aload         5
      15: bipush        32
      17: invokestatic  #189                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      20: invokevirtual #238                // Method org/apache/wss4j/dom/WSDocInfo.getResultsByTag:(Ljava/lang/Integer;)Ljava/util/List;
      23: astore        7
      25: aconst_null
      26: astore        8
      28: aload         7
      30: invokeinterface #82,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      35: ifeq          126
      38: aload_1
      39: invokeinterface #239,  1          // InterfaceMethod org/w3c/dom/Element.getNextSibling:()Lorg/w3c/dom/Node;
      44: astore        9
      46: aload         9
      48: ifnull        123
      51: aload         9
      53: instanceof    #25                 // class org/w3c/dom/Element
      56: ifeq          111
      59: ldc           #240                // String Timestamp
      61: aload         9
      63: invokeinterface #233,  1          // InterfaceMethod org/w3c/dom/Node.getLocalName:()Ljava/lang/String;
      68: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      71: ifeq          111
      74: ldc           #241                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      76: aload         9
      78: invokeinterface #242,  1          // InterfaceMethod org/w3c/dom/Node.getNamespaceURI:()Ljava/lang/String;
      83: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      86: ifeq          111
      89: new           #243                // class org/apache/wss4j/dom/message/token/Timestamp
      92: dup
      93: aload         9
      95: checkcast     #25                 // class org/w3c/dom/Element
      98: aload         4
     100: invokevirtual #27                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     103: invokespecial #244                // Method org/apache/wss4j/dom/message/token/Timestamp."<init>":(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     106: astore        8
     108: goto          123
     111: aload         9
     113: invokeinterface #26,  1           // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
     118: astore        9
     120: goto          46
     123: goto          147
     126: aload         7
     128: iconst_0
     129: invokeinterface #128,  2          // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     134: checkcast     #84                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     137: ldc           #245                // String timestamp
     139: invokevirtual #193                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     142: checkcast     #243                // class org/apache/wss4j/dom/message/token/Timestamp
     145: astore        8
     147: aload         8
     149: ifnonnull     153
     152: return
     153: aload         8
     155: invokevirtual #246                // Method org/apache/wss4j/dom/message/token/Timestamp.getCreated:()Ljava/util/Date;
     158: astore        9
     160: new           #247                // class org/apache/wss4j/dom/util/XmlSchemaDateFormat
     163: dup
     164: invokespecial #248                // Method org/apache/wss4j/dom/util/XmlSchemaDateFormat."<init>":()V
     167: astore        10
     169: new           #151                // class java/lang/StringBuilder
     172: dup
     173: invokespecial #152                // Method java/lang/StringBuilder."<init>":()V
     176: aload         10
     178: aload         9
     180: invokevirtual #249                // Method java/text/DateFormat.format:(Ljava/util/Date;)Ljava/lang/String;
     183: invokevirtual #154                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     186: ldc           #91                 // String
     188: invokevirtual #154                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     191: aload_2
     192: invokestatic  #250                // Method java/util/Arrays.hashCode:([B)I
     195: invokevirtual #251                // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     198: ldc           #91                 // String
     200: invokevirtual #154                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     203: aload_3
     204: invokeinterface #252,  1          // InterfaceMethod java/security/Key.getEncoded:()[B
     209: invokestatic  #250                // Method java/util/Arrays.hashCode:([B)I
     212: invokevirtual #251                // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     215: invokevirtual #156                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     218: astore        11
     220: aload         6
     222: aload         11
     224: invokeinterface #253,  2          // InterfaceMethod org/apache/wss4j/common/cache/ReplayCache.contains:(Ljava/lang/String;)Z
     229: ifeq          255
     232: new           #60                 // class org/apache/wss4j/common/ext/WSSecurityException
     235: dup
     236: getstatic     #113                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     239: ldc           #254                // String invalidTimestamp
     241: iconst_1
     242: anewarray     #255                // class java/lang/Object
     245: dup
     246: iconst_0
     247: ldc_w         #256                // String A replay attack has been detected
     250: aastore
     251: invokespecial #257                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     254: athrow
     255: aload         8
     257: invokevirtual #258                // Method org/apache/wss4j/dom/message/token/Timestamp.getExpires:()Ljava/util/Date;
     260: astore        12
     262: aload         12
     264: ifnull        313
     267: new           #259                // class java/util/Date
     270: dup
     271: invokespecial #260                // Method java/util/Date."<init>":()V
     274: astore        13
     276: aload         13
     278: invokevirtual #261                // Method java/util/Date.getTime:()J
     281: lstore        14
     283: aload         12
     285: invokevirtual #261                // Method java/util/Date.getTime:()J
     288: lstore        16
     290: aload         6
     292: aload         11
     294: lconst_1
     295: lload         16
     297: lload         14
     299: lsub
     300: ldc2_w        #262                // long 1000l
     303: ldiv
     304: ladd
     305: invokeinterface #264,  4          // InterfaceMethod org/apache/wss4j/common/cache/ReplayCache.add:(Ljava/lang/String;J)V
     310: goto          322
     313: aload         6
     315: aload         11
     317: invokeinterface #265,  2          // InterfaceMethod org/apache/wss4j/common/cache/ReplayCache.add:(Ljava/lang/String;)V
     322: return

  private void checkBSPCompliance(javax.xml.crypto.dsig.XMLSignature, org.apache.wss4j.common.bsp.BSPEnforcer) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: invokeinterface #266,  1          // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getObjects:()Ljava/util/List;
       6: invokeinterface #178,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      11: astore_3
      12: aload_3
      13: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      18: ifeq          98
      21: aload_3
      22: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      27: astore        4
      29: aload         4
      31: instanceof    #267                // class javax/xml/crypto/dsig/XMLObject
      34: ifeq          95
      37: aload         4
      39: checkcast     #267                // class javax/xml/crypto/dsig/XMLObject
      42: astore        5
      44: aload         5
      46: invokeinterface #268,  1          // InterfaceMethod javax/xml/crypto/dsig/XMLObject.getContent:()Ljava/util/List;
      51: invokeinterface #178,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      56: astore        6
      58: aload         6
      60: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      65: ifeq          95
      68: aload         6
      70: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      75: astore        7
      77: aload         7
      79: instanceof    #269                // class javax/xml/crypto/dsig/Manifest
      82: ifeq          92
      85: aload_2
      86: getstatic     #270                // Field org/apache/wss4j/common/bsp/BSPRule.R5403:Lorg/apache/wss4j/common/bsp/BSPRule;
      89: invokevirtual #29                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      92: goto          58
      95: goto          12
      98: aload_1
      99: invokeinterface #77,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignedInfo:()Ljavax/xml/crypto/dsig/SignedInfo;
     104: invokeinterface #78,  1           // InterfaceMethod javax/xml/crypto/dsig/SignedInfo.getCanonicalizationMethod:()Ljavax/xml/crypto/dsig/CanonicalizationMethod;
     109: invokeinterface #79,  1           // InterfaceMethod javax/xml/crypto/dsig/CanonicalizationMethod.getAlgorithm:()Ljava/lang/String;
     114: astore_3
     115: ldc_w         #271                // String http://www.w3.org/2001/10/xml-exc-c14n#
     118: aload_3
     119: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     122: ifne          132
     125: aload_2
     126: getstatic     #272                // Field org/apache/wss4j/common/bsp/BSPRule.R5404:Lorg/apache/wss4j/common/bsp/BSPRule;
     129: invokevirtual #29                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     132: aload_1
     133: invokeinterface #77,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignedInfo:()Ljavax/xml/crypto/dsig/SignedInfo;
     138: invokeinterface #216,  1          // InterfaceMethod javax/xml/crypto/dsig/SignedInfo.getSignatureMethod:()Ljavax/xml/crypto/dsig/SignatureMethod;
     143: invokeinterface #273,  1          // InterfaceMethod javax/xml/crypto/dsig/SignatureMethod.getParameterSpec:()Ljava/security/spec/AlgorithmParameterSpec;
     148: astore        4
     150: aload         4
     152: instanceof    #274                // class javax/xml/crypto/dsig/spec/HMACParameterSpec
     155: ifeq          165
     158: aload_2
     159: getstatic     #275                // Field org/apache/wss4j/common/bsp/BSPRule.R5401:Lorg/apache/wss4j/common/bsp/BSPRule;
     162: invokevirtual #29                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     165: aload_1
     166: invokeinterface #77,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignedInfo:()Ljavax/xml/crypto/dsig/SignedInfo;
     171: invokeinterface #78,  1           // InterfaceMethod javax/xml/crypto/dsig/SignedInfo.getCanonicalizationMethod:()Ljavax/xml/crypto/dsig/CanonicalizationMethod;
     176: invokeinterface #276,  1          // InterfaceMethod javax/xml/crypto/dsig/CanonicalizationMethod.getParameterSpec:()Ljava/security/spec/AlgorithmParameterSpec;
     181: astore        4
     183: aload         4
     185: ifnull        203
     188: aload         4
     190: instanceof    #277                // class javax/xml/crypto/dsig/spec/ExcC14NParameterSpec
     193: ifne          203
     196: aload_2
     197: getstatic     #272                // Field org/apache/wss4j/common/bsp/BSPRule.R5404:Lorg/apache/wss4j/common/bsp/BSPRule;
     200: invokevirtual #29                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     203: aload_1
     204: invokeinterface #77,  1           // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignedInfo:()Ljavax/xml/crypto/dsig/SignedInfo;
     209: invokeinterface #157,  1          // InterfaceMethod javax/xml/crypto/dsig/SignedInfo.getReferences:()Ljava/util/List;
     214: invokeinterface #178,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     219: astore        5
     221: aload         5
     223: invokeinterface #159,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     228: ifeq          507
     231: aload         5
     233: invokeinterface #160,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     238: astore        6
     240: aload         6
     242: checkcast     #161                // class javax/xml/crypto/dsig/Reference
     245: astore        7
     247: aload         7
     249: invokeinterface #225,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getTransforms:()Ljava/util/List;
     254: invokeinterface #82,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     259: ifeq          269
     262: aload_2
     263: getstatic     #278                // Field org/apache/wss4j/common/bsp/BSPRule.R5416:Lorg/apache/wss4j/common/bsp/BSPRule;
     266: invokevirtual #29                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     269: iconst_0
     270: istore        8
     272: iload         8
     274: aload         7
     276: invokeinterface #225,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getTransforms:()Ljava/util/List;
     281: invokeinterface #127,  1          // InterfaceMethod java/util/List.size:()I
     286: if_icmpge     504
     289: aload         7
     291: invokeinterface #225,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getTransforms:()Ljava/util/List;
     296: iload         8
     298: invokeinterface #128,  2          // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     303: checkcast     #226                // class javax/xml/crypto/dsig/Transform
     306: astore        9
     308: aload         9
     310: invokeinterface #227,  1          // InterfaceMethod javax/xml/crypto/dsig/Transform.getAlgorithm:()Ljava/lang/String;
     315: astore        10
     317: ldc_w         #271                // String http://www.w3.org/2001/10/xml-exc-c14n#
     320: aload         10
     322: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     325: ifne          389
     328: ldc           #232                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform
     330: aload         10
     332: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     335: ifne          389
     338: ldc_w         #279                // String http://www.w3.org/2002/06/xmldsig-filter2
     341: aload         10
     343: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     346: ifne          389
     349: ldc_w         #280                // String http://www.w3.org/2000/09/xmldsig#enveloped-signature
     352: aload         10
     354: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     357: ifne          389
     360: ldc_w         #281                // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete-Signature-Transform
     363: aload         10
     365: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     368: ifne          389
     371: ldc_w         #282                // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Signature-Transform
     374: aload         10
     376: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     379: ifne          389
     382: aload_2
     383: getstatic     #283                // Field org/apache/wss4j/common/bsp/BSPRule.R5423:Lorg/apache/wss4j/common/bsp/BSPRule;
     386: invokevirtual #29                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     389: iload         8
     391: aload         7
     393: invokeinterface #225,  1          // InterfaceMethod javax/xml/crypto/dsig/Reference.getTransforms:()Ljava/util/List;
     398: invokeinterface #127,  1          // InterfaceMethod java/util/List.size:()I
     403: iconst_1
     404: isub
     405: if_icmpne     458
     408: ldc_w         #271                // String http://www.w3.org/2001/10/xml-exc-c14n#
     411: aload         10
     413: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     416: ifne          458
     419: ldc           #232                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform
     421: aload         10
     423: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     426: ifne          458
     429: ldc_w         #281                // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete-Signature-Transform
     432: aload         10
     434: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     437: ifne          458
     440: ldc_w         #282                // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Signature-Transform
     443: aload         10
     445: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     448: ifne          458
     451: aload_2
     452: getstatic     #284                // Field org/apache/wss4j/common/bsp/BSPRule.R5412:Lorg/apache/wss4j/common/bsp/BSPRule;
     455: invokevirtual #29                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     458: ldc_w         #271                // String http://www.w3.org/2001/10/xml-exc-c14n#
     461: aload         10
     463: invokevirtual #32                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     466: ifeq          498
     469: aload         9
     471: invokeinterface #285,  1          // InterfaceMethod javax/xml/crypto/dsig/Transform.getParameterSpec:()Ljava/security/spec/AlgorithmParameterSpec;
     476: astore        4
     478: aload         4
     480: ifnull        498
     483: aload         4
     485: instanceof    #277                // class javax/xml/crypto/dsig/spec/ExcC14NParameterSpec
     488: ifne          498
     491: aload_2
     492: getstatic     #286                // Field org/apache/wss4j/common/bsp/BSPRule.R5407:Lorg/apache/wss4j/common/bsp/BSPRule;
     495: invokevirtual #29                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     498: iinc          8, 1
     501: goto          272
     504: goto          221
     507: return

  static {};
    Code:
       0: ldc_w         #287                // class org/apache/wss4j/dom/processor/SignatureProcessor
       3: invokestatic  #288                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
       9: return
}
