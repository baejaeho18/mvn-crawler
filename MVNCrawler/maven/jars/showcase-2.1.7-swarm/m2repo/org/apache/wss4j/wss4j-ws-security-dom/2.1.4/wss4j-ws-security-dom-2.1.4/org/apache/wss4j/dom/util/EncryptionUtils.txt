Compiled from "EncryptionUtils.java"
public final class org.apache.wss4j.dom.util.EncryptionUtils {
  private org.apache.wss4j.dom.util.EncryptionUtils();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public static org.w3c.dom.Element findEncryptedDataElement(org.w3c.dom.Document, org.apache.wss4j.dom.WSDocInfo, java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: invokevirtual #2                  // Method org/apache/wss4j/dom/WSDocInfo.getCallbackLookup:()Lorg/apache/wss4j/dom/callback/CallbackLookup;
       4: astore_3
       5: aload_3
       6: aload_2
       7: aconst_null
       8: iconst_1
       9: invokeinterface #3,  4            // InterfaceMethod org/apache/wss4j/dom/callback/CallbackLookup.getElement:(Ljava/lang/String;Ljava/lang/String;Z)Lorg/w3c/dom/Element;
      14: astore        4
      16: aload         4
      18: ifnonnull     42
      21: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
      24: dup
      25: getstatic     #5                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      28: ldc           #6                  // String dataRef
      30: iconst_1
      31: anewarray     #7                  // class java/lang/Object
      34: dup
      35: iconst_0
      36: aload_2
      37: aastore
      38: invokespecial #8                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
      41: athrow
      42: aload         4
      44: invokeinterface #9,  1            // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      49: ldc           #10                 // String EncryptedHeader
      51: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      54: ifeq          115
      57: aload         4
      59: invokeinterface #12,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      64: ldc           #13                 // String http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd
      66: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      69: ifeq          115
      72: aload         4
      74: invokeinterface #14,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      79: astore        5
      81: aload         5
      83: ifnull        109
      86: aload         5
      88: invokeinterface #15,  1           // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
      93: iconst_1
      94: if_icmpeq     109
      97: aload         5
      99: invokeinterface #16,  1           // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
     104: astore        5
     106: goto          81
     109: aload         5
     111: checkcast     #17                 // class org/w3c/dom/Element
     114: areturn
     115: aload         4
     117: areturn

  public static org.apache.wss4j.dom.WSDataRef decryptEncryptedData(org.w3c.dom.Document, java.lang.String, org.w3c.dom.Element, javax.crypto.SecretKey, java.lang.String, javax.security.auth.callback.CallbackHandler) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_2
       1: aconst_null
       2: ldc           #18                 // String Type
       4: invokeinterface #19,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
       9: astore        6
      11: aload_2
      12: invokestatic  #20                 // Method getXOPURIFromEncryptedData:(Lorg/w3c/dom/Element;)Ljava/lang/String;
      15: astore        7
      17: aload         6
      19: ifnull        120
      22: ldc           #21                 // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Only
      24: aload         6
      26: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      29: ifne          42
      32: ldc           #22                 // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete
      34: aload         6
      36: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      39: ifeq          120
      42: aload_2
      43: ldc           #23                 // String CipherData
      45: ldc           #24                 // String http://www.w3.org/2001/04/xmlenc#
      47: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      50: astore        8
      52: aload         8
      54: ifnonnull     68
      57: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
      60: dup
      61: getstatic     #26                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      64: invokespecial #27                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      67: athrow
      68: aload         8
      70: ldc           #28                 // String CipherReference
      72: ldc           #24                 // String http://www.w3.org/2001/04/xmlenc#
      74: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      77: astore        9
      79: aload         9
      81: ifnonnull     95
      84: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
      87: dup
      88: getstatic     #26                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      91: invokespecial #27                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      94: athrow
      95: aload         9
      97: aconst_null
      98: ldc           #29                 // String URI
     100: invokeinterface #19,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     105: astore        10
     107: aload_1
     108: aload         10
     110: aload_2
     111: aload_3
     112: aload         4
     114: aload         5
     116: invokestatic  #30                 // Method decryptAttachment:(Ljava/lang/String;Ljava/lang/String;Lorg/w3c/dom/Element;Ljavax/crypto/SecretKey;Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)Lorg/apache/wss4j/dom/WSDataRef;
     119: areturn
     120: new           #31                 // class org/apache/wss4j/dom/WSDataRef
     123: dup
     124: invokespecial #32                 // Method org/apache/wss4j/dom/WSDataRef."<init>":()V
     127: astore        8
     129: aload         8
     131: aload_2
     132: invokevirtual #33                 // Method org/apache/wss4j/dom/WSDataRef.setEncryptedElement:(Lorg/w3c/dom/Element;)V
     135: aload         8
     137: aload_1
     138: invokevirtual #34                 // Method org/apache/wss4j/dom/WSDataRef.setWsuId:(Ljava/lang/String;)V
     141: aload         8
     143: aload         4
     145: invokevirtual #35                 // Method org/apache/wss4j/dom/WSDataRef.setAlgorithm:(Ljava/lang/String;)V
     148: aload_2
     149: invokestatic  #36                 // Method org/apache/wss4j/dom/util/X509Util.isContent:(Lorg/w3c/dom/Node;)Z
     152: istore        9
     154: aload         8
     156: iload         9
     158: invokevirtual #37                 // Method org/apache/wss4j/dom/WSDataRef.setContent:(Z)V
     161: aload_2
     162: astore        10
     164: aload_2
     165: invokeinterface #38,  1           // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
     170: astore        11
     172: aload_2
     173: invokeinterface #39,  1           // InterfaceMethod org/w3c/dom/Element.getPreviousSibling:()Lorg/w3c/dom/Node;
     178: astore        12
     180: iload         9
     182: ifeq          203
     185: aload_2
     186: invokeinterface #38,  1           // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
     191: checkcast     #17                 // class org/w3c/dom/Element
     194: astore_2
     195: aload_2
     196: invokeinterface #38,  1           // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
     201: astore        11
     203: aconst_null
     204: astore        13
     206: aload         4
     208: invokestatic  #40                 // Method org/apache/xml/security/encryption/XMLCipher.getInstance:(Ljava/lang/String;)Lorg/apache/xml/security/encryption/XMLCipher;
     211: astore        13
     213: aload         13
     215: iconst_1
     216: invokevirtual #41                 // Method org/apache/xml/security/encryption/XMLCipher.setSecureValidation:(Z)V
     219: aload         13
     221: iconst_2
     222: aload_3
     223: invokevirtual #42                 // Method org/apache/xml/security/encryption/XMLCipher.init:(ILjava/security/Key;)V
     226: goto          244
     229: astore        14
     231: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
     234: dup
     235: getstatic     #44                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.UNSUPPORTED_ALGORITHM:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     238: aload         14
     240: invokespecial #45                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     243: athrow
     244: aconst_null
     245: astore        14
     247: aload         7
     249: ifnull        284
     252: iload         9
     254: ifeq          264
     257: aload         10
     259: astore        15
     261: goto          267
     264: aload_2
     265: astore        15
     267: aload_3
     268: aload         4
     270: aload         5
     272: aload         7
     274: aload         15
     276: invokestatic  #46                 // Method decryptXopAttachment:(Ljavax/crypto/SecretKey;Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;Lorg/w3c/dom/Element;)Lorg/w3c/dom/Node;
     279: astore        14
     281: goto          294
     284: aload         13
     286: aload_0
     287: aload_2
     288: iload         9
     290: invokevirtual #47                 // Method org/apache/xml/security/encryption/XMLCipher.doFinal:(Lorg/w3c/dom/Document;Lorg/w3c/dom/Element;Z)Lorg/w3c/dom/Document;
     293: pop
     294: goto          312
     297: astore        15
     299: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
     302: dup
     303: getstatic     #26                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     306: aload         15
     308: invokespecial #45                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     311: athrow
     312: aload         11
     314: invokeinterface #49,  1           // InterfaceMethod org/w3c/dom/Node.getLocalName:()Ljava/lang/String;
     319: ldc           #10                 // String EncryptedHeader
     321: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     324: ifeq          342
     327: aload         11
     329: invokeinterface #50,  1           // InterfaceMethod org/w3c/dom/Node.getNamespaceURI:()Ljava/lang/String;
     334: ldc           #13                 // String http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd
     336: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     339: ifne          372
     342: aload         11
     344: invokeinterface #49,  1           // InterfaceMethod org/w3c/dom/Node.getLocalName:()Ljava/lang/String;
     349: ldc           #51                 // String EncryptedAssertion
     351: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     354: ifeq          425
     357: aload         11
     359: invokeinterface #50,  1           // InterfaceMethod org/w3c/dom/Node.getNamespaceURI:()Ljava/lang/String;
     364: ldc           #52                 // String urn:oasis:names:tc:SAML:2.0:assertion
     366: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     369: ifeq          425
     372: aload         11
     374: invokeinterface #53,  1           // InterfaceMethod org/w3c/dom/Node.getFirstChild:()Lorg/w3c/dom/Node;
     379: astore        15
     381: aload         11
     383: invokeinterface #54,  1           // InterfaceMethod org/w3c/dom/Node.getParentNode:()Lorg/w3c/dom/Node;
     388: astore        16
     390: aload         16
     392: aload         15
     394: aload         11
     396: invokeinterface #55,  3           // InterfaceMethod org/w3c/dom/Node.replaceChild:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     401: pop
     402: aload         8
     404: aload         15
     406: checkcast     #17                 // class org/w3c/dom/Element
     409: invokevirtual #56                 // Method org/apache/wss4j/dom/WSDataRef.setProtectedElement:(Lorg/w3c/dom/Element;)V
     412: aload         8
     414: aload         15
     416: invokestatic  #57                 // Method getXPath:(Lorg/w3c/dom/Node;)Ljava/lang/String;
     419: invokevirtual #58                 // Method org/apache/wss4j/dom/WSDataRef.setXpath:(Ljava/lang/String;)V
     422: goto          515
     425: iload         9
     427: ifeq          448
     430: aload         8
     432: aload_2
     433: invokevirtual #56                 // Method org/apache/wss4j/dom/WSDataRef.setProtectedElement:(Lorg/w3c/dom/Element;)V
     436: aload         8
     438: aload_2
     439: invokestatic  #57                 // Method getXPath:(Lorg/w3c/dom/Node;)Ljava/lang/String;
     442: invokevirtual #58                 // Method org/apache/wss4j/dom/WSDataRef.setXpath:(Ljava/lang/String;)V
     445: goto          515
     448: aload         14
     450: ifnonnull     479
     453: aload         12
     455: ifnonnull     470
     458: aload         11
     460: invokeinterface #53,  1           // InterfaceMethod org/w3c/dom/Node.getFirstChild:()Lorg/w3c/dom/Node;
     465: astore        14
     467: goto          479
     470: aload         12
     472: invokeinterface #16,  1           // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
     477: astore        14
     479: aload         14
     481: ifnull        505
     484: iconst_1
     485: aload         14
     487: invokeinterface #15,  1           // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
     492: if_icmpne     505
     495: aload         8
     497: aload         14
     499: checkcast     #17                 // class org/w3c/dom/Element
     502: invokevirtual #56                 // Method org/apache/wss4j/dom/WSDataRef.setProtectedElement:(Lorg/w3c/dom/Element;)V
     505: aload         8
     507: aload         14
     509: invokestatic  #57                 // Method getXPath:(Lorg/w3c/dom/Node;)Ljava/lang/String;
     512: invokevirtual #58                 // Method org/apache/wss4j/dom/WSDataRef.setXpath:(Ljava/lang/String;)V
     515: aload         8
     517: areturn
    Exception table:
       from    to  target type
         206   226   229   Class org/apache/xml/security/encryption/XMLEncryptionException
         247   294   297   Class java/lang/Exception

  private static java.lang.String getXOPURIFromEncryptedData(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: invokestatic  #59                 // Method getCipherValueFromEncryptedData:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
       4: astore_1
       5: aload_1
       6: ifnull        14
       9: aload_1
      10: invokestatic  #60                 // Method getXOPURIFromCipherValue:(Lorg/w3c/dom/Element;)Ljava/lang/String;
      13: areturn
      14: aconst_null
      15: areturn

  public static org.w3c.dom.Element getCipherValueFromEncryptedData(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: ldc           #23                 // String CipherData
       3: ldc           #24                 // String http://www.w3.org/2001/04/xmlenc#
       5: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
       8: astore_1
       9: aload_1
      10: ifnull        22
      13: aload_1
      14: ldc           #61                 // String CipherValue
      16: ldc           #24                 // String http://www.w3.org/2001/04/xmlenc#
      18: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      21: areturn
      22: aconst_null
      23: areturn

  public static java.lang.String getXOPURIFromCipherValue(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: ifnull        39
       4: aload_0
       5: ldc           #62                 // String Include
       7: ldc           #63                 // String http://www.w3.org/2004/08/xop/include
       9: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      12: astore_1
      13: aload_1
      14: ifnull        39
      17: aload_1
      18: aconst_null
      19: ldc           #64                 // String href
      21: invokeinterface #65,  3           // InterfaceMethod org/w3c/dom/Element.hasAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Z
      26: ifeq          39
      29: aload_1
      30: aconst_null
      31: ldc           #64                 // String href
      33: invokeinterface #19,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      38: areturn
      39: aconst_null
      40: areturn

  private static org.apache.wss4j.dom.WSDataRef decryptAttachment(java.lang.String, java.lang.String, org.w3c.dom.Element, javax.crypto.SecretKey, java.lang.String, javax.security.auth.callback.CallbackHandler) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #31                 // class org/apache/wss4j/dom/WSDataRef
       3: dup
       4: invokespecial #32                 // Method org/apache/wss4j/dom/WSDataRef."<init>":()V
       7: astore        6
       9: aload         6
      11: aload_0
      12: invokevirtual #34                 // Method org/apache/wss4j/dom/WSDataRef.setWsuId:(Ljava/lang/String;)V
      15: aload         6
      17: aload         4
      19: invokevirtual #35                 // Method org/apache/wss4j/dom/WSDataRef.setAlgorithm:(Ljava/lang/String;)V
      22: aload_1
      23: ifnull        43
      26: aload_1
      27: invokevirtual #66                 // Method java/lang/String.length:()I
      30: iconst_5
      31: if_icmplt     43
      34: aload_1
      35: ldc           #67                 // String cid:
      37: invokevirtual #68                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      40: ifne          54
      43: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
      46: dup
      47: getstatic     #26                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      50: invokespecial #27                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      53: athrow
      54: aload         6
      56: aload_1
      57: invokevirtual #34                 // Method org/apache/wss4j/dom/WSDataRef.setWsuId:(Ljava/lang/String;)V
      60: aload         6
      62: iconst_1
      63: invokevirtual #69                 // Method org/apache/wss4j/dom/WSDataRef.setAttachment:(Z)V
      66: aload         5
      68: ifnonnull     82
      71: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
      74: dup
      75: getstatic     #26                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      78: invokespecial #27                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      81: athrow
      82: aload_1
      83: ldc           #67                 // String cid:
      85: invokevirtual #66                 // Method java/lang/String.length:()I
      88: invokevirtual #70                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      91: astore        7
      93: new           #71                 // class org/apache/wss4j/common/ext/AttachmentRequestCallback
      96: dup
      97: invokespecial #72                 // Method org/apache/wss4j/common/ext/AttachmentRequestCallback."<init>":()V
     100: astore        8
     102: aload         8
     104: aload         7
     106: invokevirtual #73                 // Method org/apache/wss4j/common/ext/AttachmentRequestCallback.setAttachmentId:(Ljava/lang/String;)V
     109: aload         5
     111: iconst_1
     112: anewarray     #74                 // class javax/security/auth/callback/Callback
     115: dup
     116: iconst_0
     117: aload         8
     119: aastore
     120: invokeinterface #75,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     125: aload         8
     127: invokevirtual #76                 // Method org/apache/wss4j/common/ext/AttachmentRequestCallback.getAttachments:()Ljava/util/List;
     130: astore        9
     132: aload         9
     134: ifnull        169
     137: aload         9
     139: invokeinterface #77,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     144: ifne          169
     147: aload         7
     149: aload         9
     151: iconst_0
     152: invokeinterface #78,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     157: checkcast     #79                 // class org/apache/wss4j/common/ext/Attachment
     160: invokevirtual #80                 // Method org/apache/wss4j/common/ext/Attachment.getId:()Ljava/lang/String;
     163: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     166: ifne          191
     169: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
     172: dup
     173: getstatic     #5                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     176: ldc           #81                 // String empty
     178: iconst_1
     179: anewarray     #7                  // class java/lang/Object
     182: dup
     183: iconst_0
     184: ldc           #82                 // String Attachment not found
     186: aastore
     187: invokespecial #8                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     190: athrow
     191: aload         9
     193: iconst_0
     194: invokeinterface #78,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     199: checkcast     #79                 // class org/apache/wss4j/common/ext/Attachment
     202: astore        10
     204: aload_2
     205: invokestatic  #83                 // Method org/apache/wss4j/dom/util/X509Util.getEncAlgo:(Lorg/w3c/dom/Node;)Ljava/lang/String;
     208: astore        11
     210: aload         11
     212: invokestatic  #84                 // Method org/apache/xml/security/algorithms/JCEMapper.translateURItoJCEID:(Ljava/lang/String;)Ljava/lang/String;
     215: astore        12
     217: aload         12
     219: invokestatic  #85                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
     222: astore        13
     224: aload         11
     226: aload         13
     228: aload_3
     229: aload         10
     231: invokevirtual #86                 // Method org/apache/wss4j/common/ext/Attachment.getSourceStream:()Ljava/io/InputStream;
     234: invokestatic  #87                 // Method org/apache/wss4j/common/util/AttachmentUtils.setupAttachmentDecryptionStream:(Ljava/lang/String;Ljavax/crypto/Cipher;Ljava/security/Key;Ljava/io/InputStream;)Ljava/io/InputStream;
     237: astore        14
     239: new           #79                 // class org/apache/wss4j/common/ext/Attachment
     242: dup
     243: invokespecial #88                 // Method org/apache/wss4j/common/ext/Attachment."<init>":()V
     246: astore        15
     248: aload         15
     250: aload         10
     252: invokevirtual #80                 // Method org/apache/wss4j/common/ext/Attachment.getId:()Ljava/lang/String;
     255: invokevirtual #89                 // Method org/apache/wss4j/common/ext/Attachment.setId:(Ljava/lang/String;)V
     258: aload         15
     260: aload_2
     261: aconst_null
     262: ldc           #90                 // String MimeType
     264: invokeinterface #19,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     269: invokevirtual #91                 // Method org/apache/wss4j/common/ext/Attachment.setMimeType:(Ljava/lang/String;)V
     272: aload         15
     274: aload         14
     276: invokevirtual #92                 // Method org/apache/wss4j/common/ext/Attachment.setSourceStream:(Ljava/io/InputStream;)V
     279: aload         15
     281: aload         10
     283: invokevirtual #93                 // Method org/apache/wss4j/common/ext/Attachment.getHeaders:()Ljava/util/Map;
     286: invokevirtual #94                 // Method org/apache/wss4j/common/ext/Attachment.addHeaders:(Ljava/util/Map;)V
     289: aload_2
     290: aconst_null
     291: ldc           #18                 // String Type
     293: invokeinterface #19,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     298: astore        16
     300: ldc           #22                 // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete
     302: aload         16
     304: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     307: ifeq          320
     310: aload         15
     312: invokevirtual #93                 // Method org/apache/wss4j/common/ext/Attachment.getHeaders:()Ljava/util/Map;
     315: aload         14
     317: invokestatic  #95                 // Method org/apache/wss4j/common/util/AttachmentUtils.readAndReplaceEncryptedAttachmentHeaders:(Ljava/util/Map;Ljava/io/InputStream;)V
     320: new           #96                 // class org/apache/wss4j/common/ext/AttachmentResultCallback
     323: dup
     324: invokespecial #97                 // Method org/apache/wss4j/common/ext/AttachmentResultCallback."<init>":()V
     327: astore        17
     329: aload         17
     331: aload         15
     333: invokevirtual #98                 // Method org/apache/wss4j/common/ext/AttachmentResultCallback.setAttachment:(Lorg/apache/wss4j/common/ext/Attachment;)V
     336: aload         17
     338: aload         15
     340: invokevirtual #80                 // Method org/apache/wss4j/common/ext/Attachment.getId:()Ljava/lang/String;
     343: invokevirtual #99                 // Method org/apache/wss4j/common/ext/AttachmentResultCallback.setAttachmentId:(Ljava/lang/String;)V
     346: aload         5
     348: iconst_1
     349: anewarray     #74                 // class javax/security/auth/callback/Callback
     352: dup
     353: iconst_0
     354: aload         17
     356: aastore
     357: invokeinterface #75,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     362: goto          380
     365: astore        7
     367: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
     370: dup
     371: getstatic     #26                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     374: aload         7
     376: invokespecial #45                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     379: athrow
     380: aload         6
     382: iconst_1
     383: invokevirtual #37                 // Method org/apache/wss4j/dom/WSDataRef.setContent:(Z)V
     386: aload_2
     387: invokeinterface #38,  1           // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
     392: aload_2
     393: invokeinterface #104,  2          // InterfaceMethod org/w3c/dom/Node.removeChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     398: pop
     399: aload         6
     401: areturn
    Exception table:
       from    to  target type
          22   362   365   Class javax/security/auth/callback/UnsupportedCallbackException
          22   362   365   Class java/io/IOException
          22   362   365   Class java/security/NoSuchAlgorithmException
          22   362   365   Class javax/crypto/NoSuchPaddingException

  private static org.w3c.dom.Node decryptXopAttachment(javax.crypto.SecretKey, java.lang.String, javax.security.auth.callback.CallbackHandler, java.lang.String, org.w3c.dom.Element) throws org.apache.wss4j.common.ext.WSSecurityException, java.io.IOException, javax.security.auth.callback.UnsupportedCallbackException, java.security.NoSuchAlgorithmException, javax.crypto.NoSuchPaddingException, javax.xml.parsers.ParserConfigurationException, org.xml.sax.SAXException;
    Code:
       0: aload_2
       1: ifnonnull     15
       4: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
       7: dup
       8: getstatic     #26                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      11: invokespecial #27                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      14: athrow
      15: aload_3
      16: ldc           #67                 // String cid:
      18: invokevirtual #66                 // Method java/lang/String.length:()I
      21: invokevirtual #70                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      24: astore        5
      26: new           #71                 // class org/apache/wss4j/common/ext/AttachmentRequestCallback
      29: dup
      30: invokespecial #72                 // Method org/apache/wss4j/common/ext/AttachmentRequestCallback."<init>":()V
      33: astore        6
      35: aload         6
      37: aload         5
      39: invokevirtual #73                 // Method org/apache/wss4j/common/ext/AttachmentRequestCallback.setAttachmentId:(Ljava/lang/String;)V
      42: aload_2
      43: iconst_1
      44: anewarray     #74                 // class javax/security/auth/callback/Callback
      47: dup
      48: iconst_0
      49: aload         6
      51: aastore
      52: invokeinterface #75,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      57: aload         6
      59: invokevirtual #76                 // Method org/apache/wss4j/common/ext/AttachmentRequestCallback.getAttachments:()Ljava/util/List;
      62: astore        7
      64: aload         7
      66: ifnull        101
      69: aload         7
      71: invokeinterface #77,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      76: ifne          101
      79: aload         5
      81: aload         7
      83: iconst_0
      84: invokeinterface #78,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      89: checkcast     #79                 // class org/apache/wss4j/common/ext/Attachment
      92: invokevirtual #80                 // Method org/apache/wss4j/common/ext/Attachment.getId:()Ljava/lang/String;
      95: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      98: ifne          123
     101: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
     104: dup
     105: getstatic     #5                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     108: ldc           #81                 // String empty
     110: iconst_1
     111: anewarray     #7                  // class java/lang/Object
     114: dup
     115: iconst_0
     116: ldc           #82                 // String Attachment not found
     118: aastore
     119: invokespecial #8                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     122: athrow
     123: aload         7
     125: iconst_0
     126: invokeinterface #78,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     131: checkcast     #79                 // class org/apache/wss4j/common/ext/Attachment
     134: astore        8
     136: aload_1
     137: invokestatic  #84                 // Method org/apache/xml/security/algorithms/JCEMapper.translateURItoJCEID:(Ljava/lang/String;)Ljava/lang/String;
     140: astore        9
     142: aload         9
     144: invokestatic  #85                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
     147: astore        10
     149: aload_1
     150: aload         10
     152: aload_0
     153: aload         8
     155: invokevirtual #86                 // Method org/apache/wss4j/common/ext/Attachment.getSourceStream:()Ljava/io/InputStream;
     158: invokestatic  #87                 // Method org/apache/wss4j/common/util/AttachmentUtils.setupAttachmentDecryptionStream:(Ljava/lang/String;Ljavax/crypto/Cipher;Ljava/security/Key;Ljava/io/InputStream;)Ljava/io/InputStream;
     161: astore        11
     163: iconst_0
     164: invokestatic  #105                // Method org/apache/xml/security/utils/XMLUtils.createDocumentBuilder:(Z)Ljavax/xml/parsers/DocumentBuilder;
     167: astore        12
     169: aload         12
     171: aload         11
     173: invokevirtual #106                // Method javax/xml/parsers/DocumentBuilder.parse:(Ljava/io/InputStream;)Lorg/w3c/dom/Document;
     176: astore        13
     178: aload         4
     180: invokeinterface #107,  1          // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     185: aload         13
     187: invokeinterface #108,  1          // InterfaceMethod org/w3c/dom/Document.getDocumentElement:()Lorg/w3c/dom/Element;
     192: iconst_1
     193: invokeinterface #109,  3          // InterfaceMethod org/w3c/dom/Document.importNode:(Lorg/w3c/dom/Node;Z)Lorg/w3c/dom/Node;
     198: astore        14
     200: aload         4
     202: invokeinterface #38,  1           // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
     207: aload         14
     209: invokeinterface #110,  2          // InterfaceMethod org/w3c/dom/Node.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     214: pop
     215: aload         12
     217: invokestatic  #111                // Method org/apache/xml/security/utils/XMLUtils.repoolDocumentBuilder:(Ljavax/xml/parsers/DocumentBuilder;)Z
     220: pop
     221: aload         4
     223: invokeinterface #38,  1           // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
     228: aload         4
     230: invokeinterface #104,  2          // InterfaceMethod org/w3c/dom/Node.removeChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     235: pop
     236: aload         14
     238: areturn

  public static java.lang.String getXPath(org.w3c.dom.Node);
    Code:
       0: aload_0
       1: ifnonnull     6
       4: aconst_null
       5: areturn
       6: ldc           #112                // String
       8: astore_1
       9: iconst_1
      10: aload_0
      11: invokeinterface #15,  1           // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
      16: if_icmpne     40
      19: aload_0
      20: invokeinterface #113,  1          // InterfaceMethod org/w3c/dom/Node.getNodeName:()Ljava/lang/String;
      25: astore_1
      26: aload_1
      27: aload_0
      28: invokeinterface #54,  1           // InterfaceMethod org/w3c/dom/Node.getParentNode:()Lorg/w3c/dom/Node;
      33: invokestatic  #114                // Method prependFullPath:(Ljava/lang/String;Lorg/w3c/dom/Node;)Ljava/lang/String;
      36: astore_1
      37: goto          94
      40: iconst_2
      41: aload_0
      42: invokeinterface #15,  1           // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
      47: if_icmpne     92
      50: new           #115                // class java/lang/StringBuilder
      53: dup
      54: invokespecial #116                // Method java/lang/StringBuilder."<init>":()V
      57: ldc           #117                // String @
      59: invokevirtual #118                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      62: aload_0
      63: invokeinterface #113,  1          // InterfaceMethod org/w3c/dom/Node.getNodeName:()Ljava/lang/String;
      68: invokevirtual #118                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      71: invokevirtual #119                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      74: astore_1
      75: aload_1
      76: aload_0
      77: checkcast     #120                // class org/w3c/dom/Attr
      80: invokeinterface #121,  1          // InterfaceMethod org/w3c/dom/Attr.getOwnerElement:()Lorg/w3c/dom/Element;
      85: invokestatic  #114                // Method prependFullPath:(Ljava/lang/String;Lorg/w3c/dom/Node;)Ljava/lang/String;
      88: astore_1
      89: goto          94
      92: aconst_null
      93: areturn
      94: aload_1
      95: areturn

  private static java.lang.String prependFullPath(java.lang.String, org.w3c.dom.Node);
    Code:
       0: aload_1
       1: ifnonnull     6
       4: aconst_null
       5: areturn
       6: iconst_1
       7: aload_1
       8: invokeinterface #15,  1           // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
      13: if_icmpne     56
      16: new           #115                // class java/lang/StringBuilder
      19: dup
      20: invokespecial #116                // Method java/lang/StringBuilder."<init>":()V
      23: aload_1
      24: invokeinterface #113,  1          // InterfaceMethod org/w3c/dom/Node.getNodeName:()Ljava/lang/String;
      29: invokevirtual #118                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      32: ldc           #122                // String /
      34: invokevirtual #118                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      37: aload_0
      38: invokevirtual #118                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      41: invokevirtual #119                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      44: astore_0
      45: aload_0
      46: aload_1
      47: invokeinterface #54,  1           // InterfaceMethod org/w3c/dom/Node.getParentNode:()Lorg/w3c/dom/Node;
      52: invokestatic  #114                // Method prependFullPath:(Ljava/lang/String;Lorg/w3c/dom/Node;)Ljava/lang/String;
      55: areturn
      56: bipush        9
      58: aload_1
      59: invokeinterface #15,  1           // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
      64: if_icmpne     87
      67: new           #115                // class java/lang/StringBuilder
      70: dup
      71: invokespecial #116                // Method java/lang/StringBuilder."<init>":()V
      74: ldc           #122                // String /
      76: invokevirtual #118                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      79: aload_0
      80: invokevirtual #118                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      83: invokevirtual #119                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      86: areturn
      87: aload_0
      88: aload_1
      89: invokeinterface #54,  1           // InterfaceMethod org/w3c/dom/Node.getParentNode:()Lorg/w3c/dom/Node;
      94: invokestatic  #114                // Method prependFullPath:(Ljava/lang/String;Lorg/w3c/dom/Node;)Ljava/lang/String;
      97: areturn

  public static java.lang.String getDigestAlgorithm(org.w3c.dom.Node) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: ldc           #123                // String EncryptionMethod
       3: ldc           #24                 // String http://www.w3.org/2001/04/xmlenc#
       5: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
       8: astore_1
       9: aload_1
      10: ifnull        36
      13: aload_1
      14: ldc           #124                // String DigestMethod
      16: ldc           #125                // String http://www.w3.org/2000/09/xmldsig#
      18: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      21: astore_2
      22: aload_2
      23: ifnull        36
      26: aload_2
      27: aconst_null
      28: ldc           #126                // String Algorithm
      30: invokeinterface #19,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      35: areturn
      36: aconst_null
      37: areturn

  public static java.lang.String getMGFAlgorithm(org.w3c.dom.Node) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: ldc           #123                // String EncryptionMethod
       3: ldc           #24                 // String http://www.w3.org/2001/04/xmlenc#
       5: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
       8: astore_1
       9: aload_1
      10: ifnull        36
      13: aload_1
      14: ldc           #127                // String MGF
      16: ldc           #128                // String http://www.w3.org/2009/xmlenc11#
      18: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      21: astore_2
      22: aload_2
      23: ifnull        36
      26: aload_2
      27: aconst_null
      28: ldc           #126                // String Algorithm
      30: invokeinterface #19,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      35: areturn
      36: aconst_null
      37: areturn

  public static byte[] getPSource(org.w3c.dom.Node) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: ldc           #123                // String EncryptionMethod
       3: ldc           #24                 // String http://www.w3.org/2001/04/xmlenc#
       5: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
       8: astore_1
       9: aload_1
      10: ifnull        31
      13: aload_1
      14: ldc           #129                // String OAEPparams
      16: ldc           #24                 // String http://www.w3.org/2001/04/xmlenc#
      18: invokestatic  #25                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      21: astore_2
      22: aload_2
      23: ifnull        31
      26: aload_2
      27: invokestatic  #130                // Method getDecodedBase64EncodedData:(Lorg/w3c/dom/Element;)[B
      30: areturn
      31: aconst_null
      32: areturn

  public static byte[] getDecodedBase64EncodedData(org.w3c.dom.Element) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: invokestatic  #131                // Method org/apache/wss4j/common/util/XMLUtils.getElementText:(Lorg/w3c/dom/Element;)Ljava/lang/String;
       4: astore_1
       5: aload_1
       6: ifnonnull     11
       9: aconst_null
      10: areturn
      11: aload_1
      12: invokestatic  #132                // Method org/apache/xml/security/utils/Base64.decode:(Ljava/lang/String;)[B
      15: areturn
      16: astore_1
      17: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
      20: dup
      21: getstatic     #134                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      24: aload_1
      25: ldc           #135                // String decoding.general
      27: invokespecial #136                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
      30: athrow
    Exception table:
       from    to  target type
           0    10    16   Class org/apache/xml/security/exceptions/Base64DecodingException
          11    15    16   Class org/apache/xml/security/exceptions/Base64DecodingException
}
