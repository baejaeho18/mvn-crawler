Compiled from "CryptoBase.java"
public abstract class org.apache.wss4j.common.crypto.CryptoBase implements org.apache.wss4j.common.crypto.Crypto {
  public static final java.lang.String SKI_OID;

  public static final java.lang.String NAME_CONSTRAINTS_OID;

  private static final org.slf4j.Logger LOG;

  private static final java.lang.reflect.Constructor<?> BC_509CLASS_CONS;

  protected java.security.cert.CertificateFactory certificateFactory;

  private java.lang.String defaultAlias;

  private java.lang.String cryptoProvider;

  protected org.apache.wss4j.common.crypto.CryptoBase();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public java.lang.String getCryptoProvider();
    Code:
       0: aload_0
       1: getfield      #2                  // Field cryptoProvider:Ljava/lang/String;
       4: areturn

  public void setCryptoProvider(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #2                  // Field cryptoProvider:Ljava/lang/String;
       5: return

  public java.lang.String getDefaultX509Identifier() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #3                  // Field defaultAlias:Ljava/lang/String;
       4: areturn

  public void setDefaultX509Identifier(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #3                  // Field defaultAlias:Ljava/lang/String;
       5: return

  public void setCertificateFactory(java.security.cert.CertificateFactory);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #4                  // Field certificateFactory:Ljava/security/cert/CertificateFactory;
       5: return

  public java.security.cert.CertificateFactory getCertificateFactory() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #4                  // Field certificateFactory:Ljava/security/cert/CertificateFactory;
       4: ifnull        12
       7: aload_0
       8: getfield      #4                  // Field certificateFactory:Ljava/security/cert/CertificateFactory;
      11: areturn
      12: aload_0
      13: invokevirtual #5                  // Method getCryptoProvider:()Ljava/lang/String;
      16: astore_1
      17: aload_1
      18: ifnull        28
      21: aload_1
      22: invokevirtual #6                  // Method java/lang/String.length:()I
      25: ifne          40
      28: aload_0
      29: ldc           #7                  // String X.509
      31: invokestatic  #8                  // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
      34: putfield      #4                  // Field certificateFactory:Ljava/security/cert/CertificateFactory;
      37: goto          50
      40: aload_0
      41: ldc           #7                  // String X.509
      43: aload_1
      44: invokestatic  #9                  // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
      47: putfield      #4                  // Field certificateFactory:Ljava/security/cert/CertificateFactory;
      50: goto          83
      53: astore_1
      54: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
      57: dup
      58: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      61: aload_1
      62: ldc           #13                 // String unsupportedCertType
      64: invokespecial #14                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
      67: athrow
      68: astore_1
      69: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
      72: dup
      73: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      76: aload_1
      77: ldc           #16                 // String noSecProvider
      79: invokespecial #14                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
      82: athrow
      83: aload_0
      84: getfield      #4                  // Field certificateFactory:Ljava/security/cert/CertificateFactory;
      87: areturn
    Exception table:
       from    to  target type
          12    50    53   Class java/security/cert/CertificateException
          12    50    68   Class java/security/NoSuchProviderException

  public java.security.cert.X509Certificate loadCertificate(java.io.InputStream) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: invokevirtual #17                 // Method getCertificateFactory:()Ljava/security/cert/CertificateFactory;
       4: astore_2
       5: aload_2
       6: aload_1
       7: invokevirtual #18                 // Method java/security/cert/CertificateFactory.generateCertificate:(Ljava/io/InputStream;)Ljava/security/cert/Certificate;
      10: checkcast     #19                 // class java/security/cert/X509Certificate
      13: areturn
      14: astore_2
      15: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
      18: dup
      19: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      22: aload_2
      23: ldc           #20                 // String parseError
      25: invokespecial #14                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
      28: athrow
    Exception table:
       from    to  target type
           0    13    14   Class java/security/cert/CertificateException

  public byte[] getSKIBytesFromCert(java.security.cert.X509Certificate) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ldc           #21                 // String 2.5.29.14
       3: invokevirtual #22                 // Method java/security/cert/X509Certificate.getExtensionValue:(Ljava/lang/String;)[B
       6: astore_2
       7: aload_1
       8: invokevirtual #23                 // Method java/security/cert/X509Certificate.getVersion:()I
      11: iconst_3
      12: if_icmplt     19
      15: aload_2
      16: ifnonnull     78
      19: new           #24                 // class org/apache/wss4j/common/crypto/X509SubjectPublicKeyInfo
      22: dup
      23: aload_1
      24: invokevirtual #25                 // Method java/security/cert/X509Certificate.getPublicKey:()Ljava/security/PublicKey;
      27: invokespecial #26                 // Method org/apache/wss4j/common/crypto/X509SubjectPublicKeyInfo."<init>":(Ljava/security/PublicKey;)V
      30: astore_3
      31: aload_3
      32: invokevirtual #27                 // Method org/apache/wss4j/common/crypto/X509SubjectPublicKeyInfo.getSubjectPublicKey:()[B
      35: astore        4
      37: ldc           #28                 // String SHA-1
      39: invokestatic  #29                 // Method java/security/MessageDigest.getInstance:(Ljava/lang/String;)Ljava/security/MessageDigest;
      42: astore        5
      44: aload         5
      46: aload         4
      48: invokevirtual #30                 // Method java/security/MessageDigest.digest:([B)[B
      51: areturn
      52: astore        5
      54: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
      57: dup
      58: getstatic     #32                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.UNSUPPORTED_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      61: aload         5
      63: ldc           #33                 // String noSKIHandling
      65: iconst_1
      66: anewarray     #34                 // class java/lang/Object
      69: dup
      70: iconst_0
      71: ldc           #35                 // String No SKI certificate extension and no SHA1 message digest available
      73: aastore
      74: invokespecial #36                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
      77: athrow
      78: new           #37                 // class org/apache/wss4j/common/crypto/DERDecoder
      81: dup
      82: aload_2
      83: invokespecial #38                 // Method org/apache/wss4j/common/crypto/DERDecoder."<init>":([B)V
      86: astore_3
      87: aload_3
      88: iconst_4
      89: invokevirtual #39                 // Method org/apache/wss4j/common/crypto/DERDecoder.expect:(B)V
      92: aload_3
      93: invokevirtual #40                 // Method org/apache/wss4j/common/crypto/DERDecoder.getLength:()I
      96: pop
      97: aload_3
      98: iconst_4
      99: invokevirtual #39                 // Method org/apache/wss4j/common/crypto/DERDecoder.expect:(B)V
     102: aload_3
     103: invokevirtual #40                 // Method org/apache/wss4j/common/crypto/DERDecoder.getLength:()I
     106: istore        4
     108: aload_3
     109: iload         4
     111: invokevirtual #41                 // Method org/apache/wss4j/common/crypto/DERDecoder.getBytes:(I)[B
     114: areturn
    Exception table:
       from    to  target type
          37    51    52   Class java/lang/Exception

  public byte[] getBytesFromCertificates(java.security.cert.X509Certificate[]) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: invokevirtual #17                 // Method getCertificateFactory:()Ljava/security/cert/CertificateFactory;
       4: aload_1
       5: invokestatic  #42                 // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
       8: invokevirtual #43                 // Method java/security/cert/CertificateFactory.generateCertPath:(Ljava/util/List;)Ljava/security/cert/CertPath;
      11: astore_2
      12: aload_2
      13: invokevirtual #44                 // Method java/security/cert/CertPath.getEncoded:()[B
      16: areturn
      17: astore_2
      18: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
      21: dup
      22: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      25: aload_2
      26: ldc           #46                 // String encodeError
      28: invokespecial #14                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
      31: athrow
      32: astore_2
      33: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
      36: dup
      37: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      40: aload_2
      41: ldc           #20                 // String parseError
      43: invokespecial #14                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
      46: athrow
    Exception table:
       from    to  target type
           0    16    17   Class java/security/cert/CertificateEncodingException
           0    16    32   Class java/security/cert/CertificateException

  public java.security.cert.X509Certificate[] getCertificatesFromBytes(byte[]) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aconst_null
       1: astore_2
       2: new           #47                 // class java/io/ByteArrayInputStream
       5: dup
       6: aload_1
       7: invokespecial #48                 // Method java/io/ByteArrayInputStream."<init>":([B)V
      10: astore_3
      11: aconst_null
      12: astore        4
      14: aload_0
      15: invokevirtual #17                 // Method getCertificateFactory:()Ljava/security/cert/CertificateFactory;
      18: aload_3
      19: invokevirtual #49                 // Method java/security/cert/CertificateFactory.generateCertPath:(Ljava/io/InputStream;)Ljava/security/cert/CertPath;
      22: astore_2
      23: aload_3
      24: ifnull        104
      27: aload         4
      29: ifnull        51
      32: aload_3
      33: invokevirtual #50                 // Method java/io/InputStream.close:()V
      36: goto          104
      39: astore        5
      41: aload         4
      43: aload         5
      45: invokevirtual #52                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
      48: goto          104
      51: aload_3
      52: invokevirtual #50                 // Method java/io/InputStream.close:()V
      55: goto          104
      58: astore        5
      60: aload         5
      62: astore        4
      64: aload         5
      66: athrow
      67: astore        6
      69: aload_3
      70: ifnull        101
      73: aload         4
      75: ifnull        97
      78: aload_3
      79: invokevirtual #50                 // Method java/io/InputStream.close:()V
      82: goto          101
      85: astore        7
      87: aload         4
      89: aload         7
      91: invokevirtual #52                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
      94: goto          101
      97: aload_3
      98: invokevirtual #50                 // Method java/io/InputStream.close:()V
     101: aload         6
     103: athrow
     104: goto          122
     107: astore_3
     108: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
     111: dup
     112: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     115: aload_3
     116: ldc           #20                 // String parseError
     118: invokespecial #14                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     121: athrow
     122: aload_2
     123: invokevirtual #54                 // Method java/security/cert/CertPath.getCertificates:()Ljava/util/List;
     126: astore_3
     127: aload_3
     128: invokeinterface #55,  1           // InterfaceMethod java/util/List.size:()I
     133: anewarray     #19                 // class java/security/cert/X509Certificate
     136: astore        4
     138: iconst_0
     139: istore        5
     141: aload_3
     142: invokeinterface #56,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     147: astore        6
     149: aload         6
     151: invokeinterface #57,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     156: ifeq          180
     159: aload         4
     161: iload         5
     163: iinc          5, 1
     166: aload         6
     168: invokeinterface #58,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     173: checkcast     #19                 // class java/security/cert/X509Certificate
     176: aastore
     177: goto          149
     180: aload         4
     182: areturn
    Exception table:
       from    to  target type
          32    36    39   Class java/lang/Throwable
          14    23    58   Class java/lang/Throwable
          14    23    67   any
          78    82    85   Class java/lang/Throwable
          58    69    67   any
           2   104   107   Class java/security/cert/CertificateException
           2   104   107   Class java/io/IOException

  public void verifyDirectTrust(java.security.cert.X509Certificate[]) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: iconst_1
       3: aconst_null
       4: invokevirtual #59                 // Method verifyTrust:([Ljava/security/cert/X509Certificate;ZLjava/util/Collection;)V
       7: return

  protected java.lang.Object createBCX509Name(java.lang.String);
    Code:
       0: getstatic     #60                 // Field BC_509CLASS_CONS:Ljava/lang/reflect/Constructor;
       3: ifnull        22
       6: getstatic     #60                 // Field BC_509CLASS_CONS:Ljava/lang/reflect/Constructor;
       9: iconst_1
      10: anewarray     #34                 // class java/lang/Object
      13: dup
      14: iconst_0
      15: aload_1
      16: aastore
      17: invokevirtual #61                 // Method java/lang/reflect/Constructor.newInstance:([Ljava/lang/Object;)Ljava/lang/Object;
      20: areturn
      21: astore_2
      22: new           #62                 // class javax/security/auth/x500/X500Principal
      25: dup
      26: aload_1
      27: invokespecial #63                 // Method javax/security/auth/x500/X500Principal."<init>":(Ljava/lang/String;)V
      30: areturn
    Exception table:
       from    to  target type
           6    20    21   Class java/lang/Exception

  protected boolean matches(java.security.cert.X509Certificate, java.util.Collection<java.util.regex.Pattern>);
    Code:
       0: aload_2
       1: ifnull        13
       4: aload_2
       5: invokeinterface #64,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
      10: ifeq          25
      13: getstatic     #65                 // Field LOG:Lorg/slf4j/Logger;
      16: ldc           #66                 // String No Subject DN Certificate Constraints were defined. This could be a security issue
      18: invokeinterface #67,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      23: iconst_1
      24: ireturn
      25: aload_2
      26: invokeinterface #64,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
      31: ifne          171
      34: aload_1
      35: ifnonnull     50
      38: getstatic     #65                 // Field LOG:Lorg/slf4j/Logger;
      41: ldc           #68                 // String The certificate is null so no constraints matching was possible
      43: invokeinterface #69,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      48: iconst_0
      49: ireturn
      50: aload_1
      51: invokevirtual #70                 // Method java/security/cert/X509Certificate.getSubjectX500Principal:()Ljavax/security/auth/x500/X500Principal;
      54: invokevirtual #71                 // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
      57: astore_3
      58: iconst_0
      59: istore        4
      61: aload_2
      62: invokeinterface #72,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      67: astore        5
      69: aload         5
      71: invokeinterface #57,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      76: ifeq          164
      79: aload         5
      81: invokeinterface #58,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      86: checkcast     #73                 // class java/util/regex/Pattern
      89: astore        6
      91: aload         6
      93: aload_3
      94: invokevirtual #74                 // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
      97: astore        7
      99: aload         7
     101: invokevirtual #75                 // Method java/util/regex/Matcher.matches:()Z
     104: ifeq          161
     107: getstatic     #65                 // Field LOG:Lorg/slf4j/Logger;
     110: invokeinterface #76,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     115: ifeq          155
     118: getstatic     #65                 // Field LOG:Lorg/slf4j/Logger;
     121: new           #77                 // class java/lang/StringBuilder
     124: dup
     125: invokespecial #78                 // Method java/lang/StringBuilder."<init>":()V
     128: ldc           #79                 // String Subject DN
     130: invokevirtual #80                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     133: aload_3
     134: invokevirtual #80                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     137: ldc           #81                 // String  matches with pattern
     139: invokevirtual #80                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     142: aload         6
     144: invokevirtual #82                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     147: invokevirtual #83                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     150: invokeinterface #69,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     155: iconst_1
     156: istore        4
     158: goto          164
     161: goto          69
     164: iload         4
     166: ifne          171
     169: iconst_0
     170: ireturn
     171: iconst_1
     172: ireturn

  static {};
    Code:
       0: ldc_w         #84                 // class org/apache/wss4j/common/crypto/CryptoBase
       3: invokestatic  #85                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #65                 // Field LOG:Lorg/slf4j/Logger;
       9: aconst_null
      10: astore_0
      11: ldc           #86                 // String org.bouncycastle.asn1.x500.X500Name
      13: invokestatic  #87                 // Method java/lang/Class.forName:(Ljava/lang/String;)Ljava/lang/Class;
      16: astore_1
      17: aload_1
      18: iconst_1
      19: anewarray     #88                 // class java/lang/Class
      22: dup
      23: iconst_0
      24: ldc_w         #89                 // class java/lang/String
      27: aastore
      28: invokevirtual #90                 // Method java/lang/Class.getConstructor:([Ljava/lang/Class;)Ljava/lang/reflect/Constructor;
      31: astore_0
      32: goto          36
      35: astore_1
      36: aload_0
      37: putstatic     #60                 // Field BC_509CLASS_CONS:Ljava/lang/reflect/Constructor;
      40: return
    Exception table:
       from    to  target type
          11    32    35   Class java/lang/Exception
}
