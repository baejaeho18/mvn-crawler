Compiled from "DerivedKeyTokenSTRParser.java"
public class org.apache.wss4j.dom.str.DerivedKeyTokenSTRParser implements org.apache.wss4j.dom.str.STRParser {
  public org.apache.wss4j.dom.str.DerivedKeyTokenSTRParser();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public org.apache.wss4j.dom.str.STRParserResult parseSecurityTokenReference(org.apache.wss4j.dom.str.STRParserParameters) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnull        25
       4: aload_1
       5: invokevirtual #2                  // Method org/apache/wss4j/dom/str/STRParserParameters.getData:()Lorg/apache/wss4j/dom/handler/RequestData;
       8: ifnull        25
      11: aload_1
      12: invokevirtual #3                  // Method org/apache/wss4j/dom/str/STRParserParameters.getWsDocInfo:()Lorg/apache/wss4j/dom/WSDocInfo;
      15: ifnull        25
      18: aload_1
      19: invokevirtual #4                  // Method org/apache/wss4j/dom/str/STRParserParameters.getStrElement:()Lorg/w3c/dom/Element;
      22: ifnonnull     38
      25: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
      28: dup
      29: getstatic     #6                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      32: ldc           #7                  // String invalidSTRParserParameter
      34: invokespecial #8                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      37: athrow
      38: new           #9                  // class org/apache/wss4j/common/token/SecurityTokenReference
      41: dup
      42: aload_1
      43: invokevirtual #4                  // Method org/apache/wss4j/dom/str/STRParserParameters.getStrElement:()Lorg/w3c/dom/Element;
      46: aload_1
      47: invokevirtual #2                  // Method org/apache/wss4j/dom/str/STRParserParameters.getData:()Lorg/apache/wss4j/dom/handler/RequestData;
      50: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
      53: invokespecial #11                 // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      56: astore_2
      57: aconst_null
      58: astore_3
      59: aload_2
      60: invokevirtual #12                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getReference:()Lorg/apache/wss4j/common/token/Reference;
      63: ifnull        82
      66: aload_2
      67: invokevirtual #12                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getReference:()Lorg/apache/wss4j/common/token/Reference;
      70: invokevirtual #13                 // Method org/apache/wss4j/common/token/Reference.getURI:()Ljava/lang/String;
      73: astore_3
      74: aload_3
      75: invokestatic  #14                 // Method org/apache/wss4j/common/util/XMLUtils.getIDFromReference:(Ljava/lang/String;)Ljava/lang/String;
      78: astore_3
      79: goto          94
      82: aload_2
      83: invokevirtual #15                 // Method org/apache/wss4j/common/token/SecurityTokenReference.containsKeyIdentifier:()Z
      86: ifeq          94
      89: aload_2
      90: invokevirtual #16                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValue:()Ljava/lang/String;
      93: astore_3
      94: aload_1
      95: invokevirtual #3                  // Method org/apache/wss4j/dom/str/STRParserParameters.getWsDocInfo:()Lorg/apache/wss4j/dom/WSDocInfo;
      98: aload_3
      99: invokevirtual #17                 // Method org/apache/wss4j/dom/WSDocInfo.getResult:(Ljava/lang/String;)Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;
     102: astore        4
     104: aload         4
     106: ifnull        118
     109: aload_0
     110: aload         4
     112: aload_2
     113: aload_1
     114: invokespecial #18                 // Method processPreviousResult:(Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/dom/str/STRParserParameters;)Lorg/apache/wss4j/dom/str/STRParserResult;
     117: areturn
     118: aload_0
     119: aload_2
     120: aload_3
     121: aload_1
     122: invokespecial #19                 // Method processSTR:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Ljava/lang/String;Lorg/apache/wss4j/dom/str/STRParserParameters;)Lorg/apache/wss4j/dom/str/STRParserResult;
     125: areturn

  private org.apache.wss4j.dom.str.STRParserResult processPreviousResult(org.apache.wss4j.dom.engine.WSSecurityEngineResult, org.apache.wss4j.common.token.SecurityTokenReference, org.apache.wss4j.dom.str.STRParserParameters) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #20                 // class org/apache/wss4j/dom/str/STRParserResult
       3: dup
       4: invokespecial #21                 // Method org/apache/wss4j/dom/str/STRParserResult."<init>":()V
       7: astore        4
       9: aload_3
      10: invokevirtual #2                  // Method org/apache/wss4j/dom/str/STRParserParameters.getData:()Lorg/apache/wss4j/dom/handler/RequestData;
      13: astore        5
      15: aload_1
      16: ldc           #22                 // String action
      18: invokevirtual #23                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      21: checkcast     #24                 // class java/lang/Integer
      24: astore        6
      26: aload         6
      28: ifnull        84
      31: sipush        8192
      34: aload         6
      36: invokevirtual #25                 // Method java/lang/Integer.intValue:()I
      39: if_icmpeq     51
      42: iconst_1
      43: aload         6
      45: invokevirtual #25                 // Method java/lang/Integer.intValue:()I
      48: if_icmpne     84
      51: aload_2
      52: aload         5
      54: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
      57: invokestatic  #26                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkUsernameTokenBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      60: aload_1
      61: ldc           #27                 // String secret
      63: invokevirtual #23                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      66: checkcast     #28                 // class "[B"
      69: checkcast     #28                 // class "[B"
      72: astore        7
      74: aload         4
      76: aload         7
      78: invokevirtual #29                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
      81: goto          289
      84: aload         6
      86: ifnull        131
      89: iconst_4
      90: aload         6
      92: invokevirtual #25                 // Method java/lang/Integer.intValue:()I
      95: if_icmpne     131
      98: aload_2
      99: aload         5
     101: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     104: invokestatic  #30                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkEncryptedKeyBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     107: aload_1
     108: ldc           #27                 // String secret
     110: invokevirtual #23                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     113: checkcast     #28                 // class "[B"
     116: checkcast     #28                 // class "[B"
     119: astore        7
     121: aload         4
     123: aload         7
     125: invokevirtual #29                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     128: goto          289
     131: aload         6
     133: ifnull        182
     136: sipush        1024
     139: aload         6
     141: invokevirtual #25                 // Method java/lang/Integer.intValue:()I
     144: if_icmpeq     158
     147: sipush        4096
     150: aload         6
     152: invokevirtual #25                 // Method java/lang/Integer.intValue:()I
     155: if_icmpne     182
     158: aload_1
     159: ldc           #27                 // String secret
     161: invokevirtual #23                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     164: checkcast     #28                 // class "[B"
     167: checkcast     #28                 // class "[B"
     170: astore        7
     172: aload         4
     174: aload         7
     176: invokevirtual #29                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     179: goto          289
     182: aload         6
     184: ifnull        276
     187: bipush        8
     189: aload         6
     191: invokevirtual #25                 // Method java/lang/Integer.intValue:()I
     194: if_icmpeq     207
     197: bipush        16
     199: aload         6
     201: invokevirtual #25                 // Method java/lang/Integer.intValue:()I
     204: if_icmpne     276
     207: aload_1
     208: ldc           #31                 // String saml-assertion
     210: invokevirtual #23                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     213: checkcast     #32                 // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     216: astore        7
     218: aload_2
     219: aload         7
     221: aload         5
     223: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     226: invokestatic  #33                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkSamlTokenBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     229: aload         7
     231: new           #34                 // class org/apache/wss4j/dom/saml/WSSSAMLKeyInfoProcessor
     234: dup
     235: aload         5
     237: aload_3
     238: invokevirtual #3                  // Method org/apache/wss4j/dom/str/STRParserParameters.getWsDocInfo:()Lorg/apache/wss4j/dom/WSDocInfo;
     241: invokespecial #35                 // Method org/apache/wss4j/dom/saml/WSSSAMLKeyInfoProcessor."<init>":(Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)V
     244: aload         5
     246: invokevirtual #36                 // Method org/apache/wss4j/dom/handler/RequestData.getSigVerCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     249: aload         5
     251: invokevirtual #37                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     254: invokestatic  #38                 // Method org/apache/wss4j/common/saml/SAMLUtil.getCredentialFromSubject:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/common/saml/SAMLKeyInfoProcessor;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;)Lorg/apache/wss4j/common/saml/SAMLKeyInfo;
     257: astore        8
     259: aload         8
     261: invokevirtual #39                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getSecret:()[B
     264: astore        9
     266: aload         4
     268: aload         9
     270: invokevirtual #29                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     273: goto          289
     276: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
     279: dup
     280: getstatic     #40                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     283: ldc           #41                 // String unsupportedKeyId
     285: invokespecial #8                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     288: athrow
     289: aload         4
     291: areturn

  private org.apache.wss4j.dom.str.STRParserResult processSTR(org.apache.wss4j.common.token.SecurityTokenReference, java.lang.String, org.apache.wss4j.dom.str.STRParserParameters) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #20                 // class org/apache/wss4j/dom/str/STRParserResult
       3: dup
       4: invokespecial #21                 // Method org/apache/wss4j/dom/str/STRParserResult."<init>":()V
       7: astore        4
       9: aload_3
      10: invokevirtual #2                  // Method org/apache/wss4j/dom/str/STRParserParameters.getData:()Lorg/apache/wss4j/dom/handler/RequestData;
      13: astore        5
      15: aload_1
      16: invokevirtual #42                 // Method org/apache/wss4j/common/token/SecurityTokenReference.containsReference:()Z
      19: ifeq          69
      22: aload_2
      23: aconst_null
      24: bipush        6
      26: aload         5
      28: invokestatic  #43                 // Method org/apache/wss4j/dom/str/STRParserUtil.getSecretKeyFromToken:(Ljava/lang/String;Ljava/lang/String;ILorg/apache/wss4j/dom/handler/RequestData;)[B
      31: astore        6
      33: aload         6
      35: ifnonnull     59
      38: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
      41: dup
      42: getstatic     #40                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      45: ldc           #41                 // String unsupportedKeyId
      47: iconst_1
      48: anewarray     #44                 // class java/lang/Object
      51: dup
      52: iconst_0
      53: aload_2
      54: aastore
      55: invokespecial #45                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
      58: athrow
      59: aload         4
      61: aload         6
      63: invokevirtual #29                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
      66: goto          403
      69: aload_1
      70: invokevirtual #15                 // Method org/apache/wss4j/common/token/SecurityTokenReference.containsKeyIdentifier:()Z
      73: ifeq          390
      76: aload_1
      77: invokevirtual #46                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValueType:()Ljava/lang/String;
      80: astore        6
      82: ldc           #47                 // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#Kerberosv5APREQSHA1
      84: aload         6
      86: invokevirtual #48                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      89: ifeq          253
      92: aload_1
      93: invokevirtual #16                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValue:()Ljava/lang/String;
      96: aload         6
      98: bipush        9
     100: aload         5
     102: invokestatic  #43                 // Method org/apache/wss4j/dom/str/STRParserUtil.getSecretKeyFromToken:(Ljava/lang/String;Ljava/lang/String;ILorg/apache/wss4j/dom/handler/RequestData;)[B
     105: astore        7
     107: aload         7
     109: ifnonnull     217
     112: aload_1
     113: invokevirtual #49                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getSKIBytes:()[B
     116: astore        8
     118: aload_3
     119: invokevirtual #3                  // Method org/apache/wss4j/dom/str/STRParserParameters.getWsDocInfo:()Lorg/apache/wss4j/dom/WSDocInfo;
     122: sipush        4096
     125: invokestatic  #50                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     128: invokevirtual #51                 // Method org/apache/wss4j/dom/WSDocInfo.getResultsByTag:(Ljava/lang/Integer;)Ljava/util/List;
     131: astore        9
     133: aload         9
     135: invokeinterface #52,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     140: astore        10
     142: aload         10
     144: invokeinterface #53,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     149: ifeq          217
     152: aload         10
     154: invokeinterface #54,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     159: checkcast     #55                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     162: astore        11
     164: aload         11
     166: ldc           #56                 // String binary-security-token
     168: invokevirtual #23                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     171: checkcast     #57                 // class org/apache/wss4j/common/token/BinarySecurity
     174: astore        12
     176: aload         12
     178: invokevirtual #58                 // Method org/apache/wss4j/common/token/BinarySecurity.getToken:()[B
     181: invokestatic  #59                 // Method org/apache/wss4j/common/util/KeyUtils.generateDigest:([B)[B
     184: astore        13
     186: aload         13
     188: aload         8
     190: invokestatic  #60                 // Method java/util/Arrays.equals:([B[B)Z
     193: ifeq          214
     196: aload         11
     198: ldc           #27                 // String secret
     200: invokevirtual #23                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     203: checkcast     #28                 // class "[B"
     206: checkcast     #28                 // class "[B"
     209: astore        7
     211: goto          217
     214: goto          142
     217: aload         7
     219: ifnonnull     243
     222: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
     225: dup
     226: getstatic     #40                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     229: ldc           #41                 // String unsupportedKeyId
     231: iconst_1
     232: anewarray     #44                 // class java/lang/Object
     235: dup
     236: iconst_0
     237: aload_2
     238: aastore
     239: invokespecial #45                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     242: athrow
     243: aload         4
     245: aload         7
     247: invokevirtual #29                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     250: goto          387
     253: ldc           #61                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKeySHA1
     255: aload         6
     257: invokevirtual #48                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     260: ifeq          272
     263: aload_1
     264: aload         5
     266: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     269: invokestatic  #30                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkEncryptedKeyBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     272: aload         5
     274: invokevirtual #62                 // Method org/apache/wss4j/dom/handler/RequestData.getDecCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     277: astore        7
     279: aload_1
     280: aload         7
     282: invokevirtual #63                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifier:(Lorg/apache/wss4j/common/crypto/Crypto;)[Ljava/security/cert/X509Certificate;
     285: astore        8
     287: aload         8
     289: ifnull        306
     292: aload         8
     294: arraylength
     295: iconst_1
     296: if_icmplt     306
     299: aload         8
     301: iconst_0
     302: aaload
     303: ifnonnull     357
     306: aload_1
     307: invokevirtual #16                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValue:()Ljava/lang/String;
     310: aload         6
     312: bipush        9
     314: aload         5
     316: invokestatic  #43                 // Method org/apache/wss4j/dom/str/STRParserUtil.getSecretKeyFromToken:(Ljava/lang/String;Ljava/lang/String;ILorg/apache/wss4j/dom/handler/RequestData;)[B
     319: astore        9
     321: aload         9
     323: ifnonnull     347
     326: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
     329: dup
     330: getstatic     #40                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     333: ldc           #41                 // String unsupportedKeyId
     335: iconst_1
     336: anewarray     #44                 // class java/lang/Object
     339: dup
     340: iconst_0
     341: aload_2
     342: aastore
     343: invokespecial #45                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     346: athrow
     347: aload         4
     349: aload         9
     351: invokevirtual #29                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     354: goto          387
     357: aload         7
     359: aload         8
     361: iconst_0
     362: aaload
     363: aload         5
     365: invokevirtual #37                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     368: invokeinterface #64,  3           // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getPrivateKey:(Ljava/security/cert/X509Certificate;Ljavax/security/auth/callback/CallbackHandler;)Ljava/security/PrivateKey;
     373: invokeinterface #65,  1           // InterfaceMethod java/security/PrivateKey.getEncoded:()[B
     378: astore        9
     380: aload         4
     382: aload         9
     384: invokevirtual #29                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     387: goto          403
     390: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
     393: dup
     394: getstatic     #40                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     397: ldc           #41                 // String unsupportedKeyId
     399: invokespecial #8                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     402: athrow
     403: aload         4
     405: areturn
}
