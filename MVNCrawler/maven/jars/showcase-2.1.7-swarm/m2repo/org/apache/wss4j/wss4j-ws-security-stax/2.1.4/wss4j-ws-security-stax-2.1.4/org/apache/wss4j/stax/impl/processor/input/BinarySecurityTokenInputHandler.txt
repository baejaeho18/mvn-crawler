Compiled from "BinarySecurityTokenInputHandler.java"
public class org.apache.wss4j.stax.impl.processor.input.BinarySecurityTokenInputHandler extends org.apache.xml.security.stax.ext.AbstractInputSecurityHeaderHandler {
  public org.apache.wss4j.stax.impl.processor.input.BinarySecurityTokenInputHandler();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/xml/security/stax/ext/AbstractInputSecurityHeaderHandler."<init>":()V
       4: return

  public void handle(org.apache.xml.security.stax.ext.InputProcessorChain, org.apache.xml.security.stax.ext.XMLSecurityProperties, java.util.Deque<org.apache.xml.security.stax.ext.stax.XMLSecEvent>, java.lang.Integer) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: aload_3
       2: aload         4
       4: invokevirtual #2                  // Method java/lang/Integer.intValue:()I
       7: aload_2
       8: invokevirtual #3                  // Method parseStructure:(Ljava/util/Deque;ILorg/apache/xml/security/stax/ext/XMLSecurityProperties;)Ljava/lang/Object;
      11: checkcast     #4                  // class javax/xml/bind/JAXBElement
      14: invokevirtual #5                  // Method javax/xml/bind/JAXBElement.getValue:()Ljava/lang/Object;
      17: checkcast     #6                  // class org/apache/wss4j/binding/wss10/BinarySecurityTokenType
      20: astore        5
      22: aload_0
      23: aload_1
      24: aload         5
      26: invokespecial #7                  // Method checkBSPCompliance:(Lorg/apache/xml/security/stax/ext/InputProcessorChain;Lorg/apache/wss4j/binding/wss10/BinarySecurityTokenType;)V
      29: aload         5
      31: invokevirtual #8                  // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getId:()Ljava/lang/String;
      34: ifnonnull     46
      37: aload         5
      39: aconst_null
      40: invokestatic  #9                  // Method org/apache/xml/security/stax/impl/util/IDGenerator.generateID:(Ljava/lang/String;)Ljava/lang/String;
      43: invokevirtual #10                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.setId:(Ljava/lang/String;)V
      46: aload_1
      47: invokeinterface #11,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InputProcessorChain.getSecurityContext:()Lorg/apache/xml/security/stax/ext/InboundSecurityContext;
      52: checkcast     #12                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
      55: astore        6
      57: aload_2
      58: checkcast     #13                 // class org/apache/wss4j/stax/ext/WSSSecurityProperties
      61: astore        7
      63: aload_0
      64: aload_3
      65: invokevirtual #14                 // Method getElementPath:(Ljava/util/Deque;)Ljava/util/List;
      68: astore        8
      70: aload_0
      71: aload_3
      72: aload         4
      74: invokevirtual #2                  // Method java/lang/Integer.intValue:()I
      77: invokevirtual #15                 // Method getResponsibleXMLSecEvents:(Ljava/util/Deque;I)Ljava/util/List;
      80: astore        9
      82: new           #16                 // class org/apache/wss4j/stax/validate/TokenContext
      85: dup
      86: aload         7
      88: aload         6
      90: aload         9
      92: aload         8
      94: invokespecial #17                 // Method org/apache/wss4j/stax/validate/TokenContext."<init>":(Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Ljava/util/List;Ljava/util/List;)V
      97: astore        10
      99: aload         7
     101: getstatic     #18                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_BinarySecurityToken:Ljavax/xml/namespace/QName;
     104: invokevirtual #19                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getValidator:(Ljavax/xml/namespace/QName;)Lorg/apache/wss4j/stax/validate/Validator;
     107: checkcast     #20                 // class org/apache/wss4j/stax/validate/BinarySecurityTokenValidator
     110: astore        11
     112: aload         11
     114: ifnonnull     126
     117: new           #21                 // class org/apache/wss4j/stax/validate/BinarySecurityTokenValidatorImpl
     120: dup
     121: invokespecial #22                 // Method org/apache/wss4j/stax/validate/BinarySecurityTokenValidatorImpl."<init>":()V
     124: astore        11
     126: aload         11
     128: aload         5
     130: aload         10
     132: invokeinterface #23,  3           // InterfaceMethod org/apache/wss4j/stax/validate/BinarySecurityTokenValidator.validate:(Lorg/apache/wss4j/binding/wss10/BinarySecurityTokenType;Lorg/apache/wss4j/stax/validate/TokenContext;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
     137: astore        12
     139: new           #24                 // class org/apache/wss4j/stax/impl/processor/input/BinarySecurityTokenInputHandler$1
     142: dup
     143: aload_0
     144: aload         12
     146: invokespecial #25                 // Method org/apache/wss4j/stax/impl/processor/input/BinarySecurityTokenInputHandler$1."<init>":(Lorg/apache/wss4j/stax/impl/processor/input/BinarySecurityTokenInputHandler;Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;)V
     149: astore        13
     151: aload         6
     153: aload         5
     155: invokevirtual #8                  // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getId:()Ljava/lang/String;
     158: aload         13
     160: invokeinterface #26,  3           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.registerSecurityTokenProvider:(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;)V
     165: aload         5
     167: invokevirtual #27                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
     170: ldc           #28                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0
     172: invokevirtual #29                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     175: ifeq          204
     178: new           #30                 // class org/apache/wss4j/stax/securityEvent/X509TokenSecurityEvent
     181: dup
     182: invokespecial #31                 // Method org/apache/wss4j/stax/securityEvent/X509TokenSecurityEvent."<init>":()V
     185: astore        15
     187: aload         15
     189: aload         12
     191: checkcast     #32                 // class org/apache/wss4j/stax/securityToken/X509SecurityToken
     194: invokevirtual #33                 // Method org/apache/wss4j/stax/securityEvent/X509TokenSecurityEvent.setSecurityToken:(Lorg/apache/xml/security/stax/securityToken/SecurityToken;)V
     197: aload         15
     199: astore        14
     201: goto          268
     204: aload         5
     206: invokevirtual #27                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
     209: ldc           #34                 // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#
     211: invokevirtual #29                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     214: ifeq          243
     217: new           #35                 // class org/apache/wss4j/stax/securityEvent/KerberosTokenSecurityEvent
     220: dup
     221: invokespecial #36                 // Method org/apache/wss4j/stax/securityEvent/KerberosTokenSecurityEvent."<init>":()V
     224: astore        15
     226: aload         15
     228: aload         12
     230: checkcast     #37                 // class org/apache/wss4j/stax/securityToken/KerberosServiceSecurityToken
     233: invokevirtual #38                 // Method org/apache/wss4j/stax/securityEvent/KerberosTokenSecurityEvent.setSecurityToken:(Lorg/apache/xml/security/stax/securityToken/SecurityToken;)V
     236: aload         15
     238: astore        14
     240: goto          268
     243: new           #39                 // class org/apache/wss4j/common/ext/WSSecurityException
     246: dup
     247: getstatic     #40                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     250: ldc           #41                 // String invalidValueType
     252: iconst_1
     253: anewarray     #42                 // class java/lang/Object
     256: dup
     257: iconst_0
     258: aload         5
     260: invokevirtual #27                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
     263: aastore
     264: invokespecial #43                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     267: athrow
     268: aload         14
     270: aload         5
     272: invokevirtual #8                  // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getId:()Ljava/lang/String;
     275: invokevirtual #44                 // Method org/apache/xml/security/stax/securityEvent/TokenSecurityEvent.setCorrelationID:(Ljava/lang/String;)V
     278: aload         6
     280: aload         14
     282: invokeinterface #45,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.registerSecurityEvent:(Lorg/apache/xml/security/stax/securityEvent/SecurityEvent;)V
     287: return

  private void checkBSPCompliance(org.apache.xml.security.stax.ext.InputProcessorChain, org.apache.wss4j.binding.wss10.BinarySecurityTokenType) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: invokeinterface #11,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InputProcessorChain.getSecurityContext:()Lorg/apache/xml/security/stax/ext/InboundSecurityContext;
       6: checkcast     #12                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
       9: astore_3
      10: aload_2
      11: invokevirtual #46                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getEncodingType:()Ljava/lang/String;
      14: ifnonnull     26
      17: aload_3
      18: getstatic     #47                 // Field org/apache/wss4j/common/bsp/BSPRule.R3029:Lorg/apache/wss4j/common/bsp/BSPRule;
      21: invokeinterface #48,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      26: ldc           #49                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary
      28: aload_2
      29: invokevirtual #46                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getEncodingType:()Ljava/lang/String;
      32: invokevirtual #50                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      35: ifne          47
      38: aload_3
      39: getstatic     #51                 // Field org/apache/wss4j/common/bsp/BSPRule.R3030:Lorg/apache/wss4j/common/bsp/BSPRule;
      42: invokeinterface #48,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      47: aload_2
      48: invokevirtual #27                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
      51: ifnonnull     63
      54: aload_3
      55: getstatic     #52                 // Field org/apache/wss4j/common/bsp/BSPRule.R3031:Lorg/apache/wss4j/common/bsp/BSPRule;
      58: invokeinterface #48,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      63: return
}
