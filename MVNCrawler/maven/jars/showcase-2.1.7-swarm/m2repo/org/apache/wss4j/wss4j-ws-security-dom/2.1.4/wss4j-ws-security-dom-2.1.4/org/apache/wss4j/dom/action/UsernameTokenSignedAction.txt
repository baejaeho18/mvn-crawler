Compiled from "UsernameTokenSignedAction.java"
public class org.apache.wss4j.dom.action.UsernameTokenSignedAction implements org.apache.wss4j.dom.action.Action {
  public org.apache.wss4j.dom.action.UsernameTokenSignedAction();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public void execute(org.apache.wss4j.dom.handler.WSHandler, org.apache.wss4j.common.SecurityActionToken, org.w3c.dom.Document, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload         4
       2: invokevirtual #2                  // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
       5: astore        5
       7: aload         5
       9: ifnonnull     20
      12: aload_1
      13: aload         4
      15: invokevirtual #3                  // Method org/apache/wss4j/dom/handler/WSHandler.getPasswordCallbackHandler:(Lorg/apache/wss4j/dom/handler/RequestData;)Ljavax/security/auth/callback/CallbackHandler;
      18: astore        5
      20: aload_1
      21: aload         4
      23: invokevirtual #4                  // Method org/apache/wss4j/dom/handler/RequestData.getUsername:()Ljava/lang/String;
      26: bipush        64
      28: aload         5
      30: aload         4
      32: invokevirtual #5                  // Method org/apache/wss4j/dom/handler/WSHandler.getPasswordCB:(Ljava/lang/String;ILjavax/security/auth/callback/CallbackHandler;Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/apache/wss4j/common/ext/WSPasswordCallback;
      35: astore        6
      37: aload         4
      39: invokevirtual #4                  // Method org/apache/wss4j/dom/handler/RequestData.getUsername:()Ljava/lang/String;
      42: ifnonnull     58
      45: new           #6                  // class org/apache/wss4j/common/ext/WSSecurityException
      48: dup
      49: getstatic     #7                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      52: ldc           #8                  // String noUser
      54: invokespecial #9                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      57: athrow
      58: new           #10                 // class org/apache/wss4j/dom/message/WSSecUsernameToken
      61: dup
      62: invokespecial #11                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken."<init>":()V
      65: astore        7
      67: aload         7
      69: aload         4
      71: invokevirtual #12                 // Method org/apache/wss4j/dom/handler/RequestData.getWssConfig:()Lorg/apache/wss4j/dom/engine/WSSConfig;
      74: invokevirtual #13                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      77: invokevirtual #14                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      80: aload         7
      82: aload         4
      84: invokevirtual #15                 // Method org/apache/wss4j/dom/handler/RequestData.isPrecisionInMilliSeconds:()Z
      87: invokevirtual #16                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setPrecisionInMilliSeconds:(Z)V
      90: aload         7
      92: aload         4
      94: invokevirtual #12                 // Method org/apache/wss4j/dom/handler/RequestData.getWssConfig:()Lorg/apache/wss4j/dom/engine/WSSConfig;
      97: invokevirtual #17                 // Method org/apache/wss4j/dom/engine/WSSConfig.getCurrentTime:()Lorg/apache/wss4j/common/util/WSTimeSource;
     100: invokevirtual #18                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setWsTimeSource:(Lorg/apache/wss4j/common/util/WSTimeSource;)V
     103: aload         4
     105: invokevirtual #19                 // Method org/apache/wss4j/dom/handler/RequestData.getDerivedKeyIterations:()I
     108: istore        8
     110: aload         4
     112: invokevirtual #20                 // Method org/apache/wss4j/dom/handler/RequestData.isUseDerivedKeyForMAC:()Z
     115: istore        9
     117: aload         7
     119: iload         9
     121: aconst_null
     122: iload         8
     124: invokevirtual #21                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.addDerivedKey:(Z[BI)V
     127: aload         7
     129: aload         4
     131: invokevirtual #4                  // Method org/apache/wss4j/dom/handler/RequestData.getUsername:()Ljava/lang/String;
     134: aload         6
     136: invokevirtual #22                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
     139: invokevirtual #23                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
     142: aload         7
     144: invokevirtual #24                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.addCreated:()V
     147: aload         7
     149: invokevirtual #25                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.addNonce:()V
     152: aload         7
     154: aload_3
     155: invokevirtual #26                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.prepare:(Lorg/w3c/dom/Document;)V
     158: aconst_null
     159: astore        10
     161: aload_2
     162: instanceof    #27                 // class org/apache/wss4j/common/SignatureActionToken
     165: ifeq          174
     168: aload_2
     169: checkcast     #27                 // class org/apache/wss4j/common/SignatureActionToken
     172: astore        10
     174: aload         10
     176: ifnonnull     186
     179: aload         4
     181: invokevirtual #28                 // Method org/apache/wss4j/dom/handler/RequestData.getSignatureToken:()Lorg/apache/wss4j/common/SignatureActionToken;
     184: astore        10
     186: new           #29                 // class org/apache/wss4j/dom/message/WSSecSignature
     189: dup
     190: invokespecial #30                 // Method org/apache/wss4j/dom/message/WSSecSignature."<init>":()V
     193: astore        11
     195: aload         11
     197: aload         4
     199: invokevirtual #12                 // Method org/apache/wss4j/dom/handler/RequestData.getWssConfig:()Lorg/apache/wss4j/dom/engine/WSSConfig;
     202: invokevirtual #13                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     205: invokevirtual #31                 // Method org/apache/wss4j/dom/message/WSSecSignature.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
     208: aload         11
     210: aload         4
     212: invokevirtual #32                 // Method org/apache/wss4j/dom/handler/RequestData.isAddInclusivePrefixes:()Z
     215: invokevirtual #33                 // Method org/apache/wss4j/dom/message/WSSecSignature.setAddInclusivePrefixes:(Z)V
     218: aload         11
     220: ldc           #34                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
     222: invokevirtual #35                 // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     225: aload         11
     227: aload         7
     229: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getId:()Ljava/lang/String;
     232: invokevirtual #37                 // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenId:(Ljava/lang/String;)V
     235: aload         11
     237: aload         7
     239: invokevirtual #38                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getDerivedKey:()[B
     242: invokevirtual #39                 // Method org/apache/wss4j/dom/message/WSSecSignature.setSecretKey:([B)V
     245: aload         11
     247: bipush        9
     249: invokevirtual #40                 // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     252: aload         10
     254: invokevirtual #41                 // Method org/apache/wss4j/common/SignatureActionToken.getDigestAlgorithm:()Ljava/lang/String;
     257: ifnull        270
     260: aload         11
     262: aload         10
     264: invokevirtual #41                 // Method org/apache/wss4j/common/SignatureActionToken.getDigestAlgorithm:()Ljava/lang/String;
     267: invokevirtual #42                 // Method org/apache/wss4j/dom/message/WSSecSignature.setDigestAlgo:(Ljava/lang/String;)V
     270: aload         10
     272: invokevirtual #43                 // Method org/apache/wss4j/common/SignatureActionToken.getSignatureAlgorithm:()Ljava/lang/String;
     275: ifnull        291
     278: aload         11
     280: aload         10
     282: invokevirtual #43                 // Method org/apache/wss4j/common/SignatureActionToken.getSignatureAlgorithm:()Ljava/lang/String;
     285: invokevirtual #44                 // Method org/apache/wss4j/dom/message/WSSecSignature.setSignatureAlgorithm:(Ljava/lang/String;)V
     288: goto          298
     291: aload         11
     293: ldc           #45                 // String http://www.w3.org/2000/09/xmldsig#hmac-sha1
     295: invokevirtual #44                 // Method org/apache/wss4j/dom/message/WSSecSignature.setSignatureAlgorithm:(Ljava/lang/String;)V
     298: aload         11
     300: aload_3
     301: aconst_null
     302: aload         4
     304: invokevirtual #46                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     307: invokevirtual #47                 // Method org/apache/wss4j/dom/message/WSSecSignature.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     310: aconst_null
     311: astore        12
     313: aload         10
     315: invokevirtual #48                 // Method org/apache/wss4j/common/SignatureActionToken.getParts:()Ljava/util/List;
     318: invokeinterface #49,  1           // InterfaceMethod java/util/List.size:()I
     323: ifle          336
     326: aload         10
     328: invokevirtual #48                 // Method org/apache/wss4j/common/SignatureActionToken.getParts:()Ljava/util/List;
     331: astore        12
     333: goto          358
     336: new           #50                 // class java/util/ArrayList
     339: dup
     340: iconst_1
     341: invokespecial #51                 // Method java/util/ArrayList."<init>":(I)V
     344: astore        12
     346: aload         12
     348: aload_3
     349: invokestatic  #52                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.getDefaultEncryptionPart:(Lorg/w3c/dom/Document;)Lorg/apache/wss4j/common/WSEncryptionPart;
     352: invokeinterface #53,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     357: pop
     358: aload         11
     360: aload         12
     362: aload         4
     364: invokevirtual #46                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     367: invokevirtual #54                 // Method org/apache/wss4j/dom/message/WSSecSignature.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     370: astore        13
     372: aload         11
     374: aload         13
     376: invokevirtual #55                 // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;)V
     379: aload         4
     381: invokevirtual #56                 // Method org/apache/wss4j/dom/handler/RequestData.getSignatureValues:()Ljava/util/List;
     384: aload         11
     386: invokevirtual #57                 // Method org/apache/wss4j/dom/message/WSSecSignature.getSignatureValue:()[B
     389: invokeinterface #53,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     394: pop
     395: goto          424
     398: astore        14
     400: new           #6                  // class org/apache/wss4j/common/ext/WSSecurityException
     403: dup
     404: getstatic     #7                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     407: aload         14
     409: ldc           #58                 // String empty
     411: iconst_1
     412: anewarray     #59                 // class java/lang/Object
     415: dup
     416: iconst_0
     417: ldc           #60                 // String WSHandler: Error during UsernameTokenSignature
     419: aastore
     420: invokespecial #61                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
     423: athrow
     424: aload         7
     426: aload         4
     428: invokevirtual #46                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     431: invokevirtual #62                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.prependToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     434: return
    Exception table:
       from    to  target type
         372   395   398   Class org/apache/wss4j/common/ext/WSSecurityException
}
