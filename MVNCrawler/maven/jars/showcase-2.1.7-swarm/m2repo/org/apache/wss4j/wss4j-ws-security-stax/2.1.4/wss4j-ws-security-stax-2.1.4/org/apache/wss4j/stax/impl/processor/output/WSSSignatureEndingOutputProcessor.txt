Compiled from "WSSSignatureEndingOutputProcessor.java"
public class org.apache.wss4j.stax.impl.processor.output.WSSSignatureEndingOutputProcessor extends org.apache.xml.security.stax.impl.processor.output.AbstractSignatureEndingOutputProcessor {
  private org.apache.xml.security.stax.impl.processor.output.AbstractSignatureEndingOutputProcessor$SignedInfoProcessor signedInfoProcessor;

  public org.apache.wss4j.stax.impl.processor.output.WSSSignatureEndingOutputProcessor(org.apache.wss4j.stax.impl.processor.output.WSSSignatureOutputProcessor) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #1                  // Method org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor."<init>":(Lorg/apache/xml/security/stax/impl/processor/output/AbstractSignatureOutputProcessor;)V
       5: aload_0
       6: aconst_null
       7: putfield      #2                  // Field signedInfoProcessor:Lorg/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor;
      10: aload_0
      11: ldc_w         #3                  // class org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor
      14: invokevirtual #4                  // Method java/lang/Class.getName:()Ljava/lang/String;
      17: invokevirtual #5                  // Method addAfterProcessor:(Ljava/lang/Object;)V
      20: aload_0
      21: ldc_w         #6                  // class org/apache/wss4j/stax/impl/processor/output/UsernameTokenOutputProcessor
      24: invokevirtual #4                  // Method java/lang/Class.getName:()Ljava/lang/String;
      27: invokevirtual #5                  // Method addAfterProcessor:(Ljava/lang/Object;)V
      30: return

  protected org.apache.xml.security.stax.impl.processor.output.AbstractSignatureEndingOutputProcessor$SignedInfoProcessor newSignedInfoProcessor(org.apache.xml.security.stax.impl.algorithms.SignatureAlgorithm, org.apache.xml.security.stax.ext.stax.XMLSecStartElement, org.apache.xml.security.stax.ext.OutputProcessorChain) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: getstatic     #7                  // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_Security:Ljavax/xml/namespace/QName;
       3: aload_2
       4: invokeinterface #8,  1            // InterfaceMethod org/apache/xml/security/stax/ext/stax/XMLSecStartElement.getName:()Ljavax/xml/namespace/QName;
       9: invokevirtual #9                  // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      12: ifne          25
      15: aload_2
      16: invokeinterface #10,  1           // InterfaceMethod org/apache/xml/security/stax/ext/stax/XMLSecStartElement.getParentXMLSecStartElement:()Lorg/apache/xml/security/stax/ext/stax/XMLSecStartElement;
      21: astore_2
      22: goto          0
      25: aload_0
      26: new           #11                 // class org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor
      29: dup
      30: aload_1
      31: aload_2
      32: invokespecial #12                 // Method org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor."<init>":(Lorg/apache/xml/security/stax/impl/algorithms/SignatureAlgorithm;Lorg/apache/xml/security/stax/ext/stax/XMLSecStartElement;)V
      35: putfield      #2                  // Field signedInfoProcessor:Lorg/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor;
      38: aload_0
      39: getfield      #2                  // Field signedInfoProcessor:Lorg/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor;
      42: aload_0
      43: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
      46: invokevirtual #14                 // Method org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor.setXMLSecurityProperties:(Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;)V
      49: aload_0
      50: getfield      #2                  // Field signedInfoProcessor:Lorg/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor;
      53: aload_0
      54: invokevirtual #15                 // Method getAction:()Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      57: invokevirtual #16                 // Method org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor.setAction:(Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
      60: aload_0
      61: getfield      #2                  // Field signedInfoProcessor:Lorg/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor;
      64: ldc_w         #17                 // class org/apache/wss4j/stax/impl/processor/output/WSSSignatureEndingOutputProcessor
      67: invokevirtual #4                  // Method java/lang/Class.getName:()Ljava/lang/String;
      70: invokevirtual #18                 // Method org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor.addAfterProcessor:(Ljava/lang/Object;)V
      73: aload_0
      74: getfield      #2                  // Field signedInfoProcessor:Lorg/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor;
      77: aload_3
      78: invokevirtual #19                 // Method org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor.init:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;)V
      81: aload_0
      82: getfield      #2                  // Field signedInfoProcessor:Lorg/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor;
      85: areturn

  public void processHeaderEvent(org.apache.xml.security.stax.ext.OutputProcessorChain) throws javax.xml.stream.XMLStreamException, org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #20                 // Method org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor.processHeaderEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;)V
       5: new           #21                 // class org/apache/xml/security/stax/securityEvent/SignatureValueSecurityEvent
       8: dup
       9: invokespecial #22                 // Method org/apache/xml/security/stax/securityEvent/SignatureValueSecurityEvent."<init>":()V
      12: astore_2
      13: aload_2
      14: aload_0
      15: getfield      #2                  // Field signedInfoProcessor:Lorg/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor;
      18: invokevirtual #23                 // Method org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor$SignedInfoProcessor.getSignatureValue:()[B
      21: invokevirtual #24                 // Method org/apache/xml/security/stax/securityEvent/SignatureValueSecurityEvent.setSignatureValue:([B)V
      24: aload_1
      25: invokeinterface #25,  1           // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessorChain.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      30: aload_2
      31: invokeinterface #26,  2           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.registerSecurityEvent:(Lorg/apache/xml/security/stax/securityEvent/SecurityEvent;)V
      36: return

  protected void createKeyInfoStructureForSignature(org.apache.xml.security.stax.ext.OutputProcessorChain, org.apache.xml.security.stax.securityToken.OutboundSecurityToken, boolean) throws javax.xml.stream.XMLStreamException, org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_2
       1: invokeinterface #27,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getCustomTokenReference:()Lorg/w3c/dom/Element;
       6: ifnull        21
       9: aload_0
      10: aload_2
      11: invokeinterface #27,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getCustomTokenReference:()Lorg/w3c/dom/Element;
      16: aload_1
      17: invokevirtual #28                 // Method outputDOMElement:(Lorg/w3c/dom/Element;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;)V
      20: return
      21: aload_0
      22: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
      25: invokevirtual #29                 // Method org/apache/xml/security/stax/ext/XMLSecurityProperties.getSignatureKeyIdentifier:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      28: astore        4
      30: aload_2
      31: invokeinterface #30,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getX509Certificates:()[Ljava/security/cert/X509Certificate;
      36: astore        5
      38: getstatic     #31                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_KeyValue:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      41: aload         4
      43: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
      46: ifeq          59
      49: aload_0
      50: aload_1
      51: aload         5
      53: invokestatic  #33                 // Method org/apache/wss4j/stax/utils/WSSUtils.createKeyValueTokenStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;[Ljava/security/cert/X509Certificate;)V
      56: goto          864
      59: iconst_0
      60: istore        6
      62: new           #34                 // class java/util/ArrayList
      65: dup
      66: iconst_2
      67: invokespecial #35                 // Method java/util/ArrayList."<init>":(I)V
      70: astore        7
      72: aload         7
      74: aload_0
      75: getstatic     #36                 // Field org/apache/wss4j/stax/ext/WSSConstants.ATT_wsu_Id:Ljavax/xml/namespace/QName;
      78: aconst_null
      79: invokestatic  #37                 // Method org/apache/xml/security/stax/impl/util/IDGenerator.generateID:(Ljava/lang/String;)Ljava/lang/String;
      82: invokevirtual #38                 // Method createAttribute:(Ljavax/xml/namespace/QName;Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/stax/XMLSecAttribute;
      85: invokeinterface #39,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      90: pop
      91: getstatic     #40                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.Saml10Token:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
      94: aload_2
      95: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     100: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     103: ifne          121
     106: getstatic     #43                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.Saml11Token:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     109: aload_2
     110: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     115: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     118: ifeq          144
     121: aload         7
     123: aload_0
     124: getstatic     #44                 // Field org/apache/wss4j/stax/ext/WSSConstants.ATT_wsse11_TokenType:Ljavax/xml/namespace/QName;
     127: ldc           #45                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     129: invokevirtual #38                 // Method createAttribute:(Ljavax/xml/namespace/QName;Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/stax/XMLSecAttribute;
     132: invokeinterface #39,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     137: pop
     138: iconst_1
     139: istore        6
     141: goto          306
     144: getstatic     #46                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.Saml20Token:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     147: aload_2
     148: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     153: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     156: ifeq          182
     159: aload         7
     161: aload_0
     162: getstatic     #44                 // Field org/apache/wss4j/stax/ext/WSSConstants.ATT_wsse11_TokenType:Ljavax/xml/namespace/QName;
     165: ldc           #47                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     167: invokevirtual #38                 // Method createAttribute:(Ljavax/xml/namespace/QName;Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/stax/XMLSecAttribute;
     170: invokeinterface #39,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     175: pop
     176: iconst_1
     177: istore        6
     179: goto          306
     182: getstatic     #48                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KerberosToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     185: aload_2
     186: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     191: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     194: ifeq          217
     197: aload         7
     199: aload_0
     200: getstatic     #44                 // Field org/apache/wss4j/stax/ext/WSSConstants.ATT_wsse11_TokenType:Ljavax/xml/namespace/QName;
     203: ldc           #49                 // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#GSS_Kerberosv5_AP_REQ
     205: invokevirtual #38                 // Method createAttribute:(Ljavax/xml/namespace/QName;Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/stax/XMLSecAttribute;
     208: invokeinterface #39,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     213: pop
     214: goto          306
     217: getstatic     #50                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.EncryptedKeyToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     220: aload_2
     221: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     226: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     229: ifne          254
     232: getstatic     #51                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_EncryptedKeySha1Identifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     235: aload         4
     237: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     240: ifne          254
     243: getstatic     #52                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_EncryptedKey:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     246: aload         4
     248: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     251: ifeq          274
     254: aload         7
     256: aload_0
     257: getstatic     #44                 // Field org/apache/wss4j/stax/ext/WSSConstants.ATT_wsse11_TokenType:Ljavax/xml/namespace/QName;
     260: ldc           #53                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     262: invokevirtual #38                 // Method createAttribute:(Ljavax/xml/namespace/QName;Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/stax/XMLSecAttribute;
     265: invokeinterface #39,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     270: pop
     271: goto          306
     274: getstatic     #54                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     277: aload         4
     279: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     282: ifeq          306
     285: iload_3
     286: ifne          306
     289: aload         7
     291: aload_0
     292: getstatic     #44                 // Field org/apache/wss4j/stax/ext/WSSConstants.ATT_wsse11_TokenType:Ljavax/xml/namespace/QName;
     295: ldc           #55                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1
     297: invokevirtual #38                 // Method createAttribute:(Ljavax/xml/namespace/QName;Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/stax/XMLSecAttribute;
     300: invokeinterface #39,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     305: pop
     306: aload_0
     307: aload_1
     308: getstatic     #56                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_SecurityTokenReference:Ljavax/xml/namespace/QName;
     311: iconst_0
     312: aload         7
     314: invokevirtual #57                 // Method createStartElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;ZLjava/util/List;)Lorg/apache/xml/security/stax/ext/stax/XMLSecStartElement;
     317: pop
     318: aload_2
     319: invokeinterface #58,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getId:()Ljava/lang/String;
     324: astore        8
     326: iload         6
     328: ifeq          347
     331: aload_0
     332: aload_1
     333: aload_2
     334: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     339: aload         8
     341: invokestatic  #59                 // Method org/apache/wss4j/stax/utils/WSSUtils.createSAMLKeyIdentifierStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;Ljava/lang/String;)V
     344: goto          856
     347: getstatic     #51                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_EncryptedKeySha1Identifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     350: aload         4
     352: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     355: ifeq          406
     358: aload_2
     359: invokeinterface #60,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getSha1Identifier:()Ljava/lang/String;
     364: astore        9
     366: aload         9
     368: ifnull        381
     371: aload_0
     372: aload_1
     373: aload         9
     375: invokestatic  #61                 // Method org/apache/wss4j/stax/utils/WSSUtils.createEncryptedKeySha1IdentifierStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljava/lang/String;)V
     378: goto          403
     381: aload_2
     382: aload_0
     383: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
     386: invokevirtual #62                 // Method org/apache/xml/security/stax/ext/XMLSecurityProperties.getSignatureAlgorithm:()Ljava/lang/String;
     389: invokeinterface #63,  2           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getSecretKey:(Ljava/lang/String;)Ljava/security/Key;
     394: astore        10
     396: aload_0
     397: aload_1
     398: aload         10
     400: invokestatic  #64                 // Method org/apache/wss4j/stax/utils/WSSUtils.createEncryptedKeySha1IdentifierStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljava/security/Key;)V
     403: goto          856
     406: getstatic     #65                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_KerberosSha1Identifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     409: aload         4
     411: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     414: ifeq          435
     417: aload_2
     418: invokeinterface #60,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getSha1Identifier:()Ljava/lang/String;
     423: astore        9
     425: aload_0
     426: aload_1
     427: aload         9
     429: invokestatic  #66                 // Method org/apache/wss4j/stax/utils/WSSUtils.createKerberosSha1IdentifierStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljava/lang/String;)V
     432: goto          856
     435: getstatic     #50                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.EncryptedKeyToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     438: aload_2
     439: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     444: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     447: ifne          461
     450: getstatic     #52                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_EncryptedKey:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     453: aload         4
     455: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     458: ifeq          482
     461: aload_2
     462: invokeinterface #58,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getId:()Ljava/lang/String;
     467: astore        9
     469: aload_0
     470: aload_1
     471: aload         9
     473: ldc           #53                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     475: iconst_1
     476: invokestatic  #67                 // Method org/apache/wss4j/stax/utils/WSSUtils.createBSTReferenceStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljava/lang/String;Ljava/lang/String;Z)V
     479: goto          856
     482: getstatic     #68                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_IssuerSerial:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     485: aload         4
     487: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     490: ifeq          503
     493: aload_0
     494: aload_1
     495: aload         5
     497: invokestatic  #69                 // Method org/apache/wss4j/stax/utils/WSSUtils.createX509IssuerSerialStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;[Ljava/security/cert/X509Certificate;)V
     500: goto          856
     503: getstatic     #70                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SkiKeyIdentifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     506: aload         4
     508: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     511: ifeq          524
     514: aload_0
     515: aload_1
     516: aload         5
     518: invokestatic  #71                 // Method org/apache/wss4j/stax/utils/WSSUtils.createX509SubjectKeyIdentifierStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;[Ljava/security/cert/X509Certificate;)V
     521: goto          856
     524: getstatic     #72                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_X509KeyIdentifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     527: aload         4
     529: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     532: ifeq          545
     535: aload_0
     536: aload_1
     537: aload         5
     539: invokestatic  #73                 // Method org/apache/wss4j/stax/utils/WSSUtils.createX509KeyIdentifierStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;[Ljava/security/cert/X509Certificate;)V
     542: goto          856
     545: getstatic     #74                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_ThumbprintIdentifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     548: aload         4
     550: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     553: ifeq          566
     556: aload_0
     557: aload_1
     558: aload         5
     560: invokestatic  #75                 // Method org/apache/wss4j/stax/utils/WSSUtils.createThumbprintKeyIdentifierStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;[Ljava/security/cert/X509Certificate;)V
     563: goto          856
     566: getstatic     #54                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     569: aload         4
     571: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     574: ifeq          786
     577: iconst_1
     578: istore        10
     580: getstatic     #46                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.Saml20Token:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     583: aload_2
     584: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     589: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     592: ifeq          601
     595: aconst_null
     596: astore        9
     598: goto          772
     601: getstatic     #48                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KerberosToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     604: aload_2
     605: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     610: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     613: ifeq          623
     616: ldc           #49                 // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#GSS_Kerberosv5_AP_REQ
     618: astore        9
     620: goto          772
     623: getstatic     #76                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.DerivedKeyToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     626: aload_2
     627: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     632: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     635: ifeq          669
     638: aload_0
     639: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
     642: checkcast     #77                 // class org/apache/wss4j/stax/ext/WSSSecurityProperties
     645: invokevirtual #78                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.isUse200512Namespace:()Z
     648: istore        11
     650: iload         11
     652: ifeq          662
     655: ldc           #79                 // String http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512/dk
     657: astore        9
     659: goto          666
     662: ldc           #80                 // String http://schemas.xmlsoap.org/ws/2005/02/sc/dk
     664: astore        9
     666: goto          772
     669: getstatic     #81                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.SpnegoContextToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     672: aload_2
     673: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     678: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     681: ifne          714
     684: getstatic     #82                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.SecurityContextToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     687: aload_2
     688: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     693: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     696: ifne          714
     699: getstatic     #83                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.SecureConversationToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     702: aload_2
     703: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     708: invokevirtual #42                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
     711: ifeq          757
     714: aload_0
     715: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
     718: checkcast     #77                 // class org/apache/wss4j/stax/ext/WSSSecurityProperties
     721: invokevirtual #78                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.isUse200512Namespace:()Z
     724: istore        11
     726: iload         11
     728: ifeq          738
     731: ldc           #84                 // String http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512/sct
     733: astore        9
     735: goto          742
     738: ldc           #85                 // String http://schemas.xmlsoap.org/ws/2005/02/sc/sct
     740: astore        9
     742: aload_0
     743: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
     746: checkcast     #77                 // class org/apache/wss4j/stax/ext/WSSSecurityProperties
     749: invokevirtual #86                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.isIncludeSignatureToken:()Z
     752: istore        10
     754: goto          772
     757: iload_3
     758: ifeq          768
     761: ldc           #87                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3
     763: astore        9
     765: goto          772
     768: ldc           #55                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1
     770: astore        9
     772: aload_0
     773: aload_1
     774: aload         8
     776: aload         9
     778: iload         10
     780: invokestatic  #67                 // Method org/apache/wss4j/stax/utils/WSSUtils.createBSTReferenceStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljava/lang/String;Ljava/lang/String;Z)V
     783: goto          856
     786: getstatic     #88                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_EmbeddedKeyIdentifierRef:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     789: aload         4
     791: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     794: ifeq          813
     797: aload_0
     798: aload_1
     799: aload_2
     800: invokeinterface #41,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     805: aload         8
     807: invokestatic  #89                 // Method org/apache/wss4j/stax/utils/WSSUtils.createEmbeddedKeyIdentifierStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;Ljava/lang/String;)V
     810: goto          856
     813: getstatic     #90                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_UsernameTokenReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     816: aload         4
     818: invokevirtual #32                 // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     821: ifeq          834
     824: aload_0
     825: aload_1
     826: aload         8
     828: invokestatic  #91                 // Method org/apache/wss4j/stax/utils/WSSUtils.createUsernameTokenReferenceStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljava/lang/String;)V
     831: goto          856
     834: new           #92                 // class org/apache/wss4j/common/ext/WSSecurityException
     837: dup
     838: getstatic     #93                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_SIGNATURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     841: ldc           #94                 // String unsupportedSecurityToken
     843: iconst_1
     844: anewarray     #95                 // class java/lang/Object
     847: dup
     848: iconst_0
     849: aload         4
     851: aastore
     852: invokespecial #96                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     855: athrow
     856: aload_0
     857: aload_1
     858: getstatic     #56                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_SecurityTokenReference:Ljavax/xml/namespace/QName;
     861: invokevirtual #97                 // Method createEndElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;)V
     864: return

  protected void createTransformsStructureForSignature(org.apache.xml.security.stax.ext.OutputProcessorChain, org.apache.xml.security.stax.impl.SignaturePartDef) throws javax.xml.stream.XMLStreamException, org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #98                 // Method org/apache/xml/security/stax/impl/SignaturePartDef.getTransforms:()[Ljava/lang/String;
       4: astore_3
       5: aload_3
       6: ifnull        316
       9: aload_3
      10: arraylength
      11: ifle          316
      14: aload_0
      15: aload_1
      16: getstatic     #99                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_Transforms:Ljavax/xml/namespace/QName;
      19: iconst_0
      20: aconst_null
      21: invokevirtual #57                 // Method createStartElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;ZLjava/util/List;)Lorg/apache/xml/security/stax/ext/stax/XMLSecStartElement;
      24: pop
      25: ldc           #100                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#STR-Transform
      27: aload_3
      28: iconst_0
      29: aaload
      30: invokevirtual #101                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      33: ifeq          160
      36: new           #34                 // class java/util/ArrayList
      39: dup
      40: iconst_1
      41: invokespecial #35                 // Method java/util/ArrayList."<init>":(I)V
      44: astore        4
      46: aload         4
      48: aload_0
      49: getstatic     #102                // Field org/apache/wss4j/stax/ext/WSSConstants.ATT_NULL_Algorithm:Ljavax/xml/namespace/QName;
      52: aload_3
      53: iconst_0
      54: aaload
      55: invokevirtual #38                 // Method createAttribute:(Ljavax/xml/namespace/QName;Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/stax/XMLSecAttribute;
      58: invokeinterface #39,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      63: pop
      64: aload_0
      65: aload_1
      66: getstatic     #103                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_Transform:Ljavax/xml/namespace/QName;
      69: iconst_0
      70: aload         4
      72: invokevirtual #57                 // Method createStartElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;ZLjava/util/List;)Lorg/apache/xml/security/stax/ext/stax/XMLSecStartElement;
      75: pop
      76: aload_3
      77: arraylength
      78: iconst_2
      79: if_icmplt     149
      82: aload_0
      83: aload_1
      84: getstatic     #104                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_TransformationParameters:Ljavax/xml/namespace/QName;
      87: iconst_0
      88: aconst_null
      89: invokevirtual #57                 // Method createStartElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;ZLjava/util/List;)Lorg/apache/xml/security/stax/ext/stax/XMLSecStartElement;
      92: pop
      93: new           #34                 // class java/util/ArrayList
      96: dup
      97: iconst_1
      98: invokespecial #35                 // Method java/util/ArrayList."<init>":(I)V
     101: astore        4
     103: aload         4
     105: aload_0
     106: getstatic     #102                // Field org/apache/wss4j/stax/ext/WSSConstants.ATT_NULL_Algorithm:Ljavax/xml/namespace/QName;
     109: aload_3
     110: iconst_1
     111: aaload
     112: invokevirtual #38                 // Method createAttribute:(Ljavax/xml/namespace/QName;Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/stax/XMLSecAttribute;
     115: invokeinterface #39,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     120: pop
     121: aload_0
     122: aload_1
     123: getstatic     #105                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_CanonicalizationMethod:Ljavax/xml/namespace/QName;
     126: iconst_0
     127: aload         4
     129: invokevirtual #57                 // Method createStartElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;ZLjava/util/List;)Lorg/apache/xml/security/stax/ext/stax/XMLSecStartElement;
     132: pop
     133: aload_0
     134: aload_1
     135: getstatic     #105                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_CanonicalizationMethod:Ljavax/xml/namespace/QName;
     138: invokevirtual #97                 // Method createEndElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;)V
     141: aload_0
     142: aload_1
     143: getstatic     #104                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_TransformationParameters:Ljavax/xml/namespace/QName;
     146: invokevirtual #97                 // Method createEndElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;)V
     149: aload_0
     150: aload_1
     151: getstatic     #103                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_Transform:Ljavax/xml/namespace/QName;
     154: invokevirtual #97                 // Method createEndElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;)V
     157: goto          308
     160: iconst_0
     161: istore        4
     163: iload         4
     165: aload_3
     166: arraylength
     167: if_icmpge     308
     170: aload_3
     171: iload         4
     173: aaload
     174: astore        5
     176: new           #34                 // class java/util/ArrayList
     179: dup
     180: iconst_1
     181: invokespecial #35                 // Method java/util/ArrayList."<init>":(I)V
     184: astore        6
     186: aload         6
     188: aload_0
     189: getstatic     #102                // Field org/apache/wss4j/stax/ext/WSSConstants.ATT_NULL_Algorithm:Ljavax/xml/namespace/QName;
     192: aload         5
     194: invokevirtual #38                 // Method createAttribute:(Ljavax/xml/namespace/QName;Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/stax/XMLSecAttribute;
     197: invokeinterface #39,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     202: pop
     203: aload_0
     204: aload_1
     205: getstatic     #103                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_Transform:Ljavax/xml/namespace/QName;
     208: iconst_0
     209: aload         6
     211: invokevirtual #57                 // Method createStartElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;ZLjava/util/List;)Lorg/apache/xml/security/stax/ext/stax/XMLSecStartElement;
     214: pop
     215: aload_0
     216: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
     219: invokevirtual #106                // Method org/apache/xml/security/stax/ext/XMLSecurityProperties.isAddExcC14NInclusivePrefixes:()Z
     222: ifeq          294
     225: ldc           #107                // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Signature-Transform
     227: aload         5
     229: invokevirtual #101                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     232: ifne          294
     235: ldc           #108                // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete-Signature-Transform
     237: aload         5
     239: invokevirtual #101                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     242: ifne          294
     245: new           #34                 // class java/util/ArrayList
     248: dup
     249: iconst_1
     250: invokespecial #35                 // Method java/util/ArrayList."<init>":(I)V
     253: astore        6
     255: aload         6
     257: aload_0
     258: getstatic     #109                // Field org/apache/xml/security/stax/ext/XMLSecurityConstants.ATT_NULL_PrefixList:Ljavax/xml/namespace/QName;
     261: aload_2
     262: invokevirtual #110                // Method org/apache/xml/security/stax/impl/SignaturePartDef.getInclusiveNamespacesPrefixes:()Ljava/lang/String;
     265: invokevirtual #38                 // Method createAttribute:(Ljavax/xml/namespace/QName;Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/stax/XMLSecAttribute;
     268: invokeinterface #39,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     273: pop
     274: aload_0
     275: aload_1
     276: getstatic     #111                // Field org/apache/xml/security/stax/ext/XMLSecurityConstants.TAG_c14nExcl_InclusiveNamespaces:Ljavax/xml/namespace/QName;
     279: iconst_1
     280: aload         6
     282: invokevirtual #57                 // Method createStartElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;ZLjava/util/List;)Lorg/apache/xml/security/stax/ext/stax/XMLSecStartElement;
     285: pop
     286: aload_0
     287: aload_1
     288: getstatic     #111                // Field org/apache/xml/security/stax/ext/XMLSecurityConstants.TAG_c14nExcl_InclusiveNamespaces:Ljavax/xml/namespace/QName;
     291: invokevirtual #97                 // Method createEndElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;)V
     294: aload_0
     295: aload_1
     296: getstatic     #103                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_Transform:Ljavax/xml/namespace/QName;
     299: invokevirtual #97                 // Method createEndElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;)V
     302: iinc          4, 1
     305: goto          163
     308: aload_0
     309: aload_1
     310: getstatic     #99                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_Transforms:Ljavax/xml/namespace/QName;
     313: invokevirtual #97                 // Method createEndElementAndOutputAsEvent:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;)V
     316: return

  public void flushBufferAndCallbackAfterHeader(org.apache.xml.security.stax.ext.OutputProcessorChain, java.util.Deque<org.apache.xml.security.stax.ext.stax.XMLSecEvent>) throws javax.xml.stream.XMLStreamException, org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
       4: checkcast     #77                 // class org/apache/wss4j/stax/ext/WSSSecurityProperties
       7: invokevirtual #112                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActor:()Ljava/lang/String;
      10: astore_3
      11: aload_2
      12: invokeinterface #113,  1          // InterfaceMethod java/util/Deque.isEmpty:()Z
      17: ifne          168
      20: aload_2
      21: invokeinterface #114,  1          // InterfaceMethod java/util/Deque.pop:()Ljava/lang/Object;
      26: checkcast     #115                // class org/apache/xml/security/stax/ext/stax/XMLSecEvent
      29: astore        4
      31: aload         4
      33: invokeinterface #116,  1          // InterfaceMethod org/apache/xml/security/stax/ext/stax/XMLSecEvent.getEventType:()I
      38: lookupswitch  { // 1
                     1: 56
               default: 151
          }
      56: aload         4
      58: aload_3
      59: invokestatic  #117                // Method org/apache/wss4j/stax/utils/WSSUtils.isSecurityHeaderElement:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;Ljava/lang/String;)Z
      62: ifeq          151
      65: aload_1
      66: getstatic     #118                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_Signature:Ljavax/xml/namespace/QName;
      69: aload_0
      70: invokevirtual #15                 // Method getAction:()Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      73: iconst_1
      74: invokestatic  #119                // Method org/apache/wss4j/stax/impl/processor/output/OutputProcessorUtils.updateSecurityHeaderOrder:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;Z)V
      77: aload_1
      78: invokeinterface #25,  1           // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessorChain.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      83: ldc_w         #120                // class org/apache/wss4j/stax/impl/SecurityHeaderOrder
      86: invokeinterface #121,  2          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.getAsList:(Ljava/lang/Object;)Ljava/util/List;
      91: astore        5
      93: aconst_null
      94: astore        6
      96: aload         5
      98: ifnull        119
     101: new           #34                 // class java/util/ArrayList
     104: dup
     105: aload         5
     107: invokespecial #122                // Method java/util/ArrayList."<init>":(Ljava/util/Collection;)V
     110: astore        6
     112: aload         5
     114: invokeinterface #123,  1          // InterfaceMethod java/util/List.clear:()V
     119: aload_1
     120: invokeinterface #124,  1          // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessorChain.reset:()V
     125: aload_1
     126: aload         4
     128: invokeinterface #125,  2          // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessorChain.processEvent:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;)V
     133: aload         5
     135: ifnull        168
     138: aload         5
     140: aload         6
     142: invokeinterface #126,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     147: pop
     148: goto          168
     151: aload_1
     152: invokeinterface #124,  1          // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessorChain.reset:()V
     157: aload_1
     158: aload         4
     160: invokeinterface #125,  2          // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessorChain.processEvent:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;)V
     165: goto          11
     168: aload_0
     169: aload_1
     170: aload_2
     171: invokespecial #127                // Method org/apache/xml/security/stax/impl/processor/output/AbstractSignatureEndingOutputProcessor.flushBufferAndCallbackAfterHeader:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljava/util/Deque;)V
     174: return
}
