Compiled from "SAMLTokenOutputProcessor.java"
class org.apache.wss4j.stax.impl.processor.output.SAMLTokenOutputProcessor$FinalSAMLTokenOutputProcessor extends org.apache.xml.security.stax.ext.AbstractOutputProcessor {
  private final org.apache.xml.security.stax.securityToken.OutboundSecurityToken securityToken;

  private final org.apache.wss4j.common.saml.SamlAssertionWrapper samlAssertionWrapper;

  private final java.lang.String securityTokenReferenceId;

  private boolean senderVouches;

  private boolean includeSTR;

  final org.apache.wss4j.stax.impl.processor.output.SAMLTokenOutputProcessor this$0;

  org.apache.wss4j.stax.impl.processor.output.SAMLTokenOutputProcessor$FinalSAMLTokenOutputProcessor(org.apache.wss4j.stax.impl.processor.output.SAMLTokenOutputProcessor, org.apache.xml.security.stax.securityToken.OutboundSecurityToken, org.apache.wss4j.common.saml.SamlAssertionWrapper, java.lang.String, boolean, boolean) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #1                  // Field this$0:Lorg/apache/wss4j/stax/impl/processor/output/SAMLTokenOutputProcessor;
       5: aload_0
       6: invokespecial #2                  // Method org/apache/xml/security/stax/ext/AbstractOutputProcessor."<init>":()V
       9: aload_0
      10: iconst_0
      11: putfield      #3                  // Field senderVouches:Z
      14: aload_0
      15: iconst_0
      16: putfield      #4                  // Field includeSTR:Z
      19: aload_0
      20: ldc_w         #5                  // class org/apache/wss4j/stax/impl/processor/output/UsernameTokenOutputProcessor
      23: invokevirtual #6                  // Method java/lang/Class.getName:()Ljava/lang/String;
      26: invokevirtual #7                  // Method addAfterProcessor:(Ljava/lang/Object;)V
      29: aload_0
      30: ldc_w         #8                  // class org/apache/wss4j/stax/impl/processor/output/SAMLTokenOutputProcessor
      33: invokevirtual #6                  // Method java/lang/Class.getName:()Ljava/lang/String;
      36: invokevirtual #7                  // Method addAfterProcessor:(Ljava/lang/Object;)V
      39: aload_0
      40: aload_3
      41: putfield      #9                  // Field samlAssertionWrapper:Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
      44: aload_0
      45: aload         4
      47: putfield      #10                 // Field securityTokenReferenceId:Ljava/lang/String;
      50: aload_0
      51: iload         5
      53: putfield      #3                  // Field senderVouches:Z
      56: aload_0
      57: aload_2
      58: putfield      #11                 // Field securityToken:Lorg/apache/xml/security/stax/securityToken/OutboundSecurityToken;
      61: aload_0
      62: iload         6
      64: putfield      #4                  // Field includeSTR:Z
      67: return

  public void processEvent(org.apache.xml.security.stax.ext.stax.XMLSecEvent, org.apache.xml.security.stax.ext.OutputProcessorChain) throws javax.xml.stream.XMLStreamException, org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_2
       1: aload_1
       2: invokeinterface #12,  2           // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessorChain.processEvent:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;)V
       7: aload_1
       8: aload_0
       9: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
      12: checkcast     #14                 // class org/apache/wss4j/stax/ext/WSSSecurityProperties
      15: invokevirtual #15                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActor:()Ljava/lang/String;
      18: invokestatic  #16                 // Method org/apache/wss4j/stax/utils/WSSUtils.isSecurityHeaderElement:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;Ljava/lang/String;)Z
      21: ifeq          217
      24: aload_2
      25: aload_0
      26: invokeinterface #17,  2           // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessorChain.createSubChain:(Lorg/apache/xml/security/stax/ext/OutputProcessor;)Lorg/apache/xml/security/stax/ext/OutputProcessorChain;
      31: astore_3
      32: aload_0
      33: invokespecial #18                 // Method includeBST:()Z
      36: ifeq          81
      39: aload_2
      40: getstatic     #19                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_BinarySecurityToken:Ljavax/xml/namespace/QName;
      43: aload_0
      44: invokevirtual #20                 // Method getAction:()Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      47: iconst_0
      48: invokestatic  #21                 // Method org/apache/wss4j/stax/impl/processor/output/OutputProcessorUtils.updateSecurityHeaderOrder:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;Z)V
      51: aload_0
      52: aload_2
      53: aload_0
      54: getfield      #11                 // Field securityToken:Lorg/apache/xml/security/stax/securityToken/OutboundSecurityToken;
      57: invokeinterface #22,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getId:()Ljava/lang/String;
      62: aload_0
      63: getfield      #11                 // Field securityToken:Lorg/apache/xml/security/stax/securityToken/OutboundSecurityToken;
      66: invokeinterface #23,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/OutboundSecurityToken.getX509Certificates:()[Ljava/security/cert/X509Certificate;
      71: aload_0
      72: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
      75: invokevirtual #24                 // Method org/apache/xml/security/stax/ext/XMLSecurityProperties.isUseSingleCert:()Z
      78: invokestatic  #25                 // Method org/apache/wss4j/stax/utils/WSSUtils.createBinarySecurityTokenStructure:(Lorg/apache/xml/security/stax/ext/AbstractOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljava/lang/String;[Ljava/security/cert/X509Certificate;Z)V
      81: aload_0
      82: getfield      #9                  // Field samlAssertionWrapper:Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
      85: invokevirtual #26                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSamlVersion:()Lorg/opensaml/saml/common/SAMLVersion;
      88: getstatic     #27                 // Field org/opensaml/saml/common/SAMLVersion.VERSION_11:Lorg/opensaml/saml/common/SAMLVersion;
      91: if_acmpne     102
      94: getstatic     #28                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_saml_Assertion:Ljavax/xml/namespace/QName;
      97: astore        4
      99: goto          107
     102: getstatic     #29                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_saml2_Assertion:Ljavax/xml/namespace/QName;
     105: astore        4
     107: aload_2
     108: aload         4
     110: aload_0
     111: invokevirtual #20                 // Method getAction:()Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     114: iconst_0
     115: invokestatic  #21                 // Method org/apache/wss4j/stax/impl/processor/output/OutputProcessorUtils.updateSecurityHeaderOrder:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;Z)V
     118: iconst_0
     119: invokestatic  #30                 // Method org/apache/xml/security/utils/XMLUtils.createDocumentBuilder:(Z)Ljavax/xml/parsers/DocumentBuilder;
     122: astore        5
     124: aload_0
     125: aload_0
     126: getfield      #9                  // Field samlAssertionWrapper:Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
     129: aload         5
     131: invokevirtual #31                 // Method javax/xml/parsers/DocumentBuilder.newDocument:()Lorg/w3c/dom/Document;
     134: invokevirtual #32                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.toDOM:(Lorg/w3c/dom/Document;)Lorg/w3c/dom/Element;
     137: aload_3
     138: invokevirtual #33                 // Method outputDOMElement:(Lorg/w3c/dom/Element;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;)V
     141: goto          168
     144: astore        5
     146: invokestatic  #35                 // Method org/apache/wss4j/stax/impl/processor/output/SAMLTokenOutputProcessor.access$000:()Lorg/slf4j/Logger;
     149: ldc           #36                 // String Error writing out SAML Assertion
     151: aload         5
     153: invokeinterface #37,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
     158: new           #38                 // class org/apache/xml/security/exceptions/XMLSecurityException
     161: dup
     162: aload         5
     164: invokespecial #39                 // Method org/apache/xml/security/exceptions/XMLSecurityException."<init>":(Ljava/lang/Exception;)V
     167: athrow
     168: aload_0
     169: getfield      #4                  // Field includeSTR:Z
     172: ifeq          210
     175: aload_2
     176: getstatic     #40                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_SecurityTokenReference:Ljavax/xml/namespace/QName;
     179: aload_0
     180: invokevirtual #20                 // Method getAction:()Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     183: iconst_0
     184: invokestatic  #21                 // Method org/apache/wss4j/stax/impl/processor/output/OutputProcessorUtils.updateSecurityHeaderOrder:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;Z)V
     187: aload_0
     188: getfield      #1                  // Field this$0:Lorg/apache/wss4j/stax/impl/processor/output/SAMLTokenOutputProcessor;
     191: aload_3
     192: aload_0
     193: getfield      #9                  // Field samlAssertionWrapper:Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
     196: aload_0
     197: getfield      #10                 // Field securityTokenReferenceId:Ljava/lang/String;
     200: aload_0
     201: getfield      #9                  // Field samlAssertionWrapper:Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
     204: invokevirtual #41                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getId:()Ljava/lang/String;
     207: invokestatic  #42                 // Method org/apache/wss4j/stax/impl/processor/output/SAMLTokenOutputProcessor.access$100:(Lorg/apache/wss4j/stax/impl/processor/output/SAMLTokenOutputProcessor;Lorg/apache/xml/security/stax/ext/OutputProcessorChain;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Ljava/lang/String;Ljava/lang/String;)V
     210: aload_2
     211: aload_0
     212: invokeinterface #43,  2           // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessorChain.removeProcessor:(Lorg/apache/xml/security/stax/ext/OutputProcessor;)V
     217: return
    Exception table:
       from    to  target type
         118   141   144   Class javax/xml/parsers/ParserConfigurationException

  private boolean includeBST();
    Code:
       0: aload_0
       1: getfield      #3                  // Field senderVouches:Z
       4: ifeq          55
       7: aload_0
       8: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
      11: invokevirtual #44                 // Method org/apache/xml/security/stax/ext/XMLSecurityProperties.getSignatureKeyIdentifier:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      14: getstatic     #45                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      17: if_acmpne     55
      20: aload_0
      21: getfield      #11                 // Field securityToken:Lorg/apache/xml/security/stax/securityToken/OutboundSecurityToken;
      24: ifnull        55
      27: getstatic     #46                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_SIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      30: aload_0
      31: getfield      #47                 // Field action:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      34: invokevirtual #48                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
      37: ifeq          53
      40: aload_0
      41: invokevirtual #13                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
      44: checkcast     #14                 // class org/apache/wss4j/stax/ext/WSSSecurityProperties
      47: invokevirtual #49                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.isIncludeSignatureToken:()Z
      50: ifne          55
      53: iconst_1
      54: ireturn
      55: iconst_0
      56: ireturn
}
