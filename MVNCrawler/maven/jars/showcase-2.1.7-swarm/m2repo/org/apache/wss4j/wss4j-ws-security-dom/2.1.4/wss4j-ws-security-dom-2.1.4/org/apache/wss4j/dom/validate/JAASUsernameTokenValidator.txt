Compiled from "JAASUsernameTokenValidator.java"
public class org.apache.wss4j.dom.validate.JAASUsernameTokenValidator implements org.apache.wss4j.dom.validate.Validator {
  private static final org.slf4j.Logger LOG;

  private java.lang.String contextName;

  public org.apache.wss4j.dom.validate.JAASUsernameTokenValidator();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public void setContextName(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #2                  // Field contextName:Ljava/lang/String;
       5: return

  public java.lang.String getContextName();
    Code:
       0: aload_0
       1: getfield      #2                  // Field contextName:Ljava/lang/String;
       4: areturn

  public org.apache.wss4j.dom.validate.Credential validate(org.apache.wss4j.dom.validate.Credential, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnull        11
       4: aload_1
       5: invokevirtual #3                  // Method org/apache/wss4j/dom/validate/Credential.getUsernametoken:()Lorg/apache/wss4j/dom/message/token/UsernameToken;
       8: ifnonnull     24
      11: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
      14: dup
      15: getstatic     #5                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      18: ldc           #6                  // String noCredential
      20: invokespecial #7                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      23: athrow
      24: aconst_null
      25: astore_3
      26: aconst_null
      27: astore        4
      29: aload_1
      30: invokevirtual #3                  // Method org/apache/wss4j/dom/validate/Credential.getUsernametoken:()Lorg/apache/wss4j/dom/message/token/UsernameToken;
      33: astore        5
      35: aload         5
      37: invokevirtual #8                  // Method org/apache/wss4j/dom/message/token/UsernameToken.getName:()Ljava/lang/String;
      40: astore_3
      41: aload         5
      43: invokevirtual #9                  // Method org/apache/wss4j/dom/message/token/UsernameToken.getPasswordType:()Ljava/lang/String;
      46: astore        6
      48: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
      51: invokeinterface #11,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
      56: ifeq          118
      59: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
      62: new           #12                 // class java/lang/StringBuilder
      65: dup
      66: invokespecial #13                 // Method java/lang/StringBuilder."<init>":()V
      69: ldc           #14                 // String UsernameToken user
      71: invokevirtual #15                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      74: aload         5
      76: invokevirtual #8                  // Method org/apache/wss4j/dom/message/token/UsernameToken.getName:()Ljava/lang/String;
      79: invokevirtual #15                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      82: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      85: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      90: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
      93: new           #12                 // class java/lang/StringBuilder
      96: dup
      97: invokespecial #13                 // Method java/lang/StringBuilder."<init>":()V
     100: ldc           #18                 // String UsernameToken password type
     102: invokevirtual #15                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     105: aload         6
     107: invokevirtual #15                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     110: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     113: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     118: aload         5
     120: invokevirtual #19                 // Method org/apache/wss4j/dom/message/token/UsernameToken.isHashed:()Z
     123: ifeq          147
     126: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
     129: ldc           #20                 // String Authentication failed as hashed username token not supported
     131: invokeinterface #21,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     136: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
     139: dup
     140: getstatic     #22                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     143: invokespecial #23                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     146: athrow
     147: aload         5
     149: invokevirtual #24                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getPassword:()Ljava/lang/String;
     152: astore        4
     154: ldc           #25                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText
     156: aload         6
     158: invokevirtual #26                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     161: ifne          208
     164: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
     167: new           #12                 // class java/lang/StringBuilder
     170: dup
     171: invokespecial #13                 // Method java/lang/StringBuilder."<init>":()V
     174: ldc           #27                 // String Password type
     176: invokevirtual #15                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     179: aload         6
     181: invokevirtual #15                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     184: ldc           #28                 // String  not supported
     186: invokevirtual #15                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     189: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     192: invokeinterface #21,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     197: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
     200: dup
     201: getstatic     #22                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     204: invokespecial #23                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     207: athrow
     208: aload_3
     209: ifnull        232
     212: aload_3
     213: invokevirtual #29                 // Method java/lang/String.length:()I
     216: ifle          232
     219: aload         4
     221: ifnull        232
     224: aload         4
     226: invokevirtual #29                 // Method java/lang/String.length:()I
     229: ifgt          253
     232: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
     235: ldc           #30                 // String User or password empty
     237: invokeinterface #21,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     242: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
     245: dup
     246: getstatic     #22                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     249: invokespecial #23                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     252: athrow
     253: aload_0
     254: aload_3
     255: aload         4
     257: invokevirtual #31                 // Method getCallbackHandler:(Ljava/lang/String;Ljava/lang/String;)Ljavax/security/auth/callback/CallbackHandler;
     260: astore        7
     262: new           #32                 // class javax/security/auth/login/LoginContext
     265: dup
     266: aload_0
     267: invokevirtual #33                 // Method getContextName:()Ljava/lang/String;
     270: aload         7
     272: invokespecial #34                 // Method javax/security/auth/login/LoginContext."<init>":(Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)V
     275: astore        8
     277: aload         8
     279: invokevirtual #35                 // Method javax/security/auth/login/LoginContext.login:()V
     282: aload         8
     284: invokevirtual #36                 // Method javax/security/auth/login/LoginContext.getSubject:()Ljavax/security/auth/Subject;
     287: astore        9
     289: aload_1
     290: aload         9
     292: invokevirtual #37                 // Method org/apache/wss4j/dom/validate/Credential.setSubject:(Ljavax/security/auth/Subject;)V
     295: goto          325
     298: astore        7
     300: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
     303: ldc           #39                 // String Authentication failed
     305: aload         7
     307: invokeinterface #40,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Throwable;)V
     312: new           #4                  // class org/apache/wss4j/common/ext/WSSecurityException
     315: dup
     316: getstatic     #22                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     319: aload         7
     321: invokespecial #41                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     324: athrow
     325: aload_1
     326: areturn
    Exception table:
       from    to  target type
         253   295   298   Class javax/security/auth/login/LoginException

  protected javax.security.auth.callback.CallbackHandler getCallbackHandler(java.lang.String, java.lang.String);
    Code:
       0: new           #42                 // class org/apache/wss4j/common/NamePasswordCallbackHandler
       3: dup
       4: aload_1
       5: aload_2
       6: invokespecial #43                 // Method org/apache/wss4j/common/NamePasswordCallbackHandler."<init>":(Ljava/lang/String;Ljava/lang/String;)V
       9: areturn

  static {};
    Code:
       0: ldc_w         #44                 // class org/apache/wss4j/dom/validate/JAASUsernameTokenValidator
       3: invokestatic  #45                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
       9: return
}
