Compiled from "DecryptInputProcessor.java"
public class org.apache.wss4j.stax.impl.processor.input.DecryptInputProcessor extends org.apache.xml.security.stax.impl.processor.input.AbstractDecryptInputProcessor {
  private static final transient org.slf4j.Logger log;

  private static final java.lang.Long maximumAllowedDecompressedBytes;

  private java.util.List<org.apache.wss4j.stax.impl.processor.input.DecryptInputProcessor$DeferredAttachment> attachmentReferences;

  public org.apache.wss4j.stax.impl.processor.input.DecryptInputProcessor(org.apache.xml.security.binding.xmldsig.KeyInfoType, org.apache.xml.security.binding.xmlenc.ReferenceList, org.apache.wss4j.stax.ext.WSSSecurityProperties, org.apache.wss4j.stax.ext.WSInboundSecurityContext) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: invokespecial #1                  // Method org/apache/xml/security/stax/impl/processor/input/AbstractDecryptInputProcessor."<init>":(Lorg/apache/xml/security/binding/xmldsig/KeyInfoType;Lorg/apache/xml/security/binding/xmlenc/ReferenceList;Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;)V
       7: aload_0
       8: new           #2                  // class java/util/ArrayList
      11: dup
      12: invokespecial #3                  // Method java/util/ArrayList."<init>":()V
      15: putfield      #4                  // Field attachmentReferences:Ljava/util/List;
      18: aload_0
      19: aload_1
      20: aload_2
      21: aload         4
      23: getstatic     #5                  // Field org/apache/wss4j/common/bsp/BSPRule.R3006:Lorg/apache/wss4j/common/bsp/BSPRule;
      26: invokespecial #6                  // Method checkBSPCompliance:(Lorg/apache/xml/security/binding/xmldsig/KeyInfoType;Lorg/apache/xml/security/binding/xmlenc/ReferenceList;Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/bsp/BSPRule;)V
      29: return

  private void checkBSPCompliance(org.apache.xml.security.binding.xmldsig.KeyInfoType, org.apache.xml.security.binding.xmlenc.ReferenceList, org.apache.wss4j.stax.ext.WSInboundSecurityContext, org.apache.wss4j.common.bsp.BSPRule) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnull        55
       4: aload_1
       5: invokevirtual #7                  // Method org/apache/xml/security/binding/xmldsig/KeyInfoType.getContent:()Ljava/util/List;
       8: invokeinterface #8,  1            // InterfaceMethod java/util/List.size:()I
      13: iconst_1
      14: if_icmpeq     26
      17: aload_3
      18: getstatic     #9                  // Field org/apache/wss4j/common/bsp/BSPRule.R5424:Lorg/apache/wss4j/common/bsp/BSPRule;
      21: invokeinterface #10,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      26: aload_1
      27: invokevirtual #7                  // Method org/apache/xml/security/binding/xmldsig/KeyInfoType.getContent:()Ljava/util/List;
      30: getstatic     #11                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_SecurityTokenReference:Ljavax/xml/namespace/QName;
      33: invokestatic  #12                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      36: checkcast     #13                 // class org/apache/wss4j/binding/wss10/SecurityTokenReferenceType
      39: astore        5
      41: aload         5
      43: ifnonnull     55
      46: aload_3
      47: getstatic     #14                 // Field org/apache/wss4j/common/bsp/BSPRule.R5426:Lorg/apache/wss4j/common/bsp/BSPRule;
      50: invokeinterface #10,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      55: aload_2
      56: ifnull        126
      59: aload_2
      60: invokevirtual #15                 // Method org/apache/xml/security/binding/xmlenc/ReferenceList.getDataReferenceOrKeyReference:()Ljava/util/List;
      63: astore        5
      65: aload         5
      67: invokeinterface #16,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      72: astore        6
      74: aload         6
      76: invokeinterface #17,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      81: ifeq          126
      84: aload         6
      86: invokeinterface #18,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      91: checkcast     #19                 // class javax/xml/bind/JAXBElement
      94: invokevirtual #20                 // Method javax/xml/bind/JAXBElement.getValue:()Ljava/lang/Object;
      97: checkcast     #21                 // class org/apache/xml/security/binding/xmlenc/ReferenceType
     100: astore        7
     102: aload         7
     104: invokevirtual #22                 // Method org/apache/xml/security/binding/xmlenc/ReferenceType.getURI:()Ljava/lang/String;
     107: ldc           #23                 // String #
     109: invokevirtual #24                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     112: ifne          123
     115: aload_3
     116: aload         4
     118: invokeinterface #10,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     123: goto          74
     126: return

  protected java.io.InputStream applyTransforms(org.apache.xml.security.binding.xmlenc.ReferenceType, java.io.InputStream) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_1
       1: ifnull        137
       4: aload_1
       5: invokevirtual #25                 // Method org/apache/xml/security/binding/xmlenc/ReferenceType.getAny:()Ljava/util/List;
       8: getstatic     #26                 // Field org/apache/xml/security/stax/ext/XMLSecurityConstants.TAG_dsig_Transforms:Ljavax/xml/namespace/QName;
      11: invokestatic  #12                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      14: checkcast     #27                 // class org/apache/xml/security/binding/xmldsig/TransformsType
      17: astore_3
      18: aload_3
      19: ifnull        137
      22: aload_3
      23: invokevirtual #28                 // Method org/apache/xml/security/binding/xmldsig/TransformsType.getTransform:()Ljava/util/List;
      26: astore        4
      28: aload         4
      30: invokeinterface #8,  1            // InterfaceMethod java/util/List.size:()I
      35: iconst_1
      36: if_icmple     49
      39: new           #29                 // class org/apache/xml/security/exceptions/XMLSecurityException
      42: dup
      43: ldc           #30                 // String stax.encryption.Transforms.NotYetImplemented
      45: invokespecial #31                 // Method org/apache/xml/security/exceptions/XMLSecurityException."<init>":(Ljava/lang/String;)V
      48: athrow
      49: aload         4
      51: iconst_0
      52: invokeinterface #32,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      57: checkcast     #33                 // class org/apache/xml/security/binding/xmldsig/TransformType
      60: astore        5
      62: aload         5
      64: invokevirtual #34                 // Method org/apache/xml/security/binding/xmldsig/TransformType.getAlgorithm:()Ljava/lang/String;
      67: getstatic     #35                 // Field org/apache/xml/security/stax/ext/XMLSecurityConstants$DIRECTION.IN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$DIRECTION;
      70: invokestatic  #36                 // Method org/apache/xml/security/stax/config/TransformerAlgorithmMapper.getTransformerClass:(Ljava/lang/String;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$DIRECTION;)Ljava/lang/Class;
      73: astore        6
      75: aload         6
      77: iconst_1
      78: anewarray     #37                 // class java/lang/Class
      81: dup
      82: iconst_0
      83: ldc_w         #38                 // class java/io/InputStream
      86: aastore
      87: invokevirtual #39                 // Method java/lang/Class.getConstructor:([Ljava/lang/Class;)Ljava/lang/reflect/Constructor;
      90: astore        7
      92: new           #40                 // class org/apache/xml/security/stax/impl/util/LimitingInputStream
      95: dup
      96: aload         7
      98: iconst_1
      99: anewarray     #41                 // class java/lang/Object
     102: dup
     103: iconst_0
     104: aload_2
     105: aastore
     106: invokevirtual #42                 // Method java/lang/reflect/Constructor.newInstance:([Ljava/lang/Object;)Ljava/lang/Object;
     109: checkcast     #38                 // class java/io/InputStream
     112: getstatic     #43                 // Field maximumAllowedDecompressedBytes:Ljava/lang/Long;
     115: invokevirtual #44                 // Method java/lang/Long.longValue:()J
     118: invokespecial #45                 // Method org/apache/xml/security/stax/impl/util/LimitingInputStream."<init>":(Ljava/io/InputStream;J)V
     121: astore_2
     122: goto          137
     125: astore        7
     127: new           #29                 // class org/apache/xml/security/exceptions/XMLSecurityException
     130: dup
     131: aload         7
     133: invokespecial #50                 // Method org/apache/xml/security/exceptions/XMLSecurityException."<init>":(Ljava/lang/Exception;)V
     136: athrow
     137: aload_2
     138: areturn
    Exception table:
       from    to  target type
          75   122   125   Class java/lang/reflect/InvocationTargetException
          75   122   125   Class java/lang/NoSuchMethodException
          75   122   125   Class java/lang/InstantiationException
          75   122   125   Class java/lang/IllegalAccessException

  protected void handleEncryptedContent(org.apache.xml.security.stax.ext.InputProcessorChain, org.apache.xml.security.stax.ext.stax.XMLSecStartElement, org.apache.xml.security.stax.securityToken.InboundSecurityToken, org.apache.xml.security.binding.xmlenc.EncryptedDataType) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_1
       1: invokeinterface #51,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InputProcessorChain.getDocumentContext:()Lorg/apache/xml/security/stax/ext/DocumentContext;
       6: astore        5
       8: aload_2
       9: invokeinterface #52,  1           // InterfaceMethod org/apache/xml/security/stax/ext/stax/XMLSecStartElement.getElementPath:()Ljava/util/List;
      14: astore        6
      16: aload         6
      18: invokeinterface #8,  1            // InterfaceMethod java/util/List.size:()I
      23: iconst_2
      24: if_icmpne     92
      27: aload         6
      29: invokestatic  #53                 // Method org/apache/wss4j/stax/utils/WSSUtils.isInSOAPBody:(Ljava/util/List;)Z
      32: ifeq          92
      35: new           #54                 // class org/apache/wss4j/stax/securityEvent/EncryptedPartSecurityEvent
      38: dup
      39: aload_3
      40: iconst_1
      41: aload         5
      43: invokeinterface #55,  1           // InterfaceMethod org/apache/xml/security/stax/ext/DocumentContext.getProtectionOrder:()Ljava/util/List;
      48: invokespecial #56                 // Method org/apache/wss4j/stax/securityEvent/EncryptedPartSecurityEvent."<init>":(Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;ZLjava/util/List;)V
      51: astore        7
      53: aload         7
      55: aload         6
      57: invokevirtual #57                 // Method org/apache/wss4j/stax/securityEvent/EncryptedPartSecurityEvent.setElementPath:(Ljava/util/List;)V
      60: aload         7
      62: aload_2
      63: invokevirtual #58                 // Method org/apache/wss4j/stax/securityEvent/EncryptedPartSecurityEvent.setXmlSecEvent:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;)V
      66: aload         7
      68: aload         4
      70: invokevirtual #59                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getId:()Ljava/lang/String;
      73: invokevirtual #60                 // Method org/apache/wss4j/stax/securityEvent/EncryptedPartSecurityEvent.setCorrelationID:(Ljava/lang/String;)V
      76: aload_1
      77: invokeinterface #61,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InputProcessorChain.getSecurityContext:()Lorg/apache/xml/security/stax/ext/InboundSecurityContext;
      82: aload         7
      84: invokeinterface #62,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.registerSecurityEvent:(Lorg/apache/xml/security/stax/securityEvent/SecurityEvent;)V
      89: goto          146
      92: new           #63                 // class org/apache/xml/security/stax/securityEvent/ContentEncryptedElementSecurityEvent
      95: dup
      96: aload_3
      97: iconst_1
      98: aload         5
     100: invokeinterface #55,  1           // InterfaceMethod org/apache/xml/security/stax/ext/DocumentContext.getProtectionOrder:()Ljava/util/List;
     105: invokespecial #64                 // Method org/apache/xml/security/stax/securityEvent/ContentEncryptedElementSecurityEvent."<init>":(Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;ZLjava/util/List;)V
     108: astore        7
     110: aload         7
     112: aload         6
     114: invokevirtual #65                 // Method org/apache/xml/security/stax/securityEvent/ContentEncryptedElementSecurityEvent.setElementPath:(Ljava/util/List;)V
     117: aload         7
     119: aload_2
     120: invokevirtual #66                 // Method org/apache/xml/security/stax/securityEvent/ContentEncryptedElementSecurityEvent.setXmlSecEvent:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;)V
     123: aload         7
     125: aload         4
     127: invokevirtual #59                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getId:()Ljava/lang/String;
     130: invokevirtual #67                 // Method org/apache/xml/security/stax/securityEvent/ContentEncryptedElementSecurityEvent.setCorrelationID:(Ljava/lang/String;)V
     133: aload_1
     134: invokeinterface #61,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InputProcessorChain.getSecurityContext:()Lorg/apache/xml/security/stax/ext/InboundSecurityContext;
     139: aload         7
     141: invokeinterface #62,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.registerSecurityEvent:(Lorg/apache/xml/security/stax/securityEvent/SecurityEvent;)V
     146: return

  protected void handleCipherReference(org.apache.xml.security.stax.ext.InputProcessorChain, org.apache.xml.security.binding.xmlenc.EncryptedDataType, javax.crypto.Cipher, org.apache.xml.security.stax.securityToken.InboundSecurityToken) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #68                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getType:()Ljava/lang/String;
       4: astore        5
       6: aload         5
       8: ifnull        132
      11: ldc           #69                 // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Only
      13: aload         5
      15: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      18: ifne          31
      21: ldc           #71                 // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete
      23: aload         5
      25: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      28: ifeq          132
      31: aload_2
      32: invokevirtual #72                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getCipherData:()Lorg/apache/xml/security/binding/xmlenc/CipherDataType;
      35: invokevirtual #73                 // Method org/apache/xml/security/binding/xmlenc/CipherDataType.getCipherReference:()Lorg/apache/xml/security/binding/xmlenc/CipherReferenceType;
      38: astore        6
      40: aload         6
      42: ifnonnull     56
      45: new           #74                 // class org/apache/wss4j/common/ext/WSSecurityException
      48: dup
      49: getstatic     #75                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      52: invokespecial #76                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      55: athrow
      56: aload         6
      58: invokevirtual #77                 // Method org/apache/xml/security/binding/xmlenc/CipherReferenceType.getURI:()Ljava/lang/String;
      61: astore        7
      63: aload         7
      65: ifnull        77
      68: aload         7
      70: invokevirtual #78                 // Method java/lang/String.length:()I
      73: iconst_5
      74: if_icmpge     88
      77: new           #74                 // class org/apache/wss4j/common/ext/WSSecurityException
      80: dup
      81: getstatic     #75                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      84: invokespecial #76                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      87: athrow
      88: aload         7
      90: ldc           #79                 // String cid:
      92: invokevirtual #24                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      95: ifne          109
      98: new           #74                 // class org/apache/wss4j/common/ext/WSSecurityException
     101: dup
     102: getstatic     #75                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     105: invokespecial #76                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     108: athrow
     109: aload_0
     110: getfield      #4                  // Field attachmentReferences:Ljava/util/List;
     113: new           #80                 // class org/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DeferredAttachment
     116: dup
     117: aload_0
     118: aload_2
     119: aload_3
     120: aload         4
     122: aconst_null
     123: invokespecial #81                 // Method org/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DeferredAttachment."<init>":(Lorg/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor;Lorg/apache/xml/security/binding/xmlenc/EncryptedDataType;Ljavax/crypto/Cipher;Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;Lorg/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$1;)V
     126: invokeinterface #82,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     131: pop
     132: return

  protected org.apache.xml.security.stax.impl.processor.input.AbstractDecryptInputProcessor$AbstractDecryptedEventReaderInputProcessor newDecryptedEventReaderInputProcessor(boolean, org.apache.xml.security.stax.ext.stax.XMLSecStartElement, org.apache.xml.security.binding.xmlenc.EncryptedDataType, org.apache.xml.security.stax.securityToken.InboundSecurityToken, org.apache.xml.security.stax.ext.InboundSecurityContext) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_3
       1: invokevirtual #83                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getEncryptionMethod:()Lorg/apache/xml/security/binding/xmlenc/EncryptionMethodType;
       4: invokevirtual #84                 // Method org/apache/xml/security/binding/xmlenc/EncryptionMethodType.getAlgorithm:()Ljava/lang/String;
       7: astore        6
       9: aload_0
      10: invokevirtual #85                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
      13: invokevirtual #86                 // Method org/apache/xml/security/stax/ext/XMLSecurityProperties.getEncryptionSymAlgorithm:()Ljava/lang/String;
      16: ifnull        55
      19: aload_0
      20: invokevirtual #85                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
      23: invokevirtual #86                 // Method org/apache/xml/security/stax/ext/XMLSecurityProperties.getEncryptionSymAlgorithm:()Ljava/lang/String;
      26: aload         6
      28: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      31: ifne          55
      34: getstatic     #87                 // Field log:Lorg/slf4j/Logger;
      37: ldc           #88                 // String The Key encryption method does not match the requirement
      39: invokeinterface #89,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      44: new           #74                 // class org/apache/wss4j/common/ext/WSSecurityException
      47: dup
      48: getstatic     #90                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      51: invokespecial #76                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      54: athrow
      55: ldc           #91                 // String http://www.w3.org/2001/04/xmlenc#tripledes-cbc
      57: aload         6
      59: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      62: ifne          118
      65: ldc           #92                 // String http://www.w3.org/2001/04/xmlenc#aes128-cbc
      67: aload         6
      69: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      72: ifne          118
      75: ldc           #93                 // String http://www.w3.org/2009/xmlenc11#aes128-gcm
      77: aload         6
      79: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      82: ifne          118
      85: ldc           #94                 // String http://www.w3.org/2001/04/xmlenc#aes256-cbc
      87: aload         6
      89: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      92: ifne          118
      95: ldc           #95                 // String http://www.w3.org/2009/xmlenc11#aes256-gcm
      97: aload         6
      99: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     102: ifne          118
     105: aload         5
     107: checkcast     #96                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     110: getstatic     #97                 // Field org/apache/wss4j/common/bsp/BSPRule.R5620:Lorg/apache/wss4j/common/bsp/BSPRule;
     113: invokeinterface #10,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     118: new           #98                 // class org/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DecryptedEventReaderInputProcessor
     121: dup
     122: aload_0
     123: aload_0
     124: invokevirtual #85                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
     127: aload_3
     128: invokevirtual #68                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getType:()Ljava/lang/String;
     131: invokestatic  #99                 // Method org/apache/xml/security/stax/ext/SecurePart$Modifier.getModifier:(Ljava/lang/String;)Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     134: iload_1
     135: aload_2
     136: aload_3
     137: aload_0
     138: aload         4
     140: invokespecial #100                // Method org/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DecryptedEventReaderInputProcessor."<init>":(Lorg/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;ZLorg/apache/xml/security/stax/ext/stax/XMLSecStartElement;Lorg/apache/xml/security/binding/xmlenc/EncryptedDataType;Lorg/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor;Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;)V
     143: areturn

  protected void handleSecurityToken(org.apache.xml.security.stax.securityToken.InboundSecurityToken, org.apache.xml.security.stax.ext.InboundSecurityContext, org.apache.xml.security.binding.xmlenc.EncryptedDataType) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_1
       1: getstatic     #101                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.TokenUsage_Encryption:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenUsage;
       4: invokeinterface #102,  2          // InterfaceMethod org/apache/xml/security/stax/securityToken/InboundSecurityToken.addTokenUsage:(Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenUsage;)V
       9: aload_1
      10: aload_3
      11: invokevirtual #59                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getId:()Ljava/lang/String;
      14: invokestatic  #103                // Method org/apache/wss4j/stax/utils/WSSUtils.createTokenSecurityEvent:(Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;Ljava/lang/String;)Lorg/apache/xml/security/stax/securityEvent/TokenSecurityEvent;
      17: astore        4
      19: aload_2
      20: aload         4
      22: invokeinterface #62,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.registerSecurityEvent:(Lorg/apache/xml/security/stax/securityEvent/SecurityEvent;)V
      27: return

  public void doFinal(org.apache.xml.security.stax.ext.InputProcessorChain) throws javax.xml.stream.XMLStreamException, org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_1
       1: invokeinterface #61,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InputProcessorChain.getSecurityContext:()Lorg/apache/xml/security/stax/ext/InboundSecurityContext;
       6: ldc           #104                // String PROP_ENCRYPTED_DATA_REFS
       8: invokeinterface #105,  2          // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.getAsList:(Ljava/lang/Object;)Ljava/util/List;
      13: astore_2
      14: aload_2
      15: ifnull        155
      18: aload_2
      19: invokeinterface #106,  1          // InterfaceMethod java/util/List.isEmpty:()Z
      24: ifne          155
      27: aload_0
      28: invokevirtual #107                // Method getReferences:()Ljava/util/Map;
      31: astore_3
      32: aload_0
      33: invokevirtual #108                // Method getProcessedReferences:()Ljava/util/List;
      36: astore        4
      38: aload_3
      39: ifnull        155
      42: aload_3
      43: invokeinterface #109,  1          // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
      48: invokeinterface #110,  1          // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      53: astore        5
      55: aload         5
      57: invokeinterface #17,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      62: ifeq          155
      65: aload         5
      67: invokeinterface #18,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      72: checkcast     #111                // class java/util/Map$Entry
      75: astore        6
      77: aload         6
      79: invokeinterface #112,  1          // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
      84: checkcast     #21                 // class org/apache/xml/security/binding/xmlenc/ReferenceType
      87: astore        7
      89: aload         7
      91: invokevirtual #22                 // Method org/apache/xml/security/binding/xmlenc/ReferenceType.getURI:()Ljava/lang/String;
      94: invokestatic  #113                // Method org/apache/wss4j/stax/utils/WSSUtils.dropReferenceMarker:(Ljava/lang/String;)Ljava/lang/String;
      97: astore        8
      99: aload_2
     100: invokeinterface #16,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     105: astore        9
     107: aload         9
     109: invokeinterface #17,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     114: ifeq          152
     117: aload         9
     119: invokeinterface #18,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     124: checkcast     #114                // class java/lang/String
     127: astore        10
     129: aload         10
     131: aload         8
     133: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     136: ifeq          149
     139: aload         4
     141: aload         7
     143: invokeinterface #82,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     148: pop
     149: goto          107
     152: goto          55
     155: aload_0
     156: aload_1
     157: invokespecial #115                // Method org/apache/xml/security/stax/impl/processor/input/AbstractDecryptInputProcessor.doFinal:(Lorg/apache/xml/security/stax/ext/InputProcessorChain;)V
     160: iconst_0
     161: istore_3
     162: iload_3
     163: aload_0
     164: getfield      #4                  // Field attachmentReferences:Ljava/util/List;
     167: invokeinterface #8,  1            // InterfaceMethod java/util/List.size:()I
     172: if_icmpge     654
     175: aload_0
     176: getfield      #4                  // Field attachmentReferences:Ljava/util/List;
     179: iload_3
     180: invokeinterface #32,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     185: checkcast     #80                 // class org/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DeferredAttachment
     188: astore        4
     190: aload         4
     192: invokestatic  #116                // Method org/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DeferredAttachment.access$100:(Lorg/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DeferredAttachment;)Lorg/apache/xml/security/binding/xmlenc/EncryptedDataType;
     195: astore        5
     197: aload         4
     199: invokestatic  #117                // Method org/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DeferredAttachment.access$200:(Lorg/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DeferredAttachment;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
     202: astore        6
     204: aload         4
     206: invokestatic  #118                // Method org/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DeferredAttachment.access$300:(Lorg/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor$DeferredAttachment;)Ljavax/crypto/Cipher;
     209: astore        7
     211: aload         5
     213: invokevirtual #72                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getCipherData:()Lorg/apache/xml/security/binding/xmlenc/CipherDataType;
     216: invokevirtual #73                 // Method org/apache/xml/security/binding/xmlenc/CipherDataType.getCipherReference:()Lorg/apache/xml/security/binding/xmlenc/CipherReferenceType;
     219: invokevirtual #77                 // Method org/apache/xml/security/binding/xmlenc/CipherReferenceType.getURI:()Ljava/lang/String;
     222: astore        8
     224: aload         8
     226: iconst_4
     227: invokevirtual #119                // Method java/lang/String.substring:(I)Ljava/lang/String;
     230: astore        9
     232: aload_0
     233: invokevirtual #85                 // Method getSecurityProperties:()Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;
     236: checkcast     #120                // class org/apache/wss4j/stax/ext/WSSSecurityProperties
     239: invokevirtual #121                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getAttachmentCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     242: astore        10
     244: aload         10
     246: ifnonnull     271
     249: new           #74                 // class org/apache/wss4j/common/ext/WSSecurityException
     252: dup
     253: getstatic     #90                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     256: ldc           #122                // String empty
     258: iconst_1
     259: anewarray     #41                 // class java/lang/Object
     262: dup
     263: iconst_0
     264: ldc           #123                // String no attachment callbackhandler supplied
     266: aastore
     267: invokespecial #124                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     270: athrow
     271: new           #125                // class org/apache/wss4j/common/ext/AttachmentRequestCallback
     274: dup
     275: invokespecial #126                // Method org/apache/wss4j/common/ext/AttachmentRequestCallback."<init>":()V
     278: astore        11
     280: aload         11
     282: aload         9
     284: invokevirtual #127                // Method org/apache/wss4j/common/ext/AttachmentRequestCallback.setAttachmentId:(Ljava/lang/String;)V
     287: aload         10
     289: iconst_1
     290: anewarray     #128                // class javax/security/auth/callback/Callback
     293: dup
     294: iconst_0
     295: aload         11
     297: aastore
     298: invokeinterface #129,  2          // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     303: goto          321
     306: astore        12
     308: new           #74                 // class org/apache/wss4j/common/ext/WSSecurityException
     311: dup
     312: getstatic     #90                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     315: aload         12
     317: invokespecial #131                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     320: athrow
     321: aload         11
     323: invokevirtual #132                // Method org/apache/wss4j/common/ext/AttachmentRequestCallback.getAttachments:()Ljava/util/List;
     326: astore        12
     328: aload         12
     330: ifnull        365
     333: aload         12
     335: invokeinterface #106,  1          // InterfaceMethod java/util/List.isEmpty:()Z
     340: ifne          365
     343: aload         9
     345: aload         12
     347: iconst_0
     348: invokeinterface #32,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     353: checkcast     #133                // class org/apache/wss4j/common/ext/Attachment
     356: invokevirtual #134                // Method org/apache/wss4j/common/ext/Attachment.getId:()Ljava/lang/String;
     359: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     362: ifne          387
     365: new           #74                 // class org/apache/wss4j/common/ext/WSSecurityException
     368: dup
     369: getstatic     #90                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     372: ldc           #122                // String empty
     374: iconst_1
     375: anewarray     #41                 // class java/lang/Object
     378: dup
     379: iconst_0
     380: ldc           #135                // String Attachment not found
     382: aastore
     383: invokespecial #124                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     386: athrow
     387: aload         12
     389: iconst_0
     390: invokeinterface #32,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     395: checkcast     #133                // class org/apache/wss4j/common/ext/Attachment
     398: astore        13
     400: aload         5
     402: invokevirtual #83                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getEncryptionMethod:()Lorg/apache/xml/security/binding/xmlenc/EncryptionMethodType;
     405: invokevirtual #84                 // Method org/apache/xml/security/binding/xmlenc/EncryptionMethodType.getAlgorithm:()Ljava/lang/String;
     408: astore        14
     410: aload         6
     412: aload         14
     414: getstatic     #136                // Field org/apache/xml/security/stax/ext/XMLSecurityConstants.Enc:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$AlgorithmUsage;
     417: aload         5
     419: invokevirtual #59                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getId:()Ljava/lang/String;
     422: invokeinterface #137,  4          // InterfaceMethod org/apache/xml/security/stax/securityToken/InboundSecurityToken.getSecretKey:(Ljava/lang/String;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$AlgorithmUsage;Ljava/lang/String;)Ljava/security/Key;
     427: astore        15
     429: aload         14
     431: aload         7
     433: aload         15
     435: aload         13
     437: invokevirtual #138                // Method org/apache/wss4j/common/ext/Attachment.getSourceStream:()Ljava/io/InputStream;
     440: invokestatic  #139                // Method org/apache/wss4j/common/util/AttachmentUtils.setupAttachmentDecryptionStream:(Ljava/lang/String;Ljavax/crypto/Cipher;Ljava/security/Key;Ljava/io/InputStream;)Ljava/io/InputStream;
     443: astore        16
     445: new           #133                // class org/apache/wss4j/common/ext/Attachment
     448: dup
     449: invokespecial #140                // Method org/apache/wss4j/common/ext/Attachment."<init>":()V
     452: astore        17
     454: aload         17
     456: aload         13
     458: invokevirtual #134                // Method org/apache/wss4j/common/ext/Attachment.getId:()Ljava/lang/String;
     461: invokevirtual #141                // Method org/apache/wss4j/common/ext/Attachment.setId:(Ljava/lang/String;)V
     464: aload         17
     466: aload         5
     468: invokevirtual #142                // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getMimeType:()Ljava/lang/String;
     471: invokevirtual #143                // Method org/apache/wss4j/common/ext/Attachment.setMimeType:(Ljava/lang/String;)V
     474: aload         17
     476: aload         16
     478: invokevirtual #144                // Method org/apache/wss4j/common/ext/Attachment.setSourceStream:(Ljava/io/InputStream;)V
     481: aload         17
     483: aload         13
     485: invokevirtual #145                // Method org/apache/wss4j/common/ext/Attachment.getHeaders:()Ljava/util/Map;
     488: invokevirtual #146                // Method org/apache/wss4j/common/ext/Attachment.addHeaders:(Ljava/util/Map;)V
     491: ldc           #71                 // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete
     493: aload         5
     495: invokevirtual #68                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getType:()Ljava/lang/String;
     498: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     501: ifeq          532
     504: aload         17
     506: invokevirtual #145                // Method org/apache/wss4j/common/ext/Attachment.getHeaders:()Ljava/util/Map;
     509: aload         16
     511: invokestatic  #147                // Method org/apache/wss4j/common/util/AttachmentUtils.readAndReplaceEncryptedAttachmentHeaders:(Ljava/util/Map;Ljava/io/InputStream;)V
     514: goto          532
     517: astore        18
     519: new           #74                 // class org/apache/wss4j/common/ext/WSSecurityException
     522: dup
     523: getstatic     #90                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     526: aload         18
     528: invokespecial #131                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     531: athrow
     532: new           #149                // class org/apache/wss4j/common/ext/AttachmentResultCallback
     535: dup
     536: invokespecial #150                // Method org/apache/wss4j/common/ext/AttachmentResultCallback."<init>":()V
     539: astore        18
     541: aload         18
     543: aload         17
     545: invokevirtual #151                // Method org/apache/wss4j/common/ext/AttachmentResultCallback.setAttachment:(Lorg/apache/wss4j/common/ext/Attachment;)V
     548: aload         18
     550: aload         17
     552: invokevirtual #134                // Method org/apache/wss4j/common/ext/Attachment.getId:()Ljava/lang/String;
     555: invokevirtual #152                // Method org/apache/wss4j/common/ext/AttachmentResultCallback.setAttachmentId:(Ljava/lang/String;)V
     558: aload         10
     560: iconst_1
     561: anewarray     #128                // class javax/security/auth/callback/Callback
     564: dup
     565: iconst_0
     566: aload         18
     568: aastore
     569: invokeinterface #129,  2          // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     574: goto          592
     577: astore        19
     579: new           #74                 // class org/apache/wss4j/common/ext/WSSecurityException
     582: dup
     583: getstatic     #90                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     586: aload         19
     588: invokespecial #131                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     591: athrow
     592: aload_1
     593: invokeinterface #51,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InputProcessorChain.getDocumentContext:()Lorg/apache/xml/security/stax/ext/DocumentContext;
     598: astore        19
     600: new           #54                 // class org/apache/wss4j/stax/securityEvent/EncryptedPartSecurityEvent
     603: dup
     604: aload         6
     606: iconst_1
     607: aload         19
     609: invokeinterface #55,  1           // InterfaceMethod org/apache/xml/security/stax/ext/DocumentContext.getProtectionOrder:()Ljava/util/List;
     614: invokespecial #56                 // Method org/apache/wss4j/stax/securityEvent/EncryptedPartSecurityEvent."<init>":(Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;ZLjava/util/List;)V
     617: astore        20
     619: aload         20
     621: iconst_1
     622: invokevirtual #153                // Method org/apache/wss4j/stax/securityEvent/EncryptedPartSecurityEvent.setAttachment:(Z)V
     625: aload         20
     627: aload         5
     629: invokevirtual #59                 // Method org/apache/xml/security/binding/xmlenc/EncryptedDataType.getId:()Ljava/lang/String;
     632: invokevirtual #60                 // Method org/apache/wss4j/stax/securityEvent/EncryptedPartSecurityEvent.setCorrelationID:(Ljava/lang/String;)V
     635: aload_1
     636: invokeinterface #61,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InputProcessorChain.getSecurityContext:()Lorg/apache/xml/security/stax/ext/InboundSecurityContext;
     641: aload         20
     643: invokeinterface #62,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.registerSecurityEvent:(Lorg/apache/xml/security/stax/securityEvent/SecurityEvent;)V
     648: iinc          3, 1
     651: goto          162
     654: return
    Exception table:
       from    to  target type
         287   303   306   Class java/lang/Exception
         504   514   517   Class java/io/IOException
         558   574   577   Class java/lang/Exception

  static {};
    Code:
       0: ldc_w         #154                // class org/apache/wss4j/stax/impl/processor/input/DecryptInputProcessor
       3: invokestatic  #155                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #87                 // Field log:Lorg/slf4j/Logger;
       9: ldc           #156                // String MaximumAllowedDecompressedBytes
      11: invokestatic  #157                // Method org/apache/xml/security/stax/config/ConfigurationProperties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      14: invokestatic  #158                // Method java/lang/Long.valueOf:(Ljava/lang/String;)Ljava/lang/Long;
      17: putstatic     #43                 // Field maximumAllowedDecompressedBytes:Ljava/lang/Long;
      20: return
}
