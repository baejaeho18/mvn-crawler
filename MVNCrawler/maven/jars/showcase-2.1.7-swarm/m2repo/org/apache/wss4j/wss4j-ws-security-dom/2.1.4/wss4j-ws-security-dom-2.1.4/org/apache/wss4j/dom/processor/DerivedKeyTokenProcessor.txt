Compiled from "DerivedKeyTokenProcessor.java"
public class org.apache.wss4j.dom.processor.DerivedKeyTokenProcessor implements org.apache.wss4j.dom.processor.Processor {
  public org.apache.wss4j.dom.processor.DerivedKeyTokenProcessor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult> handleToken(org.w3c.dom.Element, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #2                  // class org/apache/wss4j/dom/message/token/DerivedKeyToken
       3: dup
       4: aload_1
       5: aload_2
       6: invokevirtual #3                  // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
       9: invokespecial #4                  // Method org/apache/wss4j/dom/message/token/DerivedKeyToken."<init>":(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      12: astore        4
      14: aload_2
      15: invokevirtual #5                  // Method org/apache/wss4j/dom/handler/RequestData.getAlgorithmSuite:()Lorg/apache/wss4j/common/crypto/AlgorithmSuite;
      18: astore        5
      20: aload         5
      22: ifnull        46
      25: new           #6                  // class org/apache/wss4j/common/crypto/AlgorithmSuiteValidator
      28: dup
      29: aload         5
      31: invokespecial #7                  // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator."<init>":(Lorg/apache/wss4j/common/crypto/AlgorithmSuite;)V
      34: astore        6
      36: aload         6
      38: aload         4
      40: invokevirtual #8                  // Method org/apache/wss4j/dom/message/token/DerivedKeyToken.getAlgorithm:()Ljava/lang/String;
      43: invokevirtual #9                  // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkDerivedKeyAlgorithm:(Ljava/lang/String;)V
      46: aconst_null
      47: astore        6
      49: aload         4
      51: invokevirtual #10                 // Method org/apache/wss4j/dom/message/token/DerivedKeyToken.getSecurityTokenReferenceElement:()Lorg/w3c/dom/Element;
      54: astore        7
      56: aload         7
      58: ifnull        119
      61: new           #11                 // class org/apache/wss4j/dom/str/STRParserParameters
      64: dup
      65: invokespecial #12                 // Method org/apache/wss4j/dom/str/STRParserParameters."<init>":()V
      68: astore        8
      70: aload         8
      72: aload_2
      73: invokevirtual #13                 // Method org/apache/wss4j/dom/str/STRParserParameters.setData:(Lorg/apache/wss4j/dom/handler/RequestData;)V
      76: aload         8
      78: aload_3
      79: invokevirtual #14                 // Method org/apache/wss4j/dom/str/STRParserParameters.setWsDocInfo:(Lorg/apache/wss4j/dom/WSDocInfo;)V
      82: aload         8
      84: aload         7
      86: invokevirtual #15                 // Method org/apache/wss4j/dom/str/STRParserParameters.setStrElement:(Lorg/w3c/dom/Element;)V
      89: new           #16                 // class org/apache/wss4j/dom/str/DerivedKeyTokenSTRParser
      92: dup
      93: invokespecial #17                 // Method org/apache/wss4j/dom/str/DerivedKeyTokenSTRParser."<init>":()V
      96: astore        9
      98: aload         9
     100: aload         8
     102: invokeinterface #18,  2           // InterfaceMethod org/apache/wss4j/dom/str/STRParser.parseSecurityTokenReference:(Lorg/apache/wss4j/dom/str/STRParserParameters;)Lorg/apache/wss4j/dom/str/STRParserResult;
     107: astore        10
     109: aload         10
     111: invokevirtual #19                 // Method org/apache/wss4j/dom/str/STRParserResult.getSecretKey:()[B
     114: astore        6
     116: goto          132
     119: new           #20                 // class org/apache/wss4j/common/ext/WSSecurityException
     122: dup
     123: getstatic     #21                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     126: ldc           #22                 // String noReference
     128: invokespecial #23                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     131: athrow
     132: aload         4
     134: invokevirtual #24                 // Method org/apache/wss4j/dom/message/token/DerivedKeyToken.getNonce:()Ljava/lang/String;
     137: astore        8
     139: aload         8
     141: ifnonnull     166
     144: new           #20                 // class org/apache/wss4j/common/ext/WSSecurityException
     147: dup
     148: getstatic     #25                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     151: ldc           #26                 // String empty
     153: iconst_1
     154: anewarray     #27                 // class java/lang/Object
     157: dup
     158: iconst_0
     159: ldc           #28                 // String Missing wsc:Nonce value
     161: aastore
     162: invokespecial #29                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     165: athrow
     166: aload         4
     168: invokevirtual #30                 // Method org/apache/wss4j/dom/message/token/DerivedKeyToken.getLength:()I
     171: istore        9
     173: aload         4
     175: iload         9
     177: aload         6
     179: invokevirtual #31                 // Method org/apache/wss4j/dom/message/token/DerivedKeyToken.deriveKey:(I[B)[B
     182: astore        10
     184: new           #32                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     187: dup
     188: sipush        2048
     191: aconst_null
     192: aload         10
     194: aconst_null
     195: invokespecial #33                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult."<init>":(I[B[BLjava/util/List;)V
     198: astore        11
     200: aload_3
     201: aload_1
     202: invokevirtual #34                 // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;)V
     205: aload         4
     207: invokevirtual #35                 // Method org/apache/wss4j/dom/message/token/DerivedKeyToken.getID:()Ljava/lang/String;
     210: astore        12
     212: ldc           #36                 // String
     214: aload         12
     216: invokevirtual #37                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     219: ifne          232
     222: aload         11
     224: ldc           #38                 // String id
     226: aload         12
     228: invokevirtual #39                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     231: pop
     232: aload         11
     234: ldc           #40                 // String derived-key-token
     236: aload         4
     238: invokevirtual #39                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     241: pop
     242: aload         11
     244: ldc           #41                 // String secret
     246: aload         6
     248: invokevirtual #39                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     251: pop
     252: aload         11
     254: ldc           #42                 // String token-element
     256: aload         4
     258: invokevirtual #43                 // Method org/apache/wss4j/dom/message/token/DerivedKeyToken.getElement:()Lorg/w3c/dom/Element;
     261: invokevirtual #39                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     264: pop
     265: aload_3
     266: aload         11
     268: invokevirtual #44                 // Method org/apache/wss4j/dom/WSDocInfo.addResult:(Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;)V
     271: aload         11
     273: invokestatic  #45                 // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
     276: areturn
}
