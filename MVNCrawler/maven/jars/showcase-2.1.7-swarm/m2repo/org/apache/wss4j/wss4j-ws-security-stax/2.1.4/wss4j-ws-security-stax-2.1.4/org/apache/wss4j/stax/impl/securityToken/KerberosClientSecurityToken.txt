Compiled from "KerberosClientSecurityToken.java"
public class org.apache.wss4j.stax.impl.securityToken.KerberosClientSecurityToken extends org.apache.xml.security.stax.impl.securityToken.GenericOutboundSecurityToken {
  private javax.security.auth.callback.CallbackHandler callbackHandler;

  private java.security.Key secretKey;

  private byte[] ticket;

  public org.apache.wss4j.stax.impl.securityToken.KerberosClientSecurityToken(byte[], java.security.Key, java.lang.String);
    Code:
       0: aload_0
       1: aload_3
       2: getstatic     #1                  // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KerberosToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
       5: invokespecial #2                  // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken."<init>":(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;)V
       8: aload_0
       9: aload_1
      10: putfield      #3                  // Field ticket:[B
      13: aload_0
      14: aload_2
      15: putfield      #4                  // Field secretKey:Ljava/security/Key;
      18: return

  public org.apache.wss4j.stax.impl.securityToken.KerberosClientSecurityToken(javax.security.auth.callback.CallbackHandler, java.lang.String);
    Code:
       0: aload_0
       1: aload_2
       2: getstatic     #1                  // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KerberosToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
       5: invokespecial #2                  // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken."<init>":(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;)V
       8: aload_0
       9: aload_1
      10: putfield      #5                  // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      13: return

  private void getTGT() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #6                  // class org/apache/wss4j/common/kerberos/KerberosContextAndServiceNameCallback
       3: dup
       4: invokespecial #7                  // Method org/apache/wss4j/common/kerberos/KerberosContextAndServiceNameCallback."<init>":()V
       7: astore_1
       8: aload_0
       9: getfield      #5                  // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      12: iconst_1
      13: anewarray     #8                  // class javax/security/auth/callback/Callback
      16: dup
      17: iconst_0
      18: aload_1
      19: aastore
      20: invokeinterface #9,  2            // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      25: aload_1
      26: invokevirtual #10                 // Method org/apache/wss4j/common/kerberos/KerberosContextAndServiceNameCallback.getContextName:()Ljava/lang/String;
      29: ifnonnull     45
      32: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
      35: dup
      36: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      39: ldc           #13                 // String kerberosCallbackContextNameNotSupplied
      41: invokespecial #14                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      44: athrow
      45: aload_1
      46: invokevirtual #15                 // Method org/apache/wss4j/common/kerberos/KerberosContextAndServiceNameCallback.getServiceName:()Ljava/lang/String;
      49: ifnonnull     65
      52: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
      55: dup
      56: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      59: ldc           #16                 // String kerberosCallbackServiceNameNotSupplied
      61: invokespecial #14                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      64: athrow
      65: new           #17                 // class javax/security/auth/login/LoginContext
      68: dup
      69: aload_1
      70: invokevirtual #10                 // Method org/apache/wss4j/common/kerberos/KerberosContextAndServiceNameCallback.getContextName:()Ljava/lang/String;
      73: aload_0
      74: getfield      #5                  // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      77: invokespecial #18                 // Method javax/security/auth/login/LoginContext."<init>":(Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)V
      80: astore_2
      81: aload_2
      82: invokevirtual #19                 // Method javax/security/auth/login/LoginContext.login:()V
      85: aload_2
      86: invokevirtual #20                 // Method javax/security/auth/login/LoginContext.getSubject:()Ljavax/security/auth/Subject;
      89: astore_3
      90: aload_3
      91: invokevirtual #21                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      94: astore        4
      96: aload         4
      98: invokeinterface #22,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
     103: ifeq          128
     106: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
     109: dup
     110: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     113: ldc           #23                 // String kerberosLoginError
     115: iconst_1
     116: anewarray     #24                 // class java/lang/Object
     119: dup
     120: iconst_0
     121: ldc           #25                 // String No Client principals found after login
     123: aastore
     124: invokespecial #26                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     127: athrow
     128: aload_0
     129: aload_3
     130: aconst_null
     131: invokespecial #27                 // Method getKerberosTicket:(Ljavax/security/auth/Subject;Ljavax/security/auth/kerberos/KerberosTicket;)Ljavax/security/auth/kerberos/KerberosTicket;
     134: astore        5
     136: new           #28                 // class org/apache/wss4j/common/kerberos/KerberosClientExceptionAction
     139: dup
     140: aload         4
     142: invokeinterface #29,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     147: invokeinterface #30,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     152: checkcast     #31                 // class java/security/Principal
     155: aload_1
     156: invokevirtual #15                 // Method org/apache/wss4j/common/kerberos/KerberosContextAndServiceNameCallback.getServiceName:()Ljava/lang/String;
     159: aload_1
     160: invokevirtual #32                 // Method org/apache/wss4j/common/kerberos/KerberosContextAndServiceNameCallback.isUsernameServiceNameForm:()Z
     163: aload_1
     164: invokevirtual #33                 // Method org/apache/wss4j/common/kerberos/KerberosContextAndServiceNameCallback.isRequestCredDeleg:()Z
     167: invokespecial #34                 // Method org/apache/wss4j/common/kerberos/KerberosClientExceptionAction."<init>":(Ljava/security/Principal;Ljava/lang/String;ZZ)V
     170: astore        6
     172: aconst_null
     173: astore        7
     175: aload_3
     176: aload         6
     178: invokestatic  #35                 // Method javax/security/auth/Subject.doAs:(Ljavax/security/auth/Subject;Ljava/security/PrivilegedExceptionAction;)Ljava/lang/Object;
     181: checkcast     #36                 // class org/apache/wss4j/common/kerberos/KerberosContext
     184: astore        7
     186: aload         7
     188: invokevirtual #37                 // Method org/apache/wss4j/common/kerberos/KerberosContext.getSecretKey:()Ljava/security/Key;
     191: astore        8
     193: aload         8
     195: ifnull        226
     198: aload_0
     199: new           #38                 // class javax/crypto/spec/SecretKeySpec
     202: dup
     203: aload         8
     205: invokeinterface #39,  1           // InterfaceMethod java/security/Key.getEncoded:()[B
     210: aload         8
     212: invokeinterface #40,  1           // InterfaceMethod java/security/Key.getAlgorithm:()Ljava/lang/String;
     217: invokespecial #41                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
     220: putfield      #4                  // Field secretKey:Ljava/security/Key;
     223: goto          244
     226: aload_0
     227: aload_3
     228: aload         5
     230: invokespecial #27                 // Method getKerberosTicket:(Ljavax/security/auth/Subject;Ljavax/security/auth/kerberos/KerberosTicket;)Ljavax/security/auth/kerberos/KerberosTicket;
     233: astore        9
     235: aload_0
     236: aload         9
     238: invokevirtual #42                 // Method javax/security/auth/kerberos/KerberosTicket.getSessionKey:()Ljavax/crypto/SecretKey;
     241: putfield      #4                  // Field secretKey:Ljava/security/Key;
     244: aload_0
     245: aload         7
     247: invokevirtual #43                 // Method org/apache/wss4j/common/kerberos/KerberosContext.getKerberosToken:()[B
     250: putfield      #3                  // Field ticket:[B
     253: goto          301
     256: astore        8
     258: aload         8
     260: invokevirtual #45                 // Method java/security/PrivilegedActionException.getCause:()Ljava/lang/Throwable;
     263: astore        9
     265: aload         9
     267: instanceof    #11                 // class org/apache/wss4j/common/ext/WSSecurityException
     270: ifeq          279
     273: aload         9
     275: checkcast     #11                 // class org/apache/wss4j/common/ext/WSSecurityException
     278: athrow
     279: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
     282: dup
     283: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     286: new           #46                 // class java/lang/Exception
     289: dup
     290: aload         9
     292: invokespecial #47                 // Method java/lang/Exception."<init>":(Ljava/lang/Throwable;)V
     295: ldc           #48                 // String kerberosServiceTicketError
     297: invokespecial #49                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     300: athrow
     301: goto          317
     304: astore_1
     305: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
     308: dup
     309: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     312: aload_1
     313: invokespecial #53                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     316: athrow
     317: return
    Exception table:
       from    to  target type
         175   253   256   Class java/security/PrivilegedActionException
           0   301   304   Class javax/security/auth/login/LoginException
           0   301   304   Class javax/security/auth/callback/UnsupportedCallbackException
           0   301   304   Class java/io/IOException

  private javax.security.auth.kerberos.KerberosTicket getKerberosTicket(javax.security.auth.Subject, javax.security.auth.kerberos.KerberosTicket);
    Code:
       0: aload_1
       1: ldc_w         #54                 // class javax/security/auth/kerberos/KerberosTicket
       4: invokevirtual #55                 // Method javax/security/auth/Subject.getPrivateCredentials:(Ljava/lang/Class;)Ljava/util/Set;
       7: astore_3
       8: aload_3
       9: ifnull        21
      12: aload_3
      13: invokeinterface #22,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
      18: ifeq          23
      21: aconst_null
      22: areturn
      23: aload_3
      24: invokeinterface #56,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      29: astore        4
      31: aload         4
      33: invokeinterface #57,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      38: ifeq          68
      41: aload         4
      43: invokeinterface #30,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      48: checkcast     #54                 // class javax/security/auth/kerberos/KerberosTicket
      51: astore        5
      53: aload         5
      55: aload_2
      56: invokevirtual #58                 // Method javax/security/auth/kerberos/KerberosTicket.equals:(Ljava/lang/Object;)Z
      59: ifne          65
      62: aload         5
      64: areturn
      65: goto          31
      68: aconst_null
      69: areturn

  public java.security.Key getSecretKey(java.lang.String) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #59                 // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.getSecretKey:(Ljava/lang/String;)Ljava/security/Key;
       5: astore_2
       6: aload_2
       7: ifnull        12
      10: aload_2
      11: areturn
      12: aload_0
      13: getfield      #4                  // Field secretKey:Ljava/security/Key;
      16: ifnonnull     23
      19: aload_0
      20: invokespecial #60                 // Method getTGT:()V
      23: aload_0
      24: getfield      #4                  // Field secretKey:Ljava/security/Key;
      27: invokeinterface #39,  1           // InterfaceMethod java/security/Key.getEncoded:()[B
      32: astore_3
      33: aload_1
      34: aload_3
      35: invokestatic  #61                 // Method org/apache/wss4j/common/util/KeyUtils.prepareSecretKey:(Ljava/lang/String;[B)Ljavax/crypto/SecretKey;
      38: astore_2
      39: aload_0
      40: aload_1
      41: aload_2
      42: invokevirtual #62                 // Method setSecretKey:(Ljava/lang/String;Ljava/security/Key;)V
      45: aload_2
      46: areturn

  public byte[] getTicket() throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: getfield      #3                  // Field ticket:[B
       4: ifnonnull     11
       7: aload_0
       8: invokespecial #60                 // Method getTGT:()V
      11: aload_0
      12: getfield      #3                  // Field ticket:[B
      15: areturn
}
