Compiled from "WSSecSignature.java"
public class org.apache.wss4j.dom.message.WSSecSignature extends org.apache.wss4j.dom.message.WSSecSignatureBase {
  private static final org.slf4j.Logger LOG;

  protected javax.xml.crypto.dsig.XMLSignatureFactory signatureFactory;

  protected javax.xml.crypto.dsig.keyinfo.KeyInfo keyInfo;

  protected javax.xml.crypto.dsig.CanonicalizationMethod c14nMethod;

  protected javax.xml.crypto.dsig.XMLSignature sig;

  protected byte[] secretKey;

  protected org.w3c.dom.Document document;

  protected org.apache.wss4j.dom.WSDocInfo wsDocInfo;

  protected java.lang.String strUri;

  protected org.w3c.dom.Element bstToken;

  protected java.lang.String keyInfoUri;

  protected java.lang.String certUri;

  protected byte[] signatureValue;

  private boolean useSingleCert;

  private java.lang.String sigAlgo;

  private java.lang.String canonAlgo;

  private org.apache.wss4j.common.token.SecurityTokenReference secRef;

  private java.lang.String customTokenValueType;

  private java.lang.String customTokenId;

  private java.lang.String encrKeySha1value;

  private org.apache.wss4j.common.crypto.Crypto crypto;

  private java.lang.String digestAlgo;

  private java.security.cert.X509Certificate useThisCert;

  private org.w3c.dom.Element securityHeader;

  private boolean useCustomSecRef;

  private boolean bstAddedToSecurityHeader;

  private boolean includeSignatureToken;

  private boolean addInclusivePrefixes;

  public org.apache.wss4j.dom.message.WSSecSignature();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/wss4j/dom/message/WSSecSignatureBase."<init>":()V
       4: aload_0
       5: iconst_1
       6: putfield      #2                  // Field useSingleCert:Z
       9: aload_0
      10: ldc           #3                  // String http://www.w3.org/2001/10/xml-exc-c14n#
      12: putfield      #4                  // Field canonAlgo:Ljava/lang/String;
      15: aload_0
      16: ldc           #5                  // String http://www.w3.org/2000/09/xmldsig#sha1
      18: putfield      #6                  // Field digestAlgo:Ljava/lang/String;
      21: aload_0
      22: iconst_1
      23: putfield      #7                  // Field addInclusivePrefixes:Z
      26: aload_0
      27: invokespecial #8                  // Method init:()V
      30: return

  private void init();
    Code:
       0: aload_0
       1: ldc           #9                  // String DOM
       3: ldc           #10                 // String ApacheXMLDSig
       5: invokestatic  #11                 // Method javax/xml/crypto/dsig/XMLSignatureFactory.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljavax/xml/crypto/dsig/XMLSignatureFactory;
       8: putfield      #12                 // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      11: goto          24
      14: astore_1
      15: aload_0
      16: ldc           #9                  // String DOM
      18: invokestatic  #14                 // Method javax/xml/crypto/dsig/XMLSignatureFactory.getInstance:(Ljava/lang/String;)Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      21: putfield      #12                 // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      24: return
    Exception table:
       from    to  target type
           0    11    14   Class java/security/NoSuchProviderException

  public void prepare(org.w3c.dom.Document, org.apache.wss4j.common.crypto.Crypto, org.apache.wss4j.dom.message.WSSecHeader) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_2
       2: putfield      #15                 // Field crypto:Lorg/apache/wss4j/common/crypto/Crypto;
       5: aload_0
       6: aload_1
       7: putfield      #16                 // Field document:Lorg/w3c/dom/Document;
      10: aload_0
      11: new           #17                 // class org/apache/wss4j/dom/WSDocInfo
      14: dup
      15: aload_1
      16: invokespecial #18                 // Method org/apache/wss4j/dom/WSDocInfo."<init>":(Lorg/w3c/dom/Document;)V
      19: putfield      #19                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
      22: aload_0
      23: getfield      #19                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
      26: aload_2
      27: invokevirtual #20                 // Method org/apache/wss4j/dom/WSDocInfo.setCrypto:(Lorg/apache/wss4j/common/crypto/Crypto;)V
      30: aload_0
      31: aload_3
      32: invokevirtual #21                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      35: putfield      #22                 // Field securityHeader:Lorg/w3c/dom/Element;
      38: aload_0
      39: invokespecial #23                 // Method getSigningCerts:()[Ljava/security/cert/X509Certificate;
      42: astore        4
      44: aconst_null
      45: astore        5
      47: aload_0
      48: getfield      #7                  // Field addInclusivePrefixes:Z
      51: ifeq          88
      54: aload_0
      55: getfield      #4                  // Field canonAlgo:Ljava/lang/String;
      58: ldc           #3                  // String http://www.w3.org/2001/10/xml-exc-c14n#
      60: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      63: ifeq          88
      66: aload_0
      67: aload_3
      68: invokevirtual #21                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      71: iconst_0
      72: invokevirtual #25                 // Method getInclusivePrefixes:(Lorg/w3c/dom/Element;Z)Ljava/util/List;
      75: astore        6
      77: new           #26                 // class javax/xml/crypto/dsig/spec/ExcC14NParameterSpec
      80: dup
      81: aload         6
      83: invokespecial #27                 // Method javax/xml/crypto/dsig/spec/ExcC14NParameterSpec."<init>":(Ljava/util/List;)V
      86: astore        5
      88: aload_0
      89: aload_0
      90: getfield      #12                 // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      93: aload_0
      94: getfield      #4                  // Field canonAlgo:Ljava/lang/String;
      97: aload         5
      99: invokevirtual #28                 // Method javax/xml/crypto/dsig/XMLSignatureFactory.newCanonicalizationMethod:(Ljava/lang/String;Ljavax/xml/crypto/dsig/spec/C14NMethodParameterSpec;)Ljavax/xml/crypto/dsig/CanonicalizationMethod;
     102: putfield      #29                 // Field c14nMethod:Ljavax/xml/crypto/dsig/CanonicalizationMethod;
     105: goto          137
     108: astore        5
     110: getstatic     #31                 // Field LOG:Lorg/slf4j/Logger;
     113: ldc           #32                 // String
     115: aload         5
     117: invokeinterface #33,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     122: new           #34                 // class org/apache/wss4j/common/ext/WSSecurityException
     125: dup
     126: getstatic     #35                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_SIGNATURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     129: aload         5
     131: ldc           #36                 // String noXMLSig
     133: invokespecial #37                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     136: athrow
     137: aload_0
     138: aload_0
     139: invokevirtual #38                 // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     142: ldc           #39                 // String KI-
     144: aload_0
     145: getfield      #40                 // Field keyInfo:Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
     148: invokeinterface #41,  3           // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createSecureId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     153: putfield      #42                 // Field keyInfoUri:Ljava/lang/String;
     156: aload_0
     157: getfield      #43                 // Field useCustomSecRef:Z
     160: ifne          1218
     163: aload_0
     164: new           #44                 // class org/apache/wss4j/common/token/SecurityTokenReference
     167: dup
     168: aload_1
     169: invokespecial #45                 // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     172: putfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     175: aload_0
     176: aload_0
     177: invokevirtual #38                 // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     180: ldc           #47                 // String STR-
     182: aload_0
     183: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     186: invokeinterface #41,  3           // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createSecureId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     191: putfield      #48                 // Field strUri:Ljava/lang/String;
     194: aload_0
     195: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     198: invokevirtual #49                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addWSSENamespace:()V
     201: aload_0
     202: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     205: invokevirtual #50                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addWSUNamespace:()V
     208: aload_0
     209: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     212: aload_0
     213: getfield      #48                 // Field strUri:Ljava/lang/String;
     216: invokevirtual #51                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setID:(Ljava/lang/String;)V
     219: aload_0
     220: getfield      #52                 // Field keyIdentifierType:I
     223: tableswitch   { // 1 to 13
                     1: 288
                     2: 379
                     3: 454
                     4: 468
                     5: 1205
                     6: 1205
                     7: 1205
                     8: 499
                     9: 580
                    10: 526
                    11: 764
                    12: 930
                    13: 1128
               default: 1205
          }
     288: new           #53                 // class org/apache/wss4j/common/token/Reference
     291: dup
     292: aload_0
     293: getfield      #16                 // Field document:Lorg/w3c/dom/Document;
     296: invokespecial #54                 // Method org/apache/wss4j/common/token/Reference."<init>":(Lorg/w3c/dom/Document;)V
     299: astore        5
     301: aload         5
     303: new           #55                 // class java/lang/StringBuilder
     306: dup
     307: invokespecial #56                 // Method java/lang/StringBuilder."<init>":()V
     310: ldc           #57                 // String #
     312: invokevirtual #58                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     315: aload_0
     316: getfield      #59                 // Field certUri:Ljava/lang/String;
     319: invokevirtual #58                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     322: invokevirtual #60                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     325: invokevirtual #61                 // Method org/apache/wss4j/common/token/Reference.setURI:(Ljava/lang/String;)V
     328: aload_0
     329: aload         4
     331: invokespecial #62                 // Method addBST:([Ljava/security/cert/X509Certificate;)V
     334: aload_0
     335: getfield      #2                  // Field useSingleCert:Z
     338: ifne          360
     341: aload_0
     342: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     345: ldc           #63                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1
     347: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     350: aload         5
     352: ldc           #63                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1
     354: invokevirtual #65                 // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     357: goto          367
     360: aload         5
     362: ldc           #66                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3
     364: invokevirtual #65                 // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     367: aload_0
     368: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     371: aload         5
     373: invokevirtual #67                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setReference:(Lorg/apache/wss4j/common/token/Reference;)V
     376: goto          1218
     379: aload         4
     381: iconst_0
     382: aaload
     383: invokevirtual #68                 // Method java/security/cert/X509Certificate.getIssuerX500Principal:()Ljavax/security/auth/x500/X500Principal;
     386: invokevirtual #69                 // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
     389: astore        6
     391: aload         4
     393: iconst_0
     394: aaload
     395: invokevirtual #70                 // Method java/security/cert/X509Certificate.getSerialNumber:()Ljava/math/BigInteger;
     398: astore        7
     400: new           #71                 // class org/apache/wss4j/common/token/DOMX509IssuerSerial
     403: dup
     404: aload_1
     405: aload         6
     407: aload         7
     409: invokespecial #72                 // Method org/apache/wss4j/common/token/DOMX509IssuerSerial."<init>":(Lorg/w3c/dom/Document;Ljava/lang/String;Ljava/math/BigInteger;)V
     412: astore        8
     414: new           #73                 // class org/apache/wss4j/common/token/DOMX509Data
     417: dup
     418: aload_1
     419: aload         8
     421: invokespecial #74                 // Method org/apache/wss4j/common/token/DOMX509Data."<init>":(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/token/DOMX509IssuerSerial;)V
     424: astore        9
     426: aload_0
     427: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     430: aload         9
     432: invokevirtual #75                 // Method org/apache/wss4j/common/token/DOMX509Data.getElement:()Lorg/w3c/dom/Element;
     435: invokevirtual #76                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setUnknownElement:(Lorg/w3c/dom/Element;)V
     438: aload_0
     439: getfield      #77                 // Field includeSignatureToken:Z
     442: ifeq          1218
     445: aload_0
     446: aload         4
     448: invokespecial #62                 // Method addBST:([Ljava/security/cert/X509Certificate;)V
     451: goto          1218
     454: aload_0
     455: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     458: aload         4
     460: iconst_0
     461: aaload
     462: invokevirtual #78                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/security/cert/X509Certificate;)V
     465: goto          1218
     468: aload_0
     469: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     472: aload         4
     474: iconst_0
     475: aaload
     476: aload_0
     477: getfield      #15                 // Field crypto:Lorg/apache/wss4j/common/crypto/Crypto;
     480: invokevirtual #79                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierSKI:(Ljava/security/cert/X509Certificate;Lorg/apache/wss4j/common/crypto/Crypto;)V
     483: aload_0
     484: getfield      #77                 // Field includeSignatureToken:Z
     487: ifeq          1218
     490: aload_0
     491: aload         4
     493: invokespecial #62                 // Method addBST:([Ljava/security/cert/X509Certificate;)V
     496: goto          1218
     499: aload_0
     500: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     503: aload         4
     505: iconst_0
     506: aaload
     507: invokevirtual #80                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierThumb:(Ljava/security/cert/X509Certificate;)V
     510: aload_0
     511: getfield      #77                 // Field includeSignatureToken:Z
     514: ifeq          1218
     517: aload_0
     518: aload         4
     520: invokespecial #62                 // Method addBST:([Ljava/security/cert/X509Certificate;)V
     523: goto          1218
     526: aload_0
     527: getfield      #81                 // Field encrKeySha1value:Ljava/lang/String;
     530: ifnull        547
     533: aload_0
     534: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     537: aload_0
     538: getfield      #81                 // Field encrKeySha1value:Ljava/lang/String;
     541: invokevirtual #82                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierEncKeySHA1:(Ljava/lang/String;)V
     544: goto          568
     547: aload_0
     548: getfield      #83                 // Field secretKey:[B
     551: invokestatic  #84                 // Method org/apache/wss4j/common/util/KeyUtils.generateDigest:([B)[B
     554: astore        10
     556: aload_0
     557: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     560: aload         10
     562: invokestatic  #85                 // Method org/apache/xml/security/utils/Base64.encode:([B)Ljava/lang/String;
     565: invokevirtual #82                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierEncKeySHA1:(Ljava/lang/String;)V
     568: aload_0
     569: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     572: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     574: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     577: goto          1218
     580: new           #53                 // class org/apache/wss4j/common/token/Reference
     583: dup
     584: aload_0
     585: getfield      #16                 // Field document:Lorg/w3c/dom/Document;
     588: invokespecial #54                 // Method org/apache/wss4j/common/token/Reference."<init>":(Lorg/w3c/dom/Document;)V
     591: astore        10
     593: ldc           #87                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     595: aload_0
     596: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     599: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     602: ifeq          626
     605: aload_0
     606: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     609: ldc           #89                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     611: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     614: aload         10
     616: aload_0
     617: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     620: invokevirtual #65                 // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     623: goto          725
     626: ldc           #90                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     628: aload_0
     629: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     632: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     635: ifeq          650
     638: aload_0
     639: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     642: ldc           #91                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     644: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     647: goto          725
     650: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     652: aload_0
     653: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     656: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     659: ifeq          683
     662: aload_0
     663: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     666: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     668: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     671: aload         10
     673: aload_0
     674: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     677: invokevirtual #65                 // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     680: goto          725
     683: aload_0
     684: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     687: invokestatic  #92                 // Method org/apache/wss4j/dom/message/token/KerberosSecurity.isKerberosToken:(Ljava/lang/String;)Z
     690: ifeq          716
     693: aload_0
     694: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     697: aload_0
     698: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     701: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     704: aload         10
     706: aload_0
     707: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     710: invokevirtual #65                 // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     713: goto          725
     716: aload         10
     718: aload_0
     719: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     722: invokevirtual #65                 // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     725: aload         10
     727: new           #55                 // class java/lang/StringBuilder
     730: dup
     731: invokespecial #56                 // Method java/lang/StringBuilder."<init>":()V
     734: ldc           #57                 // String #
     736: invokevirtual #58                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     739: aload_0
     740: getfield      #93                 // Field customTokenId:Ljava/lang/String;
     743: invokevirtual #58                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     746: invokevirtual #60                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     749: invokevirtual #61                 // Method org/apache/wss4j/common/token/Reference.setURI:(Ljava/lang/String;)V
     752: aload_0
     753: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     756: aload         10
     758: invokevirtual #67                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setReference:(Lorg/apache/wss4j/common/token/Reference;)V
     761: goto          1218
     764: new           #53                 // class org/apache/wss4j/common/token/Reference
     767: dup
     768: aload_0
     769: getfield      #16                 // Field document:Lorg/w3c/dom/Document;
     772: invokespecial #54                 // Method org/apache/wss4j/common/token/Reference."<init>":(Lorg/w3c/dom/Document;)V
     775: astore        11
     777: ldc           #87                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     779: aload_0
     780: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     783: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     786: ifeq          810
     789: aload_0
     790: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     793: ldc           #89                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     795: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     798: aload         11
     800: aload_0
     801: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     804: invokevirtual #65                 // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     807: goto          909
     810: ldc           #90                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     812: aload_0
     813: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     816: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     819: ifeq          834
     822: aload_0
     823: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     826: ldc           #91                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     828: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     831: goto          909
     834: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     836: aload_0
     837: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     840: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     843: ifeq          867
     846: aload_0
     847: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     850: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     852: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     855: aload         11
     857: aload_0
     858: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     861: invokevirtual #65                 // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     864: goto          909
     867: aload_0
     868: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     871: invokestatic  #92                 // Method org/apache/wss4j/dom/message/token/KerberosSecurity.isKerberosToken:(Ljava/lang/String;)Z
     874: ifeq          900
     877: aload_0
     878: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     881: aload_0
     882: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     885: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     888: aload         11
     890: aload_0
     891: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     894: invokevirtual #65                 // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     897: goto          909
     900: aload         11
     902: aload_0
     903: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     906: invokevirtual #65                 // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     909: aload         11
     911: aload_0
     912: getfield      #93                 // Field customTokenId:Ljava/lang/String;
     915: invokevirtual #61                 // Method org/apache/wss4j/common/token/Reference.setURI:(Ljava/lang/String;)V
     918: aload_0
     919: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     922: aload         11
     924: invokevirtual #67                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setReference:(Lorg/apache/wss4j/common/token/Reference;)V
     927: goto          1218
     930: ldc           #87                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     932: aload_0
     933: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     936: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     939: ifeq          969
     942: aload_0
     943: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     946: aload_0
     947: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     950: aload_0
     951: getfield      #93                 // Field customTokenId:Ljava/lang/String;
     954: invokevirtual #94                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/lang/String;Ljava/lang/String;)V
     957: aload_0
     958: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     961: ldc           #89                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     963: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     966: goto          1218
     969: ldc           #90                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     971: aload_0
     972: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     975: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     978: ifeq          1008
     981: aload_0
     982: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     985: aload_0
     986: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
     989: aload_0
     990: getfield      #93                 // Field customTokenId:Ljava/lang/String;
     993: invokevirtual #94                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/lang/String;Ljava/lang/String;)V
     996: aload_0
     997: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
    1000: ldc           #91                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    1002: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
    1005: goto          1218
    1008: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
    1010: aload_0
    1011: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
    1014: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1017: ifeq          1048
    1020: aload_0
    1021: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
    1024: aload_0
    1025: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
    1028: aload_0
    1029: getfield      #93                 // Field customTokenId:Ljava/lang/String;
    1032: iconst_1
    1033: invokevirtual #95                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/lang/String;Ljava/lang/String;Z)V
    1036: aload_0
    1037: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
    1040: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
    1042: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
    1045: goto          1218
    1048: ldc           #96                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKeySHA1
    1050: aload_0
    1051: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
    1054: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1057: ifeq          1088
    1060: aload_0
    1061: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
    1064: aload_0
    1065: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
    1068: aload_0
    1069: getfield      #93                 // Field customTokenId:Ljava/lang/String;
    1072: iconst_1
    1073: invokevirtual #95                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/lang/String;Ljava/lang/String;Z)V
    1076: aload_0
    1077: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
    1080: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
    1082: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
    1085: goto          1218
    1088: ldc           #97                 // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#Kerberosv5APREQSHA1
    1090: aload_0
    1091: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
    1094: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1097: ifeq          1218
    1100: aload_0
    1101: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
    1104: aload_0
    1105: getfield      #88                 // Field customTokenValueType:Ljava/lang/String;
    1108: aload_0
    1109: getfield      #93                 // Field customTokenId:Ljava/lang/String;
    1112: iconst_1
    1113: invokevirtual #95                 // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/lang/String;Ljava/lang/String;Z)V
    1116: aload_0
    1117: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
    1120: ldc           #98                 // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#GSS_Kerberosv5_AP_REQ
    1122: invokevirtual #64                 // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
    1125: goto          1218
    1128: aload         4
    1130: iconst_0
    1131: aaload
    1132: invokevirtual #99                 // Method java/security/cert/X509Certificate.getPublicKey:()Ljava/security/PublicKey;
    1135: astore        12
    1137: aload_0
    1138: getfield      #12                 // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
    1141: invokevirtual #100                // Method javax/xml/crypto/dsig/XMLSignatureFactory.getKeyInfoFactory:()Ljavax/xml/crypto/dsig/keyinfo/KeyInfoFactory;
    1144: astore        13
    1146: aload         13
    1148: aload         12
    1150: invokevirtual #101                // Method javax/xml/crypto/dsig/keyinfo/KeyInfoFactory.newKeyValue:(Ljava/security/PublicKey;)Ljavax/xml/crypto/dsig/keyinfo/KeyValue;
    1153: astore        14
    1155: aload_0
    1156: aload         13
    1158: aload         14
    1160: invokestatic  #102                // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
    1163: aload_0
    1164: getfield      #42                 // Field keyInfoUri:Ljava/lang/String;
    1167: invokevirtual #103                // Method javax/xml/crypto/dsig/keyinfo/KeyInfoFactory.newKeyInfo:(Ljava/util/List;Ljava/lang/String;)Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
    1170: putfield      #40                 // Field keyInfo:Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
    1173: goto          1218
    1176: astore        13
    1178: getstatic     #31                 // Field LOG:Lorg/slf4j/Logger;
    1181: ldc           #32                 // String
    1183: aload         13
    1185: invokeinterface #33,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
    1190: new           #34                 // class org/apache/wss4j/common/ext/WSSecurityException
    1193: dup
    1194: getstatic     #35                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_SIGNATURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
    1197: aload         13
    1199: ldc           #36                 // String noXMLSig
    1201: invokespecial #37                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
    1204: athrow
    1205: new           #34                 // class org/apache/wss4j/common/ext/WSSecurityException
    1208: dup
    1209: getstatic     #105                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
    1212: ldc           #106                // String unsupportedKeyId
    1214: invokespecial #107                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
    1217: athrow
    1218: aload_0
    1219: getfield      #52                 // Field keyIdentifierType:I
    1222: bipush        13
    1224: if_icmpeq     1285
    1227: new           #108                // class javax/xml/crypto/dom/DOMStructure
    1230: dup
    1231: aload_0
    1232: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
    1235: invokevirtual #109                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
    1238: invokespecial #110                // Method javax/xml/crypto/dom/DOMStructure."<init>":(Lorg/w3c/dom/Node;)V
    1241: astore        5
    1243: aload_0
    1244: getfield      #19                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
    1247: aload_0
    1248: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
    1251: invokevirtual #109                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
    1254: iconst_0
    1255: invokevirtual #111                // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;Z)V
    1258: aload_0
    1259: getfield      #12                 // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
    1262: invokevirtual #100                // Method javax/xml/crypto/dsig/XMLSignatureFactory.getKeyInfoFactory:()Ljavax/xml/crypto/dsig/keyinfo/KeyInfoFactory;
    1265: astore        6
    1267: aload_0
    1268: aload         6
    1270: aload         5
    1272: invokestatic  #102                // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
    1275: aload_0
    1276: getfield      #42                 // Field keyInfoUri:Ljava/lang/String;
    1279: invokevirtual #103                // Method javax/xml/crypto/dsig/keyinfo/KeyInfoFactory.newKeyInfo:(Ljava/util/List;Ljava/lang/String;)Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
    1282: putfield      #40                 // Field keyInfo:Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
    1285: return
    Exception table:
       from    to  target type
          44   105   108   Class java/lang/Exception
        1137  1173  1176   Class java/security/KeyException

  public org.w3c.dom.Document build(org.w3c.dom.Document, org.apache.wss4j.common.crypto.Crypto, org.apache.wss4j.dom.message.WSSecHeader) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getstatic     #31                 // Field LOG:Lorg/slf4j/Logger;
       4: invokeinterface #112,  1          // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
       9: putfield      #113                // Field doDebug:Z
      12: aload_0
      13: getfield      #113                // Field doDebug:Z
      16: ifeq          29
      19: getstatic     #31                 // Field LOG:Lorg/slf4j/Logger;
      22: ldc           #114                // String Beginning signing...
      24: invokeinterface #115,  2          // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      29: aload_0
      30: aload_1
      31: aload_2
      32: aload_3
      33: invokevirtual #116                // Method prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
      36: aload_0
      37: invokevirtual #117                // Method getParts:()Ljava/util/List;
      40: invokeinterface #118,  1          // InterfaceMethod java/util/List.isEmpty:()Z
      45: ifeq          68
      48: aload_0
      49: invokevirtual #117                // Method getParts:()Ljava/util/List;
      52: aload_0
      53: getfield      #16                 // Field document:Lorg/w3c/dom/Document;
      56: invokestatic  #119                // Method org/apache/wss4j/dom/util/WSSecurityUtil.getDefaultEncryptionPart:(Lorg/w3c/dom/Document;)Lorg/apache/wss4j/common/WSEncryptionPart;
      59: invokeinterface #120,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      64: pop
      65: goto          134
      68: aload_0
      69: invokevirtual #117                // Method getParts:()Ljava/util/List;
      72: invokeinterface #121,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      77: astore        4
      79: aload         4
      81: invokeinterface #122,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      86: ifeq          134
      89: aload         4
      91: invokeinterface #123,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      96: checkcast     #124                // class org/apache/wss4j/common/WSEncryptionPart
      99: astore        5
     101: aload         5
     103: invokevirtual #125                // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
     106: ifnonnull     131
     109: ldc           #126                // String STRTransform
     111: aload         5
     113: invokevirtual #127                // Method org/apache/wss4j/common/WSEncryptionPart.getName:()Ljava/lang/String;
     116: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     119: ifeq          131
     122: aload         5
     124: aload_0
     125: getfield      #48                 // Field strUri:Ljava/lang/String;
     128: invokevirtual #128                // Method org/apache/wss4j/common/WSEncryptionPart.setId:(Ljava/lang/String;)V
     131: goto          79
     134: aload_0
     135: aload_0
     136: invokevirtual #117                // Method getParts:()Ljava/util/List;
     139: aload_3
     140: invokevirtual #129                // Method addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     143: astore        4
     145: aload_0
     146: aload         4
     148: invokevirtual #130                // Method computeSignature:(Ljava/util/List;)V
     151: aload_0
     152: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
     155: ifnull        163
     158: aload_0
     159: aload_3
     160: invokevirtual #132                // Method prependBSTElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     163: aload_1
     164: areturn

  public java.util.List<javax.xml.crypto.dsig.Reference> addReferencesToSign(java.util.List<org.apache.wss4j.common.WSEncryptionPart>, org.apache.wss4j.dom.message.WSSecHeader) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_0
       2: getfield      #16                 // Field document:Lorg/w3c/dom/Document;
       5: aload_1
       6: aload_0
       7: getfield      #19                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
      10: aload_0
      11: getfield      #12                 // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      14: aload_2
      15: aload_0
      16: getfield      #7                  // Field addInclusivePrefixes:Z
      19: aload_0
      20: getfield      #6                  // Field digestAlgo:Ljava/lang/String;
      23: invokevirtual #133                // Method addReferencesToSign:(Lorg/w3c/dom/Document;Ljava/util/List;Lorg/apache/wss4j/dom/WSDocInfo;Ljavax/xml/crypto/dsig/XMLSignatureFactory;Lorg/apache/wss4j/dom/message/WSSecHeader;ZLjava/lang/String;)Ljava/util/List;
      26: areturn

  public org.w3c.dom.Element getSignatureElement();
    Code:
       0: aload_0
       1: getfield      #22                 // Field securityHeader:Lorg/w3c/dom/Element;
       4: ldc           #134                // String Signature
       6: ldc           #135                // String http://www.w3.org/2000/09/xmldsig#
       8: invokestatic  #136                // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      11: areturn

  private void addBST(java.security.cert.X509Certificate[]) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #137                // Field storeBytesInAttachment:Z
       4: ifeq          179
       7: aload_0
       8: aload_0
       9: getfield      #16                 // Field document:Lorg/w3c/dom/Document;
      12: ldc           #138                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
      14: ldc           #139                // String wsse:BinarySecurityToken
      16: invokeinterface #140,  3          // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      21: putfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
      24: aload_0
      25: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
      28: aconst_null
      29: ldc           #141                // String EncodingType
      31: ldc           #142                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary
      33: invokeinterface #143,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
      38: aload_0
      39: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
      42: ldc           #144                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      44: ldc           #145                // String wsu:Id
      46: aload_0
      47: getfield      #59                 // Field certUri:Ljava/lang/String;
      50: invokeinterface #143,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
      55: aconst_null
      56: astore_2
      57: aload_0
      58: getfield      #2                  // Field useSingleCert:Z
      61: ifne          92
      64: aload_0
      65: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
      68: aconst_null
      69: ldc           #146                // String ValueType
      71: ldc           #63                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1
      73: invokeinterface #143,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
      78: aload_0
      79: getfield      #15                 // Field crypto:Lorg/apache/wss4j/common/crypto/Crypto;
      82: aload_1
      83: invokeinterface #147,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getBytesFromCertificates:([Ljava/security/cert/X509Certificate;)[B
      88: astore_2
      89: goto          131
      92: aload_0
      93: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
      96: aconst_null
      97: ldc           #146                // String ValueType
      99: ldc           #66                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3
     101: invokeinterface #143,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     106: aload_1
     107: iconst_0
     108: aaload
     109: invokevirtual #148                // Method java/security/cert/X509Certificate.getEncoded:()[B
     112: astore_2
     113: goto          131
     116: astore_3
     117: new           #34                 // class org/apache/wss4j/common/ext/WSSecurityException
     120: dup
     121: getstatic     #150                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     124: aload_3
     125: ldc           #151                // String encodeError
     127: invokespecial #37                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     130: athrow
     131: aload_0
     132: invokevirtual #38                 // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     135: ldc           #32                 // String
     137: aload_0
     138: getfield      #16                 // Field document:Lorg/w3c/dom/Document;
     141: invokeinterface #152,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     146: astore_3
     147: aload_0
     148: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
     151: aload_0
     152: getfield      #16                 // Field document:Lorg/w3c/dom/Document;
     155: aload_3
     156: aload_2
     157: aload_0
     158: getfield      #153                // Field attachmentCallbackHandler:Ljavax/security/auth/callback/CallbackHandler;
     161: invokestatic  #154                // Method org/apache/wss4j/dom/util/WSSecurityUtil.storeBytesInAttachment:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Document;Ljava/lang/String;[BLjavax/security/auth/callback/CallbackHandler;)V
     164: aload_0
     165: getfield      #19                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     168: aload_0
     169: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
     172: iconst_0
     173: invokevirtual #111                // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;Z)V
     176: goto          265
     179: aconst_null
     180: astore_2
     181: aload_0
     182: getfield      #2                  // Field useSingleCert:Z
     185: ifne          215
     188: new           #155                // class org/apache/wss4j/common/token/PKIPathSecurity
     191: dup
     192: aload_0
     193: getfield      #16                 // Field document:Lorg/w3c/dom/Document;
     196: invokespecial #156                // Method org/apache/wss4j/common/token/PKIPathSecurity."<init>":(Lorg/w3c/dom/Document;)V
     199: astore_2
     200: aload_2
     201: checkcast     #155                // class org/apache/wss4j/common/token/PKIPathSecurity
     204: aload_1
     205: aload_0
     206: getfield      #15                 // Field crypto:Lorg/apache/wss4j/common/crypto/Crypto;
     209: invokevirtual #157                // Method org/apache/wss4j/common/token/PKIPathSecurity.setX509Certificates:([Ljava/security/cert/X509Certificate;Lorg/apache/wss4j/common/crypto/Crypto;)V
     212: goto          237
     215: new           #158                // class org/apache/wss4j/common/token/X509Security
     218: dup
     219: aload_0
     220: getfield      #16                 // Field document:Lorg/w3c/dom/Document;
     223: invokespecial #159                // Method org/apache/wss4j/common/token/X509Security."<init>":(Lorg/w3c/dom/Document;)V
     226: astore_2
     227: aload_2
     228: checkcast     #158                // class org/apache/wss4j/common/token/X509Security
     231: aload_1
     232: iconst_0
     233: aaload
     234: invokevirtual #160                // Method org/apache/wss4j/common/token/X509Security.setX509Certificate:(Ljava/security/cert/X509Certificate;)V
     237: aload_2
     238: aload_0
     239: getfield      #59                 // Field certUri:Ljava/lang/String;
     242: invokevirtual #161                // Method org/apache/wss4j/common/token/BinarySecurity.setID:(Ljava/lang/String;)V
     245: aload_0
     246: aload_2
     247: invokevirtual #162                // Method org/apache/wss4j/common/token/BinarySecurity.getElement:()Lorg/w3c/dom/Element;
     250: putfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
     253: aload_0
     254: getfield      #19                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     257: aload_0
     258: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
     261: iconst_0
     262: invokevirtual #111                // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;Z)V
     265: aload_0
     266: iconst_0
     267: putfield      #163                // Field bstAddedToSecurityHeader:Z
     270: return
    Exception table:
       from    to  target type
         106   113   116   Class java/security/cert/CertificateEncodingException

  public void prependBSTElementToHeader(org.apache.wss4j.dom.message.WSSecHeader);
    Code:
       0: aload_0
       1: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
       4: ifnull        31
       7: aload_0
       8: getfield      #163                // Field bstAddedToSecurityHeader:Z
      11: ifne          31
      14: aload_1
      15: invokevirtual #21                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      18: aload_0
      19: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
      22: invokestatic  #164                // Method org/apache/wss4j/dom/util/WSSecurityUtil.prependChildElement:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      25: pop
      26: aload_0
      27: iconst_1
      28: putfield      #163                // Field bstAddedToSecurityHeader:Z
      31: return

  public void appendBSTElementToHeader(org.apache.wss4j.dom.message.WSSecHeader);
    Code:
       0: aload_0
       1: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
       4: ifnull        35
       7: aload_0
       8: getfield      #163                // Field bstAddedToSecurityHeader:Z
      11: ifne          35
      14: aload_1
      15: invokevirtual #21                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      18: astore_2
      19: aload_2
      20: aload_0
      21: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
      24: invokeinterface #165,  2          // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      29: pop
      30: aload_0
      31: iconst_1
      32: putfield      #163                // Field bstAddedToSecurityHeader:Z
      35: return

  public void computeSignature(java.util.List<javax.xml.crypto.dsig.Reference>) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: iconst_1
       3: aconst_null
       4: invokevirtual #166                // Method computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
       7: return

  public void computeSignature(java.util.List<javax.xml.crypto.dsig.Reference>, boolean, org.w3c.dom.Element) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #83                 // Field secretKey:[B
       4: ifnonnull     29
       7: aload_0
       8: getfield      #15                 // Field crypto:Lorg/apache/wss4j/common/crypto/Crypto;
      11: aload_0
      12: getfield      #167                // Field user:Ljava/lang/String;
      15: aload_0
      16: getfield      #168                // Field password:Ljava/lang/String;
      19: invokeinterface #169,  3          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getPrivateKey:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/PrivateKey;
      24: astore        4
      26: goto          42
      29: aload_0
      30: getfield      #170                // Field sigAlgo:Ljava/lang/String;
      33: aload_0
      34: getfield      #83                 // Field secretKey:[B
      37: invokestatic  #171                // Method org/apache/wss4j/common/util/KeyUtils.prepareSecretKey:(Ljava/lang/String;[B)Ljavax/crypto/SecretKey;
      40: astore        4
      42: aload_0
      43: getfield      #12                 // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      46: aload_0
      47: getfield      #170                // Field sigAlgo:Ljava/lang/String;
      50: aconst_null
      51: invokevirtual #172                // Method javax/xml/crypto/dsig/XMLSignatureFactory.newSignatureMethod:(Ljava/lang/String;Ljavax/xml/crypto/dsig/spec/SignatureMethodParameterSpec;)Ljavax/xml/crypto/dsig/SignatureMethod;
      54: astore        5
      56: aload_0
      57: getfield      #12                 // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      60: aload_0
      61: getfield      #29                 // Field c14nMethod:Ljavax/xml/crypto/dsig/CanonicalizationMethod;
      64: aload         5
      66: aload_1
      67: invokevirtual #173                // Method javax/xml/crypto/dsig/XMLSignatureFactory.newSignedInfo:(Ljavax/xml/crypto/dsig/CanonicalizationMethod;Ljavax/xml/crypto/dsig/SignatureMethod;Ljava/util/List;)Ljavax/xml/crypto/dsig/SignedInfo;
      70: astore        6
      72: aload_0
      73: aload_0
      74: getfield      #12                 // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      77: aload         6
      79: aload_0
      80: getfield      #40                 // Field keyInfo:Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
      83: aconst_null
      84: aload_0
      85: invokevirtual #38                 // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      88: ldc           #174                // String SIG-
      90: aconst_null
      91: invokeinterface #152,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
      96: aconst_null
      97: invokevirtual #175                // Method javax/xml/crypto/dsig/XMLSignatureFactory.newXMLSignature:(Ljavax/xml/crypto/dsig/SignedInfo;Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;)Ljavax/xml/crypto/dsig/XMLSignature;
     100: putfield      #176                // Field sig:Ljavax/xml/crypto/dsig/XMLSignature;
     103: aconst_null
     104: astore        7
     106: iload_2
     107: ifeq          200
     110: aload_3
     111: ifnonnull     159
     114: aload_0
     115: getfield      #22                 // Field securityHeader:Lorg/w3c/dom/Element;
     118: invokeinterface #177,  1          // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
     123: astore        8
     125: aload         8
     127: ifnull        153
     130: aload         8
     132: invokeinterface #178,  1          // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
     137: iconst_1
     138: if_icmpeq     153
     141: aload         8
     143: invokeinterface #179,  1          // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
     148: astore        8
     150: goto          125
     153: aload         8
     155: checkcast     #180                // class org/w3c/dom/Element
     158: astore_3
     159: aload_3
     160: ifnonnull     181
     163: new           #181                // class javax/xml/crypto/dsig/dom/DOMSignContext
     166: dup
     167: aload         4
     169: aload_0
     170: getfield      #22                 // Field securityHeader:Lorg/w3c/dom/Element;
     173: invokespecial #182                // Method javax/xml/crypto/dsig/dom/DOMSignContext."<init>":(Ljava/security/Key;Lorg/w3c/dom/Node;)V
     176: astore        7
     178: goto          215
     181: new           #181                // class javax/xml/crypto/dsig/dom/DOMSignContext
     184: dup
     185: aload         4
     187: aload_0
     188: getfield      #22                 // Field securityHeader:Lorg/w3c/dom/Element;
     191: aload_3
     192: invokespecial #183                // Method javax/xml/crypto/dsig/dom/DOMSignContext."<init>":(Ljava/security/Key;Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)V
     195: astore        7
     197: goto          215
     200: new           #181                // class javax/xml/crypto/dsig/dom/DOMSignContext
     203: dup
     204: aload         4
     206: aload_0
     207: getfield      #22                 // Field securityHeader:Lorg/w3c/dom/Element;
     210: invokespecial #182                // Method javax/xml/crypto/dsig/dom/DOMSignContext."<init>":(Ljava/security/Key;Lorg/w3c/dom/Node;)V
     213: astore        7
     215: aload         7
     217: ldc           #135                // String http://www.w3.org/2000/09/xmldsig#
     219: ldc           #184                // String ds
     221: invokeinterface #185,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLSignContext.putNamespacePrefix:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     226: pop
     227: ldc           #3                  // String http://www.w3.org/2001/10/xml-exc-c14n#
     229: aload_0
     230: getfield      #4                  // Field canonAlgo:Ljava/lang/String;
     233: invokevirtual #24                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     236: ifeq          251
     239: aload         7
     241: ldc           #3                  // String http://www.w3.org/2001/10/xml-exc-c14n#
     243: ldc           #186                // String ec
     245: invokeinterface #185,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLSignContext.putNamespacePrefix:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     250: pop
     251: aload         7
     253: ldc           #187                // String transform_ws_doc_info
     255: aload_0
     256: getfield      #19                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     259: invokeinterface #188,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLSignContext.setProperty:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     264: pop
     265: aload_0
     266: getfield      #19                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     269: aload_0
     270: getfield      #189                // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
     273: invokevirtual #190                // Method org/apache/wss4j/dom/WSDocInfo.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
     276: aload_0
     277: getfield      #19                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     280: aload         7
     282: checkcast     #181                // class javax/xml/crypto/dsig/dom/DOMSignContext
     285: invokevirtual #191                // Method org/apache/wss4j/dom/WSDocInfo.setTokensOnContext:(Ljavax/xml/crypto/dom/DOMCryptoContext;)V
     288: aload_0
     289: getfield      #176                // Field sig:Ljavax/xml/crypto/dsig/XMLSignature;
     292: aload         7
     294: invokeinterface #192,  2          // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.sign:(Ljavax/xml/crypto/dsig/XMLSignContext;)V
     299: aload_0
     300: aload_0
     301: getfield      #176                // Field sig:Ljavax/xml/crypto/dsig/XMLSignature;
     304: invokeinterface #193,  1          // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignatureValue:()Ljavax/xml/crypto/dsig/XMLSignature$SignatureValue;
     309: invokeinterface #194,  1          // InterfaceMethod javax/xml/crypto/dsig/XMLSignature$SignatureValue.getValue:()[B
     314: putfield      #195                // Field signatureValue:[B
     317: goto          350
     320: astore        4
     322: getstatic     #31                 // Field LOG:Lorg/slf4j/Logger;
     325: aload         4
     327: invokevirtual #196                // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     330: aload         4
     332: invokeinterface #33,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     337: new           #34                 // class org/apache/wss4j/common/ext/WSSecurityException
     340: dup
     341: getstatic     #35                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_SIGNATURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     344: aload         4
     346: invokespecial #197                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     349: athrow
     350: return
    Exception table:
       from    to  target type
           0   317   320   Class java/lang/Exception

  public void setUseSingleCertificate(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #2                  // Field useSingleCert:Z
       5: return

  public boolean isUseSingleCertificate();
    Code:
       0: aload_0
       1: getfield      #2                  // Field useSingleCert:Z
       4: ireturn

  public void setSignatureAlgorithm(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #170                // Field sigAlgo:Ljava/lang/String;
       5: return

  public java.lang.String getSignatureAlgorithm();
    Code:
       0: aload_0
       1: getfield      #170                // Field sigAlgo:Ljava/lang/String;
       4: areturn

  public void setSigCanonicalization(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #4                  // Field canonAlgo:Ljava/lang/String;
       5: return

  public java.lang.String getSigCanonicalization();
    Code:
       0: aload_0
       1: getfield      #4                  // Field canonAlgo:Ljava/lang/String;
       4: areturn

  public java.lang.String getDigestAlgo();
    Code:
       0: aload_0
       1: getfield      #6                  // Field digestAlgo:Ljava/lang/String;
       4: areturn

  public void setDigestAlgo(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #6                  // Field digestAlgo:Ljava/lang/String;
       5: return

  public byte[] getSignatureValue();
    Code:
       0: aload_0
       1: getfield      #195                // Field signatureValue:[B
       4: areturn

  public java.lang.String getId();
    Code:
       0: aload_0
       1: getfield      #176                // Field sig:Ljavax/xml/crypto/dsig/XMLSignature;
       4: ifnonnull     9
       7: aconst_null
       8: areturn
       9: aload_0
      10: getfield      #176                // Field sig:Ljavax/xml/crypto/dsig/XMLSignature;
      13: invokeinterface #198,  1          // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getId:()Ljava/lang/String;
      18: areturn

  public java.lang.String getBSTTokenId();
    Code:
       0: aload_0
       1: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
       4: ifnonnull     9
       7: aconst_null
       8: areturn
       9: aload_0
      10: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
      13: ldc           #144                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      15: ldc           #199                // String Id
      17: invokeinterface #200,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      22: areturn

  public void setSecretKey(byte[]);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #83                 // Field secretKey:[B
       5: return

  public void setCustomTokenValueType(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #88                 // Field customTokenValueType:Ljava/lang/String;
       5: return

  public void setCustomTokenId(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #93                 // Field customTokenId:Ljava/lang/String;
       5: return

  public void setEncrKeySha1value(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #81                 // Field encrKeySha1value:Ljava/lang/String;
       5: return

  public void setX509Certificate(java.security.cert.X509Certificate);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #201                // Field useThisCert:Ljava/security/cert/X509Certificate;
       5: return

  public org.w3c.dom.Element getBinarySecurityTokenElement();
    Code:
       0: aload_0
       1: getfield      #131                // Field bstToken:Lorg/w3c/dom/Element;
       4: areturn

  public java.lang.String getSecurityTokenReferenceURI();
    Code:
       0: aload_0
       1: getfield      #48                 // Field strUri:Ljava/lang/String;
       4: areturn

  public org.apache.wss4j.common.token.SecurityTokenReference getSecurityTokenReference();
    Code:
       0: aload_0
       1: getfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
       4: areturn

  public void setSecurityTokenReference(org.apache.wss4j.common.token.SecurityTokenReference);
    Code:
       0: aload_0
       1: iconst_1
       2: putfield      #43                 // Field useCustomSecRef:Z
       5: aload_0
       6: aload_1
       7: putfield      #46                 // Field secRef:Lorg/apache/wss4j/common/token/SecurityTokenReference;
      10: return

  private java.security.cert.X509Certificate[] getSigningCerts() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aconst_null
       1: astore_1
       2: aload_0
       3: getfield      #52                 // Field keyIdentifierType:I
       6: bipush        9
       8: if_icmpeq     280
      11: aload_0
      12: getfield      #52                 // Field keyIdentifierType:I
      15: bipush        11
      17: if_icmpeq     280
      20: aload_0
      21: getfield      #52                 // Field keyIdentifierType:I
      24: bipush        10
      26: if_icmpeq     280
      29: aload_0
      30: getfield      #52                 // Field keyIdentifierType:I
      33: bipush        12
      35: if_icmpeq     280
      38: aload_0
      39: getfield      #201                // Field useThisCert:Ljava/security/cert/X509Certificate;
      42: ifnonnull     98
      45: new           #202                // class org/apache/wss4j/common/crypto/CryptoType
      48: dup
      49: getstatic     #203                // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ALIAS:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
      52: invokespecial #204                // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
      55: astore_2
      56: aload_2
      57: aload_0
      58: getfield      #167                // Field user:Ljava/lang/String;
      61: invokevirtual #205                // Method org/apache/wss4j/common/crypto/CryptoType.setAlias:(Ljava/lang/String;)V
      64: aload_0
      65: getfield      #15                 // Field crypto:Lorg/apache/wss4j/common/crypto/Crypto;
      68: ifnonnull     84
      71: new           #34                 // class org/apache/wss4j/common/ext/WSSecurityException
      74: dup
      75: getstatic     #105                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      78: ldc           #206                // String noSigCryptoFile
      80: invokespecial #107                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      83: athrow
      84: aload_0
      85: getfield      #15                 // Field crypto:Lorg/apache/wss4j/common/crypto/Crypto;
      88: aload_2
      89: invokeinterface #207,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
      94: astore_1
      95: goto          110
      98: iconst_1
      99: anewarray     #208                // class java/security/cert/X509Certificate
     102: dup
     103: iconst_0
     104: aload_0
     105: getfield      #201                // Field useThisCert:Ljava/security/cert/X509Certificate;
     108: aastore
     109: astore_1
     110: aload_1
     111: ifnull        119
     114: aload_1
     115: arraylength
     116: ifgt          148
     119: new           #34                 // class org/apache/wss4j/common/ext/WSSecurityException
     122: dup
     123: getstatic     #105                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     126: ldc           #209                // String noUserCertsFound
     128: iconst_2
     129: anewarray     #210                // class java/lang/Object
     132: dup
     133: iconst_0
     134: aload_0
     135: getfield      #167                // Field user:Ljava/lang/String;
     138: aastore
     139: dup
     140: iconst_1
     141: ldc           #211                // String signature
     143: aastore
     144: invokespecial #212                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     147: athrow
     148: aload_0
     149: aload_0
     150: invokevirtual #38                 // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     153: ldc           #213                // String X509-
     155: aload_1
     156: iconst_0
     157: aaload
     158: invokeinterface #41,  3           // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createSecureId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     163: putfield      #59                 // Field certUri:Ljava/lang/String;
     166: aload_0
     167: getfield      #170                // Field sigAlgo:Ljava/lang/String;
     170: ifnonnull     280
     173: aload_1
     174: iconst_0
     175: aaload
     176: invokevirtual #99                 // Method java/security/cert/X509Certificate.getPublicKey:()Ljava/security/PublicKey;
     179: invokeinterface #214,  1          // InterfaceMethod java/security/PublicKey.getAlgorithm:()Ljava/lang/String;
     184: astore_2
     185: getstatic     #31                 // Field LOG:Lorg/slf4j/Logger;
     188: invokeinterface #112,  1          // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     193: ifeq          223
     196: getstatic     #31                 // Field LOG:Lorg/slf4j/Logger;
     199: new           #55                 // class java/lang/StringBuilder
     202: dup
     203: invokespecial #56                 // Method java/lang/StringBuilder."<init>":()V
     206: ldc           #215                // String Automatic signature algorithm detection:
     208: invokevirtual #58                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     211: aload_2
     212: invokevirtual #58                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     215: invokevirtual #60                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     218: invokeinterface #115,  2          // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     223: aload_2
     224: ldc           #216                // String DSA
     226: invokevirtual #217                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     229: ifeq          241
     232: aload_0
     233: ldc           #218                // String http://www.w3.org/2000/09/xmldsig#dsa-sha1
     235: putfield      #170                // Field sigAlgo:Ljava/lang/String;
     238: goto          280
     241: aload_2
     242: ldc           #219                // String RSA
     244: invokevirtual #217                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     247: ifeq          259
     250: aload_0
     251: ldc           #220                // String http://www.w3.org/2000/09/xmldsig#rsa-sha1
     253: putfield      #170                // Field sigAlgo:Ljava/lang/String;
     256: goto          280
     259: new           #34                 // class org/apache/wss4j/common/ext/WSSecurityException
     262: dup
     263: getstatic     #105                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     266: ldc           #221                // String unknownSignatureAlgorithm
     268: iconst_1
     269: anewarray     #210                // class java/lang/Object
     272: dup
     273: iconst_0
     274: aload_2
     275: aastore
     276: invokespecial #212                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     279: athrow
     280: aload_1
     281: areturn

  public boolean isIncludeSignatureToken();
    Code:
       0: aload_0
       1: getfield      #77                 // Field includeSignatureToken:Z
       4: ireturn

  public void setIncludeSignatureToken(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #77                 // Field includeSignatureToken:Z
       5: return

  public boolean isAddInclusivePrefixes();
    Code:
       0: aload_0
       1: getfield      #7                  // Field addInclusivePrefixes:Z
       4: ireturn

  public void setAddInclusivePrefixes(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #7                  // Field addInclusivePrefixes:Z
       5: return

  static {};
    Code:
       0: ldc_w         #222                // class org/apache/wss4j/dom/message/WSSecSignature
       3: invokestatic  #223                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #31                 // Field LOG:Lorg/slf4j/Logger;
       9: return
}
