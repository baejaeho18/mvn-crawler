Compiled from "OutboundWSSec.java"
public class org.apache.wss4j.stax.setup.OutboundWSSec {
  private final org.apache.wss4j.stax.ext.WSSSecurityProperties securityProperties;

  public org.apache.wss4j.stax.setup.OutboundWSSec(org.apache.wss4j.stax.ext.WSSSecurityProperties);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
       9: return

  public javax.xml.stream.XMLStreamWriter processOutMessage(java.io.OutputStream, java.lang.String, java.util.List<org.apache.xml.security.stax.securityEvent.SecurityEvent>) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aconst_null
       5: invokevirtual #3                  // Method processOutMessage:(Ljava/io/OutputStream;Ljava/lang/String;Ljava/util/List;Lorg/apache/xml/security/stax/securityEvent/SecurityEventListener;)Ljavax/xml/stream/XMLStreamWriter;
       8: areturn

  public javax.xml.stream.XMLStreamWriter processOutMessage(javax.xml.stream.XMLStreamWriter, java.lang.String, java.util.List<org.apache.xml.security.stax.securityEvent.SecurityEvent>) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aconst_null
       5: invokevirtual #4                  // Method processOutMessage:(Ljavax/xml/stream/XMLStreamWriter;Ljava/lang/String;Ljava/util/List;Lorg/apache/xml/security/stax/securityEvent/SecurityEventListener;)Ljavax/xml/stream/XMLStreamWriter;
       8: areturn

  public javax.xml.stream.XMLStreamWriter processOutMessage(java.io.OutputStream, java.lang.String, java.util.List<org.apache.xml.security.stax.securityEvent.SecurityEvent>, org.apache.xml.security.stax.securityEvent.SecurityEventListener) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #5                  // class org/apache/xml/security/stax/impl/OutboundSecurityContextImpl
       3: dup
       4: invokespecial #6                  // Method org/apache/xml/security/stax/impl/OutboundSecurityContextImpl."<init>":()V
       7: astore        5
       9: aload         5
      11: ldc_w         #7                  // class org/apache/xml/security/stax/securityEvent/SecurityEvent
      14: aload_3
      15: invokevirtual #8                  // Method org/apache/xml/security/stax/impl/OutboundSecurityContextImpl.putList:(Ljava/lang/Object;Ljava/util/List;)V
      18: aload         5
      20: aload         4
      22: invokevirtual #9                  // Method org/apache/xml/security/stax/impl/OutboundSecurityContextImpl.addSecurityEventListener:(Lorg/apache/xml/security/stax/securityEvent/SecurityEventListener;)V
      25: aload_0
      26: aload_1
      27: aload_2
      28: aload         5
      30: invokevirtual #10                 // Method processOutMessage:(Ljava/lang/Object;Ljava/lang/String;Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;)Ljavax/xml/stream/XMLStreamWriter;
      33: areturn

  public javax.xml.stream.XMLStreamWriter processOutMessage(javax.xml.stream.XMLStreamWriter, java.lang.String, java.util.List<org.apache.xml.security.stax.securityEvent.SecurityEvent>, org.apache.xml.security.stax.securityEvent.SecurityEventListener) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #5                  // class org/apache/xml/security/stax/impl/OutboundSecurityContextImpl
       3: dup
       4: invokespecial #6                  // Method org/apache/xml/security/stax/impl/OutboundSecurityContextImpl."<init>":()V
       7: astore        5
       9: aload         5
      11: ldc_w         #7                  // class org/apache/xml/security/stax/securityEvent/SecurityEvent
      14: aload_3
      15: invokevirtual #8                  // Method org/apache/xml/security/stax/impl/OutboundSecurityContextImpl.putList:(Ljava/lang/Object;Ljava/util/List;)V
      18: aload         5
      20: aload         4
      22: invokevirtual #9                  // Method org/apache/xml/security/stax/impl/OutboundSecurityContextImpl.addSecurityEventListener:(Lorg/apache/xml/security/stax/securityEvent/SecurityEventListener;)V
      25: aload_0
      26: aload_1
      27: aload_2
      28: aload         5
      30: invokevirtual #10                 // Method processOutMessage:(Ljava/lang/Object;Ljava/lang/String;Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;)Ljavax/xml/stream/XMLStreamWriter;
      33: areturn

  public javax.xml.stream.XMLStreamWriter processOutMessage(javax.xml.stream.XMLStreamWriter, java.lang.String, org.apache.xml.security.stax.ext.OutboundSecurityContext) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: invokevirtual #10                 // Method processOutMessage:(Ljava/lang/Object;Ljava/lang/String;Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;)Ljavax/xml/stream/XMLStreamWriter;
       7: areturn

  public javax.xml.stream.XMLStreamWriter processOutMessage(java.lang.Object, java.lang.String, org.apache.xml.security.stax.ext.OutboundSecurityContext) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #11                 // class org/apache/xml/security/stax/impl/DocumentContextImpl
       3: dup
       4: invokespecial #12                 // Method org/apache/xml/security/stax/impl/DocumentContextImpl."<init>":()V
       7: astore        4
       9: aload         4
      11: aload_2
      12: invokevirtual #13                 // Method org/apache/xml/security/stax/impl/DocumentContextImpl.setEncoding:(Ljava/lang/String;)V
      15: new           #14                 // class org/apache/xml/security/stax/impl/OutputProcessorChainImpl
      18: dup
      19: aload_3
      20: aload         4
      22: invokespecial #15                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl."<init>":(Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;Lorg/apache/xml/security/stax/impl/DocumentContextImpl;)V
      25: astore        5
      27: new           #16                 // class org/apache/wss4j/stax/impl/processor/output/SecurityHeaderOutputProcessor
      30: dup
      31: invokespecial #17                 // Method org/apache/wss4j/stax/impl/processor/output/SecurityHeaderOutputProcessor."<init>":()V
      34: astore        6
      36: aload_0
      37: aload         5
      39: aload         6
      41: aconst_null
      42: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
      45: iconst_0
      46: istore        7
      48: iconst_0
      49: istore        8
      51: iconst_0
      52: istore        9
      54: iconst_0
      55: istore        10
      57: iconst_0
      58: istore        11
      60: iconst_0
      61: istore        12
      63: iconst_0
      64: istore        13
      66: iconst_0
      67: istore        14
      69: iconst_0
      70: istore        15
      72: aload_0
      73: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      76: invokevirtual #19                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getDerivedKeyTokenReference:()Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
      79: getstatic     #20                 // Field org/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference.EncryptedKey:Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
      82: if_acmpne     158
      85: aload_0
      86: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      89: invokevirtual #21                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
      92: invokeinterface #22,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      97: astore        16
      99: aload         16
     101: invokeinterface #23,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     106: ifeq          158
     109: aload         16
     111: invokeinterface #24,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     116: checkcast     #25                 // class org/apache/xml/security/stax/ext/XMLSecurityConstants$Action
     119: astore        17
     121: getstatic     #26                 // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_WITH_DERIVED_KEY:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     124: aload         17
     126: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     129: ifeq          138
     132: iconst_1
     133: istore        15
     135: goto          155
     138: getstatic     #28                 // Field org/apache/wss4j/stax/ext/WSSConstants.ENCRYPT_WITH_DERIVED_KEY:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     141: aload         17
     143: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     146: ifeq          155
     149: iconst_0
     150: istore        15
     152: goto          158
     155: goto          99
     158: aload_0
     159: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     162: invokevirtual #21                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
     165: invokeinterface #22,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     170: astore        16
     172: aload         16
     174: invokeinterface #23,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     179: ifeq          1125
     182: aload         16
     184: invokeinterface #24,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     189: checkcast     #25                 // class org/apache/xml/security/stax/ext/XMLSecurityConstants$Action
     192: astore        17
     194: getstatic     #29                 // Field org/apache/wss4j/stax/ext/WSSConstants.TIMESTAMP:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     197: aload         17
     199: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     202: ifeq          227
     205: new           #30                 // class org/apache/wss4j/stax/impl/processor/output/TimestampOutputProcessor
     208: dup
     209: invokespecial #31                 // Method org/apache/wss4j/stax/impl/processor/output/TimestampOutputProcessor."<init>":()V
     212: astore        18
     214: aload_0
     215: aload         5
     217: aload         18
     219: aload         17
     221: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     224: goto          1122
     227: getstatic     #32                 // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     230: aload         17
     232: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     235: ifeq          282
     238: iconst_1
     239: istore        7
     241: new           #33                 // class org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor
     244: dup
     245: invokespecial #34                 // Method org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor."<init>":()V
     248: astore        18
     250: aload_0
     251: aload         5
     253: aload         18
     255: aload         17
     257: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     260: new           #35                 // class org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor
     263: dup
     264: invokespecial #36                 // Method org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor."<init>":()V
     267: astore        19
     269: aload_0
     270: aload         5
     272: aload         19
     274: aload         17
     276: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     279: goto          1122
     282: getstatic     #37                 // Field org/apache/wss4j/stax/ext/WSSConstants.ENCRYPT:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     285: aload         17
     287: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     290: ifeq          404
     293: iconst_1
     294: istore        8
     296: aconst_null
     297: astore        18
     299: aload_0
     300: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     303: invokevirtual #38                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.isEncryptSymmetricEncryptionKey:()Z
     306: ifeq          347
     309: new           #33                 // class org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor
     312: dup
     313: invokespecial #34                 // Method org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor."<init>":()V
     316: astore        19
     318: aload_0
     319: aload         5
     321: aload         19
     323: aload         17
     325: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     328: new           #39                 // class org/apache/wss4j/stax/impl/processor/output/EncryptedKeyOutputProcessor
     331: dup
     332: invokespecial #40                 // Method org/apache/wss4j/stax/impl/processor/output/EncryptedKeyOutputProcessor."<init>":()V
     335: astore        18
     337: aload_0
     338: aload         5
     340: aload         18
     342: aload         17
     344: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     347: new           #41                 // class org/apache/wss4j/stax/impl/processor/output/EncryptOutputProcessor
     350: dup
     351: invokespecial #42                 // Method org/apache/wss4j/stax/impl/processor/output/EncryptOutputProcessor."<init>":()V
     354: astore        19
     356: aload_0
     357: aload         5
     359: aload         19
     361: aload         17
     363: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     366: aload         18
     368: ifnonnull     401
     371: new           #43                 // class org/apache/wss4j/stax/impl/processor/output/ReferenceListOutputProcessor
     374: dup
     375: invokespecial #44                 // Method org/apache/wss4j/stax/impl/processor/output/ReferenceListOutputProcessor."<init>":()V
     378: astore        20
     380: aload         20
     382: ldc_w         #45                 // class org/apache/wss4j/stax/impl/processor/output/EncryptEndingOutputProcessor
     385: invokevirtual #46                 // Method java/lang/Class.getName:()Ljava/lang/String;
     388: invokevirtual #47                 // Method org/apache/wss4j/stax/impl/processor/output/ReferenceListOutputProcessor.addAfterProcessor:(Ljava/lang/Object;)V
     391: aload_0
     392: aload         5
     394: aload         20
     396: aload         17
     398: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     401: goto          1122
     404: getstatic     #48                 // Field org/apache/wss4j/stax/ext/WSSConstants.USERNAMETOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     407: aload         17
     409: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     412: ifeq          437
     415: new           #49                 // class org/apache/wss4j/stax/impl/processor/output/UsernameTokenOutputProcessor
     418: dup
     419: invokespecial #50                 // Method org/apache/wss4j/stax/impl/processor/output/UsernameTokenOutputProcessor."<init>":()V
     422: astore        18
     424: aload_0
     425: aload         5
     427: aload         18
     429: aload         17
     431: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     434: goto          1122
     437: getstatic     #51                 // Field org/apache/wss4j/stax/ext/WSSConstants.USERNAMETOKEN_SIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     440: aload         17
     442: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     445: ifeq          489
     448: new           #49                 // class org/apache/wss4j/stax/impl/processor/output/UsernameTokenOutputProcessor
     451: dup
     452: invokespecial #50                 // Method org/apache/wss4j/stax/impl/processor/output/UsernameTokenOutputProcessor."<init>":()V
     455: astore        18
     457: aload_0
     458: aload         5
     460: aload         18
     462: aload         17
     464: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     467: new           #35                 // class org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor
     470: dup
     471: invokespecial #36                 // Method org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor."<init>":()V
     474: astore        19
     476: aload_0
     477: aload         5
     479: aload         19
     481: aload         17
     483: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     486: goto          1122
     489: getstatic     #52                 // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_CONFIRMATION:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     492: aload         17
     494: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     497: ifeq          522
     500: new           #53                 // class org/apache/wss4j/stax/impl/processor/output/SignatureConfirmationOutputProcessor
     503: dup
     504: invokespecial #54                 // Method org/apache/wss4j/stax/impl/processor/output/SignatureConfirmationOutputProcessor."<init>":()V
     507: astore        18
     509: aload_0
     510: aload         5
     512: aload         18
     514: aload         17
     516: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     519: goto          1122
     522: getstatic     #26                 // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_WITH_DERIVED_KEY:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     525: aload         17
     527: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     530: ifeq          667
     533: aload_0
     534: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     537: invokevirtual #19                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getDerivedKeyTokenReference:()Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
     540: getstatic     #20                 // Field org/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference.EncryptedKey:Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
     543: if_acmpne     579
     546: iload         15
     548: ifeq          570
     551: new           #39                 // class org/apache/wss4j/stax/impl/processor/output/EncryptedKeyOutputProcessor
     554: dup
     555: invokespecial #40                 // Method org/apache/wss4j/stax/impl/processor/output/EncryptedKeyOutputProcessor."<init>":()V
     558: astore        18
     560: aload_0
     561: aload         5
     563: aload         18
     565: aload         17
     567: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     570: iconst_1
     571: istore        8
     573: iconst_1
     574: istore        14
     576: goto          626
     579: aload_0
     580: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     583: invokevirtual #19                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getDerivedKeyTokenReference:()Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
     586: getstatic     #55                 // Field org/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference.SecurityContextToken:Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
     589: if_acmpne     620
     592: new           #56                 // class org/apache/wss4j/stax/impl/processor/output/SecurityContextTokenOutputProcessor
     595: dup
     596: invokespecial #57                 // Method org/apache/wss4j/stax/impl/processor/output/SecurityContextTokenOutputProcessor."<init>":()V
     599: astore        18
     601: aload_0
     602: aload         5
     604: aload         18
     606: aload         17
     608: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     611: iconst_1
     612: istore        7
     614: iconst_1
     615: istore        13
     617: goto          626
     620: iconst_1
     621: istore        7
     623: iconst_1
     624: istore        13
     626: new           #58                 // class org/apache/wss4j/stax/impl/processor/output/DerivedKeyTokenOutputProcessor
     629: dup
     630: invokespecial #59                 // Method org/apache/wss4j/stax/impl/processor/output/DerivedKeyTokenOutputProcessor."<init>":()V
     633: astore        18
     635: aload_0
     636: aload         5
     638: aload         18
     640: aload         17
     642: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     645: new           #35                 // class org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor
     648: dup
     649: invokespecial #36                 // Method org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor."<init>":()V
     652: astore        19
     654: aload_0
     655: aload         5
     657: aload         19
     659: aload         17
     661: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     664: goto          1122
     667: getstatic     #28                 // Field org/apache/wss4j/stax/ext/WSSConstants.ENCRYPT_WITH_DERIVED_KEY:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     670: aload         17
     672: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     675: ifeq          830
     678: iconst_1
     679: istore        8
     681: iconst_1
     682: istore        14
     684: aconst_null
     685: astore        18
     687: aload_0
     688: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     691: invokevirtual #19                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getDerivedKeyTokenReference:()Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
     694: getstatic     #20                 // Field org/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference.EncryptedKey:Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
     697: if_acmpne     722
     700: new           #39                 // class org/apache/wss4j/stax/impl/processor/output/EncryptedKeyOutputProcessor
     703: dup
     704: invokespecial #40                 // Method org/apache/wss4j/stax/impl/processor/output/EncryptedKeyOutputProcessor."<init>":()V
     707: astore        18
     709: aload_0
     710: aload         5
     712: aload         18
     714: aload         17
     716: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     719: goto          754
     722: aload_0
     723: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     726: invokevirtual #19                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getDerivedKeyTokenReference:()Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
     729: getstatic     #55                 // Field org/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference.SecurityContextToken:Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
     732: if_acmpne     754
     735: new           #56                 // class org/apache/wss4j/stax/impl/processor/output/SecurityContextTokenOutputProcessor
     738: dup
     739: invokespecial #57                 // Method org/apache/wss4j/stax/impl/processor/output/SecurityContextTokenOutputProcessor."<init>":()V
     742: astore        19
     744: aload_0
     745: aload         5
     747: aload         19
     749: aload         17
     751: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     754: new           #58                 // class org/apache/wss4j/stax/impl/processor/output/DerivedKeyTokenOutputProcessor
     757: dup
     758: invokespecial #59                 // Method org/apache/wss4j/stax/impl/processor/output/DerivedKeyTokenOutputProcessor."<init>":()V
     761: astore        19
     763: aload_0
     764: aload         5
     766: aload         19
     768: aload         17
     770: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     773: new           #41                 // class org/apache/wss4j/stax/impl/processor/output/EncryptOutputProcessor
     776: dup
     777: invokespecial #42                 // Method org/apache/wss4j/stax/impl/processor/output/EncryptOutputProcessor."<init>":()V
     780: astore        20
     782: aload_0
     783: aload         5
     785: aload         20
     787: aload         17
     789: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     792: aload         18
     794: ifnonnull     827
     797: new           #43                 // class org/apache/wss4j/stax/impl/processor/output/ReferenceListOutputProcessor
     800: dup
     801: invokespecial #44                 // Method org/apache/wss4j/stax/impl/processor/output/ReferenceListOutputProcessor."<init>":()V
     804: astore        21
     806: aload         21
     808: ldc_w         #45                 // class org/apache/wss4j/stax/impl/processor/output/EncryptEndingOutputProcessor
     811: invokevirtual #46                 // Method java/lang/Class.getName:()Ljava/lang/String;
     814: invokevirtual #47                 // Method org/apache/wss4j/stax/impl/processor/output/ReferenceListOutputProcessor.addAfterProcessor:(Ljava/lang/Object;)V
     817: aload_0
     818: aload         5
     820: aload         21
     822: aload         17
     824: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     827: goto          1122
     830: getstatic     #60                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_SIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     833: aload         17
     835: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     838: ifeq          907
     841: iconst_1
     842: istore        7
     844: iconst_1
     845: istore        9
     847: new           #33                 // class org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor
     850: dup
     851: invokespecial #34                 // Method org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor."<init>":()V
     854: astore        18
     856: aload_0
     857: aload         5
     859: aload         18
     861: aload         17
     863: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     866: new           #61                 // class org/apache/wss4j/stax/impl/processor/output/SAMLTokenOutputProcessor
     869: dup
     870: invokespecial #62                 // Method org/apache/wss4j/stax/impl/processor/output/SAMLTokenOutputProcessor."<init>":()V
     873: astore        19
     875: aload_0
     876: aload         5
     878: aload         19
     880: aload         17
     882: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     885: new           #35                 // class org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor
     888: dup
     889: invokespecial #36                 // Method org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor."<init>":()V
     892: astore        20
     894: aload_0
     895: aload         5
     897: aload         20
     899: aload         17
     901: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     904: goto          1122
     907: getstatic     #63                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_UNSIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     910: aload         17
     912: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     915: ifeq          940
     918: new           #61                 // class org/apache/wss4j/stax/impl/processor/output/SAMLTokenOutputProcessor
     921: dup
     922: invokespecial #62                 // Method org/apache/wss4j/stax/impl/processor/output/SAMLTokenOutputProcessor."<init>":()V
     925: astore        18
     927: aload_0
     928: aload         5
     930: aload         18
     932: aload         17
     934: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     937: goto          1122
     940: getstatic     #64                 // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_WITH_KERBEROS_TOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     943: aload         17
     945: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
     948: ifeq          998
     951: iconst_1
     952: istore        10
     954: iconst_1
     955: istore        11
     957: new           #33                 // class org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor
     960: dup
     961: invokespecial #34                 // Method org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor."<init>":()V
     964: astore        18
     966: aload_0
     967: aload         5
     969: aload         18
     971: aload         17
     973: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     976: new           #35                 // class org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor
     979: dup
     980: invokespecial #36                 // Method org/apache/wss4j/stax/impl/processor/output/WSSSignatureOutputProcessor."<init>":()V
     983: astore        19
     985: aload_0
     986: aload         5
     988: aload         19
     990: aload         17
     992: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     995: goto          1122
     998: getstatic     #65                 // Field org/apache/wss4j/stax/ext/WSSConstants.ENCRYPT_WITH_KERBEROS_TOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
    1001: aload         17
    1003: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
    1006: ifeq          1056
    1009: iconst_1
    1010: istore        10
    1012: iconst_1
    1013: istore        12
    1015: new           #33                 // class org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor
    1018: dup
    1019: invokespecial #34                 // Method org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor."<init>":()V
    1022: astore        18
    1024: aload_0
    1025: aload         5
    1027: aload         18
    1029: aload         17
    1031: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
    1034: new           #41                 // class org/apache/wss4j/stax/impl/processor/output/EncryptOutputProcessor
    1037: dup
    1038: invokespecial #42                 // Method org/apache/wss4j/stax/impl/processor/output/EncryptOutputProcessor."<init>":()V
    1041: astore        19
    1043: aload_0
    1044: aload         5
    1046: aload         19
    1048: aload         17
    1050: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
    1053: goto          1122
    1056: getstatic     #66                 // Field org/apache/wss4j/stax/ext/WSSConstants.KERBEROS_TOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
    1059: aload         17
    1061: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
    1064: ifeq          1092
    1067: iconst_1
    1068: istore        10
    1070: new           #33                 // class org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor
    1073: dup
    1074: invokespecial #34                 // Method org/apache/wss4j/stax/impl/processor/output/BinarySecurityTokenOutputProcessor."<init>":()V
    1077: astore        18
    1079: aload_0
    1080: aload         5
    1082: aload         18
    1084: aload         17
    1086: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
    1089: goto          1122
    1092: getstatic     #67                 // Field org/apache/wss4j/stax/ext/WSSConstants.CUSTOM_TOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
    1095: aload         17
    1097: invokevirtual #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityConstants$Action.equals:(Ljava/lang/Object;)Z
    1100: ifeq          1122
    1103: new           #68                 // class org/apache/wss4j/stax/impl/processor/output/CustomTokenOutputProcessor
    1106: dup
    1107: invokespecial #69                 // Method org/apache/wss4j/stax/impl/processor/output/CustomTokenOutputProcessor."<init>":()V
    1110: astore        18
    1112: aload_0
    1113: aload         5
    1115: aload         18
    1117: aload         17
    1119: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
    1122: goto          172
    1125: iload         7
    1127: ifeq          1142
    1130: aload_0
    1131: aload         5
    1133: aload_0
    1134: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
    1137: iload         9
    1139: invokespecial #70                 // Method setupSignatureKey:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;Z)V
    1142: iload         8
    1144: ifeq          1157
    1147: aload_0
    1148: aload         5
    1150: aload_0
    1151: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
    1154: invokespecial #71                 // Method setupEncryptionKey:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)V
    1157: iload         10
    1159: ifeq          1176
    1162: aload_0
    1163: aload         5
    1165: aload_0
    1166: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
    1169: iload         11
    1171: iload         12
    1173: invokespecial #72                 // Method setupKerberosKey:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;ZZ)V
    1176: iload         13
    1178: ifeq          1206
    1181: aload         5
    1183: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
    1186: ldc           #74                 // String PROP_USE_THIS_TOKEN_ID_FOR_SIGNATURE
    1188: invokeinterface #75,  2           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.get:(Ljava/lang/String;)Ljava/lang/Object;
    1193: checkcast     #76                 // class java/lang/String
    1196: astore        16
    1198: aload_0
    1199: aload         5
    1201: aload         16
    1203: invokespecial #77                 // Method setDerivedIdentifier:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Ljava/lang/String;)V
    1206: iload         14
    1208: ifeq          1258
    1211: aload         5
    1213: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
    1216: ldc           #78                 // String PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTED_KEY
    1218: invokeinterface #75,  2           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.get:(Ljava/lang/String;)Ljava/lang/Object;
    1223: checkcast     #76                 // class java/lang/String
    1226: astore        16
    1228: aload         16
    1230: ifnonnull     1250
    1233: aload         5
    1235: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
    1238: ldc           #79                 // String PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTION
    1240: invokeinterface #75,  2           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.get:(Ljava/lang/String;)Ljava/lang/Object;
    1245: checkcast     #76                 // class java/lang/String
    1248: astore        16
    1250: aload_0
    1251: aload         5
    1253: aload         16
    1255: invokespecial #77                 // Method setDerivedIdentifier:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Ljava/lang/String;)V
    1258: new           #80                 // class org/apache/wss4j/stax/impl/processor/output/SecurityHeaderReorderProcessor
    1261: dup
    1262: invokespecial #81                 // Method org/apache/wss4j/stax/impl/processor/output/SecurityHeaderReorderProcessor."<init>":()V
    1265: astore        16
    1267: aload_0
    1268: aload         5
    1270: aload         16
    1272: aconst_null
    1273: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
    1276: aload_1
    1277: instanceof    #82                 // class java/io/OutputStream
    1280: ifeq          1309
    1283: new           #83                 // class org/apache/xml/security/stax/impl/processor/output/FinalOutputProcessor
    1286: dup
    1287: aload_1
    1288: checkcast     #82                 // class java/io/OutputStream
    1291: aload_2
    1292: invokespecial #84                 // Method org/apache/xml/security/stax/impl/processor/output/FinalOutputProcessor."<init>":(Ljava/io/OutputStream;Ljava/lang/String;)V
    1295: astore        17
    1297: aload_0
    1298: aload         5
    1300: aload         17
    1302: aconst_null
    1303: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
    1306: goto          1368
    1309: aload_1
    1310: instanceof    #85                 // class javax/xml/stream/XMLStreamWriter
    1313: ifeq          1341
    1316: new           #83                 // class org/apache/xml/security/stax/impl/processor/output/FinalOutputProcessor
    1319: dup
    1320: aload_1
    1321: checkcast     #85                 // class javax/xml/stream/XMLStreamWriter
    1324: invokespecial #86                 // Method org/apache/xml/security/stax/impl/processor/output/FinalOutputProcessor."<init>":(Ljavax/xml/stream/XMLStreamWriter;)V
    1327: astore        17
    1329: aload_0
    1330: aload         5
    1332: aload         17
    1334: aconst_null
    1335: invokespecial #18                 // Method initializeOutputProcessor:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Lorg/apache/xml/security/stax/ext/OutputProcessor;Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
    1338: goto          1368
    1341: new           #87                 // class java/lang/IllegalArgumentException
    1344: dup
    1345: new           #88                 // class java/lang/StringBuilder
    1348: dup
    1349: invokespecial #89                 // Method java/lang/StringBuilder."<init>":()V
    1352: aload_1
    1353: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
    1356: ldc           #91                 // String  is not supported as output
    1358: invokevirtual #92                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1361: invokevirtual #93                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1364: invokespecial #94                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
    1367: athrow
    1368: goto          1386
    1371: astore        6
    1373: new           #96                 // class org/apache/wss4j/common/ext/WSSecurityException
    1376: dup
    1377: getstatic     #97                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
    1380: aload         6
    1382: invokespecial #98                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
    1385: athrow
    1386: new           #99                 // class org/apache/xml/security/stax/impl/XMLSecurityStreamWriter
    1389: dup
    1390: aload         5
    1392: invokespecial #100                // Method org/apache/xml/security/stax/impl/XMLSecurityStreamWriter."<init>":(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;)V
    1395: areturn
    Exception table:
       from    to  target type
          27  1368  1371   Class org/apache/xml/security/exceptions/XMLSecurityException

  private void initializeOutputProcessor(org.apache.xml.security.stax.impl.OutputProcessorChainImpl, org.apache.xml.security.stax.ext.OutputProcessor, org.apache.xml.security.stax.ext.XMLSecurityConstants$Action) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_2
       1: aload_0
       2: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
       5: invokeinterface #101,  2          // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessor.setXMLSecurityProperties:(Lorg/apache/xml/security/stax/ext/XMLSecurityProperties;)V
      10: aload_2
      11: aload_3
      12: invokeinterface #102,  2          // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessor.setAction:(Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
      17: aload_2
      18: aload_1
      19: invokeinterface #103,  2          // InterfaceMethod org/apache/xml/security/stax/ext/OutputProcessor.init:(Lorg/apache/xml/security/stax/ext/OutputProcessorChain;)V
      24: return

  private void setupSignatureKey(org.apache.xml.security.stax.impl.OutputProcessorChainImpl, org.apache.wss4j.stax.ext.WSSSecurityProperties, boolean) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #104                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureAlgorithm:()Ljava/lang/String;
       4: astore        4
       6: aload_0
       7: aload_1
       8: ldc           #74                 // String PROP_USE_THIS_TOKEN_ID_FOR_SIGNATURE
      10: invokespecial #105                // Method getOutboundSecurityToken:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Ljava/lang/String;)Lorg/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken;
      13: astore        5
      15: aload         5
      17: ifnull        107
      20: aload         4
      22: ifnull        107
      25: aload         4
      27: ldc           #106                // String hmac-sha
      29: invokevirtual #107                // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
      32: ifeq          46
      35: aload         5
      37: aload         4
      39: invokevirtual #108                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.getSecretKey:(Ljava/lang/String;)Ljava/security/Key;
      42: ifnull        46
      45: return
      46: aload         4
      48: ldc           #106                // String hmac-sha
      50: invokevirtual #107                // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
      53: ifne          107
      56: aload         5
      58: invokevirtual #109                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.getX509Certificates:()[Ljava/security/cert/X509Certificate;
      61: ifnull        107
      64: aload         5
      66: aload         4
      68: invokevirtual #108                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.getSecretKey:(Ljava/lang/String;)Ljava/security/Key;
      71: ifnull        75
      74: return
      75: aload_2
      76: invokevirtual #110                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
      79: aload         5
      81: invokevirtual #109                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.getX509Certificates:()[Ljava/security/cert/X509Certificate;
      84: iconst_0
      85: aaload
      86: aload_2
      87: invokevirtual #111                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      90: invokeinterface #112,  3          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getPrivateKey:(Ljava/security/cert/X509Certificate;Ljavax/security/auth/callback/CallbackHandler;)Ljava/security/PrivateKey;
      95: astore        6
      97: aload         5
      99: aload         4
     101: aload         6
     103: invokevirtual #113                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.setSecretKey:(Ljava/lang/String;Ljava/security/Key;)V
     106: return
     107: aload_2
     108: invokevirtual #114                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureUser:()Ljava/lang/String;
     111: astore        6
     113: new           #115                // class org/apache/wss4j/common/ext/WSPasswordCallback
     116: dup
     117: aload         6
     119: iconst_3
     120: invokespecial #116                // Method org/apache/wss4j/common/ext/WSPasswordCallback."<init>":(Ljava/lang/String;I)V
     123: astore        7
     125: aload_2
     126: invokevirtual #111                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     129: aload         7
     131: invokestatic  #117                // Method org/apache/wss4j/stax/utils/WSSUtils.doPasswordCallback:(Ljavax/security/auth/callback/CallbackHandler;Ljavax/security/auth/callback/Callback;)V
     134: aload         7
     136: invokevirtual #118                // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
     139: astore        8
     141: aload         7
     143: invokevirtual #119                // Method org/apache/wss4j/common/ext/WSPasswordCallback.getKey:()[B
     146: astore        9
     148: aconst_null
     149: astore        10
     151: aconst_null
     152: astore        11
     154: aload         8
     156: ifnull        249
     159: aload_2
     160: invokevirtual #110                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     163: ifnull        249
     166: aload_2
     167: invokevirtual #110                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     170: aload         6
     172: aload         8
     174: invokeinterface #120,  3          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getPrivateKey:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/PrivateKey;
     179: astore        10
     181: new           #121                // class org/apache/wss4j/common/crypto/CryptoType
     184: dup
     185: getstatic     #122                // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ALIAS:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
     188: invokespecial #123                // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
     191: astore        12
     193: aload         12
     195: aload         6
     197: invokevirtual #124                // Method org/apache/wss4j/common/crypto/CryptoType.setAlias:(Ljava/lang/String;)V
     200: aload_2
     201: invokevirtual #110                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     204: aload         12
     206: invokeinterface #125,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
     211: astore        11
     213: aload         11
     215: ifnull        224
     218: aload         11
     220: arraylength
     221: ifne          246
     224: new           #96                 // class org/apache/wss4j/common/ext/WSSecurityException
     227: dup
     228: getstatic     #126                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_SIGNATURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     231: ldc           #127                // String noUserCertsFound
     233: iconst_1
     234: anewarray     #128                // class java/lang/Object
     237: dup
     238: iconst_0
     239: aload         6
     241: aastore
     242: invokespecial #129                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     245: athrow
     246: goto          302
     249: aload         9
     251: ifnull        280
     254: aconst_null
     255: astore        11
     257: aload         4
     259: invokestatic  #130                // Method org/apache/xml/security/stax/config/JCEAlgorithmMapper.getJCEKeyAlgorithmFromURI:(Ljava/lang/String;)Ljava/lang/String;
     262: astore        12
     264: new           #131                // class javax/crypto/spec/SecretKeySpec
     267: dup
     268: aload         9
     270: aload         12
     272: invokespecial #132                // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
     275: astore        10
     277: goto          302
     280: new           #96                 // class org/apache/wss4j/common/ext/WSSecurityException
     283: dup
     284: getstatic     #126                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_SIGNATURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     287: ldc           #133                // String noPassword
     289: iconst_1
     290: anewarray     #128                // class java/lang/Object
     293: dup
     294: iconst_0
     295: aload         6
     297: aastore
     298: invokespecial #129                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     301: athrow
     302: goto          322
     305: astore        12
     307: iload_3
     308: ifeq          319
     311: aload_2
     312: invokevirtual #134                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSamlCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     315: ifnull        319
     318: return
     319: aload         12
     321: athrow
     322: aconst_null
     323: invokestatic  #135                // Method org/apache/xml/security/stax/impl/util/IDGenerator.generateID:(Ljava/lang/String;)Ljava/lang/String;
     326: astore        12
     328: new           #136                // class org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken
     331: dup
     332: aload         12
     334: getstatic     #137                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.X509V3Token:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     337: aload         10
     339: aload         11
     341: invokespecial #138                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken."<init>":(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;Ljava/security/Key;[Ljava/security/cert/X509Certificate;)V
     344: astore        13
     346: new           #139                // class org/apache/wss4j/stax/setup/OutboundWSSec$1
     349: dup
     350: aload_0
     351: aload         13
     353: aload         12
     355: invokespecial #140                // Method org/apache/wss4j/stax/setup/OutboundWSSec$1."<init>":(Lorg/apache/wss4j/stax/setup/OutboundWSSec;Lorg/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken;Ljava/lang/String;)V
     358: astore        14
     360: aload_1
     361: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     364: aload         12
     366: aload         14
     368: invokeinterface #141,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.registerSecurityTokenProvider:(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;)V
     373: aload_1
     374: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     377: ldc           #74                 // String PROP_USE_THIS_TOKEN_ID_FOR_SIGNATURE
     379: aload         12
     381: invokeinterface #142,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     386: return
    Exception table:
       from    to  target type
         154   302   305   Class org/apache/wss4j/common/ext/WSSecurityException

  private void setupEncryptionKey(org.apache.xml.security.stax.impl.OutputProcessorChainImpl, org.apache.wss4j.stax.ext.WSSSecurityProperties) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #143                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getEncryptionSymAlgorithm:()Ljava/lang/String;
       4: astore_3
       5: aload_0
       6: aload_1
       7: ldc           #79                 // String PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTION
       9: invokespecial #105                // Method getOutboundSecurityToken:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Ljava/lang/String;)Lorg/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken;
      12: astore        4
      14: aload         4
      16: ifnull        28
      19: aload         4
      21: aload_3
      22: invokevirtual #108                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.getSecretKey:(Ljava/lang/String;)Ljava/security/Key;
      25: ifnonnull     161
      28: aload_2
      29: invokevirtual #143                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getEncryptionSymAlgorithm:()Ljava/lang/String;
      32: invokestatic  #130                // Method org/apache/xml/security/stax/config/JCEAlgorithmMapper.getJCEKeyAlgorithmFromURI:(Ljava/lang/String;)Ljava/lang/String;
      35: astore        5
      37: aload         5
      39: invokestatic  #144                // Method javax/crypto/KeyGenerator.getInstance:(Ljava/lang/String;)Ljavax/crypto/KeyGenerator;
      42: astore        6
      44: goto          62
      47: astore        7
      49: new           #96                 // class org/apache/wss4j/common/ext/WSSecurityException
      52: dup
      53: getstatic     #97                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      56: aload         7
      58: invokespecial #98                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      61: athrow
      62: aload         5
      64: ldc           #146                // String AES
      66: invokevirtual #107                // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
      69: ifeq          88
      72: aload_2
      73: invokevirtual #143                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getEncryptionSymAlgorithm:()Ljava/lang/String;
      76: invokestatic  #147                // Method org/apache/xml/security/stax/config/JCEAlgorithmMapper.getKeyLengthFromURI:(Ljava/lang/String;)I
      79: istore        7
      81: aload         6
      83: iload         7
      85: invokevirtual #148                // Method javax/crypto/KeyGenerator.init:(I)V
      88: aload         6
      90: invokevirtual #149                // Method javax/crypto/KeyGenerator.generateKey:()Ljavax/crypto/SecretKey;
      93: astore        7
      95: aconst_null
      96: invokestatic  #135                // Method org/apache/xml/security/stax/impl/util/IDGenerator.generateID:(Ljava/lang/String;)Ljava/lang/String;
      99: astore        8
     101: new           #136                // class org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken
     104: dup
     105: aload         8
     107: getstatic     #150                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.EncryptedKeyToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     110: aload         7
     112: invokespecial #151                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken."<init>":(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;Ljava/security/Key;)V
     115: astore        9
     117: aload         9
     119: astore        4
     121: new           #152                // class org/apache/wss4j/stax/setup/OutboundWSSec$2
     124: dup
     125: aload_0
     126: aload         9
     128: aload         8
     130: invokespecial #153                // Method org/apache/wss4j/stax/setup/OutboundWSSec$2."<init>":(Lorg/apache/wss4j/stax/setup/OutboundWSSec;Lorg/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken;Ljava/lang/String;)V
     133: astore        10
     135: aload_1
     136: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     139: aload         8
     141: aload         10
     143: invokeinterface #141,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.registerSecurityTokenProvider:(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;)V
     148: aload_1
     149: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     152: ldc           #79                 // String PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTION
     154: aload         8
     156: invokeinterface #142,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     161: aload_2
     162: invokevirtual #38                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.isEncryptSymmetricEncryptionKey:()Z
     165: ifne          169
     168: return
     169: aconst_null
     170: astore        5
     172: aload_0
     173: aload_1
     174: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     177: invokespecial #154                // Method getReqSigCert:(Lorg/apache/xml/security/stax/ext/SecurityContext;)Ljava/security/cert/X509Certificate;
     180: astore        6
     182: aload_2
     183: invokevirtual #155                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.isUseReqSigCertForEncryption:()Z
     186: ifeq          222
     189: aload         6
     191: ifnonnull     207
     194: new           #96                 // class org/apache/wss4j/common/ext/WSSecurityException
     197: dup
     198: getstatic     #156                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_ENCRYPTION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     201: ldc           #157                // String noCert
     203: invokespecial #158                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     206: athrow
     207: iconst_1
     208: anewarray     #159                // class java/security/cert/X509Certificate
     211: astore        5
     213: aload         5
     215: iconst_0
     216: aload         6
     218: aastore
     219: goto          328
     222: aload_2
     223: invokevirtual #160                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getEncryptionUseThisCertificate:()Ljava/security/cert/X509Certificate;
     226: ifnull        250
     229: aload_2
     230: invokevirtual #160                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getEncryptionUseThisCertificate:()Ljava/security/cert/X509Certificate;
     233: astore        6
     235: iconst_1
     236: anewarray     #159                // class java/security/cert/X509Certificate
     239: astore        5
     241: aload         5
     243: iconst_0
     244: aload         6
     246: aastore
     247: goto          328
     250: new           #121                // class org/apache/wss4j/common/crypto/CryptoType
     253: dup
     254: getstatic     #122                // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ALIAS:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
     257: invokespecial #123                // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
     260: astore        7
     262: aload         7
     264: aload_2
     265: invokevirtual #161                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getEncryptionUser:()Ljava/lang/String;
     268: invokevirtual #124                // Method org/apache/wss4j/common/crypto/CryptoType.setAlias:(Ljava/lang/String;)V
     271: aload_2
     272: invokevirtual #162                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getEncryptionCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     275: astore        8
     277: aload         8
     279: aload         7
     281: invokeinterface #125,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
     286: astore        5
     288: aload         5
     290: ifnull        299
     293: aload         5
     295: arraylength
     296: ifne          328
     299: new           #96                 // class org/apache/wss4j/common/ext/WSSecurityException
     302: dup
     303: getstatic     #156                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_ENCRYPTION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     306: ldc           #127                // String noUserCertsFound
     308: iconst_2
     309: anewarray     #128                // class java/lang/Object
     312: dup
     313: iconst_0
     314: aload_2
     315: invokevirtual #161                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getEncryptionUser:()Ljava/lang/String;
     318: aastore
     319: dup
     320: iconst_1
     321: ldc           #163                // String encryption
     323: aastore
     324: invokespecial #129                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     327: athrow
     328: aload_2
     329: invokevirtual #164                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.isEnableRevocation:()Z
     332: ifeq          352
     335: aload_2
     336: invokevirtual #162                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getEncryptionCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     339: astore        7
     341: aload         7
     343: aload         5
     345: iconst_1
     346: aconst_null
     347: invokeinterface #165,  4          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.verifyTrust:([Ljava/security/cert/X509Certificate;ZLjava/util/Collection;)V
     352: aconst_null
     353: invokestatic  #135                // Method org/apache/xml/security/stax/impl/util/IDGenerator.generateID:(Ljava/lang/String;)Ljava/lang/String;
     356: astore        7
     358: new           #136                // class org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken
     361: dup
     362: aload         7
     364: getstatic     #137                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.X509V3Token:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
     367: aconst_null
     368: aload         5
     370: invokespecial #138                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken."<init>":(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;Ljava/security/Key;[Ljava/security/cert/X509Certificate;)V
     373: astore        8
     375: aload         8
     377: aload         4
     379: invokevirtual #166                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.addWrappedToken:(Lorg/apache/xml/security/stax/securityToken/OutboundSecurityToken;)V
     382: aload         4
     384: aload         8
     386: invokevirtual #167                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.setKeyWrappingToken:(Lorg/apache/xml/security/stax/securityToken/OutboundSecurityToken;)V
     389: new           #168                // class org/apache/wss4j/stax/setup/OutboundWSSec$3
     392: dup
     393: aload_0
     394: aload         8
     396: aload         7
     398: invokespecial #169                // Method org/apache/wss4j/stax/setup/OutboundWSSec$3."<init>":(Lorg/apache/wss4j/stax/setup/OutboundWSSec;Lorg/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken;Ljava/lang/String;)V
     401: astore        9
     403: aload_1
     404: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     407: aload         7
     409: aload         9
     411: invokeinterface #141,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.registerSecurityTokenProvider:(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;)V
     416: aload_1
     417: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     420: ldc           #78                 // String PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTED_KEY
     422: aload         7
     424: invokeinterface #142,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     429: return
    Exception table:
       from    to  target type
          37    44    47   Class java/security/NoSuchAlgorithmException

  private void setupKerberosKey(org.apache.xml.security.stax.impl.OutputProcessorChainImpl, org.apache.wss4j.stax.ext.WSSSecurityProperties, boolean, boolean) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: ldc           #170                // String PROP_USE_THIS_TOKEN_ID_FOR_KERBEROS
       4: invokespecial #105                // Method getOutboundSecurityToken:(Lorg/apache/xml/security/stax/impl/OutputProcessorChainImpl;Ljava/lang/String;)Lorg/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken;
       7: astore        5
       9: aconst_null
      10: astore        6
      12: aload         5
      14: ifnonnull     85
      17: aconst_null
      18: invokestatic  #135                // Method org/apache/xml/security/stax/impl/util/IDGenerator.generateID:(Ljava/lang/String;)Ljava/lang/String;
      21: astore        7
      23: aload         7
      25: astore        6
      27: new           #171                // class org/apache/wss4j/stax/impl/securityToken/KerberosClientSecurityToken
      30: dup
      31: aload_2
      32: invokevirtual #111                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      35: aload         7
      37: invokespecial #172                // Method org/apache/wss4j/stax/impl/securityToken/KerberosClientSecurityToken."<init>":(Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;)V
      40: astore        8
      42: new           #173                // class org/apache/wss4j/stax/setup/OutboundWSSec$4
      45: dup
      46: aload_0
      47: aload         8
      49: aload         7
      51: invokespecial #174                // Method org/apache/wss4j/stax/setup/OutboundWSSec$4."<init>":(Lorg/apache/wss4j/stax/setup/OutboundWSSec;Lorg/apache/wss4j/stax/impl/securityToken/KerberosClientSecurityToken;Ljava/lang/String;)V
      54: astore        9
      56: aload_1
      57: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      60: aload         7
      62: aload         9
      64: invokeinterface #141,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.registerSecurityTokenProvider:(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;)V
      69: aload_1
      70: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      73: ldc           #170                // String PROP_USE_THIS_TOKEN_ID_FOR_KERBEROS
      75: aload         7
      77: invokeinterface #142,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
      82: goto          92
      85: aload         5
      87: invokevirtual #175                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.getId:()Ljava/lang/String;
      90: astore        6
      92: iload_3
      93: ifeq          109
      96: aload_1
      97: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     100: ldc           #74                 // String PROP_USE_THIS_TOKEN_ID_FOR_SIGNATURE
     102: aload         6
     104: invokeinterface #142,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     109: iload         4
     111: ifeq          127
     114: aload_1
     115: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     118: ldc           #79                 // String PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTION
     120: aload         6
     122: invokeinterface #142,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     127: return

  private org.apache.xml.security.stax.impl.securityToken.GenericOutboundSecurityToken getOutboundSecurityToken(org.apache.xml.security.stax.impl.OutputProcessorChainImpl, java.lang.String) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_1
       1: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
       4: aload_2
       5: invokeinterface #75,  2           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.get:(Ljava/lang/String;)Ljava/lang/Object;
      10: checkcast     #76                 // class java/lang/String
      13: astore_3
      14: aconst_null
      15: astore        4
      17: aload_3
      18: ifnull        49
      21: aload_1
      22: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      25: aload_3
      26: invokeinterface #176,  2          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.getSecurityTokenProvider:(Ljava/lang/String;)Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;
      31: astore        4
      33: aload         4
      35: ifnull        49
      38: aload         4
      40: invokeinterface #177,  1          // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
      45: checkcast     #136                // class org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken
      48: areturn
      49: aconst_null
      50: areturn

  private java.security.cert.X509Certificate getReqSigCert(org.apache.xml.security.stax.ext.SecurityContext) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_1
       1: ldc_w         #7                  // class org/apache/xml/security/stax/securityEvent/SecurityEvent
       4: invokeinterface #178,  2          // InterfaceMethod org/apache/xml/security/stax/ext/SecurityContext.getAsList:(Ljava/lang/Object;)Ljava/util/List;
       9: astore_2
      10: aload_2
      11: ifnull        111
      14: iconst_0
      15: istore_3
      16: iload_3
      17: aload_2
      18: invokeinterface #179,  1          // InterfaceMethod java/util/List.size:()I
      23: if_icmpge     111
      26: aload_2
      27: iload_3
      28: invokeinterface #180,  2          // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      33: checkcast     #7                  // class org/apache/xml/security/stax/securityEvent/SecurityEvent
      36: astore        4
      38: aload         4
      40: instanceof    #181                // class org/apache/xml/security/stax/securityEvent/TokenSecurityEvent
      43: ifeq          105
      46: aload         4
      48: checkcast     #181                // class org/apache/xml/security/stax/securityEvent/TokenSecurityEvent
      51: astore        5
      53: aload         5
      55: invokevirtual #182                // Method org/apache/xml/security/stax/securityEvent/TokenSecurityEvent.getSecurityToken:()Lorg/apache/xml/security/stax/securityToken/SecurityToken;
      58: invokeinterface #183,  1          // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityToken.getTokenUsages:()Ljava/util/List;
      63: getstatic     #184                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.TokenUsage_MainSignature:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenUsage;
      66: invokeinterface #185,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      71: ifne          77
      74: goto          105
      77: aload         5
      79: invokevirtual #182                // Method org/apache/xml/security/stax/securityEvent/TokenSecurityEvent.getSecurityToken:()Lorg/apache/xml/security/stax/securityToken/SecurityToken;
      82: invokeinterface #186,  1          // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityToken.getX509Certificates:()[Ljava/security/cert/X509Certificate;
      87: astore        6
      89: aload         6
      91: ifnull        105
      94: aload         6
      96: arraylength
      97: ifle          105
     100: aload         6
     102: iconst_0
     103: aaload
     104: areturn
     105: iinc          3, 1
     108: goto          16
     111: aconst_null
     112: areturn

  private void setDerivedIdentifier(org.apache.xml.security.stax.impl.OutputProcessorChainImpl, java.lang.String);
    Code:
       0: aload_0
       1: getfield      #2                  // Field securityProperties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
       4: invokevirtual #19                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getDerivedKeyTokenReference:()Lorg/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference;
       7: astore_3
       8: getstatic     #187                // Field org/apache/wss4j/stax/setup/OutboundWSSec$5.$SwitchMap$org$apache$wss4j$stax$ext$WSSConstants$DerivedKeyTokenReference:[I
      11: aload_3
      12: invokevirtual #188                // Method org/apache/wss4j/stax/ext/WSSConstants$DerivedKeyTokenReference.ordinal:()I
      15: iaload
      16: tableswitch   { // 1 to 3
                     1: 44
                     2: 59
                     3: 103
               default: 115
          }
      44: aload_1
      45: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      48: ldc           #189                // String PROP_USE_THIS_TOKEN_ID_FOR_DERIVED_KEY
      50: aload_2
      51: invokeinterface #142,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
      56: goto          115
      59: aload_1
      60: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      63: ldc           #79                 // String PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTION
      65: invokeinterface #75,  2           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.get:(Ljava/lang/String;)Ljava/lang/Object;
      70: checkcast     #76                 // class java/lang/String
      73: astore        4
      75: aload_1
      76: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      79: ldc           #189                // String PROP_USE_THIS_TOKEN_ID_FOR_DERIVED_KEY
      81: aload         4
      83: invokeinterface #142,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
      88: aload_1
      89: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      92: ldc           #78                 // String PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTED_KEY
      94: aload_2
      95: invokeinterface #142,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     100: goto          115
     103: aload_1
     104: invokevirtual #73                 // Method org/apache/xml/security/stax/impl/OutputProcessorChainImpl.getSecurityContext:()Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     107: ldc           #190                // String PROP_USE_THIS_TOKEN_ID_FOR_SECURITYCONTEXTTOKEN
     109: aload_2
     110: invokeinterface #142,  3          // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     115: return
}
