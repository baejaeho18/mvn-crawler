Compiled from "EncryptionDerivedAction.java"
public class org.apache.wss4j.dom.action.EncryptionDerivedAction extends org.apache.wss4j.dom.action.AbstractDerivedAction implements org.apache.wss4j.dom.action.Action {
  public org.apache.wss4j.dom.action.EncryptionDerivedAction();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/wss4j/dom/action/AbstractDerivedAction."<init>":()V
       4: return

  public void execute(org.apache.wss4j.dom.handler.WSHandler, org.apache.wss4j.common.SecurityActionToken, org.w3c.dom.Document, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload         4
       2: invokevirtual #2                  // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
       5: astore        5
       7: aload         5
       9: ifnonnull     20
      12: aload_1
      13: aload         4
      15: invokevirtual #3                  // Method org/apache/wss4j/dom/handler/WSHandler.getPasswordCallbackHandler:(Lorg/apache/wss4j/dom/handler/RequestData;)Ljavax/security/auth/callback/CallbackHandler;
      18: astore        5
      20: aconst_null
      21: astore        6
      23: aload_2
      24: instanceof    #4                  // class org/apache/wss4j/common/EncryptionActionToken
      27: ifeq          36
      30: aload_2
      31: checkcast     #4                  // class org/apache/wss4j/common/EncryptionActionToken
      34: astore        6
      36: aload         6
      38: ifnonnull     48
      41: aload         4
      43: invokevirtual #5                  // Method org/apache/wss4j/dom/handler/RequestData.getEncryptionToken:()Lorg/apache/wss4j/common/EncryptionActionToken;
      46: astore        6
      48: aload_1
      49: aload         6
      51: invokevirtual #6                  // Method org/apache/wss4j/common/EncryptionActionToken.getUser:()Ljava/lang/String;
      54: ldc           #7                  // int 65536
      56: aload         5
      58: aload         4
      60: invokevirtual #8                  // Method org/apache/wss4j/dom/handler/WSHandler.getPasswordCB:(Ljava/lang/String;ILjavax/security/auth/callback/CallbackHandler;Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/apache/wss4j/common/ext/WSPasswordCallback;
      63: astore        7
      65: new           #9                  // class org/apache/wss4j/dom/message/WSSecDKEncrypt
      68: dup
      69: invokespecial #10                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt."<init>":()V
      72: astore        8
      74: aload         8
      76: aload         4
      78: invokevirtual #11                 // Method org/apache/wss4j/dom/handler/RequestData.getWssConfig:()Lorg/apache/wss4j/dom/engine/WSSConfig;
      81: invokevirtual #12                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      84: invokevirtual #13                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      87: aload         6
      89: invokevirtual #14                 // Method org/apache/wss4j/common/EncryptionActionToken.getKeyIdentifierId:()I
      92: ifeq          105
      95: aload         8
      97: aload         6
      99: invokevirtual #14                 // Method org/apache/wss4j/common/EncryptionActionToken.getKeyIdentifierId:()I
     102: invokevirtual #15                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setKeyIdentifierType:(I)V
     105: aload         6
     107: invokevirtual #16                 // Method org/apache/wss4j/common/EncryptionActionToken.getSymmetricAlgorithm:()Ljava/lang/String;
     110: ifnull        123
     113: aload         8
     115: aload         6
     117: invokevirtual #16                 // Method org/apache/wss4j/common/EncryptionActionToken.getSymmetricAlgorithm:()Ljava/lang/String;
     120: invokevirtual #17                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setSymmetricEncAlgorithm:(Ljava/lang/String;)V
     123: aload         8
     125: aload         6
     127: invokevirtual #6                  // Method org/apache/wss4j/common/EncryptionActionToken.getUser:()Ljava/lang/String;
     130: aload         7
     132: invokevirtual #18                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
     135: invokevirtual #19                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
     138: aload         4
     140: invokevirtual #20                 // Method org/apache/wss4j/dom/handler/RequestData.isUse200512Namespace:()Z
     143: ifeq          155
     146: aload         8
     148: iconst_2
     149: invokevirtual #21                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setWscVersion:(I)V
     152: goto          161
     155: aload         8
     157: iconst_1
     158: invokevirtual #21                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setWscVersion:(I)V
     161: aload         6
     163: invokevirtual #22                 // Method org/apache/wss4j/common/EncryptionActionToken.getDerivedKeyLength:()I
     166: ifle          179
     169: aload         8
     171: aload         6
     173: invokevirtual #22                 // Method org/apache/wss4j/common/EncryptionActionToken.getDerivedKeyLength:()I
     176: invokevirtual #23                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setDerivedKeyLength:(I)V
     179: aload_0
     180: aload         4
     182: aload         6
     184: aload         8
     186: aload         7
     188: aload_3
     189: invokespecial #24                 // Method setupTokenReference:(Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/common/EncryptionActionToken;Lorg/apache/wss4j/dom/message/WSSecDKEncrypt;Lorg/apache/wss4j/common/ext/WSPasswordCallback;Lorg/w3c/dom/Document;)Lorg/w3c/dom/Element;
     192: astore        9
     194: aload         8
     196: aload         4
     198: invokevirtual #25                 // Method org/apache/wss4j/dom/handler/RequestData.getAttachmentCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     201: invokevirtual #26                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setAttachmentCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
     204: aload         8
     206: aload         4
     208: invokevirtual #27                 // Method org/apache/wss4j/dom/handler/RequestData.isStoreBytesInAttachment:()Z
     211: invokevirtual #28                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setStoreBytesInAttachment:(Z)V
     214: aload         6
     216: invokevirtual #29                 // Method org/apache/wss4j/common/EncryptionActionToken.getParts:()Ljava/util/List;
     219: astore        10
     221: aload         10
     223: ifnull        252
     226: aload         10
     228: invokeinterface #30,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     233: ifne          252
     236: aload         8
     238: invokevirtual #31                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.getParts:()Ljava/util/List;
     241: aload         10
     243: invokeinterface #32,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     248: pop
     249: goto          267
     252: aload         8
     254: invokevirtual #31                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.getParts:()Ljava/util/List;
     257: aload_3
     258: invokestatic  #33                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.getDefaultEncryptionPart:(Lorg/w3c/dom/Document;)Lorg/apache/wss4j/common/WSEncryptionPart;
     261: invokeinterface #34,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     266: pop
     267: aload         8
     269: aload_3
     270: invokevirtual #35                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.prepare:(Lorg/w3c/dom/Document;)V
     273: aload         8
     275: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.encrypt:()Lorg/w3c/dom/Element;
     278: astore        11
     280: aconst_null
     281: astore        12
     283: aload         9
     285: ifnonnull     312
     288: ldc           #37                 // String EncryptedKey
     290: aload         6
     292: invokevirtual #38                 // Method org/apache/wss4j/common/EncryptionActionToken.getDerivedKeyTokenReference:()Ljava/lang/String;
     295: invokevirtual #39                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     298: ifeq          312
     301: aload_0
     302: aload         4
     304: invokevirtual #40                 // Method findEncryptedKeySibling:(Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/w3c/dom/Node;
     307: astore        12
     309: goto          338
     312: aload         9
     314: ifnonnull     338
     317: ldc           #41                 // String SecurityContextToken
     319: aload         6
     321: invokevirtual #38                 // Method org/apache/wss4j/common/EncryptionActionToken.getDerivedKeyTokenReference:()Ljava/lang/String;
     324: invokevirtual #39                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     327: ifeq          338
     330: aload_0
     331: aload         4
     333: invokevirtual #42                 // Method findSCTSibling:(Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/w3c/dom/Node;
     336: astore        12
     338: aload         12
     340: ifnonnull     356
     343: aload         8
     345: aload         4
     347: invokevirtual #43                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     350: invokevirtual #44                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.prependDKElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     353: goto          377
     356: aload         4
     358: invokevirtual #43                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     361: invokevirtual #45                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     364: aload         8
     366: invokevirtual #46                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.getdktElement:()Lorg/w3c/dom/Element;
     369: aload         12
     371: invokeinterface #47,  3           // InterfaceMethod org/w3c/dom/Element.insertBefore:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     376: pop
     377: aload         8
     379: aload         11
     381: aload         4
     383: invokevirtual #43                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     386: invokevirtual #48                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.addExternalRefElement:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     389: aload         9
     391: ifnull        408
     394: aload         4
     396: invokevirtual #43                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     399: invokevirtual #45                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     402: aload         9
     404: invokestatic  #49                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.prependChildElement:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     407: pop
     408: goto          437
     411: astore        10
     413: new           #50                 // class org/apache/wss4j/common/ext/WSSecurityException
     416: dup
     417: getstatic     #51                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     420: aload         10
     422: ldc           #52                 // String empty
     424: iconst_1
     425: anewarray     #53                 // class java/lang/Object
     428: dup
     429: iconst_0
     430: ldc           #54                 // String Error during Encryption:
     432: aastore
     433: invokespecial #55                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
     436: athrow
     437: return
    Exception table:
       from    to  target type
         214   408   411   Class org/apache/wss4j/common/ext/WSSecurityException

  private org.w3c.dom.Element setupTokenReference(org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.common.EncryptionActionToken, org.apache.wss4j.dom.message.WSSecDKEncrypt, org.apache.wss4j.common.ext.WSPasswordCallback, org.w3c.dom.Document) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #38                 // Method org/apache/wss4j/common/EncryptionActionToken.getDerivedKeyTokenReference:()Ljava/lang/String;
       4: astore        6
       6: ldc           #41                 // String SecurityContextToken
       8: aload         6
      10: invokevirtual #39                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      13: ifeq          35
      16: aload_0
      17: aload_3
      18: aload         4
      20: aload_2
      21: aload_1
      22: invokevirtual #56                 // Method org/apache/wss4j/dom/handler/RequestData.getSignatureToken:()Lorg/apache/wss4j/common/SignatureActionToken;
      25: aload_1
      26: invokevirtual #20                 // Method org/apache/wss4j/dom/handler/RequestData.isUse200512Namespace:()Z
      29: aload         5
      31: invokevirtual #57                 // Method setupSCTReference:(Lorg/apache/wss4j/dom/message/WSSecDerivedKeyBase;Lorg/apache/wss4j/common/ext/WSPasswordCallback;Lorg/apache/wss4j/common/SignatureEncryptionActionToken;Lorg/apache/wss4j/common/SignatureEncryptionActionToken;ZLorg/w3c/dom/Document;)Lorg/w3c/dom/Element;
      34: areturn
      35: aload_0
      36: aload_3
      37: aload         4
      39: aload_2
      40: aload_1
      41: invokevirtual #56                 // Method org/apache/wss4j/dom/handler/RequestData.getSignatureToken:()Lorg/apache/wss4j/common/SignatureActionToken;
      44: aload_1
      45: invokevirtual #20                 // Method org/apache/wss4j/dom/handler/RequestData.isUse200512Namespace:()Z
      48: aload         5
      50: aload_2
      51: invokevirtual #58                 // Method org/apache/wss4j/common/EncryptionActionToken.getKeyTransportAlgorithm:()Ljava/lang/String;
      54: aload_2
      55: invokevirtual #59                 // Method org/apache/wss4j/common/EncryptionActionToken.getMgfAlgorithm:()Ljava/lang/String;
      58: invokevirtual #60                 // Method setupEKReference:(Lorg/apache/wss4j/dom/message/WSSecDerivedKeyBase;Lorg/apache/wss4j/common/ext/WSPasswordCallback;Lorg/apache/wss4j/common/SignatureEncryptionActionToken;Lorg/apache/wss4j/common/SignatureEncryptionActionToken;ZLorg/w3c/dom/Document;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      61: areturn
}
