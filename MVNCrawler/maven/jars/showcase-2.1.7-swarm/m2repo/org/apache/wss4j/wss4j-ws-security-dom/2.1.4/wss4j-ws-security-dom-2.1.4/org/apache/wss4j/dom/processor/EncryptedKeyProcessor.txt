Compiled from "EncryptedKeyProcessor.java"
public class org.apache.wss4j.dom.processor.EncryptedKeyProcessor implements org.apache.wss4j.dom.processor.Processor {
  private static final org.slf4j.Logger LOG;

  public org.apache.wss4j.dom.processor.EncryptedKeyProcessor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult> handleToken(org.w3c.dom.Element, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload_2
       5: invokevirtual #2                  // Method org/apache/wss4j/dom/handler/RequestData.getAlgorithmSuite:()Lorg/apache/wss4j/common/crypto/AlgorithmSuite;
       8: invokevirtual #3                  // Method handleToken:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;Lorg/apache/wss4j/common/crypto/AlgorithmSuite;)Ljava/util/List;
      11: areturn

  public java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult> handleToken(org.w3c.dom.Element, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo, org.apache.wss4j.common.crypto.AlgorithmSuite) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: getstatic     #4                  // Field LOG:Lorg/slf4j/Logger;
       3: invokeinterface #5,  1            // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
       8: ifeq          21
      11: getstatic     #4                  // Field LOG:Lorg/slf4j/Logger;
      14: ldc           #6                  // String Found encrypted key element
      16: invokeinterface #7,  2            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      21: aload_1
      22: aconst_null
      23: ldc           #8                  // String Id
      25: invokeinterface #9,  3            // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      30: astore        5
      32: ldc           #10                 // String
      34: aload         5
      36: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      39: ifne          78
      42: aload_3
      43: aload         5
      45: invokevirtual #12                 // Method org/apache/wss4j/dom/WSDocInfo.getResult:(Ljava/lang/String;)Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;
      48: astore        6
      50: aload         6
      52: ifnull        78
      55: iconst_4
      56: aload         6
      58: ldc           #13                 // String action
      60: invokevirtual #14                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      63: checkcast     #15                 // class java/lang/Integer
      66: invokevirtual #16                 // Method java/lang/Integer.intValue:()I
      69: if_icmpne     78
      72: aload         6
      74: invokestatic  #17                 // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
      77: areturn
      78: aload_2
      79: invokevirtual #18                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      82: ifnonnull     98
      85: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
      88: dup
      89: getstatic     #20                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      92: ldc           #21                 // String noCallback
      94: invokespecial #22                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      97: athrow
      98: aload_1
      99: invokestatic  #23                 // Method org/apache/wss4j/dom/util/X509Util.getEncAlgo:(Lorg/w3c/dom/Node;)Ljava/lang/String;
     102: astore        6
     104: aload         6
     106: ifnonnull     122
     109: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     112: dup
     113: getstatic     #24                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.UNSUPPORTED_ALGORITHM:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     116: ldc           #25                 // String noEncAlgo
     118: invokespecial #22                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     121: athrow
     122: ldc           #26                 // String http://www.w3.org/2001/04/xmlenc#rsa-1_5
     124: aload         6
     126: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     129: ifeq          180
     132: aload_2
     133: invokevirtual #27                 // Method org/apache/wss4j/dom/handler/RequestData.isAllowRSA15KeyTransportAlgorithm:()Z
     136: ifne          180
     139: aload         4
     141: ifnull        159
     144: aload         4
     146: invokevirtual #28                 // Method org/apache/wss4j/common/crypto/AlgorithmSuite.getKeyWrapAlgorithms:()Ljava/util/Set;
     149: ldc           #26                 // String http://www.w3.org/2001/04/xmlenc#rsa-1_5
     151: invokeinterface #29,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
     156: ifne          180
     159: getstatic     #4                  // Field LOG:Lorg/slf4j/Logger;
     162: ldc           #30                 // String The Key transport method does not match the requirement
     164: invokeinterface #7,  2            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     169: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     172: dup
     173: getstatic     #31                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     176: invokespecial #32                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     179: athrow
     180: aload_0
     181: aload_1
     182: aload         6
     184: aload_2
     185: invokevirtual #33                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     188: invokespecial #34                 // Method checkBSPCompliance:(Lorg/w3c/dom/Element;Ljava/lang/String;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     191: aload_1
     192: invokestatic  #35                 // Method org/apache/wss4j/dom/util/EncryptionUtils.getCipherValueFromEncryptedData:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     195: astore        7
     197: aload         7
     199: ifnonnull     215
     202: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     205: dup
     206: getstatic     #31                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     209: ldc           #36                 // String noCipher
     211: invokespecial #22                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     214: athrow
     215: aload_0
     216: aload_1
     217: aload_2
     218: invokespecial #37                 // Method getKeyInfoChildElement:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/w3c/dom/Element;
     221: astore        8
     223: aconst_null
     224: astore        9
     226: aconst_null
     227: astore        10
     229: aload         6
     231: invokestatic  #38                 // Method isSymmetricKeyWrap:(Ljava/lang/String;)Z
     234: istore        11
     236: iload         11
     238: ifne          386
     241: ldc           #39                 // String SecurityTokenReference
     243: aload         8
     245: invokeinterface #40,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
     250: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     253: ifeq          336
     256: ldc           #41                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
     258: aload         8
     260: invokeinterface #42,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
     265: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     268: ifeq          336
     271: new           #43                 // class org/apache/wss4j/dom/str/STRParserParameters
     274: dup
     275: invokespecial #44                 // Method org/apache/wss4j/dom/str/STRParserParameters."<init>":()V
     278: astore        12
     280: aload         12
     282: aload_2
     283: invokevirtual #45                 // Method org/apache/wss4j/dom/str/STRParserParameters.setData:(Lorg/apache/wss4j/dom/handler/RequestData;)V
     286: aload         12
     288: aload_3
     289: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserParameters.setWsDocInfo:(Lorg/apache/wss4j/dom/WSDocInfo;)V
     292: aload         12
     294: aload         8
     296: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserParameters.setStrElement:(Lorg/w3c/dom/Element;)V
     299: new           #48                 // class org/apache/wss4j/dom/str/EncryptedKeySTRParser
     302: dup
     303: invokespecial #49                 // Method org/apache/wss4j/dom/str/EncryptedKeySTRParser."<init>":()V
     306: astore        13
     308: aload         13
     310: aload         12
     312: invokeinterface #50,  2           // InterfaceMethod org/apache/wss4j/dom/str/STRParser.parseSecurityTokenReference:(Lorg/apache/wss4j/dom/str/STRParserParameters;)Lorg/apache/wss4j/dom/str/STRParserResult;
     317: astore        14
     319: aload         14
     321: invokevirtual #51                 // Method org/apache/wss4j/dom/str/STRParserResult.getCertificates:()[Ljava/security/cert/X509Certificate;
     324: astore        9
     326: aload         14
     328: invokevirtual #52                 // Method org/apache/wss4j/dom/str/STRParserResult.getCertificatesReferenceType:()Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;
     331: astore        10
     333: goto          345
     336: aload_0
     337: aload         8
     339: aload_2
     340: invokespecial #53                 // Method getCertificatesFromX509Data:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;)[Ljava/security/cert/X509Certificate;
     343: astore        9
     345: aload         9
     347: ifnull        364
     350: aload         9
     352: arraylength
     353: iconst_1
     354: if_icmplt     364
     357: aload         9
     359: iconst_0
     360: aaload
     361: ifnonnull     386
     364: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     367: dup
     368: getstatic     #20                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     371: ldc           #54                 // String noCertsFound
     373: iconst_1
     374: anewarray     #55                 // class java/lang/Object
     377: dup
     378: iconst_0
     379: ldc           #56                 // String decryption (KeyId)
     381: aastore
     382: invokespecial #57                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     385: athrow
     386: aload         4
     388: ifnull        423
     391: new           #58                 // class org/apache/wss4j/common/crypto/AlgorithmSuiteValidator
     394: dup
     395: aload         4
     397: invokespecial #59                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator."<init>":(Lorg/apache/wss4j/common/crypto/AlgorithmSuite;)V
     400: astore        12
     402: iload         11
     404: ifne          416
     407: aload         12
     409: aload         9
     411: iconst_0
     412: aaload
     413: invokevirtual #60                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkAsymmetricKeyLength:(Ljava/security/cert/X509Certificate;)V
     416: aload         12
     418: aload         6
     420: invokevirtual #61                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkEncryptionKeyWrapAlgorithm:(Ljava/lang/String;)V
     423: aconst_null
     424: astore        12
     426: aconst_null
     427: astore        13
     429: aload_1
     430: ldc           #62                 // String ReferenceList
     432: ldc           #63                 // String http://www.w3.org/2001/04/xmlenc#
     434: invokestatic  #64                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     437: astore        14
     439: aload         7
     441: invokestatic  #65                 // Method org/apache/wss4j/dom/util/EncryptionUtils.getXOPURIFromCipherValue:(Lorg/w3c/dom/Element;)Ljava/lang/String;
     444: astore        15
     446: aload         15
     448: ifnull        472
     451: aload         15
     453: ldc           #66                 // String cid:
     455: invokevirtual #67                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     458: ifeq          472
     461: aload         15
     463: aload_2
     464: invokestatic  #68                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.getBytesFromAttachment:(Ljava/lang/String;Lorg/apache/wss4j/dom/handler/RequestData;)[B
     467: astore        12
     469: goto          479
     472: aload         7
     474: invokestatic  #69                 // Method org/apache/wss4j/dom/util/EncryptionUtils.getDecodedBase64EncodedData:(Lorg/w3c/dom/Element;)[B
     477: astore        12
     479: iload         11
     481: ifeq          500
     484: aload_2
     485: aload_3
     486: aload         8
     488: aload         14
     490: aload         12
     492: invokestatic  #70                 // Method getSymmetricDecryptedBytes:(Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;[B)[B
     495: astore        13
     497: goto          518
     500: aload_2
     501: aload_3
     502: aload         6
     504: aload         12
     506: aload         14
     508: aload_1
     509: aload         9
     511: iconst_0
     512: aaload
     513: invokestatic  #71                 // Method getAsymmetricDecryptedBytes:(Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;Ljava/lang/String;[BLorg/w3c/dom/Element;Lorg/w3c/dom/Element;Ljava/security/cert/X509Certificate;)[B
     516: astore        13
     518: aload_0
     519: aload         14
     521: aload_3
     522: aload         13
     524: aload_2
     525: invokespecial #72                 // Method decryptDataRefs:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/WSDocInfo;[BLorg/apache/wss4j/dom/handler/RequestData;)Ljava/util/List;
     528: astore        16
     530: new           #73                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     533: dup
     534: iconst_4
     535: aload         13
     537: aload         12
     539: aload         16
     541: aload         9
     543: invokespecial #74                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult."<init>":(I[B[BLjava/util/List;[Ljava/security/cert/X509Certificate;)V
     546: astore        17
     548: aload         17
     550: ldc           #75                 // String encrypted-key-transport-method
     552: aload         6
     554: invokevirtual #76                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     557: pop
     558: aload         17
     560: ldc           #77                 // String token-element
     562: aload_1
     563: invokevirtual #76                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     566: pop
     567: aload_1
     568: aconst_null
     569: ldc           #8                  // String Id
     571: invokeinterface #9,  3            // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     576: astore        18
     578: ldc           #10                 // String
     580: aload         18
     582: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     585: ifne          598
     588: aload         17
     590: ldc           #78                 // String id
     592: aload         18
     594: invokevirtual #76                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     597: pop
     598: aload         10
     600: ifnull        613
     603: aload         17
     605: ldc           #79                 // String x509-reference-type
     607: aload         10
     609: invokevirtual #76                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     612: pop
     613: aload_3
     614: aload         17
     616: invokevirtual #80                 // Method org/apache/wss4j/dom/WSDocInfo.addResult:(Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;)V
     619: aload_3
     620: aload_1
     621: invokevirtual #81                 // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;)V
     624: aload         17
     626: invokestatic  #17                 // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
     629: areturn

  private static byte[] getSymmetricDecryptedBytes(org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo, org.w3c.dom.Element, org.w3c.dom.Element, byte[]) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_3
       1: invokestatic  #82                 // Method getFirstDataRefURI:(Lorg/w3c/dom/Element;)Ljava/lang/String;
       4: astore        5
       6: aconst_null
       7: astore        6
       9: aload         5
      11: ifnull        35
      14: aload_3
      15: invokeinterface #83,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
      20: aload_1
      21: aload         5
      23: invokestatic  #84                 // Method org/apache/wss4j/dom/util/EncryptionUtils.findEncryptedDataElement:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/WSDocInfo;Ljava/lang/String;)Lorg/w3c/dom/Element;
      26: astore        7
      28: aload         7
      30: invokestatic  #23                 // Method org/apache/wss4j/dom/util/X509Util.getEncAlgo:(Lorg/w3c/dom/Node;)Ljava/lang/String;
      33: astore        6
      35: aload_2
      36: aload         6
      38: aload_0
      39: invokevirtual #18                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      42: aload         4
      44: invokestatic  #85                 // Method org/apache/wss4j/dom/util/X509Util.getSecretKey:(Lorg/w3c/dom/Element;Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;[B)[B
      47: areturn

  private static byte[] getAsymmetricDecryptedBytes(org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo, java.lang.String, byte[], org.w3c.dom.Element, org.w3c.dom.Element, java.security.cert.X509Certificate) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: invokevirtual #86                 // Method org/apache/wss4j/dom/handler/RequestData.getDecCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
       4: ifnonnull     20
       7: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
      10: dup
      11: getstatic     #20                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      14: ldc           #87                 // String noDecCryptoFile
      16: invokespecial #22                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      19: athrow
      20: aload_2
      21: invokestatic  #88                 // Method org/apache/wss4j/common/util/KeyUtils.getCipherInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
      24: astore        7
      26: aload_0
      27: invokevirtual #86                 // Method org/apache/wss4j/dom/handler/RequestData.getDecCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
      30: aload         6
      32: aload_0
      33: invokevirtual #18                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      36: invokeinterface #89,  3           // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getPrivateKey:(Ljava/security/cert/X509Certificate;Ljavax/security/auth/callback/CallbackHandler;)Ljava/security/PrivateKey;
      41: astore        8
      43: aconst_null
      44: astore        9
      46: ldc           #90                 // String http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p
      48: aload_2
      49: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      52: ifne          64
      55: ldc           #91                 // String http://www.w3.org/2009/xmlenc11#rsa-oaep
      57: aload_2
      58: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      61: ifeq          262
      64: aload         5
      66: invokestatic  #92                 // Method org/apache/wss4j/dom/util/EncryptionUtils.getDigestAlgorithm:(Lorg/w3c/dom/Node;)Ljava/lang/String;
      69: astore        10
      71: ldc           #93                 // String SHA-1
      73: astore        11
      75: aload         10
      77: ifnull        97
      80: ldc           #10                 // String
      82: aload         10
      84: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      87: ifne          97
      90: aload         10
      92: invokestatic  #94                 // Method org/apache/xml/security/algorithms/JCEMapper.translateURItoJCEID:(Ljava/lang/String;)Ljava/lang/String;
      95: astore        11
      97: new           #95                 // class java/security/spec/MGF1ParameterSpec
     100: dup
     101: ldc           #93                 // String SHA-1
     103: invokespecial #96                 // Method java/security/spec/MGF1ParameterSpec."<init>":(Ljava/lang/String;)V
     106: astore        12
     108: ldc           #91                 // String http://www.w3.org/2009/xmlenc11#rsa-oaep
     110: aload_2
     111: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     114: ifeq          217
     117: aload         5
     119: invokestatic  #97                 // Method org/apache/wss4j/dom/util/EncryptionUtils.getMGFAlgorithm:(Lorg/w3c/dom/Node;)Ljava/lang/String;
     122: astore        13
     124: ldc           #98                 // String http://www.w3.org/2009/xmlenc11#mgf1sha224
     126: aload         13
     128: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     131: ifeq          148
     134: new           #95                 // class java/security/spec/MGF1ParameterSpec
     137: dup
     138: ldc           #99                 // String SHA-224
     140: invokespecial #96                 // Method java/security/spec/MGF1ParameterSpec."<init>":(Ljava/lang/String;)V
     143: astore        12
     145: goto          217
     148: ldc           #100                // String http://www.w3.org/2009/xmlenc11#mgf1sha256
     150: aload         13
     152: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     155: ifeq          172
     158: new           #95                 // class java/security/spec/MGF1ParameterSpec
     161: dup
     162: ldc           #101                // String SHA-256
     164: invokespecial #96                 // Method java/security/spec/MGF1ParameterSpec."<init>":(Ljava/lang/String;)V
     167: astore        12
     169: goto          217
     172: ldc           #102                // String http://www.w3.org/2009/xmlenc11#mgf1sha384
     174: aload         13
     176: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     179: ifeq          196
     182: new           #95                 // class java/security/spec/MGF1ParameterSpec
     185: dup
     186: ldc           #103                // String SHA-384
     188: invokespecial #96                 // Method java/security/spec/MGF1ParameterSpec."<init>":(Ljava/lang/String;)V
     191: astore        12
     193: goto          217
     196: ldc           #104                // String http://www.w3.org/2009/xmlenc11#mgf1sha512
     198: aload         13
     200: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     203: ifeq          217
     206: new           #95                 // class java/security/spec/MGF1ParameterSpec
     209: dup
     210: ldc           #105                // String SHA-512
     212: invokespecial #96                 // Method java/security/spec/MGF1ParameterSpec."<init>":(Ljava/lang/String;)V
     215: astore        12
     217: getstatic     #106                // Field javax/crypto/spec/PSource$PSpecified.DEFAULT:Ljavax/crypto/spec/PSource$PSpecified;
     220: astore        13
     222: aload         5
     224: invokestatic  #107                // Method org/apache/wss4j/dom/util/EncryptionUtils.getPSource:(Lorg/w3c/dom/Node;)[B
     227: astore        14
     229: aload         14
     231: ifnull        245
     234: new           #108                // class javax/crypto/spec/PSource$PSpecified
     237: dup
     238: aload         14
     240: invokespecial #109                // Method javax/crypto/spec/PSource$PSpecified."<init>":([B)V
     243: astore        13
     245: new           #110                // class javax/crypto/spec/OAEPParameterSpec
     248: dup
     249: aload         11
     251: ldc           #111                // String MGF1
     253: aload         12
     255: aload         13
     257: invokespecial #112                // Method javax/crypto/spec/OAEPParameterSpec."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/security/spec/AlgorithmParameterSpec;Ljavax/crypto/spec/PSource;)V
     260: astore        9
     262: aload         9
     264: ifnonnull     278
     267: aload         7
     269: iconst_4
     270: aload         8
     272: invokevirtual #113                // Method javax/crypto/Cipher.init:(ILjava/security/Key;)V
     275: goto          288
     278: aload         7
     280: iconst_4
     281: aload         8
     283: aload         9
     285: invokevirtual #114                // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
     288: goto          306
     291: astore        8
     293: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     296: dup
     297: getstatic     #116                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     300: aload         8
     302: invokespecial #117                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     305: athrow
     306: aload_2
     307: invokestatic  #94                 // Method org/apache/xml/security/algorithms/JCEMapper.translateURItoJCEID:(Ljava/lang/String;)Ljava/lang/String;
     310: astore        8
     312: aload         7
     314: aload_3
     315: aload         8
     317: iconst_3
     318: invokevirtual #118                // Method javax/crypto/Cipher.unwrap:([BLjava/lang/String;I)Ljava/security/Key;
     321: invokeinterface #119,  1          // InterfaceMethod java/security/Key.getEncoded:()[B
     326: areturn
     327: astore        8
     329: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     332: dup
     333: getstatic     #116                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     336: aload         8
     338: invokespecial #117                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     341: athrow
     342: astore        8
     344: aload         4
     346: aload_1
     347: invokestatic  #121                // Method getRandomKey:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/WSDocInfo;)[B
     350: areturn
    Exception table:
       from    to  target type
          26   288   291   Class java/lang/Exception
         306   326   327   Class java/lang/IllegalStateException
         306   326   342   Class java/lang/Exception

  private static boolean isSymmetricKeyWrap(java.lang.String);
    Code:
       0: ldc           #122                // String http://www.w3.org/2001/04/xmlenc#kw-aes128
       2: aload_0
       3: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       6: ifne          72
       9: ldc           #123                // String http://www.w3.org/2001/04/xmlenc#kw-aes192
      11: aload_0
      12: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      15: ifne          72
      18: ldc           #124                // String http://www.w3.org/2001/04/xmlenc#kw-aes256
      20: aload_0
      21: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      24: ifne          72
      27: ldc           #125                // String http://www.w3.org/2001/04/xmlenc#kw-tripledes
      29: aload_0
      30: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      33: ifne          72
      36: ldc           #126                // String http://www.w3.org/2001/04/xmldsig-more#kw-camellia128
      38: aload_0
      39: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      42: ifne          72
      45: ldc           #127                // String http://www.w3.org/2001/04/xmldsig-more#kw-camellia192
      47: aload_0
      48: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      51: ifne          72
      54: ldc           #128                // String http://www.w3.org/2001/04/xmldsig-more#kw-camellia256
      56: aload_0
      57: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      60: ifne          72
      63: ldc           #129                // String http://www.w3.org/2007/05/xmldsig-more#kw-seed128
      65: aload_0
      66: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      69: ifeq          76
      72: iconst_1
      73: goto          77
      76: iconst_0
      77: ireturn

  private static byte[] getRandomKey(org.w3c.dom.Element, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: ldc           #130                // String AES
       2: astore_2
       3: bipush        16
       5: istore_3
       6: aload_0
       7: invokestatic  #82                 // Method getFirstDataRefURI:(Lorg/w3c/dom/Element;)Ljava/lang/String;
      10: astore        4
      12: aload         4
      14: ifnull        50
      17: aload_0
      18: invokeinterface #83,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
      23: aload_1
      24: aload         4
      26: invokestatic  #84                 // Method org/apache/wss4j/dom/util/EncryptionUtils.findEncryptedDataElement:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/WSDocInfo;Ljava/lang/String;)Lorg/w3c/dom/Element;
      29: astore        5
      31: aload         5
      33: invokestatic  #23                 // Method org/apache/wss4j/dom/util/X509Util.getEncAlgo:(Lorg/w3c/dom/Node;)Ljava/lang/String;
      36: astore        6
      38: aload         6
      40: invokestatic  #131                // Method org/apache/xml/security/algorithms/JCEMapper.getJCEKeyAlgorithmFromURI:(Ljava/lang/String;)Ljava/lang/String;
      43: astore_2
      44: aload         6
      46: invokestatic  #132                // Method org/apache/wss4j/common/util/KeyUtils.getKeyLength:(Ljava/lang/String;)I
      49: istore_3
      50: aload_2
      51: invokestatic  #133                // Method javax/crypto/KeyGenerator.getInstance:(Ljava/lang/String;)Ljavax/crypto/KeyGenerator;
      54: astore        5
      56: aload         5
      58: iload_3
      59: bipush        8
      61: imul
      62: invokevirtual #134                // Method javax/crypto/KeyGenerator.init:(I)V
      65: aload         5
      67: invokevirtual #135                // Method javax/crypto/KeyGenerator.generateKey:()Ljavax/crypto/SecretKey;
      70: astore        6
      72: aload         6
      74: invokeinterface #136,  1          // InterfaceMethod javax/crypto/SecretKey.getEncoded:()[B
      79: areturn
      80: astore_2
      81: ldc           #130                // String AES
      83: invokestatic  #133                // Method javax/crypto/KeyGenerator.getInstance:(Ljava/lang/String;)Ljavax/crypto/KeyGenerator;
      86: astore_3
      87: aload_3
      88: sipush        128
      91: invokevirtual #134                // Method javax/crypto/KeyGenerator.init:(I)V
      94: aload_3
      95: invokevirtual #135                // Method javax/crypto/KeyGenerator.generateKey:()Ljavax/crypto/SecretKey;
      98: astore        4
     100: aload         4
     102: invokeinterface #136,  1          // InterfaceMethod javax/crypto/SecretKey.getEncoded:()[B
     107: areturn
     108: astore_3
     109: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     112: dup
     113: getstatic     #116                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     116: aload_3
     117: invokespecial #117                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     120: athrow
    Exception table:
       from    to  target type
           0    79    80   Class java/lang/Throwable
          81   107   108   Class java/security/NoSuchAlgorithmException

  private static java.lang.String getFirstDataRefURI(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: ifnull        81
       4: aload_0
       5: invokeinterface #139,  1          // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      10: astore_1
      11: aload_1
      12: ifnull        81
      15: iconst_1
      16: aload_1
      17: invokeinterface #140,  1          // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
      22: if_icmpne     71
      25: ldc           #63                 // String http://www.w3.org/2001/04/xmlenc#
      27: aload_1
      28: invokeinterface #141,  1          // InterfaceMethod org/w3c/dom/Node.getNamespaceURI:()Ljava/lang/String;
      33: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      36: ifeq          71
      39: ldc           #142                // String DataReference
      41: aload_1
      42: invokeinterface #143,  1          // InterfaceMethod org/w3c/dom/Node.getLocalName:()Ljava/lang/String;
      47: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      50: ifeq          71
      53: aload_1
      54: checkcast     #144                // class org/w3c/dom/Element
      57: aconst_null
      58: ldc           #145                // String URI
      60: invokeinterface #9,  3            // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      65: astore_2
      66: aload_2
      67: invokestatic  #146                // Method org/apache/wss4j/common/util/XMLUtils.getIDFromReference:(Ljava/lang/String;)Ljava/lang/String;
      70: areturn
      71: aload_1
      72: invokeinterface #147,  1          // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
      77: astore_1
      78: goto          11
      81: aconst_null
      82: areturn

  private org.w3c.dom.Element getKeyInfoChildElement(org.w3c.dom.Element, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ldc           #148                // String KeyInfo
       3: ldc           #149                // String http://www.w3.org/2000/09/xmldsig#
       5: invokestatic  #64                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
       8: astore_3
       9: aload_3
      10: ifnull        102
      13: aconst_null
      14: astore        4
      16: iconst_0
      17: istore        5
      19: aload_3
      20: invokeinterface #139,  1          // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      25: astore        6
      27: aload         6
      29: ifnull        65
      32: iconst_1
      33: aload         6
      35: invokeinterface #140,  1          // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
      40: if_icmpne     53
      43: iinc          5, 1
      46: aload         6
      48: checkcast     #144                // class org/w3c/dom/Element
      51: astore        4
      53: aload         6
      55: invokeinterface #147,  1          // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
      60: astore        6
      62: goto          27
      65: iload         5
      67: iconst_1
      68: if_icmpeq     81
      71: aload_2
      72: invokevirtual #33                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
      75: getstatic     #150                // Field org/apache/wss4j/common/bsp/BSPRule.R5424:Lorg/apache/wss4j/common/bsp/BSPRule;
      78: invokevirtual #151                // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      81: aload         4
      83: ifnonnull     99
      86: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
      89: dup
      90: getstatic     #31                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      93: ldc           #152                // String noSecTokRef
      95: invokespecial #22                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      98: athrow
      99: aload         4
     101: areturn
     102: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     105: dup
     106: getstatic     #31                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     109: ldc           #153                // String noKeyinfo
     111: invokespecial #22                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     114: athrow

  private java.security.cert.X509Certificate[] getCertificatesFromX509Data(org.w3c.dom.Element, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: ldc           #149                // String http://www.w3.org/2000/09/xmldsig#
       2: aload_1
       3: invokeinterface #42,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
       8: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      11: ifeq          360
      14: ldc           #154                // String X509Data
      16: aload_1
      17: invokeinterface #40,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      22: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      25: ifeq          360
      28: aload_2
      29: invokevirtual #33                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
      32: getstatic     #155                // Field org/apache/wss4j/common/bsp/BSPRule.R5426:Lorg/apache/wss4j/common/bsp/BSPRule;
      35: invokevirtual #151                // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      38: aload_0
      39: aload_1
      40: invokespecial #156                // Method getFirstElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      43: astore_3
      44: aload_3
      45: ifnull        360
      48: ldc           #149                // String http://www.w3.org/2000/09/xmldsig#
      50: aload_3
      51: invokeinterface #42,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      56: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      59: ifeq          360
      62: ldc           #157                // String X509IssuerSerial
      64: aload_3
      65: invokeinterface #40,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      70: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      73: ifeq          125
      76: new           #158                // class org/apache/wss4j/common/token/DOMX509IssuerSerial
      79: dup
      80: aload_3
      81: invokespecial #159                // Method org/apache/wss4j/common/token/DOMX509IssuerSerial."<init>":(Lorg/w3c/dom/Element;)V
      84: astore        4
      86: new           #160                // class org/apache/wss4j/common/crypto/CryptoType
      89: dup
      90: getstatic     #161                // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ISSUER_SERIAL:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
      93: invokespecial #162                // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
      96: astore        5
      98: aload         5
     100: aload         4
     102: invokevirtual #163                // Method org/apache/wss4j/common/token/DOMX509IssuerSerial.getIssuer:()Ljava/lang/String;
     105: aload         4
     107: invokevirtual #164                // Method org/apache/wss4j/common/token/DOMX509IssuerSerial.getSerialNumber:()Ljava/math/BigInteger;
     110: invokevirtual #165                // Method org/apache/wss4j/common/crypto/CryptoType.setIssuerSerial:(Ljava/lang/String;Ljava/math/BigInteger;)V
     113: aload_2
     114: invokevirtual #86                 // Method org/apache/wss4j/dom/handler/RequestData.getDecCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     117: aload         5
     119: invokeinterface #166,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
     124: areturn
     125: ldc           #167                // String X509Certificate
     127: aload_3
     128: invokeinterface #40,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
     133: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     136: ifeq          360
     139: aload_3
     140: invokestatic  #69                 // Method org/apache/wss4j/dom/util/EncryptionUtils.getDecodedBase64EncodedData:(Lorg/w3c/dom/Element;)[B
     143: astore        4
     145: aload         4
     147: ifnonnull     172
     150: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     153: dup
     154: getstatic     #20                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     157: ldc           #168                // String invalidCertData
     159: iconst_1
     160: anewarray     #55                 // class java/lang/Object
     163: dup
     164: iconst_0
     165: ldc           #169                // String 0
     167: aastore
     168: invokespecial #57                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     171: athrow
     172: new           #170                // class java/io/ByteArrayInputStream
     175: dup
     176: aload         4
     178: invokespecial #171                // Method java/io/ByteArrayInputStream."<init>":([B)V
     181: astore        5
     183: aconst_null
     184: astore        6
     186: aload_2
     187: invokevirtual #86                 // Method org/apache/wss4j/dom/handler/RequestData.getDecCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     190: aload         5
     192: invokeinterface #172,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.loadCertificate:(Ljava/io/InputStream;)Ljava/security/cert/X509Certificate;
     197: astore        7
     199: aload         7
     201: ifnull        253
     204: iconst_1
     205: anewarray     #173                // class java/security/cert/X509Certificate
     208: dup
     209: iconst_0
     210: aload         7
     212: aastore
     213: astore        8
     215: aload         5
     217: ifnull        250
     220: aload         6
     222: ifnull        245
     225: aload         5
     227: invokevirtual #174                // Method java/io/InputStream.close:()V
     230: goto          250
     233: astore        9
     235: aload         6
     237: aload         9
     239: invokevirtual #175                // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     242: goto          250
     245: aload         5
     247: invokevirtual #174                // Method java/io/InputStream.close:()V
     250: aload         8
     252: areturn
     253: aload         5
     255: ifnull        340
     258: aload         6
     260: ifnull        283
     263: aload         5
     265: invokevirtual #174                // Method java/io/InputStream.close:()V
     268: goto          340
     271: astore        7
     273: aload         6
     275: aload         7
     277: invokevirtual #175                // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     280: goto          340
     283: aload         5
     285: invokevirtual #174                // Method java/io/InputStream.close:()V
     288: goto          340
     291: astore        7
     293: aload         7
     295: astore        6
     297: aload         7
     299: athrow
     300: astore        10
     302: aload         5
     304: ifnull        337
     307: aload         6
     309: ifnull        332
     312: aload         5
     314: invokevirtual #174                // Method java/io/InputStream.close:()V
     317: goto          337
     320: astore        11
     322: aload         6
     324: aload         11
     326: invokevirtual #175                // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     329: goto          337
     332: aload         5
     334: invokevirtual #174                // Method java/io/InputStream.close:()V
     337: aload         10
     339: athrow
     340: goto          360
     343: astore        5
     345: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     348: dup
     349: getstatic     #177                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     352: aload         5
     354: ldc           #178                // String parseError
     356: invokespecial #179                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     359: athrow
     360: aconst_null
     361: areturn
    Exception table:
       from    to  target type
         225   230   233   Class java/lang/Throwable
         263   268   271   Class java/lang/Throwable
         186   215   291   Class java/lang/Throwable
         186   215   300   any
         312   317   320   Class java/lang/Throwable
         291   302   300   any
         172   250   343   Class java/io/IOException
         253   340   343   Class java/io/IOException

  private org.w3c.dom.Element getFirstElement(org.w3c.dom.Element);
    Code:
       0: aload_1
       1: invokeinterface #139,  1          // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
       6: astore_2
       7: aload_2
       8: ifnull        36
      11: iconst_1
      12: aload_2
      13: invokeinterface #140,  1          // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
      18: if_icmpne     26
      21: aload_2
      22: checkcast     #144                // class org/w3c/dom/Element
      25: areturn
      26: aload_2
      27: invokeinterface #147,  1          // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
      32: astore_2
      33: goto          7
      36: aconst_null
      37: areturn

  private java.util.List<org.apache.wss4j.dom.WSDataRef> decryptDataRefs(org.w3c.dom.Element, org.apache.wss4j.dom.WSDocInfo, byte[], org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnonnull     6
       4: aconst_null
       5: areturn
       6: new           #180                // class java/util/ArrayList
       9: dup
      10: invokespecial #181                // Method java/util/ArrayList."<init>":()V
      13: astore        5
      15: aload_1
      16: invokeinterface #139,  1          // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      21: astore        6
      23: aload         6
      25: ifnull        131
      28: iconst_1
      29: aload         6
      31: invokeinterface #140,  1          // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
      36: if_icmpne     119
      39: ldc           #63                 // String http://www.w3.org/2001/04/xmlenc#
      41: aload         6
      43: invokeinterface #141,  1          // InterfaceMethod org/w3c/dom/Node.getNamespaceURI:()Ljava/lang/String;
      48: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      51: ifeq          119
      54: ldc           #142                // String DataReference
      56: aload         6
      58: invokeinterface #143,  1          // InterfaceMethod org/w3c/dom/Node.getLocalName:()Ljava/lang/String;
      63: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      66: ifeq          119
      69: aload         6
      71: checkcast     #144                // class org/w3c/dom/Element
      74: aconst_null
      75: ldc           #145                // String URI
      77: invokeinterface #9,  3            // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      82: astore        7
      84: aload         7
      86: invokestatic  #146                // Method org/apache/wss4j/common/util/XMLUtils.getIDFromReference:(Ljava/lang/String;)Ljava/lang/String;
      89: astore        7
      91: aload_0
      92: aload_1
      93: invokeinterface #83,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
      98: aload         7
     100: aload_2
     101: aload_3
     102: aload         4
     104: invokespecial #182                // Method decryptDataRef:(Lorg/w3c/dom/Document;Ljava/lang/String;Lorg/apache/wss4j/dom/WSDocInfo;[BLorg/apache/wss4j/dom/handler/RequestData;)Lorg/apache/wss4j/dom/WSDataRef;
     107: astore        8
     109: aload         5
     111: aload         8
     113: invokeinterface #183,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     118: pop
     119: aload         6
     121: invokeinterface #147,  1          // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
     126: astore        6
     128: goto          23
     131: aload         5
     133: areturn

  private org.apache.wss4j.dom.WSDataRef decryptDataRef(org.w3c.dom.Document, java.lang.String, org.apache.wss4j.dom.WSDocInfo, byte[], org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: getstatic     #4                  // Field LOG:Lorg/slf4j/Logger;
       3: invokeinterface #5,  1            // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
       8: ifeq          38
      11: getstatic     #4                  // Field LOG:Lorg/slf4j/Logger;
      14: new           #184                // class java/lang/StringBuilder
      17: dup
      18: invokespecial #185                // Method java/lang/StringBuilder."<init>":()V
      21: ldc           #186                // String found data reference:
      23: invokevirtual #187                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      26: aload_2
      27: invokevirtual #187                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      30: invokevirtual #188                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      33: invokeinterface #7,  2            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      38: aload_1
      39: aload_3
      40: aload_2
      41: invokestatic  #84                 // Method org/apache/wss4j/dom/util/EncryptionUtils.findEncryptedDataElement:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/WSDocInfo;Ljava/lang/String;)Lorg/w3c/dom/Element;
      44: astore        6
      46: aload         6
      48: ifnull        76
      51: aload         5
      53: invokevirtual #189                // Method org/apache/wss4j/dom/handler/RequestData.isRequireSignedEncryptedDataElements:()Z
      56: ifeq          76
      59: aload_3
      60: iconst_2
      61: invokestatic  #190                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      64: invokevirtual #191                // Method org/apache/wss4j/dom/WSDocInfo.getResultsByTag:(Ljava/lang/Integer;)Ljava/util/List;
      67: astore        7
      69: aload         6
      71: aload         7
      73: invokestatic  #192                // Method org/apache/wss4j/dom/util/WSSecurityUtil.verifySignedElement:(Lorg/w3c/dom/Element;Ljava/util/List;)V
      76: aload         6
      78: invokestatic  #23                 // Method org/apache/wss4j/dom/util/X509Util.getEncAlgo:(Lorg/w3c/dom/Node;)Ljava/lang/String;
      81: astore        7
      83: aload         7
      85: ifnonnull     119
      88: getstatic     #4                  // Field LOG:Lorg/slf4j/Logger;
      91: ldc           #193                // String No encryption algorithm was specified in the request
      93: invokeinterface #7,  2            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      98: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     101: dup
     102: getstatic     #24                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.UNSUPPORTED_ALGORITHM:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     105: ldc           #194                // String badEncAlgo
     107: iconst_1
     108: anewarray     #55                 // class java/lang/Object
     111: dup
     112: iconst_0
     113: aconst_null
     114: aastore
     115: invokespecial #57                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     118: athrow
     119: ldc           #195                // String http://www.w3.org/2001/04/xmlenc#tripledes-cbc
     121: aload         7
     123: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     126: ifne          180
     129: ldc           #196                // String http://www.w3.org/2001/04/xmlenc#aes128-cbc
     131: aload         7
     133: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     136: ifne          180
     139: ldc           #197                // String http://www.w3.org/2009/xmlenc11#aes128-gcm
     141: aload         7
     143: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     146: ifne          180
     149: ldc           #198                // String http://www.w3.org/2001/04/xmlenc#aes256-cbc
     151: aload         7
     153: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     156: ifne          180
     159: ldc           #199                // String http://www.w3.org/2009/xmlenc11#aes256-gcm
     161: aload         7
     163: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     166: ifne          180
     169: aload         5
     171: invokevirtual #33                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     174: getstatic     #200                // Field org/apache/wss4j/common/bsp/BSPRule.R5620:Lorg/apache/wss4j/common/bsp/BSPRule;
     177: invokevirtual #151                // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     180: aconst_null
     181: astore        8
     183: aload         7
     185: aload         4
     187: invokestatic  #201                // Method org/apache/wss4j/common/util/KeyUtils.prepareSecretKey:(Ljava/lang/String;[B)Ljavax/crypto/SecretKey;
     190: astore        8
     192: goto          221
     195: astore        9
     197: new           #19                 // class org/apache/wss4j/common/ext/WSSecurityException
     200: dup
     201: getstatic     #24                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.UNSUPPORTED_ALGORITHM:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     204: aload         9
     206: ldc           #194                // String badEncAlgo
     208: iconst_1
     209: anewarray     #55                 // class java/lang/Object
     212: dup
     213: iconst_0
     214: aload         7
     216: aastore
     217: invokespecial #203                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
     220: athrow
     221: aload         5
     223: invokevirtual #2                  // Method org/apache/wss4j/dom/handler/RequestData.getAlgorithmSuite:()Lorg/apache/wss4j/common/crypto/AlgorithmSuite;
     226: astore        9
     228: aload         9
     230: ifnull        264
     233: new           #58                 // class org/apache/wss4j/common/crypto/AlgorithmSuiteValidator
     236: dup
     237: aload         9
     239: invokespecial #59                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator."<init>":(Lorg/apache/wss4j/common/crypto/AlgorithmSuite;)V
     242: astore        10
     244: aload         10
     246: aload         8
     248: invokeinterface #136,  1          // InterfaceMethod javax/crypto/SecretKey.getEncoded:()[B
     253: arraylength
     254: invokevirtual #204                // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkSymmetricKeyLength:(I)V
     257: aload         10
     259: aload         7
     261: invokevirtual #205                // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkSymmetricEncryptionAlgorithm:(Ljava/lang/String;)V
     264: aload_1
     265: aload_2
     266: aload         6
     268: aload         8
     270: aload         7
     272: aload         5
     274: invokevirtual #206                // Method org/apache/wss4j/dom/handler/RequestData.getAttachmentCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     277: invokestatic  #207                // Method org/apache/wss4j/dom/util/EncryptionUtils.decryptEncryptedData:(Lorg/w3c/dom/Document;Ljava/lang/String;Lorg/w3c/dom/Element;Ljavax/crypto/SecretKey;Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)Lorg/apache/wss4j/dom/WSDataRef;
     280: areturn
    Exception table:
       from    to  target type
         183   192   195   Class java/lang/IllegalArgumentException

  private void checkBSPCompliance(org.w3c.dom.Element, java.lang.String, org.apache.wss4j.common.bsp.BSPEnforcer) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: aconst_null
       2: ldc           #208                // String Type
       4: invokeinterface #9,  3            // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
       9: astore        4
      11: aload         4
      13: ifnull        33
      16: ldc           #10                 // String
      18: aload         4
      20: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      23: ifne          33
      26: aload_3
      27: getstatic     #209                // Field org/apache/wss4j/common/bsp/BSPRule.R3209:Lorg/apache/wss4j/common/bsp/BSPRule;
      30: invokevirtual #151                // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      33: aload_1
      34: aconst_null
      35: ldc           #210                // String MimeType
      37: invokeinterface #9,  3            // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      42: astore        4
      44: aload         4
      46: ifnull        66
      49: ldc           #10                 // String
      51: aload         4
      53: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      56: ifne          66
      59: aload_3
      60: getstatic     #211                // Field org/apache/wss4j/common/bsp/BSPRule.R5622:Lorg/apache/wss4j/common/bsp/BSPRule;
      63: invokevirtual #151                // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      66: aload_1
      67: aconst_null
      68: ldc           #212                // String Encoding
      70: invokeinterface #9,  3            // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      75: astore        4
      77: aload         4
      79: ifnull        99
      82: ldc           #10                 // String
      84: aload         4
      86: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      89: ifne          99
      92: aload_3
      93: getstatic     #213                // Field org/apache/wss4j/common/bsp/BSPRule.R5623:Lorg/apache/wss4j/common/bsp/BSPRule;
      96: invokevirtual #151                // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      99: aload_1
     100: aconst_null
     101: ldc           #214                // String Recipient
     103: invokeinterface #9,  3            // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     108: astore        4
     110: aload         4
     112: ifnull        132
     115: ldc           #10                 // String
     117: aload         4
     119: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     122: ifne          132
     125: aload_3
     126: getstatic     #215                // Field org/apache/wss4j/common/bsp/BSPRule.R5602:Lorg/apache/wss4j/common/bsp/BSPRule;
     129: invokevirtual #151                // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     132: ldc           #26                 // String http://www.w3.org/2001/04/xmlenc#rsa-1_5
     134: aload_2
     135: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     138: ifne          166
     141: ldc           #90                 // String http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p
     143: aload_2
     144: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     147: ifne          166
     150: ldc           #91                 // String http://www.w3.org/2009/xmlenc11#rsa-oaep
     152: aload_2
     153: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     156: ifne          166
     159: aload_3
     160: getstatic     #216                // Field org/apache/wss4j/common/bsp/BSPRule.R5621:Lorg/apache/wss4j/common/bsp/BSPRule;
     163: invokevirtual #151                // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     166: return

  static {};
    Code:
       0: ldc_w         #217                // class org/apache/wss4j/dom/processor/EncryptedKeyProcessor
       3: invokestatic  #218                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #4                  // Field LOG:Lorg/slf4j/Logger;
       9: return
}
