Compiled from "WSSecEncrypt.java"
public class org.apache.wss4j.dom.message.WSSecEncrypt extends org.apache.wss4j.dom.message.WSSecEncryptedKey {
  private static final org.slf4j.Logger LOG;

  private org.apache.wss4j.common.token.SecurityTokenReference securityTokenReference;

  private boolean encryptSymmKey;

  private java.lang.String customReferenceValue;

  private boolean encKeyIdDirectId;

  private boolean embedEncryptedKey;

  private java.util.List<org.w3c.dom.Element> attachmentEncryptedDataElements;

  public org.apache.wss4j.dom.message.WSSecEncrypt();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/wss4j/dom/message/WSSecEncryptedKey."<init>":()V
       4: aload_0
       5: iconst_1
       6: putfield      #2                  // Field encryptSymmKey:Z
       9: return

  public void prepare(org.w3c.dom.Document, org.apache.wss4j.common.crypto.Crypto) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #3                  // Field document:Lorg/w3c/dom/Document;
       5: aload_0
       6: new           #4                  // class java/util/ArrayList
       9: dup
      10: invokespecial #5                  // Method java/util/ArrayList."<init>":()V
      13: putfield      #6                  // Field attachmentEncryptedDataElements:Ljava/util/List;
      16: aload_0
      17: getfield      #7                  // Field symmetricKey:Ljavax/crypto/SecretKey;
      20: ifnonnull     64
      23: aload_0
      24: invokevirtual #8                  // Method getEphemeralKey:()[B
      27: ifnull        48
      30: aload_0
      31: aload_0
      32: invokevirtual #9                  // Method getSymmetricEncAlgorithm:()Ljava/lang/String;
      35: aload_0
      36: invokevirtual #8                  // Method getEphemeralKey:()[B
      39: invokestatic  #10                 // Method org/apache/wss4j/common/util/KeyUtils.prepareSecretKey:(Ljava/lang/String;[B)Ljavax/crypto/SecretKey;
      42: putfield      #7                  // Field symmetricKey:Ljavax/crypto/SecretKey;
      45: goto          64
      48: aload_0
      49: invokevirtual #9                  // Method getSymmetricEncAlgorithm:()Ljava/lang/String;
      52: invokestatic  #11                 // Method org/apache/wss4j/common/util/KeyUtils.getKeyGenerator:(Ljava/lang/String;)Ljavax/crypto/KeyGenerator;
      55: astore_3
      56: aload_0
      57: aload_3
      58: invokevirtual #12                 // Method javax/crypto/KeyGenerator.generateKey:()Ljavax/crypto/SecretKey;
      61: putfield      #7                  // Field symmetricKey:Ljavax/crypto/SecretKey;
      64: aload_0
      65: getfield      #2                  // Field encryptSymmKey:Z
      68: ifeq          212
      71: aload_0
      72: getfield      #13                 // Field encryptedEphemeralKey:[B
      75: ifnonnull     212
      78: aload_0
      79: invokevirtual #14                 // Method getUseThisCert:()Ljava/security/cert/X509Certificate;
      82: astore_3
      83: aload_3
      84: ifnonnull     199
      87: aconst_null
      88: astore        4
      90: aload_0
      91: getfield      #15                 // Field keyIdentifierType:I
      94: bipush        14
      96: if_icmpne     123
      99: new           #16                 // class org/apache/wss4j/common/crypto/CryptoType
     102: dup
     103: getstatic     #17                 // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ENDPOINT:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
     106: invokespecial #18                 // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
     109: astore        4
     111: aload         4
     113: aload_0
     114: getfield      #19                 // Field user:Ljava/lang/String;
     117: invokevirtual #20                 // Method org/apache/wss4j/common/crypto/CryptoType.setEndpoint:(Ljava/lang/String;)V
     120: goto          144
     123: new           #16                 // class org/apache/wss4j/common/crypto/CryptoType
     126: dup
     127: getstatic     #21                 // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ALIAS:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
     130: invokespecial #18                 // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
     133: astore        4
     135: aload         4
     137: aload_0
     138: getfield      #19                 // Field user:Ljava/lang/String;
     141: invokevirtual #22                 // Method org/apache/wss4j/common/crypto/CryptoType.setAlias:(Ljava/lang/String;)V
     144: aload_2
     145: aload         4
     147: invokeinterface #23,  2           // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
     152: astore        5
     154: aload         5
     156: ifnull        165
     159: aload         5
     161: arraylength
     162: ifgt          194
     165: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
     168: dup
     169: getstatic     #25                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     172: ldc           #26                 // String noUserCertsFound
     174: iconst_2
     175: anewarray     #27                 // class java/lang/Object
     178: dup
     179: iconst_0
     180: aload_0
     181: getfield      #19                 // Field user:Ljava/lang/String;
     184: aastore
     185: dup
     186: iconst_1
     187: ldc           #28                 // String encryption
     189: aastore
     190: invokespecial #29                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     193: athrow
     194: aload         5
     196: iconst_0
     197: aaload
     198: astore_3
     199: aload_0
     200: aload_0
     201: getfield      #7                  // Field symmetricKey:Ljavax/crypto/SecretKey;
     204: aload_3
     205: aload_2
     206: invokevirtual #30                 // Method prepareInternal:(Ljavax/crypto/SecretKey;Ljava/security/cert/X509Certificate;Lorg/apache/wss4j/common/crypto/Crypto;)V
     209: goto          243
     212: aload_0
     213: getfield      #13                 // Field encryptedEphemeralKey:[B
     216: ifnull        230
     219: aload_0
     220: aload_0
     221: getfield      #7                  // Field symmetricKey:Ljavax/crypto/SecretKey;
     224: invokevirtual #31                 // Method prepareInternal:(Ljavax/crypto/SecretKey;)V
     227: goto          243
     230: aload_0
     231: aload_0
     232: getfield      #7                  // Field symmetricKey:Ljavax/crypto/SecretKey;
     235: invokeinterface #32,  1           // InterfaceMethod javax/crypto/SecretKey.getEncoded:()[B
     240: putfield      #13                 // Field encryptedEphemeralKey:[B
     243: return

  public org.w3c.dom.Document build(org.w3c.dom.Document, org.apache.wss4j.common.crypto.Crypto, org.apache.wss4j.dom.message.WSSecHeader) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
       4: invokeinterface #34,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
       9: putfield      #35                 // Field doDebug:Z
      12: aload_0
      13: aload_1
      14: aload_2
      15: invokevirtual #36                 // Method prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;)V
      18: aload_0
      19: getfield      #35                 // Field doDebug:Z
      22: ifeq          35
      25: getstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
      28: ldc           #37                 // String Beginning Encryption...
      30: invokeinterface #38,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      35: aload_0
      36: invokevirtual #39                 // Method encrypt:()Lorg/w3c/dom/Element;
      39: astore        4
      41: aload_0
      42: aload_3
      43: invokevirtual #40                 // Method addAttachmentEncryptedDataElements:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
      46: aload_0
      47: invokevirtual #41                 // Method getEncryptedKeyElement:()Lorg/w3c/dom/Element;
      50: ifnull        67
      53: aload_0
      54: aload         4
      56: invokevirtual #42                 // Method addInternalRefElement:(Lorg/w3c/dom/Element;)V
      59: aload_0
      60: aload_3
      61: invokevirtual #43                 // Method prependToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
      64: goto          74
      67: aload_0
      68: aload         4
      70: aload_3
      71: invokevirtual #44                 // Method addExternalRefElement:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
      74: aload_0
      75: aload_3
      76: invokevirtual #45                 // Method prependBSTElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
      79: aload_0
      80: invokevirtual #46                 // Method clean:()V
      83: getstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
      86: ldc           #47                 // String Encryption complete.
      88: invokeinterface #38,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      93: aload_1
      94: areturn

  public org.w3c.dom.Element encrypt() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: invokevirtual #48                 // Method getParts:()Ljava/util/List;
       4: invokeinterface #49,  1           // InterfaceMethod java/util/List.isEmpty:()Z
       9: ifeq          29
      12: aload_0
      13: invokevirtual #48                 // Method getParts:()Ljava/util/List;
      16: aload_0
      17: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
      20: invokestatic  #50                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.getDefaultEncryptionPart:(Lorg/w3c/dom/Document;)Lorg/apache/wss4j/common/WSEncryptionPart;
      23: invokeinterface #51,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      28: pop
      29: aload_0
      30: aconst_null
      31: aload_0
      32: invokevirtual #48                 // Method getParts:()Ljava/util/List;
      35: invokevirtual #52                 // Method encryptForRef:(Lorg/w3c/dom/Element;Ljava/util/List;)Lorg/w3c/dom/Element;
      38: areturn

  public org.w3c.dom.Element encryptForRef(org.w3c.dom.Element, java.util.List<org.apache.wss4j.common.WSEncryptionPart>) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: invokespecial #53                 // Method createKeyInfo:()Lorg/apache/xml/security/keys/KeyInfo;
       4: astore_3
       5: new           #54                 // class javax/crypto/spec/SecretKeySpec
       8: dup
       9: aload_0
      10: getfield      #7                  // Field symmetricKey:Ljavax/crypto/SecretKey;
      13: invokeinterface #32,  1           // InterfaceMethod javax/crypto/SecretKey.getEncoded:()[B
      18: aload_0
      19: getfield      #7                  // Field symmetricKey:Ljavax/crypto/SecretKey;
      22: invokeinterface #55,  1           // InterfaceMethod javax/crypto/SecretKey.getAlgorithm:()Ljava/lang/String;
      27: invokespecial #56                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      30: astore        4
      32: aload_0
      33: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
      36: aload_0
      37: invokevirtual #57                 // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      40: aload_3
      41: aload         4
      43: aload_0
      44: invokevirtual #9                  // Method getSymmetricEncAlgorithm:()Ljava/lang/String;
      47: aload_2
      48: aload_0
      49: getfield      #58                 // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      52: aload_0
      53: getfield      #59                 // Field attachmentCallbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      56: aload_0
      57: getfield      #6                  // Field attachmentEncryptedDataElements:Ljava/util/List;
      60: aload_0
      61: getfield      #60                 // Field storeBytesInAttachment:Z
      64: invokestatic  #61                 // Method doEncryption:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/WsuIdAllocator;Lorg/apache/xml/security/keys/KeyInfo;Ljavax/crypto/SecretKey;Ljava/lang/String;Ljava/util/List;Lorg/apache/wss4j/dom/callback/CallbackLookup;Ljavax/security/auth/callback/CallbackHandler;Ljava/util/List;Z)Ljava/util/List;
      67: astore        5
      69: aload         5
      71: invokeinterface #49,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      76: ifeq          81
      79: aconst_null
      80: areturn
      81: aload_1
      82: ifnonnull     115
      85: aload_0
      86: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
      89: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
      91: ldc           #63                 // String xenc:ReferenceList
      93: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      98: astore_1
      99: aload_0
     100: getfield      #2                  // Field encryptSymmKey:Z
     103: ifne          115
     106: aload_1
     107: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
     109: ldc           #65                 // String xenc
     111: invokestatic  #66                 // Method org/apache/wss4j/common/util/XMLUtils.setNamespace:(Lorg/w3c/dom/Element;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     114: pop
     115: aload_0
     116: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
     119: aload_1
     120: aload         5
     122: invokestatic  #67                 // Method createDataRefList:(Lorg/w3c/dom/Document;Lorg/w3c/dom/Element;Ljava/util/List;)Lorg/w3c/dom/Element;
     125: areturn

  public void addInternalRefElement(org.w3c.dom.Element);
    Code:
       0: aload_1
       1: ifnull        15
       4: aload_0
       5: invokevirtual #41                 // Method getEncryptedKeyElement:()Lorg/w3c/dom/Element;
       8: aload_1
       9: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      14: pop
      15: return

  public void addExternalRefElement(org.w3c.dom.Element, org.apache.wss4j.dom.message.WSSecHeader);
    Code:
       0: aload_1
       1: ifnull        13
       4: aload_2
       5: invokevirtual #69                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
       8: aload_1
       9: invokestatic  #70                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.prependChildElement:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      12: pop
      13: return

  public void addAttachmentEncryptedDataElements(org.apache.wss4j.dom.message.WSSecHeader);
    Code:
       0: aload_0
       1: getfield      #6                  // Field attachmentEncryptedDataElements:Ljava/util/List;
       4: ifnull        51
       7: iconst_0
       8: istore_2
       9: iload_2
      10: aload_0
      11: getfield      #6                  // Field attachmentEncryptedDataElements:Ljava/util/List;
      14: invokeinterface #71,  1           // InterfaceMethod java/util/List.size:()I
      19: if_icmpge     51
      22: aload_0
      23: getfield      #6                  // Field attachmentEncryptedDataElements:Ljava/util/List;
      26: iload_2
      27: invokeinterface #72,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      32: checkcast     #73                 // class org/w3c/dom/Element
      35: astore_3
      36: aload_1
      37: invokevirtual #69                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      40: aload_3
      41: invokestatic  #70                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.prependChildElement:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      44: pop
      45: iinc          2, 1
      48: goto          9
      51: return

  public static java.util.List<java.lang.String> doEncryption(org.w3c.dom.Document, org.apache.wss4j.dom.WsuIdAllocator, org.apache.xml.security.keys.KeyInfo, javax.crypto.SecretKey, java.lang.String, java.util.List<org.apache.wss4j.common.WSEncryptionPart>, org.apache.wss4j.dom.callback.CallbackLookup) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: aload         5
       8: aload         6
      10: aconst_null
      11: aconst_null
      12: iconst_0
      13: invokestatic  #61                 // Method doEncryption:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/WsuIdAllocator;Lorg/apache/xml/security/keys/KeyInfo;Ljavax/crypto/SecretKey;Ljava/lang/String;Ljava/util/List;Lorg/apache/wss4j/dom/callback/CallbackLookup;Ljavax/security/auth/callback/CallbackHandler;Ljava/util/List;Z)Ljava/util/List;
      16: areturn

  public static java.util.List<java.lang.String> doEncryption(org.w3c.dom.Document, org.apache.wss4j.dom.WsuIdAllocator, org.apache.xml.security.keys.KeyInfo, javax.crypto.SecretKey, java.lang.String, java.util.List<org.apache.wss4j.common.WSEncryptionPart>, org.apache.wss4j.dom.callback.CallbackLookup, javax.security.auth.callback.CallbackHandler, java.util.List<org.w3c.dom.Element>, boolean) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aconst_null
       1: astore        10
       3: aload         4
       5: invokestatic  #74                 // Method org/apache/xml/security/encryption/XMLCipher.getInstance:(Ljava/lang/String;)Lorg/apache/xml/security/encryption/XMLCipher;
       8: astore        10
      10: goto          28
      13: astore        11
      15: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
      18: dup
      19: getstatic     #76                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.UNSUPPORTED_ALGORITHM:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      22: aload         11
      24: invokespecial #77                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      27: athrow
      28: new           #4                  // class java/util/ArrayList
      31: dup
      32: invokespecial #5                  // Method java/util/ArrayList."<init>":()V
      35: astore        11
      37: aconst_null
      38: astore        12
      40: iconst_0
      41: istore        13
      43: iload         13
      45: aload         5
      47: invokeinterface #71,  1           // InterfaceMethod java/util/List.size:()I
      52: if_icmpge     409
      55: aload         5
      57: iload         13
      59: invokeinterface #72,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      64: checkcast     #78                 // class org/apache/wss4j/common/WSEncryptionPart
      67: astore        14
      69: aload         14
      71: invokevirtual #79                 // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
      74: ifnull        97
      77: aload         14
      79: invokevirtual #79                 // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
      82: ldc           #80                 // String cid:
      84: invokevirtual #81                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      87: ifeq          97
      90: aload         14
      92: astore        12
      94: goto          403
      97: aload         6
      99: ifnonnull     112
     102: new           #82                 // class org/apache/wss4j/dom/callback/DOMCallbackLookup
     105: dup
     106: aload_0
     107: invokespecial #83                 // Method org/apache/wss4j/dom/callback/DOMCallbackLookup."<init>":(Lorg/w3c/dom/Document;)V
     110: astore        6
     112: aload         14
     114: aload         6
     116: aload_0
     117: invokestatic  #84                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.findElements:(Lorg/apache/wss4j/common/WSEncryptionPart;Lorg/apache/wss4j/dom/callback/CallbackLookup;Lorg/w3c/dom/Document;)Ljava/util/List;
     120: astore        15
     122: aload         15
     124: ifnull        137
     127: aload         15
     129: invokeinterface #71,  1           // InterfaceMethod java/util/List.size:()I
     134: ifne          204
     137: aload         14
     139: invokevirtual #85                 // Method org/apache/wss4j/common/WSEncryptionPart.isRequired:()Z
     142: ifne          148
     145: goto          403
     148: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
     151: dup
     152: getstatic     #25                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     155: ldc           #86                 // String noEncElement
     157: iconst_1
     158: anewarray     #27                 // class java/lang/Object
     161: dup
     162: iconst_0
     163: new           #87                 // class java/lang/StringBuilder
     166: dup
     167: invokespecial #88                 // Method java/lang/StringBuilder."<init>":()V
     170: ldc           #89                 // String {
     172: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     175: aload         14
     177: invokevirtual #91                 // Method org/apache/wss4j/common/WSEncryptionPart.getNamespace:()Ljava/lang/String;
     180: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     183: ldc           #92                 // String }
     185: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     188: aload         14
     190: invokevirtual #93                 // Method org/apache/wss4j/common/WSEncryptionPart.getName:()Ljava/lang/String;
     193: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     196: invokevirtual #94                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     199: aastore
     200: invokespecial #29                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     203: athrow
     204: iload         9
     206: ifeq          316
     209: aload         15
     211: invokeinterface #95,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     216: astore        16
     218: aload         16
     220: invokeinterface #96,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     225: ifeq          313
     228: aload         16
     230: invokeinterface #97,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     235: checkcast     #73                 // class org/w3c/dom/Element
     238: astore        17
     240: aload_0
     241: aload_1
     242: aload_2
     243: aload_3
     244: aload         4
     246: aload         7
     248: aload         14
     250: aload         17
     252: invokestatic  #98                 // Method encryptElementInAttachment:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/WsuIdAllocator;Lorg/apache/xml/security/keys/KeyInfo;Ljavax/crypto/SecretKey;Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/wss4j/common/WSEncryptionPart;Lorg/w3c/dom/Element;)Ljava/lang/String;
     255: astore        18
     257: aload         14
     259: aload         18
     261: invokevirtual #99                 // Method org/apache/wss4j/common/WSEncryptionPart.setEncId:(Ljava/lang/String;)V
     264: aload         11
     266: new           #87                 // class java/lang/StringBuilder
     269: dup
     270: invokespecial #88                 // Method java/lang/StringBuilder."<init>":()V
     273: ldc           #100                // String #
     275: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     278: aload         18
     280: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     283: invokevirtual #94                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     286: invokeinterface #51,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     291: pop
     292: goto          310
     295: astore        18
     297: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
     300: dup
     301: getstatic     #102                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_ENCRYPTION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     304: aload         18
     306: invokespecial #77                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     309: athrow
     310: goto          218
     313: goto          403
     316: aload         15
     318: invokeinterface #95,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     323: astore        16
     325: aload         16
     327: invokeinterface #96,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     332: ifeq          403
     335: aload         16
     337: invokeinterface #97,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     342: checkcast     #73                 // class org/w3c/dom/Element
     345: astore        17
     347: aload_0
     348: aload         17
     350: aload         14
     352: invokevirtual #103                // Method org/apache/wss4j/common/WSEncryptionPart.getEncModifier:()Ljava/lang/String;
     355: aload_1
     356: aload         10
     358: aload_3
     359: aload_2
     360: invokestatic  #104                // Method encryptElement:(Lorg/w3c/dom/Document;Lorg/w3c/dom/Element;Ljava/lang/String;Lorg/apache/wss4j/dom/WsuIdAllocator;Lorg/apache/xml/security/encryption/XMLCipher;Ljavax/crypto/SecretKey;Lorg/apache/xml/security/keys/KeyInfo;)Ljava/lang/String;
     363: astore        18
     365: aload         14
     367: aload         18
     369: invokevirtual #99                 // Method org/apache/wss4j/common/WSEncryptionPart.setEncId:(Ljava/lang/String;)V
     372: aload         11
     374: new           #87                 // class java/lang/StringBuilder
     377: dup
     378: invokespecial #88                 // Method java/lang/StringBuilder."<init>":()V
     381: ldc           #100                // String #
     383: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     386: aload         18
     388: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     391: invokevirtual #94                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     394: invokeinterface #51,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     399: pop
     400: goto          325
     403: iinc          13, 1
     406: goto          43
     409: aload         12
     411: ifnull        431
     414: aload_0
     415: aload_1
     416: aload_2
     417: aload_3
     418: aload         4
     420: aload         7
     422: aload         12
     424: aload         11
     426: aload         8
     428: invokestatic  #105                // Method encryptAttachment:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/WsuIdAllocator;Lorg/apache/xml/security/keys/KeyInfo;Ljavax/crypto/SecretKey;Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/wss4j/common/WSEncryptionPart;Ljava/util/List;Ljava/util/List;)V
     431: aload         11
     433: areturn
    Exception table:
       from    to  target type
           3    10    13   Class org/apache/xml/security/encryption/XMLEncryptionException
         240   292   295   Class java/lang/Exception

  private static java.lang.String encryptElementInAttachment(org.w3c.dom.Document, org.apache.wss4j.dom.WsuIdAllocator, org.apache.xml.security.keys.KeyInfo, javax.crypto.SecretKey, java.lang.String, javax.security.auth.callback.CallbackHandler, org.apache.wss4j.common.WSEncryptionPart, org.w3c.dom.Element) throws java.lang.Exception;
    Code:
       0: ldc           #106                // String http://www.w3.org/2001/04/xmlenc#Element
       2: astore        8
       4: ldc           #107                // String Content
       6: aload         6
       8: invokevirtual #103                // Method org/apache/wss4j/common/WSEncryptionPart.getEncModifier:()Ljava/lang/String;
      11: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      14: ifeq          21
      17: ldc           #109                // String http://www.w3.org/2001/04/xmlenc#Content
      19: astore        8
      21: aload_1
      22: ldc           #110                // String
      24: aload_0
      25: invokeinterface #111,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
      30: astore        9
      32: aload_1
      33: ldc           #112                // String ED-
      35: aload         9
      37: invokeinterface #111,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
      42: astore        10
      44: ldc           #113                // String Header
      46: aload         6
      48: invokevirtual #103                // Method org/apache/wss4j/common/WSEncryptionPart.getEncModifier:()Ljava/lang/String;
      51: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      54: ifeq          81
      57: aload         7
      59: invokeinterface #114,  1          // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
      64: aload_0
      65: invokestatic  #115                // Method org/apache/wss4j/dom/util/WSSecurityUtil.getSOAPHeader:(Lorg/w3c/dom/Document;)Lorg/w3c/dom/Element;
      68: invokevirtual #116                // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
      71: ifeq          81
      74: aload_0
      75: aload         7
      77: aload_1
      78: invokestatic  #117                // Method createEncryptedHeaderElement:(Lorg/w3c/dom/Document;Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      81: aload_0
      82: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
      84: ldc           #118                // String xenc:EncryptedData
      86: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      91: astore        11
      93: aload         11
      95: aconst_null
      96: ldc           #119                // String Id
      98: aload         10
     100: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     105: aload         11
     107: aconst_null
     108: ldc           #121                // String Type
     110: aload         8
     112: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     117: aload_0
     118: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
     120: ldc           #122                // String xenc:EncryptionMethod
     122: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     127: astore        12
     129: aload         12
     131: aconst_null
     132: ldc           #123                // String Algorithm
     134: aload         4
     136: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     141: aload         11
     143: aload         12
     145: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     150: pop
     151: aload         11
     153: aload_2
     154: invokevirtual #124                // Method org/apache/xml/security/keys/KeyInfo.getElement:()Lorg/w3c/dom/Element;
     157: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     162: pop
     163: aload_0
     164: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
     166: ldc           #125                // String xenc:CipherData
     168: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     173: astore        13
     175: aload_0
     176: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
     178: ldc           #126                // String xenc:CipherValue
     180: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     185: astore        14
     187: aload         13
     189: aload         14
     191: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     196: pop
     197: aload         11
     199: aload         13
     201: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     206: pop
     207: aload         4
     209: aload_3
     210: invokestatic  #127                // Method createCipher:(Ljava/lang/String;Ljavax/crypto/SecretKey;)Ljavax/crypto/Cipher;
     213: astore        15
     215: new           #128                // class org/apache/xml/security/encryption/TransformSerializer
     218: dup
     219: invokespecial #129                // Method org/apache/xml/security/encryption/TransformSerializer."<init>":()V
     222: astore        16
     224: aload         16
     226: ldc           #130                // String http://santuario.apache.org/c14n/physical
     228: invokestatic  #131                // Method org/apache/xml/security/c14n/Canonicalizer.getInstance:(Ljava/lang/String;)Lorg/apache/xml/security/c14n/Canonicalizer;
     231: invokevirtual #132                // Method org/apache/xml/security/encryption/AbstractSerializer.setCanonicalizer:(Lorg/apache/xml/security/c14n/Canonicalizer;)V
     234: aload         16
     236: iconst_1
     237: invokevirtual #133                // Method org/apache/xml/security/encryption/AbstractSerializer.setSecureValidation:(Z)V
     240: aconst_null
     241: astore        17
     243: aload         8
     245: ldc           #109                // String http://www.w3.org/2001/04/xmlenc#Content
     247: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     250: ifeq          296
     253: aload         7
     255: invokeinterface #134,  1          // InterfaceMethod org/w3c/dom/Element.getChildNodes:()Lorg/w3c/dom/NodeList;
     260: astore        18
     262: aconst_null
     263: aload         18
     265: if_acmpeq     280
     268: aload         16
     270: aload         18
     272: invokevirtual #135                // Method org/apache/xml/security/encryption/AbstractSerializer.serializeToByteArray:(Lorg/w3c/dom/NodeList;)[B
     275: astore        17
     277: goto          293
     280: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
     283: dup
     284: getstatic     #102                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_ENCRYPTION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     287: ldc           #136                // String Element has no content.
     289: invokespecial #137                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     292: athrow
     293: goto          305
     296: aload         16
     298: aload         7
     300: invokevirtual #138                // Method org/apache/xml/security/encryption/AbstractSerializer.serializeToByteArray:(Lorg/w3c/dom/Element;)[B
     303: astore        17
     305: aconst_null
     306: astore        18
     308: aload         15
     310: aload         17
     312: invokevirtual #139                // Method javax/crypto/Cipher.doFinal:([B)[B
     315: astore        18
     317: goto          350
     320: astore        19
     322: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
     325: dup
     326: getstatic     #102                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_ENCRYPTION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     329: aload         19
     331: invokespecial #77                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     334: athrow
     335: astore        19
     337: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
     340: dup
     341: getstatic     #102                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_ENCRYPTION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     344: aload         19
     346: invokespecial #77                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     349: athrow
     350: aload         15
     352: invokevirtual #142                // Method javax/crypto/Cipher.getIV:()[B
     355: astore        19
     357: aload         19
     359: arraylength
     360: aload         18
     362: arraylength
     363: iadd
     364: newarray       byte
     366: astore        20
     368: aload         19
     370: iconst_0
     371: aload         20
     373: iconst_0
     374: aload         19
     376: arraylength
     377: invokestatic  #143                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     380: aload         18
     382: iconst_0
     383: aload         20
     385: aload         19
     387: arraylength
     388: aload         18
     390: arraylength
     391: invokestatic  #143                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     394: ldc           #107                // String Content
     396: aload         6
     398: invokevirtual #103                // Method org/apache/wss4j/common/WSEncryptionPart.getEncModifier:()Ljava/lang/String;
     401: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     404: ifeq          460
     407: aload         7
     409: invokeinterface #144,  1          // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
     414: astore        21
     416: aload         21
     418: ifnull        447
     421: aload         21
     423: invokeinterface #145,  1          // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
     428: astore        22
     430: aload         7
     432: aload         21
     434: invokeinterface #146,  2          // InterfaceMethod org/w3c/dom/Element.removeChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     439: pop
     440: aload         22
     442: astore        21
     444: goto          416
     447: aload         7
     449: aload         11
     451: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     456: pop
     457: goto          477
     460: aload         7
     462: invokeinterface #114,  1          // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
     467: aload         11
     469: aload         7
     471: invokeinterface #147,  3          // InterfaceMethod org/w3c/dom/Node.replaceChild:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     476: pop
     477: aload         14
     479: aload_0
     480: aload         9
     482: aload         20
     484: aload         5
     486: invokestatic  #148                // Method org/apache/wss4j/dom/util/WSSecurityUtil.storeBytesInAttachment:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Document;Ljava/lang/String;[BLjavax/security/auth/callback/CallbackHandler;)V
     489: aload         10
     491: areturn
    Exception table:
       from    to  target type
         308   317   320   Class javax/crypto/IllegalBlockSizeException
         308   317   335   Class javax/crypto/BadPaddingException

  private static void encryptAttachment(org.w3c.dom.Document, org.apache.wss4j.dom.WsuIdAllocator, org.apache.xml.security.keys.KeyInfo, javax.crypto.SecretKey, java.lang.String, javax.security.auth.callback.CallbackHandler, org.apache.wss4j.common.WSEncryptionPart, java.util.List<java.lang.String>, java.util.List<org.w3c.dom.Element>) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload         5
       2: ifnonnull     27
       5: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
       8: dup
       9: getstatic     #25                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      12: ldc           #149                // String empty
      14: iconst_1
      15: anewarray     #27                 // class java/lang/Object
      18: dup
      19: iconst_0
      20: ldc           #150                // String no attachment callbackhandler supplied
      22: aastore
      23: invokespecial #29                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
      26: athrow
      27: new           #151                // class org/apache/wss4j/common/ext/AttachmentRequestCallback
      30: dup
      31: invokespecial #152                // Method org/apache/wss4j/common/ext/AttachmentRequestCallback."<init>":()V
      34: astore        9
      36: aload         6
      38: invokevirtual #79                 // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
      41: iconst_4
      42: invokevirtual #153                // Method java/lang/String.substring:(I)Ljava/lang/String;
      45: astore        10
      47: aload         9
      49: aload         10
      51: invokevirtual #154                // Method org/apache/wss4j/common/ext/AttachmentRequestCallback.setAttachmentId:(Ljava/lang/String;)V
      54: aload         5
      56: iconst_1
      57: anewarray     #155                // class javax/security/auth/callback/Callback
      60: dup
      61: iconst_0
      62: aload         9
      64: aastore
      65: invokeinterface #156,  2          // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      70: goto          88
      73: astore        11
      75: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
      78: dup
      79: getstatic     #102                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_ENCRYPTION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      82: aload         11
      84: invokespecial #77                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      87: athrow
      88: ldc           #157                // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Content-Only
      90: astore        11
      92: ldc           #158                // String Element
      94: aload         6
      96: invokevirtual #103                // Method org/apache/wss4j/common/WSEncryptionPart.getEncModifier:()Ljava/lang/String;
      99: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     102: ifeq          109
     105: ldc           #159                // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Complete
     107: astore        11
     109: aload         9
     111: invokevirtual #160                // Method org/apache/wss4j/common/ext/AttachmentRequestCallback.getAttachments:()Ljava/util/List;
     114: invokeinterface #95,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     119: astore        12
     121: aload         12
     123: invokeinterface #96,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     128: ifeq          563
     131: aload         12
     133: invokeinterface #97,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     138: checkcast     #161                // class org/apache/wss4j/common/ext/Attachment
     141: astore        13
     143: aload         13
     145: invokevirtual #162                // Method org/apache/wss4j/common/ext/Attachment.getId:()Ljava/lang/String;
     148: astore        14
     150: aload_1
     151: ldc           #112                // String ED-
     153: aload         14
     155: invokeinterface #111,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     160: astore        15
     162: aload         7
     164: new           #87                 // class java/lang/StringBuilder
     167: dup
     168: invokespecial #88                 // Method java/lang/StringBuilder."<init>":()V
     171: ldc           #100                // String #
     173: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     176: aload         15
     178: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     181: invokevirtual #94                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     184: invokeinterface #51,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     189: pop
     190: aload_0
     191: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
     193: ldc           #118                // String xenc:EncryptedData
     195: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     200: astore        16
     202: aload         16
     204: aconst_null
     205: ldc           #119                // String Id
     207: aload         15
     209: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     214: aload         16
     216: aconst_null
     217: ldc           #163                // String MimeType
     219: aload         13
     221: invokevirtual #164                // Method org/apache/wss4j/common/ext/Attachment.getMimeType:()Ljava/lang/String;
     224: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     229: aload         16
     231: aconst_null
     232: ldc           #121                // String Type
     234: aload         11
     236: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     241: aload_0
     242: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
     244: ldc           #122                // String xenc:EncryptionMethod
     246: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     251: astore        17
     253: aload         17
     255: aconst_null
     256: ldc           #123                // String Algorithm
     258: aload         4
     260: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     265: aload         16
     267: aload         17
     269: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     274: pop
     275: aload         16
     277: aload_2
     278: invokevirtual #124                // Method org/apache/xml/security/keys/KeyInfo.getElement:()Lorg/w3c/dom/Element;
     281: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     286: pop
     287: aload_0
     288: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
     290: ldc           #125                // String xenc:CipherData
     292: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     297: astore        18
     299: aload_0
     300: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
     302: ldc           #165                // String xenc:CipherReference
     304: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     309: astore        19
     311: aload         19
     313: aconst_null
     314: ldc           #166                // String URI
     316: new           #87                 // class java/lang/StringBuilder
     319: dup
     320: invokespecial #88                 // Method java/lang/StringBuilder."<init>":()V
     323: ldc           #80                 // String cid:
     325: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     328: aload         14
     330: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     333: invokevirtual #94                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     336: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     341: aload_0
     342: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
     344: ldc           #167                // String xenc:Transforms
     346: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     351: astore        20
     353: aload_0
     354: ldc           #168                // String http://www.w3.org/2000/09/xmldsig#
     356: ldc           #169                // String ds:Transform
     358: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     363: astore        21
     365: aload         21
     367: aconst_null
     368: ldc           #123                // String Algorithm
     370: ldc           #170                // String http://docs.oasis-open.org/wss/oasis-wss-SwAProfile-1.1#Attachment-Ciphertext-Transform
     372: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     377: aload         20
     379: aload         21
     381: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     386: pop
     387: aload         19
     389: aload         20
     391: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     396: pop
     397: aload         18
     399: aload         19
     401: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     406: pop
     407: aload         16
     409: aload         18
     411: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     416: pop
     417: aload         8
     419: aload         16
     421: invokeinterface #51,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     426: pop
     427: new           #161                // class org/apache/wss4j/common/ext/Attachment
     430: dup
     431: invokespecial #171                // Method org/apache/wss4j/common/ext/Attachment."<init>":()V
     434: astore        22
     436: aload         22
     438: aload         14
     440: invokevirtual #172                // Method org/apache/wss4j/common/ext/Attachment.setId:(Ljava/lang/String;)V
     443: aload         22
     445: ldc           #173                // String application/octet-stream
     447: invokevirtual #174                // Method org/apache/wss4j/common/ext/Attachment.setMimeType:(Ljava/lang/String;)V
     450: aload         4
     452: aload_3
     453: invokestatic  #127                // Method createCipher:(Ljava/lang/String;Ljavax/crypto/SecretKey;)Ljavax/crypto/Cipher;
     456: astore        23
     458: new           #175                // class java/util/HashMap
     461: dup
     462: aload         13
     464: invokevirtual #176                // Method org/apache/wss4j/common/ext/Attachment.getHeaders:()Ljava/util/Map;
     467: invokespecial #177                // Method java/util/HashMap."<init>":(Ljava/util/Map;)V
     470: astore        24
     472: aload         22
     474: aload         23
     476: ldc           #158                // String Element
     478: aload         6
     480: invokevirtual #103                // Method org/apache/wss4j/common/WSEncryptionPart.getEncModifier:()Ljava/lang/String;
     483: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     486: aload         13
     488: aload         24
     490: invokestatic  #178                // Method org/apache/wss4j/common/util/AttachmentUtils.setupAttachmentEncryptionStream:(Ljavax/crypto/Cipher;ZLorg/apache/wss4j/common/ext/Attachment;Ljava/util/Map;)Ljava/io/InputStream;
     493: invokevirtual #179                // Method org/apache/wss4j/common/ext/Attachment.setSourceStream:(Ljava/io/InputStream;)V
     496: aload         22
     498: aload         24
     500: invokevirtual #180                // Method org/apache/wss4j/common/ext/Attachment.addHeaders:(Ljava/util/Map;)V
     503: new           #181                // class org/apache/wss4j/common/ext/AttachmentResultCallback
     506: dup
     507: invokespecial #182                // Method org/apache/wss4j/common/ext/AttachmentResultCallback."<init>":()V
     510: astore        25
     512: aload         25
     514: aload         14
     516: invokevirtual #183                // Method org/apache/wss4j/common/ext/AttachmentResultCallback.setAttachmentId:(Ljava/lang/String;)V
     519: aload         25
     521: aload         22
     523: invokevirtual #184                // Method org/apache/wss4j/common/ext/AttachmentResultCallback.setAttachment:(Lorg/apache/wss4j/common/ext/Attachment;)V
     526: aload         5
     528: iconst_1
     529: anewarray     #155                // class javax/security/auth/callback/Callback
     532: dup
     533: iconst_0
     534: aload         25
     536: aastore
     537: invokeinterface #156,  2          // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     542: goto          560
     545: astore        26
     547: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
     550: dup
     551: getstatic     #102                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_ENCRYPTION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     554: aload         26
     556: invokespecial #77                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     559: athrow
     560: goto          121
     563: return
    Exception table:
       from    to  target type
          54    70    73   Class java/lang/Exception
         526   542   545   Class java/lang/Exception

  private static javax.crypto.Cipher createCipher(java.lang.String, javax.crypto.SecretKey) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: invokestatic  #185                // Method org/apache/xml/security/algorithms/JCEMapper.translateURItoJCEID:(Ljava/lang/String;)Ljava/lang/String;
       4: astore_2
       5: aload_2
       6: invokestatic  #186                // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
       9: astore_3
      10: ldc           #187                // String http://www.w3.org/2009/xmlenc11#aes128-gcm
      12: aload_0
      13: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      16: ifne          37
      19: ldc           #188                // String http://www.w3.org/2009/xmlenc11#aes192-gcm
      21: aload_0
      22: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      25: ifne          37
      28: ldc           #189                // String http://www.w3.org/2009/xmlenc11#aes256-gcm
      30: aload_0
      31: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      34: ifeq          66
      37: bipush        12
      39: invokestatic  #190                // Method org/apache/wss4j/dom/util/WSSecurityUtil.generateNonce:(I)[B
      42: astore        4
      44: new           #191                // class javax/crypto/spec/IvParameterSpec
      47: dup
      48: aload         4
      50: invokespecial #192                // Method javax/crypto/spec/IvParameterSpec."<init>":([B)V
      53: astore        5
      55: aload_3
      56: iconst_1
      57: aload_1
      58: aload         5
      60: invokevirtual #193                // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
      63: goto          72
      66: aload_3
      67: iconst_1
      68: aload_1
      69: invokevirtual #194                // Method javax/crypto/Cipher.init:(ILjava/security/Key;)V
      72: aload_3
      73: areturn
      74: astore_3
      75: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
      78: dup
      79: getstatic     #102                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_ENCRYPTION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      82: aload_3
      83: invokespecial #77                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      86: athrow
    Exception table:
       from    to  target type
           5    73    74   Class java/lang/Exception

  private static java.lang.String encryptElement(org.w3c.dom.Document, org.w3c.dom.Element, java.lang.String, org.apache.wss4j.dom.WsuIdAllocator, org.apache.xml.security.encryption.XMLCipher, javax.crypto.SecretKey, org.apache.xml.security.keys.KeyInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: ldc           #107                // String Content
       2: aload_2
       3: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       6: istore        7
       8: aload_3
       9: ldc           #112                // String ED-
      11: aload_1
      12: invokeinterface #111,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
      17: astore        8
      19: ldc           #113                // String Header
      21: aload_2
      22: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      25: ifeq          50
      28: aload_1
      29: invokeinterface #114,  1          // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
      34: aload_0
      35: invokestatic  #115                // Method org/apache/wss4j/dom/util/WSSecurityUtil.getSOAPHeader:(Lorg/w3c/dom/Document;)Lorg/w3c/dom/Element;
      38: invokevirtual #116                // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
      41: ifeq          50
      44: aload_0
      45: aload_1
      46: aload_3
      47: invokestatic  #117                // Method createEncryptedHeaderElement:(Lorg/w3c/dom/Document;Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      50: aload         4
      52: iconst_1
      53: aload         5
      55: invokevirtual #195                // Method org/apache/xml/security/encryption/XMLCipher.init:(ILjava/security/Key;)V
      58: aload         4
      60: invokevirtual #196                // Method org/apache/xml/security/encryption/XMLCipher.getEncryptedData:()Lorg/apache/xml/security/encryption/EncryptedData;
      63: astore        9
      65: aload         9
      67: aload         8
      69: invokeinterface #197,  2          // InterfaceMethod org/apache/xml/security/encryption/EncryptedData.setId:(Ljava/lang/String;)V
      74: aload         9
      76: aload         6
      78: invokeinterface #198,  2          // InterfaceMethod org/apache/xml/security/encryption/EncryptedData.setKeyInfo:(Lorg/apache/xml/security/keys/KeyInfo;)V
      83: aload         4
      85: aload_0
      86: aload_1
      87: iload         7
      89: invokevirtual #199                // Method org/apache/xml/security/encryption/XMLCipher.doFinal:(Lorg/w3c/dom/Document;Lorg/w3c/dom/Element;Z)Lorg/w3c/dom/Document;
      92: pop
      93: aload         8
      95: areturn
      96: astore        9
      98: new           #24                 // class org/apache/wss4j/common/ext/WSSecurityException
     101: dup
     102: getstatic     #102                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_ENCRYPTION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     105: aload         9
     107: invokespecial #77                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     110: athrow
    Exception table:
       from    to  target type
          19    95    96   Class java/lang/Exception

  private static void createEncryptedHeaderElement(org.w3c.dom.Document, org.w3c.dom.Element, org.apache.wss4j.dom.WsuIdAllocator);
    Code:
       0: aload_0
       1: ldc           #200                // String http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd
       3: ldc           #201                // String wsse11:EncryptedHeader
       5: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      10: astore_3
      11: aload_3
      12: ldc           #200                // String http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd
      14: ldc           #202                // String wsse11
      16: invokestatic  #66                 // Method org/apache/wss4j/common/util/XMLUtils.setNamespace:(Lorg/w3c/dom/Element;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      19: pop
      20: aload_3
      21: ldc           #203                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      23: ldc           #204                // String wsu
      25: invokestatic  #66                 // Method org/apache/wss4j/common/util/XMLUtils.setNamespace:(Lorg/w3c/dom/Element;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      28: astore        4
      30: aload_2
      31: ldc           #205                // String EH-
      33: aload_1
      34: invokeinterface #111,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
      39: astore        5
      41: aload_3
      42: ldc           #203                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      44: new           #87                 // class java/lang/StringBuilder
      47: dup
      48: invokespecial #88                 // Method java/lang/StringBuilder."<init>":()V
      51: aload         4
      53: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      56: ldc           #206                // String :Id
      58: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      61: invokevirtual #94                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      64: aload         5
      66: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
      71: aload_1
      72: invokeinterface #114,  1          // InterfaceMethod org/w3c/dom/Element.getParentNode:()Lorg/w3c/dom/Node;
      77: astore        6
      79: aload         6
      81: aload_3
      82: aload_1
      83: invokeinterface #147,  3          // InterfaceMethod org/w3c/dom/Node.replaceChild:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      88: checkcast     #73                 // class org/w3c/dom/Element
      91: astore_1
      92: aload_3
      93: aload_1
      94: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      99: pop
     100: aload_1
     101: invokeinterface #207,  1          // InterfaceMethod org/w3c/dom/Element.getAttributes:()Lorg/w3c/dom/NamedNodeMap;
     106: astore        7
     108: iconst_0
     109: istore        8
     111: iload         8
     113: aload         7
     115: invokeinterface #208,  1          // InterfaceMethod org/w3c/dom/NamedNodeMap.getLength:()I
     120: if_icmpge     238
     123: aload         7
     125: iload         8
     127: invokeinterface #209,  2          // InterfaceMethod org/w3c/dom/NamedNodeMap.item:(I)Lorg/w3c/dom/Node;
     132: checkcast     #210                // class org/w3c/dom/Attr
     135: astore        9
     137: aload         9
     139: invokeinterface #211,  1          // InterfaceMethod org/w3c/dom/Attr.getNamespaceURI:()Ljava/lang/String;
     144: ldc           #212                // String http://schemas.xmlsoap.org/soap/envelope/
     146: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     149: ifne          167
     152: aload         9
     154: invokeinterface #211,  1          // InterfaceMethod org/w3c/dom/Attr.getNamespaceURI:()Ljava/lang/String;
     159: ldc           #213                // String http://www.w3.org/2003/05/soap-envelope
     161: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     164: ifeq          232
     167: aload_3
     168: aload         9
     170: invokeinterface #211,  1          // InterfaceMethod org/w3c/dom/Attr.getNamespaceURI:()Ljava/lang/String;
     175: ldc           #214                // String soapenv
     177: invokestatic  #66                 // Method org/apache/wss4j/common/util/XMLUtils.setNamespace:(Lorg/w3c/dom/Element;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     180: astore        10
     182: aload_3
     183: aload         9
     185: invokeinterface #211,  1          // InterfaceMethod org/w3c/dom/Attr.getNamespaceURI:()Ljava/lang/String;
     190: new           #87                 // class java/lang/StringBuilder
     193: dup
     194: invokespecial #88                 // Method java/lang/StringBuilder."<init>":()V
     197: aload         10
     199: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     202: ldc           #215                // String :
     204: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     207: aload         9
     209: invokeinterface #216,  1          // InterfaceMethod org/w3c/dom/Attr.getLocalName:()Ljava/lang/String;
     214: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     217: invokevirtual #94                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     220: aload         9
     222: invokeinterface #217,  1          // InterfaceMethod org/w3c/dom/Attr.getValue:()Ljava/lang/String;
     227: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     232: iinc          8, 1
     235: goto          111
     238: return

  private org.apache.xml.security.keys.KeyInfo createKeyInfo() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #218                // class org/apache/xml/security/keys/KeyInfo
       3: dup
       4: aload_0
       5: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
       8: invokespecial #219                // Method org/apache/xml/security/keys/KeyInfo."<init>":(Lorg/w3c/dom/Document;)V
      11: astore_1
      12: aload_0
      13: getfield      #220                // Field embedEncryptedKey:Z
      16: ifeq          30
      19: aload_1
      20: aload_0
      21: invokevirtual #41                 // Method getEncryptedKeyElement:()Lorg/w3c/dom/Element;
      24: invokevirtual #221                // Method org/apache/xml/security/keys/KeyInfo.addUnknownElement:(Lorg/w3c/dom/Element;)V
      27: goto          569
      30: aload_0
      31: getfield      #15                 // Field keyIdentifierType:I
      34: bipush        10
      36: if_icmpne     106
      39: new           #222                // class org/apache/wss4j/common/token/SecurityTokenReference
      42: dup
      43: aload_0
      44: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
      47: invokespecial #223                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
      50: astore_2
      51: aload_2
      52: invokevirtual #224                // Method org/apache/wss4j/common/token/SecurityTokenReference.addWSSENamespace:()V
      55: aload_0
      56: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
      59: ifnull        73
      62: aload_2
      63: aload_0
      64: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
      67: invokevirtual #226                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierEncKeySHA1:(Ljava/lang/String;)V
      70: goto          89
      73: aload_0
      74: getfield      #13                 // Field encryptedEphemeralKey:[B
      77: invokestatic  #227                // Method org/apache/wss4j/common/util/KeyUtils.generateDigest:([B)[B
      80: astore_3
      81: aload_2
      82: aload_3
      83: invokestatic  #228                // Method org/apache/xml/security/utils/Base64.encode:([B)Ljava/lang/String;
      86: invokevirtual #226                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierEncKeySHA1:(Ljava/lang/String;)V
      89: aload_2
      90: ldc           #229                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
      92: invokevirtual #230                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
      95: aload_1
      96: aload_2
      97: invokevirtual #231                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     100: invokevirtual #221                // Method org/apache/xml/security/keys/KeyInfo.addUnknownElement:(Lorg/w3c/dom/Element;)V
     103: goto          569
     106: ldc           #232                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     108: aload_0
     109: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     112: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     115: ifeq          161
     118: new           #222                // class org/apache/wss4j/common/token/SecurityTokenReference
     121: dup
     122: aload_0
     123: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
     126: invokespecial #223                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     129: astore_2
     130: aload_2
     131: invokevirtual #224                // Method org/apache/wss4j/common/token/SecurityTokenReference.addWSSENamespace:()V
     134: aload_2
     135: ldc           #233                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     137: invokevirtual #230                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     140: aload_2
     141: ldc           #232                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     143: aload_0
     144: invokevirtual #234                // Method getId:()Ljava/lang/String;
     147: invokevirtual #235                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/lang/String;Ljava/lang/String;)V
     150: aload_1
     151: aload_2
     152: invokevirtual #231                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     155: invokevirtual #221                // Method org/apache/xml/security/keys/KeyInfo.addUnknownElement:(Lorg/w3c/dom/Element;)V
     158: goto          569
     161: ldc           #236                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     163: aload_0
     164: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     167: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     170: ifeq          216
     173: new           #222                // class org/apache/wss4j/common/token/SecurityTokenReference
     176: dup
     177: aload_0
     178: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
     181: invokespecial #223                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     184: astore_2
     185: aload_2
     186: invokevirtual #224                // Method org/apache/wss4j/common/token/SecurityTokenReference.addWSSENamespace:()V
     189: aload_2
     190: ldc           #237                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     192: invokevirtual #230                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     195: aload_2
     196: ldc           #236                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     198: aload_0
     199: invokevirtual #234                // Method getId:()Ljava/lang/String;
     202: invokevirtual #235                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/lang/String;Ljava/lang/String;)V
     205: aload_1
     206: aload_2
     207: invokevirtual #231                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     210: invokevirtual #221                // Method org/apache/xml/security/keys/KeyInfo.addUnknownElement:(Lorg/w3c/dom/Element;)V
     213: goto          569
     216: ldc           #238                // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#Kerberosv5APREQSHA1
     218: aload_0
     219: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     222: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     225: ifeq          274
     228: new           #222                // class org/apache/wss4j/common/token/SecurityTokenReference
     231: dup
     232: aload_0
     233: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
     236: invokespecial #223                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     239: astore_2
     240: aload_2
     241: invokevirtual #224                // Method org/apache/wss4j/common/token/SecurityTokenReference.addWSSENamespace:()V
     244: aload_2
     245: ldc           #239                // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#GSS_Kerberosv5_AP_REQ
     247: invokevirtual #230                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     250: aload_2
     251: aload_0
     252: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     255: aload_0
     256: invokevirtual #234                // Method getId:()Ljava/lang/String;
     259: iconst_1
     260: invokevirtual #240                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/lang/String;Ljava/lang/String;Z)V
     263: aload_1
     264: aload_2
     265: invokevirtual #231                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     268: invokevirtual #221                // Method org/apache/xml/security/keys/KeyInfo.addUnknownElement:(Lorg/w3c/dom/Element;)V
     271: goto          569
     274: aload_0
     275: getfield      #241                // Field securityTokenReference:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     278: ifnull        341
     281: aload_0
     282: getfield      #241                // Field securityTokenReference:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     285: invokevirtual #231                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     288: astore_2
     289: aload_2
     290: ldc           #242                // String http://www.w3.org/2000/xmlns/
     292: new           #87                 // class java/lang/StringBuilder
     295: dup
     296: invokespecial #88                 // Method java/lang/StringBuilder."<init>":()V
     299: ldc           #243                // String xmlns:
     301: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     304: aload_2
     305: invokeinterface #244,  1          // InterfaceMethod org/w3c/dom/Element.getPrefix:()Ljava/lang/String;
     310: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     313: invokevirtual #94                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     316: aload_2
     317: invokeinterface #245,  1          // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
     322: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     327: aload_1
     328: aload_0
     329: getfield      #241                // Field securityTokenReference:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     332: invokevirtual #231                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     335: invokevirtual #221                // Method org/apache/xml/security/keys/KeyInfo.addUnknownElement:(Lorg/w3c/dom/Element;)V
     338: goto          569
     341: aload_0
     342: invokevirtual #234                // Method getId:()Ljava/lang/String;
     345: ifnull        490
     348: new           #222                // class org/apache/wss4j/common/token/SecurityTokenReference
     351: dup
     352: aload_0
     353: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
     356: invokespecial #223                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     359: astore_2
     360: aload_2
     361: invokevirtual #224                // Method org/apache/wss4j/common/token/SecurityTokenReference.addWSSENamespace:()V
     364: new           #246                // class org/apache/wss4j/common/token/Reference
     367: dup
     368: aload_0
     369: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
     372: invokespecial #247                // Method org/apache/wss4j/common/token/Reference."<init>":(Lorg/w3c/dom/Document;)V
     375: astore_3
     376: aload_0
     377: getfield      #248                // Field encKeyIdDirectId:Z
     380: ifeq          394
     383: aload_3
     384: aload_0
     385: invokevirtual #234                // Method getId:()Ljava/lang/String;
     388: invokevirtual #249                // Method org/apache/wss4j/common/token/Reference.setURI:(Ljava/lang/String;)V
     391: goto          420
     394: aload_3
     395: new           #87                 // class java/lang/StringBuilder
     398: dup
     399: invokespecial #88                 // Method java/lang/StringBuilder."<init>":()V
     402: ldc           #100                // String #
     404: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     407: aload_0
     408: invokevirtual #234                // Method getId:()Ljava/lang/String;
     411: invokevirtual #90                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     414: invokevirtual #94                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     417: invokevirtual #249                // Method org/apache/wss4j/common/token/Reference.setURI:(Ljava/lang/String;)V
     420: aload_0
     421: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     424: ifnull        435
     427: aload_3
     428: aload_0
     429: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     432: invokevirtual #250                // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     435: aload_2
     436: aload_3
     437: invokevirtual #251                // Method org/apache/wss4j/common/token/SecurityTokenReference.setReference:(Lorg/apache/wss4j/common/token/Reference;)V
     440: aload_0
     441: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     444: invokestatic  #252                // Method org/apache/wss4j/dom/message/token/KerberosSecurity.isKerberosToken:(Ljava/lang/String;)Z
     447: ifeq          461
     450: aload_2
     451: aload_0
     452: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     455: invokevirtual #230                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     458: goto          479
     461: ldc           #253                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
     463: aload_0
     464: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     467: invokevirtual #108                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     470: ifne          479
     473: aload_2
     474: ldc           #229                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     476: invokevirtual #230                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     479: aload_1
     480: aload_2
     481: invokevirtual #231                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     484: invokevirtual #221                // Method org/apache/xml/security/keys/KeyInfo.addUnknownElement:(Lorg/w3c/dom/Element;)V
     487: goto          569
     490: aload_0
     491: getfield      #2                  // Field encryptSymmKey:Z
     494: ifne          569
     497: aload_0
     498: getfield      #15                 // Field keyIdentifierType:I
     501: iconst_2
     502: if_icmpne     569
     505: new           #222                // class org/apache/wss4j/common/token/SecurityTokenReference
     508: dup
     509: aload_0
     510: getfield      #3                  // Field document:Lorg/w3c/dom/Document;
     513: invokespecial #223                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     516: astore_2
     517: aload_2
     518: invokevirtual #224                // Method org/apache/wss4j/common/token/SecurityTokenReference.addWSSENamespace:()V
     521: aload_0
     522: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     525: ifnull        539
     528: aload_2
     529: aload_0
     530: getfield      #225                // Field customReferenceValue:Ljava/lang/String;
     533: invokevirtual #226                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierEncKeySHA1:(Ljava/lang/String;)V
     536: goto          555
     539: aload_0
     540: getfield      #13                 // Field encryptedEphemeralKey:[B
     543: invokestatic  #227                // Method org/apache/wss4j/common/util/KeyUtils.generateDigest:([B)[B
     546: astore_3
     547: aload_2
     548: aload_3
     549: invokestatic  #228                // Method org/apache/xml/security/utils/Base64.encode:([B)Ljava/lang/String;
     552: invokevirtual #226                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierEncKeySHA1:(Ljava/lang/String;)V
     555: aload_2
     556: ldc           #229                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     558: invokevirtual #230                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     561: aload_1
     562: aload_2
     563: invokevirtual #231                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     566: invokevirtual #221                // Method org/apache/xml/security/keys/KeyInfo.addUnknownElement:(Lorg/w3c/dom/Element;)V
     569: aload_1
     570: invokevirtual #124                // Method org/apache/xml/security/keys/KeyInfo.getElement:()Lorg/w3c/dom/Element;
     573: astore_2
     574: aload_2
     575: ldc           #242                // String http://www.w3.org/2000/xmlns/
     577: ldc           #254                // String xmlns:ds
     579: ldc           #168                // String http://www.w3.org/2000/09/xmldsig#
     581: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     586: aload_1
     587: areturn

  public static org.w3c.dom.Element createDataRefList(org.w3c.dom.Document, org.w3c.dom.Element, java.util.List<java.lang.String>);
    Code:
       0: aload_2
       1: invokeinterface #95,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
       6: astore_3
       7: aload_3
       8: invokeinterface #96,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      13: ifeq          64
      16: aload_3
      17: invokeinterface #97,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      22: checkcast     #255                // class java/lang/String
      25: astore        4
      27: aload_0
      28: ldc           #62                 // String http://www.w3.org/2001/04/xmlenc#
      30: ldc_w         #256                // String xenc:DataReference
      33: invokeinterface #64,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      38: astore        5
      40: aload         5
      42: aconst_null
      43: ldc           #166                // String URI
      45: aload         4
      47: invokeinterface #120,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
      52: aload_1
      53: aload         5
      55: invokeinterface #68,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      60: pop
      61: goto          7
      64: aload_1
      65: areturn

  public org.apache.wss4j.common.token.SecurityTokenReference getSecurityTokenReference();
    Code:
       0: aload_0
       1: getfield      #241                // Field securityTokenReference:Lorg/apache/wss4j/common/token/SecurityTokenReference;
       4: areturn

  public void setSecurityTokenReference(org.apache.wss4j.common.token.SecurityTokenReference);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #241                // Field securityTokenReference:Lorg/apache/wss4j/common/token/SecurityTokenReference;
       5: return

  public boolean isEncryptSymmKey();
    Code:
       0: aload_0
       1: getfield      #2                  // Field encryptSymmKey:Z
       4: ireturn

  public void setEncryptSymmKey(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #2                  // Field encryptSymmKey:Z
       5: return

  public void setCustomReferenceValue(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #225                // Field customReferenceValue:Ljava/lang/String;
       5: return

  public void setEncKeyIdDirectId(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #248                // Field encKeyIdDirectId:Z
       5: return

  public void setEmbedEncryptedKey(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #220                // Field embedEncryptedKey:Z
       5: return

  public boolean isEmbedEncryptedKey();
    Code:
       0: aload_0
       1: getfield      #220                // Field embedEncryptedKey:Z
       4: ireturn

  public java.util.List<org.w3c.dom.Element> getAttachmentEncryptedDataElements();
    Code:
       0: aload_0
       1: getfield      #6                  // Field attachmentEncryptedDataElements:Ljava/util/List;
       4: areturn

  static {};
    Code:
       0: ldc_w         #257                // class org/apache/wss4j/dom/message/WSSecEncrypt
       3: invokestatic  #258                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
       9: return
}
