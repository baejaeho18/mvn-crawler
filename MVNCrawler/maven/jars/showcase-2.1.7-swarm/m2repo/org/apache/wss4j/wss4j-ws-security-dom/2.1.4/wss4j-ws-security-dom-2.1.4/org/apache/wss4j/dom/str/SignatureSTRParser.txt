Compiled from "SignatureSTRParser.java"
public class org.apache.wss4j.dom.str.SignatureSTRParser implements org.apache.wss4j.dom.str.STRParser {
  public org.apache.wss4j.dom.str.SignatureSTRParser();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public org.apache.wss4j.dom.str.STRParserResult parseSecurityTokenReference(org.apache.wss4j.dom.str.STRParserParameters) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnull        25
       4: aload_1
       5: invokevirtual #2                  // Method org/apache/wss4j/dom/str/STRParserParameters.getData:()Lorg/apache/wss4j/dom/handler/RequestData;
       8: ifnull        25
      11: aload_1
      12: invokevirtual #3                  // Method org/apache/wss4j/dom/str/STRParserParameters.getWsDocInfo:()Lorg/apache/wss4j/dom/WSDocInfo;
      15: ifnull        25
      18: aload_1
      19: invokevirtual #4                  // Method org/apache/wss4j/dom/str/STRParserParameters.getStrElement:()Lorg/w3c/dom/Element;
      22: ifnonnull     38
      25: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
      28: dup
      29: getstatic     #6                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      32: ldc           #7                  // String invalidSTRParserParameter
      34: invokespecial #8                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      37: athrow
      38: new           #9                  // class org/apache/wss4j/common/token/SecurityTokenReference
      41: dup
      42: aload_1
      43: invokevirtual #4                  // Method org/apache/wss4j/dom/str/STRParserParameters.getStrElement:()Lorg/w3c/dom/Element;
      46: aload_1
      47: invokevirtual #2                  // Method org/apache/wss4j/dom/str/STRParserParameters.getData:()Lorg/apache/wss4j/dom/handler/RequestData;
      50: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
      53: invokespecial #11                 // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      56: astore_2
      57: aconst_null
      58: astore_3
      59: aload_2
      60: invokevirtual #12                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getReference:()Lorg/apache/wss4j/common/token/Reference;
      63: ifnull        82
      66: aload_2
      67: invokevirtual #12                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getReference:()Lorg/apache/wss4j/common/token/Reference;
      70: invokevirtual #13                 // Method org/apache/wss4j/common/token/Reference.getURI:()Ljava/lang/String;
      73: astore_3
      74: aload_3
      75: invokestatic  #14                 // Method org/apache/wss4j/common/util/XMLUtils.getIDFromReference:(Ljava/lang/String;)Ljava/lang/String;
      78: astore_3
      79: goto          94
      82: aload_2
      83: invokevirtual #15                 // Method org/apache/wss4j/common/token/SecurityTokenReference.containsKeyIdentifier:()Z
      86: ifeq          94
      89: aload_2
      90: invokevirtual #16                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValue:()Ljava/lang/String;
      93: astore_3
      94: aload_1
      95: invokevirtual #3                  // Method org/apache/wss4j/dom/str/STRParserParameters.getWsDocInfo:()Lorg/apache/wss4j/dom/WSDocInfo;
      98: aload_3
      99: invokevirtual #17                 // Method org/apache/wss4j/dom/WSDocInfo.getResult:(Ljava/lang/String;)Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;
     102: astore        4
     104: aload         4
     106: ifnull        118
     109: aload_0
     110: aload         4
     112: aload_2
     113: aload_1
     114: invokespecial #18                 // Method processPreviousResult:(Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/dom/str/STRParserParameters;)Lorg/apache/wss4j/dom/str/STRParserResult;
     117: areturn
     118: aload_0
     119: aload_2
     120: aload_3
     121: aload_1
     122: invokespecial #19                 // Method processSTR:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Ljava/lang/String;Lorg/apache/wss4j/dom/str/STRParserParameters;)Lorg/apache/wss4j/dom/str/STRParserResult;
     125: areturn

  private java.security.Principal createPrincipalFromSAML(org.apache.wss4j.common.saml.SamlAssertionWrapper, org.apache.wss4j.dom.str.STRParserResult);
    Code:
       0: new           #20                 // class org/apache/wss4j/common/principal/SAMLTokenPrincipalImpl
       3: dup
       4: aload_1
       5: invokespecial #21                 // Method org/apache/wss4j/common/principal/SAMLTokenPrincipalImpl."<init>":(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)V
       8: astore_3
       9: aconst_null
      10: astore        4
      12: aload_1
      13: invokevirtual #22                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getConfirmationMethods:()Ljava/util/List;
      16: astore        5
      18: aload         5
      20: ifnull        46
      23: aload         5
      25: invokeinterface #23,  1           // InterfaceMethod java/util/List.size:()I
      30: ifle          46
      33: aload         5
      35: iconst_0
      36: invokeinterface #24,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      41: checkcast     #25                 // class java/lang/String
      44: astore        4
      46: aload         4
      48: invokestatic  #26                 // Method org/apache/wss4j/common/saml/OpenSAMLUtil.isMethodHolderOfKey:(Ljava/lang/String;)Z
      51: ifeq          66
      54: aload_1
      55: invokevirtual #27                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.isSigned:()Z
      58: ifeq          66
      61: aload_2
      62: iconst_1
      63: invokevirtual #28                 // Method org/apache/wss4j/dom/str/STRParserResult.setTrustedCredential:(Z)V
      66: aload_3
      67: areturn

  private void parseSAMLKeyIdentifier(org.apache.wss4j.common.token.SecurityTokenReference, org.apache.wss4j.dom.WSDocInfo, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.str.STRParserResult) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValueType:()Ljava/lang/String;
       4: astore        5
       6: aload_1
       7: invokevirtual #16                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValue:()Ljava/lang/String;
      10: aload         5
      12: bipush        9
      14: aload_3
      15: invokestatic  #30                 // Method org/apache/wss4j/dom/str/STRParserUtil.getSecretKeyFromToken:(Ljava/lang/String;Ljava/lang/String;ILorg/apache/wss4j/dom/handler/RequestData;)[B
      18: astore        6
      20: aload         6
      22: ifnonnull     135
      25: aload_1
      26: aload_1
      27: invokevirtual #31                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
      30: aload_3
      31: aload_2
      32: invokestatic  #32                 // Method org/apache/wss4j/dom/str/STRParserUtil.getAssertionFromKeyIdentifier:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
      35: astore        7
      37: aload_1
      38: aload         7
      40: aload_3
      41: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
      44: invokestatic  #33                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkSamlTokenBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      47: aload         7
      49: new           #34                 // class org/apache/wss4j/dom/saml/WSSSAMLKeyInfoProcessor
      52: dup
      53: aload_3
      54: aload_2
      55: invokespecial #35                 // Method org/apache/wss4j/dom/saml/WSSSAMLKeyInfoProcessor."<init>":(Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)V
      58: aload_3
      59: invokevirtual #36                 // Method org/apache/wss4j/dom/handler/RequestData.getSigVerCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
      62: aload_3
      63: invokevirtual #37                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      66: invokestatic  #38                 // Method org/apache/wss4j/common/saml/SAMLUtil.getCredentialFromSubject:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/common/saml/SAMLKeyInfoProcessor;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;)Lorg/apache/wss4j/common/saml/SAMLKeyInfo;
      69: astore        8
      71: aload         8
      73: invokevirtual #39                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getCerts:()[Ljava/security/cert/X509Certificate;
      76: astore        9
      78: aload         9
      80: ifnull        105
      83: aload         9
      85: arraylength
      86: ifle          105
      89: aload         4
      91: iconst_1
      92: anewarray     #40                 // class java/security/cert/X509Certificate
      95: dup
      96: iconst_0
      97: aload         9
      99: iconst_0
     100: aaload
     101: aastore
     102: invokevirtual #41                 // Method org/apache/wss4j/dom/str/STRParserResult.setCerts:([Ljava/security/cert/X509Certificate;)V
     105: aload         8
     107: invokevirtual #42                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getSecret:()[B
     110: astore        6
     112: aload         4
     114: aload         8
     116: invokevirtual #43                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getPublicKey:()Ljava/security/PublicKey;
     119: invokevirtual #44                 // Method org/apache/wss4j/dom/str/STRParserResult.setPublicKey:(Ljava/security/PublicKey;)V
     122: aload         4
     124: aload_0
     125: aload         7
     127: aload         4
     129: invokespecial #45                 // Method createPrincipalFromSAML:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/dom/str/STRParserResult;)Ljava/security/Principal;
     132: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     135: aload         4
     137: aload         6
     139: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     142: return

  private void parseBSTKeyIdentifier(org.apache.wss4j.common.token.SecurityTokenReference, org.apache.wss4j.common.crypto.Crypto, org.apache.wss4j.dom.WSDocInfo, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.str.STRParserResult) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: aconst_null
       2: aload         4
       4: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
       7: invokestatic  #48                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkBinarySecurityBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/token/BinarySecurity;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      10: aload_1
      11: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValueType:()Ljava/lang/String;
      14: astore        6
      16: ldc           #49                 // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#Kerberosv5APREQSHA1
      18: aload         6
      20: invokevirtual #50                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      23: ifeq          192
      26: aload_1
      27: invokevirtual #16                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValue:()Ljava/lang/String;
      30: aload         6
      32: bipush        9
      34: aload         4
      36: invokestatic  #30                 // Method org/apache/wss4j/dom/str/STRParserUtil.getSecretKeyFromToken:(Ljava/lang/String;Ljava/lang/String;ILorg/apache/wss4j/dom/handler/RequestData;)[B
      39: astore        7
      41: aload         7
      43: ifnonnull     166
      46: aload_1
      47: invokevirtual #51                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getSKIBytes:()[B
      50: astore        8
      52: aload_3
      53: sipush        4096
      56: invokestatic  #52                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      59: invokevirtual #53                 // Method org/apache/wss4j/dom/WSDocInfo.getResultsByTag:(Ljava/lang/Integer;)Ljava/util/List;
      62: astore        9
      64: aload         9
      66: invokeinterface #54,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      71: astore        10
      73: aload         10
      75: invokeinterface #55,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      80: ifeq          163
      83: aload         10
      85: invokeinterface #56,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      90: checkcast     #57                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
      93: astore        11
      95: aload         11
      97: ldc           #58                 // String binary-security-token
      99: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     102: checkcast     #60                 // class org/apache/wss4j/common/token/BinarySecurity
     105: astore        12
     107: aload         12
     109: invokevirtual #61                 // Method org/apache/wss4j/common/token/BinarySecurity.getToken:()[B
     112: invokestatic  #62                 // Method org/apache/wss4j/common/util/KeyUtils.generateDigest:([B)[B
     115: astore        13
     117: aload         13
     119: aload         8
     121: invokestatic  #63                 // Method java/util/Arrays.equals:([B[B)Z
     124: ifeq          160
     127: aload         11
     129: ldc           #64                 // String secret
     131: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     134: checkcast     #65                 // class "[B"
     137: checkcast     #65                 // class "[B"
     140: astore        7
     142: aload         5
     144: aload         11
     146: ldc           #66                 // String principal
     148: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     151: checkcast     #67                 // class java/security/Principal
     154: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     157: goto          163
     160: goto          73
     163: goto          182
     166: aload         5
     168: new           #68                 // class org/apache/wss4j/common/principal/CustomTokenPrincipal
     171: dup
     172: aload_1
     173: invokevirtual #16                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValue:()Ljava/lang/String;
     176: invokespecial #69                 // Method org/apache/wss4j/common/principal/CustomTokenPrincipal."<init>":(Ljava/lang/String;)V
     179: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     182: aload         5
     184: aload         7
     186: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     189: goto          519
     192: aload_1
     193: aload_2
     194: invokevirtual #70                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifier:(Lorg/apache/wss4j/common/crypto/Crypto;)[Ljava/security/cert/X509Certificate;
     197: astore        7
     199: aload         7
     201: ifnonnull     498
     204: ldc           #71                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier
     206: aload         6
     208: invokevirtual #50                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     211: ifeq          329
     214: aload_1
     215: invokevirtual #51                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getSKIBytes:()[B
     218: astore        8
     220: aload_3
     221: sipush        4096
     224: invokestatic  #52                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     227: invokevirtual #53                 // Method org/apache/wss4j/dom/WSDocInfo.getResultsByTag:(Ljava/lang/Integer;)Ljava/util/List;
     230: astore        9
     232: aload         9
     234: invokeinterface #54,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     239: astore        10
     241: aload         10
     243: invokeinterface #55,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     248: ifeq          326
     251: aload         10
     253: invokeinterface #56,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     258: checkcast     #57                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     261: astore        11
     263: aload         11
     265: ldc           #72                 // String x509-certificates
     267: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     270: checkcast     #73                 // class "[Ljava/security/cert/X509Certificate;"
     273: checkcast     #73                 // class "[Ljava/security/cert/X509Certificate;"
     276: astore        12
     278: aload         12
     280: ifnull        323
     283: aload         8
     285: aload_2
     286: aload         12
     288: iconst_0
     289: aaload
     290: invokeinterface #74,  2           // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getSKIBytesFromCert:(Ljava/security/cert/X509Certificate;)[B
     295: invokestatic  #63                 // Method java/util/Arrays.equals:([B[B)Z
     298: ifeq          323
     301: aload         5
     303: aload         11
     305: ldc           #66                 // String principal
     307: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     310: checkcast     #67                 // class java/security/Principal
     313: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     316: aload         12
     318: astore        7
     320: goto          326
     323: goto          241
     326: goto          498
     329: ldc           #75                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#ThumbprintSHA1
     331: aload         6
     333: invokevirtual #50                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     336: ifeq          498
     339: aload_1
     340: invokevirtual #16                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValue:()Ljava/lang/String;
     343: astore        8
     345: aload_3
     346: sipush        4096
     349: invokestatic  #52                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     352: invokevirtual #53                 // Method org/apache/wss4j/dom/WSDocInfo.getResultsByTag:(Ljava/lang/Integer;)Ljava/util/List;
     355: astore        9
     357: aload         9
     359: invokeinterface #54,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     364: astore        10
     366: aload         10
     368: invokeinterface #55,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     373: ifeq          498
     376: aload         10
     378: invokeinterface #56,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     383: checkcast     #57                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     386: astore        11
     388: aload         11
     390: ldc           #72                 // String x509-certificates
     392: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     395: checkcast     #73                 // class "[Ljava/security/cert/X509Certificate;"
     398: checkcast     #73                 // class "[Ljava/security/cert/X509Certificate;"
     401: astore        12
     403: aload         12
     405: ifnull        495
     408: aload         12
     410: iconst_0
     411: aaload
     412: invokevirtual #76                 // Method java/security/cert/X509Certificate.getEncoded:()[B
     415: invokestatic  #62                 // Method org/apache/wss4j/common/util/KeyUtils.generateDigest:([B)[B
     418: astore        13
     420: aload         8
     422: invokestatic  #77                 // Method org/apache/xml/security/utils/Base64.decode:(Ljava/lang/String;)[B
     425: aload         13
     427: invokestatic  #63                 // Method java/util/Arrays.equals:([B[B)Z
     430: ifeq          455
     433: aload         5
     435: aload         11
     437: ldc           #66                 // String principal
     439: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     442: checkcast     #67                 // class java/security/Principal
     445: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     448: aload         12
     450: astore        7
     452: goto          498
     455: goto          475
     458: astore        14
     460: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
     463: dup
     464: getstatic     #6                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     467: aload         14
     469: ldc           #79                 // String decoding.general
     471: invokespecial #80                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     474: athrow
     475: goto          495
     478: astore        13
     480: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
     483: dup
     484: getstatic     #82                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     487: aload         13
     489: ldc           #83                 // String encodeError
     491: invokespecial #80                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     494: athrow
     495: goto          366
     498: aload         7
     500: ifnull        519
     503: aload         5
     505: iconst_1
     506: anewarray     #40                 // class java/security/cert/X509Certificate
     509: dup
     510: iconst_0
     511: aload         7
     513: iconst_0
     514: aaload
     515: aastore
     516: invokevirtual #41                 // Method org/apache/wss4j/dom/str/STRParserResult.setCerts:([Ljava/security/cert/X509Certificate;)V
     519: return
    Exception table:
       from    to  target type
         420   452   458   Class org/apache/xml/security/exceptions/Base64DecodingException
         408   452   478   Class java/security/cert/CertificateEncodingException
         455   475   478   Class java/security/cert/CertificateEncodingException

  private org.apache.wss4j.dom.str.STRParserResult processPreviousResult(org.apache.wss4j.dom.engine.WSSecurityEngineResult, org.apache.wss4j.common.token.SecurityTokenReference, org.apache.wss4j.dom.str.STRParserParameters) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #84                 // class org/apache/wss4j/dom/str/STRParserResult
       3: dup
       4: invokespecial #85                 // Method org/apache/wss4j/dom/str/STRParserResult."<init>":()V
       7: astore        4
       9: aload_3
      10: invokevirtual #2                  // Method org/apache/wss4j/dom/str/STRParserParameters.getData:()Lorg/apache/wss4j/dom/handler/RequestData;
      13: astore        5
      15: aload_1
      16: ldc           #86                 // String action
      18: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      21: checkcast     #87                 // class java/lang/Integer
      24: astore        6
      26: aload         6
      28: ifnull        111
      31: sipush        8192
      34: aload         6
      36: invokevirtual #88                 // Method java/lang/Integer.intValue:()I
      39: if_icmpeq     51
      42: iconst_1
      43: aload         6
      45: invokevirtual #88                 // Method java/lang/Integer.intValue:()I
      48: if_icmpne     111
      51: aload_2
      52: aload         5
      54: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
      57: invokestatic  #89                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkUsernameTokenBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      60: aload_1
      61: ldc           #90                 // String username-token
      63: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      66: checkcast     #91                 // class org/apache/wss4j/dom/message/token/UsernameToken
      69: astore        7
      71: aload         7
      73: aload         5
      75: invokevirtual #37                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      78: invokevirtual #92                 // Method org/apache/wss4j/dom/message/token/UsernameToken.setRawPassword:(Ljavax/security/auth/callback/CallbackHandler;)V
      81: aload         4
      83: aload_1
      84: ldc           #64                 // String secret
      86: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      89: checkcast     #65                 // class "[B"
      92: checkcast     #65                 // class "[B"
      95: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
      98: aload         4
     100: aload         7
     102: invokevirtual #93                 // Method org/apache/wss4j/dom/message/token/UsernameToken.createPrincipal:()Ljava/security/Principal;
     105: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     108: goto          583
     111: aload         6
     113: ifnull        211
     116: sipush        4096
     119: aload         6
     121: invokevirtual #88                 // Method java/lang/Integer.intValue:()I
     124: if_icmpne     211
     127: aload_1
     128: ldc           #58                 // String binary-security-token
     130: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     133: checkcast     #60                 // class org/apache/wss4j/common/token/BinarySecurity
     136: astore        7
     138: aload_2
     139: aload         7
     141: aload         5
     143: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     146: invokestatic  #48                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkBinarySecurityBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/token/BinarySecurity;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     149: aload         4
     151: aload_1
     152: ldc           #72                 // String x509-certificates
     154: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     157: checkcast     #73                 // class "[Ljava/security/cert/X509Certificate;"
     160: checkcast     #73                 // class "[Ljava/security/cert/X509Certificate;"
     163: invokevirtual #41                 // Method org/apache/wss4j/dom/str/STRParserResult.setCerts:([Ljava/security/cert/X509Certificate;)V
     166: aload         4
     168: aload_1
     169: ldc           #64                 // String secret
     171: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     174: checkcast     #65                 // class "[B"
     177: checkcast     #65                 // class "[B"
     180: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     183: aload_1
     184: ldc           #94                 // String validated-token
     186: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     189: checkcast     #95                 // class java/lang/Boolean
     192: astore        8
     194: aload         8
     196: invokevirtual #96                 // Method java/lang/Boolean.booleanValue:()Z
     199: ifeq          208
     202: aload         4
     204: iconst_1
     205: invokevirtual #28                 // Method org/apache/wss4j/dom/str/STRParserResult.setTrustedCredential:(Z)V
     208: goto          583
     211: aload         6
     213: ifnull        279
     216: iconst_4
     217: aload         6
     219: invokevirtual #88                 // Method java/lang/Integer.intValue:()I
     222: if_icmpne     279
     225: aload_2
     226: aload         5
     228: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     231: invokestatic  #97                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkEncryptedKeyBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     234: aload         4
     236: aload_1
     237: ldc           #64                 // String secret
     239: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     242: checkcast     #65                 // class "[B"
     245: checkcast     #65                 // class "[B"
     248: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     251: aload_1
     252: ldc           #98                 // String id
     254: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     257: checkcast     #25                 // class java/lang/String
     260: astore        7
     262: aload         4
     264: new           #68                 // class org/apache/wss4j/common/principal/CustomTokenPrincipal
     267: dup
     268: aload         7
     270: invokespecial #69                 // Method org/apache/wss4j/common/principal/CustomTokenPrincipal."<init>":(Ljava/lang/String;)V
     273: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     276: goto          583
     279: aload         6
     281: ifnull        343
     284: sipush        1024
     287: aload         6
     289: invokevirtual #88                 // Method java/lang/Integer.intValue:()I
     292: if_icmpne     343
     295: aload         4
     297: aload_1
     298: ldc           #64                 // String secret
     300: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     303: checkcast     #65                 // class "[B"
     306: checkcast     #65                 // class "[B"
     309: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     312: aload_1
     313: ldc           #99                 // String security-context-token
     315: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     318: checkcast     #100                // class org/apache/wss4j/dom/message/token/SecurityContextToken
     321: astore        7
     323: aload         4
     325: new           #68                 // class org/apache/wss4j/common/principal/CustomTokenPrincipal
     328: dup
     329: aload         7
     331: invokevirtual #101                // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getIdentifier:()Ljava/lang/String;
     334: invokespecial #69                 // Method org/apache/wss4j/common/principal/CustomTokenPrincipal."<init>":(Ljava/lang/String;)V
     337: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     340: goto          583
     343: aload         6
     345: ifnull        450
     348: sipush        2048
     351: aload         6
     353: invokevirtual #88                 // Method java/lang/Integer.intValue:()I
     356: if_icmpne     450
     359: aload_1
     360: ldc           #102                // String derived-key-token
     362: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     365: checkcast     #103                // class org/apache/wss4j/dom/message/token/DerivedKeyToken
     368: astore        7
     370: aload         7
     372: invokevirtual #104                // Method org/apache/wss4j/dom/message/token/DerivedKeyToken.getLength:()I
     375: istore        8
     377: iload         8
     379: ifgt          395
     382: aload_3
     383: invokevirtual #105                // Method org/apache/wss4j/dom/str/STRParserParameters.getDerivationKeyLength:()I
     386: ifle          395
     389: aload_3
     390: invokevirtual #105                // Method org/apache/wss4j/dom/str/STRParserParameters.getDerivationKeyLength:()I
     393: istore        8
     395: aload_1
     396: ldc           #64                 // String secret
     398: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     401: checkcast     #65                 // class "[B"
     404: checkcast     #65                 // class "[B"
     407: astore        9
     409: aload         7
     411: invokevirtual #106                // Method org/apache/wss4j/dom/message/token/DerivedKeyToken.createPrincipal:()Ljava/security/Principal;
     414: astore        10
     416: aload         10
     418: checkcast     #107                // class org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal
     421: aload         9
     423: invokevirtual #108                // Method org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal.setSecret:([B)V
     426: aload         4
     428: aload         10
     430: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     433: aload         4
     435: aload         7
     437: iload         8
     439: aload         9
     441: invokevirtual #109                // Method org/apache/wss4j/dom/message/token/DerivedKeyToken.deriveKey:(I[B)[B
     444: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     447: goto          583
     450: aload         6
     452: ifnull        583
     455: bipush        8
     457: aload         6
     459: invokevirtual #88                 // Method java/lang/Integer.intValue:()I
     462: if_icmpeq     475
     465: bipush        16
     467: aload         6
     469: invokevirtual #88                 // Method java/lang/Integer.intValue:()I
     472: if_icmpne     583
     475: aload_1
     476: ldc           #110                // String saml-assertion
     478: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     481: checkcast     #111                // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     484: astore        7
     486: aload_2
     487: aload         7
     489: aload         5
     491: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     494: invokestatic  #33                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkSamlTokenBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     497: aload         7
     499: invokevirtual #112                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSubjectKeyInfo:()Lorg/apache/wss4j/common/saml/SAMLKeyInfo;
     502: astore        8
     504: aload         8
     506: ifnonnull     522
     509: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
     512: dup
     513: getstatic     #6                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     516: ldc           #113                // String invalidSAMLsecurity
     518: invokespecial #8                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     521: athrow
     522: aload         8
     524: invokevirtual #39                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getCerts:()[Ljava/security/cert/X509Certificate;
     527: astore        9
     529: aload         9
     531: ifnull        550
     534: aload         4
     536: iconst_1
     537: anewarray     #40                 // class java/security/cert/X509Certificate
     540: dup
     541: iconst_0
     542: aload         9
     544: iconst_0
     545: aaload
     546: aastore
     547: invokevirtual #41                 // Method org/apache/wss4j/dom/str/STRParserResult.setCerts:([Ljava/security/cert/X509Certificate;)V
     550: aload         4
     552: aload         8
     554: invokevirtual #42                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getSecret:()[B
     557: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     560: aload         4
     562: aload         8
     564: invokevirtual #43                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getPublicKey:()Ljava/security/PublicKey;
     567: invokevirtual #44                 // Method org/apache/wss4j/dom/str/STRParserResult.setPublicKey:(Ljava/security/PublicKey;)V
     570: aload         4
     572: aload_0
     573: aload         7
     575: aload         4
     577: invokespecial #45                 // Method createPrincipalFromSAML:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/dom/str/STRParserResult;)Ljava/security/Principal;
     580: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     583: aload_0
     584: aload_2
     585: invokespecial #114                // Method getReferenceType:(Lorg/apache/wss4j/common/token/SecurityTokenReference;)Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;
     588: astore        7
     590: aload         7
     592: ifnull        602
     595: aload         4
     597: aload         7
     599: invokevirtual #115                // Method org/apache/wss4j/dom/str/STRParserResult.setReferenceType:(Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;)V
     602: aload         4
     604: areturn

  private org.apache.wss4j.dom.str.STRParserResult processSTR(org.apache.wss4j.common.token.SecurityTokenReference, java.lang.String, org.apache.wss4j.dom.str.STRParserParameters) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #84                 // class org/apache/wss4j/dom/str/STRParserResult
       3: dup
       4: invokespecial #85                 // Method org/apache/wss4j/dom/str/STRParserResult."<init>":()V
       7: astore        4
       9: aload_3
      10: invokevirtual #2                  // Method org/apache/wss4j/dom/str/STRParserParameters.getData:()Lorg/apache/wss4j/dom/handler/RequestData;
      13: astore        5
      15: aload_3
      16: invokevirtual #3                  // Method org/apache/wss4j/dom/str/STRParserParameters.getWsDocInfo:()Lorg/apache/wss4j/dom/WSDocInfo;
      19: astore        6
      21: aload_3
      22: invokevirtual #4                  // Method org/apache/wss4j/dom/str/STRParserParameters.getStrElement:()Lorg/w3c/dom/Element;
      25: astore        7
      27: aload_1
      28: invokevirtual #116                // Method org/apache/wss4j/common/token/SecurityTokenReference.containsReference:()Z
      31: ifeq          594
      34: aload_1
      35: invokevirtual #12                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getReference:()Lorg/apache/wss4j/common/token/Reference;
      38: astore        8
      40: aload_2
      41: aload         8
      43: invokevirtual #117                // Method org/apache/wss4j/common/token/Reference.getValueType:()Ljava/lang/String;
      46: bipush        9
      48: aload         5
      50: invokestatic  #30                 // Method org/apache/wss4j/dom/str/STRParserUtil.getSecretKeyFromToken:(Ljava/lang/String;Ljava/lang/String;ILorg/apache/wss4j/dom/handler/RequestData;)[B
      53: astore        9
      55: new           #68                 // class org/apache/wss4j/common/principal/CustomTokenPrincipal
      58: dup
      59: aload_2
      60: invokespecial #69                 // Method org/apache/wss4j/common/principal/CustomTokenPrincipal."<init>":(Ljava/lang/String;)V
      63: astore        10
      65: aload         9
      67: ifnonnull     577
      70: aload         7
      72: invokeinterface #118,  1          // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
      77: aload         6
      79: aload         5
      81: invokevirtual #37                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      84: aload_2
      85: aload         8
      87: invokevirtual #117                // Method org/apache/wss4j/common/token/Reference.getValueType:()Ljava/lang/String;
      90: invokestatic  #119                // Method org/apache/wss4j/dom/str/STRParserUtil.getTokenElement:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/WSDocInfo;Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      93: astore        11
      95: new           #120                // class javax/xml/namespace/QName
      98: dup
      99: aload         11
     101: invokeinterface #121,  1          // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
     106: aload         11
     108: invokeinterface #122,  1          // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
     113: invokespecial #123                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     116: astore        12
     118: aload         12
     120: getstatic     #124                // Field org/apache/wss4j/dom/WSConstants.BINARY_TOKEN:Ljavax/xml/namespace/QName;
     123: invokevirtual #125                // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
     126: ifeq          268
     129: aload         5
     131: invokevirtual #126                // Method org/apache/wss4j/dom/handler/RequestData.getWssConfig:()Lorg/apache/wss4j/dom/engine/WSSConfig;
     134: getstatic     #124                // Field org/apache/wss4j/dom/WSConstants.BINARY_TOKEN:Ljavax/xml/namespace/QName;
     137: invokevirtual #127                // Method org/apache/wss4j/dom/engine/WSSConfig.getProcessor:(Ljavax/xml/namespace/QName;)Lorg/apache/wss4j/dom/processor/Processor;
     140: astore        13
     142: aload         13
     144: aload         11
     146: aload_3
     147: invokevirtual #2                  // Method org/apache/wss4j/dom/str/STRParserParameters.getData:()Lorg/apache/wss4j/dom/handler/RequestData;
     150: aload_3
     151: invokevirtual #3                  // Method org/apache/wss4j/dom/str/STRParserParameters.getWsDocInfo:()Lorg/apache/wss4j/dom/WSDocInfo;
     154: invokeinterface #128,  4          // InterfaceMethod org/apache/wss4j/dom/processor/Processor.handleToken:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Ljava/util/List;
     159: astore        14
     161: aload         14
     163: iconst_0
     164: invokeinterface #24,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     169: checkcast     #57                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     172: ldc           #58                 // String binary-security-token
     174: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     177: checkcast     #60                 // class org/apache/wss4j/common/token/BinarySecurity
     180: astore        15
     182: aload_1
     183: aload         15
     185: aload         5
     187: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     190: invokestatic  #48                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkBinarySecurityBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/token/BinarySecurity;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     193: aload         4
     195: aload         14
     197: iconst_0
     198: invokeinterface #24,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     203: checkcast     #57                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     206: ldc           #72                 // String x509-certificates
     208: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     211: checkcast     #73                 // class "[Ljava/security/cert/X509Certificate;"
     214: checkcast     #73                 // class "[Ljava/security/cert/X509Certificate;"
     217: invokevirtual #41                 // Method org/apache/wss4j/dom/str/STRParserResult.setCerts:([Ljava/security/cert/X509Certificate;)V
     220: aload         14
     222: iconst_0
     223: invokeinterface #24,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     228: checkcast     #57                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     231: ldc           #64                 // String secret
     233: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     236: checkcast     #65                 // class "[B"
     239: checkcast     #65                 // class "[B"
     242: astore        9
     244: aload         14
     246: iconst_0
     247: invokeinterface #24,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     252: checkcast     #57                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     255: ldc           #66                 // String principal
     257: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     260: checkcast     #67                 // class java/security/Principal
     263: astore        10
     265: goto          577
     268: aload         12
     270: getstatic     #129                // Field org/apache/wss4j/dom/WSConstants.SAML_TOKEN:Ljavax/xml/namespace/QName;
     273: invokevirtual #125                // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
     276: ifne          290
     279: aload         12
     281: getstatic     #130                // Field org/apache/wss4j/dom/WSConstants.SAML2_TOKEN:Ljavax/xml/namespace/QName;
     284: invokevirtual #125                // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
     287: ifeq          486
     290: aload         5
     292: invokevirtual #126                // Method org/apache/wss4j/dom/handler/RequestData.getWssConfig:()Lorg/apache/wss4j/dom/engine/WSSConfig;
     295: getstatic     #129                // Field org/apache/wss4j/dom/WSConstants.SAML_TOKEN:Ljavax/xml/namespace/QName;
     298: invokevirtual #127                // Method org/apache/wss4j/dom/engine/WSSConfig.getProcessor:(Ljavax/xml/namespace/QName;)Lorg/apache/wss4j/dom/processor/Processor;
     301: astore        13
     303: aload         7
     305: invokeinterface #118,  1          // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     310: aload         6
     312: aload         5
     314: invokevirtual #37                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     317: aload_2
     318: aload_1
     319: invokevirtual #12                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getReference:()Lorg/apache/wss4j/common/token/Reference;
     322: invokevirtual #117                // Method org/apache/wss4j/common/token/Reference.getValueType:()Ljava/lang/String;
     325: invokestatic  #131                // Method org/apache/wss4j/dom/str/STRParserUtil.findProcessedTokenElement:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/WSDocInfo;Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     328: astore        14
     330: aconst_null
     331: astore        15
     333: aload         14
     335: ifnonnull     377
     338: aload         13
     340: aload         11
     342: aload         5
     344: aload         6
     346: invokeinterface #128,  4          // InterfaceMethod org/apache/wss4j/dom/processor/Processor.handleToken:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Ljava/util/List;
     351: astore        16
     353: aload         16
     355: iconst_0
     356: invokeinterface #24,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     361: checkcast     #57                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     364: ldc           #110                // String saml-assertion
     366: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     369: checkcast     #111                // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     372: astore        15
     374: goto          414
     377: new           #111                // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     380: dup
     381: aload         14
     383: invokespecial #132                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper."<init>":(Lorg/w3c/dom/Element;)V
     386: astore        15
     388: aload         15
     390: new           #34                 // class org/apache/wss4j/dom/saml/WSSSAMLKeyInfoProcessor
     393: dup
     394: aload         5
     396: aload         6
     398: invokespecial #35                 // Method org/apache/wss4j/dom/saml/WSSSAMLKeyInfoProcessor."<init>":(Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)V
     401: aload         5
     403: invokevirtual #36                 // Method org/apache/wss4j/dom/handler/RequestData.getSigVerCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     406: aload         5
     408: invokevirtual #37                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     411: invokevirtual #133                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.parseSubject:(Lorg/apache/wss4j/common/saml/SAMLKeyInfoProcessor;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;)V
     414: aload_1
     415: aload         15
     417: aload         5
     419: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     422: invokestatic  #33                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkSamlTokenBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     425: aload         15
     427: invokevirtual #112                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSubjectKeyInfo:()Lorg/apache/wss4j/common/saml/SAMLKeyInfo;
     430: astore        16
     432: aload         16
     434: invokevirtual #39                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getCerts:()[Ljava/security/cert/X509Certificate;
     437: astore        17
     439: aload         17
     441: ifnull        466
     444: aload         17
     446: arraylength
     447: ifle          466
     450: aload         4
     452: iconst_1
     453: anewarray     #40                 // class java/security/cert/X509Certificate
     456: dup
     457: iconst_0
     458: aload         17
     460: iconst_0
     461: aaload
     462: aastore
     463: invokevirtual #41                 // Method org/apache/wss4j/dom/str/STRParserResult.setCerts:([Ljava/security/cert/X509Certificate;)V
     466: aload         16
     468: invokevirtual #42                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getSecret:()[B
     471: astore        9
     473: aload_0
     474: aload         15
     476: aload         4
     478: invokespecial #45                 // Method createPrincipalFromSAML:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/dom/str/STRParserResult;)Ljava/security/Principal;
     481: astore        10
     483: goto          577
     486: aload         12
     488: getstatic     #134                // Field org/apache/wss4j/dom/WSConstants.ENCRYPTED_KEY:Ljavax/xml/namespace/QName;
     491: invokevirtual #125                // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
     494: ifeq          577
     497: aload_1
     498: aload         5
     500: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     503: invokestatic  #97                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkEncryptedKeyBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     506: aload         5
     508: invokevirtual #126                // Method org/apache/wss4j/dom/handler/RequestData.getWssConfig:()Lorg/apache/wss4j/dom/engine/WSSConfig;
     511: getstatic     #134                // Field org/apache/wss4j/dom/WSConstants.ENCRYPTED_KEY:Ljavax/xml/namespace/QName;
     514: invokevirtual #127                // Method org/apache/wss4j/dom/engine/WSSConfig.getProcessor:(Ljavax/xml/namespace/QName;)Lorg/apache/wss4j/dom/processor/Processor;
     517: astore        13
     519: aload         13
     521: aload         11
     523: aload         5
     525: aload         6
     527: invokeinterface #128,  4          // InterfaceMethod org/apache/wss4j/dom/processor/Processor.handleToken:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Ljava/util/List;
     532: astore        14
     534: aload         14
     536: iconst_0
     537: invokeinterface #24,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     542: checkcast     #57                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     545: ldc           #64                 // String secret
     547: invokevirtual #59                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     550: checkcast     #65                 // class "[B"
     553: checkcast     #65                 // class "[B"
     556: astore        9
     558: new           #68                 // class org/apache/wss4j/common/principal/CustomTokenPrincipal
     561: dup
     562: aload         11
     564: aconst_null
     565: ldc           #135                // String Id
     567: invokeinterface #136,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     572: invokespecial #69                 // Method org/apache/wss4j/common/principal/CustomTokenPrincipal."<init>":(Ljava/lang/String;)V
     575: astore        10
     577: aload         4
     579: aload         9
     581: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     584: aload         4
     586: aload         10
     588: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     591: goto          814
     594: aload_1
     595: invokevirtual #137                // Method org/apache/wss4j/common/token/SecurityTokenReference.containsX509Data:()Z
     598: ifne          608
     601: aload_1
     602: invokevirtual #138                // Method org/apache/wss4j/common/token/SecurityTokenReference.containsX509IssuerSerial:()Z
     605: ifeq          661
     608: aload         4
     610: getstatic     #139                // Field org/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE.ISSUER_SERIAL:Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;
     613: invokevirtual #115                // Method org/apache/wss4j/dom/str/STRParserResult.setReferenceType:(Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;)V
     616: aload         5
     618: invokevirtual #36                 // Method org/apache/wss4j/dom/handler/RequestData.getSigVerCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     621: astore        8
     623: aload_1
     624: aload         8
     626: invokevirtual #140                // Method org/apache/wss4j/common/token/SecurityTokenReference.getX509IssuerSerial:(Lorg/apache/wss4j/common/crypto/Crypto;)[Ljava/security/cert/X509Certificate;
     629: astore        9
     631: aload         9
     633: ifnull        658
     636: aload         9
     638: arraylength
     639: ifle          658
     642: aload         4
     644: iconst_1
     645: anewarray     #40                 // class java/security/cert/X509Certificate
     648: dup
     649: iconst_0
     650: aload         9
     652: iconst_0
     653: aaload
     654: aastore
     655: invokevirtual #41                 // Method org/apache/wss4j/dom/str/STRParserResult.setCerts:([Ljava/security/cert/X509Certificate;)V
     658: goto          814
     661: aload_1
     662: invokevirtual #15                 // Method org/apache/wss4j/common/token/SecurityTokenReference.containsKeyIdentifier:()Z
     665: ifeq          789
     668: aload_1
     669: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValueType:()Ljava/lang/String;
     672: ldc           #141                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKeySHA1
     674: invokevirtual #50                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     677: ifeq          728
     680: aload_1
     681: aload         5
     683: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
     686: invokestatic  #97                 // Method org/apache/wss4j/dom/str/STRParserUtil.checkEncryptedKeyBSPCompliance:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     689: aload_1
     690: invokevirtual #16                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValue:()Ljava/lang/String;
     693: astore        8
     695: aload         4
     697: aload         8
     699: ldc           #141                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKeySHA1
     701: bipush        9
     703: aload         5
     705: invokestatic  #30                 // Method org/apache/wss4j/dom/str/STRParserUtil.getSecretKeyFromToken:(Ljava/lang/String;Ljava/lang/String;ILorg/apache/wss4j/dom/handler/RequestData;)[B
     708: invokevirtual #47                 // Method org/apache/wss4j/dom/str/STRParserResult.setSecretKey:([B)V
     711: aload         4
     713: new           #68                 // class org/apache/wss4j/common/principal/CustomTokenPrincipal
     716: dup
     717: aload         8
     719: invokespecial #69                 // Method org/apache/wss4j/common/principal/CustomTokenPrincipal."<init>":(Ljava/lang/String;)V
     722: invokevirtual #46                 // Method org/apache/wss4j/dom/str/STRParserResult.setPrincipal:(Ljava/security/Principal;)V
     725: goto          814
     728: ldc           #142                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     730: aload_1
     731: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValueType:()Ljava/lang/String;
     734: invokevirtual #50                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     737: ifne          752
     740: ldc           #143                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     742: aload_1
     743: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValueType:()Ljava/lang/String;
     746: invokevirtual #50                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     749: ifeq          766
     752: aload_0
     753: aload_1
     754: aload         6
     756: aload         5
     758: aload         4
     760: invokespecial #144                // Method parseSAMLKeyIdentifier:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/dom/WSDocInfo;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/str/STRParserResult;)V
     763: goto          814
     766: aload         5
     768: invokevirtual #36                 // Method org/apache/wss4j/dom/handler/RequestData.getSigVerCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     771: astore        8
     773: aload_0
     774: aload_1
     775: aload         8
     777: aload         6
     779: aload         5
     781: aload         4
     783: invokespecial #145                // Method parseBSTKeyIdentifier:(Lorg/apache/wss4j/common/token/SecurityTokenReference;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/wss4j/dom/WSDocInfo;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/str/STRParserResult;)V
     786: goto          814
     789: new           #5                  // class org/apache/wss4j/common/ext/WSSecurityException
     792: dup
     793: getstatic     #146                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     796: ldc           #147                // String unsupportedKeyInfo
     798: iconst_1
     799: anewarray     #148                // class java/lang/Object
     802: dup
     803: iconst_0
     804: aload         7
     806: invokevirtual #149                // Method java/lang/Object.toString:()Ljava/lang/String;
     809: aastore
     810: invokespecial #150                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     813: athrow
     814: aload_0
     815: aload_1
     816: invokespecial #114                // Method getReferenceType:(Lorg/apache/wss4j/common/token/SecurityTokenReference;)Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;
     819: astore        8
     821: aload         8
     823: ifnull        833
     826: aload         4
     828: aload         8
     830: invokevirtual #115                // Method org/apache/wss4j/dom/str/STRParserResult.setReferenceType:(Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;)V
     833: aload         4
     835: areturn

  private org.apache.wss4j.dom.str.STRParser$REFERENCE_TYPE getReferenceType(org.apache.wss4j.common.token.SecurityTokenReference);
    Code:
       0: aload_1
       1: invokevirtual #116                // Method org/apache/wss4j/common/token/SecurityTokenReference.containsReference:()Z
       4: ifeq          11
       7: getstatic     #151                // Field org/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE.DIRECT_REF:Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;
      10: areturn
      11: aload_1
      12: invokevirtual #15                 // Method org/apache/wss4j/common/token/SecurityTokenReference.containsKeyIdentifier:()Z
      15: ifeq          38
      18: ldc           #75                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#ThumbprintSHA1
      20: aload_1
      21: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValueType:()Ljava/lang/String;
      24: invokevirtual #50                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      27: ifeq          34
      30: getstatic     #152                // Field org/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE.THUMBPRINT_SHA1:Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;
      33: areturn
      34: getstatic     #153                // Field org/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE.KEY_IDENTIFIER:Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;
      37: areturn
      38: aconst_null
      39: areturn
}
