Compiled from "Merlin.java"
public class org.apache.wss4j.common.crypto.Merlin extends org.apache.wss4j.common.crypto.CryptoBase {
  public static final java.lang.String ENCRYPTED_PASSWORD_PREFIX;

  public static final java.lang.String ENCRYPTED_PASSWORD_SUFFIX;

  public static final java.lang.String PREFIX;

  public static final java.lang.String OLD_PREFIX;

  public static final java.lang.String OLD_KEYSTORE_FILE;

  public static final java.lang.String CRYPTO_KEYSTORE_PROVIDER;

  public static final java.lang.String CRYPTO_CERT_PROVIDER;

  public static final java.lang.String KEYSTORE_FILE;

  public static final java.lang.String KEYSTORE_PASSWORD;

  public static final java.lang.String KEYSTORE_TYPE;

  public static final java.lang.String KEYSTORE_ALIAS;

  public static final java.lang.String KEYSTORE_PRIVATE_PASSWORD;

  public static final java.lang.String LOAD_CA_CERTS;

  public static final java.lang.String TRUSTSTORE_FILE;

  public static final java.lang.String TRUSTSTORE_PASSWORD;

  public static final java.lang.String TRUSTSTORE_TYPE;

  public static final java.lang.String X509_CRL_FILE;

  private static final org.slf4j.Logger LOG;

  private static final boolean DO_DEBUG;

  protected java.util.Properties properties;

  protected java.security.KeyStore keystore;

  protected java.security.KeyStore truststore;

  protected java.security.cert.CertStore crlCertStore;

  protected boolean loadCACerts;

  protected boolean privatePasswordSet;

  protected org.apache.wss4j.common.crypto.PasswordEncryptor passwordEncryptor;

  public org.apache.wss4j.common.crypto.Merlin();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/wss4j/common/crypto/CryptoBase."<init>":()V
       4: return

  public org.apache.wss4j.common.crypto.Merlin(boolean, java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/wss4j/common/crypto/CryptoBase."<init>":()V
       4: aload_0
       5: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
       8: ifnonnull     203
      11: iload_1
      12: ifeq          203
      15: new           #3                  // class java/lang/StringBuilder
      18: dup
      19: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
      22: ldc           #5                  // String java.home
      24: invokestatic  #6                  // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      27: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      30: ldc           #8                  // String /lib/security/cacerts
      32: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      35: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      38: astore_3
      39: new           #10                 // class java/io/FileInputStream
      42: dup
      43: aload_3
      44: invokespecial #11                 // Method java/io/FileInputStream."<init>":(Ljava/lang/String;)V
      47: astore        4
      49: aconst_null
      50: astore        5
      52: aload_0
      53: invokestatic  #12                 // Method java/security/KeyStore.getDefaultType:()Ljava/lang/String;
      56: invokestatic  #13                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;)Ljava/security/KeyStore;
      59: putfield      #2                  // Field truststore:Ljava/security/KeyStore;
      62: aload_0
      63: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      66: aload         4
      68: aload_2
      69: invokevirtual #14                 // Method java/lang/String.toCharArray:()[C
      72: invokevirtual #15                 // Method java/security/KeyStore.load:(Ljava/io/InputStream;[C)V
      75: aload_0
      76: iconst_1
      77: putfield      #16                 // Field loadCACerts:Z
      80: aload         4
      82: ifnull        167
      85: aload         5
      87: ifnull        110
      90: aload         4
      92: invokevirtual #17                 // Method java/io/InputStream.close:()V
      95: goto          167
      98: astore        6
     100: aload         5
     102: aload         6
     104: invokevirtual #19                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     107: goto          167
     110: aload         4
     112: invokevirtual #17                 // Method java/io/InputStream.close:()V
     115: goto          167
     118: astore        6
     120: aload         6
     122: astore        5
     124: aload         6
     126: athrow
     127: astore        7
     129: aload         4
     131: ifnull        164
     134: aload         5
     136: ifnull        159
     139: aload         4
     141: invokevirtual #17                 // Method java/io/InputStream.close:()V
     144: goto          164
     147: astore        8
     149: aload         5
     151: aload         8
     153: invokevirtual #19                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     156: goto          164
     159: aload         4
     161: invokevirtual #17                 // Method java/io/InputStream.close:()V
     164: aload         7
     166: athrow
     167: goto          203
     170: astore        4
     172: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     175: new           #3                  // class java/lang/StringBuilder
     178: dup
     179: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     182: ldc           #22                 // String CA certs could not be loaded:
     184: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     187: aload         4
     189: invokevirtual #23                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     192: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     195: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     198: invokeinterface #24,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     203: return
    Exception table:
       from    to  target type
          90    95    98   Class java/lang/Throwable
          52    80   118   Class java/lang/Throwable
          52    80   127   any
         139   144   147   Class java/lang/Throwable
         118   129   127   any
          39   167   170   Class java/lang/Exception

  public org.apache.wss4j.common.crypto.Merlin(java.util.Properties, java.lang.ClassLoader, org.apache.wss4j.common.crypto.PasswordEncryptor) throws org.apache.wss4j.common.ext.WSSecurityException, java.io.IOException;
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/wss4j/common/crypto/CryptoBase."<init>":()V
       4: aload_0
       5: aload_1
       6: aload_2
       7: aload_3
       8: invokevirtual #25                 // Method loadProperties:(Ljava/util/Properties;Ljava/lang/ClassLoader;Lorg/apache/wss4j/common/crypto/PasswordEncryptor;)V
      11: return

  public void loadProperties(java.util.Properties, java.lang.ClassLoader, org.apache.wss4j.common.crypto.PasswordEncryptor) throws org.apache.wss4j.common.ext.WSSecurityException, java.io.IOException;
    Code:
       0: aload_1
       1: ifnonnull     5
       4: return
       5: aload_0
       6: aload_1
       7: putfield      #26                 // Field properties:Ljava/util/Properties;
      10: aload_0
      11: aload_3
      12: putfield      #27                 // Field passwordEncryptor:Lorg/apache/wss4j/common/crypto/PasswordEncryptor;
      15: ldc           #28                 // String org.apache.wss4j.crypto.merlin.
      17: astore        4
      19: aload_1
      20: invokevirtual #29                 // Method java/util/Properties.keySet:()Ljava/util/Set;
      23: invokeinterface #30,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      28: astore        5
      30: aload         5
      32: invokeinterface #31,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      37: ifeq          97
      40: aload         5
      42: invokeinterface #32,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      47: astore        6
      49: aload         6
      51: instanceof    #33                 // class java/lang/String
      54: ifeq          94
      57: aload         6
      59: checkcast     #33                 // class java/lang/String
      62: astore        7
      64: aload         7
      66: ldc           #28                 // String org.apache.wss4j.crypto.merlin.
      68: invokevirtual #34                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      71: ifeq          77
      74: goto          97
      77: aload         7
      79: ldc           #35                 // String org.apache.ws.security.crypto.merlin.
      81: invokevirtual #34                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      84: ifeq          94
      87: ldc           #35                 // String org.apache.ws.security.crypto.merlin.
      89: astore        4
      91: goto          97
      94: goto          30
      97: aload_1
      98: new           #3                  // class java/lang/StringBuilder
     101: dup
     102: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     105: aload         4
     107: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     110: ldc           #36                 // String keystore.provider
     112: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     115: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     118: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     121: astore        5
     123: aload         5
     125: ifnull        135
     128: aload         5
     130: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     133: astore        5
     135: aload_1
     136: new           #3                  // class java/lang/StringBuilder
     139: dup
     140: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     143: aload         4
     145: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     148: ldc           #39                 // String cert.provider
     150: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     153: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     156: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     159: astore        6
     161: aload         6
     163: ifnull        172
     166: aload_0
     167: aload         6
     169: invokevirtual #40                 // Method setCryptoProvider:(Ljava/lang/String;)V
     172: aload_1
     173: new           #3                  // class java/lang/StringBuilder
     176: dup
     177: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     180: aload         4
     182: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     185: ldc           #41                 // String keystore.alias
     187: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     190: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     193: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     196: astore        7
     198: aload         7
     200: ifnull        216
     203: aload         7
     205: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     208: astore        7
     210: aload_0
     211: aload         7
     213: invokevirtual #42                 // Method setDefaultX509Identifier:(Ljava/lang/String;)V
     216: aload_1
     217: new           #3                  // class java/lang/StringBuilder
     220: dup
     221: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     224: aload         4
     226: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     229: ldc           #43                 // String keystore.file
     231: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     234: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     237: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     240: astore        8
     242: aload         8
     244: ifnonnull     273
     247: aload_1
     248: new           #3                  // class java/lang/StringBuilder
     251: dup
     252: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     255: aload         4
     257: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     260: ldc           #44                 // String file
     262: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     265: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     268: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     271: astore        8
     273: aload         8
     275: ifnull        577
     278: aload         8
     280: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     283: astore        8
     285: aload_2
     286: aload         8
     288: invokestatic  #45                 // Method loadInputStream:(Ljava/lang/ClassLoader;Ljava/lang/String;)Ljava/io/InputStream;
     291: astore        9
     293: aconst_null
     294: astore        10
     296: aload_1
     297: new           #3                  // class java/lang/StringBuilder
     300: dup
     301: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     304: aload         4
     306: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     309: ldc           #46                 // String keystore.password
     311: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     314: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     317: ldc           #47                 // String security
     319: invokevirtual #48                 // Method java/util/Properties.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     322: astore        11
     324: aload         11
     326: ifnull        345
     329: aload         11
     331: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     334: astore        11
     336: aload_0
     337: aload         11
     339: aload_3
     340: invokevirtual #49                 // Method decryptPassword:(Ljava/lang/String;Lorg/apache/wss4j/common/crypto/PasswordEncryptor;)Ljava/lang/String;
     343: astore        11
     345: aload_1
     346: new           #3                  // class java/lang/StringBuilder
     349: dup
     350: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     353: aload         4
     355: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     358: ldc           #50                 // String keystore.type
     360: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     363: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     366: invokestatic  #12                 // Method java/security/KeyStore.getDefaultType:()Ljava/lang/String;
     369: invokevirtual #48                 // Method java/util/Properties.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     372: astore        12
     374: aload         12
     376: ifnull        386
     379: aload         12
     381: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     384: astore        12
     386: aload_0
     387: aload_0
     388: aload         9
     390: aload         11
     392: aload         5
     394: aload         12
     396: invokevirtual #51                 // Method load:(Ljava/io/InputStream;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/security/KeyStore;
     399: putfield      #52                 // Field keystore:Ljava/security/KeyStore;
     402: getstatic     #53                 // Field DO_DEBUG:Z
     405: ifeq          451
     408: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     411: new           #3                  // class java/lang/StringBuilder
     414: dup
     415: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     418: ldc           #54                 // String The KeyStore
     420: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     423: aload         8
     425: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     428: ldc           #55                 // String  of type
     430: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     433: aload         12
     435: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     438: ldc           #56                 // String  has been loaded
     440: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     443: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     446: invokeinterface #57,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     451: aload_1
     452: new           #3                  // class java/lang/StringBuilder
     455: dup
     456: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     459: aload         4
     461: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     464: ldc           #58                 // String keystore.private.password
     466: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     469: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     472: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     475: astore        13
     477: aload         13
     479: ifnull        487
     482: aload_0
     483: iconst_1
     484: putfield      #59                 // Field privatePasswordSet:Z
     487: aload         9
     489: ifnull        574
     492: aload         10
     494: ifnull        517
     497: aload         9
     499: invokevirtual #17                 // Method java/io/InputStream.close:()V
     502: goto          574
     505: astore        11
     507: aload         10
     509: aload         11
     511: invokevirtual #19                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     514: goto          574
     517: aload         9
     519: invokevirtual #17                 // Method java/io/InputStream.close:()V
     522: goto          574
     525: astore        11
     527: aload         11
     529: astore        10
     531: aload         11
     533: athrow
     534: astore        14
     536: aload         9
     538: ifnull        571
     541: aload         10
     543: ifnull        566
     546: aload         9
     548: invokevirtual #17                 // Method java/io/InputStream.close:()V
     551: goto          571
     554: astore        15
     556: aload         10
     558: aload         15
     560: invokevirtual #19                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     563: goto          571
     566: aload         9
     568: invokevirtual #17                 // Method java/io/InputStream.close:()V
     571: aload         14
     573: athrow
     574: goto          593
     577: getstatic     #53                 // Field DO_DEBUG:Z
     580: ifeq          593
     583: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     586: ldc           #60                 // String The KeyStore is not loaded as KEYSTORE_FILE is null
     588: invokeinterface #57,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     593: aload_1
     594: new           #3                  // class java/lang/StringBuilder
     597: dup
     598: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     601: aload         4
     603: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     606: ldc           #61                 // String truststore.file
     608: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     611: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     614: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     617: astore        9
     619: aload         9
     621: ifnull        892
     624: aload         9
     626: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     629: astore        9
     631: aload_2
     632: aload         9
     634: invokestatic  #45                 // Method loadInputStream:(Ljava/lang/ClassLoader;Ljava/lang/String;)Ljava/io/InputStream;
     637: astore        10
     639: aconst_null
     640: astore        11
     642: aload_1
     643: new           #3                  // class java/lang/StringBuilder
     646: dup
     647: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     650: aload         4
     652: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     655: ldc           #62                 // String truststore.password
     657: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     660: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     663: ldc           #63                 // String changeit
     665: invokevirtual #48                 // Method java/util/Properties.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     668: astore        12
     670: aload         12
     672: ifnull        691
     675: aload         12
     677: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     680: astore        12
     682: aload_0
     683: aload         12
     685: aload_3
     686: invokevirtual #49                 // Method decryptPassword:(Ljava/lang/String;Lorg/apache/wss4j/common/crypto/PasswordEncryptor;)Ljava/lang/String;
     689: astore        12
     691: aload_1
     692: new           #3                  // class java/lang/StringBuilder
     695: dup
     696: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     699: aload         4
     701: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     704: ldc           #64                 // String truststore.type
     706: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     709: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     712: invokestatic  #12                 // Method java/security/KeyStore.getDefaultType:()Ljava/lang/String;
     715: invokevirtual #48                 // Method java/util/Properties.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     718: astore        13
     720: aload         13
     722: ifnull        732
     725: aload         13
     727: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     730: astore        13
     732: aload_0
     733: aload_0
     734: aload         10
     736: aload         12
     738: aload         5
     740: aload         13
     742: invokevirtual #51                 // Method load:(Ljava/io/InputStream;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/security/KeyStore;
     745: putfield      #2                  // Field truststore:Ljava/security/KeyStore;
     748: getstatic     #53                 // Field DO_DEBUG:Z
     751: ifeq          797
     754: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     757: new           #3                  // class java/lang/StringBuilder
     760: dup
     761: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     764: ldc           #65                 // String The TrustStore
     766: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     769: aload         9
     771: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     774: ldc           #55                 // String  of type
     776: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     779: aload         13
     781: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     784: ldc           #56                 // String  has been loaded
     786: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     789: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     792: invokeinterface #57,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     797: aload_0
     798: iconst_0
     799: putfield      #16                 // Field loadCACerts:Z
     802: aload         10
     804: ifnull        889
     807: aload         11
     809: ifnull        832
     812: aload         10
     814: invokevirtual #17                 // Method java/io/InputStream.close:()V
     817: goto          889
     820: astore        12
     822: aload         11
     824: aload         12
     826: invokevirtual #19                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     829: goto          889
     832: aload         10
     834: invokevirtual #17                 // Method java/io/InputStream.close:()V
     837: goto          889
     840: astore        12
     842: aload         12
     844: astore        11
     846: aload         12
     848: athrow
     849: astore        16
     851: aload         10
     853: ifnull        886
     856: aload         11
     858: ifnull        881
     861: aload         10
     863: invokevirtual #17                 // Method java/io/InputStream.close:()V
     866: goto          886
     869: astore        17
     871: aload         11
     873: aload         17
     875: invokevirtual #19                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     878: goto          886
     881: aload         10
     883: invokevirtual #17                 // Method java/io/InputStream.close:()V
     886: aload         16
     888: athrow
     889: goto          1167
     892: aload_1
     893: new           #3                  // class java/lang/StringBuilder
     896: dup
     897: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     900: aload         4
     902: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     905: ldc           #66                 // String load.cacerts
     907: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     910: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     913: ldc           #67                 // String false
     915: invokevirtual #48                 // Method java/util/Properties.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     918: astore        10
     920: aload         10
     922: ifnull        932
     925: aload         10
     927: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     930: astore        10
     932: aload         10
     934: invokestatic  #68                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     937: invokevirtual #69                 // Method java/lang/Boolean.booleanValue:()Z
     940: ifeq          1167
     943: new           #3                  // class java/lang/StringBuilder
     946: dup
     947: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     950: ldc           #5                  // String java.home
     952: invokestatic  #6                  // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     955: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     958: ldc           #8                  // String /lib/security/cacerts
     960: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     963: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     966: astore        11
     968: aload         11
     970: ifnull        980
     973: aload         11
     975: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     978: astore        11
     980: new           #10                 // class java/io/FileInputStream
     983: dup
     984: aload         11
     986: invokespecial #11                 // Method java/io/FileInputStream."<init>":(Ljava/lang/String;)V
     989: astore        12
     991: aconst_null
     992: astore        13
     994: aload_1
     995: new           #3                  // class java/lang/StringBuilder
     998: dup
     999: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
    1002: aload         4
    1004: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1007: ldc           #62                 // String truststore.password
    1009: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1012: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1015: ldc           #63                 // String changeit
    1017: invokevirtual #48                 // Method java/util/Properties.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
    1020: astore        14
    1022: aload         14
    1024: ifnull        1043
    1027: aload         14
    1029: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
    1032: astore        14
    1034: aload_0
    1035: aload         14
    1037: aload_3
    1038: invokevirtual #49                 // Method decryptPassword:(Ljava/lang/String;Lorg/apache/wss4j/common/crypto/PasswordEncryptor;)Ljava/lang/String;
    1041: astore        14
    1043: aload_0
    1044: aload_0
    1045: aload         12
    1047: aload         14
    1049: aconst_null
    1050: invokestatic  #12                 // Method java/security/KeyStore.getDefaultType:()Ljava/lang/String;
    1053: invokevirtual #51                 // Method load:(Ljava/io/InputStream;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/security/KeyStore;
    1056: putfield      #2                  // Field truststore:Ljava/security/KeyStore;
    1059: getstatic     #53                 // Field DO_DEBUG:Z
    1062: ifeq          1075
    1065: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
    1068: ldc           #70                 // String CA certs have been loaded
    1070: invokeinterface #57,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
    1075: aload_0
    1076: iconst_1
    1077: putfield      #16                 // Field loadCACerts:Z
    1080: aload         12
    1082: ifnull        1167
    1085: aload         13
    1087: ifnull        1110
    1090: aload         12
    1092: invokevirtual #17                 // Method java/io/InputStream.close:()V
    1095: goto          1167
    1098: astore        14
    1100: aload         13
    1102: aload         14
    1104: invokevirtual #19                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
    1107: goto          1167
    1110: aload         12
    1112: invokevirtual #17                 // Method java/io/InputStream.close:()V
    1115: goto          1167
    1118: astore        14
    1120: aload         14
    1122: astore        13
    1124: aload         14
    1126: athrow
    1127: astore        18
    1129: aload         12
    1131: ifnull        1164
    1134: aload         13
    1136: ifnull        1159
    1139: aload         12
    1141: invokevirtual #17                 // Method java/io/InputStream.close:()V
    1144: goto          1164
    1147: astore        19
    1149: aload         13
    1151: aload         19
    1153: invokevirtual #19                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
    1156: goto          1164
    1159: aload         12
    1161: invokevirtual #17                 // Method java/io/InputStream.close:()V
    1164: aload         18
    1166: athrow
    1167: aload_1
    1168: new           #3                  // class java/lang/StringBuilder
    1171: dup
    1172: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
    1175: aload         4
    1177: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1180: ldc           #71                 // String x509crl.file
    1182: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1185: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1188: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
    1191: astore        10
    1193: aload         10
    1195: ifnull        1461
    1198: aload         10
    1200: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
    1203: astore        10
    1205: aload_2
    1206: aload         10
    1208: invokestatic  #45                 // Method loadInputStream:(Ljava/lang/ClassLoader;Ljava/lang/String;)Ljava/io/InputStream;
    1211: astore        11
    1213: aconst_null
    1214: astore        12
    1216: aload_0
    1217: invokevirtual #72                 // Method getCertificateFactory:()Ljava/security/cert/CertificateFactory;
    1220: astore        13
    1222: aload         13
    1224: aload         11
    1226: invokevirtual #73                 // Method java/security/cert/CertificateFactory.generateCRL:(Ljava/io/InputStream;)Ljava/security/cert/CRL;
    1229: checkcast     #74                 // class java/security/cert/X509CRL
    1232: astore        14
    1234: aload         5
    1236: ifnull        1247
    1239: aload         5
    1241: invokevirtual #75                 // Method java/lang/String.length:()I
    1244: ifne          1271
    1247: aload_0
    1248: ldc           #76                 // String Collection
    1250: new           #77                 // class java/security/cert/CollectionCertStoreParameters
    1253: dup
    1254: aload         14
    1256: invokestatic  #78                 // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
    1259: invokespecial #79                 // Method java/security/cert/CollectionCertStoreParameters."<init>":(Ljava/util/Collection;)V
    1262: invokestatic  #80                 // Method java/security/cert/CertStore.getInstance:(Ljava/lang/String;Ljava/security/cert/CertStoreParameters;)Ljava/security/cert/CertStore;
    1265: putfield      #81                 // Field crlCertStore:Ljava/security/cert/CertStore;
    1268: goto          1294
    1271: aload_0
    1272: ldc           #76                 // String Collection
    1274: new           #77                 // class java/security/cert/CollectionCertStoreParameters
    1277: dup
    1278: aload         14
    1280: invokestatic  #78                 // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
    1283: invokespecial #79                 // Method java/security/cert/CollectionCertStoreParameters."<init>":(Ljava/util/Collection;)V
    1286: aload         5
    1288: invokestatic  #82                 // Method java/security/cert/CertStore.getInstance:(Ljava/lang/String;Ljava/security/cert/CertStoreParameters;Ljava/lang/String;)Ljava/security/cert/CertStore;
    1291: putfield      #81                 // Field crlCertStore:Ljava/security/cert/CertStore;
    1294: getstatic     #53                 // Field DO_DEBUG:Z
    1297: ifeq          1333
    1300: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
    1303: new           #3                  // class java/lang/StringBuilder
    1306: dup
    1307: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
    1310: ldc           #83                 // String The CRL
    1312: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1315: aload         10
    1317: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1320: ldc           #56                 // String  has been loaded
    1322: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1325: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1328: invokeinterface #57,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
    1333: aload         11
    1335: ifnull        1420
    1338: aload         12
    1340: ifnull        1363
    1343: aload         11
    1345: invokevirtual #17                 // Method java/io/InputStream.close:()V
    1348: goto          1420
    1351: astore        13
    1353: aload         12
    1355: aload         13
    1357: invokevirtual #19                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
    1360: goto          1420
    1363: aload         11
    1365: invokevirtual #17                 // Method java/io/InputStream.close:()V
    1368: goto          1420
    1371: astore        13
    1373: aload         13
    1375: astore        12
    1377: aload         13
    1379: athrow
    1380: astore        20
    1382: aload         11
    1384: ifnull        1417
    1387: aload         12
    1389: ifnull        1412
    1392: aload         11
    1394: invokevirtual #17                 // Method java/io/InputStream.close:()V
    1397: goto          1417
    1400: astore        21
    1402: aload         12
    1404: aload         21
    1406: invokevirtual #19                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
    1409: goto          1417
    1412: aload         11
    1414: invokevirtual #17                 // Method java/io/InputStream.close:()V
    1417: aload         20
    1419: athrow
    1420: goto          1461
    1423: astore        11
    1425: getstatic     #53                 // Field DO_DEBUG:Z
    1428: ifeq          1446
    1431: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
    1434: aload         11
    1436: invokevirtual #23                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
    1439: aload         11
    1441: invokeinterface #84,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
    1446: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
    1449: dup
    1450: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
    1453: aload         11
    1455: ldc           #87                 // String failedCredentialLoad
    1457: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
    1460: athrow
    1461: return
    Exception table:
       from    to  target type
         497   502   505   Class java/lang/Throwable
         296   487   525   Class java/lang/Throwable
         296   487   534   any
         546   551   554   Class java/lang/Throwable
         525   536   534   any
         812   817   820   Class java/lang/Throwable
         642   802   840   Class java/lang/Throwable
         642   802   849   any
         861   866   869   Class java/lang/Throwable
         840   851   849   any
        1090  1095  1098   Class java/lang/Throwable
         994  1080  1118   Class java/lang/Throwable
         994  1080  1127   any
        1139  1144  1147   Class java/lang/Throwable
        1118  1129  1127   any
        1343  1348  1351   Class java/lang/Throwable
        1216  1333  1371   Class java/lang/Throwable
        1216  1333  1380   any
        1392  1397  1400   Class java/lang/Throwable
        1371  1382  1380   any
        1205  1420  1423   Class java/lang/Exception

  public static java.io.InputStream loadInputStream(java.lang.ClassLoader, java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException, java.io.IOException;
    Code:
       0: aconst_null
       1: astore_2
       2: aload_1
       3: ifnull        83
       6: aload_0
       7: aload_1
       8: invokestatic  #89                 // Method org/apache/wss4j/common/util/Loader.getResource:(Ljava/lang/ClassLoader;Ljava/lang/String;)Ljava/net/URL;
      11: astore_3
      12: aload_3
      13: ifnull        21
      16: aload_3
      17: invokevirtual #90                 // Method java/net/URL.openStream:()Ljava/io/InputStream;
      20: astore_2
      21: aload_2
      22: ifnonnull     83
      25: new           #10                 // class java/io/FileInputStream
      28: dup
      29: aload_1
      30: invokespecial #11                 // Method java/io/FileInputStream."<init>":(Ljava/lang/String;)V
      33: astore_2
      34: goto          83
      37: astore        4
      39: getstatic     #53                 // Field DO_DEBUG:Z
      42: ifeq          60
      45: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
      48: aload         4
      50: invokevirtual #23                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
      53: aload         4
      55: invokeinterface #84,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
      60: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
      63: dup
      64: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      67: aload         4
      69: ldc           #91                 // String proxyNotFound
      71: iconst_1
      72: anewarray     #92                 // class java/lang/Object
      75: dup
      76: iconst_0
      77: aload_1
      78: aastore
      79: invokespecial #93                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
      82: athrow
      83: aload_2
      84: areturn
    Exception table:
       from    to  target type
          25    34    37   Class java/lang/Exception

  protected java.security.KeyStore load(java.io.InputStream, java.lang.String, java.lang.String, java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aconst_null
       1: astore        5
       3: aload_3
       4: ifnull        14
       7: aload_3
       8: invokevirtual #75                 // Method java/lang/String.length:()I
      11: ifne          24
      14: aload         4
      16: invokestatic  #13                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;)Ljava/security/KeyStore;
      19: astore        5
      21: goto          32
      24: aload         4
      26: aload_3
      27: invokestatic  #94                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/KeyStore;
      30: astore        5
      32: aload         5
      34: aload_1
      35: aload_2
      36: ifnull        46
      39: aload_2
      40: invokevirtual #75                 // Method java/lang/String.length:()I
      43: ifne          52
      46: iconst_0
      47: newarray       char
      49: goto          56
      52: aload_2
      53: invokevirtual #14                 // Method java/lang/String.toCharArray:()[C
      56: invokevirtual #15                 // Method java/security/KeyStore.load:(Ljava/io/InputStream;[C)V
      59: goto          100
      62: astore        6
      64: getstatic     #53                 // Field DO_DEBUG:Z
      67: ifeq          85
      70: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
      73: aload         6
      75: invokevirtual #23                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
      78: aload         6
      80: invokeinterface #84,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
      85: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
      88: dup
      89: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      92: aload         6
      94: ldc           #87                 // String failedCredentialLoad
      96: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
      99: athrow
     100: aload         5
     102: areturn
    Exception table:
       from    to  target type
           3    59    62   Class java/io/IOException
           3    59    62   Class java/security/GeneralSecurityException

  public java.security.KeyStore getKeyStore();
    Code:
       0: aload_0
       1: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
       4: areturn

  public void setKeyStore(java.security.KeyStore);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #52                 // Field keystore:Ljava/security/KeyStore;
       5: return

  public java.security.KeyStore getTrustStore();
    Code:
       0: aload_0
       1: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
       4: areturn

  public void setTrustStore(java.security.KeyStore);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #2                  // Field truststore:Ljava/security/KeyStore;
       5: return

  public void setCRLCertStore(java.security.cert.CertStore);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #81                 // Field crlCertStore:Ljava/security/cert/CertStore;
       5: return

  public java.security.cert.CertStore getCRLCertStore();
    Code:
       0: aload_0
       1: getfield      #81                 // Field crlCertStore:Ljava/security/cert/CertStore;
       4: areturn

  public java.security.cert.CertificateFactory getCertificateFactory() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #97                 // Field certificateFactory:Ljava/security/cert/CertificateFactory;
       4: ifnull        12
       7: aload_0
       8: getfield      #97                 // Field certificateFactory:Ljava/security/cert/CertificateFactory;
      11: areturn
      12: aload_0
      13: invokevirtual #98                 // Method getCryptoProvider:()Ljava/lang/String;
      16: astore_1
      17: aconst_null
      18: astore_2
      19: aload_0
      20: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      23: ifnull        37
      26: aload_0
      27: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      30: invokevirtual #99                 // Method java/security/KeyStore.getProvider:()Ljava/security/Provider;
      33: invokevirtual #100                // Method java/security/Provider.getName:()Ljava/lang/String;
      36: astore_2
      37: aload_1
      38: ifnull        48
      41: aload_1
      42: invokevirtual #75                 // Method java/lang/String.length:()I
      45: ifne          109
      48: aload_2
      49: ifnull        90
      52: aload_2
      53: invokevirtual #75                 // Method java/lang/String.length:()I
      56: ifeq          90
      59: aload_0
      60: ldc           #101                // String X.509
      62: aload_0
      63: aload_2
      64: invokespecial #102                // Method mapKeystoreProviderToCertProvider:(Ljava/lang/String;)Ljava/lang/String;
      67: invokestatic  #103                // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
      70: putfield      #97                 // Field certificateFactory:Ljava/security/cert/CertificateFactory;
      73: goto          90
      76: astore_3
      77: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
      80: aload_3
      81: invokevirtual #23                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
      84: aload_3
      85: invokeinterface #84,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
      90: aload_0
      91: getfield      #97                 // Field certificateFactory:Ljava/security/cert/CertificateFactory;
      94: ifnonnull     119
      97: aload_0
      98: ldc           #101                // String X.509
     100: invokestatic  #104                // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
     103: putfield      #97                 // Field certificateFactory:Ljava/security/cert/CertificateFactory;
     106: goto          119
     109: aload_0
     110: ldc           #101                // String X.509
     112: aload_1
     113: invokestatic  #103                // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
     116: putfield      #97                 // Field certificateFactory:Ljava/security/cert/CertificateFactory;
     119: goto          152
     122: astore_3
     123: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     126: dup
     127: getstatic     #106                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     130: aload_3
     131: ldc           #107                // String unsupportedCertType
     133: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     136: athrow
     137: astore_3
     138: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     141: dup
     142: getstatic     #106                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     145: aload_3
     146: ldc           #109                // String noSecProvider
     148: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     151: athrow
     152: aload_0
     153: getfield      #97                 // Field certificateFactory:Ljava/security/cert/CertificateFactory;
     156: areturn
    Exception table:
       from    to  target type
          59    73    76   Class java/lang/Exception
          37   119   122   Class java/security/cert/CertificateException
          37   119   137   Class java/security/NoSuchProviderException

  private java.lang.String mapKeystoreProviderToCertProvider(java.lang.String);
    Code:
       0: ldc           #110                // String SunJSSE
       2: aload_1
       3: invokevirtual #111                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       6: ifeq          12
       9: ldc           #112                // String SUN
      11: areturn
      12: aload_1
      13: areturn

  public java.lang.String getDefaultX509Identifier() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: invokespecial #113                // Method org/apache/wss4j/common/crypto/CryptoBase.getDefaultX509Identifier:()Ljava/lang/String;
       4: ifnull        12
       7: aload_0
       8: invokespecial #113                // Method org/apache/wss4j/common/crypto/CryptoBase.getDefaultX509Identifier:()Ljava/lang/String;
      11: areturn
      12: aload_0
      13: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      16: ifnull        80
      19: aload_0
      20: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      23: invokevirtual #114                // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
      26: astore_1
      27: aload_1
      28: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      33: ifeq          62
      36: aload_1
      37: invokeinterface #116,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      42: checkcast     #33                 // class java/lang/String
      45: astore_2
      46: aload_1
      47: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      52: ifne          62
      55: aload_0
      56: aload_2
      57: invokevirtual #42                 // Method setDefaultX509Identifier:(Ljava/lang/String;)V
      60: aload_2
      61: areturn
      62: goto          80
      65: astore_1
      66: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
      69: dup
      70: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      73: aload_1
      74: ldc           #118                // String keystore
      76: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
      79: athrow
      80: aconst_null
      81: areturn
    Exception table:
       from    to  target type
          19    61    65   Class java/security/KeyStoreException

  public java.security.cert.X509Certificate[] getX509Certificates(org.apache.wss4j.common.crypto.CryptoType) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnonnull     6
       4: aconst_null
       5: areturn
       6: aload_1
       7: invokevirtual #119                // Method org/apache/wss4j/common/crypto/CryptoType.getType:()Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
      10: astore_2
      11: aconst_null
      12: astore_3
      13: getstatic     #120                // Field org/apache/wss4j/common/crypto/Merlin$1.$SwitchMap$org$apache$wss4j$common$crypto$CryptoType$TYPE:[I
      16: aload_2
      17: invokevirtual #121                // Method org/apache/wss4j/common/crypto/CryptoType$TYPE.ordinal:()I
      20: iaload
      21: tableswitch   { // 1 to 6
                     1: 60
                     2: 76
                     3: 88
                     4: 100
                     5: 112
                     6: 124
               default: 124
          }
      60: aload_0
      61: aload_1
      62: invokevirtual #122                // Method org/apache/wss4j/common/crypto/CryptoType.getIssuer:()Ljava/lang/String;
      65: aload_1
      66: invokevirtual #123                // Method org/apache/wss4j/common/crypto/CryptoType.getSerial:()Ljava/math/BigInteger;
      69: invokespecial #124                // Method getX509Certificates:(Ljava/lang/String;Ljava/math/BigInteger;)[Ljava/security/cert/X509Certificate;
      72: astore_3
      73: goto          124
      76: aload_0
      77: aload_1
      78: invokevirtual #125                // Method org/apache/wss4j/common/crypto/CryptoType.getBytes:()[B
      81: invokespecial #126                // Method getX509Certificates:([B)[Ljava/security/cert/X509Certificate;
      84: astore_3
      85: goto          124
      88: aload_0
      89: aload_1
      90: invokevirtual #125                // Method org/apache/wss4j/common/crypto/CryptoType.getBytes:()[B
      93: invokespecial #127                // Method getX509CertificatesSKI:([B)[Ljava/security/cert/X509Certificate;
      96: astore_3
      97: goto          124
     100: aload_0
     101: aload_1
     102: invokevirtual #128                // Method org/apache/wss4j/common/crypto/CryptoType.getSubjectDN:()Ljava/lang/String;
     105: invokespecial #129                // Method getX509CertificatesSubjectDN:(Ljava/lang/String;)[Ljava/security/cert/X509Certificate;
     108: astore_3
     109: goto          124
     112: aload_0
     113: aload_1
     114: invokevirtual #130                // Method org/apache/wss4j/common/crypto/CryptoType.getAlias:()Ljava/lang/String;
     117: invokespecial #131                // Method getX509Certificates:(Ljava/lang/String;)[Ljava/security/cert/X509Certificate;
     120: astore_3
     121: goto          124
     124: aload_3
     125: areturn

  public java.lang.String getX509Identifier(java.security.cert.X509Certificate) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aconst_null
       1: astore_2
       2: aload_0
       3: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
       6: ifnull        19
       9: aload_0
      10: aload_1
      11: aload_0
      12: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      15: invokespecial #132                // Method getIdentifier:(Ljava/security/cert/X509Certificate;Ljava/security/KeyStore;)Ljava/lang/String;
      18: astore_2
      19: aload_2
      20: ifnonnull     40
      23: aload_0
      24: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      27: ifnull        40
      30: aload_0
      31: aload_1
      32: aload_0
      33: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      36: invokespecial #132                // Method getIdentifier:(Ljava/security/cert/X509Certificate;Ljava/security/KeyStore;)Ljava/lang/String;
      39: astore_2
      40: aload_2
      41: areturn

  public java.security.PrivateKey getPrivateKey(java.security.cert.X509Certificate, javax.security.auth.callback.CallbackHandler) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
       4: ifnonnull     29
       7: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
      10: dup
      11: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      14: ldc           #133                // String empty
      16: iconst_1
      17: anewarray     #92                 // class java/lang/Object
      20: dup
      21: iconst_0
      22: ldc           #134                // String The keystore is null
      24: aastore
      25: invokespecial #135                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
      28: athrow
      29: aload_2
      30: ifnonnull     55
      33: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
      36: dup
      37: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      40: ldc           #133                // String empty
      42: iconst_1
      43: anewarray     #92                 // class java/lang/Object
      46: dup
      47: iconst_0
      48: ldc           #136                // String The CallbackHandler is null
      50: aastore
      51: invokespecial #135                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
      54: athrow
      55: aload_0
      56: aload_1
      57: aload_0
      58: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      61: invokespecial #132                // Method getIdentifier:(Ljava/security/cert/X509Certificate;Ljava/security/KeyStore;)Ljava/lang/String;
      64: astore_3
      65: aload_3
      66: ifnull        80
      69: aload_0
      70: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      73: aload_3
      74: invokevirtual #137                // Method java/security/KeyStore.isKeyEntry:(Ljava/lang/String;)Z
      77: ifne          165
      80: new           #3                  // class java/lang/StringBuilder
      83: dup
      84: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
      87: ldc           #138                // String Cannot find key for alias: [
      89: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      92: aload_3
      93: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      96: ldc           #139                // String ]
      98: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     101: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     104: astore        4
     106: aload_0
     107: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
     110: invokestatic  #140                // Method createKeyStoreErrorMessage:(Ljava/security/KeyStore;)Ljava/lang/String;
     113: astore        5
     115: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     118: new           #3                  // class java/lang/StringBuilder
     121: dup
     122: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     125: aload         4
     127: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     130: aload         5
     132: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     135: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     138: invokeinterface #141,  2          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     143: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     146: dup
     147: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     150: ldc           #133                // String empty
     152: iconst_1
     153: anewarray     #92                 // class java/lang/Object
     156: dup
     157: iconst_0
     158: aload         4
     160: aastore
     161: invokespecial #135                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     164: athrow
     165: aload_0
     166: aload_3
     167: aload_2
     168: invokespecial #142                // Method getPassword:(Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)Ljava/lang/String;
     171: astore        4
     173: aload         4
     175: ifnonnull     236
     178: aload_0
     179: getfield      #59                 // Field privatePasswordSet:Z
     182: ifeq          236
     185: aload_0
     186: getfield      #26                 // Field properties:Ljava/util/Properties;
     189: ldc           #143                // String org.apache.wss4j.crypto.merlin.keystore.private.password
     191: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     194: astore        4
     196: aload         4
     198: ifnonnull     212
     201: aload_0
     202: getfield      #26                 // Field properties:Ljava/util/Properties;
     205: ldc           #144                // String org.apache.ws.security.crypto.merlin.keystore.private.password
     207: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     210: astore        4
     212: aload         4
     214: ifnull        236
     217: aload         4
     219: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     222: astore        4
     224: aload_0
     225: aload         4
     227: aload_0
     228: getfield      #27                 // Field passwordEncryptor:Lorg/apache/wss4j/common/crypto/PasswordEncryptor;
     231: invokevirtual #49                 // Method decryptPassword:(Ljava/lang/String;Lorg/apache/wss4j/common/crypto/PasswordEncryptor;)Ljava/lang/String;
     234: astore        4
     236: aload_0
     237: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
     240: aload_3
     241: aload         4
     243: ifnonnull     252
     246: iconst_0
     247: newarray       char
     249: goto          257
     252: aload         4
     254: invokevirtual #14                 // Method java/lang/String.toCharArray:()[C
     257: invokevirtual #145                // Method java/security/KeyStore.getKey:(Ljava/lang/String;[C)Ljava/security/Key;
     260: astore        5
     262: aload         5
     264: instanceof    #146                // class java/security/PrivateKey
     267: ifne          355
     270: new           #3                  // class java/lang/StringBuilder
     273: dup
     274: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     277: ldc           #147                // String Key is not a private key, alias: [
     279: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     282: aload_3
     283: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     286: ldc           #139                // String ]
     288: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     291: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     294: astore        6
     296: aload_0
     297: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
     300: invokestatic  #140                // Method createKeyStoreErrorMessage:(Ljava/security/KeyStore;)Ljava/lang/String;
     303: astore        7
     305: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     308: new           #3                  // class java/lang/StringBuilder
     311: dup
     312: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     315: aload         6
     317: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     320: aload         7
     322: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     325: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     328: invokeinterface #141,  2          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     333: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     336: dup
     337: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     340: ldc           #133                // String empty
     342: iconst_1
     343: anewarray     #92                 // class java/lang/Object
     346: dup
     347: iconst_0
     348: aload         6
     350: aastore
     351: invokespecial #135                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     354: athrow
     355: aload         5
     357: checkcast     #146                // class java/security/PrivateKey
     360: areturn
     361: astore        4
     363: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     366: dup
     367: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     370: aload         4
     372: ldc           #150                // String noPrivateKey
     374: iconst_1
     375: anewarray     #92                 // class java/lang/Object
     378: dup
     379: iconst_0
     380: aload         4
     382: invokevirtual #151                // Method java/security/GeneralSecurityException.getMessage:()Ljava/lang/String;
     385: aastore
     386: invokespecial #93                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
     389: athrow
    Exception table:
       from    to  target type
          65   360   361   Class java/security/KeyStoreException
          65   360   361   Class java/security/UnrecoverableKeyException
          65   360   361   Class java/security/NoSuchAlgorithmException

  public java.security.PrivateKey getPrivateKey(java.lang.String, java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
       4: ifnonnull     29
       7: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
      10: dup
      11: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      14: ldc           #133                // String empty
      16: iconst_1
      17: anewarray     #92                 // class java/lang/Object
      20: dup
      21: iconst_0
      22: ldc           #134                // String The keystore is null
      24: aastore
      25: invokespecial #135                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
      28: athrow
      29: aload_1
      30: ifnull        44
      33: aload_0
      34: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      37: aload_1
      38: invokevirtual #137                // Method java/security/KeyStore.isKeyEntry:(Ljava/lang/String;)Z
      41: ifne          126
      44: new           #3                  // class java/lang/StringBuilder
      47: dup
      48: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
      51: ldc           #138                // String Cannot find key for alias: [
      53: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      56: aload_1
      57: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      60: ldc           #139                // String ]
      62: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      65: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      68: astore_3
      69: aload_0
      70: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      73: invokestatic  #140                // Method createKeyStoreErrorMessage:(Ljava/security/KeyStore;)Ljava/lang/String;
      76: astore        4
      78: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
      81: new           #3                  // class java/lang/StringBuilder
      84: dup
      85: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
      88: aload_3
      89: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      92: aload         4
      94: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      97: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     100: invokeinterface #141,  2          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     105: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     108: dup
     109: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     112: ldc           #133                // String empty
     114: iconst_1
     115: anewarray     #92                 // class java/lang/Object
     118: dup
     119: iconst_0
     120: aload_3
     121: aastore
     122: invokespecial #135                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     125: athrow
     126: aload_2
     127: astore_3
     128: aload_3
     129: ifnonnull     172
     132: aload_0
     133: getfield      #59                 // Field privatePasswordSet:Z
     136: ifeq          172
     139: aload_0
     140: getfield      #26                 // Field properties:Ljava/util/Properties;
     143: ldc           #143                // String org.apache.wss4j.crypto.merlin.keystore.private.password
     145: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     148: astore_3
     149: aload_3
     150: ifnonnull     163
     153: aload_0
     154: getfield      #26                 // Field properties:Ljava/util/Properties;
     157: ldc           #144                // String org.apache.ws.security.crypto.merlin.keystore.private.password
     159: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     162: astore_3
     163: aload_3
     164: ifnull        172
     167: aload_3
     168: invokevirtual #38                 // Method java/lang/String.trim:()Ljava/lang/String;
     171: astore_3
     172: aload_0
     173: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
     176: aload_1
     177: aload_3
     178: ifnonnull     187
     181: iconst_0
     182: newarray       char
     184: goto          191
     187: aload_3
     188: invokevirtual #14                 // Method java/lang/String.toCharArray:()[C
     191: invokevirtual #145                // Method java/security/KeyStore.getKey:(Ljava/lang/String;[C)Ljava/security/Key;
     194: astore        4
     196: aload         4
     198: instanceof    #146                // class java/security/PrivateKey
     201: ifne          289
     204: new           #3                  // class java/lang/StringBuilder
     207: dup
     208: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     211: ldc           #147                // String Key is not a private key, alias: [
     213: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     216: aload_1
     217: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     220: ldc           #139                // String ]
     222: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     225: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     228: astore        5
     230: aload_0
     231: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
     234: invokestatic  #140                // Method createKeyStoreErrorMessage:(Ljava/security/KeyStore;)Ljava/lang/String;
     237: astore        6
     239: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     242: new           #3                  // class java/lang/StringBuilder
     245: dup
     246: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     249: aload         5
     251: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     254: aload         6
     256: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     259: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     262: invokeinterface #141,  2          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     267: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     270: dup
     271: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     274: ldc           #133                // String empty
     276: iconst_1
     277: anewarray     #92                 // class java/lang/Object
     280: dup
     281: iconst_0
     282: aload         5
     284: aastore
     285: invokespecial #135                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     288: athrow
     289: aload         4
     291: checkcast     #146                // class java/security/PrivateKey
     294: areturn
     295: astore_3
     296: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     299: dup
     300: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     303: aload_3
     304: ldc           #150                // String noPrivateKey
     306: iconst_1
     307: anewarray     #92                 // class java/lang/Object
     310: dup
     311: iconst_0
     312: aload_3
     313: invokevirtual #151                // Method java/security/GeneralSecurityException.getMessage:()Ljava/lang/String;
     316: aastore
     317: invokespecial #93                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
     320: athrow
    Exception table:
       from    to  target type
          29   294   295   Class java/security/KeyStoreException
          29   294   295   Class java/security/UnrecoverableKeyException
          29   294   295   Class java/security/NoSuchAlgorithmException

  public void verifyTrust(java.security.cert.X509Certificate[], boolean, java.util.Collection<java.util.regex.Pattern>) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: arraylength
       2: iconst_1
       3: if_icmpne     156
       6: iload_2
       7: ifne          156
      10: aload_1
      11: iconst_0
      12: aaload
      13: invokevirtual #152                // Method java/security/cert/X509Certificate.getIssuerX500Principal:()Ljavax/security/auth/x500/X500Principal;
      16: invokevirtual #153                // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
      19: astore        4
      21: aload_1
      22: iconst_0
      23: aaload
      24: invokevirtual #154                // Method java/security/cert/X509Certificate.getSerialNumber:()Ljava/math/BigInteger;
      27: astore        5
      29: new           #155                // class org/apache/wss4j/common/crypto/CryptoType
      32: dup
      33: getstatic     #156                // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ISSUER_SERIAL:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
      36: invokespecial #157                // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
      39: astore        6
      41: aload         6
      43: aload         4
      45: aload         5
      47: invokevirtual #158                // Method org/apache/wss4j/common/crypto/CryptoType.setIssuerSerial:(Ljava/lang/String;Ljava/math/BigInteger;)V
      50: aload_0
      51: aload         6
      53: invokevirtual #159                // Method getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
      56: astore        7
      58: aload         7
      60: ifnull        156
      63: aload         7
      65: iconst_0
      66: aaload
      67: ifnull        156
      70: aload         7
      72: iconst_0
      73: aaload
      74: aload_1
      75: iconst_0
      76: aaload
      77: invokevirtual #160                // Method java/security/cert/X509Certificate.equals:(Ljava/lang/Object;)Z
      80: ifeq          156
      83: aload_1
      84: iconst_0
      85: aaload
      86: invokevirtual #161                // Method java/security/cert/X509Certificate.checkValidity:()V
      89: goto          109
      92: astore        8
      94: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
      97: dup
      98: getstatic     #164                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_CHECK:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     101: aload         8
     103: ldc           #165                // String invalidCert
     105: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     108: athrow
     109: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     112: invokeinterface #166,  1          // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     117: ifeq          155
     120: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     123: new           #3                  // class java/lang/StringBuilder
     126: dup
     127: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     130: ldc           #167                // String Direct trust for certificate with
     132: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     135: aload_1
     136: iconst_0
     137: aaload
     138: invokevirtual #168                // Method java/security/cert/X509Certificate.getSubjectX500Principal:()Ljavax/security/auth/x500/X500Principal;
     141: invokevirtual #153                // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
     144: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     147: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     150: invokeinterface #57,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     155: return
     156: aload_1
     157: astore        4
     159: aload_1
     160: iconst_0
     161: aaload
     162: invokevirtual #152                // Method java/security/cert/X509Certificate.getIssuerX500Principal:()Ljavax/security/auth/x500/X500Principal;
     165: invokevirtual #153                // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
     168: astore        5
     170: aload_1
     171: arraylength
     172: iconst_1
     173: if_icmpne     326
     176: new           #155                // class org/apache/wss4j/common/crypto/CryptoType
     179: dup
     180: getstatic     #169                // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.SUBJECT_DN:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
     183: invokespecial #157                // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
     186: astore        6
     188: aload         6
     190: aload         5
     192: invokevirtual #170                // Method org/apache/wss4j/common/crypto/CryptoType.setSubjectDN:(Ljava/lang/String;)V
     195: aload_0
     196: aload         6
     198: invokevirtual #159                // Method getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
     201: astore        7
     203: aload         7
     205: ifnull        215
     208: aload         7
     210: arraylength
     211: iconst_1
     212: if_icmpge     297
     215: aload_1
     216: iconst_0
     217: aaload
     218: invokevirtual #168                // Method java/security/cert/X509Certificate.getSubjectX500Principal:()Ljavax/security/auth/x500/X500Principal;
     221: invokevirtual #153                // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
     224: astore        8
     226: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     229: invokeinterface #166,  1          // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     234: ifeq          275
     237: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     240: new           #3                  // class java/lang/StringBuilder
     243: dup
     244: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     247: ldc           #171                // String No certs found in keystore for issuer
     249: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     252: aload         5
     254: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     257: ldc           #172                // String  of certificate for
     259: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     262: aload         8
     264: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     267: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     270: invokeinterface #57,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     275: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     278: dup
     279: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     282: ldc           #173                // String certpath
     284: iconst_1
     285: anewarray     #92                 // class java/lang/Object
     288: dup
     289: iconst_0
     290: ldc           #174                // String No trusted certs found
     292: aastore
     293: invokespecial #135                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     296: athrow
     297: aload         7
     299: arraylength
     300: iconst_1
     301: iadd
     302: anewarray     #175                // class java/security/cert/X509Certificate
     305: astore        4
     307: aload         4
     309: iconst_0
     310: aload_1
     311: iconst_0
     312: aaload
     313: aastore
     314: aload         7
     316: iconst_0
     317: aload         4
     319: iconst_1
     320: aload         7
     322: arraylength
     323: invokestatic  #176                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     326: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     329: invokeinterface #166,  1          // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     334: ifeq          365
     337: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
     340: new           #3                  // class java/lang/StringBuilder
     343: dup
     344: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
     347: ldc           #177                // String Preparing to validate certificate path for issuer
     349: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     352: aload         5
     354: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     357: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     360: invokeinterface #57,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     365: aload         4
     367: invokestatic  #178                // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
     370: astore        6
     372: aload_0
     373: invokevirtual #72                 // Method getCertificateFactory:()Ljava/security/cert/CertificateFactory;
     376: aload         6
     378: invokevirtual #179                // Method java/security/cert/CertificateFactory.generateCertPath:(Ljava/util/List;)Ljava/security/cert/CertPath;
     381: astore        7
     383: new           #180                // class java/util/HashSet
     386: dup
     387: invokespecial #181                // Method java/util/HashSet."<init>":()V
     390: astore        8
     392: aload_0
     393: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
     396: ifnull        480
     399: aload_0
     400: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
     403: invokevirtual #114                // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
     406: astore        9
     408: aload         9
     410: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
     415: ifeq          480
     418: aload         9
     420: invokeinterface #116,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
     425: checkcast     #33                 // class java/lang/String
     428: astore        10
     430: aload_0
     431: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
     434: aload         10
     436: invokevirtual #182                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
     439: checkcast     #175                // class java/security/cert/X509Certificate
     442: astore        11
     444: aload         11
     446: ifnull        477
     449: new           #183                // class java/security/cert/TrustAnchor
     452: dup
     453: aload         11
     455: aload         11
     457: ldc           #184                // String 2.5.29.30
     459: invokevirtual #185                // Method java/security/cert/X509Certificate.getExtensionValue:(Ljava/lang/String;)[B
     462: invokespecial #186                // Method java/security/cert/TrustAnchor."<init>":(Ljava/security/cert/X509Certificate;[B)V
     465: astore        12
     467: aload         8
     469: aload         12
     471: invokeinterface #187,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     476: pop
     477: goto          408
     480: aload_0
     481: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
     484: ifnull        582
     487: aload_0
     488: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
     491: ifnull        501
     494: aload_0
     495: getfield      #16                 // Field loadCACerts:Z
     498: ifeq          582
     501: aload_0
     502: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
     505: invokevirtual #114                // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
     508: astore        9
     510: aload         9
     512: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
     517: ifeq          582
     520: aload         9
     522: invokeinterface #116,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
     527: checkcast     #33                 // class java/lang/String
     530: astore        10
     532: aload_0
     533: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
     536: aload         10
     538: invokevirtual #182                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
     541: checkcast     #175                // class java/security/cert/X509Certificate
     544: astore        11
     546: aload         11
     548: ifnull        579
     551: new           #183                // class java/security/cert/TrustAnchor
     554: dup
     555: aload         11
     557: aload         11
     559: ldc           #184                // String 2.5.29.30
     561: invokevirtual #185                // Method java/security/cert/X509Certificate.getExtensionValue:(Ljava/lang/String;)[B
     564: invokespecial #186                // Method java/security/cert/TrustAnchor."<init>":(Ljava/security/cert/X509Certificate;[B)V
     567: astore        12
     569: aload         8
     571: aload         12
     573: invokeinterface #187,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     578: pop
     579: goto          510
     582: aload_0
     583: invokevirtual #98                 // Method getCryptoProvider:()Ljava/lang/String;
     586: astore        9
     588: aconst_null
     589: astore        10
     591: aload         9
     593: ifnull        604
     596: aload         9
     598: invokevirtual #75                 // Method java/lang/String.length:()I
     601: ifne          614
     604: ldc           #188                // String PKIX
     606: invokestatic  #189                // Method java/security/cert/CertPathValidator.getInstance:(Ljava/lang/String;)Ljava/security/cert/CertPathValidator;
     609: astore        10
     611: goto          623
     614: ldc           #188                // String PKIX
     616: aload         9
     618: invokestatic  #190                // Method java/security/cert/CertPathValidator.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/cert/CertPathValidator;
     621: astore        10
     623: aload_0
     624: aload         8
     626: iload_2
     627: invokevirtual #191                // Method createPKIXParameters:(Ljava/util/Set;Z)Ljava/security/cert/PKIXParameters;
     630: astore        11
     632: aload         10
     634: aload         7
     636: aload         11
     638: invokevirtual #192                // Method java/security/cert/CertPathValidator.validate:(Ljava/security/cert/CertPath;Ljava/security/cert/CertPathParameters;)Ljava/security/cert/CertPathValidatorResult;
     641: pop
     642: goto          662
     645: astore        6
     647: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     650: dup
     651: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     654: aload         6
     656: ldc           #173                // String certpath
     658: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     661: athrow
     662: aload_0
     663: aload_1
     664: iconst_0
     665: aaload
     666: aload_3
     667: invokevirtual #195                // Method matches:(Ljava/security/cert/X509Certificate;Ljava/util/Collection;)Z
     670: ifne          684
     673: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     676: dup
     677: getstatic     #196                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     680: invokespecial #197                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     683: athrow
     684: return
    Exception table:
       from    to  target type
          83    89    92   Class java/security/cert/CertificateExpiredException
          83    89    92   Class java/security/cert/CertificateNotYetValidException
         365   642   645   Class java/security/NoSuchProviderException
         365   642   645   Class java/security/NoSuchAlgorithmException
         365   642   645   Class java/security/cert/CertificateException
         365   642   645   Class java/security/InvalidAlgorithmParameterException
         365   642   645   Class java/security/cert/CertPathValidatorException
         365   642   645   Class java/security/KeyStoreException

  protected java.security.cert.PKIXParameters createPKIXParameters(java.util.Set<java.security.cert.TrustAnchor>, boolean) throws java.security.InvalidAlgorithmParameterException;
    Code:
       0: new           #198                // class java/security/cert/PKIXParameters
       3: dup
       4: aload_1
       5: invokespecial #199                // Method java/security/cert/PKIXParameters."<init>":(Ljava/util/Set;)V
       8: astore_3
       9: aload_3
      10: iload_2
      11: invokevirtual #200                // Method java/security/cert/PKIXParameters.setRevocationEnabled:(Z)V
      14: iload_2
      15: ifeq          33
      18: aload_0
      19: getfield      #81                 // Field crlCertStore:Ljava/security/cert/CertStore;
      22: ifnull        33
      25: aload_3
      26: aload_0
      27: getfield      #81                 // Field crlCertStore:Ljava/security/cert/CertStore;
      30: invokevirtual #201                // Method java/security/cert/PKIXParameters.addCertStore:(Ljava/security/cert/CertStore;)V
      33: aload_3
      34: areturn

  public void verifyTrust(java.security.PublicKey) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnonnull     15
       4: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
       7: dup
       8: getstatic     #196                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      11: invokespecial #197                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      14: athrow
      15: aload_0
      16: aload_1
      17: aload_0
      18: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      21: invokespecial #202                // Method findPublicKeyInKeyStore:(Ljava/security/PublicKey;Ljava/security/KeyStore;)Z
      24: ifne          50
      27: aload_0
      28: aload_1
      29: aload_0
      30: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      33: invokespecial #202                // Method findPublicKeyInKeyStore:(Ljava/security/PublicKey;Ljava/security/KeyStore;)Z
      36: ifne          50
      39: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
      42: dup
      43: getstatic     #196                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      46: invokespecial #197                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      49: athrow
      50: return

  private java.security.cert.X509Certificate[] getX509Certificates(java.lang.String, java.math.BigInteger) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aconst_null
       1: astore_3
       2: new           #203                // class javax/security/auth/x500/X500Principal
       5: dup
       6: aload_1
       7: invokespecial #204                // Method javax/security/auth/x500/X500Principal."<init>":(Ljava/lang/String;)V
      10: astore        4
      12: aload_0
      13: aload         4
      15: invokevirtual #153                // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
      18: invokevirtual #205                // Method createBCX509Name:(Ljava/lang/String;)Ljava/lang/Object;
      21: astore_3
      22: goto          33
      25: astore        4
      27: aload_0
      28: aload_1
      29: invokevirtual #205                // Method createBCX509Name:(Ljava/lang/String;)Ljava/lang/Object;
      32: astore_3
      33: aconst_null
      34: astore        4
      36: aload_0
      37: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      40: ifnull        55
      43: aload_0
      44: aload_3
      45: aload_2
      46: aload_0
      47: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      50: invokespecial #207                // Method getCertificates:(Ljava/lang/Object;Ljava/math/BigInteger;Ljava/security/KeyStore;)[Ljava/security/cert/Certificate;
      53: astore        4
      55: aload         4
      57: ifnull        66
      60: aload         4
      62: arraylength
      63: ifne          85
      66: aload_0
      67: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      70: ifnull        85
      73: aload_0
      74: aload_3
      75: aload_2
      76: aload_0
      77: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      80: invokespecial #207                // Method getCertificates:(Ljava/lang/Object;Ljava/math/BigInteger;Ljava/security/KeyStore;)[Ljava/security/cert/Certificate;
      83: astore        4
      85: aload         4
      87: ifnull        96
      90: aload         4
      92: arraylength
      93: ifne          98
      96: aconst_null
      97: areturn
      98: aload         4
     100: aload         4
     102: arraylength
     103: ldc_w         #208                // class "[Ljava/security/cert/X509Certificate;"
     106: invokestatic  #209                // Method java/util/Arrays.copyOf:([Ljava/lang/Object;ILjava/lang/Class;)[Ljava/lang/Object;
     109: checkcast     #208                // class "[Ljava/security/cert/X509Certificate;"
     112: areturn
    Exception table:
       from    to  target type
           2    22    25   Class java/lang/IllegalArgumentException

  private java.security.cert.Certificate[] getCertificates(java.lang.Object, java.math.BigInteger, java.security.KeyStore) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_3
       1: invokevirtual #114                // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
       4: astore        4
       6: aload         4
       8: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      13: ifeq          142
      16: aload         4
      18: invokeinterface #116,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      23: checkcast     #33                 // class java/lang/String
      26: astore        5
      28: aload_3
      29: aload         5
      31: invokevirtual #210                // Method java/security/KeyStore.getCertificateChain:(Ljava/lang/String;)[Ljava/security/cert/Certificate;
      34: astore        6
      36: aload         6
      38: ifnull        47
      41: aload         6
      43: arraylength
      44: ifne          71
      47: aload_3
      48: aload         5
      50: invokevirtual #182                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
      53: astore        7
      55: aload         7
      57: ifnull        71
      60: iconst_1
      61: anewarray     #211                // class java/security/cert/Certificate
      64: dup
      65: iconst_0
      66: aload         7
      68: aastore
      69: astore        6
      71: aload         6
      73: ifnull        139
      76: aload         6
      78: arraylength
      79: ifle          139
      82: aload         6
      84: iconst_0
      85: aaload
      86: instanceof    #175                // class java/security/cert/X509Certificate
      89: ifeq          139
      92: aload         6
      94: iconst_0
      95: aaload
      96: checkcast     #175                // class java/security/cert/X509Certificate
      99: astore        7
     101: aload         7
     103: invokevirtual #154                // Method java/security/cert/X509Certificate.getSerialNumber:()Ljava/math/BigInteger;
     106: aload_2
     107: invokevirtual #212                // Method java/math/BigInteger.compareTo:(Ljava/math/BigInteger;)I
     110: ifne          139
     113: aload_0
     114: aload         7
     116: invokevirtual #152                // Method java/security/cert/X509Certificate.getIssuerX500Principal:()Ljavax/security/auth/x500/X500Principal;
     119: invokevirtual #153                // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
     122: invokevirtual #205                // Method createBCX509Name:(Ljava/lang/String;)Ljava/lang/Object;
     125: astore        8
     127: aload         8
     129: aload_1
     130: invokevirtual #213                // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
     133: ifeq          139
     136: aload         6
     138: areturn
     139: goto          6
     142: goto          162
     145: astore        4
     147: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     150: dup
     151: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     154: aload         4
     156: ldc           #118                // String keystore
     158: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     161: athrow
     162: iconst_0
     163: anewarray     #211                // class java/security/cert/Certificate
     166: areturn
    Exception table:
       from    to  target type
           0   138   145   Class java/security/KeyStoreException
         139   142   145   Class java/security/KeyStoreException

  private java.security.cert.X509Certificate[] getX509Certificates(byte[]) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aconst_null
       1: astore_2
       2: ldc           #214                // String SHA1
       4: invokestatic  #215                // Method java/security/MessageDigest.getInstance:(Ljava/lang/String;)Ljava/security/MessageDigest;
       7: astore_2
       8: goto          26
      11: astore_3
      12: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
      15: dup
      16: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      19: aload_3
      20: ldc           #216                // String decoding.general
      22: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
      25: athrow
      26: aconst_null
      27: astore_3
      28: aload_0
      29: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      32: ifnull        46
      35: aload_0
      36: aload_1
      37: aload_0
      38: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      41: aload_2
      42: invokespecial #217                // Method getCertificates:([BLjava/security/KeyStore;Ljava/security/MessageDigest;)[Ljava/security/cert/Certificate;
      45: astore_3
      46: aload_3
      47: ifnull        55
      50: aload_3
      51: arraylength
      52: ifne          73
      55: aload_0
      56: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      59: ifnull        73
      62: aload_0
      63: aload_1
      64: aload_0
      65: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      68: aload_2
      69: invokespecial #217                // Method getCertificates:([BLjava/security/KeyStore;Ljava/security/MessageDigest;)[Ljava/security/cert/Certificate;
      72: astore_3
      73: aload_3
      74: ifnull        82
      77: aload_3
      78: arraylength
      79: ifne          84
      82: aconst_null
      83: areturn
      84: aload_3
      85: aload_3
      86: arraylength
      87: ldc_w         #208                // class "[Ljava/security/cert/X509Certificate;"
      90: invokestatic  #209                // Method java/util/Arrays.copyOf:([Ljava/lang/Object;ILjava/lang/Class;)[Ljava/lang/Object;
      93: checkcast     #208                // class "[Ljava/security/cert/X509Certificate;"
      96: areturn
    Exception table:
       from    to  target type
           2     8    11   Class java/security/NoSuchAlgorithmException

  private java.security.cert.Certificate[] getCertificates(byte[], java.security.KeyStore, java.security.MessageDigest) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #114                // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
       4: astore        4
       6: aload         4
       8: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      13: ifeq          151
      16: aload         4
      18: invokeinterface #116,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      23: checkcast     #33                 // class java/lang/String
      26: astore        5
      28: aload_2
      29: aload         5
      31: invokevirtual #210                // Method java/security/KeyStore.getCertificateChain:(Ljava/lang/String;)[Ljava/security/cert/Certificate;
      34: astore        6
      36: aload         6
      38: ifnull        47
      41: aload         6
      43: arraylength
      44: ifne          71
      47: aload_2
      48: aload         5
      50: invokevirtual #182                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
      53: astore        7
      55: aload         7
      57: ifnull        71
      60: iconst_1
      61: anewarray     #211                // class java/security/cert/Certificate
      64: dup
      65: iconst_0
      66: aload         7
      68: aastore
      69: astore        6
      71: aload         6
      73: ifnull        148
      76: aload         6
      78: arraylength
      79: ifle          148
      82: aload         6
      84: iconst_0
      85: aaload
      86: instanceof    #175                // class java/security/cert/X509Certificate
      89: ifeq          148
      92: aload         6
      94: iconst_0
      95: aaload
      96: checkcast     #175                // class java/security/cert/X509Certificate
      99: astore        7
     101: aload_3
     102: aload         7
     104: invokevirtual #218                // Method java/security/cert/X509Certificate.getEncoded:()[B
     107: invokevirtual #219                // Method java/security/MessageDigest.update:([B)V
     110: goto          130
     113: astore        8
     115: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     118: dup
     119: getstatic     #106                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.SECURITY_TOKEN_UNAVAILABLE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     122: aload         8
     124: ldc           #221                // String encodeError
     126: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     129: athrow
     130: aload_3
     131: invokevirtual #222                // Method java/security/MessageDigest.digest:()[B
     134: astore        8
     136: aload         8
     138: aload_1
     139: invokestatic  #223                // Method java/util/Arrays.equals:([B[B)Z
     142: ifeq          148
     145: aload         6
     147: areturn
     148: goto          6
     151: goto          171
     154: astore        4
     156: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     159: dup
     160: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     163: aload         4
     165: ldc           #118                // String keystore
     167: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     170: athrow
     171: iconst_0
     172: anewarray     #211                // class java/security/cert/Certificate
     175: areturn
    Exception table:
       from    to  target type
         101   110   113   Class java/security/cert/CertificateEncodingException
           0   147   154   Class java/security/KeyStoreException
         148   151   154   Class java/security/KeyStoreException

  private java.security.cert.X509Certificate[] getX509CertificatesSKI(byte[]) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aconst_null
       1: astore_2
       2: aload_0
       3: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
       6: ifnull        19
       9: aload_0
      10: aload_1
      11: aload_0
      12: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      15: invokespecial #224                // Method getCertificates:([BLjava/security/KeyStore;)[Ljava/security/cert/Certificate;
      18: astore_2
      19: aload_2
      20: ifnull        28
      23: aload_2
      24: arraylength
      25: ifne          45
      28: aload_0
      29: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      32: ifnull        45
      35: aload_0
      36: aload_1
      37: aload_0
      38: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      41: invokespecial #224                // Method getCertificates:([BLjava/security/KeyStore;)[Ljava/security/cert/Certificate;
      44: astore_2
      45: aload_2
      46: ifnull        54
      49: aload_2
      50: arraylength
      51: ifne          56
      54: aconst_null
      55: areturn
      56: aload_2
      57: aload_2
      58: arraylength
      59: ldc_w         #208                // class "[Ljava/security/cert/X509Certificate;"
      62: invokestatic  #209                // Method java/util/Arrays.copyOf:([Ljava/lang/Object;ILjava/lang/Class;)[Ljava/lang/Object;
      65: checkcast     #208                // class "[Ljava/security/cert/X509Certificate;"
      68: areturn

  private java.security.cert.Certificate[] getCertificates(byte[], java.security.KeyStore) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #114                // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
       4: astore_3
       5: aload_3
       6: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      11: ifeq          129
      14: aload_3
      15: invokeinterface #116,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      20: checkcast     #33                 // class java/lang/String
      23: astore        4
      25: aload_2
      26: aload         4
      28: invokevirtual #210                // Method java/security/KeyStore.getCertificateChain:(Ljava/lang/String;)[Ljava/security/cert/Certificate;
      31: astore        5
      33: aload         5
      35: ifnull        44
      38: aload         5
      40: arraylength
      41: ifne          68
      44: aload_2
      45: aload         4
      47: invokevirtual #182                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
      50: astore        6
      52: aload         6
      54: ifnull        68
      57: iconst_1
      58: anewarray     #211                // class java/security/cert/Certificate
      61: dup
      62: iconst_0
      63: aload         6
      65: aastore
      66: astore        5
      68: aload         5
      70: ifnull        126
      73: aload         5
      75: arraylength
      76: ifle          126
      79: aload         5
      81: iconst_0
      82: aaload
      83: instanceof    #175                // class java/security/cert/X509Certificate
      86: ifeq          126
      89: aload         5
      91: iconst_0
      92: aaload
      93: checkcast     #175                // class java/security/cert/X509Certificate
      96: astore        6
      98: aload_0
      99: aload         6
     101: invokevirtual #225                // Method getSKIBytesFromCert:(Ljava/security/cert/X509Certificate;)[B
     104: astore        7
     106: aload         7
     108: arraylength
     109: aload_1
     110: arraylength
     111: if_icmpne     126
     114: aload         7
     116: aload_1
     117: invokestatic  #223                // Method java/util/Arrays.equals:([B[B)Z
     120: ifeq          126
     123: aload         5
     125: areturn
     126: goto          5
     129: goto          147
     132: astore_3
     133: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     136: dup
     137: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     140: aload_3
     141: ldc           #118                // String keystore
     143: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     146: athrow
     147: iconst_0
     148: anewarray     #211                // class java/security/cert/Certificate
     151: areturn
    Exception table:
       from    to  target type
           0   125   132   Class java/security/KeyStoreException
         126   129   132   Class java/security/KeyStoreException

  private java.security.cert.X509Certificate[] getX509CertificatesSubjectDN(java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #203                // class javax/security/auth/x500/X500Principal
       3: dup
       4: aload_1
       5: invokespecial #204                // Method javax/security/auth/x500/X500Principal."<init>":(Ljava/lang/String;)V
       8: astore_3
       9: aload_0
      10: aload_3
      11: invokevirtual #153                // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
      14: invokevirtual #205                // Method createBCX509Name:(Ljava/lang/String;)Ljava/lang/Object;
      17: astore_2
      18: goto          28
      21: astore_3
      22: aload_0
      23: aload_1
      24: invokevirtual #205                // Method createBCX509Name:(Ljava/lang/String;)Ljava/lang/Object;
      27: astore_2
      28: aconst_null
      29: astore_3
      30: aload_0
      31: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      34: ifnull        47
      37: aload_0
      38: aload_2
      39: aload_0
      40: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      43: invokespecial #226                // Method getCertificates:(Ljava/lang/Object;Ljava/security/KeyStore;)[Ljava/security/cert/Certificate;
      46: astore_3
      47: aload_3
      48: ifnull        56
      51: aload_3
      52: arraylength
      53: ifne          73
      56: aload_0
      57: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      60: ifnull        73
      63: aload_0
      64: aload_2
      65: aload_0
      66: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      69: invokespecial #226                // Method getCertificates:(Ljava/lang/Object;Ljava/security/KeyStore;)[Ljava/security/cert/Certificate;
      72: astore_3
      73: aload_3
      74: ifnull        82
      77: aload_3
      78: arraylength
      79: ifne          84
      82: aconst_null
      83: areturn
      84: aload_3
      85: aload_3
      86: arraylength
      87: ldc_w         #208                // class "[Ljava/security/cert/X509Certificate;"
      90: invokestatic  #209                // Method java/util/Arrays.copyOf:([Ljava/lang/Object;ILjava/lang/Class;)[Ljava/lang/Object;
      93: checkcast     #208                // class "[Ljava/security/cert/X509Certificate;"
      96: areturn
    Exception table:
       from    to  target type
           0    18    21   Class java/lang/IllegalArgumentException

  private java.security.cert.X509Certificate[] getX509Certificates(java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aconst_null
       1: astore_2
       2: aload_0
       3: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
       6: ifnull        49
       9: aload_0
      10: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      13: aload_1
      14: invokevirtual #210                // Method java/security/KeyStore.getCertificateChain:(Ljava/lang/String;)[Ljava/security/cert/Certificate;
      17: astore_2
      18: aload_2
      19: ifnull        27
      22: aload_2
      23: arraylength
      24: ifne          49
      27: aload_0
      28: getfield      #52                 // Field keystore:Ljava/security/KeyStore;
      31: aload_1
      32: invokevirtual #182                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
      35: astore_3
      36: aload_3
      37: ifnull        49
      40: iconst_1
      41: anewarray     #211                // class java/security/cert/Certificate
      44: dup
      45: iconst_0
      46: aload_3
      47: aastore
      48: astore_2
      49: aload_2
      50: ifnonnull     95
      53: aload_0
      54: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      57: ifnull        95
      60: aload_0
      61: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      64: aload_1
      65: invokevirtual #210                // Method java/security/KeyStore.getCertificateChain:(Ljava/lang/String;)[Ljava/security/cert/Certificate;
      68: astore_2
      69: aload_2
      70: ifnonnull     95
      73: aload_0
      74: getfield      #2                  // Field truststore:Ljava/security/KeyStore;
      77: aload_1
      78: invokevirtual #182                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
      81: astore_3
      82: aload_3
      83: ifnull        95
      86: iconst_1
      87: anewarray     #211                // class java/security/cert/Certificate
      90: dup
      91: iconst_0
      92: aload_3
      93: aastore
      94: astore_2
      95: aload_2
      96: ifnonnull     101
      99: aconst_null
     100: areturn
     101: goto          119
     104: astore_3
     105: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     108: dup
     109: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     112: aload_3
     113: ldc           #118                // String keystore
     115: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     118: athrow
     119: aload_2
     120: aload_2
     121: arraylength
     122: ldc_w         #208                // class "[Ljava/security/cert/X509Certificate;"
     125: invokestatic  #209                // Method java/util/Arrays.copyOf:([Ljava/lang/Object;ILjava/lang/Class;)[Ljava/lang/Object;
     128: checkcast     #208                // class "[Ljava/security/cert/X509Certificate;"
     131: areturn
    Exception table:
       from    to  target type
           2   100   104   Class java/security/KeyStoreException

  private boolean findPublicKeyInKeyStore(java.security.PublicKey, java.security.KeyStore);
    Code:
       0: aload_2
       1: ifnonnull     6
       4: iconst_0
       5: ireturn
       6: aload_2
       7: invokevirtual #114                // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
      10: astore_3
      11: aload_3
      12: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      17: ifeq          117
      20: aload_3
      21: invokeinterface #116,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      26: checkcast     #33                 // class java/lang/String
      29: astore        4
      31: aload_2
      32: aload         4
      34: invokevirtual #210                // Method java/security/KeyStore.getCertificateChain:(Ljava/lang/String;)[Ljava/security/cert/Certificate;
      37: astore        5
      39: aload         5
      41: ifnull        50
      44: aload         5
      46: arraylength
      47: ifne          74
      50: aload_2
      51: aload         4
      53: invokevirtual #182                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
      56: astore        6
      58: aload         6
      60: ifnull        74
      63: iconst_1
      64: anewarray     #211                // class java/security/cert/Certificate
      67: dup
      68: iconst_0
      69: aload         6
      71: aastore
      72: astore        5
      74: aload         5
      76: ifnull        114
      79: aload         5
      81: arraylength
      82: ifle          114
      85: aload         5
      87: iconst_0
      88: aaload
      89: instanceof    #175                // class java/security/cert/X509Certificate
      92: ifeq          114
      95: aload_1
      96: aload         5
      98: iconst_0
      99: aaload
     100: checkcast     #175                // class java/security/cert/X509Certificate
     103: invokevirtual #227                // Method java/security/cert/X509Certificate.getPublicKey:()Ljava/security/PublicKey;
     106: invokevirtual #213                // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
     109: ifeq          114
     112: iconst_1
     113: ireturn
     114: goto          11
     117: goto          123
     120: astore_3
     121: iconst_0
     122: ireturn
     123: iconst_0
     124: ireturn
    Exception table:
       from    to  target type
           6   113   120   Class java/security/KeyStoreException
         114   117   120   Class java/security/KeyStoreException

  private java.security.cert.Certificate[] getCertificates(java.lang.Object, java.security.KeyStore) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #114                // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
       4: astore_3
       5: aload_3
       6: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      11: ifeq          127
      14: aload_3
      15: invokeinterface #116,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      20: checkcast     #33                 // class java/lang/String
      23: astore        4
      25: aload_2
      26: aload         4
      28: invokevirtual #210                // Method java/security/KeyStore.getCertificateChain:(Ljava/lang/String;)[Ljava/security/cert/Certificate;
      31: astore        5
      33: aload         5
      35: ifnull        44
      38: aload         5
      40: arraylength
      41: ifne          68
      44: aload_2
      45: aload         4
      47: invokevirtual #182                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
      50: astore        6
      52: aload         6
      54: ifnull        68
      57: iconst_1
      58: anewarray     #211                // class java/security/cert/Certificate
      61: dup
      62: iconst_0
      63: aload         6
      65: aastore
      66: astore        5
      68: aload         5
      70: ifnull        124
      73: aload         5
      75: arraylength
      76: ifle          124
      79: aload         5
      81: iconst_0
      82: aaload
      83: instanceof    #175                // class java/security/cert/X509Certificate
      86: ifeq          124
      89: aload         5
      91: iconst_0
      92: aaload
      93: checkcast     #175                // class java/security/cert/X509Certificate
      96: invokevirtual #168                // Method java/security/cert/X509Certificate.getSubjectX500Principal:()Ljavax/security/auth/x500/X500Principal;
      99: astore        6
     101: aload_0
     102: aload         6
     104: invokevirtual #153                // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
     107: invokevirtual #205                // Method createBCX509Name:(Ljava/lang/String;)Ljava/lang/Object;
     110: astore        7
     112: aload_1
     113: aload         7
     115: invokevirtual #213                // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
     118: ifeq          124
     121: aload         5
     123: areturn
     124: goto          5
     127: goto          145
     130: astore_3
     131: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     134: dup
     135: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     138: aload_3
     139: ldc           #118                // String keystore
     141: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     144: athrow
     145: iconst_0
     146: anewarray     #211                // class java/security/cert/Certificate
     149: areturn
    Exception table:
       from    to  target type
           0   123   130   Class java/security/KeyStoreException
         124   127   130   Class java/security/KeyStoreException

  private static java.lang.String createKeyStoreErrorMessage(java.security.KeyStore) throws java.security.KeyStoreException;
    Code:
       0: aload_0
       1: invokevirtual #114                // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
       4: astore_1
       5: new           #3                  // class java/lang/StringBuilder
       8: dup
       9: aload_0
      10: invokevirtual #228                // Method java/security/KeyStore.size:()I
      13: bipush        7
      15: imul
      16: invokespecial #229                // Method java/lang/StringBuilder."<init>":(I)V
      19: astore_2
      20: iconst_1
      21: istore_3
      22: aload_1
      23: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      28: ifeq          61
      31: iload_3
      32: ifne          42
      35: aload_2
      36: ldc           #230                // String ,
      38: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      41: pop
      42: aload_2
      43: aload_1
      44: invokeinterface #116,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      49: checkcast     #33                 // class java/lang/String
      52: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      55: pop
      56: iconst_0
      57: istore_3
      58: goto          22
      61: new           #3                  // class java/lang/StringBuilder
      64: dup
      65: invokespecial #4                  // Method java/lang/StringBuilder."<init>":()V
      68: ldc           #231                // String  in keystore of type [
      70: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      73: aload_0
      74: invokevirtual #232                // Method java/security/KeyStore.getType:()Ljava/lang/String;
      77: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      80: ldc           #233                // String ] from provider [
      82: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      85: aload_0
      86: invokevirtual #99                 // Method java/security/KeyStore.getProvider:()Ljava/security/Provider;
      89: invokevirtual #234                // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      92: ldc           #235                // String ] with size [
      94: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      97: aload_0
      98: invokevirtual #228                // Method java/security/KeyStore.size:()I
     101: invokevirtual #236                // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     104: ldc           #237                // String ] and aliases: {
     106: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     109: aload_2
     110: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     113: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     116: ldc           #238                // String }
     118: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     121: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     124: astore        4
     126: aload         4
     128: areturn

  private java.lang.String getIdentifier(java.security.cert.X509Certificate, java.security.KeyStore) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #114                // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
       4: astore_3
       5: aload_3
       6: invokeinterface #115,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      11: ifeq          96
      14: aload_3
      15: invokeinterface #116,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      20: checkcast     #33                 // class java/lang/String
      23: astore        4
      25: aload_2
      26: aload         4
      28: invokevirtual #210                // Method java/security/KeyStore.getCertificateChain:(Ljava/lang/String;)[Ljava/security/cert/Certificate;
      31: astore        5
      33: aload         5
      35: ifnull        44
      38: aload         5
      40: arraylength
      41: ifne          68
      44: aload_2
      45: aload         4
      47: invokevirtual #182                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
      50: astore        6
      52: aload         6
      54: ifnull        68
      57: iconst_1
      58: anewarray     #211                // class java/security/cert/Certificate
      61: dup
      62: iconst_0
      63: aload         6
      65: aastore
      66: astore        5
      68: aload         5
      70: ifnull        93
      73: aload         5
      75: arraylength
      76: ifle          93
      79: aload         5
      81: iconst_0
      82: aaload
      83: aload_1
      84: invokevirtual #239                // Method java/security/cert/Certificate.equals:(Ljava/lang/Object;)Z
      87: ifeq          93
      90: aload         4
      92: areturn
      93: goto          5
      96: goto          114
      99: astore_3
     100: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
     103: dup
     104: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     107: aload_3
     108: ldc           #118                // String keystore
     110: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     113: athrow
     114: aconst_null
     115: areturn
    Exception table:
       from    to  target type
           0    92    99   Class java/security/KeyStoreException
          93    96    99   Class java/security/KeyStoreException

  private java.lang.String getPassword(java.lang.String, javax.security.auth.callback.CallbackHandler) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #240                // class org/apache/wss4j/common/ext/WSPasswordCallback
       3: dup
       4: aload_1
       5: iconst_1
       6: invokespecial #241                // Method org/apache/wss4j/common/ext/WSPasswordCallback."<init>":(Ljava/lang/String;I)V
       9: astore_3
      10: iconst_1
      11: anewarray     #242                // class javax/security/auth/callback/Callback
      14: dup
      15: iconst_0
      16: aload_3
      17: aastore
      18: astore        4
      20: aload_2
      21: aload         4
      23: invokeinterface #243,  2          // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      28: goto          56
      31: astore        4
      33: new           #85                 // class org/apache/wss4j/common/ext/WSSecurityException
      36: dup
      37: getstatic     #86                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      40: aload         4
      42: ldc           #245                // String noPassword
      44: iconst_1
      45: anewarray     #92                 // class java/lang/Object
      48: dup
      49: iconst_0
      50: aload_1
      51: aastore
      52: invokespecial #93                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
      55: athrow
      56: aload_3
      57: invokevirtual #246                // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
      60: areturn
    Exception table:
       from    to  target type
          10    28    31   Class java/io/IOException
          10    28    31   Class javax/security/auth/callback/UnsupportedCallbackException

  protected java.lang.String decryptPassword(java.lang.String, org.apache.wss4j.common.crypto.PasswordEncryptor);
    Code:
       0: aload_1
       1: ldc           #247                // String ENC(
       3: invokevirtual #34                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
       6: ifeq          60
       9: aload_1
      10: ldc           #248                // String )
      12: invokevirtual #249                // Method java/lang/String.endsWith:(Ljava/lang/String;)Z
      15: ifeq          60
      18: aload_2
      19: ifnonnull     36
      22: ldc           #250                // String The Crypto properties has an encrypted password, but no PasswordEncryptor is configured!
      24: astore_3
      25: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
      28: aload_3
      29: invokeinterface #57,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      34: aload_1
      35: areturn
      36: aload_1
      37: ldc           #247                // String ENC(
      39: invokevirtual #75                 // Method java/lang/String.length:()I
      42: aload_1
      43: invokevirtual #75                 // Method java/lang/String.length:()I
      46: iconst_1
      47: isub
      48: invokevirtual #251                // Method java/lang/String.substring:(II)Ljava/lang/String;
      51: astore_3
      52: aload_2
      53: aload_3
      54: invokeinterface #252,  2          // InterfaceMethod org/apache/wss4j/common/crypto/PasswordEncryptor.decrypt:(Ljava/lang/String;)Ljava/lang/String;
      59: areturn
      60: aload_1
      61: areturn

  public void setPasswordEncryptor(org.apache.wss4j.common.crypto.PasswordEncryptor);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #27                 // Field passwordEncryptor:Lorg/apache/wss4j/common/crypto/PasswordEncryptor;
       5: return

  static {};
    Code:
       0: ldc_w         #253                // class org/apache/wss4j/common/crypto/Merlin
       3: invokestatic  #254                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
       9: getstatic     #21                 // Field LOG:Lorg/slf4j/Logger;
      12: invokeinterface #166,  1          // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
      17: putstatic     #53                 // Field DO_DEBUG:Z
      20: return
}
