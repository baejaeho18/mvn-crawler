Compiled from "EncryptedDataProcessor.java"
public class org.apache.wss4j.dom.processor.EncryptedDataProcessor implements org.apache.wss4j.dom.processor.Processor {
  private static final org.slf4j.Logger LOG;

  public org.apache.wss4j.dom.processor.EncryptedDataProcessor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult> handleToken(org.w3c.dom.Element, org.apache.wss4j.dom.handler.RequestData, org.apache.wss4j.dom.WSDocInfo) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
       3: invokeinterface #3,  1            // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
       8: ifeq          21
      11: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
      14: ldc           #4                  // String Found EncryptedData element
      16: invokeinterface #5,  2            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      21: aload_1
      22: aconst_null
      23: ldc           #6                  // String Id
      25: invokeinterface #7,  3            // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      30: astore        4
      32: aload_1
      33: ldc           #8                  // String KeyInfo
      35: ldc           #9                  // String http://www.w3.org/2000/09/xmldsig#
      37: invokestatic  #10                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      40: astore        5
      42: aload         5
      44: ifnonnull     60
      47: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
      50: dup
      51: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.UNSUPPORTED_ALGORITHM:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      54: ldc           #13                 // String noKeyinfo
      56: invokespecial #14                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      59: athrow
      60: aload_1
      61: invokestatic  #15                 // Method org/apache/wss4j/dom/util/X509Util.getEncAlgo:(Lorg/w3c/dom/Node;)Ljava/lang/String;
      64: astore        6
      66: aload         6
      68: aload_2
      69: invokevirtual #16                 // Method org/apache/wss4j/dom/handler/RequestData.getBSPEnforcer:()Lorg/apache/wss4j/common/bsp/BSPEnforcer;
      72: invokestatic  #17                 // Method checkBSPCompliance:(Ljava/lang/String;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      75: aload         5
      77: ldc           #18                 // String SecurityTokenReference
      79: ldc           #19                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
      81: invokestatic  #10                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      84: astore        7
      86: aload         5
      88: ldc           #20                 // String EncryptedKey
      90: ldc           #21                 // String http://www.w3.org/2001/04/xmlenc#
      92: invokestatic  #10                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      95: astore        8
      97: aload_2
      98: invokevirtual #22                 // Method org/apache/wss4j/dom/handler/RequestData.isRequireSignedEncryptedDataElements:()Z
     101: ifeq          120
     104: aload_3
     105: iconst_2
     106: invokestatic  #23                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     109: invokevirtual #24                 // Method org/apache/wss4j/dom/WSDocInfo.getResultsByTag:(Ljava/lang/Integer;)Ljava/util/List;
     112: astore        9
     114: aload_1
     115: aload         9
     117: invokestatic  #25                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.verifySignedElement:(Lorg/w3c/dom/Element;Ljava/util/List;)V
     120: aconst_null
     121: astore        9
     123: aconst_null
     124: astore        10
     126: aconst_null
     127: astore        11
     129: aload         7
     131: ifnull        232
     134: new           #26                 // class org/apache/wss4j/dom/str/STRParserParameters
     137: dup
     138: invokespecial #27                 // Method org/apache/wss4j/dom/str/STRParserParameters."<init>":()V
     141: astore        12
     143: aload         12
     145: aload_2
     146: invokevirtual #28                 // Method org/apache/wss4j/dom/str/STRParserParameters.setData:(Lorg/apache/wss4j/dom/handler/RequestData;)V
     149: aload         12
     151: aload_3
     152: invokevirtual #29                 // Method org/apache/wss4j/dom/str/STRParserParameters.setWsDocInfo:(Lorg/apache/wss4j/dom/WSDocInfo;)V
     155: aload         12
     157: aload         7
     159: invokevirtual #30                 // Method org/apache/wss4j/dom/str/STRParserParameters.setStrElement:(Lorg/w3c/dom/Element;)V
     162: aload         6
     164: ifnull        177
     167: aload         12
     169: aload         6
     171: invokestatic  #31                 // Method org/apache/wss4j/common/util/KeyUtils.getKeyLength:(Ljava/lang/String;)I
     174: invokevirtual #32                 // Method org/apache/wss4j/dom/str/STRParserParameters.setDerivationKeyLength:(I)V
     177: new           #33                 // class org/apache/wss4j/dom/str/SecurityTokenRefSTRParser
     180: dup
     181: invokespecial #34                 // Method org/apache/wss4j/dom/str/SecurityTokenRefSTRParser."<init>":()V
     184: astore        13
     186: aload         13
     188: aload         12
     190: invokeinterface #35,  2           // InterfaceMethod org/apache/wss4j/dom/str/STRParser.parseSecurityTokenReference:(Lorg/apache/wss4j/dom/str/STRParserParameters;)Lorg/apache/wss4j/dom/str/STRParserResult;
     195: astore        14
     197: aload         14
     199: invokevirtual #36                 // Method org/apache/wss4j/dom/str/STRParserResult.getSecretKey:()[B
     202: astore        15
     204: aload         14
     206: invokevirtual #37                 // Method org/apache/wss4j/dom/str/STRParserResult.getPrincipal:()Ljava/security/Principal;
     209: astore        11
     211: aload         6
     213: aload         15
     215: invokestatic  #38                 // Method org/apache/wss4j/common/util/KeyUtils.prepareSecretKey:(Ljava/lang/String;[B)Ljavax/crypto/SecretKey;
     218: astore        9
     220: new           #39                 // class java/util/ArrayList
     223: dup
     224: invokespecial #40                 // Method java/util/ArrayList."<init>":()V
     227: astore        10
     229: goto          306
     232: aload         8
     234: ifnull        293
     237: new           #41                 // class org/apache/wss4j/dom/processor/EncryptedKeyProcessor
     240: dup
     241: invokespecial #42                 // Method org/apache/wss4j/dom/processor/EncryptedKeyProcessor."<init>":()V
     244: astore        12
     246: aload         12
     248: aload         8
     250: aload_2
     251: aload_3
     252: invokevirtual #43                 // Method org/apache/wss4j/dom/processor/EncryptedKeyProcessor.handleToken:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Ljava/util/List;
     255: astore        10
     257: aload         10
     259: iconst_0
     260: invokeinterface #44,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     265: checkcast     #45                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     268: ldc           #46                 // String secret
     270: invokevirtual #47                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     273: checkcast     #48                 // class "[B"
     276: checkcast     #48                 // class "[B"
     279: astore        13
     281: aload         6
     283: aload         13
     285: invokestatic  #38                 // Method org/apache/wss4j/common/util/KeyUtils.prepareSecretKey:(Ljava/lang/String;[B)Ljavax/crypto/SecretKey;
     288: astore        9
     290: goto          306
     293: new           #11                 // class org/apache/wss4j/common/ext/WSSecurityException
     296: dup
     297: getstatic     #12                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.UNSUPPORTED_ALGORITHM:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     300: ldc           #49                 // String noEncKey
     302: invokespecial #14                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     305: athrow
     306: aload_2
     307: invokevirtual #50                 // Method org/apache/wss4j/dom/handler/RequestData.getAlgorithmSuite:()Lorg/apache/wss4j/common/crypto/AlgorithmSuite;
     310: astore        12
     312: aload         12
     314: ifnull        382
     317: new           #51                 // class org/apache/wss4j/common/crypto/AlgorithmSuiteValidator
     320: dup
     321: aload         12
     323: invokespecial #52                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator."<init>":(Lorg/apache/wss4j/common/crypto/AlgorithmSuite;)V
     326: astore        13
     328: aload         11
     330: instanceof    #53                 // class org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal
     333: ifeq          362
     336: aload         13
     338: aload         11
     340: checkcast     #53                 // class org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal
     343: invokevirtual #54                 // Method org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal.getAlgorithm:()Ljava/lang/String;
     346: invokevirtual #55                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkDerivedKeyAlgorithm:(Ljava/lang/String;)V
     349: aload         13
     351: aload         11
     353: checkcast     #53                 // class org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal
     356: invokevirtual #56                 // Method org/apache/wss4j/common/principal/WSDerivedKeyTokenPrincipal.getLength:()I
     359: invokevirtual #57                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkEncryptionDerivedKeyLength:(I)V
     362: aload         13
     364: aload         9
     366: invokeinterface #58,  1           // InterfaceMethod javax/crypto/SecretKey.getEncoded:()[B
     371: arraylength
     372: invokevirtual #59                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkSymmetricKeyLength:(I)V
     375: aload         13
     377: aload         6
     379: invokevirtual #60                 // Method org/apache/wss4j/common/crypto/AlgorithmSuiteValidator.checkSymmetricEncryptionAlgorithm:(Ljava/lang/String;)V
     382: aload_1
     383: invokeinterface #61,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     388: aload         4
     390: aload_1
     391: aload         9
     393: aload         6
     395: aload_2
     396: invokevirtual #62                 // Method org/apache/wss4j/dom/handler/RequestData.getAttachmentCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     399: invokestatic  #63                 // Method org/apache/wss4j/dom/util/EncryptionUtils.decryptEncryptedData:(Lorg/w3c/dom/Document;Ljava/lang/String;Lorg/w3c/dom/Element;Ljavax/crypto/SecretKey;Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)Lorg/apache/wss4j/dom/WSDataRef;
     402: astore        13
     404: new           #45                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     407: dup
     408: iconst_4
     409: aload         13
     411: invokestatic  #64                 // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
     414: invokespecial #65                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult."<init>":(ILjava/util/List;)V
     417: astore        14
     419: ldc           #66                 // String
     421: aload         4
     423: invokevirtual #67                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     426: ifne          439
     429: aload         14
     431: ldc           #68                 // String id
     433: aload         4
     435: invokevirtual #69                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     438: pop
     439: aload_3
     440: aload         14
     442: invokevirtual #70                 // Method org/apache/wss4j/dom/WSDocInfo.addResult:(Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;)V
     445: aload_3
     446: aload_1
     447: invokevirtual #71                 // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;)V
     450: new           #72                 // class java/util/LinkedList
     453: dup
     454: invokespecial #73                 // Method java/util/LinkedList."<init>":()V
     457: astore        15
     459: aload         15
     461: aload         10
     463: invokeinterface #74,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     468: pop
     469: aload         15
     471: aload         14
     473: invokeinterface #75,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     478: pop
     479: aload_2
     480: invokevirtual #76                 // Method org/apache/wss4j/dom/handler/RequestData.getWssConfig:()Lorg/apache/wss4j/dom/engine/WSSConfig;
     483: astore        16
     485: aload         16
     487: ifnull        613
     490: aload         13
     492: invokevirtual #77                 // Method org/apache/wss4j/dom/WSDataRef.getProtectedElement:()Lorg/w3c/dom/Element;
     495: astore        17
     497: aload         17
     499: ifnull        613
     502: new           #78                 // class javax/xml/namespace/QName
     505: dup
     506: aload         17
     508: invokeinterface #79,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
     513: aload         17
     515: invokeinterface #80,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
     520: invokespecial #81                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     523: astore        18
     525: aload_2
     526: invokevirtual #76                 // Method org/apache/wss4j/dom/handler/RequestData.getWssConfig:()Lorg/apache/wss4j/dom/engine/WSSConfig;
     529: aload         18
     531: invokevirtual #82                 // Method org/apache/wss4j/dom/engine/WSSConfig.getProcessor:(Ljavax/xml/namespace/QName;)Lorg/apache/wss4j/dom/processor/Processor;
     534: astore        19
     536: aload         19
     538: ifnull        613
     541: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
     544: invokeinterface #3,  1            // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     549: ifeq          586
     552: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
     555: new           #83                 // class java/lang/StringBuilder
     558: dup
     559: invokespecial #84                 // Method java/lang/StringBuilder."<init>":()V
     562: ldc           #85                 // String Processing decrypted element with:
     564: invokevirtual #86                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     567: aload         19
     569: invokevirtual #87                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
     572: invokevirtual #88                 // Method java/lang/Class.getName:()Ljava/lang/String;
     575: invokevirtual #86                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     578: invokevirtual #89                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     581: invokeinterface #5,  2            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     586: aload         19
     588: aload         17
     590: aload_2
     591: aload_3
     592: invokeinterface #90,  4           // InterfaceMethod org/apache/wss4j/dom/processor/Processor.handleToken:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Ljava/util/List;
     597: astore        20
     599: aload         15
     601: iconst_0
     602: aload         20
     604: invokeinterface #91,  3           // InterfaceMethod java/util/List.addAll:(ILjava/util/Collection;)Z
     609: pop
     610: aload         15
     612: areturn
     613: aload         15
     615: areturn

  private static void checkBSPCompliance(java.lang.String, org.apache.wss4j.common.bsp.BSPEnforcer) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: ifnonnull     11
       4: aload_1
       5: getstatic     #92                 // Field org/apache/wss4j/common/bsp/BSPRule.R5601:Lorg/apache/wss4j/common/bsp/BSPRule;
       8: invokevirtual #93                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      11: ldc           #94                 // String http://www.w3.org/2001/04/xmlenc#tripledes-cbc
      13: aload_0
      14: invokevirtual #67                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      17: ifne          63
      20: ldc           #95                 // String http://www.w3.org/2001/04/xmlenc#aes128-cbc
      22: aload_0
      23: invokevirtual #67                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      26: ifne          63
      29: ldc           #96                 // String http://www.w3.org/2009/xmlenc11#aes128-gcm
      31: aload_0
      32: invokevirtual #67                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      35: ifne          63
      38: ldc           #97                 // String http://www.w3.org/2001/04/xmlenc#aes256-cbc
      40: aload_0
      41: invokevirtual #67                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      44: ifne          63
      47: ldc           #98                 // String http://www.w3.org/2009/xmlenc11#aes256-gcm
      49: aload_0
      50: invokevirtual #67                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      53: ifne          63
      56: aload_1
      57: getstatic     #99                 // Field org/apache/wss4j/common/bsp/BSPRule.R5620:Lorg/apache/wss4j/common/bsp/BSPRule;
      60: invokevirtual #93                 // Method org/apache/wss4j/common/bsp/BSPEnforcer.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      63: return

  static {};
    Code:
       0: ldc_w         #100                // class org/apache/wss4j/dom/processor/EncryptedDataProcessor
       3: invokestatic  #101                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
       9: return
}
