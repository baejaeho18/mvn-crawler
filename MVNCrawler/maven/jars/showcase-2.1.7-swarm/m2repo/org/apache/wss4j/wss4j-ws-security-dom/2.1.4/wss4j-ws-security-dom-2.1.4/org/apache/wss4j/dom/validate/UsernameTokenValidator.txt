Compiled from "UsernameTokenValidator.java"
public class org.apache.wss4j.dom.validate.UsernameTokenValidator implements org.apache.wss4j.dom.validate.Validator {
  private static final org.slf4j.Logger LOG;

  public org.apache.wss4j.dom.validate.UsernameTokenValidator();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public org.apache.wss4j.dom.validate.Credential validate(org.apache.wss4j.dom.validate.Credential, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnull        11
       4: aload_1
       5: invokevirtual #2                  // Method org/apache/wss4j/dom/validate/Credential.getUsernametoken:()Lorg/apache/wss4j/dom/message/token/UsernameToken;
       8: ifnonnull     24
      11: new           #3                  // class org/apache/wss4j/common/ext/WSSecurityException
      14: dup
      15: getstatic     #4                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      18: ldc           #5                  // String noCredential
      20: invokespecial #6                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      23: athrow
      24: aload_2
      25: invokevirtual #7                  // Method org/apache/wss4j/dom/handler/RequestData.isHandleCustomPasswordTypes:()Z
      28: istore_3
      29: aload_2
      30: invokevirtual #8                  // Method org/apache/wss4j/dom/handler/RequestData.isEncodePasswords:()Z
      33: istore        4
      35: aload_2
      36: invokevirtual #9                  // Method org/apache/wss4j/dom/handler/RequestData.getRequiredPasswordType:()Ljava/lang/String;
      39: astore        5
      41: aload_1
      42: invokevirtual #2                  // Method org/apache/wss4j/dom/validate/Credential.getUsernametoken:()Lorg/apache/wss4j/dom/message/token/UsernameToken;
      45: astore        6
      47: aload         6
      49: iload         4
      51: invokevirtual #10                 // Method org/apache/wss4j/dom/message/token/UsernameToken.setPasswordsAreEncoded:(Z)V
      54: aload         6
      56: invokevirtual #11                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getPasswordType:()Ljava/lang/String;
      59: astore        7
      61: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
      64: invokeinterface #13,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
      69: ifeq          131
      72: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
      75: new           #14                 // class java/lang/StringBuilder
      78: dup
      79: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
      82: ldc           #16                 // String UsernameToken user
      84: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      87: aload         6
      89: invokevirtual #18                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getName:()Ljava/lang/String;
      92: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      95: invokevirtual #19                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      98: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     103: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     106: new           #14                 // class java/lang/StringBuilder
     109: dup
     110: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
     113: ldc           #21                 // String UsernameToken password type
     115: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     118: aload         7
     120: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     123: invokevirtual #19                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     126: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     131: aload         5
     133: ifnull        196
     136: aload         5
     138: aload         7
     140: invokevirtual #22                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     143: ifne          196
     146: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     149: invokeinterface #13,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     154: ifeq          185
     157: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     160: new           #14                 // class java/lang/StringBuilder
     163: dup
     164: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
     167: ldc           #23                 // String Authentication failed as the received password type does not match the required password type of:
     169: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     172: aload         5
     174: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     177: invokevirtual #19                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     180: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     185: new           #3                  // class org/apache/wss4j/common/ext/WSSecurityException
     188: dup
     189: getstatic     #24                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     192: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     195: athrow
     196: aload         6
     198: invokevirtual #26                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getPassword:()Ljava/lang/String;
     201: astore        8
     203: aload         6
     205: invokevirtual #27                 // Method org/apache/wss4j/dom/message/token/UsernameToken.isHashed:()Z
     208: ifeq          221
     211: aload_0
     212: aload         6
     214: aload_2
     215: invokevirtual #28                 // Method verifyDigestPassword:(Lorg/apache/wss4j/dom/message/token/UsernameToken;Lorg/apache/wss4j/dom/handler/RequestData;)V
     218: goto          322
     221: ldc           #29                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText
     223: aload         7
     225: invokevirtual #22                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     228: ifne          254
     231: aload         8
     233: ifnull        264
     236: aload         7
     238: ifnull        254
     241: ldc           #30                 // String
     243: aload         7
     245: invokevirtual #31                 // Method java/lang/String.trim:()Ljava/lang/String;
     248: invokevirtual #22                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     251: ifeq          264
     254: aload_0
     255: aload         6
     257: aload_2
     258: invokevirtual #32                 // Method verifyPlaintextPassword:(Lorg/apache/wss4j/dom/message/token/UsernameToken;Lorg/apache/wss4j/dom/handler/RequestData;)V
     261: goto          322
     264: aload         8
     266: ifnull        315
     269: iload_3
     270: ifne          305
     273: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     276: invokeinterface #13,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     281: ifeq          294
     284: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     287: ldc           #33                 // String Authentication failed as handleCustomUsernameTokenTypes is false
     289: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     294: new           #3                  // class org/apache/wss4j/common/ext/WSSecurityException
     297: dup
     298: getstatic     #24                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     301: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     304: athrow
     305: aload_0
     306: aload         6
     308: aload_2
     309: invokevirtual #34                 // Method verifyCustomPassword:(Lorg/apache/wss4j/dom/message/token/UsernameToken;Lorg/apache/wss4j/dom/handler/RequestData;)V
     312: goto          322
     315: aload_0
     316: aload         6
     318: aload_2
     319: invokevirtual #35                 // Method verifyUnknownPassword:(Lorg/apache/wss4j/dom/message/token/UsernameToken;Lorg/apache/wss4j/dom/handler/RequestData;)V
     322: aload_1
     323: areturn

  protected void verifyCustomPassword(org.apache.wss4j.dom.message.token.UsernameToken, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokevirtual #32                 // Method verifyPlaintextPassword:(Lorg/apache/wss4j/dom/message/token/UsernameToken;Lorg/apache/wss4j/dom/handler/RequestData;)V
       6: return

  protected void verifyPlaintextPassword(org.apache.wss4j.dom.message.token.UsernameToken, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokevirtual #28                 // Method verifyDigestPassword:(Lorg/apache/wss4j/dom/message/token/UsernameToken;Lorg/apache/wss4j/dom/handler/RequestData;)V
       6: return

  protected void verifyDigestPassword(org.apache.wss4j.dom.message.token.UsernameToken, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #36                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
       4: ifnonnull     20
       7: new           #3                  // class org/apache/wss4j/common/ext/WSSecurityException
      10: dup
      11: getstatic     #4                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      14: ldc           #37                 // String noCallback
      16: invokespecial #6                  // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      19: athrow
      20: aload_1
      21: invokevirtual #18                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getName:()Ljava/lang/String;
      24: astore_3
      25: aload_1
      26: invokevirtual #26                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getPassword:()Ljava/lang/String;
      29: astore        4
      31: aload_1
      32: invokevirtual #38                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getNonce:()Ljava/lang/String;
      35: astore        5
      37: aload_1
      38: invokevirtual #39                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getCreated:()Ljava/lang/String;
      41: astore        6
      43: aload_1
      44: invokevirtual #11                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getPasswordType:()Ljava/lang/String;
      47: astore        7
      49: aload_1
      50: invokevirtual #40                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getPasswordsAreEncoded:()Z
      53: istore        8
      55: new           #41                 // class org/apache/wss4j/common/ext/WSPasswordCallback
      58: dup
      59: aload_3
      60: aconst_null
      61: aload         7
      63: iconst_2
      64: invokespecial #42                 // Method org/apache/wss4j/common/ext/WSPasswordCallback."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;I)V
      67: astore        9
      69: aload_2
      70: invokevirtual #36                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      73: iconst_1
      74: anewarray     #43                 // class javax/security/auth/callback/Callback
      77: dup
      78: iconst_0
      79: aload         9
      81: aastore
      82: invokeinterface #44,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      87: goto          131
      90: astore        10
      92: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
      95: invokeinterface #13,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     100: ifeq          118
     103: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     106: aload         10
     108: invokevirtual #47                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     111: aload         10
     113: invokeinterface #48,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
     118: new           #3                  // class org/apache/wss4j/common/ext/WSSecurityException
     121: dup
     122: getstatic     #24                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     125: aload         10
     127: invokespecial #49                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     130: athrow
     131: aload         9
     133: invokevirtual #50                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
     136: astore        10
     138: aload         10
     140: ifnonnull     192
     143: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     146: invokeinterface #13,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     151: ifeq          181
     154: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     157: new           #14                 // class java/lang/StringBuilder
     160: dup
     161: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
     164: ldc           #51                 // String Callback supplied no password for:
     166: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     169: aload_3
     170: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     173: invokevirtual #19                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     176: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     181: new           #3                  // class org/apache/wss4j/common/ext/WSSecurityException
     184: dup
     185: getstatic     #24                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     188: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     191: athrow
     192: aload_1
     193: invokevirtual #27                 // Method org/apache/wss4j/dom/message/token/UsernameToken.isHashed:()Z
     196: ifeq          273
     199: iload         8
     201: ifeq          238
     204: aload         5
     206: aload         6
     208: aload         10
     210: invokestatic  #52                 // Method org/apache/xml/security/utils/Base64.decode:(Ljava/lang/String;)[B
     213: invokestatic  #53                 // Method org/apache/wss4j/dom/message/token/UsernameToken.doPasswordDigest:(Ljava/lang/String;Ljava/lang/String;[B)Ljava/lang/String;
     216: astore        11
     218: goto          249
     221: astore        12
     223: new           #3                  // class org/apache/wss4j/common/ext/WSSecurityException
     226: dup
     227: getstatic     #4                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     230: aload         12
     232: ldc           #55                 // String decoding.general
     234: invokespecial #56                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     237: athrow
     238: aload         5
     240: aload         6
     242: aload         10
     244: invokestatic  #57                 // Method org/apache/wss4j/dom/message/token/UsernameToken.doPasswordDigest:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     247: astore        11
     249: aload         11
     251: aload         4
     253: invokevirtual #22                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     256: ifne          270
     259: new           #3                  // class org/apache/wss4j/common/ext/WSSecurityException
     262: dup
     263: getstatic     #24                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     266: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     269: athrow
     270: goto          294
     273: aload         10
     275: aload         4
     277: invokevirtual #22                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     280: ifne          294
     283: new           #3                  // class org/apache/wss4j/common/ext/WSSecurityException
     286: dup
     287: getstatic     #24                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     290: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     293: athrow
     294: return
    Exception table:
       from    to  target type
          69    87    90   Class java/io/IOException
          69    87    90   Class javax/security/auth/callback/UnsupportedCallbackException
         204   218   221   Class org/apache/xml/security/exceptions/Base64DecodingException

  protected void verifyUnknownPassword(org.apache.wss4j.dom.message.token.UsernameToken, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_2
       1: invokevirtual #58                 // Method org/apache/wss4j/dom/handler/RequestData.isAllowUsernameTokenNoPassword:()Z
       4: istore_3
       5: iload_3
       6: ifne          41
       9: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
      12: invokeinterface #13,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
      17: ifeq          30
      20: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
      23: ldc           #59                 // String Authentication failed as the received UsernameToken does not contain any password element
      25: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      30: new           #3                  // class org/apache/wss4j/common/ext/WSSecurityException
      33: dup
      34: getstatic     #24                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      37: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      40: athrow
      41: return

  static {};
    Code:
       0: ldc_w         #60                 // class org/apache/wss4j/dom/validate/UsernameTokenValidator
       3: invokestatic  #61                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
       9: return
}
