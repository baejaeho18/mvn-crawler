Compiled from "SecurityTokenFactoryImpl.java"
public class org.apache.wss4j.stax.impl.securityToken.SecurityTokenFactoryImpl extends org.apache.xml.security.stax.securityToken.SecurityTokenFactory {
  public org.apache.wss4j.stax.impl.securityToken.SecurityTokenFactoryImpl();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/xml/security/stax/securityToken/SecurityTokenFactory."<init>":()V
       4: return

  public org.apache.xml.security.stax.securityToken.InboundSecurityToken getSecurityToken(org.apache.xml.security.binding.xmldsig.KeyInfoType, org.apache.xml.security.stax.securityToken.SecurityTokenConstants$KeyUsage, org.apache.xml.security.stax.ext.XMLSecurityProperties, org.apache.xml.security.stax.ext.InboundSecurityContext) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aconst_null
       1: astore        5
       3: getstatic     #2                  // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyUsage_Signature_Verification:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyUsage;
       6: aload_2
       7: invokevirtual #3                  // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyUsage.equals:(Ljava/lang/Object;)Z
      10: ifeq          25
      13: aload_3
      14: checkcast     #4                  // class org/apache/wss4j/stax/ext/WSSSecurityProperties
      17: invokevirtual #5                  // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureVerificationCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
      20: astore        5
      22: goto          44
      25: getstatic     #6                  // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyUsage_Decryption:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyUsage;
      28: aload_2
      29: invokevirtual #3                  // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyUsage.equals:(Ljava/lang/Object;)Z
      32: ifeq          44
      35: aload_3
      36: checkcast     #4                  // class org/apache/wss4j/stax/ext/WSSSecurityProperties
      39: invokevirtual #7                  // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getDecryptionCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
      42: astore        5
      44: aload_1
      45: ifnull        129
      48: aload_1
      49: invokevirtual #8                  // Method org/apache/xml/security/binding/xmldsig/KeyInfoType.getContent:()Ljava/util/List;
      52: getstatic     #9                  // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_SecurityTokenReference:Ljavax/xml/namespace/QName;
      55: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      58: checkcast     #11                 // class org/apache/wss4j/binding/wss10/SecurityTokenReferenceType
      61: astore        6
      63: aload         6
      65: ifnull        89
      68: aload         6
      70: aload         5
      72: aload_3
      73: checkcast     #4                  // class org/apache/wss4j/stax/ext/WSSSecurityProperties
      76: invokevirtual #12                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      79: aload         4
      81: aload_3
      82: checkcast     #4                  // class org/apache/wss4j/stax/ext/WSSSecurityProperties
      85: invokestatic  #13                 // Method getSecurityToken:(Lorg/apache/wss4j/binding/wss10/SecurityTokenReferenceType;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/xml/security/stax/ext/InboundSecurityContext;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
      88: areturn
      89: aload_1
      90: invokevirtual #8                  // Method org/apache/xml/security/binding/xmldsig/KeyInfoType.getContent:()Ljava/util/List;
      93: getstatic     #14                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_KeyValue:Ljavax/xml/namespace/QName;
      96: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      99: checkcast     #15                 // class org/apache/xml/security/binding/xmldsig/KeyValueType
     102: astore        7
     104: aload         7
     106: ifnull        126
     109: aload         7
     111: aload         5
     113: aload_3
     114: checkcast     #4                  // class org/apache/wss4j/stax/ext/WSSSecurityProperties
     117: invokevirtual #12                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     120: aload         4
     122: invokestatic  #16                 // Method getSecurityToken:(Lorg/apache/xml/security/binding/xmldsig/KeyValueType;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/xml/security/stax/ext/SecurityContext;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
     125: areturn
     126: goto          187
     129: aload         5
     131: ifnull        187
     134: aload         5
     136: invokeinterface #17,  1           // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getDefaultX509Identifier:()Ljava/lang/String;
     141: ifnull        187
     144: new           #18                 // class org/apache/wss4j/stax/impl/securityToken/X509DefaultSecurityTokenImpl
     147: dup
     148: aload         4
     150: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     153: aload         5
     155: aload_3
     156: checkcast     #4                  // class org/apache/wss4j/stax/ext/WSSSecurityProperties
     159: invokevirtual #12                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     162: aload         5
     164: invokeinterface #17,  1           // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getDefaultX509Identifier:()Ljava/lang/String;
     169: aload         5
     171: invokeinterface #17,  1           // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getDefaultX509Identifier:()Ljava/lang/String;
     176: getstatic     #20                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_NoKeyInfo:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     179: aload_3
     180: checkcast     #4                  // class org/apache/wss4j/stax/ext/WSSSecurityProperties
     183: invokespecial #21                 // Method org/apache/wss4j/stax/impl/securityToken/X509DefaultSecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)V
     186: areturn
     187: new           #22                 // class org/apache/wss4j/common/ext/WSSecurityException
     190: dup
     191: getstatic     #23                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     194: ldc           #24                 // String noKeyinfo
     196: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     199: athrow

  public static org.apache.xml.security.stax.securityToken.InboundSecurityToken getSecurityToken(org.apache.wss4j.binding.wss10.SecurityTokenReferenceType, org.apache.wss4j.common.crypto.Crypto, javax.security.auth.callback.CallbackHandler, org.apache.xml.security.stax.ext.InboundSecurityContext, org.apache.wss4j.stax.ext.WSSSecurityProperties) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: ifnonnull     17
       4: new           #22                 // class org/apache/wss4j/common/ext/WSSecurityException
       7: dup
       8: getstatic     #23                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      11: ldc           #26                 // String noSecTokRef
      13: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      16: athrow
      17: aload_0
      18: invokevirtual #27                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getAny:()Ljava/util/List;
      21: invokeinterface #28,  1           // InterfaceMethod java/util/List.size:()I
      26: iconst_1
      27: if_icmple     42
      30: aload_3
      31: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
      34: getstatic     #29                 // Field org/apache/wss4j/common/bsp/BSPRule.R3061:Lorg/apache/wss4j/common/bsp/BSPRule;
      37: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
      42: aload_0
      43: invokevirtual #31                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getId:()Ljava/lang/String;
      46: ifnonnull     57
      49: aload_0
      50: aconst_null
      51: invokestatic  #32                 // Method org/apache/xml/security/stax/impl/util/IDGenerator.generateID:(Ljava/lang/String;)Ljava/lang/String;
      54: invokevirtual #33                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.setId:(Ljava/lang/String;)V
      57: aload_0
      58: invokevirtual #27                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getAny:()Ljava/util/List;
      61: getstatic     #34                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_X509Data:Ljavax/xml/namespace/QName;
      64: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      67: checkcast     #35                 // class org/apache/xml/security/binding/xmldsig/X509DataType
      70: astore        5
      72: aload         5
      74: ifnull        475
      77: aload         5
      79: invokevirtual #36                 // Method org/apache/xml/security/binding/xmldsig/X509DataType.getX509IssuerSerialOrX509SKIOrX509SubjectName:()Ljava/util/List;
      82: getstatic     #37                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_X509IssuerSerial:Ljavax/xml/namespace/QName;
      85: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      88: checkcast     #38                 // class org/apache/xml/security/binding/xmldsig/X509IssuerSerialType
      91: astore        6
      93: aload         6
      95: ifnull        319
      98: aload_3
      99: invokeinterface #39,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.getRegisteredSecurityTokenProviders:()Ljava/util/List;
     104: astore        7
     106: iconst_0
     107: istore        8
     109: iload         8
     111: aload         7
     113: invokeinterface #28,  1           // InterfaceMethod java/util/List.size:()I
     118: if_icmpge     262
     121: aload         7
     123: iload         8
     125: invokeinterface #40,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     130: checkcast     #41                 // class org/apache/xml/security/stax/securityToken/SecurityTokenProvider
     133: astore        9
     135: aload         9
     137: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
     142: checkcast     #43                 // class org/apache/xml/security/stax/securityToken/InboundSecurityToken
     145: astore        10
     147: aload         10
     149: instanceof    #44                 // class org/apache/wss4j/stax/securityToken/X509SecurityToken
     152: ifeq          256
     155: aload         10
     157: checkcast     #44                 // class org/apache/wss4j/stax/securityToken/X509SecurityToken
     160: astore        11
     162: aload         11
     164: invokeinterface #45,  1           // InterfaceMethod org/apache/wss4j/stax/securityToken/X509SecurityToken.getX509Certificates:()[Ljava/security/cert/X509Certificate;
     169: iconst_0
     170: aaload
     171: astore        12
     173: aload         12
     175: invokevirtual #46                 // Method java/security/cert/X509Certificate.getSerialNumber:()Ljava/math/BigInteger;
     178: aload         6
     180: invokevirtual #47                 // Method org/apache/xml/security/binding/xmldsig/X509IssuerSerialType.getX509SerialNumber:()Ljava/math/BigInteger;
     183: invokevirtual #48                 // Method java/math/BigInteger.compareTo:(Ljava/math/BigInteger;)I
     186: ifne          256
     189: aload         12
     191: invokevirtual #49                 // Method java/security/cert/X509Certificate.getIssuerX500Principal:()Ljavax/security/auth/x500/X500Principal;
     194: new           #50                 // class javax/security/auth/x500/X500Principal
     197: dup
     198: aload         6
     200: invokevirtual #51                 // Method org/apache/xml/security/binding/xmldsig/X509IssuerSerialType.getX509IssuerName:()Ljava/lang/String;
     203: invokespecial #52                 // Method javax/security/auth/x500/X500Principal."<init>":(Ljava/lang/String;)V
     206: invokevirtual #53                 // Method javax/security/auth/x500/X500Principal.equals:(Ljava/lang/Object;)Z
     209: ifeq          256
     212: aload         10
     214: getstatic     #54                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_IssuerSerial:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     217: invokestatic  #55                 // Method createSecurityTokenProxy:(Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
     220: astore        13
     222: aload_3
     223: new           #56                 // class java/lang/StringBuilder
     226: dup
     227: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
     230: ldc           #58                 // String
     232: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     235: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     238: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
     241: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     244: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     247: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
     252: pop
     253: aload         13
     255: areturn
     256: iinc          8, 1
     259: goto          109
     262: new           #65                 // class org/apache/wss4j/stax/impl/securityToken/X509IssuerSerialTokenImpl
     265: dup
     266: aload_3
     267: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     270: aload_1
     271: aload_2
     272: aload         6
     274: aload_0
     275: invokevirtual #31                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getId:()Ljava/lang/String;
     278: aload         4
     280: invokespecial #66                 // Method org/apache/wss4j/stax/impl/securityToken/X509IssuerSerialTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/xml/security/binding/xmldsig/X509IssuerSerialType;Ljava/lang/String;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)V
     283: astore        8
     285: aload_3
     286: new           #56                 // class java/lang/StringBuilder
     289: dup
     290: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
     293: ldc           #58                 // String
     295: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     298: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     301: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
     304: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     307: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     310: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
     315: pop
     316: aload         8
     318: areturn
     319: aload         5
     321: invokevirtual #36                 // Method org/apache/xml/security/binding/xmldsig/X509DataType.getX509IssuerSerialOrX509SKIOrX509SubjectName:()Ljava/util/List;
     324: getstatic     #67                 // Field org/apache/xml/security/stax/ext/XMLSecurityConstants.TAG_dsig_X509SKI:Ljavax/xml/namespace/QName;
     327: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
     330: checkcast     #68                 // class "[B"
     333: astore        7
     335: aload         7
     337: ifnull        397
     340: new           #69                 // class org/apache/wss4j/stax/impl/securityToken/X509SKISecurityTokenImpl
     343: dup
     344: aload_3
     345: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     348: aload_1
     349: aload_2
     350: aload         7
     352: aload_0
     353: invokevirtual #31                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getId:()Ljava/lang/String;
     356: aload         4
     358: invokespecial #70                 // Method org/apache/wss4j/stax/impl/securityToken/X509SKISecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;[BLjava/lang/String;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)V
     361: astore        8
     363: aload_3
     364: new           #56                 // class java/lang/StringBuilder
     367: dup
     368: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
     371: ldc           #58                 // String
     373: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     376: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     379: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
     382: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     385: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     388: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
     393: pop
     394: aload         8
     396: areturn
     397: aload         5
     399: invokevirtual #36                 // Method org/apache/xml/security/binding/xmldsig/X509DataType.getX509IssuerSerialOrX509SKIOrX509SubjectName:()Ljava/util/List;
     402: getstatic     #71                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_X509Certificate:Ljavax/xml/namespace/QName;
     405: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
     408: checkcast     #68                 // class "[B"
     411: astore        8
     413: aload         8
     415: ifnull        475
     418: new           #72                 // class org/apache/wss4j/stax/impl/securityToken/X509V3SecurityTokenImpl
     421: dup
     422: aload_3
     423: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     426: aload_1
     427: aload_2
     428: aload         8
     430: aload_0
     431: invokevirtual #31                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getId:()Ljava/lang/String;
     434: aload         4
     436: invokespecial #73                 // Method org/apache/wss4j/stax/impl/securityToken/X509V3SecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;[BLjava/lang/String;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)V
     439: astore        9
     441: aload_3
     442: new           #56                 // class java/lang/StringBuilder
     445: dup
     446: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
     449: ldc           #58                 // String
     451: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     454: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     457: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
     460: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     463: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     466: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
     471: pop
     472: aload         9
     474: areturn
     475: aload_0
     476: invokevirtual #74                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getOtherAttributes:()Ljava/util/Map;
     479: getstatic     #75                 // Field org/apache/wss4j/stax/ext/WSSConstants.ATT_wsse11_TokenType:Ljavax/xml/namespace/QName;
     482: invokestatic  #76                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameAttribute:(Ljava/util/Map;Ljavax/xml/namespace/QName;)Ljava/lang/String;
     485: astore        6
     487: aload_0
     488: invokevirtual #27                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getAny:()Ljava/util/List;
     491: getstatic     #77                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_KeyIdentifier:Ljavax/xml/namespace/QName;
     494: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
     497: checkcast     #78                 // class org/apache/wss4j/binding/wss10/KeyIdentifierType
     500: astore        7
     502: aload         7
     504: ifnull        1631
     507: aload         7
     509: invokevirtual #79                 // Method org/apache/wss4j/binding/wss10/KeyIdentifierType.getValueType:()Ljava/lang/String;
     512: astore        8
     514: aload         8
     516: ifnonnull     531
     519: aload_3
     520: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     523: getstatic     #80                 // Field org/apache/wss4j/common/bsp/BSPRule.R3054:Lorg/apache/wss4j/common/bsp/BSPRule;
     526: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     531: aload         7
     533: invokevirtual #81                 // Method org/apache/wss4j/binding/wss10/KeyIdentifierType.getEncodingType:()Ljava/lang/String;
     536: astore        9
     538: aconst_null
     539: astore        10
     541: ldc           #82                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary
     543: aload         9
     545: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     548: ifeq          564
     551: aload         7
     553: invokevirtual #84                 // Method org/apache/wss4j/binding/wss10/KeyIdentifierType.getValue:()Ljava/lang/String;
     556: invokestatic  #85                 // Method org/apache/commons/codec/binary/Base64.decodeBase64:(Ljava/lang/String;)[B
     559: astore        10
     561: goto          656
     564: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     566: aload         8
     568: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     571: ifne          619
     574: ldc           #87                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     576: aload         8
     578: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     581: ifne          619
     584: aload         9
     586: ifnonnull     604
     589: aload_3
     590: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     593: getstatic     #88                 // Field org/apache/wss4j/common/bsp/BSPRule.R3070:Lorg/apache/wss4j/common/bsp/BSPRule;
     596: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     601: goto          656
     604: aload_3
     605: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     608: getstatic     #89                 // Field org/apache/wss4j/common/bsp/BSPRule.R3071:Lorg/apache/wss4j/common/bsp/BSPRule;
     611: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     616: goto          656
     619: aload         9
     621: ifnull        656
     624: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     626: aload         8
     628: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     631: ifne          644
     634: ldc           #87                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     636: aload         8
     638: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     641: ifeq          656
     644: aload_3
     645: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     648: getstatic     #90                 // Field org/apache/wss4j/common/bsp/BSPRule.R6604:Lorg/apache/wss4j/common/bsp/BSPRule;
     651: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
     656: ldc           #91                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3
     658: aload         8
     660: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     663: ifeq          723
     666: new           #72                 // class org/apache/wss4j/stax/impl/securityToken/X509V3SecurityTokenImpl
     669: dup
     670: aload_3
     671: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     674: aload_1
     675: aload_2
     676: aload         10
     678: aload_0
     679: invokevirtual #31                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getId:()Ljava/lang/String;
     682: aload         4
     684: invokespecial #73                 // Method org/apache/wss4j/stax/impl/securityToken/X509V3SecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;[BLjava/lang/String;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)V
     687: astore        11
     689: aload_3
     690: new           #56                 // class java/lang/StringBuilder
     693: dup
     694: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
     697: ldc           #58                 // String
     699: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     702: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     705: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
     708: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     711: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     714: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
     719: pop
     720: aload         11
     722: areturn
     723: ldc           #92                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier
     725: aload         8
     727: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     730: ifeq          790
     733: new           #69                 // class org/apache/wss4j/stax/impl/securityToken/X509SKISecurityTokenImpl
     736: dup
     737: aload_3
     738: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     741: aload_1
     742: aload_2
     743: aload         10
     745: aload_0
     746: invokevirtual #31                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getId:()Ljava/lang/String;
     749: aload         4
     751: invokespecial #70                 // Method org/apache/wss4j/stax/impl/securityToken/X509SKISecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;[BLjava/lang/String;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)V
     754: astore        11
     756: aload_3
     757: new           #56                 // class java/lang/StringBuilder
     760: dup
     761: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
     764: ldc           #58                 // String
     766: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     769: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     772: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
     775: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     778: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     781: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
     786: pop
     787: aload         11
     789: areturn
     790: ldc           #93                 // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#ThumbprintSHA1
     792: aload         8
     794: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     797: ifeq          1038
     800: ldc           #94                 // String SHA-1
     802: invokestatic  #95                 // Method java/security/MessageDigest.getInstance:(Ljava/lang/String;)Ljava/security/MessageDigest;
     805: astore        11
     807: aload_3
     808: invokeinterface #39,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.getRegisteredSecurityTokenProviders:()Ljava/util/List;
     813: astore        12
     815: iconst_0
     816: istore        13
     818: iload         13
     820: aload         12
     822: invokeinterface #28,  1           // InterfaceMethod java/util/List.size:()I
     827: if_icmpge     950
     830: aload         12
     832: iload         13
     834: invokeinterface #40,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     839: checkcast     #41                 // class org/apache/xml/security/stax/securityToken/SecurityTokenProvider
     842: astore        14
     844: aload         14
     846: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
     851: checkcast     #43                 // class org/apache/xml/security/stax/securityToken/InboundSecurityToken
     854: astore        15
     856: aload         15
     858: instanceof    #44                 // class org/apache/wss4j/stax/securityToken/X509SecurityToken
     861: ifeq          944
     864: aload         15
     866: checkcast     #44                 // class org/apache/wss4j/stax/securityToken/X509SecurityToken
     869: astore        16
     871: aload         11
     873: aload         16
     875: invokeinterface #45,  1           // InterfaceMethod org/apache/wss4j/stax/securityToken/X509SecurityToken.getX509Certificates:()[Ljava/security/cert/X509Certificate;
     880: iconst_0
     881: aaload
     882: invokevirtual #96                 // Method java/security/cert/X509Certificate.getEncoded:()[B
     885: invokevirtual #97                 // Method java/security/MessageDigest.digest:([B)[B
     888: astore        17
     890: aload         17
     892: aload         10
     894: invokestatic  #98                 // Method java/util/Arrays.equals:([B[B)Z
     897: ifeq          944
     900: aload         15
     902: getstatic     #99                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_ThumbprintIdentifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     905: invokestatic  #55                 // Method createSecurityTokenProxy:(Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
     908: astore        18
     910: aload_3
     911: new           #56                 // class java/lang/StringBuilder
     914: dup
     915: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
     918: ldc           #58                 // String
     920: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     923: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     926: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
     929: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     932: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     935: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
     940: pop
     941: aload         18
     943: areturn
     944: iinc          13, 1
     947: goto          818
     950: goto          981
     953: astore        11
     955: new           #22                 // class org/apache/wss4j/common/ext/WSSecurityException
     958: dup
     959: getstatic     #101                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     962: aload         11
     964: invokespecial #102                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     967: athrow
     968: astore        11
     970: new           #22                 // class org/apache/wss4j/common/ext/WSSecurityException
     973: dup
     974: getstatic     #104                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     977: invokespecial #105                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     980: athrow
     981: new           #106                // class org/apache/wss4j/stax/impl/securityToken/X509ThumbprintSHA1SecurityTokenImpl
     984: dup
     985: aload_3
     986: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     989: aload_1
     990: aload_2
     991: aload         10
     993: aload_0
     994: invokevirtual #31                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getId:()Ljava/lang/String;
     997: aload         4
     999: invokespecial #107                // Method org/apache/wss4j/stax/impl/securityToken/X509ThumbprintSHA1SecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;[BLjava/lang/String;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)V
    1002: astore        11
    1004: aload_3
    1005: new           #56                 // class java/lang/StringBuilder
    1008: dup
    1009: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1012: ldc           #58                 // String
    1014: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1017: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1020: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1023: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1026: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1029: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    1034: pop
    1035: aload         11
    1037: areturn
    1038: ldc           #108                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKeySHA1
    1040: aload         8
    1042: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1045: ifeq          1105
    1048: new           #109                // class org/apache/wss4j/stax/impl/securityToken/EncryptedKeySha1SecurityTokenImpl
    1051: dup
    1052: aload_3
    1053: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1056: aload_2
    1057: aload         7
    1059: invokevirtual #84                 // Method org/apache/wss4j/binding/wss10/KeyIdentifierType.getValue:()Ljava/lang/String;
    1062: aload_0
    1063: invokevirtual #31                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getId:()Ljava/lang/String;
    1066: invokespecial #110                // Method org/apache/wss4j/stax/impl/securityToken/EncryptedKeySha1SecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;Ljava/lang/String;)V
    1069: astore        11
    1071: aload_3
    1072: new           #56                 // class java/lang/StringBuilder
    1075: dup
    1076: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1079: ldc           #58                 // String
    1081: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1084: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1087: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1090: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1093: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1096: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    1101: pop
    1102: aload         11
    1104: areturn
    1105: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
    1107: aload         8
    1109: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1112: ifne          1125
    1115: ldc           #87                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
    1117: aload         8
    1119: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1122: ifeq          1319
    1125: ldc           #87                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
    1127: aload         8
    1129: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1132: ifeq          1160
    1135: ldc           #111                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    1137: aload         6
    1139: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1142: ifne          1160
    1145: aload_3
    1146: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1149: getstatic     #112                // Field org/apache/wss4j/common/bsp/BSPRule.R6617:Lorg/apache/wss4j/common/bsp/BSPRule;
    1152: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    1157: goto          1192
    1160: ldc           #86                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
    1162: aload         8
    1164: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1167: ifeq          1192
    1170: ldc           #113                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
    1172: aload         6
    1174: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1177: ifne          1192
    1180: aload_3
    1181: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1184: getstatic     #114                // Field org/apache/wss4j/common/bsp/BSPRule.R6611:Lorg/apache/wss4j/common/bsp/BSPRule;
    1187: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    1192: aload_3
    1193: aload         7
    1195: invokevirtual #84                 // Method org/apache/wss4j/binding/wss10/KeyIdentifierType.getValue:()Ljava/lang/String;
    1198: invokeinterface #115,  2          // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.getSecurityTokenProvider:(Ljava/lang/String;)Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;
    1203: astore        11
    1205: aload         11
    1207: ifnull        1262
    1210: aload         11
    1212: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
    1217: checkcast     #43                 // class org/apache/xml/security/stax/securityToken/InboundSecurityToken
    1220: getstatic     #116                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
    1223: invokestatic  #55                 // Method createSecurityTokenProxy:(Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
    1226: astore        12
    1228: aload_3
    1229: new           #56                 // class java/lang/StringBuilder
    1232: dup
    1233: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1236: ldc           #58                 // String
    1238: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1241: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1244: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1247: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1250: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1253: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    1258: pop
    1259: aload         12
    1261: areturn
    1262: new           #117                // class org/apache/wss4j/stax/impl/securityToken/SamlSecurityTokenImpl
    1265: dup
    1266: aload_3
    1267: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1270: aload         7
    1272: invokevirtual #84                 // Method org/apache/wss4j/binding/wss10/KeyIdentifierType.getValue:()Ljava/lang/String;
    1275: getstatic     #118                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_ExternalReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
    1278: aload         4
    1280: invokespecial #119                // Method org/apache/wss4j/stax/impl/securityToken/SamlSecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)V
    1283: astore        12
    1285: aload_3
    1286: new           #56                 // class java/lang/StringBuilder
    1289: dup
    1290: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1293: ldc           #58                 // String
    1295: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1298: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1301: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1304: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1307: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1310: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    1315: pop
    1316: aload         12
    1318: areturn
    1319: ldc           #120                // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#Kerberosv5APREQSHA1
    1321: aload         8
    1323: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    1326: ifeq          1619
    1329: aload_3
    1330: aload         7
    1332: invokevirtual #84                 // Method org/apache/wss4j/binding/wss10/KeyIdentifierType.getValue:()Ljava/lang/String;
    1335: invokeinterface #115,  2          // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.getSecurityTokenProvider:(Ljava/lang/String;)Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;
    1340: astore        11
    1342: aload         11
    1344: ifnull        1399
    1347: aload         11
    1349: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
    1354: checkcast     #43                 // class org/apache/xml/security/stax/securityToken/InboundSecurityToken
    1357: getstatic     #116                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
    1360: invokestatic  #55                 // Method createSecurityTokenProxy:(Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
    1363: astore        12
    1365: aload_3
    1366: new           #56                 // class java/lang/StringBuilder
    1369: dup
    1370: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1373: ldc           #58                 // String
    1375: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1378: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1381: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1384: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1387: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1390: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    1395: pop
    1396: aload         12
    1398: areturn
    1399: ldc           #94                 // String SHA-1
    1401: invokestatic  #95                 // Method java/security/MessageDigest.getInstance:(Ljava/lang/String;)Ljava/security/MessageDigest;
    1404: astore        12
    1406: aload_3
    1407: invokeinterface #39,  1           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.getRegisteredSecurityTokenProviders:()Ljava/util/List;
    1412: astore        13
    1414: iconst_0
    1415: istore        14
    1417: iload         14
    1419: aload         13
    1421: invokeinterface #28,  1           // InterfaceMethod java/util/List.size:()I
    1426: if_icmpge     1544
    1429: aload         13
    1431: iload         14
    1433: invokeinterface #40,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
    1438: checkcast     #41                 // class org/apache/xml/security/stax/securityToken/SecurityTokenProvider
    1441: astore        15
    1443: aload         15
    1445: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
    1450: checkcast     #43                 // class org/apache/xml/security/stax/securityToken/InboundSecurityToken
    1453: astore        16
    1455: aload         16
    1457: instanceof    #121                // class org/apache/wss4j/stax/securityToken/KerberosServiceSecurityToken
    1460: ifeq          1538
    1463: aload         16
    1465: checkcast     #121                // class org/apache/wss4j/stax/securityToken/KerberosServiceSecurityToken
    1468: astore        17
    1470: aload         12
    1472: aload         17
    1474: invokeinterface #122,  1          // InterfaceMethod org/apache/wss4j/stax/securityToken/KerberosServiceSecurityToken.getBinaryContent:()[B
    1479: invokevirtual #97                 // Method java/security/MessageDigest.digest:([B)[B
    1482: astore        18
    1484: aload         18
    1486: aload         10
    1488: invokestatic  #98                 // Method java/util/Arrays.equals:([B[B)Z
    1491: ifeq          1538
    1494: aload         16
    1496: getstatic     #99                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_ThumbprintIdentifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
    1499: invokestatic  #55                 // Method createSecurityTokenProxy:(Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
    1502: astore        19
    1504: aload_3
    1505: new           #56                 // class java/lang/StringBuilder
    1508: dup
    1509: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1512: ldc           #58                 // String
    1514: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1517: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1520: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1523: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1526: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1529: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    1534: pop
    1535: aload         19
    1537: areturn
    1538: iinc          14, 1
    1541: goto          1417
    1544: goto          1562
    1547: astore        12
    1549: new           #22                 // class org/apache/wss4j/common/ext/WSSecurityException
    1552: dup
    1553: getstatic     #101                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
    1556: aload         12
    1558: invokespecial #102                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
    1561: athrow
    1562: new           #109                // class org/apache/wss4j/stax/impl/securityToken/EncryptedKeySha1SecurityTokenImpl
    1565: dup
    1566: aload_3
    1567: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1570: aload_2
    1571: aload         7
    1573: invokevirtual #84                 // Method org/apache/wss4j/binding/wss10/KeyIdentifierType.getValue:()Ljava/lang/String;
    1576: aload_0
    1577: invokevirtual #31                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getId:()Ljava/lang/String;
    1580: invokespecial #110                // Method org/apache/wss4j/stax/impl/securityToken/EncryptedKeySha1SecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;Ljava/lang/String;)V
    1583: astore        12
    1585: aload_3
    1586: new           #56                 // class java/lang/StringBuilder
    1589: dup
    1590: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1593: ldc           #58                 // String
    1595: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1598: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1601: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1604: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1607: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1610: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    1615: pop
    1616: aload         12
    1618: areturn
    1619: aload_3
    1620: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1623: getstatic     #123                // Field org/apache/wss4j/common/bsp/BSPRule.R3063:Lorg/apache/wss4j/common/bsp/BSPRule;
    1626: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    1631: aload_0
    1632: invokevirtual #27                 // Method org/apache/wss4j/binding/wss10/SecurityTokenReferenceType.getAny:()Ljava/util/List;
    1635: getstatic     #124                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_Reference:Ljavax/xml/namespace/QName;
    1638: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
    1641: checkcast     #125                // class org/apache/wss4j/binding/wss10/ReferenceType
    1644: astore        8
    1646: aload         8
    1648: ifnull        2342
    1651: aload         8
    1653: invokevirtual #126                // Method org/apache/wss4j/binding/wss10/ReferenceType.getURI:()Ljava/lang/String;
    1656: astore        9
    1658: aload         9
    1660: ifnonnull     1688
    1663: aload_3
    1664: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1667: getstatic     #127                // Field org/apache/wss4j/common/bsp/BSPRule.R3062:Lorg/apache/wss4j/common/bsp/BSPRule;
    1670: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    1675: new           #22                 // class org/apache/wss4j/common/ext/WSSecurityException
    1678: dup
    1679: getstatic     #23                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
    1682: ldc           #128                // String badReferenceURI
    1684: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
    1687: athrow
    1688: iconst_1
    1689: istore        10
    1691: aload         9
    1693: ldc           #129                // String #
    1695: invokevirtual #130                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
    1698: ifne          1773
    1701: iconst_0
    1702: istore        10
    1704: new           #131                // class org/apache/wss4j/stax/impl/securityToken/ExternalSecurityTokenImpl
    1707: dup
    1708: aload_3
    1709: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1712: aload         9
    1714: getstatic     #118                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_ExternalReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
    1717: aload         4
    1719: iconst_0
    1720: invokespecial #132                // Method org/apache/wss4j/stax/impl/securityToken/ExternalSecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;Z)V
    1723: astore        11
    1725: aload_3
    1726: new           #56                 // class java/lang/StringBuilder
    1729: dup
    1730: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1733: ldc           #58                 // String
    1735: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1738: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1741: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1744: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1747: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1750: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    1755: pop
    1756: aload         11
    1758: areturn
    1759: astore        11
    1761: aload_3
    1762: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1765: getstatic     #133                // Field org/apache/wss4j/common/bsp/BSPRule.R5204:Lorg/apache/wss4j/common/bsp/BSPRule;
    1768: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    1773: aload         9
    1775: invokestatic  #134                // Method org/apache/wss4j/stax/utils/WSSUtils.dropReferenceMarker:(Ljava/lang/String;)Ljava/lang/String;
    1778: astore        9
    1780: aload_3
    1781: new           #56                 // class java/lang/StringBuilder
    1784: dup
    1785: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1788: ldc           #58                 // String
    1790: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1793: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1796: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1799: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1802: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1805: invokeinterface #135,  2          // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.get:(Ljava/lang/String;)Ljava/lang/Object;
    1810: checkcast     #136                // class java/lang/Integer
    1813: astore        11
    1815: aload         11
    1817: ifnonnull     1826
    1820: iconst_0
    1821: invokestatic  #137                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
    1824: astore        11
    1826: aload         11
    1828: astore        12
    1830: aload         11
    1832: invokevirtual #138                // Method java/lang/Integer.intValue:()I
    1835: iconst_1
    1836: iadd
    1837: invokestatic  #137                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
    1840: dup
    1841: astore        11
    1843: astore        13
    1845: aload         12
    1847: pop
    1848: aload         11
    1850: invokevirtual #138                // Method java/lang/Integer.intValue:()I
    1853: bipush        10
    1855: if_icmpne     1869
    1858: new           #22                 // class org/apache/wss4j/common/ext/WSSecurityException
    1861: dup
    1862: getstatic     #104                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
    1865: invokespecial #105                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
    1868: athrow
    1869: aload_3
    1870: new           #56                 // class java/lang/StringBuilder
    1873: dup
    1874: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1877: ldc           #58                 // String
    1879: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1882: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1885: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1888: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1891: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1894: aload         11
    1896: invokeinterface #139,  3          // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
    1901: aload_3
    1902: aload         9
    1904: invokeinterface #115,  2          // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.getSecurityTokenProvider:(Ljava/lang/String;)Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;
    1909: astore        12
    1911: aload         12
    1913: ifnonnull     1972
    1916: new           #131                // class org/apache/wss4j/stax/impl/securityToken/ExternalSecurityTokenImpl
    1919: dup
    1920: aload_3
    1921: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1924: aload         9
    1926: getstatic     #118                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_ExternalReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
    1929: aload         4
    1931: iload         10
    1933: invokespecial #132                // Method org/apache/wss4j/stax/impl/securityToken/ExternalSecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;Z)V
    1936: astore        13
    1938: aload_3
    1939: new           #56                 // class java/lang/StringBuilder
    1942: dup
    1943: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    1946: ldc           #58                 // String
    1948: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1951: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    1954: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    1957: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    1960: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1963: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    1968: pop
    1969: aload         13
    1971: areturn
    1972: aload         12
    1974: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
    1979: instanceof    #140                // class org/apache/wss4j/stax/securityToken/SecurityTokenReference
    1982: ifeq          2000
    1985: aload_3
    1986: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    1989: getstatic     #141                // Field org/apache/wss4j/common/bsp/BSPRule.R3057:Lorg/apache/wss4j/common/bsp/BSPRule;
    1992: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    1997: goto          2290
    2000: aload         12
    2002: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
    2007: instanceof    #142                // class org/apache/wss4j/stax/impl/securityToken/X509PKIPathv1SecurityTokenImpl
    2010: ifeq          2067
    2013: aload         8
    2015: invokevirtual #143                // Method org/apache/wss4j/binding/wss10/ReferenceType.getValueType:()Ljava/lang/String;
    2018: astore        13
    2020: ldc           #144                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1
    2022: aload         13
    2024: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    2027: ifne          2042
    2030: aload_3
    2031: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    2034: getstatic     #145                // Field org/apache/wss4j/common/bsp/BSPRule.R3058:Lorg/apache/wss4j/common/bsp/BSPRule;
    2037: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    2042: ldc           #144                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1
    2044: aload         6
    2046: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    2049: ifne          2064
    2052: aload_3
    2053: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    2056: getstatic     #146                // Field org/apache/wss4j/common/bsp/BSPRule.R5215:Lorg/apache/wss4j/common/bsp/BSPRule;
    2059: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    2064: goto          2290
    2067: aload         12
    2069: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
    2074: instanceof    #44                 // class org/apache/wss4j/stax/securityToken/X509SecurityToken
    2077: ifeq          2112
    2080: aload         8
    2082: invokevirtual #143                // Method org/apache/wss4j/binding/wss10/ReferenceType.getValueType:()Ljava/lang/String;
    2085: astore        13
    2087: ldc           #91                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3
    2089: aload         13
    2091: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    2094: ifne          2109
    2097: aload_3
    2098: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    2101: getstatic     #145                // Field org/apache/wss4j/common/bsp/BSPRule.R3058:Lorg/apache/wss4j/common/bsp/BSPRule;
    2104: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    2109: goto          2290
    2112: aload         12
    2114: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
    2119: instanceof    #147                // class org/apache/wss4j/stax/securityToken/UsernameSecurityToken
    2122: ifeq          2157
    2125: aload         8
    2127: invokevirtual #143                // Method org/apache/wss4j/binding/wss10/ReferenceType.getValueType:()Ljava/lang/String;
    2130: astore        13
    2132: ldc           #148                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
    2134: aload         13
    2136: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    2139: ifne          2154
    2142: aload_3
    2143: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    2146: getstatic     #149                // Field org/apache/wss4j/common/bsp/BSPRule.R4214:Lorg/apache/wss4j/common/bsp/BSPRule;
    2149: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    2154: goto          2290
    2157: aload         12
    2159: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
    2164: instanceof    #150                // class org/apache/wss4j/stax/securityToken/SamlSecurityToken
    2167: ifeq          2290
    2170: aload         12
    2172: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
    2177: checkcast     #43                 // class org/apache/xml/security/stax/securityToken/InboundSecurityToken
    2180: invokeinterface #151,  1          // InterfaceMethod org/apache/xml/security/stax/securityToken/InboundSecurityToken.getTokenType:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
    2185: astore        13
    2187: getstatic     #152                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.Saml20Token:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
    2190: aload         13
    2192: invokevirtual #153                // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
    2195: ifeq          2257
    2198: aload         8
    2200: invokevirtual #143                // Method org/apache/wss4j/binding/wss10/ReferenceType.getValueType:()Ljava/lang/String;
    2203: astore        14
    2205: aload         14
    2207: ifnull        2232
    2210: ldc           #58                 // String
    2212: aload         14
    2214: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    2217: ifne          2232
    2220: aload_3
    2221: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    2224: getstatic     #154                // Field org/apache/wss4j/common/bsp/BSPRule.R6614:Lorg/apache/wss4j/common/bsp/BSPRule;
    2227: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    2232: ldc           #111                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    2234: aload         6
    2236: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    2239: ifne          2254
    2242: aload_3
    2243: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    2246: getstatic     #112                // Field org/apache/wss4j/common/bsp/BSPRule.R6617:Lorg/apache/wss4j/common/bsp/BSPRule;
    2249: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    2254: goto          2290
    2257: getstatic     #155                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.Saml10Token:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
    2260: aload         13
    2262: invokevirtual #153                // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType.equals:(Ljava/lang/Object;)Z
    2265: ifeq          2290
    2268: ldc           #113                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
    2270: aload         6
    2272: invokevirtual #83                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
    2275: ifne          2290
    2278: aload_3
    2279: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
    2282: getstatic     #114                // Field org/apache/wss4j/common/bsp/BSPRule.R6611:Lorg/apache/wss4j/common/bsp/BSPRule;
    2285: invokeinterface #30,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.handleBSPRule:(Lorg/apache/wss4j/common/bsp/BSPRule;)V
    2290: aload         12
    2292: invokeinterface #42,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getSecurityToken:()Ljava/lang/Object;
    2297: checkcast     #43                 // class org/apache/xml/security/stax/securityToken/InboundSecurityToken
    2300: getstatic     #116                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
    2303: invokestatic  #55                 // Method createSecurityTokenProxy:(Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
    2306: astore        13
    2308: aload_3
    2309: new           #56                 // class java/lang/StringBuilder
    2312: dup
    2313: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    2316: ldc           #58                 // String
    2318: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    2321: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    2324: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    2327: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    2330: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    2333: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    2338: pop
    2339: aload         13
    2341: areturn
    2342: new           #22                 // class org/apache/wss4j/common/ext/WSSecurityException
    2345: dup
    2346: getstatic     #23                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
    2349: ldc           #24                 // String noKeyinfo
    2351: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
    2354: athrow
    2355: astore        20
    2357: aload_3
    2358: new           #56                 // class java/lang/StringBuilder
    2361: dup
    2362: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
    2365: ldc           #58                 // String
    2367: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    2370: invokestatic  #60                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
    2373: invokevirtual #61                 // Method java/lang/Object.hashCode:()I
    2376: invokevirtual #62                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
    2379: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    2382: invokeinterface #64,  2           // InterfaceMethod org/apache/xml/security/stax/ext/InboundSecurityContext.remove:(Ljava/lang/String;)Ljava/lang/Object;
    2387: pop
    2388: aload         20
    2390: athrow
    Exception table:
       from    to  target type
         800   910   953   Class java/security/NoSuchAlgorithmException
         944   950   953   Class java/security/NoSuchAlgorithmException
         800   910   968   Class java/security/cert/CertificateEncodingException
         944   950   968   Class java/security/cert/CertificateEncodingException
        1399  1504  1547   Class java/security/NoSuchAlgorithmException
        1538  1544  1547   Class java/security/NoSuchAlgorithmException
        1704  1725  1759   Class org/apache/wss4j/common/ext/WSSecurityException
           0   222  2355   any
         256   285  2355   any
         319   363  2355   any
         397   441  2355   any
         475   689  2355   any
         723   756  2355   any
         790   910  2355   any
         944  1004  2355   any
        1038  1071  2355   any
        1105  1228  2355   any
        1262  1285  2355   any
        1319  1365  2355   any
        1399  1504  2355   any
        1538  1585  2355   any
        1619  1725  2355   any
        1759  1938  2355   any
        1972  2308  2355   any
        2342  2357  2355   any

  public static org.apache.xml.security.stax.securityToken.InboundSecurityToken getSecurityToken(org.apache.xml.security.binding.xmldsig.KeyValueType, org.apache.wss4j.common.crypto.Crypto, javax.security.auth.callback.CallbackHandler, org.apache.xml.security.stax.ext.SecurityContext) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: invokevirtual #156                // Method org/apache/xml/security/binding/xmldsig/KeyValueType.getContent:()Ljava/util/List;
       4: getstatic     #157                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_RSAKeyValue:Ljavax/xml/namespace/QName;
       7: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      10: checkcast     #158                // class org/apache/xml/security/binding/xmldsig/RSAKeyValueType
      13: astore        4
      15: aload         4
      17: ifnull        35
      20: new           #159                // class org/apache/wss4j/stax/impl/securityToken/RsaKeyValueSecurityTokenImpl
      23: dup
      24: aload         4
      26: aload_3
      27: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
      30: aload_1
      31: invokespecial #160                // Method org/apache/wss4j/stax/impl/securityToken/RsaKeyValueSecurityTokenImpl."<init>":(Lorg/apache/xml/security/binding/xmldsig/RSAKeyValueType;Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;)V
      34: areturn
      35: aload_0
      36: invokevirtual #156                // Method org/apache/xml/security/binding/xmldsig/KeyValueType.getContent:()Ljava/util/List;
      39: getstatic     #161                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_DSAKeyValue:Ljavax/xml/namespace/QName;
      42: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      45: checkcast     #162                // class org/apache/xml/security/binding/xmldsig/DSAKeyValueType
      48: astore        5
      50: aload         5
      52: ifnull        70
      55: new           #163                // class org/apache/wss4j/stax/impl/securityToken/DsaKeyValueSecurityTokenImpl
      58: dup
      59: aload         5
      61: aload_3
      62: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
      65: aload_1
      66: invokespecial #164                // Method org/apache/wss4j/stax/impl/securityToken/DsaKeyValueSecurityTokenImpl."<init>":(Lorg/apache/xml/security/binding/xmldsig/DSAKeyValueType;Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;)V
      69: areturn
      70: aload_0
      71: invokevirtual #156                // Method org/apache/xml/security/binding/xmldsig/KeyValueType.getContent:()Ljava/util/List;
      74: getstatic     #165                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig11_ECKeyValue:Ljavax/xml/namespace/QName;
      77: invokestatic  #10                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      80: checkcast     #166                // class org/apache/xml/security/binding/xmldsig11/ECKeyValueType
      83: astore        6
      85: aload         6
      87: ifnull        105
      90: new           #167                // class org/apache/wss4j/stax/impl/securityToken/ECKeyValueSecurityTokenImpl
      93: dup
      94: aload         6
      96: aload_3
      97: checkcast     #19                 // class org/apache/wss4j/stax/ext/WSInboundSecurityContext
     100: aload_1
     101: invokespecial #168                // Method org/apache/wss4j/stax/impl/securityToken/ECKeyValueSecurityTokenImpl."<init>":(Lorg/apache/xml/security/binding/xmldsig11/ECKeyValueType;Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;)V
     104: areturn
     105: new           #22                 // class org/apache/wss4j/common/ext/WSSecurityException
     108: dup
     109: getstatic     #23                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     112: ldc           #169                // String unsupportedKeyInfo
     114: invokespecial #25                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     117: athrow

  private static org.apache.xml.security.stax.securityToken.InboundSecurityToken createSecurityTokenProxy(org.apache.xml.security.stax.securityToken.InboundSecurityToken, org.apache.xml.security.stax.securityToken.SecurityTokenConstants$KeyIdentifier);
    Code:
       0: new           #170                // class java/util/ArrayList
       3: dup
       4: invokespecial #171                // Method java/util/ArrayList."<init>":()V
       7: astore_2
       8: aload_0
       9: invokevirtual #172                // Method java/lang/Object.getClass:()Ljava/lang/Class;
      12: aload_2
      13: invokestatic  #173                // Method getImplementedInterfaces:(Ljava/lang/Class;Ljava/util/List;)V
      16: aload_2
      17: aload_2
      18: invokeinterface #28,  1           // InterfaceMethod java/util/List.size:()I
      23: anewarray     #174                // class java/lang/Class
      26: invokeinterface #175,  2          // InterfaceMethod java/util/List.toArray:([Ljava/lang/Object;)[Ljava/lang/Object;
      31: checkcast     #176                // class "[Ljava/lang/Class;"
      34: astore_3
      35: aload_0
      36: invokevirtual #172                // Method java/lang/Object.getClass:()Ljava/lang/Class;
      39: invokevirtual #177                // Method java/lang/Class.getClassLoader:()Ljava/lang/ClassLoader;
      42: aload_3
      43: new           #178                // class org/apache/wss4j/stax/impl/securityToken/SecurityTokenFactoryImpl$1
      46: dup
      47: aload_1
      48: aload_0
      49: invokespecial #179                // Method org/apache/wss4j/stax/impl/securityToken/SecurityTokenFactoryImpl$1."<init>":(Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;)V
      52: invokestatic  #180                // Method java/lang/reflect/Proxy.newProxyInstance:(Ljava/lang/ClassLoader;[Ljava/lang/Class;Ljava/lang/reflect/InvocationHandler;)Ljava/lang/Object;
      55: checkcast     #43                 // class org/apache/xml/security/stax/securityToken/InboundSecurityToken
      58: areturn

  private static void getImplementedInterfaces(java.lang.Class<?>, java.util.List<java.lang.Class<?>>);
    Code:
       0: aload_0
       1: ifnonnull     5
       4: return
       5: aload_0
       6: invokevirtual #181                // Method java/lang/Class.getInterfaces:()[Ljava/lang/Class;
       9: astore_2
      10: iconst_0
      11: istore_3
      12: iload_3
      13: aload_2
      14: arraylength
      15: if_icmpge     55
      18: aload_2
      19: iload_3
      20: aaload
      21: astore        4
      23: aload_1
      24: aload         4
      26: invokeinterface #182,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      31: ifne          43
      34: aload_1
      35: aload         4
      37: invokeinterface #183,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      42: pop
      43: aload         4
      45: aload_1
      46: invokestatic  #173                // Method getImplementedInterfaces:(Ljava/lang/Class;Ljava/util/List;)V
      49: iinc          3, 1
      52: goto          12
      55: aload_0
      56: invokevirtual #184                // Method java/lang/Class.getSuperclass:()Ljava/lang/Class;
      59: aload_1
      60: invokestatic  #173                // Method getImplementedInterfaces:(Ljava/lang/Class;Ljava/util/List;)V
      63: return
}
