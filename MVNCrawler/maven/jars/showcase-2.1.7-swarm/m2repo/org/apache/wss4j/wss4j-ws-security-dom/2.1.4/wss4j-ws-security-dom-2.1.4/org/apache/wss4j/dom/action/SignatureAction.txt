Compiled from "SignatureAction.java"
public class org.apache.wss4j.dom.action.SignatureAction implements org.apache.wss4j.dom.action.Action {
  public org.apache.wss4j.dom.action.SignatureAction();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public void execute(org.apache.wss4j.dom.handler.WSHandler, org.apache.wss4j.common.SecurityActionToken, org.w3c.dom.Document, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload         4
       2: invokevirtual #2                  // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
       5: astore        5
       7: aload         5
       9: ifnonnull     20
      12: aload_1
      13: aload         4
      15: invokevirtual #3                  // Method org/apache/wss4j/dom/handler/WSHandler.getPasswordCallbackHandler:(Lorg/apache/wss4j/dom/handler/RequestData;)Ljavax/security/auth/callback/CallbackHandler;
      18: astore        5
      20: aconst_null
      21: astore        6
      23: aload_2
      24: instanceof    #4                  // class org/apache/wss4j/common/SignatureActionToken
      27: ifeq          36
      30: aload_2
      31: checkcast     #4                  // class org/apache/wss4j/common/SignatureActionToken
      34: astore        6
      36: aload         6
      38: ifnonnull     48
      41: aload         4
      43: invokevirtual #5                  // Method org/apache/wss4j/dom/handler/RequestData.getSignatureToken:()Lorg/apache/wss4j/common/SignatureActionToken;
      46: astore        6
      48: aload_1
      49: aload         6
      51: invokevirtual #6                  // Method org/apache/wss4j/common/SignatureActionToken.getUser:()Ljava/lang/String;
      54: iconst_2
      55: aload         5
      57: aload         4
      59: invokevirtual #7                  // Method org/apache/wss4j/dom/handler/WSHandler.getPasswordCB:(Ljava/lang/String;ILjavax/security/auth/callback/CallbackHandler;Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/apache/wss4j/common/ext/WSPasswordCallback;
      62: astore        7
      64: new           #8                  // class org/apache/wss4j/dom/message/WSSecSignature
      67: dup
      68: invokespecial #9                  // Method org/apache/wss4j/dom/message/WSSecSignature."<init>":()V
      71: astore        8
      73: aload         8
      75: aload         4
      77: invokevirtual #10                 // Method org/apache/wss4j/dom/handler/RequestData.getWssConfig:()Lorg/apache/wss4j/dom/engine/WSSConfig;
      80: invokevirtual #11                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      83: invokevirtual #12                 // Method org/apache/wss4j/dom/message/WSSecSignature.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      86: aload         8
      88: aload         4
      90: invokevirtual #13                 // Method org/apache/wss4j/dom/handler/RequestData.isAddInclusivePrefixes:()Z
      93: invokevirtual #14                 // Method org/apache/wss4j/dom/message/WSSecSignature.setAddInclusivePrefixes:(Z)V
      96: aload         6
      98: invokevirtual #15                 // Method org/apache/wss4j/common/SignatureActionToken.getKeyIdentifierId:()I
     101: ifeq          114
     104: aload         8
     106: aload         6
     108: invokevirtual #15                 // Method org/apache/wss4j/common/SignatureActionToken.getKeyIdentifierId:()I
     111: invokevirtual #16                 // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     114: aload         6
     116: invokevirtual #17                 // Method org/apache/wss4j/common/SignatureActionToken.getSignatureAlgorithm:()Ljava/lang/String;
     119: ifnull        132
     122: aload         8
     124: aload         6
     126: invokevirtual #17                 // Method org/apache/wss4j/common/SignatureActionToken.getSignatureAlgorithm:()Ljava/lang/String;
     129: invokevirtual #18                 // Method org/apache/wss4j/dom/message/WSSecSignature.setSignatureAlgorithm:(Ljava/lang/String;)V
     132: aload         6
     134: invokevirtual #19                 // Method org/apache/wss4j/common/SignatureActionToken.getDigestAlgorithm:()Ljava/lang/String;
     137: ifnull        150
     140: aload         8
     142: aload         6
     144: invokevirtual #19                 // Method org/apache/wss4j/common/SignatureActionToken.getDigestAlgorithm:()Ljava/lang/String;
     147: invokevirtual #20                 // Method org/apache/wss4j/dom/message/WSSecSignature.setDigestAlgo:(Ljava/lang/String;)V
     150: aload         6
     152: invokevirtual #21                 // Method org/apache/wss4j/common/SignatureActionToken.getC14nAlgorithm:()Ljava/lang/String;
     155: ifnull        168
     158: aload         8
     160: aload         6
     162: invokevirtual #21                 // Method org/apache/wss4j/common/SignatureActionToken.getC14nAlgorithm:()Ljava/lang/String;
     165: invokevirtual #22                 // Method org/apache/wss4j/dom/message/WSSecSignature.setSigCanonicalization:(Ljava/lang/String;)V
     168: aload         8
     170: aload         6
     172: invokevirtual #23                 // Method org/apache/wss4j/common/SignatureActionToken.isIncludeToken:()Z
     175: invokevirtual #24                 // Method org/apache/wss4j/dom/message/WSSecSignature.setIncludeSignatureToken:(Z)V
     178: aload         8
     180: aload         6
     182: invokevirtual #6                  // Method org/apache/wss4j/common/SignatureActionToken.getUser:()Ljava/lang/String;
     185: aload         7
     187: invokevirtual #25                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
     190: invokevirtual #26                 // Method org/apache/wss4j/dom/message/WSSecSignature.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
     193: aload         8
     195: aload         6
     197: invokevirtual #27                 // Method org/apache/wss4j/common/SignatureActionToken.isUseSingleCert:()Z
     200: invokevirtual #28                 // Method org/apache/wss4j/dom/message/WSSecSignature.setUseSingleCertificate:(Z)V
     203: aload         7
     205: invokevirtual #29                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getKey:()[B
     208: ifnull        224
     211: aload         8
     213: aload         7
     215: invokevirtual #29                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getKey:()[B
     218: invokevirtual #30                 // Method org/apache/wss4j/dom/message/WSSecSignature.setSecretKey:([B)V
     221: goto          266
     224: aload         6
     226: invokevirtual #31                 // Method org/apache/wss4j/common/SignatureActionToken.getKey:()[B
     229: ifnull        245
     232: aload         8
     234: aload         6
     236: invokevirtual #31                 // Method org/apache/wss4j/common/SignatureActionToken.getKey:()[B
     239: invokevirtual #30                 // Method org/apache/wss4j/dom/message/WSSecSignature.setSecretKey:([B)V
     242: goto          266
     245: aload         6
     247: invokevirtual #6                  // Method org/apache/wss4j/common/SignatureActionToken.getUser:()Ljava/lang/String;
     250: ifnonnull     266
     253: new           #32                 // class org/apache/wss4j/common/ext/WSSecurityException
     256: dup
     257: getstatic     #33                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     260: ldc           #34                 // String noSignatureUser
     262: invokespecial #35                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     265: athrow
     266: aload         6
     268: invokevirtual #36                 // Method org/apache/wss4j/common/SignatureActionToken.getTokenId:()Ljava/lang/String;
     271: ifnull        284
     274: aload         8
     276: aload         6
     278: invokevirtual #36                 // Method org/apache/wss4j/common/SignatureActionToken.getTokenId:()Ljava/lang/String;
     281: invokevirtual #37                 // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenId:(Ljava/lang/String;)V
     284: aload         6
     286: invokevirtual #38                 // Method org/apache/wss4j/common/SignatureActionToken.getTokenType:()Ljava/lang/String;
     289: ifnull        302
     292: aload         8
     294: aload         6
     296: invokevirtual #38                 // Method org/apache/wss4j/common/SignatureActionToken.getTokenType:()Ljava/lang/String;
     299: invokevirtual #39                 // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     302: aload         6
     304: invokevirtual #40                 // Method org/apache/wss4j/common/SignatureActionToken.getSha1Value:()Ljava/lang/String;
     307: ifnull        320
     310: aload         8
     312: aload         6
     314: invokevirtual #40                 // Method org/apache/wss4j/common/SignatureActionToken.getSha1Value:()Ljava/lang/String;
     317: invokevirtual #41                 // Method org/apache/wss4j/dom/message/WSSecSignature.setEncrKeySha1value:(Ljava/lang/String;)V
     320: aload         8
     322: aload         4
     324: invokevirtual #42                 // Method org/apache/wss4j/dom/handler/RequestData.getAttachmentCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     327: invokevirtual #43                 // Method org/apache/wss4j/dom/message/WSSecSignature.setAttachmentCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
     330: aload         8
     332: aload         4
     334: invokevirtual #44                 // Method org/apache/wss4j/dom/handler/RequestData.isStoreBytesInAttachment:()Z
     337: invokevirtual #45                 // Method org/apache/wss4j/dom/message/WSSecSignature.setStoreBytesInAttachment:(Z)V
     340: aload         8
     342: aload_3
     343: aload         6
     345: invokevirtual #46                 // Method org/apache/wss4j/common/SignatureActionToken.getCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     348: aload         4
     350: invokevirtual #47                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     353: invokevirtual #48                 // Method org/apache/wss4j/dom/message/WSSecSignature.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     356: aconst_null
     357: astore        9
     359: iconst_0
     360: istore        10
     362: aload         6
     364: invokevirtual #49                 // Method org/apache/wss4j/common/SignatureActionToken.getParts:()Ljava/util/List;
     367: invokeinterface #50,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     372: astore        11
     374: aload         11
     376: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     381: ifeq          594
     384: aload         11
     386: invokeinterface #52,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     391: checkcast     #53                 // class org/apache/wss4j/common/WSEncryptionPart
     394: astore        12
     396: ldc           #54                 // String STRTransform
     398: aload         12
     400: invokevirtual #55                 // Method org/apache/wss4j/common/WSEncryptionPart.getName:()Ljava/lang/String;
     403: invokevirtual #56                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     406: ifeq          430
     409: aload         12
     411: invokevirtual #57                 // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
     414: ifnonnull     430
     417: aload         12
     419: aload         8
     421: invokevirtual #58                 // Method org/apache/wss4j/dom/message/WSSecSignature.getSecurityTokenReferenceURI:()Ljava/lang/String;
     424: invokevirtual #59                 // Method org/apache/wss4j/common/WSEncryptionPart.setId:(Ljava/lang/String;)V
     427: goto          591
     430: aload         4
     432: invokevirtual #60                 // Method org/apache/wss4j/dom/handler/RequestData.isAppendSignatureAfterTimestamp:()Z
     435: ifeq          562
     438: ldc           #61                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
     440: aload         12
     442: invokevirtual #62                 // Method org/apache/wss4j/common/WSEncryptionPart.getNamespace:()Ljava/lang/String;
     445: invokevirtual #56                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     448: ifeq          562
     451: ldc           #63                 // String Timestamp
     453: aload         12
     455: invokevirtual #55                 // Method org/apache/wss4j/common/WSEncryptionPart.getName:()Ljava/lang/String;
     458: invokevirtual #56                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     461: ifeq          562
     464: aload         4
     466: invokevirtual #64                 // Method org/apache/wss4j/dom/handler/RequestData.getOriginalSignatureActionPosition:()I
     469: istore        13
     471: iload         13
     473: ifle          559
     476: aload         4
     478: invokevirtual #47                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     481: invokevirtual #65                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     484: astore        14
     486: aload         14
     488: invokeinterface #66,  1           // InterfaceMethod org/w3c/dom/Element.getLastChild:()Lorg/w3c/dom/Node;
     493: astore        15
     495: iconst_0
     496: istore        16
     498: aload         15
     500: ifnull        544
     503: iload         16
     505: iload         13
     507: if_icmpge     544
     510: aload         15
     512: ifnull        538
     515: aload         15
     517: invokeinterface #67,  1           // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
     522: iconst_1
     523: if_icmpeq     538
     526: aload         15
     528: invokeinterface #68,  1           // InterfaceMethod org/w3c/dom/Node.getPreviousSibling:()Lorg/w3c/dom/Node;
     533: astore        15
     535: goto          510
     538: iinc          16, 1
     541: goto          498
     544: aload         15
     546: instanceof    #69                 // class org/w3c/dom/Element
     549: ifeq          559
     552: aload         15
     554: checkcast     #69                 // class org/w3c/dom/Element
     557: astore        9
     559: goto          591
     562: ldc           #70                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
     564: aload         12
     566: invokevirtual #62                 // Method org/apache/wss4j/common/WSEncryptionPart.getNamespace:()Ljava/lang/String;
     569: invokevirtual #56                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     572: ifeq          591
     575: ldc           #71                 // String BinarySecurityToken
     577: aload         12
     579: invokevirtual #55                 // Method org/apache/wss4j/common/WSEncryptionPart.getName:()Ljava/lang/String;
     582: invokevirtual #56                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     585: ifeq          591
     588: iconst_1
     589: istore        10
     591: goto          374
     594: iload         10
     596: ifeq          609
     599: aload         8
     601: aload         4
     603: invokevirtual #47                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     606: invokevirtual #72                 // Method org/apache/wss4j/dom/message/WSSecSignature.prependBSTElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     609: aload         6
     611: invokevirtual #49                 // Method org/apache/wss4j/common/SignatureActionToken.getParts:()Ljava/util/List;
     614: astore        11
     616: aload         11
     618: ifnull        631
     621: aload         11
     623: invokeinterface #73,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     628: ifeq          653
     631: new           #74                 // class java/util/ArrayList
     634: dup
     635: iconst_1
     636: invokespecial #75                 // Method java/util/ArrayList."<init>":(I)V
     639: astore        11
     641: aload         11
     643: aload_3
     644: invokestatic  #76                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.getDefaultEncryptionPart:(Lorg/w3c/dom/Document;)Lorg/apache/wss4j/common/WSEncryptionPart;
     647: invokeinterface #77,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     652: pop
     653: aload         8
     655: aload         11
     657: aload         4
     659: invokevirtual #47                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     662: invokevirtual #78                 // Method org/apache/wss4j/dom/message/WSSecSignature.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     665: astore        12
     667: iload         10
     669: ifne          685
     672: aload         4
     674: invokevirtual #60                 // Method org/apache/wss4j/dom/handler/RequestData.isAppendSignatureAfterTimestamp:()Z
     677: ifeq          697
     680: aload         9
     682: ifnonnull     697
     685: aload         8
     687: aload         12
     689: iconst_0
     690: aconst_null
     691: invokevirtual #79                 // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     694: goto          707
     697: aload         8
     699: aload         12
     701: iconst_1
     702: aload         9
     704: invokevirtual #79                 // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     707: iload         10
     709: ifne          722
     712: aload         8
     714: aload         4
     716: invokevirtual #47                 // Method org/apache/wss4j/dom/handler/RequestData.getSecHeader:()Lorg/apache/wss4j/dom/message/WSSecHeader;
     719: invokevirtual #72                 // Method org/apache/wss4j/dom/message/WSSecSignature.prependBSTElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     722: aload         4
     724: invokevirtual #80                 // Method org/apache/wss4j/dom/handler/RequestData.getSignatureValues:()Ljava/util/List;
     727: aload         8
     729: invokevirtual #81                 // Method org/apache/wss4j/dom/message/WSSecSignature.getSignatureValue:()[B
     732: invokeinterface #77,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     737: pop
     738: goto          767
     741: astore        9
     743: new           #32                 // class org/apache/wss4j/common/ext/WSSecurityException
     746: dup
     747: getstatic     #33                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     750: aload         9
     752: ldc           #82                 // String empty
     754: iconst_1
     755: anewarray     #83                 // class java/lang/Object
     758: dup
     759: iconst_0
     760: ldc           #84                 // String Error during Signature:
     762: aastore
     763: invokespecial #85                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
     766: athrow
     767: return
    Exception table:
       from    to  target type
         340   738   741   Class org/apache/wss4j/common/ext/WSSecurityException
}
