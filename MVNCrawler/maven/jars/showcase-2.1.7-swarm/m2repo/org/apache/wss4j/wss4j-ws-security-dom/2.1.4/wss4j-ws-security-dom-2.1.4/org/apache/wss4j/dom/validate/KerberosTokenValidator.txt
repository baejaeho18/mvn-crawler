Compiled from "KerberosTokenValidator.java"
public class org.apache.wss4j.dom.validate.KerberosTokenValidator implements org.apache.wss4j.dom.validate.Validator {
  private static final org.slf4j.Logger LOG;

  private java.lang.String serviceName;

  private javax.security.auth.callback.CallbackHandler callbackHandler;

  private java.lang.String contextName;

  private org.apache.wss4j.common.kerberos.KerberosTokenDecoder kerberosTokenDecoder;

  private boolean isUsernameServiceNameForm;

  private boolean spnego;

  public org.apache.wss4j.dom.validate.KerberosTokenValidator();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public java.lang.String getContextName();
    Code:
       0: aload_0
       1: getfield      #2                  // Field contextName:Ljava/lang/String;
       4: areturn

  public void setContextName(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #2                  // Field contextName:Ljava/lang/String;
       5: return

  public javax.security.auth.callback.CallbackHandler getCallbackHandler();
    Code:
       0: aload_0
       1: getfield      #3                  // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
       4: areturn

  public void setCallbackHandler(javax.security.auth.callback.CallbackHandler);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #3                  // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
       5: return

  public void setServiceName(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #4                  // Field serviceName:Ljava/lang/String;
       5: return

  public java.lang.String getServiceName();
    Code:
       0: aload_0
       1: getfield      #4                  // Field serviceName:Ljava/lang/String;
       4: areturn

  public org.apache.wss4j.common.kerberos.KerberosTokenDecoder getKerberosTokenDecoder();
    Code:
       0: aload_0
       1: getfield      #5                  // Field kerberosTokenDecoder:Lorg/apache/wss4j/common/kerberos/KerberosTokenDecoder;
       4: areturn

  public void setKerberosTokenDecoder(org.apache.wss4j.common.kerberos.KerberosTokenDecoder);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #5                  // Field kerberosTokenDecoder:Lorg/apache/wss4j/common/kerberos/KerberosTokenDecoder;
       5: return

  public org.apache.wss4j.dom.validate.Credential validate(org.apache.wss4j.dom.validate.Credential, org.apache.wss4j.dom.handler.RequestData) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ifnull        11
       4: aload_1
       5: invokevirtual #6                  // Method org/apache/wss4j/dom/validate/Credential.getBinarySecurityToken:()Lorg/apache/wss4j/common/token/BinarySecurity;
       8: ifnonnull     24
      11: new           #7                  // class org/apache/wss4j/common/ext/WSSecurityException
      14: dup
      15: getstatic     #8                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      18: ldc           #9                  // String noCredential
      20: invokespecial #10                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      23: athrow
      24: aload_1
      25: invokevirtual #6                  // Method org/apache/wss4j/dom/validate/Credential.getBinarySecurityToken:()Lorg/apache/wss4j/common/token/BinarySecurity;
      28: astore_3
      29: aload_3
      30: instanceof    #11                 // class org/apache/wss4j/dom/message/token/KerberosSecurity
      33: ifne          38
      36: aload_1
      37: areturn
      38: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
      41: invokeinterface #13,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
      46: ifeq          139
      49: ldc           #14                 // String java.security.auth.login.config
      51: invokestatic  #15                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      54: astore        4
      56: ldc           #16                 // String java.security.krb5.conf
      58: invokestatic  #15                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      61: astore        5
      63: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
      66: new           #17                 // class java/lang/StringBuilder
      69: dup
      70: invokespecial #18                 // Method java/lang/StringBuilder."<init>":()V
      73: ldc           #19                 // String KerberosTokenValidator - Using JAAS auth login file:
      75: invokevirtual #20                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      78: aload         4
      80: invokevirtual #20                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      83: invokevirtual #21                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      86: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      91: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
      94: new           #17                 // class java/lang/StringBuilder
      97: dup
      98: invokespecial #18                 // Method java/lang/StringBuilder."<init>":()V
     101: ldc           #23                 // String KerberosTokenValidator - Using KRB conf file:
     103: invokevirtual #20                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     106: aload         5
     108: invokevirtual #20                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     111: invokevirtual #21                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     114: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     119: goto          139
     122: astore        4
     124: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     127: aload         4
     129: invokevirtual #25                 // Method java/lang/SecurityException.getMessage:()Ljava/lang/String;
     132: aload         4
     134: invokeinterface #26,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
     139: aconst_null
     140: astore        4
     142: aload_0
     143: getfield      #3                  // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
     146: ifnull        169
     149: new           #27                 // class javax/security/auth/login/LoginContext
     152: dup
     153: aload_0
     154: invokevirtual #28                 // Method getContextName:()Ljava/lang/String;
     157: aload_0
     158: getfield      #3                  // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
     161: invokespecial #29                 // Method javax/security/auth/login/LoginContext."<init>":(Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)V
     164: astore        4
     166: goto          209
     169: aload_2
     170: invokevirtual #30                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     173: ifnull        196
     176: new           #27                 // class javax/security/auth/login/LoginContext
     179: dup
     180: aload_0
     181: invokevirtual #28                 // Method getContextName:()Ljava/lang/String;
     184: aload_2
     185: invokevirtual #30                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     188: invokespecial #29                 // Method javax/security/auth/login/LoginContext."<init>":(Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)V
     191: astore        4
     193: goto          209
     196: new           #27                 // class javax/security/auth/login/LoginContext
     199: dup
     200: aload_0
     201: invokevirtual #28                 // Method getContextName:()Ljava/lang/String;
     204: invokespecial #31                 // Method javax/security/auth/login/LoginContext."<init>":(Ljava/lang/String;)V
     207: astore        4
     209: aload         4
     211: invokevirtual #32                 // Method javax/security/auth/login/LoginContext.login:()V
     214: goto          272
     217: astore        5
     219: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     222: invokeinterface #13,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     227: ifeq          245
     230: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     233: aload         5
     235: invokevirtual #34                 // Method javax/security/auth/login/LoginException.getMessage:()Ljava/lang/String;
     238: aload         5
     240: invokeinterface #26,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
     245: new           #7                  // class org/apache/wss4j/common/ext/WSSecurityException
     248: dup
     249: getstatic     #8                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     252: aload         5
     254: ldc           #35                 // String kerberosLoginError
     256: iconst_1
     257: anewarray     #36                 // class java/lang/Object
     260: dup
     261: iconst_0
     262: aload         5
     264: invokevirtual #34                 // Method javax/security/auth/login/LoginException.getMessage:()Ljava/lang/String;
     267: aastore
     268: invokespecial #37                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;[Ljava/lang/Object;)V
     271: athrow
     272: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     275: invokeinterface #13,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     280: ifeq          293
     283: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     286: ldc           #38                 // String Successfully authenticated to the TGT
     288: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     293: aload_3
     294: invokevirtual #39                 // Method org/apache/wss4j/common/token/BinarySecurity.getToken:()[B
     297: astore        5
     299: aload         4
     301: invokevirtual #40                 // Method javax/security/auth/login/LoginContext.getSubject:()Ljavax/security/auth/Subject;
     304: astore        6
     306: aload_0
     307: getfield      #4                  // Field serviceName:Ljava/lang/String;
     310: astore        7
     312: aload         7
     314: ifnonnull     378
     317: aload         6
     319: invokevirtual #41                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     322: astore        8
     324: aload         8
     326: invokeinterface #42,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
     331: ifeq          356
     334: new           #7                  // class org/apache/wss4j/common/ext/WSSecurityException
     337: dup
     338: getstatic     #8                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     341: ldc           #35                 // String kerberosLoginError
     343: iconst_1
     344: anewarray     #36                 // class java/lang/Object
     347: dup
     348: iconst_0
     349: ldc           #43                 // String No Client principals found after login
     351: aastore
     352: invokespecial #44                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     355: athrow
     356: aload         8
     358: invokeinterface #45,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     363: invokeinterface #46,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     368: checkcast     #47                 // class java/security/Principal
     371: invokeinterface #48,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
     376: astore        7
     378: new           #49                 // class org/apache/wss4j/common/kerberos/KerberosServiceExceptionAction
     381: dup
     382: aload         5
     384: aload         7
     386: aload_0
     387: invokevirtual #50                 // Method isUsernameServiceNameForm:()Z
     390: aload_0
     391: getfield      #51                 // Field spnego:Z
     394: invokespecial #52                 // Method org/apache/wss4j/common/kerberos/KerberosServiceExceptionAction."<init>":([BLjava/lang/String;ZZ)V
     397: astore        8
     399: aconst_null
     400: astore        9
     402: aload         6
     404: aload         8
     406: invokestatic  #53                 // Method javax/security/auth/Subject.doAs:(Ljavax/security/auth/Subject;Ljava/security/PrivilegedExceptionAction;)Ljava/lang/Object;
     409: checkcast     #54                 // class org/apache/wss4j/common/kerberos/KerberosServiceContext
     412: astore        9
     414: goto          462
     417: astore        10
     419: aload         10
     421: invokevirtual #56                 // Method java/security/PrivilegedActionException.getCause:()Ljava/lang/Throwable;
     424: astore        11
     426: aload         11
     428: instanceof    #7                  // class org/apache/wss4j/common/ext/WSSecurityException
     431: ifeq          440
     434: aload         11
     436: checkcast     #7                  // class org/apache/wss4j/common/ext/WSSecurityException
     439: athrow
     440: new           #7                  // class org/apache/wss4j/common/ext/WSSecurityException
     443: dup
     444: getstatic     #8                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     447: new           #57                 // class java/lang/Exception
     450: dup
     451: aload         11
     453: invokespecial #58                 // Method java/lang/Exception."<init>":(Ljava/lang/Throwable;)V
     456: ldc           #59                 // String kerberosTicketValidationError
     458: invokespecial #60                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     461: athrow
     462: aload_1
     463: aload         9
     465: invokevirtual #61                 // Method org/apache/wss4j/common/kerberos/KerberosServiceContext.getPrincipal:()Ljava/security/Principal;
     468: invokevirtual #62                 // Method org/apache/wss4j/dom/validate/Credential.setPrincipal:(Ljava/security/Principal;)V
     471: aload_1
     472: aload         9
     474: invokevirtual #63                 // Method org/apache/wss4j/common/kerberos/KerberosServiceContext.getDelegationCredential:()Lorg/ietf/jgss/GSSCredential;
     477: invokevirtual #64                 // Method org/apache/wss4j/dom/validate/Credential.setDelegationCredential:(Ljava/lang/Object;)V
     480: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     483: ldc           #65                 // String Trying to obtain the Session Key from the KerberosServiceContext.
     485: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     490: aload         9
     492: invokevirtual #66                 // Method org/apache/wss4j/common/kerberos/KerberosServiceContext.getSessionKey:()Ljava/security/Key;
     495: astore        10
     497: aconst_null
     498: aload         10
     500: if_acmpeq     527
     503: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     506: ldc           #67                 // String Found session key in the KerberosServiceContext.
     508: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     513: aload_1
     514: aload         10
     516: invokeinterface #68,  1           // InterfaceMethod java/security/Key.getEncoded:()[B
     521: invokevirtual #69                 // Method org/apache/wss4j/dom/validate/Credential.setSecretKey:([B)V
     524: goto          537
     527: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     530: ldc           #70                 // String Session key is not found in the KerberosServiceContext.
     532: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     537: aconst_null
     538: aload_1
     539: invokevirtual #71                 // Method org/apache/wss4j/dom/validate/Credential.getSecretKey:()[B
     542: if_acmpne     667
     545: aload_0
     546: getfield      #5                  // Field kerberosTokenDecoder:Lorg/apache/wss4j/common/kerberos/KerberosTokenDecoder;
     549: astore        11
     551: aload         11
     553: ifnonnull     565
     556: new           #72                 // class org/apache/wss4j/common/kerberos/KerberosTokenDecoderImpl
     559: dup
     560: invokespecial #73                 // Method org/apache/wss4j/common/kerberos/KerberosTokenDecoderImpl."<init>":()V
     563: astore        11
     565: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     568: ldc           #74                 // String KerberosTokenDecoder is set.Trying to obtain the session key from it.
     570: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     575: aload         11
     577: invokeinterface #75,  1           // InterfaceMethod org/apache/wss4j/common/kerberos/KerberosTokenDecoder.clear:()V
     582: aload         11
     584: aload         5
     586: invokeinterface #76,  2           // InterfaceMethod org/apache/wss4j/common/kerberos/KerberosTokenDecoder.setToken:([B)V
     591: aload         11
     593: aload         6
     595: invokeinterface #77,  2           // InterfaceMethod org/apache/wss4j/common/kerberos/KerberosTokenDecoder.setSubject:(Ljavax/security/auth/Subject;)V
     600: aload         11
     602: invokeinterface #78,  1           // InterfaceMethod org/apache/wss4j/common/kerberos/KerberosTokenDecoder.getSessionKey:()[B
     607: astore        12
     609: aconst_null
     610: aload         12
     612: if_acmpeq     634
     615: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     618: ldc           #79                 // String Session key obtained from the KerberosTokenDecoder.
     620: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     625: aload_1
     626: aload         12
     628: invokevirtual #69                 // Method org/apache/wss4j/dom/validate/Credential.setSecretKey:([B)V
     631: goto          644
     634: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     637: ldc           #80                 // String Session key could not be obtained from the KerberosTokenDecoder.
     639: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     644: goto          664
     647: astore        12
     649: new           #7                  // class org/apache/wss4j/common/ext/WSSecurityException
     652: dup
     653: getstatic     #8                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     656: aload         12
     658: ldc           #82                 // String Error retrieving session key.
     660: invokespecial #60                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     663: athrow
     664: goto          677
     667: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     670: ldc           #83                 // String KerberosTokenDecoder is not set.
     672: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     677: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     680: invokeinterface #13,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     685: ifeq          698
     688: getstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
     691: ldc           #84                 // String Successfully validated a ticket
     693: invokeinterface #22,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     698: aload_1
     699: areturn
    Exception table:
       from    to  target type
          49   119   122   Class java/lang/SecurityException
         142   214   217   Class javax/security/auth/login/LoginException
         402   414   417   Class java/security/PrivilegedActionException
         600   644   647   Class org/apache/wss4j/common/kerberos/KerberosTokenDecoderException

  public boolean isUsernameServiceNameForm();
    Code:
       0: aload_0
       1: getfield      #85                 // Field isUsernameServiceNameForm:Z
       4: ireturn

  public void setUsernameServiceNameForm(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #85                 // Field isUsernameServiceNameForm:Z
       5: return

  public boolean isSpnego();
    Code:
       0: aload_0
       1: getfield      #51                 // Field spnego:Z
       4: ireturn

  public void setSpnego(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #51                 // Field spnego:Z
       5: return

  static {};
    Code:
       0: ldc_w         #86                 // class org/apache/wss4j/dom/validate/KerberosTokenValidator
       3: invokestatic  #87                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #12                 // Field LOG:Lorg/slf4j/Logger;
       9: return
}
