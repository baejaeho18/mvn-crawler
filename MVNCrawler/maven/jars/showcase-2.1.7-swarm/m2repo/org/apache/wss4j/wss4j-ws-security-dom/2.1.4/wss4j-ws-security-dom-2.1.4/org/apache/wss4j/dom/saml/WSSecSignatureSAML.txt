Compiled from "WSSecSignatureSAML.java"
public class org.apache.wss4j.dom.saml.WSSecSignatureSAML extends org.apache.wss4j.dom.message.WSSecSignature {
  private static final org.slf4j.Logger LOG;

  private boolean senderVouches;

  private org.apache.wss4j.common.token.SecurityTokenReference secRefSaml;

  private java.lang.String secRefID;

  private org.w3c.dom.Element samlToken;

  private org.apache.wss4j.common.crypto.Crypto userCrypto;

  private org.apache.wss4j.common.crypto.Crypto issuerCrypto;

  private java.lang.String issuerKeyName;

  private java.lang.String issuerKeyPW;

  private boolean useDirectReferenceToAssertion;

  public org.apache.wss4j.dom.saml.WSSecSignatureSAML();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/wss4j/dom/message/WSSecSignature."<init>":()V
       4: aload_0
       5: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
       8: invokeinterface #3,  1            // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
      13: putfield      #4                  // Field doDebug:Z
      16: return

  public org.w3c.dom.Document build(org.w3c.dom.Document, org.apache.wss4j.common.crypto.Crypto, org.apache.wss4j.common.saml.SamlAssertionWrapper, org.apache.wss4j.common.crypto.Crypto, java.lang.String, java.lang.String, org.apache.wss4j.dom.message.WSSecHeader) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: aload         5
       8: aload         6
      10: aload         7
      12: invokevirtual #5                  // Method prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/common/crypto/Crypto;Ljava/lang/String;Ljava/lang/String;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
      15: aload_0
      16: invokevirtual #6                  // Method getParts:()Ljava/util/List;
      19: invokeinterface #7,  1            // InterfaceMethod java/util/List.isEmpty:()Z
      24: ifeq          44
      27: aload_0
      28: invokevirtual #6                  // Method getParts:()Ljava/util/List;
      31: aload_1
      32: invokestatic  #8                  // Method org/apache/wss4j/dom/util/WSSecurityUtil.getDefaultEncryptionPart:(Lorg/w3c/dom/Document;)Lorg/apache/wss4j/common/WSEncryptionPart;
      35: invokeinterface #9,  2            // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      40: pop
      41: goto          110
      44: aload_0
      45: invokevirtual #6                  // Method getParts:()Ljava/util/List;
      48: invokeinterface #10,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      53: astore        8
      55: aload         8
      57: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      62: ifeq          110
      65: aload         8
      67: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      72: checkcast     #13                 // class org/apache/wss4j/common/WSEncryptionPart
      75: astore        9
      77: ldc           #14                 // String STRTransform
      79: aload         9
      81: invokevirtual #15                 // Method org/apache/wss4j/common/WSEncryptionPart.getName:()Ljava/lang/String;
      84: invokevirtual #16                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      87: ifeq          107
      90: aload         9
      92: invokevirtual #17                 // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
      95: ifnonnull     107
      98: aload         9
     100: aload_0
     101: getfield      #18                 // Field strUri:Ljava/lang/String;
     104: invokevirtual #19                 // Method org/apache/wss4j/common/WSEncryptionPart.setId:(Ljava/lang/String;)V
     107: goto          55
     110: aload_0
     111: getfield      #20                 // Field secRefID:Ljava/lang/String;
     114: ifnull        164
     117: aload_1
     118: invokeinterface #21,  1           // InterfaceMethod org/w3c/dom/Document.getDocumentElement:()Lorg/w3c/dom/Element;
     123: invokestatic  #22                 // Method org/apache/wss4j/dom/util/WSSecurityUtil.getSOAPNamespace:(Lorg/w3c/dom/Element;)Ljava/lang/String;
     126: astore        8
     128: new           #13                 // class org/apache/wss4j/common/WSEncryptionPart
     131: dup
     132: ldc           #14                 // String STRTransform
     134: aload         8
     136: ldc           #23                 // String Content
     138: invokespecial #24                 // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     141: astore        9
     143: aload         9
     145: aload_0
     146: getfield      #20                 // Field secRefID:Ljava/lang/String;
     149: invokevirtual #19                 // Method org/apache/wss4j/common/WSEncryptionPart.setId:(Ljava/lang/String;)V
     152: aload_0
     153: invokevirtual #6                  // Method getParts:()Ljava/util/List;
     156: aload         9
     158: invokeinterface #9,  2            // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     163: pop
     164: aload_0
     165: aload_0
     166: invokevirtual #6                  // Method getParts:()Ljava/util/List;
     169: aload         7
     171: invokevirtual #25                 // Method addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     174: astore        8
     176: aload_0
     177: aload         7
     179: invokevirtual #26                 // Method prependSAMLElementsToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     182: aload_0
     183: getfield      #27                 // Field senderVouches:Z
     186: ifeq          207
     189: aload_0
     190: aload         8
     192: aload         7
     194: aload_0
     195: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     198: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     201: invokevirtual #30                 // Method computeSignature:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;Lorg/w3c/dom/Element;)V
     204: goto          219
     207: aload_0
     208: aload         8
     210: aload         7
     212: aload_0
     213: getfield      #31                 // Field samlToken:Lorg/w3c/dom/Element;
     216: invokevirtual #30                 // Method computeSignature:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;Lorg/w3c/dom/Element;)V
     219: aload_0
     220: getfield      #32                 // Field bstToken:Lorg/w3c/dom/Element;
     223: ifnull        232
     226: aload_0
     227: aload         7
     229: invokevirtual #33                 // Method prependBSTElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     232: aload_1
     233: areturn

  public void prepare(org.w3c.dom.Document, org.apache.wss4j.common.crypto.Crypto, org.apache.wss4j.common.saml.SamlAssertionWrapper, org.apache.wss4j.common.crypto.Crypto, java.lang.String, java.lang.String, org.apache.wss4j.dom.message.WSSecHeader) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #4                  // Field doDebug:Z
       4: ifeq          17
       7: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
      10: ldc           #34                 // String Beginning ST signing...
      12: invokeinterface #35,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      17: aload_0
      18: aload_2
      19: putfield      #36                 // Field userCrypto:Lorg/apache/wss4j/common/crypto/Crypto;
      22: aload_0
      23: aload         4
      25: putfield      #37                 // Field issuerCrypto:Lorg/apache/wss4j/common/crypto/Crypto;
      28: aload_0
      29: aload_1
      30: putfield      #38                 // Field document:Lorg/w3c/dom/Document;
      33: aload_0
      34: aload         5
      36: putfield      #39                 // Field issuerKeyName:Ljava/lang/String;
      39: aload_0
      40: aload         6
      42: putfield      #40                 // Field issuerKeyPW:Ljava/lang/String;
      45: aload_0
      46: aload_3
      47: aload_1
      48: invokevirtual #41                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.toDOM:(Lorg/w3c/dom/Document;)Lorg/w3c/dom/Element;
      51: putfield      #31                 // Field samlToken:Lorg/w3c/dom/Element;
      54: aconst_null
      55: astore        8
      57: aload_3
      58: invokevirtual #42                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getConfirmationMethods:()Ljava/util/List;
      61: astore        9
      63: aload         9
      65: ifnull        91
      68: aload         9
      70: invokeinterface #43,  1           // InterfaceMethod java/util/List.size:()I
      75: ifle          91
      78: aload         9
      80: iconst_0
      81: invokeinterface #44,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      86: checkcast     #45                 // class java/lang/String
      89: astore        8
      91: aload         8
      93: invokestatic  #46                 // Method org/apache/wss4j/common/saml/OpenSAMLUtil.isMethodSenderVouches:(Ljava/lang/String;)Z
      96: ifeq          104
      99: aload_0
     100: iconst_1
     101: putfield      #27                 // Field senderVouches:Z
     104: aload_0
     105: new           #47                 // class org/apache/wss4j/dom/WSDocInfo
     108: dup
     109: aload_1
     110: invokespecial #48                 // Method org/apache/wss4j/dom/WSDocInfo."<init>":(Lorg/w3c/dom/Document;)V
     113: putfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     116: aconst_null
     117: astore        10
     119: aconst_null
     120: astore        11
     122: aload_0
     123: getfield      #27                 // Field senderVouches:Z
     126: ifeq          177
     129: new           #50                 // class org/apache/wss4j/common/crypto/CryptoType
     132: dup
     133: getstatic     #51                 // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ALIAS:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
     136: invokespecial #52                 // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
     139: astore        12
     141: aload         12
     143: aload_0
     144: getfield      #39                 // Field issuerKeyName:Ljava/lang/String;
     147: invokevirtual #53                 // Method org/apache/wss4j/common/crypto/CryptoType.setAlias:(Ljava/lang/String;)V
     150: aload_0
     151: getfield      #37                 // Field issuerCrypto:Lorg/apache/wss4j/common/crypto/Crypto;
     154: aload         12
     156: invokeinterface #54,  2           // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
     161: astore        10
     163: aload_0
     164: getfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     167: aload_0
     168: getfield      #37                 // Field issuerCrypto:Lorg/apache/wss4j/common/crypto/Crypto;
     171: invokevirtual #55                 // Method org/apache/wss4j/dom/WSDocInfo.setCrypto:(Lorg/apache/wss4j/common/crypto/Crypto;)V
     174: goto          312
     177: aload_0
     178: getfield      #36                 // Field userCrypto:Lorg/apache/wss4j/common/crypto/Crypto;
     181: ifnull        191
     184: aload_3
     185: invokevirtual #56                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.isSigned:()Z
     188: ifne          213
     191: new           #57                 // class org/apache/wss4j/common/ext/WSSecurityException
     194: dup
     195: getstatic     #58                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     198: ldc           #59                 // String invalidSAMLsecurity
     200: iconst_1
     201: anewarray     #60                 // class java/lang/Object
     204: dup
     205: iconst_0
     206: ldc           #61                 // String for SAML Signature (Key Holder)
     208: aastore
     209: invokespecial #62                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     212: athrow
     213: aload_0
     214: getfield      #63                 // Field secretKey:[B
     217: ifnonnull     312
     220: new           #64                 // class org/apache/wss4j/dom/handler/RequestData
     223: dup
     224: invokespecial #65                 // Method org/apache/wss4j/dom/handler/RequestData."<init>":()V
     227: astore        12
     229: new           #66                 // class org/apache/wss4j/common/SignatureActionToken
     232: dup
     233: invokespecial #67                 // Method org/apache/wss4j/common/SignatureActionToken."<init>":()V
     236: astore        13
     238: aload         12
     240: aload         13
     242: invokevirtual #68                 // Method org/apache/wss4j/dom/handler/RequestData.setSignatureToken:(Lorg/apache/wss4j/common/SignatureActionToken;)V
     245: aload         13
     247: aload_0
     248: getfield      #36                 // Field userCrypto:Lorg/apache/wss4j/common/crypto/Crypto;
     251: invokevirtual #69                 // Method org/apache/wss4j/common/SignatureActionToken.setCrypto:(Lorg/apache/wss4j/common/crypto/Crypto;)V
     254: aload_3
     255: new           #70                 // class org/apache/wss4j/dom/saml/WSSSAMLKeyInfoProcessor
     258: dup
     259: aload         12
     261: aload_0
     262: getfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     265: invokespecial #71                 // Method org/apache/wss4j/dom/saml/WSSSAMLKeyInfoProcessor."<init>":(Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)V
     268: aload_0
     269: getfield      #36                 // Field userCrypto:Lorg/apache/wss4j/common/crypto/Crypto;
     272: aload         12
     274: invokevirtual #72                 // Method org/apache/wss4j/dom/handler/RequestData.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     277: invokestatic  #73                 // Method org/apache/wss4j/common/saml/SAMLUtil.getCredentialFromSubject:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/common/saml/SAMLKeyInfoProcessor;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;)Lorg/apache/wss4j/common/saml/SAMLKeyInfo;
     280: astore        14
     282: aload         14
     284: ifnull        312
     287: aload         14
     289: invokevirtual #74                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getPublicKey:()Ljava/security/PublicKey;
     292: astore        11
     294: aload         14
     296: invokevirtual #75                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getCerts:()[Ljava/security/cert/X509Certificate;
     299: astore        10
     301: aload_0
     302: getfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     305: aload_0
     306: getfield      #36                 // Field userCrypto:Lorg/apache/wss4j/common/crypto/Crypto;
     309: invokevirtual #55                 // Method org/apache/wss4j/dom/WSDocInfo.setCrypto:(Lorg/apache/wss4j/common/crypto/Crypto;)V
     312: aload         10
     314: ifnull        330
     317: aload         10
     319: arraylength
     320: ifeq          330
     323: aload         10
     325: iconst_0
     326: aaload
     327: ifnonnull     364
     330: aload         11
     332: ifnonnull     364
     335: aload_0
     336: getfield      #63                 // Field secretKey:[B
     339: ifnonnull     364
     342: new           #57                 // class org/apache/wss4j/common/ext/WSSecurityException
     345: dup
     346: getstatic     #58                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     349: ldc           #76                 // String noCertsFound
     351: iconst_1
     352: anewarray     #60                 // class java/lang/Object
     355: dup
     356: iconst_0
     357: ldc           #77                 // String SAML signature
     359: aastore
     360: invokespecial #62                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     363: athrow
     364: aload_0
     365: invokevirtual #78                 // Method getSignatureAlgorithm:()Ljava/lang/String;
     368: ifnonnull     527
     371: aconst_null
     372: astore        12
     374: aload         10
     376: ifnull        398
     379: aload         10
     381: iconst_0
     382: aaload
     383: ifnull        398
     386: aload         10
     388: iconst_0
     389: aaload
     390: invokevirtual #79                 // Method java/security/cert/X509Certificate.getPublicKey:()Ljava/security/PublicKey;
     393: astore        12
     395: goto          423
     398: aload         11
     400: ifnull        410
     403: aload         11
     405: astore        12
     407: goto          423
     410: new           #57                 // class org/apache/wss4j/common/ext/WSSecurityException
     413: dup
     414: getstatic     #58                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     417: ldc           #80                 // String unknownSignatureAlgorithm
     419: invokespecial #81                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     422: athrow
     423: aload         12
     425: invokeinterface #82,  1           // InterfaceMethod java/security/PublicKey.getAlgorithm:()Ljava/lang/String;
     430: astore        13
     432: aload_0
     433: getfield      #4                  // Field doDebug:Z
     436: ifeq          467
     439: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
     442: new           #83                 // class java/lang/StringBuilder
     445: dup
     446: invokespecial #84                 // Method java/lang/StringBuilder."<init>":()V
     449: ldc           #85                 // String automatic sig algo detection:
     451: invokevirtual #86                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     454: aload         13
     456: invokevirtual #86                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     459: invokevirtual #87                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     462: invokeinterface #35,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     467: aload         13
     469: ldc           #88                 // String DSA
     471: invokevirtual #89                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     474: ifeq          486
     477: aload_0
     478: ldc           #90                 // String http://www.w3.org/2000/09/xmldsig#dsa-sha1
     480: invokevirtual #91                 // Method setSignatureAlgorithm:(Ljava/lang/String;)V
     483: goto          527
     486: aload         13
     488: ldc           #92                 // String RSA
     490: invokevirtual #89                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     493: ifeq          505
     496: aload_0
     497: ldc           #93                 // String http://www.w3.org/2000/09/xmldsig#rsa-sha1
     499: invokevirtual #91                 // Method setSignatureAlgorithm:(Ljava/lang/String;)V
     502: goto          527
     505: new           #57                 // class org/apache/wss4j/common/ext/WSSecurityException
     508: dup
     509: getstatic     #58                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     512: ldc           #80                 // String unknownSignatureAlgorithm
     514: iconst_1
     515: anewarray     #60                 // class java/lang/Object
     518: dup
     519: iconst_0
     520: aload         13
     522: aastore
     523: invokespecial #62                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     526: athrow
     527: aload_0
     528: aconst_null
     529: putfield      #94                 // Field sig:Ljavax/xml/crypto/dsig/XMLSignature;
     532: aconst_null
     533: astore        12
     535: aload_0
     536: invokevirtual #95                 // Method isAddInclusivePrefixes:()Z
     539: ifeq          577
     542: aload_0
     543: invokevirtual #96                 // Method getSigCanonicalization:()Ljava/lang/String;
     546: ldc           #97                 // String http://www.w3.org/2001/10/xml-exc-c14n#
     548: invokevirtual #16                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     551: ifeq          577
     554: aload_0
     555: aload         7
     557: invokevirtual #98                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     560: iconst_0
     561: invokevirtual #99                 // Method getInclusivePrefixes:(Lorg/w3c/dom/Element;Z)Ljava/util/List;
     564: astore        13
     566: new           #100                // class javax/xml/crypto/dsig/spec/ExcC14NParameterSpec
     569: dup
     570: aload         13
     572: invokespecial #101                // Method javax/xml/crypto/dsig/spec/ExcC14NParameterSpec."<init>":(Ljava/util/List;)V
     575: astore        12
     577: aload_0
     578: aload_0
     579: getfield      #102                // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
     582: aload_0
     583: invokevirtual #96                 // Method getSigCanonicalization:()Ljava/lang/String;
     586: aload         12
     588: invokevirtual #103                // Method javax/xml/crypto/dsig/XMLSignatureFactory.newCanonicalizationMethod:(Ljava/lang/String;Ljavax/xml/crypto/dsig/spec/C14NMethodParameterSpec;)Ljavax/xml/crypto/dsig/CanonicalizationMethod;
     591: putfield      #104                // Field c14nMethod:Ljavax/xml/crypto/dsig/CanonicalizationMethod;
     594: goto          626
     597: astore        12
     599: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
     602: ldc           #106                // String
     604: aload         12
     606: invokeinterface #107,  3          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     611: new           #57                 // class org/apache/wss4j/common/ext/WSSecurityException
     614: dup
     615: getstatic     #108                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_SIGNATURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     618: aload         12
     620: ldc           #109                // String noXMLSig
     622: invokespecial #110                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
     625: athrow
     626: aload_0
     627: aload_0
     628: invokevirtual #111                // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     631: ldc           #112                // String KeyId-
     633: aload_0
     634: getfield      #113                // Field keyInfo:Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
     637: invokeinterface #114,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createSecureId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     642: putfield      #115                // Field keyInfoUri:Ljava/lang/String;
     645: new           #116                // class org/apache/wss4j/common/token/SecurityTokenReference
     648: dup
     649: aload_1
     650: invokespecial #117                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     653: astore        12
     655: aload_0
     656: aload_0
     657: invokevirtual #111                // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     660: ldc           #118                // String STRId-
     662: aload         12
     664: invokeinterface #114,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createSecureId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     669: putfield      #18                 // Field strUri:Ljava/lang/String;
     672: aload         12
     674: aload_0
     675: getfield      #18                 // Field strUri:Ljava/lang/String;
     678: invokevirtual #119                // Method org/apache/wss4j/common/token/SecurityTokenReference.setID:(Ljava/lang/String;)V
     681: aload_0
     682: aload         12
     684: invokevirtual #120                // Method setSecurityTokenReference:(Lorg/apache/wss4j/common/token/SecurityTokenReference;)V
     687: aload         10
     689: ifnull        717
     692: aload         10
     694: arraylength
     695: ifeq          717
     698: aload_0
     699: aload_0
     700: invokevirtual #111                // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     703: ldc           #121                // String CertId-
     705: aload         10
     707: iconst_0
     708: aaload
     709: invokeinterface #114,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createSecureId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     714: putfield      #122                // Field certUri:Ljava/lang/String;
     717: aload_0
     718: getfield      #27                 // Field senderVouches:Z
     721: ifeq          986
     724: aload_0
     725: new           #116                // class org/apache/wss4j/common/token/SecurityTokenReference
     728: dup
     729: aload_1
     730: invokespecial #117                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     733: putfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     736: aload_0
     737: aload_0
     738: invokevirtual #111                // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     741: ldc           #123                // String STRSAMLId-
     743: aload_0
     744: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     747: invokeinterface #114,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createSecureId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     752: putfield      #20                 // Field secRefID:Ljava/lang/String;
     755: aload_0
     756: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     759: aload_0
     760: getfield      #20                 // Field secRefID:Ljava/lang/String;
     763: invokevirtual #119                // Method org/apache/wss4j/common/token/SecurityTokenReference.setID:(Ljava/lang/String;)V
     766: aload_0
     767: getfield      #124                // Field useDirectReferenceToAssertion:Z
     770: ifeq          864
     773: new           #125                // class org/apache/wss4j/common/token/Reference
     776: dup
     777: aload_1
     778: invokespecial #126                // Method org/apache/wss4j/common/token/Reference."<init>":(Lorg/w3c/dom/Document;)V
     781: astore        13
     783: aload         13
     785: new           #83                 // class java/lang/StringBuilder
     788: dup
     789: invokespecial #84                 // Method java/lang/StringBuilder."<init>":()V
     792: ldc           #127                // String #
     794: invokevirtual #86                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     797: aload_3
     798: invokevirtual #128                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getId:()Ljava/lang/String;
     801: invokevirtual #86                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     804: invokevirtual #87                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     807: invokevirtual #129                // Method org/apache/wss4j/common/token/Reference.setURI:(Ljava/lang/String;)V
     810: aload_3
     811: invokevirtual #130                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml1:()Lorg/opensaml/saml/saml1/core/Assertion;
     814: ifnull        836
     817: aload         13
     819: ldc           #131                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     821: invokevirtual #132                // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
     824: aload_0
     825: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     828: ldc           #133                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     830: invokevirtual #134                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     833: goto          852
     836: aload_3
     837: invokevirtual #135                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml2:()Lorg/opensaml/saml/saml2/core/Assertion;
     840: ifnull        852
     843: aload_0
     844: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     847: ldc           #136                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     849: invokevirtual #134                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     852: aload_0
     853: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     856: aload         13
     858: invokevirtual #137                // Method org/apache/wss4j/common/token/SecurityTokenReference.setReference:(Lorg/apache/wss4j/common/token/Reference;)V
     861: goto          971
     864: aload_1
     865: ldc           #138                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
     867: ldc           #139                // String wsse:KeyIdentifier
     869: invokeinterface #140,  3          // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     874: astore        13
     876: aconst_null
     877: astore        14
     879: aload_3
     880: invokevirtual #130                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml1:()Lorg/opensaml/saml/saml1/core/Assertion;
     883: ifnull        902
     886: ldc           #131                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     888: astore        14
     890: aload_0
     891: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     894: ldc           #133                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     896: invokevirtual #134                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     899: goto          922
     902: aload_3
     903: invokevirtual #135                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml2:()Lorg/opensaml/saml/saml2/core/Assertion;
     906: ifnull        922
     909: ldc           #141                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     911: astore        14
     913: aload_0
     914: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     917: ldc           #136                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     919: invokevirtual #134                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     922: aload         13
     924: aconst_null
     925: ldc           #142                // String ValueType
     927: aload         14
     929: invokeinterface #143,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     934: aload         13
     936: aload_1
     937: aload_3
     938: invokevirtual #128                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getId:()Ljava/lang/String;
     941: invokeinterface #144,  2          // InterfaceMethod org/w3c/dom/Document.createTextNode:(Ljava/lang/String;)Lorg/w3c/dom/Text;
     946: invokeinterface #145,  2          // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     951: pop
     952: aload_0
     953: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     956: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     959: astore        15
     961: aload         15
     963: aload         13
     965: invokeinterface #145,  2          // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     970: pop
     971: aload_0
     972: getfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     975: aload_0
     976: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
     979: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     982: iconst_0
     983: invokevirtual #146                // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;Z)V
     986: goto          1006
     989: astore        13
     991: new           #57                 // class org/apache/wss4j/common/ext/WSSecurityException
     994: dup
     995: getstatic     #108                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_SIGNATURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     998: aload         13
    1000: ldc           #109                // String noXMLSig
    1002: invokespecial #110                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;Ljava/lang/String;)V
    1005: athrow
    1006: aload_0
    1007: getfield      #27                 // Field senderVouches:Z
    1010: ifeq          1304
    1013: aload_0
    1014: getfield      #147                // Field keyIdentifierType:I
    1017: tableswitch   { // 1 to 8
                     1: 1064
                     2: 1220
                     3: 1173
                     4: 1185
                     5: 1288
                     6: 1288
                     7: 1288
                     8: 1208
               default: 1288
          }
    1064: new           #125                // class org/apache/wss4j/common/token/Reference
    1067: dup
    1068: aload_1
    1069: invokespecial #126                // Method org/apache/wss4j/common/token/Reference."<init>":(Lorg/w3c/dom/Document;)V
    1072: astore        13
    1074: aload         13
    1076: new           #83                 // class java/lang/StringBuilder
    1079: dup
    1080: invokespecial #84                 // Method java/lang/StringBuilder."<init>":()V
    1083: ldc           #127                // String #
    1085: invokevirtual #86                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1088: aload_0
    1089: getfield      #122                // Field certUri:Ljava/lang/String;
    1092: invokevirtual #86                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1095: invokevirtual #87                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1098: invokevirtual #129                // Method org/apache/wss4j/common/token/Reference.setURI:(Ljava/lang/String;)V
    1101: new           #148                // class org/apache/wss4j/common/token/X509Security
    1104: dup
    1105: aload_1
    1106: invokespecial #149                // Method org/apache/wss4j/common/token/X509Security."<init>":(Lorg/w3c/dom/Document;)V
    1109: astore        14
    1111: aload         14
    1113: checkcast     #148                // class org/apache/wss4j/common/token/X509Security
    1116: aload         10
    1118: iconst_0
    1119: aaload
    1120: invokevirtual #150                // Method org/apache/wss4j/common/token/X509Security.setX509Certificate:(Ljava/security/cert/X509Certificate;)V
    1123: aload         14
    1125: aload_0
    1126: getfield      #122                // Field certUri:Ljava/lang/String;
    1129: invokevirtual #151                // Method org/apache/wss4j/common/token/BinarySecurity.setID:(Ljava/lang/String;)V
    1132: aload_0
    1133: aload         14
    1135: invokevirtual #152                // Method org/apache/wss4j/common/token/BinarySecurity.getElement:()Lorg/w3c/dom/Element;
    1138: putfield      #32                 // Field bstToken:Lorg/w3c/dom/Element;
    1141: aload_0
    1142: getfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
    1145: aload_0
    1146: getfield      #32                 // Field bstToken:Lorg/w3c/dom/Element;
    1149: iconst_0
    1150: invokevirtual #146                // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;Z)V
    1153: aload         13
    1155: aload         14
    1157: invokevirtual #153                // Method org/apache/wss4j/common/token/BinarySecurity.getValueType:()Ljava/lang/String;
    1160: invokevirtual #132                // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
    1163: aload         12
    1165: aload         13
    1167: invokevirtual #137                // Method org/apache/wss4j/common/token/SecurityTokenReference.setReference:(Lorg/apache/wss4j/common/token/Reference;)V
    1170: goto          1301
    1173: aload         12
    1175: aload         10
    1177: iconst_0
    1178: aaload
    1179: invokevirtual #154                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/security/cert/X509Certificate;)V
    1182: goto          1301
    1185: aload         12
    1187: aload         10
    1189: iconst_0
    1190: aaload
    1191: aload         4
    1193: ifnull        1201
    1196: aload         4
    1198: goto          1202
    1201: aload_2
    1202: invokevirtual #155                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierSKI:(Ljava/security/cert/X509Certificate;Lorg/apache/wss4j/common/crypto/Crypto;)V
    1205: goto          1301
    1208: aload         12
    1210: aload         10
    1212: iconst_0
    1213: aaload
    1214: invokevirtual #156                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierThumb:(Ljava/security/cert/X509Certificate;)V
    1217: goto          1301
    1220: aload         10
    1222: iconst_0
    1223: aaload
    1224: invokevirtual #157                // Method java/security/cert/X509Certificate.getIssuerDN:()Ljava/security/Principal;
    1227: invokeinterface #158,  1          // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
    1232: astore        15
    1234: aload         10
    1236: iconst_0
    1237: aaload
    1238: invokevirtual #159                // Method java/security/cert/X509Certificate.getSerialNumber:()Ljava/math/BigInteger;
    1241: astore        16
    1243: new           #160                // class org/apache/wss4j/common/token/DOMX509IssuerSerial
    1246: dup
    1247: aload_0
    1248: getfield      #38                 // Field document:Lorg/w3c/dom/Document;
    1251: aload         15
    1253: aload         16
    1255: invokespecial #161                // Method org/apache/wss4j/common/token/DOMX509IssuerSerial."<init>":(Lorg/w3c/dom/Document;Ljava/lang/String;Ljava/math/BigInteger;)V
    1258: astore        17
    1260: new           #162                // class org/apache/wss4j/common/token/DOMX509Data
    1263: dup
    1264: aload_0
    1265: getfield      #38                 // Field document:Lorg/w3c/dom/Document;
    1268: aload         17
    1270: invokespecial #163                // Method org/apache/wss4j/common/token/DOMX509Data."<init>":(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/token/DOMX509IssuerSerial;)V
    1273: astore        18
    1275: aload         12
    1277: aload         18
    1279: invokevirtual #164                // Method org/apache/wss4j/common/token/DOMX509Data.getElement:()Lorg/w3c/dom/Element;
    1282: invokevirtual #165                // Method org/apache/wss4j/common/token/SecurityTokenReference.setUnknownElement:(Lorg/w3c/dom/Element;)V
    1285: goto          1301
    1288: new           #57                 // class org/apache/wss4j/common/ext/WSSecurityException
    1291: dup
    1292: getstatic     #58                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
    1295: ldc           #166                // String unsupportedKeyId
    1297: invokespecial #81                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
    1300: athrow
    1301: goto          1497
    1304: aload_0
    1305: getfield      #124                // Field useDirectReferenceToAssertion:Z
    1308: ifeq          1396
    1311: new           #125                // class org/apache/wss4j/common/token/Reference
    1314: dup
    1315: aload_1
    1316: invokespecial #126                // Method org/apache/wss4j/common/token/Reference."<init>":(Lorg/w3c/dom/Document;)V
    1319: astore        13
    1321: aload         13
    1323: new           #83                 // class java/lang/StringBuilder
    1326: dup
    1327: invokespecial #84                 // Method java/lang/StringBuilder."<init>":()V
    1330: ldc           #127                // String #
    1332: invokevirtual #86                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1335: aload_3
    1336: invokevirtual #128                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getId:()Ljava/lang/String;
    1339: invokevirtual #86                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    1342: invokevirtual #87                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    1345: invokevirtual #129                // Method org/apache/wss4j/common/token/Reference.setURI:(Ljava/lang/String;)V
    1348: aload_3
    1349: invokevirtual #130                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml1:()Lorg/opensaml/saml/saml1/core/Assertion;
    1352: ifnull        1372
    1355: aload         13
    1357: ldc           #131                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
    1359: invokevirtual #132                // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
    1362: aload         12
    1364: ldc           #133                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
    1366: invokevirtual #134                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
    1369: goto          1386
    1372: aload_3
    1373: invokevirtual #135                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml2:()Lorg/opensaml/saml/saml2/core/Assertion;
    1376: ifnull        1386
    1379: aload         12
    1381: ldc           #136                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    1383: invokevirtual #134                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
    1386: aload         12
    1388: aload         13
    1390: invokevirtual #137                // Method org/apache/wss4j/common/token/SecurityTokenReference.setReference:(Lorg/apache/wss4j/common/token/Reference;)V
    1393: goto          1497
    1396: aload_1
    1397: ldc           #138                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
    1399: ldc           #139                // String wsse:KeyIdentifier
    1401: invokeinterface #140,  3          // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
    1406: astore        13
    1408: aconst_null
    1409: astore        14
    1411: aload_3
    1412: invokevirtual #130                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml1:()Lorg/opensaml/saml/saml1/core/Assertion;
    1415: ifnull        1432
    1418: ldc           #131                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
    1420: astore        14
    1422: aload         12
    1424: ldc           #133                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
    1426: invokevirtual #134                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
    1429: goto          1450
    1432: aload_3
    1433: invokevirtual #135                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml2:()Lorg/opensaml/saml/saml2/core/Assertion;
    1436: ifnull        1450
    1439: ldc           #141                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
    1441: astore        14
    1443: aload         12
    1445: ldc           #136                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
    1447: invokevirtual #134                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
    1450: aload         13
    1452: aconst_null
    1453: ldc           #142                // String ValueType
    1455: aload         14
    1457: invokeinterface #143,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
    1462: aload         13
    1464: aload_1
    1465: aload_3
    1466: invokevirtual #128                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getId:()Ljava/lang/String;
    1469: invokeinterface #144,  2          // InterfaceMethod org/w3c/dom/Document.createTextNode:(Ljava/lang/String;)Lorg/w3c/dom/Text;
    1474: invokeinterface #145,  2          // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
    1479: pop
    1480: aload         12
    1482: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
    1485: astore        15
    1487: aload         15
    1489: aload         13
    1491: invokeinterface #145,  2          // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
    1496: pop
    1497: new           #167                // class javax/xml/crypto/dom/DOMStructure
    1500: dup
    1501: aload         12
    1503: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
    1506: invokespecial #168                // Method javax/xml/crypto/dom/DOMStructure."<init>":(Lorg/w3c/dom/Node;)V
    1509: astore        13
    1511: aload_0
    1512: getfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
    1515: aload         12
    1517: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
    1520: iconst_0
    1521: invokevirtual #146                // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;Z)V
    1524: aload_0
    1525: getfield      #102                // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
    1528: invokevirtual #169                // Method javax/xml/crypto/dsig/XMLSignatureFactory.getKeyInfoFactory:()Ljavax/xml/crypto/dsig/keyinfo/KeyInfoFactory;
    1531: astore        14
    1533: aload_0
    1534: aload         14
    1536: aload         13
    1538: invokestatic  #170                // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
    1541: aload_0
    1542: getfield      #115                // Field keyInfoUri:Ljava/lang/String;
    1545: invokevirtual #171                // Method javax/xml/crypto/dsig/keyinfo/KeyInfoFactory.newKeyInfo:(Ljava/util/List;Ljava/lang/String;)Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
    1548: putfield      #113                // Field keyInfo:Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
    1551: aload_0
    1552: getfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
    1555: aload_0
    1556: getfield      #31                 // Field samlToken:Lorg/w3c/dom/Element;
    1559: iconst_0
    1560: invokevirtual #146                // Method org/apache/wss4j/dom/WSDocInfo.addTokenElement:(Lorg/w3c/dom/Element;Z)V
    1563: return
    Exception table:
       from    to  target type
         532   594   597   Class java/lang/Exception
         717   986   989   Class java/lang/Exception

  public void prependSAMLElementsToHeader(org.apache.wss4j.dom.message.WSSecHeader);
    Code:
       0: aload_0
       1: getfield      #27                 // Field senderVouches:Z
       4: ifeq          22
       7: aload_1
       8: invokevirtual #98                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      11: aload_0
      12: getfield      #28                 // Field secRefSaml:Lorg/apache/wss4j/common/token/SecurityTokenReference;
      15: invokevirtual #29                 // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
      18: invokestatic  #172                // Method org/apache/wss4j/dom/util/WSSecurityUtil.prependChildElement:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      21: pop
      22: aload_1
      23: invokevirtual #98                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      26: aload_0
      27: getfield      #31                 // Field samlToken:Lorg/w3c/dom/Element;
      30: invokestatic  #172                // Method org/apache/wss4j/dom/util/WSSecurityUtil.prependChildElement:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      33: pop
      34: return

  public void computeSignature(java.util.List<javax.xml.crypto.dsig.Reference>, org.apache.wss4j.dom.message.WSSecHeader, org.w3c.dom.Element) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #27                 // Field senderVouches:Z
       4: ifeq          29
       7: aload_0
       8: getfield      #37                 // Field issuerCrypto:Lorg/apache/wss4j/common/crypto/Crypto;
      11: aload_0
      12: getfield      #39                 // Field issuerKeyName:Ljava/lang/String;
      15: aload_0
      16: getfield      #40                 // Field issuerKeyPW:Ljava/lang/String;
      19: invokeinterface #173,  3          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getPrivateKey:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/PrivateKey;
      24: astore        4
      26: goto          71
      29: aload_0
      30: getfield      #63                 // Field secretKey:[B
      33: ifnull        52
      36: aload_0
      37: invokevirtual #78                 // Method getSignatureAlgorithm:()Ljava/lang/String;
      40: aload_0
      41: getfield      #63                 // Field secretKey:[B
      44: invokestatic  #174                // Method org/apache/wss4j/common/util/KeyUtils.prepareSecretKey:(Ljava/lang/String;[B)Ljavax/crypto/SecretKey;
      47: astore        4
      49: goto          71
      52: aload_0
      53: getfield      #36                 // Field userCrypto:Lorg/apache/wss4j/common/crypto/Crypto;
      56: aload_0
      57: getfield      #175                // Field user:Ljava/lang/String;
      60: aload_0
      61: getfield      #176                // Field password:Ljava/lang/String;
      64: invokeinterface #173,  3          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getPrivateKey:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/PrivateKey;
      69: astore        4
      71: aload_0
      72: getfield      #102                // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      75: aload_0
      76: invokevirtual #78                 // Method getSignatureAlgorithm:()Ljava/lang/String;
      79: aconst_null
      80: invokevirtual #177                // Method javax/xml/crypto/dsig/XMLSignatureFactory.newSignatureMethod:(Ljava/lang/String;Ljavax/xml/crypto/dsig/spec/SignatureMethodParameterSpec;)Ljavax/xml/crypto/dsig/SignatureMethod;
      83: astore        5
      85: aload_0
      86: getfield      #102                // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
      89: aload_0
      90: getfield      #104                // Field c14nMethod:Ljavax/xml/crypto/dsig/CanonicalizationMethod;
      93: aload         5
      95: aload_1
      96: invokevirtual #178                // Method javax/xml/crypto/dsig/XMLSignatureFactory.newSignedInfo:(Ljavax/xml/crypto/dsig/CanonicalizationMethod;Ljavax/xml/crypto/dsig/SignatureMethod;Ljava/util/List;)Ljavax/xml/crypto/dsig/SignedInfo;
      99: astore        6
     101: aload_0
     102: aload_0
     103: getfield      #102                // Field signatureFactory:Ljavax/xml/crypto/dsig/XMLSignatureFactory;
     106: aload         6
     108: aload_0
     109: getfield      #113                // Field keyInfo:Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;
     112: aconst_null
     113: aload_0
     114: invokevirtual #111                // Method getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     117: ldc           #179                // String SIG-
     119: aconst_null
     120: invokeinterface #180,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     125: aconst_null
     126: invokevirtual #181                // Method javax/xml/crypto/dsig/XMLSignatureFactory.newXMLSignature:(Ljavax/xml/crypto/dsig/SignedInfo;Ljavax/xml/crypto/dsig/keyinfo/KeyInfo;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;)Ljavax/xml/crypto/dsig/XMLSignature;
     129: putfield      #94                 // Field sig:Ljavax/xml/crypto/dsig/XMLSignature;
     132: aload_2
     133: invokevirtual #98                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     136: astore        7
     138: aconst_null
     139: astore        8
     141: aload_3
     142: ifnull        176
     145: aload_3
     146: invokeinterface #182,  1          // InterfaceMethod org/w3c/dom/Element.getNextSibling:()Lorg/w3c/dom/Node;
     151: ifnull        176
     154: new           #183                // class javax/xml/crypto/dsig/dom/DOMSignContext
     157: dup
     158: aload         4
     160: aload         7
     162: aload_3
     163: invokeinterface #182,  1          // InterfaceMethod org/w3c/dom/Element.getNextSibling:()Lorg/w3c/dom/Node;
     168: invokespecial #184                // Method javax/xml/crypto/dsig/dom/DOMSignContext."<init>":(Ljava/security/Key;Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)V
     171: astore        8
     173: goto          189
     176: new           #183                // class javax/xml/crypto/dsig/dom/DOMSignContext
     179: dup
     180: aload         4
     182: aload         7
     184: invokespecial #185                // Method javax/xml/crypto/dsig/dom/DOMSignContext."<init>":(Ljava/security/Key;Lorg/w3c/dom/Node;)V
     187: astore        8
     189: aload         8
     191: ldc           #186                // String http://www.w3.org/2000/09/xmldsig#
     193: ldc           #187                // String ds
     195: invokeinterface #188,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLSignContext.putNamespacePrefix:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     200: pop
     201: ldc           #97                 // String http://www.w3.org/2001/10/xml-exc-c14n#
     203: aload_0
     204: invokevirtual #96                 // Method getSigCanonicalization:()Ljava/lang/String;
     207: invokevirtual #16                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     210: ifeq          225
     213: aload         8
     215: ldc           #97                 // String http://www.w3.org/2001/10/xml-exc-c14n#
     217: ldc           #189                // String ec
     219: invokeinterface #188,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLSignContext.putNamespacePrefix:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     224: pop
     225: aload         8
     227: ldc           #190                // String transform_ws_doc_info
     229: aload_0
     230: getfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     233: invokeinterface #191,  3          // InterfaceMethod javax/xml/crypto/dsig/XMLSignContext.setProperty:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     238: pop
     239: aload_0
     240: getfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     243: aload_0
     244: getfield      #192                // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
     247: invokevirtual #193                // Method org/apache/wss4j/dom/WSDocInfo.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
     250: aload_0
     251: getfield      #49                 // Field wsDocInfo:Lorg/apache/wss4j/dom/WSDocInfo;
     254: aload         8
     256: checkcast     #183                // class javax/xml/crypto/dsig/dom/DOMSignContext
     259: invokevirtual #194                // Method org/apache/wss4j/dom/WSDocInfo.setTokensOnContext:(Ljavax/xml/crypto/dom/DOMCryptoContext;)V
     262: aload_0
     263: getfield      #94                 // Field sig:Ljavax/xml/crypto/dsig/XMLSignature;
     266: aload         8
     268: invokeinterface #195,  2          // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.sign:(Ljavax/xml/crypto/dsig/XMLSignContext;)V
     273: aload_0
     274: aload_0
     275: getfield      #94                 // Field sig:Ljavax/xml/crypto/dsig/XMLSignature;
     278: invokeinterface #196,  1          // InterfaceMethod javax/xml/crypto/dsig/XMLSignature.getSignatureValue:()Ljavax/xml/crypto/dsig/XMLSignature$SignatureValue;
     283: invokeinterface #197,  1          // InterfaceMethod javax/xml/crypto/dsig/XMLSignature$SignatureValue.getValue:()[B
     288: putfield      #198                // Field signatureValue:[B
     291: goto          324
     294: astore        4
     296: getstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
     299: aload         4
     301: invokevirtual #199                // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     304: aload         4
     306: invokeinterface #107,  3          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     311: new           #57                 // class org/apache/wss4j/common/ext/WSSecurityException
     314: dup
     315: getstatic     #108                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_SIGNATURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     318: aload         4
     320: invokespecial #200                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     323: athrow
     324: return
    Exception table:
       from    to  target type
           0   291   294   Class java/lang/Exception

  public boolean isUseDirectReferenceToAssertion();
    Code:
       0: aload_0
       1: getfield      #124                // Field useDirectReferenceToAssertion:Z
       4: ireturn

  public void setUseDirectReferenceToAssertion(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #124                // Field useDirectReferenceToAssertion:Z
       5: return

  static {};
    Code:
       0: ldc_w         #201                // class org/apache/wss4j/dom/saml/WSSecSignatureSAML
       3: invokestatic  #202                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #2                  // Field LOG:Lorg/slf4j/Logger;
       9: return
}
