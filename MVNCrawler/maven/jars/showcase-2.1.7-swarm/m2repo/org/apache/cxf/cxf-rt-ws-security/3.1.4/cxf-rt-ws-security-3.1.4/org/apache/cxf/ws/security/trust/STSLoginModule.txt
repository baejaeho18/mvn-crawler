Compiled from "STSLoginModule.java"
public class org.apache.cxf.ws.security.trust.STSLoginModule implements javax.security.auth.spi.LoginModule {
  public static final java.lang.String REQUIRE_ROLES;

  public static final java.lang.String DISABLE_ON_BEHALF_OF;

  public static final java.lang.String DISABLE_CACHING;

  public static final java.lang.String WSDL_LOCATION;

  public static final java.lang.String SERVICE_NAME;

  public static final java.lang.String ENDPOINT_NAME;

  public static final java.lang.String KEY_SIZE;

  public static final java.lang.String KEY_TYPE;

  public static final java.lang.String TOKEN_TYPE;

  public static final java.lang.String WS_TRUST_NAMESPACE;

  public static final java.lang.String CXF_SPRING_CFG;

  private static final java.util.logging.Logger LOG;

  private static final java.lang.String TOKEN_STORE_KEY;

  private java.util.Set<java.security.Principal> roles;

  private java.security.Principal userPrincipal;

  private javax.security.auth.Subject subject;

  private javax.security.auth.callback.CallbackHandler callbackHandler;

  private boolean requireRoles;

  private boolean disableOnBehalfOf;

  private boolean disableCaching;

  private java.lang.String wsdlLocation;

  private java.lang.String serviceName;

  private java.lang.String endpointName;

  private java.lang.String cxfSpringCfg;

  private int keySize;

  private java.lang.String keyType;

  private java.lang.String tokenType;

  private java.lang.String namespace;

  private java.util.Map<java.lang.String, java.lang.Object> stsClientProperties;

  public org.apache.cxf.ws.security.trust.STSLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/HashSet
       8: dup
       9: invokespecial #3                  // Method java/util/HashSet."<init>":()V
      12: putfield      #4                  // Field roles:Ljava/util/Set;
      15: aload_0
      16: ldc           #5                  // String http://docs.oasis-open.org/ws-sx/ws-trust/200512/Bearer
      18: putfield      #6                  // Field keyType:Ljava/lang/String;
      21: aload_0
      22: ldc           #7                  // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
      24: putfield      #8                  // Field tokenType:Ljava/lang/String;
      27: aload_0
      28: new           #9                  // class java/util/HashMap
      31: dup
      32: invokespecial #10                 // Method java/util/HashMap."<init>":()V
      35: putfield      #11                 // Field stsClientProperties:Ljava/util/Map;
      38: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map<java.lang.String, ?>, java.util.Map<java.lang.String, ?>);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #12                 // Field subject:Ljavax/security/auth/Subject;
       5: aload_0
       6: aload_2
       7: putfield      #13                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      10: aload         4
      12: ldc           #14                 // String require.roles
      14: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
      19: ifeq          41
      22: aload_0
      23: aload         4
      25: ldc           #14                 // String require.roles
      27: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      32: checkcast     #17                 // class java/lang/String
      35: invokestatic  #18                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
      38: putfield      #19                 // Field requireRoles:Z
      41: aload         4
      43: ldc           #20                 // String disable.on.behalf.of
      45: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
      50: ifeq          72
      53: aload_0
      54: aload         4
      56: ldc           #20                 // String disable.on.behalf.of
      58: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      63: checkcast     #17                 // class java/lang/String
      66: invokestatic  #18                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
      69: putfield      #21                 // Field disableOnBehalfOf:Z
      72: aload         4
      74: ldc           #22                 // String disable.caching
      76: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
      81: ifeq          103
      84: aload_0
      85: aload         4
      87: ldc           #22                 // String disable.caching
      89: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      94: checkcast     #17                 // class java/lang/String
      97: invokestatic  #18                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
     100: putfield      #23                 // Field disableCaching:Z
     103: aload         4
     105: ldc           #24                 // String wsdl.location
     107: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     112: ifeq          131
     115: aload_0
     116: aload         4
     118: ldc           #24                 // String wsdl.location
     120: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     125: checkcast     #17                 // class java/lang/String
     128: putfield      #25                 // Field wsdlLocation:Ljava/lang/String;
     131: aload         4
     133: ldc           #26                 // String service.name
     135: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     140: ifeq          159
     143: aload_0
     144: aload         4
     146: ldc           #26                 // String service.name
     148: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     153: checkcast     #17                 // class java/lang/String
     156: putfield      #27                 // Field serviceName:Ljava/lang/String;
     159: aload         4
     161: ldc           #28                 // String endpoint.name
     163: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     168: ifeq          187
     171: aload_0
     172: aload         4
     174: ldc           #28                 // String endpoint.name
     176: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     181: checkcast     #17                 // class java/lang/String
     184: putfield      #29                 // Field endpointName:Ljava/lang/String;
     187: aload         4
     189: ldc           #30                 // String key.size
     191: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     196: ifeq          218
     199: aload_0
     200: aload         4
     202: ldc           #30                 // String key.size
     204: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     209: checkcast     #17                 // class java/lang/String
     212: invokestatic  #31                 // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
     215: putfield      #32                 // Field keySize:I
     218: aload         4
     220: ldc           #33                 // String key.type
     222: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     227: ifeq          246
     230: aload_0
     231: aload         4
     233: ldc           #33                 // String key.type
     235: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     240: checkcast     #17                 // class java/lang/String
     243: putfield      #6                  // Field keyType:Ljava/lang/String;
     246: aload         4
     248: ldc           #34                 // String token.type
     250: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     255: ifeq          274
     258: aload_0
     259: aload         4
     261: ldc           #34                 // String token.type
     263: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     268: checkcast     #17                 // class java/lang/String
     271: putfield      #8                  // Field tokenType:Ljava/lang/String;
     274: aload         4
     276: ldc           #35                 // String ws.trust.namespace
     278: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     283: ifeq          302
     286: aload_0
     287: aload         4
     289: ldc           #35                 // String ws.trust.namespace
     291: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     296: checkcast     #17                 // class java/lang/String
     299: putfield      #36                 // Field namespace:Ljava/lang/String;
     302: aload         4
     304: ldc           #37                 // String cxf.spring.config
     306: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     311: ifeq          330
     314: aload_0
     315: aload         4
     317: ldc           #37                 // String cxf.spring.config
     319: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     324: checkcast     #17                 // class java/lang/String
     327: putfield      #38                 // Field cxfSpringCfg:Ljava/lang/String;
     330: aload_0
     331: getfield      #11                 // Field stsClientProperties:Ljava/util/Map;
     334: invokeinterface #39,  1           // InterfaceMethod java/util/Map.clear:()V
     339: getstatic     #40                 // Field org/apache/cxf/ws/security/SecurityConstants.ALL_PROPERTIES:Ljava/util/Set;
     342: invokeinterface #41,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     347: astore        5
     349: aload         5
     351: invokeinterface #42,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     356: ifeq          407
     359: aload         5
     361: invokeinterface #43,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     366: checkcast     #17                 // class java/lang/String
     369: astore        6
     371: aload         4
     373: aload         6
     375: invokeinterface #15,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     380: ifeq          404
     383: aload_0
     384: getfield      #11                 // Field stsClientProperties:Ljava/util/Map;
     387: aload         6
     389: aload         4
     391: aload         6
     393: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     398: invokeinterface #44,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     403: pop
     404: goto          349
     407: return

  public boolean login() throws javax.security.auth.login.LoginException;
    Code:
       0: iconst_2
       1: anewarray     #45                 // class javax/security/auth/callback/Callback
       4: astore_1
       5: aload_1
       6: iconst_0
       7: new           #46                 // class javax/security/auth/callback/NameCallback
      10: dup
      11: ldc           #47                 // String Username:
      13: invokespecial #48                 // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;)V
      16: aastore
      17: aload_1
      18: iconst_1
      19: new           #49                 // class javax/security/auth/callback/PasswordCallback
      22: dup
      23: ldc           #50                 // String Password:
      25: iconst_0
      26: invokespecial #51                 // Method javax/security/auth/callback/PasswordCallback."<init>":(Ljava/lang/String;Z)V
      29: aastore
      30: aload_0
      31: getfield      #13                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      34: aload_1
      35: invokeinterface #52,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      40: goto          87
      43: astore_2
      44: new           #54                 // class javax/security/auth/login/LoginException
      47: dup
      48: aload_2
      49: invokevirtual #55                 // Method java/io/IOException.getMessage:()Ljava/lang/String;
      52: invokespecial #56                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      55: athrow
      56: astore_2
      57: new           #54                 // class javax/security/auth/login/LoginException
      60: dup
      61: new           #58                 // class java/lang/StringBuilder
      64: dup
      65: invokespecial #59                 // Method java/lang/StringBuilder."<init>":()V
      68: aload_2
      69: invokevirtual #60                 // Method javax/security/auth/callback/UnsupportedCallbackException.getMessage:()Ljava/lang/String;
      72: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      75: ldc           #62                 // String  not available to obtain information from user.
      77: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      80: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      83: invokespecial #56                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      86: athrow
      87: aload_1
      88: iconst_0
      89: aaload
      90: checkcast     #46                 // class javax/security/auth/callback/NameCallback
      93: invokevirtual #64                 // Method javax/security/auth/callback/NameCallback.getName:()Ljava/lang/String;
      96: astore_2
      97: aload_1
      98: iconst_1
      99: aaload
     100: checkcast     #49                 // class javax/security/auth/callback/PasswordCallback
     103: invokevirtual #65                 // Method javax/security/auth/callback/PasswordCallback.getPassword:()[C
     106: astore_3
     107: aload_3
     108: ifnonnull     115
     111: iconst_0
     112: newarray       char
     114: astore_3
     115: new           #17                 // class java/lang/String
     118: dup
     119: aload_3
     120: invokespecial #66                 // Method java/lang/String."<init>":([C)V
     123: astore        4
     125: aload_0
     126: new           #2                  // class java/util/HashSet
     129: dup
     130: invokespecial #3                  // Method java/util/HashSet."<init>":()V
     133: putfield      #4                  // Field roles:Ljava/util/Set;
     136: aload_0
     137: aconst_null
     138: putfield      #67                 // Field userPrincipal:Ljava/security/Principal;
     141: new           #68                 // class org/apache/cxf/ws/security/trust/STSTokenValidator
     144: dup
     145: iconst_1
     146: invokespecial #69                 // Method org/apache/cxf/ws/security/trust/STSTokenValidator."<init>":(Z)V
     149: astore        5
     151: aload         5
     153: aload_0
     154: getfield      #19                 // Field requireRoles:Z
     157: invokevirtual #70                 // Method org/apache/cxf/ws/security/trust/STSTokenValidator.setUseIssueBinding:(Z)V
     160: aload         5
     162: aload_0
     163: getfield      #21                 // Field disableOnBehalfOf:Z
     166: ifne          173
     169: iconst_1
     170: goto          174
     173: iconst_0
     174: invokevirtual #71                 // Method org/apache/cxf/ws/security/trust/STSTokenValidator.setUseOnBehalfOf:(Z)V
     177: aload         5
     179: aload_0
     180: getfield      #19                 // Field requireRoles:Z
     183: ifeq          193
     186: aload_0
     187: getfield      #23                 // Field disableCaching:Z
     190: ifeq          197
     193: iconst_1
     194: goto          198
     197: iconst_0
     198: invokevirtual #72                 // Method org/apache/cxf/ws/security/trust/STSTokenValidator.setDisableCaching:(Z)V
     201: aload_0
     202: aload_2
     203: aload         4
     205: invokespecial #73                 // Method convertToToken:(Ljava/lang/String;Ljava/lang/String;)Lorg/apache/wss4j/dom/message/token/UsernameToken;
     208: astore        6
     210: new           #74                 // class org/apache/wss4j/dom/validate/Credential
     213: dup
     214: invokespecial #75                 // Method org/apache/wss4j/dom/validate/Credential."<init>":()V
     217: astore        7
     219: aload         7
     221: aload         6
     223: invokevirtual #76                 // Method org/apache/wss4j/dom/validate/Credential.setUsernametoken:(Lorg/apache/wss4j/dom/message/token/UsernameToken;)V
     226: new           #77                 // class org/apache/wss4j/dom/handler/RequestData
     229: dup
     230: invokespecial #78                 // Method org/apache/wss4j/dom/handler/RequestData."<init>":()V
     233: astore        8
     235: invokestatic  #79                 // Method org/apache/cxf/phase/PhaseInterceptorChain.getCurrentMessage:()Lorg/apache/cxf/message/Message;
     238: astore        9
     240: aload_0
     241: aload         9
     243: invokespecial #80                 // Method configureSTSClient:(Lorg/apache/cxf/message/Message;)Lorg/apache/cxf/ws/security/trust/STSClient;
     246: astore        10
     248: aload         9
     250: ifnull        275
     253: aload         9
     255: ldc           #81                 // String security.sts.client
     257: aload         10
     259: invokeinterface #82,  3           // InterfaceMethod org/apache/cxf/message/Message.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     264: pop
     265: aload         8
     267: aload         9
     269: invokevirtual #83                 // Method org/apache/wss4j/dom/handler/RequestData.setMsgContext:(Ljava/lang/Object;)V
     272: goto          295
     275: aload_0
     276: invokespecial #84                 // Method configureTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     279: astore        11
     281: aload         5
     283: aload         10
     285: invokevirtual #85                 // Method org/apache/cxf/ws/security/trust/STSTokenValidator.setStsClient:(Lorg/apache/cxf/ws/security/trust/STSClient;)V
     288: aload         5
     290: aload         11
     292: invokevirtual #86                 // Method org/apache/cxf/ws/security/trust/STSTokenValidator.setTokenStore:(Lorg/apache/cxf/ws/security/tokenstore/TokenStore;)V
     295: aload         5
     297: aload         7
     299: aload         8
     301: invokevirtual #87                 // Method org/apache/cxf/ws/security/trust/STSTokenValidator.validate:(Lorg/apache/wss4j/dom/validate/Credential;Lorg/apache/wss4j/dom/handler/RequestData;)Lorg/apache/wss4j/dom/validate/Credential;
     304: astore        7
     306: aload_0
     307: new           #88                 // class org/apache/cxf/common/security/SimplePrincipal
     310: dup
     311: aload_2
     312: invokespecial #89                 // Method org/apache/cxf/common/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
     315: putfield      #67                 // Field userPrincipal:Ljava/security/Principal;
     318: aload_0
     319: getfield      #4                  // Field roles:Ljava/util/Set;
     322: aload_0
     323: aload         9
     325: aload         7
     327: invokespecial #90                 // Method getRoles:(Lorg/apache/cxf/message/Message;Lorg/apache/wss4j/dom/validate/Credential;)Ljava/util/Set;
     330: invokeinterface #91,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     335: pop
     336: goto          416
     339: astore        6
     341: getstatic     #93                 // Field LOG:Ljava/util/logging/Logger;
     344: getstatic     #94                 // Field java/util/logging/Level.INFO:Ljava/util/logging/Level;
     347: new           #58                 // class java/lang/StringBuilder
     350: dup
     351: invokespecial #59                 // Method java/lang/StringBuilder."<init>":()V
     354: ldc           #95                 // String User
     356: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     359: aload_2
     360: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     363: ldc           #96                 // String  authentication failed
     365: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     368: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     371: aload         6
     373: invokevirtual #97                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     376: new           #54                 // class javax/security/auth/login/LoginException
     379: dup
     380: new           #58                 // class java/lang/StringBuilder
     383: dup
     384: invokespecial #59                 // Method java/lang/StringBuilder."<init>":()V
     387: ldc           #95                 // String User
     389: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     392: aload_2
     393: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     396: ldc           #98                 // String  authentication failed:
     398: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     401: aload         6
     403: invokevirtual #99                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     406: invokevirtual #61                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     409: invokevirtual #63                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     412: invokespecial #56                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
     415: athrow
     416: iconst_1
     417: ireturn
    Exception table:
       from    to  target type
          30    40    43   Class java/io/IOException
          30    40    56   Class javax/security/auth/callback/UnsupportedCallbackException
         201   336   339   Class java/lang/Exception

  private org.apache.cxf.ws.security.trust.STSClient configureSTSClient(org.apache.cxf.message.Message) throws org.apache.cxf.BusException, org.apache.cxf.endpoint.EndpointException;
    Code:
       0: aconst_null
       1: astore_2
       2: aload_0
       3: getfield      #38                 // Field cxfSpringCfg:Ljava/lang/String;
       6: ifnull        60
       9: new           #100                // class org/apache/cxf/bus/spring/SpringBusFactory
      12: dup
      13: invokespecial #101                // Method org/apache/cxf/bus/spring/SpringBusFactory."<init>":()V
      16: astore_3
      17: aload_0
      18: getfield      #38                 // Field cxfSpringCfg:Ljava/lang/String;
      21: invokestatic  #102                // Method org/apache/wss4j/common/util/Loader.getResource:(Ljava/lang/String;)Ljava/net/URL;
      24: astore        4
      26: aload_3
      27: aload         4
      29: invokevirtual #103                // Method java/net/URL.toString:()Ljava/lang/String;
      32: invokevirtual #104                // Method org/apache/cxf/bus/spring/SpringBusFactory.createBus:(Ljava/lang/String;)Lorg/apache/cxf/Bus;
      35: astore        5
      37: aload         5
      39: invokestatic  #105                // Method org/apache/cxf/bus/spring/SpringBusFactory.setDefaultBus:(Lorg/apache/cxf/Bus;)V
      42: aload         5
      44: invokestatic  #106                // Method org/apache/cxf/bus/spring/SpringBusFactory.setThreadDefaultBus:(Lorg/apache/cxf/Bus;)V
      47: new           #107                // class org/apache/cxf/ws/security/trust/STSClient
      50: dup
      51: aload         5
      53: invokespecial #108                // Method org/apache/cxf/ws/security/trust/STSClient."<init>":(Lorg/apache/cxf/Bus;)V
      56: astore_2
      57: goto          88
      60: aload_1
      61: ifnonnull     81
      64: iconst_1
      65: invokestatic  #109                // Method org/apache/cxf/BusFactory.getDefaultBus:(Z)Lorg/apache/cxf/Bus;
      68: astore_3
      69: new           #107                // class org/apache/cxf/ws/security/trust/STSClient
      72: dup
      73: aload_3
      74: invokespecial #108                // Method org/apache/cxf/ws/security/trust/STSClient."<init>":(Lorg/apache/cxf/Bus;)V
      77: astore_2
      78: goto          88
      81: aload_1
      82: ldc           #110                // String sts
      84: invokestatic  #111                // Method org/apache/cxf/ws/security/trust/STSUtils.getClient:(Lorg/apache/cxf/message/Message;Ljava/lang/String;)Lorg/apache/cxf/ws/security/trust/STSClient;
      87: astore_2
      88: aload_0
      89: getfield      #25                 // Field wsdlLocation:Ljava/lang/String;
      92: ifnull        103
      95: aload_2
      96: aload_0
      97: getfield      #25                 // Field wsdlLocation:Ljava/lang/String;
     100: invokevirtual #112                // Method org/apache/cxf/ws/security/trust/STSClient.setWsdlLocation:(Ljava/lang/String;)V
     103: aload_0
     104: getfield      #27                 // Field serviceName:Ljava/lang/String;
     107: ifnull        118
     110: aload_2
     111: aload_0
     112: getfield      #27                 // Field serviceName:Ljava/lang/String;
     115: invokevirtual #113                // Method org/apache/cxf/ws/security/trust/STSClient.setServiceName:(Ljava/lang/String;)V
     118: aload_0
     119: getfield      #29                 // Field endpointName:Ljava/lang/String;
     122: ifnull        133
     125: aload_2
     126: aload_0
     127: getfield      #29                 // Field endpointName:Ljava/lang/String;
     130: invokevirtual #114                // Method org/apache/cxf/ws/security/trust/STSClient.setEndpointName:(Ljava/lang/String;)V
     133: aload_0
     134: getfield      #32                 // Field keySize:I
     137: ifle          148
     140: aload_2
     141: aload_0
     142: getfield      #32                 // Field keySize:I
     145: invokevirtual #115                // Method org/apache/cxf/ws/security/trust/STSClient.setKeySize:(I)V
     148: aload_0
     149: getfield      #6                  // Field keyType:Ljava/lang/String;
     152: ifnull        163
     155: aload_2
     156: aload_0
     157: getfield      #6                  // Field keyType:Ljava/lang/String;
     160: invokevirtual #116                // Method org/apache/cxf/ws/security/trust/STSClient.setKeyType:(Ljava/lang/String;)V
     163: aload_0
     164: getfield      #8                  // Field tokenType:Ljava/lang/String;
     167: ifnull        178
     170: aload_2
     171: aload_0
     172: getfield      #8                  // Field tokenType:Ljava/lang/String;
     175: invokevirtual #117                // Method org/apache/cxf/ws/security/trust/STSClient.setTokenType:(Ljava/lang/String;)V
     178: aload_0
     179: getfield      #36                 // Field namespace:Ljava/lang/String;
     182: ifnull        193
     185: aload_2
     186: aload_0
     187: getfield      #36                 // Field namespace:Ljava/lang/String;
     190: invokevirtual #118                // Method org/apache/cxf/ws/security/trust/STSClient.setNamespace:(Ljava/lang/String;)V
     193: aload_2
     194: aload_0
     195: getfield      #11                 // Field stsClientProperties:Ljava/util/Map;
     198: invokevirtual #119                // Method org/apache/cxf/ws/security/trust/STSClient.setProperties:(Ljava/util/Map;)V
     201: aload_0
     202: getfield      #19                 // Field requireRoles:Z
     205: ifeq          226
     208: aload_2
     209: invokevirtual #120                // Method org/apache/cxf/ws/security/trust/STSClient.getClaimsCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     212: ifnonnull     226
     215: aload_2
     216: new           #121                // class org/apache/cxf/ws/security/trust/claims/RoleClaimsCallbackHandler
     219: dup
     220: invokespecial #122                // Method org/apache/cxf/ws/security/trust/claims/RoleClaimsCallbackHandler."<init>":()V
     223: invokevirtual #123                // Method org/apache/cxf/ws/security/trust/STSClient.setClaimsCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
     226: aload_2
     227: areturn

  private org.apache.cxf.ws.security.tokenstore.TokenStore configureTokenStore() throws java.net.MalformedURLException;
    Code:
       0: invokestatic  #124                // Method org/apache/cxf/ws/security/tokenstore/TokenStoreFactory.isEhCacheInstalled:()Z
       3: ifeq          54
       6: ldc           #125                // String cxf-ehcache.xml
       8: astore_1
       9: aconst_null
      10: astore_2
      11: aload_2
      12: ifnonnull     23
      15: aload_1
      16: ldc_w         #126                // class org/apache/cxf/ws/security/trust/STSLoginModule
      19: invokestatic  #127                // Method org/apache/cxf/common/classloader/ClassLoaderUtils.getResource:(Ljava/lang/String;Ljava/lang/Class;)Ljava/net/URL;
      22: astore_2
      23: aload_2
      24: ifnonnull     36
      27: new           #128                // class java/net/URL
      30: dup
      31: aload_1
      32: invokespecial #129                // Method java/net/URL."<init>":(Ljava/lang/String;)V
      35: astore_2
      36: aload_2
      37: ifnull        54
      40: new           #130                // class org/apache/cxf/ws/security/tokenstore/EHCacheTokenStore
      43: dup
      44: ldc           #131                // String sts.login.module.tokenstore
      46: invokestatic  #132                // Method org/apache/cxf/BusFactory.getDefaultBus:()Lorg/apache/cxf/Bus;
      49: aload_2
      50: invokespecial #133                // Method org/apache/cxf/ws/security/tokenstore/EHCacheTokenStore."<init>":(Ljava/lang/String;Lorg/apache/cxf/Bus;Ljava/net/URL;)V
      53: areturn
      54: aconst_null
      55: areturn

  private org.apache.wss4j.dom.message.token.UsernameToken convertToToken(java.lang.String, java.lang.String) throws java.lang.Exception;
    Code:
       0: invokestatic  #134                // Method org/apache/cxf/helpers/DOMUtils.createDocument:()Lorg/w3c/dom/Document;
       3: astore_3
       4: new           #135                // class org/apache/wss4j/dom/message/token/UsernameToken
       7: dup
       8: iconst_0
       9: aload_3
      10: ldc           #136                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText
      12: invokespecial #137                // Method org/apache/wss4j/dom/message/token/UsernameToken."<init>":(ZLorg/w3c/dom/Document;Ljava/lang/String;)V
      15: astore        4
      17: aload         4
      19: aload_1
      20: invokevirtual #138                // Method org/apache/wss4j/dom/message/token/UsernameToken.setName:(Ljava/lang/String;)V
      23: aload         4
      25: aload_2
      26: invokevirtual #139                // Method org/apache/wss4j/dom/message/token/UsernameToken.setPassword:(Ljava/lang/String;)V
      29: aload         4
      31: areturn

  private java.util.Set<java.security.Principal> getRoles(org.apache.cxf.message.Message, org.apache.wss4j.dom.validate.Credential);
    Code:
       0: aload_2
       1: invokevirtual #140                // Method org/apache/wss4j/dom/validate/Credential.getTransformedToken:()Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
       4: astore_3
       5: aload_3
       6: ifnonnull     14
       9: aload_2
      10: invokevirtual #141                // Method org/apache/wss4j/dom/validate/Credential.getSamlAssertion:()Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
      13: astore_3
      14: aload_3
      15: ifnull        68
      18: aconst_null
      19: astore        4
      21: aload_1
      22: ifnull        36
      25: ldc           #142                // String security.saml-role-attributename
      27: aload_1
      28: invokestatic  #143                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      31: checkcast     #17                 // class java/lang/String
      34: astore        4
      36: aload         4
      38: ifnull        49
      41: aload         4
      43: invokevirtual #144                // Method java/lang/String.length:()I
      46: ifne          53
      49: ldc           #145                // String http://schemas.xmlsoap.org/ws/2005/05/identity/claims/role
      51: astore        4
      53: aload_3
      54: invokestatic  #146                // Method org/apache/cxf/rt/security/saml/utils/SAMLUtils.getClaims:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)Lorg/apache/cxf/rt/security/claims/ClaimCollection;
      57: astore        5
      59: aload         5
      61: aload         4
      63: aconst_null
      64: invokestatic  #147                // Method org/apache/cxf/rt/security/saml/utils/SAMLUtils.parseRolesFromClaims:(Lorg/apache/cxf/rt/security/claims/ClaimCollection;Ljava/lang/String;Ljava/lang/String;)Ljava/util/Set;
      67: areturn
      68: invokestatic  #148                // Method java/util/Collections.emptySet:()Ljava/util/Set;
      71: areturn

  public boolean commit() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #67                 // Field userPrincipal:Ljava/security/Principal;
       4: ifnonnull     9
       7: iconst_0
       8: ireturn
       9: aload_0
      10: getfield      #12                 // Field subject:Ljavax/security/auth/Subject;
      13: invokevirtual #149                // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      16: aload_0
      17: getfield      #67                 // Field userPrincipal:Ljava/security/Principal;
      20: invokeinterface #150,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      25: pop
      26: aload_0
      27: getfield      #12                 // Field subject:Ljavax/security/auth/Subject;
      30: invokevirtual #149                // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      33: aload_0
      34: getfield      #4                  // Field roles:Ljava/util/Set;
      37: invokeinterface #91,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
      42: pop
      43: iconst_1
      44: ireturn

  public boolean abort() throws javax.security.auth.login.LoginException;
    Code:
       0: iconst_1
       1: ireturn

  public boolean logout() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #12                 // Field subject:Ljavax/security/auth/Subject;
       4: invokevirtual #149                // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
       7: aload_0
       8: getfield      #67                 // Field userPrincipal:Ljava/security/Principal;
      11: invokeinterface #151,  2          // InterfaceMethod java/util/Set.remove:(Ljava/lang/Object;)Z
      16: pop
      17: aload_0
      18: getfield      #12                 // Field subject:Ljavax/security/auth/Subject;
      21: invokevirtual #149                // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      24: aload_0
      25: getfield      #4                  // Field roles:Ljava/util/Set;
      28: invokeinterface #152,  2          // InterfaceMethod java/util/Set.removeAll:(Ljava/util/Collection;)Z
      33: pop
      34: aload_0
      35: getfield      #4                  // Field roles:Ljava/util/Set;
      38: invokeinterface #153,  1          // InterfaceMethod java/util/Set.clear:()V
      43: aload_0
      44: aconst_null
      45: putfield      #67                 // Field userPrincipal:Ljava/security/Principal;
      48: iconst_1
      49: ireturn

  static {};
    Code:
       0: ldc_w         #126                // class org/apache/cxf/ws/security/trust/STSLoginModule
       3: invokestatic  #154                // Method org/apache/cxf/common/logging/LogUtils.getL7dLogger:(Ljava/lang/Class;)Ljava/util/logging/Logger;
       6: putstatic     #93                 // Field LOG:Ljava/util/logging/Logger;
       9: return
}
