Compiled from "TransportBindingHandler.java"
public class org.apache.cxf.ws.security.wss4j.policyhandlers.TransportBindingHandler extends org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder {
  org.apache.wss4j.policy.model.TransportBinding tbinding;

  public org.apache.cxf.ws.security.wss4j.policyhandlers.TransportBindingHandler(org.apache.wss4j.dom.engine.WSSConfig, org.apache.wss4j.policy.model.TransportBinding, javax.xml.soap.SOAPMessage, org.apache.wss4j.dom.message.WSSecHeader, org.apache.cxf.ws.policy.AssertionInfoMap, org.apache.cxf.binding.soap.SoapMessage) throws javax.xml.soap.SOAPException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: aload         5
       8: aload         6
      10: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder."<init>":(Lorg/apache/wss4j/dom/engine/WSSConfig;Lorg/apache/wss4j/policy/model/AbstractBinding;Ljavax/xml/soap/SOAPMessage;Lorg/apache/wss4j/dom/message/WSSecHeader;Lorg/apache/cxf/ws/policy/AssertionInfoMap;Lorg/apache/cxf/binding/soap/SoapMessage;)V
      13: aload_0
      14: aload_2
      15: putfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
      18: return

  private void addSignedSupportingTokens(org.apache.wss4j.policy.model.SupportingTokens) throws java.lang.Exception;
    Code:
       0: aload_1
       1: invokevirtual #3                  // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
       4: invokeinterface #4,  1            // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
       9: astore_2
      10: aload_2
      11: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
      16: ifeq          193
      19: aload_2
      20: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      25: checkcast     #7                  // class org/apache/wss4j/policy/model/AbstractToken
      28: astore_3
      29: aload_0
      30: aload_3
      31: invokevirtual #8                  // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
      34: aload_3
      35: ifnull        52
      38: aload_0
      39: aload_3
      40: invokevirtual #9                  // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      43: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      46: ifne          52
      49: goto          10
      52: aload_3
      53: instanceof    #11                 // class org/apache/wss4j/policy/model/UsernameToken
      56: ifeq          98
      59: aload_0
      60: aload_3
      61: checkcast     #11                 // class org/apache/wss4j/policy/model/UsernameToken
      64: invokevirtual #12                 // Method addUsernameToken:(Lorg/apache/wss4j/policy/model/UsernameToken;)Lorg/apache/wss4j/dom/message/WSSecUsernameToken;
      67: astore        4
      69: aload         4
      71: ifnull        95
      74: aload         4
      76: aload_0
      77: getfield      #13                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
      80: invokevirtual #14                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
      83: invokevirtual #15                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.prepare:(Lorg/w3c/dom/Document;)V
      86: aload         4
      88: aload_0
      89: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      92: invokevirtual #17                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.appendToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
      95: goto          190
      98: aload_3
      99: instanceof    #18                 // class org/apache/wss4j/policy/model/IssuedToken
     102: ifne          119
     105: aload_3
     106: instanceof    #19                 // class org/apache/wss4j/policy/model/KerberosToken
     109: ifne          119
     112: aload_3
     113: instanceof    #20                 // class org/apache/wss4j/policy/model/SpnegoContextToken
     116: ifeq          152
     119: aload_0
     120: invokevirtual #21                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     123: astore        4
     125: aload_0
     126: aload_3
     127: invokevirtual #9                  // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     130: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
     133: ifeq          149
     136: aload_0
     137: aload_0
     138: aload         4
     140: invokevirtual #22                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
     143: invokevirtual #23                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     146: invokevirtual #24                 // Method addEncryptedKeyElement:(Lorg/w3c/dom/Element;)V
     149: goto          190
     152: aload_3
     153: instanceof    #25                 // class org/apache/wss4j/policy/model/SamlToken
     156: ifeq          190
     159: aload_0
     160: aload_3
     161: checkcast     #25                 // class org/apache/wss4j/policy/model/SamlToken
     164: invokevirtual #26                 // Method addSamlToken:(Lorg/apache/wss4j/policy/model/SamlToken;)Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
     167: astore        4
     169: aload         4
     171: ifnull        190
     174: aload_0
     175: aload         4
     177: aload_0
     178: getfield      #13                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     181: invokevirtual #14                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     184: invokevirtual #27                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.toDOM:(Lorg/w3c/dom/Document;)Lorg/w3c/dom/Element;
     187: invokevirtual #28                 // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
     190: goto          10
     193: return

  public void handleBinding();
    Code:
       0: aload_0
       1: invokevirtual #29                 // Method createTimestamp:()Lorg/apache/wss4j/dom/message/WSSecTimestamp;
       4: astore_1
       5: aload_0
       6: aload_1
       7: invokevirtual #30                 // Method handleLayout:(Lorg/apache/wss4j/dom/message/WSSecTimestamp;)Lorg/apache/wss4j/dom/message/WSSecTimestamp;
      10: pop
      11: aload_0
      12: invokevirtual #31                 // Method isRequestor:()Z
      15: ifeq          119
      18: aload_0
      19: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
      22: invokevirtual #32                 // Method org/apache/wss4j/policy/model/TransportBinding.getTransportToken:()Lorg/apache/wss4j/policy/model/TransportToken;
      25: astore_2
      26: aload_2
      27: ifnull        104
      30: aload_2
      31: invokevirtual #33                 // Method org/apache/wss4j/policy/model/TransportToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
      34: astore_3
      35: aload_3
      36: instanceof    #18                 // class org/apache/wss4j/policy/model/IssuedToken
      39: ifeq          94
      42: aload_0
      43: invokevirtual #21                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      46: astore        4
      48: aload         4
      50: ifnonnull     61
      53: aload_0
      54: aload_3
      55: ldc           #34                 // String No transport token id
      57: invokevirtual #35                 // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
      60: return
      61: aload_0
      62: aload_3
      63: invokevirtual #36                 // Method assertPolicy:(Lorg/apache/neethi/Assertion;)V
      66: aload_0
      67: aload_3
      68: invokevirtual #9                  // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      71: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      74: ifeq          94
      77: aload         4
      79: invokevirtual #22                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
      82: astore        5
      84: aload_0
      85: aload_0
      86: aload         5
      88: invokevirtual #23                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      91: invokevirtual #24                 // Method addEncryptedKeyElement:(Lorg/w3c/dom/Element;)V
      94: aload_0
      95: aload_3
      96: invokevirtual #8                  // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
      99: aload_0
     100: aload_2
     101: invokevirtual #37                 // Method assertTokenWrapper:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;)V
     104: aload_0
     105: invokespecial #38                 // Method handleNonEndorsingSupportingTokens:()V
     108: aload_2
     109: ifnull        116
     112: aload_0
     113: invokespecial #39                 // Method handleEndorsingSupportingTokens:()V
     116: goto          174
     119: aload_0
     120: invokespecial #38                 // Method handleNonEndorsingSupportingTokens:()V
     123: aload_0
     124: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     127: ifnull        169
     130: aload_0
     131: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     134: invokevirtual #32                 // Method org/apache/wss4j/policy/model/TransportBinding.getTransportToken:()Lorg/apache/wss4j/policy/model/TransportToken;
     137: ifnull        169
     140: aload_0
     141: aload_0
     142: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     145: invokevirtual #32                 // Method org/apache/wss4j/policy/model/TransportBinding.getTransportToken:()Lorg/apache/wss4j/policy/model/TransportToken;
     148: invokevirtual #37                 // Method assertTokenWrapper:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;)V
     151: aload_0
     152: aload_0
     153: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     156: invokevirtual #32                 // Method org/apache/wss4j/policy/model/TransportBinding.getTransportToken:()Lorg/apache/wss4j/policy/model/TransportToken;
     159: invokevirtual #33                 // Method org/apache/wss4j/policy/model/TransportToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     162: invokevirtual #8                  // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
     165: aload_0
     166: invokespecial #39                 // Method handleEndorsingSupportingTokens:()V
     169: aload_0
     170: aconst_null
     171: invokevirtual #40                 // Method addSignatureConfirmation:(Ljava/util/List;)V
     174: goto          201
     177: astore_2
     178: getstatic     #42                 // Field LOG:Ljava/util/logging/Logger;
     181: getstatic     #43                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     184: aload_2
     185: invokevirtual #44                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     188: aload_2
     189: invokevirtual #45                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     192: new           #46                 // class org/apache/cxf/interceptor/Fault
     195: dup
     196: aload_2
     197: invokespecial #47                 // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     200: athrow
     201: aload_0
     202: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     205: ifnull        258
     208: aload_0
     209: aload_0
     210: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     213: invokevirtual #48                 // Method org/apache/wss4j/policy/model/TransportBinding.getName:()Ljavax/xml/namespace/QName;
     216: invokevirtual #49                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     219: aload_0
     220: aload_0
     221: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     224: invokevirtual #50                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     227: invokevirtual #51                 // Method assertAlgorithmSuite:(Lorg/apache/wss4j/policy/model/AlgorithmSuite;)V
     230: aload_0
     231: aload_0
     232: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     235: invokevirtual #48                 // Method org/apache/wss4j/policy/model/TransportBinding.getName:()Ljavax/xml/namespace/QName;
     238: invokevirtual #52                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     241: invokevirtual #53                 // Method assertWSSProperties:(Ljava/lang/String;)V
     244: aload_0
     245: aload_0
     246: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     249: invokevirtual #48                 // Method org/apache/wss4j/policy/model/TransportBinding.getName:()Ljavax/xml/namespace/QName;
     252: invokevirtual #52                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     255: invokevirtual #54                 // Method assertTrustProperties:(Ljava/lang/String;)V
     258: aload_0
     259: getstatic     #55                 // Field org/apache/wss4j/policy/SP12Constants.SIGNED_PARTS:Ljavax/xml/namespace/QName;
     262: invokevirtual #49                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     265: aload_0
     266: getstatic     #56                 // Field org/apache/wss4j/policy/SP11Constants.SIGNED_PARTS:Ljavax/xml/namespace/QName;
     269: invokevirtual #49                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     272: aload_0
     273: getstatic     #57                 // Field org/apache/wss4j/policy/SP12Constants.ENCRYPTED_PARTS:Ljavax/xml/namespace/QName;
     276: invokevirtual #49                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     279: aload_0
     280: getstatic     #58                 // Field org/apache/wss4j/policy/SP11Constants.ENCRYPTED_PARTS:Ljavax/xml/namespace/QName;
     283: invokevirtual #49                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     286: return
    Exception table:
       from    to  target type
          11    60   177   Class java/lang/Exception
          61   174   177   Class java/lang/Exception

  private void handleNonEndorsingSupportingTokens() throws java.lang.Exception;
    Code:
       0: aload_0
       1: ldc           #59                 // String SignedSupportingTokens
       3: invokevirtual #60                 // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
       6: astore_1
       7: aload_1
       8: invokeinterface #61,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
      13: ifne          70
      16: aload_1
      17: invokeinterface #62,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      22: astore_2
      23: aload_2
      24: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
      29: ifeq          70
      32: aload_2
      33: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      38: checkcast     #63                 // class org/apache/cxf/ws/policy/AssertionInfo
      41: astore_3
      42: aload_3
      43: invokevirtual #64                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      46: checkcast     #65                 // class org/apache/wss4j/policy/model/SupportingTokens
      49: astore        4
      51: aload         4
      53: ifnull        62
      56: aload_0
      57: aload         4
      59: invokespecial #66                 // Method addSignedSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;)V
      62: aload_3
      63: iconst_1
      64: invokevirtual #67                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      67: goto          23
      70: aload_0
      71: ldc           #68                 // String SignedEncryptedSupportingTokens
      73: invokevirtual #60                 // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
      76: astore_1
      77: aload_1
      78: invokeinterface #61,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
      83: ifne          140
      86: aload_1
      87: invokeinterface #62,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      92: astore_2
      93: aload_2
      94: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
      99: ifeq          140
     102: aload_2
     103: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     108: checkcast     #63                 // class org/apache/cxf/ws/policy/AssertionInfo
     111: astore_3
     112: aload_3
     113: invokevirtual #64                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     116: checkcast     #65                 // class org/apache/wss4j/policy/model/SupportingTokens
     119: astore        4
     121: aload         4
     123: ifnull        132
     126: aload_0
     127: aload         4
     129: invokespecial #66                 // Method addSignedSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     132: aload_3
     133: iconst_1
     134: invokevirtual #67                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     137: goto          93
     140: aload_0
     141: ldc           #69                 // String EncryptedSupportingTokens
     143: invokevirtual #60                 // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     146: astore_1
     147: aload_1
     148: invokeinterface #61,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
     153: ifne          210
     156: aload_1
     157: invokeinterface #62,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     162: astore_2
     163: aload_2
     164: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
     169: ifeq          210
     172: aload_2
     173: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     178: checkcast     #63                 // class org/apache/cxf/ws/policy/AssertionInfo
     181: astore_3
     182: aload_3
     183: invokevirtual #64                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     186: checkcast     #65                 // class org/apache/wss4j/policy/model/SupportingTokens
     189: astore        4
     191: aload         4
     193: ifnull        202
     196: aload_0
     197: aload         4
     199: invokespecial #66                 // Method addSignedSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     202: aload_3
     203: iconst_1
     204: invokevirtual #67                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     207: goto          163
     210: aload_0
     211: ldc           #70                 // String SupportingTokens
     213: invokevirtual #60                 // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     216: astore_1
     217: aload_1
     218: invokeinterface #61,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
     223: ifne          310
     226: aload_1
     227: invokeinterface #62,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     232: astore_2
     233: aload_2
     234: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
     239: ifeq          310
     242: aload_2
     243: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     248: checkcast     #63                 // class org/apache/cxf/ws/policy/AssertionInfo
     251: astore_3
     252: aload_3
     253: invokevirtual #64                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     256: checkcast     #65                 // class org/apache/wss4j/policy/model/SupportingTokens
     259: astore        4
     261: aload         4
     263: ifnull        302
     266: aload         4
     268: invokevirtual #3                  // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
     271: ifnull        302
     274: aload         4
     276: invokevirtual #3                  // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
     279: invokeinterface #71,  1           // InterfaceMethod java/util/List.size:()I
     284: ifle          302
     287: aload_0
     288: aload         4
     290: iconst_0
     291: new           #72                 // class java/util/ArrayList
     294: dup
     295: invokespecial #73                 // Method java/util/ArrayList."<init>":()V
     298: invokevirtual #74                 // Method handleSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;ZLjava/util/List;)Ljava/util/List;
     301: pop
     302: aload_3
     303: iconst_1
     304: invokevirtual #67                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     307: goto          233
     310: return

  private void handleEndorsingSupportingTokens() throws java.lang.Exception;
    Code:
       0: aload_0
       1: ldc           #75                 // String SignedEndorsingSupportingTokens
       3: invokevirtual #60                 // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
       6: astore_1
       7: aload_1
       8: invokeinterface #61,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
      13: ifne          107
      16: aconst_null
      17: astore_2
      18: aload_1
      19: invokeinterface #62,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      24: astore_3
      25: aload_3
      26: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
      31: ifeq          63
      34: aload_3
      35: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      40: checkcast     #63                 // class org/apache/cxf/ws/policy/AssertionInfo
      43: astore        4
      45: aload         4
      47: invokevirtual #64                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      50: checkcast     #65                 // class org/apache/wss4j/policy/model/SupportingTokens
      53: astore_2
      54: aload         4
      56: iconst_1
      57: invokevirtual #67                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      60: goto          25
      63: aload_2
      64: ifnull        107
      67: aload_2
      68: invokevirtual #3                  // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
      71: invokeinterface #4,  1            // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      76: astore_3
      77: aload_3
      78: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
      83: ifeq          107
      86: aload_3
      87: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      92: checkcast     #7                  // class org/apache/wss4j/policy/model/AbstractToken
      95: astore        4
      97: aload_0
      98: aload         4
     100: aload_2
     101: invokespecial #76                 // Method handleEndorsingToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     104: goto          77
     107: aload_0
     108: ldc           #77                 // String EndorsingSupportingTokens
     110: invokevirtual #60                 // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     113: astore_1
     114: aload_1
     115: invokeinterface #61,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
     120: ifne          214
     123: aconst_null
     124: astore_2
     125: aload_1
     126: invokeinterface #62,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     131: astore_3
     132: aload_3
     133: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
     138: ifeq          170
     141: aload_3
     142: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     147: checkcast     #63                 // class org/apache/cxf/ws/policy/AssertionInfo
     150: astore        4
     152: aload         4
     154: invokevirtual #64                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     157: checkcast     #65                 // class org/apache/wss4j/policy/model/SupportingTokens
     160: astore_2
     161: aload         4
     163: iconst_1
     164: invokevirtual #67                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     167: goto          132
     170: aload_2
     171: ifnull        214
     174: aload_2
     175: invokevirtual #3                  // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
     178: invokeinterface #4,  1            // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     183: astore_3
     184: aload_3
     185: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
     190: ifeq          214
     193: aload_3
     194: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     199: checkcast     #7                  // class org/apache/wss4j/policy/model/AbstractToken
     202: astore        4
     204: aload_0
     205: aload         4
     207: aload_2
     208: invokespecial #76                 // Method handleEndorsingToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     211: goto          184
     214: aload_0
     215: ldc           #78                 // String EndorsingEncryptedSupportingTokens
     217: invokevirtual #60                 // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     220: astore_1
     221: aload_1
     222: invokeinterface #61,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
     227: ifne          321
     230: aconst_null
     231: astore_2
     232: aload_1
     233: invokeinterface #62,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     238: astore_3
     239: aload_3
     240: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
     245: ifeq          277
     248: aload_3
     249: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     254: checkcast     #63                 // class org/apache/cxf/ws/policy/AssertionInfo
     257: astore        4
     259: aload         4
     261: invokevirtual #64                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     264: checkcast     #65                 // class org/apache/wss4j/policy/model/SupportingTokens
     267: astore_2
     268: aload         4
     270: iconst_1
     271: invokevirtual #67                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     274: goto          239
     277: aload_2
     278: ifnull        321
     281: aload_2
     282: invokevirtual #3                  // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
     285: invokeinterface #4,  1            // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     290: astore_3
     291: aload_3
     292: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
     297: ifeq          321
     300: aload_3
     301: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     306: checkcast     #7                  // class org/apache/wss4j/policy/model/AbstractToken
     309: astore        4
     311: aload_0
     312: aload         4
     314: aload_2
     315: invokespecial #76                 // Method handleEndorsingToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     318: goto          291
     321: aload_0
     322: ldc           #79                 // String SignedEndorsingEncryptedSupportingTokens
     324: invokevirtual #60                 // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     327: astore_1
     328: aload_1
     329: invokeinterface #61,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
     334: ifne          428
     337: aconst_null
     338: astore_2
     339: aload_1
     340: invokeinterface #62,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     345: astore_3
     346: aload_3
     347: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
     352: ifeq          384
     355: aload_3
     356: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     361: checkcast     #63                 // class org/apache/cxf/ws/policy/AssertionInfo
     364: astore        4
     366: aload         4
     368: invokevirtual #64                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     371: checkcast     #65                 // class org/apache/wss4j/policy/model/SupportingTokens
     374: astore_2
     375: aload         4
     377: iconst_1
     378: invokevirtual #67                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     381: goto          346
     384: aload_2
     385: ifnull        428
     388: aload_2
     389: invokevirtual #3                  // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
     392: invokeinterface #4,  1            // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     397: astore_3
     398: aload_3
     399: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
     404: ifeq          428
     407: aload_3
     408: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     413: checkcast     #7                  // class org/apache/wss4j/policy/model/AbstractToken
     416: astore        4
     418: aload_0
     419: aload         4
     421: aload_2
     422: invokespecial #76                 // Method handleEndorsingToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     425: goto          398
     428: return

  private void handleEndorsingToken(org.apache.wss4j.policy.model.AbstractToken, org.apache.wss4j.policy.model.SupportingTokens) throws java.lang.Exception;
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #8                  // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
       5: aload_1
       6: ifnull        21
       9: aload_0
      10: aload_1
      11: invokevirtual #9                  // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      14: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      17: ifne          21
      20: return
      21: aload_1
      22: instanceof    #18                 // class org/apache/wss4j/policy/model/IssuedToken
      25: ifne          56
      28: aload_1
      29: instanceof    #80                 // class org/apache/wss4j/policy/model/SecureConversationToken
      32: ifne          56
      35: aload_1
      36: instanceof    #81                 // class org/apache/wss4j/policy/model/SecurityContextToken
      39: ifne          56
      42: aload_1
      43: instanceof    #19                 // class org/apache/wss4j/policy/model/KerberosToken
      46: ifne          56
      49: aload_1
      50: instanceof    #20                 // class org/apache/wss4j/policy/model/SpnegoContextToken
      53: ifeq          69
      56: aload_0
      57: aload_0
      58: aload_1
      59: aload_2
      60: invokespecial #82                 // Method doIssuedTokenSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)[B
      63: invokevirtual #83                 // Method addSig:([B)V
      66: goto          265
      69: aload_1
      70: instanceof    #84                 // class org/apache/wss4j/policy/model/X509Token
      73: ifne          83
      76: aload_1
      77: instanceof    #85                 // class org/apache/wss4j/policy/model/KeyValueToken
      80: ifeq          96
      83: aload_0
      84: aload_0
      85: aload_1
      86: aload_2
      87: invokespecial #86                 // Method doX509TokenSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)[B
      90: invokevirtual #83                 // Method addSig:([B)V
      93: goto          265
      96: aload_1
      97: instanceof    #25                 // class org/apache/wss4j/policy/model/SamlToken
     100: ifeq          142
     103: aload_0
     104: aload_1
     105: checkcast     #25                 // class org/apache/wss4j/policy/model/SamlToken
     108: invokevirtual #26                 // Method addSamlToken:(Lorg/apache/wss4j/policy/model/SamlToken;)Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
     111: astore_3
     112: aload_3
     113: aload_0
     114: getfield      #13                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     117: invokevirtual #14                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     120: invokevirtual #27                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.toDOM:(Lorg/w3c/dom/Document;)Lorg/w3c/dom/Element;
     123: pop
     124: aload_0
     125: aload_3
     126: invokevirtual #87                 // Method storeAssertionAsSecurityToken:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)V
     129: aload_0
     130: aload_0
     131: aload_1
     132: aload_2
     133: invokespecial #82                 // Method doIssuedTokenSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)[B
     136: invokevirtual #83                 // Method addSig:([B)V
     139: goto          265
     142: aload_1
     143: instanceof    #11                 // class org/apache/wss4j/policy/model/UsernameToken
     146: ifeq          265
     149: aload_0
     150: aload_1
     151: checkcast     #11                 // class org/apache/wss4j/policy/model/UsernameToken
     154: iconst_1
     155: invokevirtual #88                 // Method addDKUsernameToken:(Lorg/apache/wss4j/policy/model/UsernameToken;Z)Lorg/apache/wss4j/dom/message/WSSecUsernameToken;
     158: astore_3
     159: aload_3
     160: invokevirtual #89                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getId:()Ljava/lang/String;
     163: astore        4
     165: aload_3
     166: invokevirtual #90                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getDerivedKey:()[B
     169: astore        5
     171: new           #91                 // class java/util/Date
     174: dup
     175: invokespecial #92                 // Method java/util/Date."<init>":()V
     178: astore        6
     180: new           #91                 // class java/util/Date
     183: dup
     184: invokespecial #92                 // Method java/util/Date."<init>":()V
     187: astore        7
     189: aload         7
     191: aload         6
     193: invokevirtual #93                 // Method java/util/Date.getTime:()J
     196: ldc2_w        #94                 // long 300000l
     199: ladd
     200: invokevirtual #96                 // Method java/util/Date.setTime:(J)V
     203: new           #97                 // class org/apache/cxf/ws/security/tokenstore/SecurityToken
     206: dup
     207: aload         4
     209: aload_3
     210: invokevirtual #98                 // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getUsernameTokenElement:()Lorg/w3c/dom/Element;
     213: aload         6
     215: aload         7
     217: invokespecial #99                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;Lorg/w3c/dom/Element;Ljava/util/Date;Ljava/util/Date;)V
     220: astore        8
     222: aload         8
     224: aload         5
     226: invokevirtual #100                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
     229: aload_0
     230: invokevirtual #101                // Method getTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     233: aload         8
     235: invokeinterface #102,  2          // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.add:(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
     240: aload_0
     241: getfield      #103                // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     244: ldc           #104                // String ws-security.token.id
     246: aload         8
     248: invokevirtual #105                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     251: invokevirtual #106                // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     254: pop
     255: aload_0
     256: aload_0
     257: aload_1
     258: aload_2
     259: invokespecial #82                 // Method doIssuedTokenSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)[B
     262: invokevirtual #83                 // Method addSig:([B)V
     265: return

  private byte[] doX509TokenSignature(org.apache.wss4j.policy.model.AbstractToken, org.apache.wss4j.policy.model.SupportingTokens) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #13                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
       4: invokevirtual #14                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
       7: astore_3
       8: aload_0
       9: aload_2
      10: invokevirtual #107                // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedParts:()Lorg/apache/wss4j/policy/model/SignedParts;
      13: aload_2
      14: invokevirtual #108                // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedElements:()Lorg/apache/wss4j/policy/model/SignedElements;
      17: invokespecial #109                // Method signPartsAndElements:(Lorg/apache/wss4j/policy/model/SignedParts;Lorg/apache/wss4j/policy/model/SignedElements;)Ljava/util/List;
      20: astore        4
      22: aload_1
      23: invokevirtual #110                // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
      26: getstatic     #111                // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
      29: if_acmpne     250
      32: aload_0
      33: aload_1
      34: invokevirtual #112                // Method getEncryptedKeyBuilder:(Lorg/apache/wss4j/policy/model/AbstractToken;)Lorg/apache/wss4j/dom/message/WSSecEncryptedKey;
      37: astore        5
      39: aload_0
      40: aload_2
      41: invokevirtual #36                 // Method assertPolicy:(Lorg/apache/neethi/Assertion;)V
      44: aload         5
      46: invokevirtual #113                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.getBinarySecurityTokenElement:()Lorg/w3c/dom/Element;
      49: astore        6
      51: aload         6
      53: ifnull        62
      56: aload_0
      57: aload         6
      59: invokevirtual #114                // Method addTopDownElement:(Lorg/w3c/dom/Element;)V
      62: aload         5
      64: aload_0
      65: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      68: invokevirtual #115                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.appendToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
      71: new           #116                // class org/apache/wss4j/dom/message/WSSecDKSign
      74: dup
      75: invokespecial #117                // Method org/apache/wss4j/dom/message/WSSecDKSign."<init>":()V
      78: astore        7
      80: aload         7
      82: aload_0
      83: getfield      #118                // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      86: invokevirtual #119                // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      89: invokevirtual #120                // Method org/apache/wss4j/dom/message/WSSecDKSign.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      92: aload         7
      94: aload_0
      95: getfield      #121                // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      98: invokevirtual #122                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
     101: aload_1
     102: invokevirtual #123                // Method org/apache/wss4j/policy/model/AbstractToken.getVersion:()Lorg/apache/wss4j/policy/SPConstants$SPVersion;
     105: getstatic     #124                // Field org/apache/wss4j/policy/SPConstants$SPVersion.SP11:Lorg/apache/wss4j/policy/SPConstants$SPVersion;
     108: if_acmpne     117
     111: aload         7
     113: iconst_1
     114: invokevirtual #125                // Method org/apache/wss4j/dom/message/WSSecDKSign.setWscVersion:(I)V
     117: aload         7
     119: aload_0
     120: getfield      #126                // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     123: invokevirtual #127                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     126: invokevirtual #128                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     129: invokevirtual #129                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     132: invokevirtual #130                // Method org/apache/wss4j/dom/message/WSSecDKSign.setSigCanonicalization:(Ljava/lang/String;)V
     135: aload         7
     137: aload_0
     138: getfield      #126                // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     141: invokevirtual #127                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     144: invokevirtual #131                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
     147: invokevirtual #132                // Method org/apache/wss4j/dom/message/WSSecDKSign.setSignatureAlgorithm:(Ljava/lang/String;)V
     150: aload_0
     151: getfield      #126                // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     154: invokevirtual #127                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     157: invokevirtual #133                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     160: astore        8
     162: aload         7
     164: aload         8
     166: invokevirtual #134                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getSignatureDerivedKeyLength:()I
     169: bipush        8
     171: idiv
     172: invokevirtual #135                // Method org/apache/wss4j/dom/message/WSSecDKSign.setDerivedKeyLength:(I)V
     175: aload         7
     177: aload         5
     179: invokevirtual #136                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.getEphemeralKey:()[B
     182: aload         5
     184: invokevirtual #137                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.getId:()Ljava/lang/String;
     187: invokevirtual #138                // Method org/apache/wss4j/dom/message/WSSecDKSign.setExternalKey:([BLjava/lang/String;)V
     190: aload         7
     192: aload_3
     193: aload_0
     194: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     197: invokevirtual #139                // Method org/apache/wss4j/dom/message/WSSecDKSign.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     200: aload         7
     202: invokevirtual #140                // Method org/apache/wss4j/dom/message/WSSecDKSign.getParts:()Ljava/util/List;
     205: aload         4
     207: invokeinterface #141,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     212: pop
     213: aload         7
     215: aload         4
     217: aload_0
     218: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     221: invokevirtual #142                // Method org/apache/wss4j/dom/message/WSSecDKSign.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     224: astore        9
     226: aload         7
     228: aload_0
     229: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     232: invokevirtual #143                // Method org/apache/wss4j/dom/message/WSSecDKSign.appendDKElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     235: aload         7
     237: aload         9
     239: iconst_0
     240: aconst_null
     241: invokevirtual #144                // Method org/apache/wss4j/dom/message/WSSecDKSign.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     244: aload         7
     246: invokevirtual #145                // Method org/apache/wss4j/dom/message/WSSecDKSign.getSignatureValue:()[B
     249: areturn
     250: aload_0
     251: aload_1
     252: iconst_0
     253: iconst_0
     254: invokevirtual #146                // Method getSignatureBuilder:(Lorg/apache/wss4j/policy/model/AbstractToken;ZZ)Lorg/apache/wss4j/dom/message/WSSecSignature;
     257: astore        5
     259: aload_0
     260: aload_2
     261: invokevirtual #36                 // Method assertPolicy:(Lorg/apache/neethi/Assertion;)V
     264: aload         5
     266: ifnull        346
     269: aload         5
     271: aload_0
     272: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     275: invokevirtual #147                // Method org/apache/wss4j/dom/message/WSSecSignature.prependBSTElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     278: aload         5
     280: aload         4
     282: aload_0
     283: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     286: invokevirtual #148                // Method org/apache/wss4j/dom/message/WSSecSignature.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     289: astore        6
     291: aload_0
     292: getfield      #149                // Field bottomUpElement:Lorg/w3c/dom/Element;
     295: ifnonnull     310
     298: aload         5
     300: aload         6
     302: iconst_0
     303: aconst_null
     304: invokevirtual #150                // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     307: goto          322
     310: aload         5
     312: aload         6
     314: iconst_1
     315: aload_0
     316: getfield      #149                // Field bottomUpElement:Lorg/w3c/dom/Element;
     319: invokevirtual #150                // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     322: aload_0
     323: aload         5
     325: invokevirtual #151                // Method org/apache/wss4j/dom/message/WSSecSignature.getSignatureElement:()Lorg/w3c/dom/Element;
     328: putfield      #149                // Field bottomUpElement:Lorg/w3c/dom/Element;
     331: aload_0
     332: aload         5
     334: invokevirtual #152                // Method org/apache/wss4j/dom/message/WSSecSignature.getId:()Ljava/lang/String;
     337: putfield      #153                // Field mainSigId:Ljava/lang/String;
     340: aload         5
     342: invokevirtual #154                // Method org/apache/wss4j/dom/message/WSSecSignature.getSignatureValue:()[B
     345: areturn
     346: iconst_0
     347: newarray       byte
     349: areturn

  private byte[] doIssuedTokenSignature(org.apache.wss4j.policy.model.AbstractToken, org.apache.wss4j.policy.model.SupportingTokens) throws java.lang.Exception;
    Code:
       0: iconst_0
       1: istore_3
       2: aload_0
       3: invokevirtual #21                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
       6: astore        4
       8: aload         4
      10: ifnonnull     45
      13: getstatic     #42                 // Field LOG:Ljava/util/logging/Logger;
      16: ldc           #155                // String The retrieved SecurityToken was null
      18: invokevirtual #156                // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
      21: new           #41                 // class java/lang/Exception
      24: dup
      25: ldc           #155                // String The retrieved SecurityToken was null
      27: invokespecial #157                // Method java/lang/Exception."<init>":(Ljava/lang/String;)V
      30: astore        5
      32: new           #158                // class org/apache/wss4j/common/ext/WSSecurityException
      35: dup
      36: getstatic     #159                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      39: aload         5
      41: invokespecial #160                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      44: athrow
      45: aload_0
      46: aload_1
      47: invokevirtual #9                  // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      50: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      53: ifeq          75
      56: aload_0
      57: aload         4
      59: invokevirtual #22                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
      62: invokevirtual #23                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      65: astore        5
      67: aload_0
      68: aload         5
      70: invokevirtual #24                 // Method addEncryptedKeyElement:(Lorg/w3c/dom/Element;)V
      73: iconst_1
      74: istore_3
      75: aload_0
      76: aload_2
      77: invokevirtual #107                // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedParts:()Lorg/apache/wss4j/policy/model/SignedParts;
      80: aload_2
      81: invokevirtual #108                // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedElements:()Lorg/apache/wss4j/policy/model/SignedElements;
      84: invokespecial #109                // Method signPartsAndElements:(Lorg/apache/wss4j/policy/model/SignedParts;Lorg/apache/wss4j/policy/model/SignedElements;)Ljava/util/List;
      87: astore        5
      89: aload_1
      90: invokevirtual #110                // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
      93: getstatic     #111                // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
      96: if_acmpne     110
      99: aload_0
     100: iload_3
     101: aload         4
     103: aload_1
     104: aload         5
     106: invokespecial #161                // Method doDerivedKeySignature:(ZLorg/apache/cxf/ws/security/tokenstore/SecurityToken;Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/util/List;)[B
     109: areturn
     110: aload_0
     111: iload_3
     112: aload         4
     114: aload_1
     115: aload_2
     116: aload         5
     118: invokespecial #162                // Method doSignature:(ZLorg/apache/cxf/ws/security/tokenstore/SecurityToken;Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;Ljava/util/List;)[B
     121: areturn

  private byte[] doDerivedKeySignature(boolean, org.apache.cxf.ws.security.tokenstore.SecurityToken, org.apache.wss4j.policy.model.AbstractToken, java.util.List<org.apache.wss4j.common.WSEncryptionPart>) throws java.lang.Exception;
    Code:
       0: new           #116                // class org/apache/wss4j/dom/message/WSSecDKSign
       3: dup
       4: invokespecial #117                // Method org/apache/wss4j/dom/message/WSSecDKSign."<init>":()V
       7: astore        5
       9: aload         5
      11: aload_0
      12: getfield      #118                // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      15: invokevirtual #119                // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      18: invokevirtual #120                // Method org/apache/wss4j/dom/message/WSSecDKSign.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      21: aload         5
      23: aload_0
      24: getfield      #121                // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      27: invokevirtual #122                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
      30: aload_0
      31: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
      34: invokevirtual #50                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
      37: astore        6
      39: iload_1
      40: ifeq          52
      43: aload_2
      44: invokevirtual #163                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getAttachedReference:()Lorg/w3c/dom/Element;
      47: astore        7
      49: goto          58
      52: aload_2
      53: invokevirtual #164                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getUnattachedReference:()Lorg/w3c/dom/Element;
      56: astore        7
      58: aload         7
      60: ifnull        81
      63: aload         5
      65: aload_2
      66: invokevirtual #165                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
      69: aload_0
      70: aload         7
      72: invokevirtual #23                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      75: invokevirtual #166                // Method org/apache/wss4j/dom/message/WSSecDKSign.setExternalKey:([BLorg/w3c/dom/Element;)V
      78: goto          94
      81: aload         5
      83: aload_2
      84: invokevirtual #165                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
      87: aload_2
      88: invokevirtual #105                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
      91: invokevirtual #138                // Method org/apache/wss4j/dom/message/WSSecDKSign.setExternalKey:([BLjava/lang/String;)V
      94: aload_3
      95: instanceof    #11                 // class org/apache/wss4j/policy/model/UsernameToken
      98: ifeq          108
     101: aload         5
     103: ldc           #167                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
     105: invokevirtual #168                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCustomValueType:(Ljava/lang/String;)V
     108: aload         5
     110: aload         6
     112: invokevirtual #131                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
     115: invokevirtual #132                // Method org/apache/wss4j/dom/message/WSSecDKSign.setSignatureAlgorithm:(Ljava/lang/String;)V
     118: aload_0
     119: getfield      #126                // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     122: invokevirtual #127                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     125: invokevirtual #133                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     128: astore        8
     130: aload         5
     132: aload         8
     134: invokevirtual #134                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getSignatureDerivedKeyLength:()I
     137: bipush        8
     139: idiv
     140: invokevirtual #135                // Method org/apache/wss4j/dom/message/WSSecDKSign.setDerivedKeyLength:(I)V
     143: aload_3
     144: invokevirtual #123                // Method org/apache/wss4j/policy/model/AbstractToken.getVersion:()Lorg/apache/wss4j/policy/SPConstants$SPVersion;
     147: getstatic     #124                // Field org/apache/wss4j/policy/SPConstants$SPVersion.SP11:Lorg/apache/wss4j/policy/SPConstants$SPVersion;
     150: if_acmpne     159
     153: aload         5
     155: iconst_1
     156: invokevirtual #125                // Method org/apache/wss4j/dom/message/WSSecDKSign.setWscVersion:(I)V
     159: aload_0
     160: getfield      #13                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     163: invokevirtual #14                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     166: astore        9
     168: aload         5
     170: aload         9
     172: aload_0
     173: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     176: invokevirtual #139                // Method org/apache/wss4j/dom/message/WSSecDKSign.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     179: aload_0
     180: aload         5
     182: invokevirtual #169                // Method org/apache/wss4j/dom/message/WSSecDKSign.getdktElement:()Lorg/w3c/dom/Element;
     185: invokevirtual #170                // Method addDerivedKeyElement:(Lorg/w3c/dom/Element;)V
     188: aload         5
     190: invokevirtual #140                // Method org/apache/wss4j/dom/message/WSSecDKSign.getParts:()Ljava/util/List;
     193: aload         4
     195: invokeinterface #141,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     200: pop
     201: aload         5
     203: aload         4
     205: aload_0
     206: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     209: invokevirtual #142                // Method org/apache/wss4j/dom/message/WSSecDKSign.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     212: astore        10
     214: aload         5
     216: aload         10
     218: iconst_0
     219: aconst_null
     220: invokevirtual #144                // Method org/apache/wss4j/dom/message/WSSecDKSign.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     223: aload         5
     225: invokevirtual #145                // Method org/apache/wss4j/dom/message/WSSecDKSign.getSignatureValue:()[B
     228: areturn

  private byte[] doSignature(boolean, org.apache.cxf.ws.security.tokenstore.SecurityToken, org.apache.wss4j.policy.model.AbstractToken, org.apache.wss4j.policy.model.SupportingTokens, java.util.List<org.apache.wss4j.common.WSEncryptionPart>) throws java.lang.Exception;
    Code:
       0: new           #171                // class org/apache/wss4j/dom/message/WSSecSignature
       3: dup
       4: invokespecial #172                // Method org/apache/wss4j/dom/message/WSSecSignature."<init>":()V
       7: astore        6
       9: aload         6
      11: aload_0
      12: getfield      #118                // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      15: invokevirtual #119                // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      18: invokevirtual #173                // Method org/apache/wss4j/dom/message/WSSecSignature.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      21: aload         6
      23: aload_0
      24: getfield      #121                // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      27: invokevirtual #174                // Method org/apache/wss4j/dom/message/WSSecSignature.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
      30: iload_1
      31: ifeq          43
      34: aload_2
      35: invokevirtual #163                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getAttachedReference:()Lorg/w3c/dom/Element;
      38: astore        7
      40: goto          49
      43: aload_2
      44: invokevirtual #164                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getUnattachedReference:()Lorg/w3c/dom/Element;
      47: astore        7
      49: aload         7
      51: ifnull        93
      54: new           #175                // class org/apache/wss4j/common/token/SecurityTokenReference
      57: dup
      58: aload_0
      59: aload         7
      61: invokevirtual #23                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      64: new           #176                // class org/apache/wss4j/common/bsp/BSPEnforcer
      67: dup
      68: invokespecial #177                // Method org/apache/wss4j/common/bsp/BSPEnforcer."<init>":()V
      71: invokespecial #178                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      74: astore        8
      76: aload         6
      78: aload         8
      80: invokevirtual #179                // Method org/apache/wss4j/dom/message/WSSecSignature.setSecurityTokenReference:(Lorg/apache/wss4j/common/token/SecurityTokenReference;)V
      83: aload         6
      85: bipush        12
      87: invokevirtual #180                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
      90: goto          296
      93: aload_3
      94: instanceof    #11                 // class org/apache/wss4j/policy/model/UsernameToken
      97: ifeq          139
     100: aload         6
     102: aload_2
     103: invokevirtual #105                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     106: invokevirtual #181                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenId:(Ljava/lang/String;)V
     109: aload         6
     111: ldc           #167                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
     113: invokevirtual #182                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     116: iload_1
     117: ifeq          125
     120: bipush        9
     122: goto          127
     125: bipush        11
     127: istore        8
     129: aload         6
     131: iload         8
     133: invokevirtual #180                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     136: goto          296
     139: aload_2
     140: invokevirtual #183                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     143: ifnonnull     163
     146: aload         6
     148: ldc           #184                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     150: invokevirtual #182                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     153: aload         6
     155: bipush        12
     157: invokevirtual #180                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     160: goto          296
     163: aload_2
     164: invokevirtual #185                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getWsuId:()Ljava/lang/String;
     167: astore        8
     169: aload         8
     171: ifnonnull     193
     174: aload         6
     176: aload_2
     177: invokevirtual #105                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     180: invokevirtual #181                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenId:(Ljava/lang/String;)V
     183: aload         6
     185: bipush        11
     187: invokevirtual #180                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     190: goto          209
     193: aload         6
     195: aload_2
     196: invokevirtual #185                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getWsuId:()Ljava/lang/String;
     199: invokevirtual #181                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenId:(Ljava/lang/String;)V
     202: aload         6
     204: bipush        9
     206: invokevirtual #180                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     209: aload_2
     210: invokevirtual #183                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     213: astore        9
     215: ldc           #186                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     217: aload         9
     219: invokevirtual #187                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     222: ifne          235
     225: ldc           #188                // String urn:oasis:names:tc:SAML:1.0:assertion
     227: aload         9
     229: invokevirtual #187                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     232: ifeq          252
     235: aload         6
     237: ldc           #184                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     239: invokevirtual #182                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     242: aload         6
     244: bipush        12
     246: invokevirtual #180                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     249: goto          296
     252: ldc           #189                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     254: aload         9
     256: invokevirtual #187                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     259: ifne          272
     262: ldc           #190                // String urn:oasis:names:tc:SAML:2.0:assertion
     264: aload         9
     266: invokevirtual #187                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     269: ifeq          289
     272: aload         6
     274: ldc           #191                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     276: invokevirtual #182                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     279: aload         6
     281: bipush        12
     283: invokevirtual #180                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     286: goto          296
     289: aload         6
     291: aload         9
     293: invokevirtual #182                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     296: aconst_null
     297: astore        8
     299: aload_2
     300: invokevirtual #165                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     303: ifnonnull     442
     306: aload         6
     308: aload_2
     309: invokevirtual #192                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getX509Certificate:()Ljava/security/cert/X509Certificate;
     312: invokevirtual #193                // Method org/apache/wss4j/dom/message/WSSecSignature.setX509Certificate:(Ljava/security/cert/X509Certificate;)V
     315: aload_2
     316: invokevirtual #194                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     319: astore        8
     321: aload         8
     323: ifnonnull     332
     326: aload_0
     327: invokevirtual #195                // Method getSignatureCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     330: astore        8
     332: aload         8
     334: ifnonnull     369
     337: getstatic     #42                 // Field LOG:Ljava/util/logging/Logger;
     340: ldc           #196                // String No signature Crypto properties are available
     342: invokevirtual #156                // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
     345: new           #41                 // class java/lang/Exception
     348: dup
     349: ldc           #196                // String No signature Crypto properties are available
     351: invokespecial #157                // Method java/lang/Exception."<init>":(Ljava/lang/String;)V
     354: astore        9
     356: new           #158                // class org/apache/wss4j/common/ext/WSSecurityException
     359: dup
     360: getstatic     #159                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     363: aload         9
     365: invokespecial #160                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     368: athrow
     369: aload         8
     371: aload_2
     372: invokevirtual #192                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getX509Certificate:()Ljava/security/cert/X509Certificate;
     375: invokeinterface #197,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Identifier:(Ljava/security/cert/X509Certificate;)Ljava/lang/String;
     380: astore        9
     382: aload         9
     384: ifnonnull     405
     387: ldc           #198                // String security.signature.username
     389: astore        10
     391: aload         10
     393: aload_0
     394: getfield      #103                // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     397: invokestatic  #199                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     400: checkcast     #200                // class java/lang/String
     403: astore        9
     405: aload_0
     406: aload         9
     408: aload_3
     409: iconst_3
     410: invokevirtual #201                // Method getPassword:(Ljava/lang/String;Lorg/apache/neethi/Assertion;I)Ljava/lang/String;
     413: astore        10
     415: aload         6
     417: aload         9
     419: aload         10
     421: invokevirtual #202                // Method org/apache/wss4j/dom/message/WSSecSignature.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
     424: aload         6
     426: aload_0
     427: getfield      #126                // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     430: invokevirtual #127                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     433: invokevirtual #203                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAsymmetricSignature:()Ljava/lang/String;
     436: invokevirtual #204                // Method org/apache/wss4j/dom/message/WSSecSignature.setSignatureAlgorithm:(Ljava/lang/String;)V
     439: goto          472
     442: aload_0
     443: invokevirtual #195                // Method getSignatureCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     446: astore        8
     448: aload         6
     450: aload_2
     451: invokevirtual #165                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     454: invokevirtual #205                // Method org/apache/wss4j/dom/message/WSSecSignature.setSecretKey:([B)V
     457: aload         6
     459: aload_0
     460: getfield      #126                // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     463: invokevirtual #127                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     466: invokevirtual #131                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
     469: invokevirtual #204                // Method org/apache/wss4j/dom/message/WSSecSignature.setSignatureAlgorithm:(Ljava/lang/String;)V
     472: aload         6
     474: aload_0
     475: getfield      #126                // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     478: invokevirtual #127                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     481: invokevirtual #128                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     484: invokevirtual #129                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     487: invokevirtual #206                // Method org/apache/wss4j/dom/message/WSSecSignature.setSigCanonicalization:(Ljava/lang/String;)V
     490: aload_0
     491: getfield      #13                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     494: invokevirtual #14                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     497: astore        9
     499: aload         6
     501: aload         9
     503: aload         8
     505: aload_0
     506: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     509: invokevirtual #207                // Method org/apache/wss4j/dom/message/WSSecSignature.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     512: aload         6
     514: invokevirtual #208                // Method org/apache/wss4j/dom/message/WSSecSignature.getParts:()Ljava/util/List;
     517: aload         5
     519: invokeinterface #141,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     524: pop
     525: aload         6
     527: aload         5
     529: aload_0
     530: getfield      #16                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     533: invokevirtual #148                // Method org/apache/wss4j/dom/message/WSSecSignature.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     536: astore        10
     538: aload_0
     539: getfield      #149                // Field bottomUpElement:Lorg/w3c/dom/Element;
     542: ifnonnull     557
     545: aload         6
     547: aload         10
     549: iconst_0
     550: aconst_null
     551: invokevirtual #150                // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     554: goto          569
     557: aload         6
     559: aload         10
     561: iconst_1
     562: aload_0
     563: getfield      #149                // Field bottomUpElement:Lorg/w3c/dom/Element;
     566: invokevirtual #150                // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     569: aload_0
     570: aload         6
     572: invokevirtual #151                // Method org/apache/wss4j/dom/message/WSSecSignature.getSignatureElement:()Lorg/w3c/dom/Element;
     575: putfield      #149                // Field bottomUpElement:Lorg/w3c/dom/Element;
     578: aload_0
     579: aload         6
     581: invokevirtual #152                // Method org/apache/wss4j/dom/message/WSSecSignature.getId:()Ljava/lang/String;
     584: putfield      #153                // Field mainSigId:Ljava/lang/String;
     587: aload         6
     589: invokevirtual #154                // Method org/apache/wss4j/dom/message/WSSecSignature.getSignatureValue:()[B
     592: areturn

  private java.util.List<org.apache.wss4j.common.WSEncryptionPart> signPartsAndElements(org.apache.wss4j.policy.model.SignedParts, org.apache.wss4j.policy.model.SignedElements) throws javax.xml.soap.SOAPException;
    Code:
       0: new           #72                 // class java/util/ArrayList
       3: dup
       4: invokespecial #73                 // Method java/util/ArrayList."<init>":()V
       7: astore_3
       8: new           #72                 // class java/util/ArrayList
      11: dup
      12: invokespecial #73                 // Method java/util/ArrayList."<init>":()V
      15: astore        4
      17: aload_0
      18: getfield      #209                // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
      21: ifnull        93
      24: new           #210                // class org/apache/wss4j/common/WSEncryptionPart
      27: dup
      28: ldc           #211                // String Timestamp
      30: ldc           #212                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      32: ldc           #213                // String Element
      34: invokespecial #214                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
      37: astore        5
      39: aload_0
      40: aload_0
      41: getfield      #209                // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
      44: invokevirtual #215                // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
      47: invokevirtual #216                // Method addWsuIdToElement:(Lorg/w3c/dom/Element;)Ljava/lang/String;
      50: astore        6
      52: aload         5
      54: aload         6
      56: invokevirtual #217                // Method org/apache/wss4j/common/WSEncryptionPart.setId:(Ljava/lang/String;)V
      59: aload         5
      61: aload_0
      62: getfield      #209                // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
      65: invokevirtual #215                // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
      68: invokevirtual #218                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
      71: aload         4
      73: aload         5
      75: invokevirtual #219                // Method org/apache/wss4j/common/WSEncryptionPart.getElement:()Lorg/w3c/dom/Element;
      78: invokeinterface #220,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      83: pop
      84: aload_3
      85: aload         5
      87: invokeinterface #220,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      92: pop
      93: aload_1
      94: ifnull        197
      97: new           #72                 // class java/util/ArrayList
     100: dup
     101: invokespecial #73                 // Method java/util/ArrayList."<init>":()V
     104: astore        5
     106: aload_1
     107: invokevirtual #221                // Method org/apache/wss4j/policy/model/SignedParts.isBody:()Z
     110: istore        6
     112: aload_1
     113: invokevirtual #222                // Method org/apache/wss4j/policy/model/SignedParts.getHeaders:()Ljava/util/List;
     116: invokeinterface #4,  1            // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     121: astore        7
     123: aload         7
     125: invokeinterface #5,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
     130: ifeq          179
     133: aload         7
     135: invokeinterface #6,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     140: checkcast     #223                // class org/apache/wss4j/policy/model/Header
     143: astore        8
     145: new           #210                // class org/apache/wss4j/common/WSEncryptionPart
     148: dup
     149: aload         8
     151: invokevirtual #224                // Method org/apache/wss4j/policy/model/Header.getName:()Ljava/lang/String;
     154: aload         8
     156: invokevirtual #225                // Method org/apache/wss4j/policy/model/Header.getNamespace:()Ljava/lang/String;
     159: ldc           #213                // String Element
     161: invokespecial #214                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     164: astore        9
     166: aload         5
     168: aload         9
     170: invokeinterface #220,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     175: pop
     176: goto          123
     179: aload_3
     180: aload_0
     181: iconst_1
     182: iload         6
     184: aload         5
     186: aload         4
     188: invokevirtual #226                // Method getParts:(ZZLjava/util/List;Ljava/util/List;)Ljava/util/List;
     191: invokeinterface #141,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     196: pop
     197: aload_2
     198: ifnull        221
     201: aload_3
     202: aload_0
     203: ldc           #213                // String Element
     205: aload_2
     206: invokevirtual #227                // Method org/apache/wss4j/policy/model/SignedElements.getXPaths:()Ljava/util/List;
     209: aload         4
     211: iconst_1
     212: invokevirtual #228                // Method getElements:(Ljava/lang/String;Ljava/util/List;Ljava/util/List;Z)Ljava/util/List;
     215: invokeinterface #141,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     220: pop
     221: aload_3
     222: areturn
}
