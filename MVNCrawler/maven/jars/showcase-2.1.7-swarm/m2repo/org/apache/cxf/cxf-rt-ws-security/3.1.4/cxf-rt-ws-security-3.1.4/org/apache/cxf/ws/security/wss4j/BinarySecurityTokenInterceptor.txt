Compiled from "BinarySecurityTokenInterceptor.java"
public class org.apache.cxf.ws.security.wss4j.BinarySecurityTokenInterceptor extends org.apache.cxf.ws.security.wss4j.AbstractTokenInterceptor {
  public org.apache.cxf.ws.security.wss4j.BinarySecurityTokenInterceptor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/AbstractTokenInterceptor."<init>":()V
       4: return

  protected void processToken(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_0
       1: aload_1
       2: iconst_0
       3: invokevirtual #2                  // Method findSecurityHeader:(Lorg/apache/cxf/binding/soap/SoapMessage;Z)Lorg/apache/cxf/headers/Header;
       6: astore_2
       7: aload_2
       8: ifnonnull     12
      11: return
      12: aload_2
      13: invokevirtual #3                  // Method org/apache/cxf/headers/Header.getObject:()Ljava/lang/Object;
      16: checkcast     #4                  // class org/w3c/dom/Element
      19: astore_3
      20: aload_3
      21: invokestatic  #5                  // Method org/apache/cxf/helpers/DOMUtils.getFirstElement:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Element;
      24: astore        4
      26: aload         4
      28: ifnull        242
      31: ldc           #6                  // String BinarySecurityToken
      33: aload         4
      35: invokeinterface #7,  1            // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      40: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      43: ifeq          232
      46: ldc           #9                  // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
      48: aload         4
      50: invokeinterface #10,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      55: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      58: ifeq          232
      61: aload_0
      62: aload         4
      64: aload_1
      65: invokespecial #11                 // Method processToken:(Lorg/w3c/dom/Element;Lorg/apache/cxf/binding/soap/SoapMessage;)Ljava/util/List;
      68: astore        5
      70: aload         5
      72: ifnull        216
      75: aload_1
      76: ldc           #12                 // String RECV_RESULTS
      78: invokevirtual #13                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Object;)Ljava/lang/Object;
      81: checkcast     #14                 // class java/util/List
      84: invokestatic  #15                 // Method org/apache/cxf/helpers/CastUtils.cast:(Ljava/util/List;)Ljava/util/List;
      87: astore        6
      89: aload         6
      91: ifnonnull     112
      94: new           #16                 // class java/util/ArrayList
      97: dup
      98: invokespecial #17                 // Method java/util/ArrayList."<init>":()V
     101: astore        6
     103: aload_1
     104: ldc           #12                 // String RECV_RESULTS
     106: aload         6
     108: invokevirtual #18                 // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     111: pop
     112: new           #19                 // class org/apache/wss4j/dom/handler/WSHandlerResult
     115: dup
     116: aconst_null
     117: aload         5
     119: sipush        4096
     122: invokestatic  #20                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     125: aload         5
     127: invokestatic  #21                 // Method java/util/Collections.singletonMap:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/util/Map;
     130: invokespecial #22                 // Method org/apache/wss4j/dom/handler/WSHandlerResult."<init>":(Ljava/lang/String;Ljava/util/List;Ljava/util/Map;)V
     133: astore        7
     135: aload         6
     137: iconst_0
     138: aload         7
     140: invokeinterface #23,  3           // InterfaceMethod java/util/List.add:(ILjava/lang/Object;)V
     145: aload_0
     146: aload_1
     147: invokevirtual #24                 // Method assertTokens:(Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/wss4j/policy/model/AbstractToken;
     150: pop
     151: aload         5
     153: iconst_0
     154: invokeinterface #25,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     159: checkcast     #26                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     162: ldc           #27                 // String principal
     164: invokevirtual #28                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     167: checkcast     #29                 // class java/security/Principal
     170: astore        8
     172: aload_1
     173: ldc_w         #30                 // class org/apache/cxf/security/SecurityContext
     176: invokevirtual #31                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
     179: checkcast     #30                 // class org/apache/cxf/security/SecurityContext
     182: astore        9
     184: aload         9
     186: ifnull        199
     189: aload         9
     191: invokeinterface #32,  1           // InterfaceMethod org/apache/cxf/security/SecurityContext.getUserPrincipal:()Ljava/security/Principal;
     196: ifnonnull     216
     199: aload_1
     200: ldc_w         #30                 // class org/apache/cxf/security/SecurityContext
     203: new           #33                 // class org/apache/cxf/interceptor/security/DefaultSecurityContext
     206: dup
     207: aload         8
     209: aconst_null
     210: invokespecial #34                 // Method org/apache/cxf/interceptor/security/DefaultSecurityContext."<init>":(Ljava/security/Principal;Ljavax/security/auth/Subject;)V
     213: invokevirtual #35                 // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/Class;Ljava/lang/Object;)V
     216: goto          232
     219: astore        5
     221: aload_1
     222: aload_1
     223: invokevirtual #37                 // Method org/apache/cxf/binding/soap/SoapMessage.getVersion:()Lorg/apache/cxf/binding/soap/SoapVersion;
     226: aload         5
     228: invokestatic  #38                 // Method org/apache/cxf/ws/security/wss4j/WSS4JUtils.createSoapFault:(Lorg/apache/cxf/binding/soap/SoapMessage;Lorg/apache/cxf/binding/soap/SoapVersion;Lorg/apache/wss4j/common/ext/WSSecurityException;)Lorg/apache/cxf/binding/soap/SoapFault;
     231: athrow
     232: aload         4
     234: invokestatic  #39                 // Method org/apache/cxf/helpers/DOMUtils.getNextElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     237: astore        4
     239: goto          26
     242: return
    Exception table:
       from    to  target type
          61   216   219   Class org/apache/wss4j/common/ext/WSSecurityException

  private java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult> processToken(org.w3c.dom.Element, org.apache.cxf.binding.soap.SoapMessage) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #40                 // class org/apache/wss4j/dom/WSDocInfo
       3: dup
       4: aload_1
       5: invokeinterface #41,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
      10: invokespecial #42                 // Method org/apache/wss4j/dom/WSDocInfo."<init>":(Lorg/w3c/dom/Document;)V
      13: astore_3
      14: new           #43                 // class org/apache/cxf/ws/security/wss4j/CXFRequestData
      17: dup
      18: invokespecial #44                 // Method org/apache/cxf/ws/security/wss4j/CXFRequestData."<init>":()V
      21: astore        4
      23: ldc           #45                 // String security.callback-handler
      25: aload_2
      26: invokestatic  #46                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      29: astore        5
      31: aload         4
      33: aload         5
      35: invokestatic  #47                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getCallbackHandler:(Ljava/lang/Object;)Ljavax/security/auth/callback/CallbackHandler;
      38: invokevirtual #48                 // Method org/apache/wss4j/dom/handler/RequestData.setCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
      41: goto          59
      44: astore        6
      46: new           #36                 // class org/apache/wss4j/common/ext/WSSecurityException
      49: dup
      50: getstatic     #50                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      53: aload         6
      55: invokespecial #51                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      58: athrow
      59: aload         4
      61: aload_2
      62: invokevirtual #52                 // Method org/apache/wss4j/dom/handler/RequestData.setMsgContext:(Ljava/lang/Object;)V
      65: aload         4
      67: invokestatic  #53                 // Method org/apache/wss4j/dom/engine/WSSConfig.getNewInstance:()Lorg/apache/wss4j/dom/engine/WSSConfig;
      70: invokevirtual #54                 // Method org/apache/wss4j/dom/handler/RequestData.setWssConfig:(Lorg/apache/wss4j/dom/engine/WSSConfig;)V
      73: new           #55                 // class org/apache/wss4j/dom/processor/BinarySecurityTokenProcessor
      76: dup
      77: invokespecial #56                 // Method org/apache/wss4j/dom/processor/BinarySecurityTokenProcessor."<init>":()V
      80: astore        6
      82: aload         6
      84: aload_1
      85: aload         4
      87: aload_3
      88: invokevirtual #57                 // Method org/apache/wss4j/dom/processor/BinarySecurityTokenProcessor.handleToken:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Ljava/util/List;
      91: astore        7
      93: aload         7
      95: areturn
    Exception table:
       from    to  target type
          31    41    44   Class java/lang/Exception

  protected org.apache.wss4j.policy.model.AbstractToken assertTokens(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aconst_null
       1: areturn

  protected void addToken(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #58                 // Method getSecurityToken:(Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
       5: astore_2
       6: aload_2
       7: ifnull        17
      10: aload_2
      11: invokevirtual #59                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
      14: ifnonnull     18
      17: return
      18: aload_0
      19: aload_1
      20: invokevirtual #24                 // Method assertTokens:(Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/wss4j/policy/model/AbstractToken;
      23: pop
      24: aload_0
      25: aload_1
      26: iconst_1
      27: invokevirtual #2                  // Method findSecurityHeader:(Lorg/apache/cxf/binding/soap/SoapMessage;Z)Lorg/apache/cxf/headers/Header;
      30: astore_3
      31: aload_3
      32: invokevirtual #3                  // Method org/apache/cxf/headers/Header.getObject:()Ljava/lang/Object;
      35: checkcast     #4                  // class org/w3c/dom/Element
      38: astore        4
      40: aload         4
      42: aload         4
      44: invokeinterface #41,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
      49: aload_2
      50: invokevirtual #59                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
      53: iconst_1
      54: invokeinterface #60,  3           // InterfaceMethod org/w3c/dom/Document.importNode:(Lorg/w3c/dom/Node;Z)Lorg/w3c/dom/Node;
      59: invokeinterface #61,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      64: pop
      65: return

  private org.apache.cxf.ws.security.tokenstore.SecurityToken getSecurityToken(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_1
       1: ldc           #62                 // String ws-security.token
       3: invokevirtual #63                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
       6: instanceof    #64                 // class org/apache/cxf/ws/security/tokenstore/SecurityToken
       9: ifeq          22
      12: aload_1
      13: ldc           #62                 // String ws-security.token
      15: invokevirtual #63                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      18: checkcast     #64                 // class org/apache/cxf/ws/security/tokenstore/SecurityToken
      21: areturn
      22: aload_0
      23: aload_1
      24: invokevirtual #65                 // Method getTokenStore:(Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      27: astore_2
      28: aload_2
      29: ifnonnull     34
      32: aconst_null
      33: areturn
      34: aload_1
      35: ldc           #66                 // String ws-security.token.id
      37: invokevirtual #63                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      40: checkcast     #67                 // class java/lang/String
      43: astore_3
      44: aload_3
      45: ifnull        56
      48: aload_2
      49: aload_3
      50: invokeinterface #68,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.getToken:(Ljava/lang/String;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      55: areturn
      56: aconst_null
      57: areturn
}
