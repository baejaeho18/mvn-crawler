Compiled from "SamlTokenInterceptor.java"
public class org.apache.cxf.ws.security.wss4j.SamlTokenInterceptor extends org.apache.cxf.ws.security.wss4j.AbstractTokenInterceptor {
  public org.apache.cxf.ws.security.wss4j.SamlTokenInterceptor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/AbstractTokenInterceptor."<init>":()V
       4: return

  protected void processToken(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_0
       1: aload_1
       2: iconst_0
       3: invokevirtual #2                  // Method findSecurityHeader:(Lorg/apache/cxf/binding/soap/SoapMessage;Z)Lorg/apache/cxf/headers/Header;
       6: astore_2
       7: aload_2
       8: ifnonnull     12
      11: return
      12: aload_2
      13: invokevirtual #3                  // Method org/apache/cxf/headers/Header.getObject:()Ljava/lang/Object;
      16: checkcast     #4                  // class org/w3c/dom/Element
      19: astore_3
      20: aload_3
      21: invokestatic  #5                  // Method org/apache/cxf/helpers/DOMUtils.getFirstElement:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Element;
      24: astore        4
      26: aload         4
      28: ifnull        541
      31: ldc           #6                  // String Assertion
      33: aload         4
      35: invokeinterface #7,  1            // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      40: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      43: ifeq          531
      46: ldc           #9                  // String urn:oasis:names:tc:SAML:1.0:assertion
      48: aload         4
      50: invokeinterface #10,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      55: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      58: ifne          76
      61: ldc           #11                 // String urn:oasis:names:tc:SAML:2.0:assertion
      63: aload         4
      65: invokeinterface #10,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      70: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      73: ifeq          531
      76: aload_0
      77: aload         4
      79: aload_1
      80: invokespecial #12                 // Method processToken:(Lorg/w3c/dom/Element;Lorg/apache/cxf/binding/soap/SoapMessage;)Ljava/util/List;
      83: astore        5
      85: aload         5
      87: ifnull        515
      90: aload_1
      91: ldc           #13                 // String RECV_RESULTS
      93: invokevirtual #14                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Object;)Ljava/lang/Object;
      96: checkcast     #15                 // class java/util/List
      99: invokestatic  #16                 // Method org/apache/cxf/helpers/CastUtils.cast:(Ljava/util/List;)Ljava/util/List;
     102: astore        6
     104: aload         6
     106: ifnonnull     127
     109: new           #17                 // class java/util/ArrayList
     112: dup
     113: invokespecial #18                 // Method java/util/ArrayList."<init>":()V
     116: astore        6
     118: aload_1
     119: ldc           #13                 // String RECV_RESULTS
     121: aload         6
     123: invokevirtual #19                 // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     126: pop
     127: iconst_0
     128: istore        7
     130: aload         5
     132: invokeinterface #20,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     137: astore        8
     139: aload         8
     141: invokeinterface #21,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     146: ifeq          190
     149: aload         8
     151: invokeinterface #22,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     156: checkcast     #23                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     159: astore        9
     161: aload         9
     163: ldc           #24                 // String saml-assertion
     165: invokevirtual #25                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     168: checkcast     #26                 // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     171: astore        10
     173: aload         10
     175: invokevirtual #27                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.isSigned:()Z
     178: ifeq          187
     181: iconst_1
     182: istore        7
     184: goto          190
     187: goto          139
     190: aload_0
     191: aload_1
     192: ldc           #28                 // String SamlToken
     194: iload         7
     196: invokevirtual #29                 // Method assertTokens:(Lorg/apache/cxf/binding/soap/SoapMessage;Ljava/lang/String;Z)Lorg/apache/wss4j/policy/model/AbstractToken;
     199: pop
     200: bipush        8
     202: invokestatic  #30                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     205: astore        8
     207: iload         7
     209: ifeq          219
     212: bipush        16
     214: invokestatic  #30                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     217: astore        8
     219: new           #31                 // class org/apache/wss4j/dom/handler/WSHandlerResult
     222: dup
     223: aconst_null
     224: aload         5
     226: aload         8
     228: aload         5
     230: invokestatic  #32                 // Method java/util/Collections.singletonMap:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/util/Map;
     233: invokespecial #33                 // Method org/apache/wss4j/dom/handler/WSHandlerResult."<init>":(Ljava/lang/String;Ljava/util/List;Ljava/util/Map;)V
     236: astore        9
     238: aload         6
     240: iconst_0
     241: aload         9
     243: invokeinterface #34,  3           // InterfaceMethod java/util/List.add:(ILjava/lang/Object;)V
     248: aload_1
     249: ldc_w         #35                 // class org/apache/cxf/ws/policy/AssertionInfoMap
     252: invokevirtual #36                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
     255: checkcast     #35                 // class org/apache/cxf/ws/policy/AssertionInfoMap
     258: astore        10
     260: aload         10
     262: ldc           #28                 // String SamlToken
     264: invokestatic  #37                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
     267: invokeinterface #38,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     272: astore        11
     274: aload         11
     276: invokeinterface #21,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     281: ifeq          445
     284: aload         11
     286: invokeinterface #22,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     291: checkcast     #39                 // class org/apache/cxf/ws/policy/AssertionInfo
     294: astore        12
     296: aload         12
     298: invokevirtual #40                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     301: checkcast     #41                 // class org/apache/wss4j/policy/model/SamlToken
     304: astore        13
     306: aload         5
     308: invokeinterface #20,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     313: astore        14
     315: aload         14
     317: invokeinterface #21,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     322: ifeq          442
     325: aload         14
     327: invokeinterface #22,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     332: checkcast     #23                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     335: astore        15
     337: aload         15
     339: ldc           #24                 // String saml-assertion
     341: invokevirtual #25                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     344: checkcast     #26                 // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     347: astore        16
     349: aload_0
     350: aload         10
     352: aload         13
     354: aload         16
     356: invokespecial #42                 // Method checkVersion:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Lorg/apache/wss4j/policy/model/SamlToken;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)Z
     359: ifne          369
     362: aload         12
     364: ldc           #43                 // String Wrong SAML Version
     366: invokevirtual #44                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     369: aload_1
     370: ldc_w         #45                 // class org/apache/cxf/security/transport/TLSSessionInfo
     373: invokevirtual #36                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
     376: checkcast     #45                 // class org/apache/cxf/security/transport/TLSSessionInfo
     379: astore        17
     381: aconst_null
     382: astore        18
     384: aload         17
     386: ifnull        396
     389: aload         17
     391: invokevirtual #46                 // Method org/apache/cxf/security/transport/TLSSessionInfo.getPeerCertificates:()[Ljava/security/cert/Certificate;
     394: astore        18
     396: aload         16
     398: aconst_null
     399: aload         18
     401: invokestatic  #47                 // Method org/apache/wss4j/dom/saml/DOMSAMLUtil.checkHolderOfKey:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Ljava/util/List;[Ljava/security/cert/Certificate;)Z
     404: ifne          417
     407: aload         12
     409: ldc           #48                 // String Assertion fails holder-of-key requirements
     411: invokevirtual #44                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     414: goto          315
     417: aload         16
     419: aload         18
     421: aconst_null
     422: aconst_null
     423: invokestatic  #49                 // Method org/apache/wss4j/dom/saml/DOMSAMLUtil.checkSenderVouches:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;[Ljava/security/cert/Certificate;Lorg/w3c/dom/Element;Ljava/util/List;)Z
     426: ifne          439
     429: aload         12
     431: ldc           #50                 // String Assertion fails sender-vouches requirements
     433: invokevirtual #44                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     436: goto          315
     439: goto          315
     442: goto          274
     445: iload         7
     447: ifeq          515
     450: aload         5
     452: iconst_0
     453: invokeinterface #51,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     458: checkcast     #23                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     461: ldc           #52                 // String principal
     463: invokevirtual #25                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     466: checkcast     #53                 // class java/security/Principal
     469: astore        11
     471: aload_1
     472: ldc_w         #54                 // class org/apache/cxf/security/SecurityContext
     475: invokevirtual #36                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
     478: checkcast     #54                 // class org/apache/cxf/security/SecurityContext
     481: astore        12
     483: aload         12
     485: ifnull        498
     488: aload         12
     490: invokeinterface #55,  1           // InterfaceMethod org/apache/cxf/security/SecurityContext.getUserPrincipal:()Ljava/security/Principal;
     495: ifnonnull     515
     498: aload_1
     499: ldc_w         #54                 // class org/apache/cxf/security/SecurityContext
     502: new           #56                 // class org/apache/cxf/interceptor/security/DefaultSecurityContext
     505: dup
     506: aload         11
     508: aconst_null
     509: invokespecial #57                 // Method org/apache/cxf/interceptor/security/DefaultSecurityContext."<init>":(Ljava/security/Principal;Ljavax/security/auth/Subject;)V
     512: invokevirtual #58                 // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/Class;Ljava/lang/Object;)V
     515: goto          531
     518: astore        5
     520: aload_1
     521: aload_1
     522: invokevirtual #60                 // Method org/apache/cxf/binding/soap/SoapMessage.getVersion:()Lorg/apache/cxf/binding/soap/SoapVersion;
     525: aload         5
     527: invokestatic  #61                 // Method org/apache/cxf/ws/security/wss4j/WSS4JUtils.createSoapFault:(Lorg/apache/cxf/binding/soap/SoapMessage;Lorg/apache/cxf/binding/soap/SoapVersion;Lorg/apache/wss4j/common/ext/WSSecurityException;)Lorg/apache/cxf/binding/soap/SoapFault;
     530: athrow
     531: aload         4
     533: invokestatic  #62                 // Method org/apache/cxf/helpers/DOMUtils.getNextElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     536: astore        4
     538: goto          26
     541: return
    Exception table:
       from    to  target type
          76   515   518   Class org/apache/wss4j/common/ext/WSSecurityException

  private java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult> processToken(org.w3c.dom.Element, org.apache.cxf.binding.soap.SoapMessage) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #63                 // class org/apache/wss4j/dom/WSDocInfo
       3: dup
       4: aload_1
       5: invokeinterface #64,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
      10: invokespecial #65                 // Method org/apache/wss4j/dom/WSDocInfo."<init>":(Lorg/w3c/dom/Document;)V
      13: astore_3
      14: new           #66                 // class org/apache/cxf/ws/security/wss4j/CXFRequestData
      17: dup
      18: invokespecial #67                 // Method org/apache/cxf/ws/security/wss4j/CXFRequestData."<init>":()V
      21: astore        4
      23: ldc           #68                 // String security.callback-handler
      25: aload_2
      26: invokestatic  #69                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      29: astore        5
      31: aload         4
      33: aload         5
      35: invokestatic  #70                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getCallbackHandler:(Ljava/lang/Object;)Ljavax/security/auth/callback/CallbackHandler;
      38: invokevirtual #71                 // Method org/apache/wss4j/dom/handler/RequestData.setCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
      41: goto          59
      44: astore        6
      46: new           #59                 // class org/apache/wss4j/common/ext/WSSecurityException
      49: dup
      50: getstatic     #73                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      53: aload         6
      55: invokespecial #74                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      58: athrow
      59: aload         4
      61: aload_2
      62: invokevirtual #75                 // Method org/apache/wss4j/dom/handler/RequestData.setMsgContext:(Ljava/lang/Object;)V
      65: aload         4
      67: invokestatic  #76                 // Method org/apache/wss4j/dom/engine/WSSConfig.getNewInstance:()Lorg/apache/wss4j/dom/engine/WSSConfig;
      70: invokevirtual #77                 // Method org/apache/wss4j/dom/handler/RequestData.setWssConfig:(Lorg/apache/wss4j/dom/engine/WSSConfig;)V
      73: aload         4
      75: aload_0
      76: aconst_null
      77: ldc           #78                 // String security.signature.crypto
      79: ldc           #79                 // String security.signature.properties
      81: aload_2
      82: invokespecial #80                 // Method getCrypto:(Lorg/apache/wss4j/policy/model/SamlToken;Ljava/lang/String;Ljava/lang/String;Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/wss4j/common/crypto/Crypto;
      85: invokevirtual #81                 // Method org/apache/wss4j/dom/handler/RequestData.setSigVerCrypto:(Lorg/apache/wss4j/common/crypto/Crypto;)V
      88: new           #82                 // class org/apache/wss4j/dom/processor/SAMLTokenProcessor
      91: dup
      92: invokespecial #83                 // Method org/apache/wss4j/dom/processor/SAMLTokenProcessor."<init>":()V
      95: astore        6
      97: aload         6
      99: aload_1
     100: aload         4
     102: aload_3
     103: invokevirtual #84                 // Method org/apache/wss4j/dom/processor/SAMLTokenProcessor.handleToken:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Ljava/util/List;
     106: areturn
    Exception table:
       from    to  target type
          31    41    44   Class java/lang/Exception

  protected org.apache.wss4j.policy.model.AbstractToken assertTokens(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_1
       1: ldc_w         #35                 // class org/apache/cxf/ws/policy/AssertionInfoMap
       4: invokevirtual #36                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
       7: checkcast     #35                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      10: astore_2
      11: aload_2
      12: ldc           #85                 // String WssSamlV11Token10
      14: invokestatic  #86                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
      17: pop
      18: aload_2
      19: ldc           #87                 // String WssSamlV11Token11
      21: invokestatic  #86                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
      24: pop
      25: aload_2
      26: ldc           #88                 // String WssSamlV20Token11
      28: invokestatic  #86                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
      31: pop
      32: aload_0
      33: aload_1
      34: ldc           #28                 // String SamlToken
      36: iconst_1
      37: invokevirtual #29                 // Method assertTokens:(Lorg/apache/cxf/binding/soap/SoapMessage;Ljava/lang/String;Z)Lorg/apache/wss4j/policy/model/AbstractToken;
      40: areturn

  protected void addToken(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: invokestatic  #89                 // Method org/apache/wss4j/dom/engine/WSSConfig.init:()V
       3: aload_0
       4: aload_1
       5: invokevirtual #90                 // Method assertTokens:(Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/wss4j/policy/model/AbstractToken;
       8: checkcast     #41                 // class org/apache/wss4j/policy/model/SamlToken
      11: astore_2
      12: aload_0
      13: aload_1
      14: iconst_1
      15: invokevirtual #2                  // Method findSecurityHeader:(Lorg/apache/cxf/binding/soap/SoapMessage;Z)Lorg/apache/cxf/headers/Header;
      18: astore_3
      19: aload_0
      20: aload_2
      21: aload_1
      22: invokespecial #91                 // Method addSamlToken:(Lorg/apache/wss4j/policy/model/SamlToken;Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
      25: astore        4
      27: aload         4
      29: ifnonnull     102
      32: aload_1
      33: ldc_w         #35                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      36: invokevirtual #36                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      39: checkcast     #35                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      42: astore        5
      44: aload         5
      46: ldc           #28                 // String SamlToken
      48: invokestatic  #37                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      51: astore        6
      53: aload         6
      55: invokeinterface #38,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      60: astore        7
      62: aload         7
      64: invokeinterface #21,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      69: ifeq          101
      72: aload         7
      74: invokeinterface #22,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      79: checkcast     #39                 // class org/apache/cxf/ws/policy/AssertionInfo
      82: astore        8
      84: aload         8
      86: invokevirtual #92                 // Method org/apache/cxf/ws/policy/AssertionInfo.isAsserted:()Z
      89: ifeq          98
      92: aload         8
      94: iconst_0
      95: invokevirtual #93                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      98: goto          62
     101: return
     102: aload_3
     103: invokevirtual #3                  // Method org/apache/cxf/headers/Header.getObject:()Ljava/lang/Object;
     106: checkcast     #4                  // class org/w3c/dom/Element
     109: astore        5
     111: aload         5
     113: aload         4
     115: aload         5
     117: invokeinterface #64,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     122: invokevirtual #94                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.toDOM:(Lorg/w3c/dom/Document;)Lorg/w3c/dom/Element;
     125: invokeinterface #95,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     130: pop
     131: goto          147
     134: astore        4
     136: aload_0
     137: aload_2
     138: aload         4
     140: invokevirtual #96                 // Method org/apache/wss4j/common/ext/WSSecurityException.getMessage:()Ljava/lang/String;
     143: aload_1
     144: invokevirtual #97                 // Method policyNotAsserted:(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/String;Lorg/apache/cxf/binding/soap/SoapMessage;)V
     147: return
    Exception table:
       from    to  target type
          19   101   134   Class org/apache/wss4j/common/ext/WSSecurityException
         102   131   134   Class org/apache/wss4j/common/ext/WSSecurityException

  private org.apache.wss4j.common.saml.SamlAssertionWrapper addSamlToken(org.apache.wss4j.policy.model.SamlToken, org.apache.cxf.binding.soap.SoapMessage) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: ldc           #98                 // String security.saml-callback-handler
       2: aload_2
       3: invokestatic  #69                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
       6: astore_3
       7: aconst_null
       8: astore        4
      10: aload_3
      11: instanceof    #99                 // class javax/security/auth/callback/CallbackHandler
      14: ifeq          26
      17: aload_3
      18: checkcast     #99                 // class javax/security/auth/callback/CallbackHandler
      21: astore        4
      23: goto          60
      26: aload_3
      27: instanceof    #100                // class java/lang/String
      30: ifeq          60
      33: aload_3
      34: checkcast     #100                // class java/lang/String
      37: aload_0
      38: invokevirtual #101                // Method java/lang/Object.getClass:()Ljava/lang/Class;
      41: invokestatic  #102                // Method org/apache/cxf/common/classloader/ClassLoaderUtils.loadClass:(Ljava/lang/String;Ljava/lang/Class;)Ljava/lang/Class;
      44: invokevirtual #103                // Method java/lang/Class.newInstance:()Ljava/lang/Object;
      47: checkcast     #99                 // class javax/security/auth/callback/CallbackHandler
      50: astore        4
      52: goto          60
      55: astore        5
      57: aconst_null
      58: astore        4
      60: aload         4
      62: ifnonnull     67
      65: aconst_null
      66: areturn
      67: aload_2
      68: ldc_w         #35                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      71: invokevirtual #36                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      74: checkcast     #35                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      77: astore        5
      79: new           #104                // class org/apache/wss4j/common/saml/SAMLCallback
      82: dup
      83: invokespecial #105                // Method org/apache/wss4j/common/saml/SAMLCallback."<init>":()V
      86: astore        6
      88: aload_1
      89: invokevirtual #106                // Method org/apache/wss4j/policy/model/SamlToken.getSamlTokenType:()Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
      92: astore        7
      94: aload         7
      96: getstatic     #107                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV11Token10:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
      99: if_acmpeq     110
     102: aload         7
     104: getstatic     #108                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV11Token11:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
     107: if_acmpne     137
     110: aload         6
     112: getstatic     #109                // Field org/apache/wss4j/common/saml/bean/Version.SAML_11:Lorg/apache/wss4j/common/saml/bean/Version;
     115: invokevirtual #110                // Method org/apache/wss4j/common/saml/SAMLCallback.setSamlVersion:(Lorg/apache/wss4j/common/saml/bean/Version;)V
     118: aload         5
     120: ldc           #85                 // String WssSamlV11Token10
     122: invokestatic  #86                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
     125: pop
     126: aload         5
     128: ldc           #87                 // String WssSamlV11Token11
     130: invokestatic  #86                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
     133: pop
     134: goto          161
     137: aload         7
     139: getstatic     #111                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV20Token11:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
     142: if_acmpne     161
     145: aload         6
     147: getstatic     #112                // Field org/apache/wss4j/common/saml/bean/Version.SAML_20:Lorg/apache/wss4j/common/saml/bean/Version;
     150: invokevirtual #110                // Method org/apache/wss4j/common/saml/SAMLCallback.setSamlVersion:(Lorg/apache/wss4j/common/saml/bean/Version;)V
     153: aload         5
     155: ldc           #88                 // String WssSamlV20Token11
     157: invokestatic  #86                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
     160: pop
     161: aload         4
     163: aload         6
     165: invokestatic  #113                // Method org/apache/wss4j/common/saml/SAMLUtil.doSAMLCallback:(Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/wss4j/common/saml/SAMLCallback;)V
     168: new           #26                 // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     171: dup
     172: aload         6
     174: invokespecial #114                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper."<init>":(Lorg/apache/wss4j/common/saml/SAMLCallback;)V
     177: astore        8
     179: aload         6
     181: invokevirtual #115                // Method org/apache/wss4j/common/saml/SAMLCallback.isSignAssertion:()Z
     184: ifeq          306
     187: aload         6
     189: invokevirtual #116                // Method org/apache/wss4j/common/saml/SAMLCallback.getIssuerKeyName:()Ljava/lang/String;
     192: astore        9
     194: aload         9
     196: ifnonnull     214
     199: ldc           #117                // String security.signature.username
     201: astore        10
     203: aload         10
     205: aload_2
     206: invokestatic  #69                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     209: checkcast     #100                // class java/lang/String
     212: astore        9
     214: aload         6
     216: invokevirtual #118                // Method org/apache/wss4j/common/saml/SAMLCallback.getIssuerKeyPassword:()Ljava/lang/String;
     219: astore        10
     221: aload         10
     223: ifnonnull     256
     226: ldc           #119                // String security.password
     228: aload_2
     229: invokestatic  #69                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     232: checkcast     #100                // class java/lang/String
     235: astore        10
     237: aload         10
     239: invokestatic  #120                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     242: ifeq          256
     245: aload_0
     246: aload         9
     248: aload_1
     249: iconst_3
     250: aload_2
     251: invokevirtual #121                // Method getPassword:(Ljava/lang/String;Lorg/apache/wss4j/policy/model/AbstractToken;ILorg/apache/cxf/binding/soap/SoapMessage;)Ljava/lang/String;
     254: astore        10
     256: aload         6
     258: invokevirtual #122                // Method org/apache/wss4j/common/saml/SAMLCallback.getIssuerCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     261: astore        11
     263: aload         11
     265: ifnonnull     280
     268: aload_0
     269: aload_1
     270: ldc           #78                 // String security.signature.crypto
     272: ldc           #79                 // String security.signature.properties
     274: aload_2
     275: invokespecial #80                 // Method getCrypto:(Lorg/apache/wss4j/policy/model/SamlToken;Ljava/lang/String;Ljava/lang/String;Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/wss4j/common/crypto/Crypto;
     278: astore        11
     280: aload         8
     282: aload         9
     284: aload         10
     286: aload         11
     288: aload         6
     290: invokevirtual #123                // Method org/apache/wss4j/common/saml/SAMLCallback.isSendKeyValue:()Z
     293: aload         6
     295: invokevirtual #124                // Method org/apache/wss4j/common/saml/SAMLCallback.getCanonicalizationAlgorithm:()Ljava/lang/String;
     298: aload         6
     300: invokevirtual #125                // Method org/apache/wss4j/common/saml/SAMLCallback.getSignatureAlgorithm:()Ljava/lang/String;
     303: invokevirtual #126                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.signAssertion:(Ljava/lang/String;Ljava/lang/String;Lorg/apache/wss4j/common/crypto/Crypto;ZLjava/lang/String;Ljava/lang/String;)V
     306: aload         8
     308: areturn
    Exception table:
       from    to  target type
          33    52    55   Class java/lang/Exception

  private org.apache.wss4j.common.crypto.Crypto getCrypto(org.apache.wss4j.policy.model.SamlToken, java.lang.String, java.lang.String, org.apache.cxf.binding.soap.SoapMessage) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_2
       1: aload         4
       3: invokestatic  #69                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
       6: checkcast     #127                // class org/apache/wss4j/common/crypto/Crypto
       9: astore        5
      11: aload         5
      13: ifnull        19
      16: aload         5
      18: areturn
      19: aload_3
      20: aload         4
      22: invokestatic  #69                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      25: astore        6
      27: aload         6
      29: ifnonnull     34
      32: aconst_null
      33: areturn
      34: aload         4
      36: aload         6
      38: invokestatic  #128                // Method org/apache/cxf/rt/security/utils/SecurityUtils.loadResource:(Lorg/apache/cxf/message/Message;Ljava/lang/Object;)Ljava/net/URL;
      41: astore        7
      43: aload         6
      45: aload         7
      47: invokestatic  #129                // Method org/apache/cxf/ws/security/wss4j/WSS4JUtils.getProps:(Ljava/lang/Object;Ljava/net/URL;)Ljava/util/Properties;
      50: astore        8
      52: aload         8
      54: ifnull        64
      57: aload         8
      59: invokestatic  #130                // Method org/apache/wss4j/common/crypto/CryptoFactory.getInstance:(Ljava/util/Properties;)Lorg/apache/wss4j/common/crypto/Crypto;
      62: astore        5
      64: aload         5
      66: areturn

  private boolean checkVersion(org.apache.cxf.ws.policy.AssertionInfoMap, org.apache.wss4j.policy.model.SamlToken, org.apache.wss4j.common.saml.SamlAssertionWrapper);
    Code:
       0: aload_2
       1: invokevirtual #106                // Method org/apache/wss4j/policy/model/SamlToken.getSamlTokenType:()Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
       4: astore        4
       6: aload         4
       8: getstatic     #107                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV11Token10:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
      11: if_acmpeq     22
      14: aload         4
      16: getstatic     #108                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV11Token11:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
      19: if_acmpne     34
      22: aload_3
      23: invokevirtual #131                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSamlVersion:()Lorg/opensaml/saml/common/SAMLVersion;
      26: getstatic     #132                // Field org/opensaml/saml/common/SAMLVersion.VERSION_11:Lorg/opensaml/saml/common/SAMLVersion;
      29: if_acmpeq     34
      32: iconst_0
      33: ireturn
      34: aload         4
      36: getstatic     #111                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV20Token11:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
      39: if_acmpne     54
      42: aload_3
      43: invokevirtual #131                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSamlVersion:()Lorg/opensaml/saml/common/SAMLVersion;
      46: getstatic     #133                // Field org/opensaml/saml/common/SAMLVersion.VERSION_20:Lorg/opensaml/saml/common/SAMLVersion;
      49: if_acmpeq     54
      52: iconst_0
      53: ireturn
      54: aload_1
      55: new           #134                // class javax/xml/namespace/QName
      58: dup
      59: aload_2
      60: invokevirtual #135                // Method org/apache/wss4j/policy/model/SamlToken.getVersion:()Lorg/apache/wss4j/policy/SPConstants$SPVersion;
      63: invokevirtual #136                // Method org/apache/wss4j/policy/SPConstants$SPVersion.getNamespace:()Ljava/lang/String;
      66: aload         4
      68: invokevirtual #137                // Method org/apache/wss4j/policy/model/SamlToken$SamlTokenType.name:()Ljava/lang/String;
      71: invokespecial #138                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      74: invokestatic  #139                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      77: pop
      78: iconst_1
      79: ireturn
}
