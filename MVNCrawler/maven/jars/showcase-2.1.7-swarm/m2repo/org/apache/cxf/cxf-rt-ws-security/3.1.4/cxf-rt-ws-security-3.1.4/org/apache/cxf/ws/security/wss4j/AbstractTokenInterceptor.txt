Compiled from "AbstractTokenInterceptor.java"
public abstract class org.apache.cxf.ws.security.wss4j.AbstractTokenInterceptor extends org.apache.cxf.binding.soap.interceptor.AbstractSoapInterceptor {
  private static final java.util.logging.Logger LOG;

  private static final java.util.Set<javax.xml.namespace.QName> HEADERS;

  public org.apache.cxf.ws.security.wss4j.AbstractTokenInterceptor();
    Code:
       0: aload_0
       1: ldc           #1                  // String pre-protocol
       3: invokespecial #2                  // Method org/apache/cxf/binding/soap/interceptor/AbstractSoapInterceptor."<init>":(Ljava/lang/String;)V
       6: aload_0
       7: ldc_w         #3                  // class org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JOutInterceptor
      10: invokevirtual #4                  // Method java/lang/Class.getName:()Ljava/lang/String;
      13: invokevirtual #5                  // Method addAfter:(Ljava/lang/String;)V
      16: aload_0
      17: ldc_w         #6                  // class org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JInInterceptor
      20: invokevirtual #4                  // Method java/lang/Class.getName:()Ljava/lang/String;
      23: invokevirtual #5                  // Method addAfter:(Ljava/lang/String;)V
      26: aload_0
      27: ldc_w         #7                  // class org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JStaxInInterceptor
      30: invokevirtual #4                  // Method java/lang/Class.getName:()Ljava/lang/String;
      33: invokevirtual #5                  // Method addAfter:(Ljava/lang/String;)V
      36: return

  public java.util.Set<javax.xml.namespace.QName> getUnderstoodHeaders();
    Code:
       0: getstatic     #8                  // Field HEADERS:Ljava/util/Set;
       3: areturn

  public void handleMessage(org.apache.cxf.binding.soap.SoapMessage) throws org.apache.cxf.interceptor.Fault;
    Code:
       0: aload_1
       1: ldc           #9                  // String ws-security.enable.streaming
       3: invokevirtual #10                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
       6: invokestatic  #11                 // Method org/apache/cxf/message/MessageUtils.isTrue:(Ljava/lang/Object;)Z
       9: istore_2
      10: iload_2
      11: ifeq          15
      14: return
      15: aload_1
      16: invokestatic  #12                 // Method org/apache/cxf/message/MessageUtils.isRequestor:(Lorg/apache/cxf/message/Message;)Z
      19: istore_3
      20: aload_1
      21: invokestatic  #13                 // Method org/apache/cxf/message/MessageUtils.isOutbound:(Lorg/apache/cxf/message/Message;)Z
      24: istore        4
      26: iload_3
      27: iload         4
      29: if_icmpeq     39
      32: aload_0
      33: aload_1
      34: invokevirtual #14                 // Method assertTokens:(Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/wss4j/policy/model/AbstractToken;
      37: pop
      38: return
      39: iload_3
      40: ifeq          62
      43: aload_1
      44: getstatic     #15                 // Field org/apache/cxf/ws/security/wss4j/PolicyBasedWSS4JOutInterceptor.SECURITY_PROCESSED:Ljava/lang/String;
      47: invokevirtual #16                 // Method org/apache/cxf/binding/soap/SoapMessage.containsKey:(Ljava/lang/Object;)Z
      50: ifeq          54
      53: return
      54: aload_0
      55: aload_1
      56: invokevirtual #17                 // Method addToken:(Lorg/apache/cxf/binding/soap/SoapMessage;)V
      59: goto          78
      62: aload_1
      63: getstatic     #18                 // Field org/apache/cxf/ws/security/wss4j/WSS4JInInterceptor.SECURITY_PROCESSED:Ljava/lang/String;
      66: invokevirtual #16                 // Method org/apache/cxf/binding/soap/SoapMessage.containsKey:(Ljava/lang/Object;)Z
      69: ifeq          73
      72: return
      73: aload_0
      74: aload_1
      75: invokevirtual #19                 // Method processToken:(Lorg/apache/cxf/binding/soap/SoapMessage;)V
      78: return

  protected abstract void processToken(org.apache.cxf.binding.soap.SoapMessage);

  protected abstract void addToken(org.apache.cxf.binding.soap.SoapMessage);

  protected abstract org.apache.wss4j.policy.model.AbstractToken assertTokens(org.apache.cxf.binding.soap.SoapMessage);

  protected org.apache.wss4j.policy.model.AbstractToken assertTokens(org.apache.cxf.binding.soap.SoapMessage, java.lang.String, boolean);
    Code:
       0: aload_1
       1: ldc_w         #20                 // class org/apache/cxf/ws/policy/AssertionInfoMap
       4: invokevirtual #21                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
       7: checkcast     #20                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      10: astore        4
      12: aload         4
      14: aload_2
      15: invokestatic  #22                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      18: astore        5
      20: aconst_null
      21: astore        6
      23: aload         5
      25: invokeinterface #23,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      30: astore        7
      32: aload         7
      34: invokeinterface #24,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      39: ifeq          73
      42: aload         7
      44: invokeinterface #25,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      49: checkcast     #26                 // class org/apache/cxf/ws/policy/AssertionInfo
      52: astore        8
      54: aload         8
      56: invokevirtual #27                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      59: checkcast     #28                 // class org/apache/wss4j/policy/model/AbstractToken
      62: astore        6
      64: aload         8
      66: iconst_1
      67: invokevirtual #29                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      70: goto          32
      73: aload         4
      75: ldc           #30                 // String SupportingTokens
      77: invokestatic  #31                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
      80: pop
      81: iload_3
      82: ifne          93
      85: aload_0
      86: aload_1
      87: invokevirtual #32                 // Method isTLSInUse:(Lorg/apache/cxf/binding/soap/SoapMessage;)Z
      90: ifeq          101
      93: aload         4
      95: ldc           #33                 // String SignedSupportingTokens
      97: invokestatic  #31                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
     100: pop
     101: aload         6
     103: areturn

  protected boolean isTLSInUse(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_1
       1: ldc_w         #34                 // class org/apache/cxf/security/transport/TLSSessionInfo
       4: invokevirtual #21                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
       7: checkcast     #34                 // class org/apache/cxf/security/transport/TLSSessionInfo
      10: astore_2
      11: aload_2
      12: ifnull        19
      15: iconst_1
      16: goto          20
      19: iconst_0
      20: ireturn

  protected org.apache.cxf.ws.security.tokenstore.TokenStore getTokenStore(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_1
       1: invokevirtual #35                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
       4: invokeinterface #36,  1           // InterfaceMethod org/apache/cxf/message/Exchange.getEndpoint:()Lorg/apache/cxf/endpoint/Endpoint;
       9: invokeinterface #37,  1           // InterfaceMethod org/apache/cxf/endpoint/Endpoint.getEndpointInfo:()Lorg/apache/cxf/service/model/EndpointInfo;
      14: astore_2
      15: aload_2
      16: dup
      17: astore_3
      18: monitorenter
      19: aload_1
      20: ldc           #38                 // String org.apache.cxf.ws.security.tokenstore.TokenStore
      22: invokevirtual #10                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      25: checkcast     #39                 // class org/apache/cxf/ws/security/tokenstore/TokenStore
      28: astore        4
      30: aload         4
      32: ifnonnull     46
      35: aload_2
      36: ldc           #38                 // String org.apache.cxf.ws.security.tokenstore.TokenStore
      38: invokevirtual #40                 // Method org/apache/cxf/service/model/EndpointInfo.getProperty:(Ljava/lang/String;)Ljava/lang/Object;
      41: checkcast     #39                 // class org/apache/cxf/ws/security/tokenstore/TokenStore
      44: astore        4
      46: aload         4
      48: aload_3
      49: monitorexit
      50: areturn
      51: astore        5
      53: aload_3
      54: monitorexit
      55: aload         5
      57: athrow
    Exception table:
       from    to  target type
          19    50    51   any
          51    55    51   any

  protected org.apache.cxf.headers.Header findSecurityHeader(org.apache.cxf.binding.soap.SoapMessage, boolean);
    Code:
       0: aload_1
       1: invokevirtual #41                 // Method org/apache/cxf/binding/soap/SoapMessage.getHeaders:()Ljava/util/List;
       4: invokeinterface #42,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
       9: astore_3
      10: aload_3
      11: invokeinterface #24,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      16: ifeq          82
      19: aload_3
      20: invokeinterface #25,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      25: checkcast     #43                 // class org/apache/cxf/headers/Header
      28: astore        4
      30: aload         4
      32: invokevirtual #44                 // Method org/apache/cxf/headers/Header.getName:()Ljavax/xml/namespace/QName;
      35: astore        5
      37: aload         5
      39: invokevirtual #45                 // Method javax/xml/namespace/QName.getLocalPart:()Ljava/lang/String;
      42: ldc           #46                 // String Security
      44: invokevirtual #47                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      47: ifeq          79
      50: aload         5
      52: invokevirtual #48                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
      55: ldc           #49                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
      57: invokevirtual #47                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      60: ifne          76
      63: aload         5
      65: invokevirtual #48                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
      68: ldc           #50                 // String http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd
      70: invokevirtual #47                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      73: ifeq          79
      76: aload         4
      78: areturn
      79: goto          10
      82: iload_2
      83: ifne          88
      86: aconst_null
      87: areturn
      88: invokestatic  #51                 // Method org/apache/cxf/helpers/DOMUtils.createDocument:()Lorg/w3c/dom/Document;
      91: astore_3
      92: aload_3
      93: ldc           #49                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
      95: ldc           #52                 // String wsse:Security
      97: invokeinterface #53,  3           // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     102: astore        4
     104: aload         4
     106: ldc           #54                 // String http://www.w3.org/2000/xmlns/
     108: ldc           #55                 // String xmlns:wsse
     110: ldc           #49                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
     112: invokeinterface #56,  4           // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     117: new           #57                 // class org/apache/cxf/binding/soap/SoapHeader
     120: dup
     121: new           #58                 // class javax/xml/namespace/QName
     124: dup
     125: ldc           #49                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
     127: ldc           #46                 // String Security
     129: invokespecial #59                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     132: aload         4
     134: invokespecial #60                 // Method org/apache/cxf/binding/soap/SoapHeader."<init>":(Ljavax/xml/namespace/QName;Ljava/lang/Object;)V
     137: astore        5
     139: aload         5
     141: iconst_1
     142: invokevirtual #61                 // Method org/apache/cxf/binding/soap/SoapHeader.setMustUnderstand:(Z)V
     145: aload_1
     146: invokevirtual #41                 // Method org/apache/cxf/binding/soap/SoapMessage.getHeaders:()Ljava/util/List;
     149: aload         5
     151: invokeinterface #62,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     156: pop
     157: aload         5
     159: areturn

  protected java.lang.String getPassword(java.lang.String, org.apache.wss4j.policy.model.AbstractToken, int, org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aconst_null
       1: astore        5
       3: ldc           #63                 // String security.callback-handler
       5: aload         4
       7: invokestatic  #64                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      10: astore        6
      12: aload         6
      14: invokestatic  #65                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getCallbackHandler:(Ljava/lang/Object;)Ljavax/security/auth/callback/CallbackHandler;
      17: astore        5
      19: aload         5
      21: ifnonnull     35
      24: aload_0
      25: aload_2
      26: ldc           #66                 // String No callback handler and no password available
      28: aload         4
      30: invokevirtual #67                 // Method policyNotAsserted:(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/String;Lorg/apache/cxf/binding/soap/SoapMessage;)V
      33: aconst_null
      34: areturn
      35: goto          51
      38: astore        6
      40: aload_0
      41: aload_2
      42: ldc           #66                 // String No callback handler and no password available
      44: aload         4
      46: invokevirtual #67                 // Method policyNotAsserted:(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/String;Lorg/apache/cxf/binding/soap/SoapMessage;)V
      49: aconst_null
      50: areturn
      51: iconst_1
      52: anewarray     #69                 // class org/apache/wss4j/common/ext/WSPasswordCallback
      55: dup
      56: iconst_0
      57: new           #69                 // class org/apache/wss4j/common/ext/WSPasswordCallback
      60: dup
      61: aload_1
      62: iload_3
      63: invokespecial #70                 // Method org/apache/wss4j/common/ext/WSPasswordCallback."<init>":(Ljava/lang/String;I)V
      66: aastore
      67: astore        6
      69: aload         5
      71: aload         6
      73: invokeinterface #71,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      78: goto          92
      81: astore        7
      83: aload_0
      84: aload_2
      85: aload         7
      87: aload         4
      89: invokevirtual #72                 // Method policyNotAsserted:(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/Exception;Lorg/apache/cxf/binding/soap/SoapMessage;)V
      92: aload         6
      94: iconst_0
      95: aaload
      96: invokevirtual #73                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
      99: areturn
    Exception table:
       from    to  target type
           3    34    38   Class java/lang/Exception
          69    78    81   Class java/lang/Exception

  protected void policyNotAsserted(org.apache.wss4j.policy.model.AbstractToken, java.lang.String, org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_1
       1: ifnonnull     5
       4: return
       5: aload_3
       6: ldc_w         #20                 // class org/apache/cxf/ws/policy/AssertionInfoMap
       9: invokevirtual #21                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      12: checkcast     #20                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      15: astore        4
      17: aload         4
      19: aload_1
      20: invokevirtual #74                 // Method org/apache/wss4j/policy/model/AbstractToken.getName:()Ljavax/xml/namespace/QName;
      23: invokevirtual #75                 // Method org/apache/cxf/ws/policy/AssertionInfoMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
      26: checkcast     #76                 // class java/util/Collection
      29: astore        5
      31: aload         5
      33: ifnull        85
      36: aload         5
      38: invokeinterface #23,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      43: astore        6
      45: aload         6
      47: invokeinterface #24,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      52: ifeq          85
      55: aload         6
      57: invokeinterface #25,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      62: checkcast     #26                 // class org/apache/cxf/ws/policy/AssertionInfo
      65: astore        7
      67: aload         7
      69: invokevirtual #27                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      72: aload_1
      73: if_acmpne     82
      76: aload         7
      78: aload_2
      79: invokevirtual #77                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
      82: goto          45
      85: aload_1
      86: invokevirtual #78                 // Method org/apache/wss4j/policy/model/AbstractToken.isOptional:()Z
      89: ifne          115
      92: new           #79                 // class org/apache/cxf/ws/policy/PolicyException
      95: dup
      96: new           #80                 // class org/apache/cxf/common/i18n/Message
      99: dup
     100: aload_2
     101: getstatic     #81                 // Field LOG:Ljava/util/logging/Logger;
     104: iconst_0
     105: anewarray     #82                 // class java/lang/Object
     108: invokespecial #83                 // Method org/apache/cxf/common/i18n/Message."<init>":(Ljava/lang/String;Ljava/util/logging/Logger;[Ljava/lang/Object;)V
     111: invokespecial #84                 // Method org/apache/cxf/ws/policy/PolicyException."<init>":(Lorg/apache/cxf/common/i18n/Message;)V
     114: athrow
     115: return

  protected void policyNotAsserted(org.apache.wss4j.policy.model.AbstractToken, java.lang.Exception, org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_1
       1: ifnonnull     5
       4: return
       5: aload_3
       6: ldc_w         #20                 // class org/apache/cxf/ws/policy/AssertionInfoMap
       9: invokevirtual #21                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      12: checkcast     #20                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      15: astore        4
      17: aload         4
      19: aload_1
      20: invokevirtual #74                 // Method org/apache/wss4j/policy/model/AbstractToken.getName:()Ljavax/xml/namespace/QName;
      23: invokevirtual #75                 // Method org/apache/cxf/ws/policy/AssertionInfoMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
      26: checkcast     #76                 // class java/util/Collection
      29: astore        5
      31: aload         5
      33: ifnull        88
      36: aload         5
      38: invokeinterface #23,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      43: astore        6
      45: aload         6
      47: invokeinterface #24,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      52: ifeq          88
      55: aload         6
      57: invokeinterface #25,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      62: checkcast     #26                 // class org/apache/cxf/ws/policy/AssertionInfo
      65: astore        7
      67: aload         7
      69: invokevirtual #27                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      72: aload_1
      73: if_acmpne     85
      76: aload         7
      78: aload_2
      79: invokevirtual #85                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
      82: invokevirtual #77                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
      85: goto          45
      88: new           #79                 // class org/apache/cxf/ws/policy/PolicyException
      91: dup
      92: aload_2
      93: invokespecial #86                 // Method org/apache/cxf/ws/policy/PolicyException."<init>":(Ljava/lang/Throwable;)V
      96: athrow

  public void handleMessage(org.apache.cxf.message.Message) throws org.apache.cxf.interceptor.Fault;
    Code:
       0: aload_0
       1: aload_1
       2: checkcast     #87                 // class org/apache/cxf/binding/soap/SoapMessage
       5: invokevirtual #88                 // Method handleMessage:(Lorg/apache/cxf/binding/soap/SoapMessage;)V
       8: return

  static {};
    Code:
       0: ldc_w         #89                 // class org/apache/cxf/binding/soap/interceptor/AbstractSoapInterceptor
       3: invokestatic  #90                 // Method org/apache/cxf/common/logging/LogUtils.getL7dLogger:(Ljava/lang/Class;)Ljava/util/logging/Logger;
       6: putstatic     #81                 // Field LOG:Ljava/util/logging/Logger;
       9: new           #58                 // class javax/xml/namespace/QName
      12: dup
      13: ldc           #49                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
      15: ldc           #46                 // String Security
      17: invokespecial #59                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      20: invokestatic  #91                 // Method java/util/Collections.singleton:(Ljava/lang/Object;)Ljava/util/Set;
      23: putstatic     #8                  // Field HEADERS:Ljava/util/Set;
      26: return
}
