Compiled from "SCTValidator.java"
public class org.apache.cxf.sts.token.validator.SCTValidator implements org.apache.cxf.sts.token.validator.TokenValidator {
  public static final java.lang.String SCT_VALIDATOR_SECRET;

  private static final java.util.logging.Logger LOG;

  public org.apache.cxf.sts.token.validator.SCTValidator();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public boolean canHandleToken(org.apache.cxf.sts.request.ReceivedToken);
    Code:
       0: aload_0
       1: aload_1
       2: aconst_null
       3: invokevirtual #2                  // Method canHandleToken:(Lorg/apache/cxf/sts/request/ReceivedToken;Ljava/lang/String;)Z
       6: ireturn

  public boolean canHandleToken(org.apache.cxf.sts.request.ReceivedToken, java.lang.String);
    Code:
       0: aload_1
       1: invokevirtual #3                  // Method org/apache/cxf/sts/request/ReceivedToken.getToken:()Ljava/lang/Object;
       4: astore_3
       5: aload_3
       6: instanceof    #4                  // class org/w3c/dom/Element
       9: ifeq          68
      12: aload_3
      13: checkcast     #4                  // class org/w3c/dom/Element
      16: astore        4
      18: aload         4
      20: invokeinterface #5,  1            // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      25: astore        5
      27: aload         4
      29: invokeinterface #6,  1            // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      34: astore        6
      36: ldc           #7                  // String http://schemas.xmlsoap.org/ws/2005/02/sc
      38: aload         5
      40: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      43: ifne          56
      46: ldc           #9                  // String http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512
      48: aload         5
      50: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      53: ifeq          68
      56: ldc           #10                 // String SecurityContextToken
      58: aload         6
      60: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      63: ifeq          68
      66: iconst_1
      67: ireturn
      68: iconst_0
      69: ireturn

  public org.apache.cxf.sts.token.validator.TokenValidatorResponse validateToken(org.apache.cxf.sts.token.validator.TokenValidatorParameters);
    Code:
       0: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
       3: ldc           #12                 // String Validating SecurityContextToken
       5: invokevirtual #13                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
       8: new           #14                 // class org/apache/cxf/sts/token/validator/TokenValidatorResponse
      11: dup
      12: invokespecial #15                 // Method org/apache/cxf/sts/token/validator/TokenValidatorResponse."<init>":()V
      15: astore_2
      16: aload_1
      17: invokevirtual #16                 // Method org/apache/cxf/sts/token/validator/TokenValidatorParameters.getToken:()Lorg/apache/cxf/sts/request/ReceivedToken;
      20: astore_3
      21: aload_3
      22: getstatic     #17                 // Field org/apache/cxf/sts/request/ReceivedToken$STATE.INVALID:Lorg/apache/cxf/sts/request/ReceivedToken$STATE;
      25: invokevirtual #18                 // Method org/apache/cxf/sts/request/ReceivedToken.setState:(Lorg/apache/cxf/sts/request/ReceivedToken$STATE;)V
      28: aload_2
      29: aload_3
      30: invokevirtual #19                 // Method org/apache/cxf/sts/token/validator/TokenValidatorResponse.setToken:(Lorg/apache/cxf/sts/request/ReceivedToken;)V
      33: aload_1
      34: invokevirtual #20                 // Method org/apache/cxf/sts/token/validator/TokenValidatorParameters.getTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      37: ifnonnull     53
      40: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
      43: getstatic     #21                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
      46: ldc           #22                 // String A cache must be configured to use the SCTValidator
      48: invokevirtual #23                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;)V
      51: aload_2
      52: areturn
      53: aload_3
      54: invokevirtual #24                 // Method org/apache/cxf/sts/request/ReceivedToken.isDOMElement:()Z
      57: ifeq          295
      60: aload_3
      61: invokevirtual #3                  // Method org/apache/cxf/sts/request/ReceivedToken.getToken:()Ljava/lang/Object;
      64: checkcast     #4                  // class org/w3c/dom/Element
      67: astore        4
      69: new           #25                 // class org/apache/wss4j/dom/message/token/SecurityContextToken
      72: dup
      73: aload         4
      75: invokespecial #26                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken."<init>":(Lorg/w3c/dom/Element;)V
      78: astore        5
      80: aload         5
      82: invokevirtual #27                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getIdentifier:()Ljava/lang/String;
      85: astore        6
      87: aload_1
      88: invokevirtual #20                 // Method org/apache/cxf/sts/token/validator/TokenValidatorParameters.getTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      91: aload         6
      93: invokeinterface #28,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.getToken:(Ljava/lang/String;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      98: astore        7
     100: aload         7
     102: ifnonnull     138
     105: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     108: new           #29                 // class java/lang/StringBuilder
     111: dup
     112: invokespecial #30                 // Method java/lang/StringBuilder."<init>":()V
     115: ldc           #31                 // String Identifier:
     117: invokevirtual #32                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     120: aload         6
     122: invokevirtual #32                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     125: ldc           #33                 // String  is not found in the cache
     127: invokevirtual #32                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     130: invokevirtual #34                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     133: invokevirtual #13                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
     136: aload_2
     137: areturn
     138: aload         7
     140: invokevirtual #35                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.isExpired:()Z
     143: ifeq          186
     146: aload_3
     147: getstatic     #36                 // Field org/apache/cxf/sts/request/ReceivedToken$STATE.EXPIRED:Lorg/apache/cxf/sts/request/ReceivedToken$STATE;
     150: invokevirtual #18                 // Method org/apache/cxf/sts/request/ReceivedToken.setState:(Lorg/apache/cxf/sts/request/ReceivedToken$STATE;)V
     153: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     156: new           #29                 // class java/lang/StringBuilder
     159: dup
     160: invokespecial #30                 // Method java/lang/StringBuilder."<init>":()V
     163: ldc           #37                 // String Token:
     165: invokevirtual #32                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     168: aload         6
     170: invokevirtual #32                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     173: ldc           #38                 // String  is in the cache but expired
     175: invokevirtual #32                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     178: invokevirtual #34                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     181: invokevirtual #13                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
     184: aload_2
     185: areturn
     186: aload         7
     188: invokevirtual #39                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     191: astore        8
     193: new           #40                 // class java/util/HashMap
     196: dup
     197: iconst_1
     198: invokespecial #41                 // Method java/util/HashMap."<init>":(I)V
     201: astore        9
     203: aload         9
     205: ldc           #42                 // String sct-validator-secret
     207: aload         8
     209: invokeinterface #43,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     214: pop
     215: aload_2
     216: aload         9
     218: invokevirtual #44                 // Method org/apache/cxf/sts/token/validator/TokenValidatorResponse.setAdditionalProperties:(Ljava/util/Map;)V
     221: aload_2
     222: aload         7
     224: invokevirtual #45                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getPrincipal:()Ljava/security/Principal;
     227: invokevirtual #46                 // Method org/apache/cxf/sts/token/validator/TokenValidatorResponse.setPrincipal:(Ljava/security/Principal;)V
     230: aload         7
     232: invokevirtual #47                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getProperties:()Ljava/util/Map;
     235: astore        10
     237: aload         10
     239: ifnull        262
     242: aload         10
     244: ldc           #48                 // String org.apache.cxf.sts.token.realm
     246: invokeinterface #49,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     251: checkcast     #50                 // class java/lang/String
     254: astore        11
     256: aload_2
     257: aload         11
     259: invokevirtual #51                 // Method org/apache/cxf/sts/token/validator/TokenValidatorResponse.setTokenRealm:(Ljava/lang/String;)V
     262: aload_3
     263: getstatic     #52                 // Field org/apache/cxf/sts/request/ReceivedToken$STATE.VALID:Lorg/apache/cxf/sts/request/ReceivedToken$STATE;
     266: invokevirtual #18                 // Method org/apache/cxf/sts/request/ReceivedToken.setState:(Lorg/apache/cxf/sts/request/ReceivedToken$STATE;)V
     269: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     272: ldc           #53                 // String SecurityContextToken successfully validated
     274: invokevirtual #13                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
     277: goto          295
     280: astore        4
     282: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     285: getstatic     #55                 // Field java/util/logging/Level.WARNING:Ljava/util/logging/Level;
     288: ldc           #56                 // String
     290: aload         4
     292: invokevirtual #57                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     295: aload_2
     296: areturn
    Exception table:
       from    to  target type
          60   137   280   Class org/apache/wss4j/common/ext/WSSecurityException
         138   185   280   Class org/apache/wss4j/common/ext/WSSecurityException
         186   277   280   Class org/apache/wss4j/common/ext/WSSecurityException

  static {};
    Code:
       0: ldc_w         #58                 // class org/apache/cxf/sts/token/validator/SCTValidator
       3: invokestatic  #59                 // Method org/apache/cxf/common/logging/LogUtils.getL7dLogger:(Ljava/lang/Class;)Ljava/util/logging/Logger;
       6: putstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
       9: return
}
