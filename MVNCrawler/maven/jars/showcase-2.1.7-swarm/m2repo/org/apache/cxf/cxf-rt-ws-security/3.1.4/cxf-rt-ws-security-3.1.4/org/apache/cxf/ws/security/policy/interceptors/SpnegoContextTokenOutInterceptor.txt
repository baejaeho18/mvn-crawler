Compiled from "SpnegoContextTokenOutInterceptor.java"
class org.apache.cxf.ws.security.policy.interceptors.SpnegoContextTokenOutInterceptor extends org.apache.cxf.phase.AbstractPhaseInterceptor<org.apache.cxf.binding.soap.SoapMessage> {
  org.apache.cxf.ws.security.policy.interceptors.SpnegoContextTokenOutInterceptor();
    Code:
       0: aload_0
       1: ldc           #1                  // String prepare-send
       3: invokespecial #2                  // Method org/apache/cxf/phase/AbstractPhaseInterceptor."<init>":(Ljava/lang/String;)V
       6: return

  public void handleMessage(org.apache.cxf.binding.soap.SoapMessage) throws org.apache.cxf.interceptor.Fault;
    Code:
       0: aload_1
       1: ldc_w         #3                  // class org/apache/cxf/ws/policy/AssertionInfoMap
       4: invokevirtual #4                  // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
       7: checkcast     #3                  // class org/apache/cxf/ws/policy/AssertionInfoMap
      10: astore_2
      11: aload_2
      12: ifnull        277
      15: aload_2
      16: ldc           #5                  // String SpnegoContextToken
      18: invokestatic  #6                  // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      21: astore_3
      22: aload_3
      23: invokeinterface #7,  1            // InterfaceMethod java/util/Collection.isEmpty:()Z
      28: ifeq          32
      31: return
      32: aload_0
      33: aload_1
      34: invokevirtual #8                  // Method isRequestor:(Lorg/apache/cxf/message/Message;)Z
      37: ifeq          238
      40: aload_1
      41: ldc           #9                  // String ws-security.token.id
      43: invokevirtual #10                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      46: checkcast     #11                 // class java/lang/String
      49: astore        4
      51: aconst_null
      52: astore        5
      54: aload         4
      56: ifnull        128
      59: aload_1
      60: invokestatic  #12                 // Method org/apache/cxf/ws/security/tokenstore/TokenStoreUtils.getTokenStore:(Lorg/apache/cxf/message/Message;)Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      63: aload         4
      65: invokeinterface #13,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.getToken:(Ljava/lang/String;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      70: astore        5
      72: aload         5
      74: ifnull        128
      77: aload         5
      79: invokevirtual #14                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.isExpired:()Z
      82: ifeq          128
      85: aload_1
      86: invokevirtual #15                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
      89: invokeinterface #16,  1           // InterfaceMethod org/apache/cxf/message/Exchange.getEndpoint:()Lorg/apache/cxf/endpoint/Endpoint;
      94: ldc           #9                  // String ws-security.token.id
      96: invokeinterface #17,  2           // InterfaceMethod org/apache/cxf/endpoint/Endpoint.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     101: pop
     102: aload_1
     103: invokevirtual #15                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
     106: ldc           #9                  // String ws-security.token.id
     108: invokeinterface #18,  2           // InterfaceMethod org/apache/cxf/message/Exchange.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     113: pop
     114: aload_1
     115: invokestatic  #12                 // Method org/apache/cxf/ws/security/tokenstore/TokenStoreUtils.getTokenStore:(Lorg/apache/cxf/message/Message;)Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     118: aload         4
     120: invokeinterface #19,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.remove:(Ljava/lang/String;)V
     125: aconst_null
     126: astore        5
     128: aload         5
     130: ifnonnull     141
     133: aload_0
     134: aload_1
     135: aload_2
     136: invokespecial #20                 // Method issueToken:(Lorg/apache/cxf/binding/soap/SoapMessage;Lorg/apache/cxf/ws/policy/AssertionInfoMap;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     139: astore        5
     141: aload         5
     143: ifnull        235
     146: aload_3
     147: invokeinterface #21,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     152: astore        6
     154: aload         6
     156: invokeinterface #22,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     161: ifeq          185
     164: aload         6
     166: invokeinterface #23,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     171: checkcast     #24                 // class org/apache/cxf/ws/policy/AssertionInfo
     174: astore        7
     176: aload         7
     178: iconst_1
     179: invokevirtual #25                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     182: goto          154
     185: aload_1
     186: invokevirtual #15                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
     189: invokeinterface #16,  1           // InterfaceMethod org/apache/cxf/message/Exchange.getEndpoint:()Lorg/apache/cxf/endpoint/Endpoint;
     194: ldc           #9                  // String ws-security.token.id
     196: aload         5
     198: invokevirtual #26                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     201: invokeinterface #27,  3           // InterfaceMethod org/apache/cxf/endpoint/Endpoint.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     206: pop
     207: aload_1
     208: invokevirtual #15                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
     211: ldc           #9                  // String ws-security.token.id
     213: aload         5
     215: invokevirtual #26                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     218: invokeinterface #28,  3           // InterfaceMethod org/apache/cxf/message/Exchange.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     223: pop
     224: aload_1
     225: invokestatic  #12                 // Method org/apache/cxf/ws/security/tokenstore/TokenStoreUtils.getTokenStore:(Lorg/apache/cxf/message/Message;)Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     228: aload         5
     230: invokeinterface #29,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.add:(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
     235: goto          277
     238: aload_3
     239: invokeinterface #21,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     244: astore        4
     246: aload         4
     248: invokeinterface #22,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     253: ifeq          277
     256: aload         4
     258: invokeinterface #23,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     263: checkcast     #24                 // class org/apache/cxf/ws/policy/AssertionInfo
     266: astore        5
     268: aload         5
     270: iconst_1
     271: invokevirtual #25                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     274: goto          246
     277: return

  private org.apache.cxf.ws.security.tokenstore.SecurityToken issueToken(org.apache.cxf.binding.soap.SoapMessage, org.apache.cxf.ws.policy.AssertionInfoMap);
    Code:
       0: aload_1
       1: ldc           #30                 // String ws-security.kerberos.jaas.context
       3: invokevirtual #10                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
       6: checkcast     #11                 // class java/lang/String
       9: astore_3
      10: aload_1
      11: ldc           #31                 // String ws-security.kerberos.spn
      13: invokevirtual #10                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      16: checkcast     #11                 // class java/lang/String
      19: astore        4
      21: new           #32                 // class org/apache/wss4j/common/spnego/SpnegoTokenContext
      24: dup
      25: invokespecial #33                 // Method org/apache/wss4j/common/spnego/SpnegoTokenContext."<init>":()V
      28: astore        5
      30: aload_1
      31: ldc           #34                 // String ws-security.spnego.client.action
      33: invokevirtual #10                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      36: astore        6
      38: aload         6
      40: instanceof    #35                 // class org/apache/wss4j/common/spnego/SpnegoClientAction
      43: ifeq          56
      46: aload         5
      48: aload         6
      50: checkcast     #35                 // class org/apache/wss4j/common/spnego/SpnegoClientAction
      53: invokevirtual #36                 // Method org/apache/wss4j/common/spnego/SpnegoTokenContext.setSpnegoClientAction:(Lorg/apache/wss4j/common/spnego/SpnegoClientAction;)V
      56: ldc           #37                 // String security.callback-handler
      58: aload_1
      59: invokestatic  #38                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      62: invokestatic  #39                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getCallbackHandler:(Ljava/lang/Object;)Ljavax/security/auth/callback/CallbackHandler;
      65: astore        7
      67: aload         5
      69: aload_3
      70: aload         7
      72: aload         4
      74: invokevirtual #40                 // Method org/apache/wss4j/common/spnego/SpnegoTokenContext.retrieveServiceTicket:(Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;Ljava/lang/String;)V
      77: goto          92
      80: astore        7
      82: new           #42                 // class org/apache/cxf/interceptor/Fault
      85: dup
      86: aload         7
      88: invokespecial #43                 // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
      91: athrow
      92: aload_1
      93: ldc           #44                 // String spnego
      95: invokestatic  #45                 // Method org/apache/cxf/ws/security/trust/STSUtils.getClient:(Lorg/apache/cxf/message/Message;Ljava/lang/String;)Lorg/apache/cxf/ws/security/trust/STSClient;
      98: astore        7
     100: aload_1
     101: ldc           #46                 // String javax.xml.ws.addressing.context.outbound
     103: invokevirtual #47                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Object;)Ljava/lang/Object;
     106: checkcast     #48                 // class org/apache/cxf/ws/addressing/AddressingProperties
     109: astore        8
     111: aload         8
     113: ifnonnull     127
     116: aload_1
     117: ldc           #49                 // String javax.xml.ws.addressing.context
     119: invokevirtual #47                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Object;)Ljava/lang/Object;
     122: checkcast     #48                 // class org/apache/cxf/ws/addressing/AddressingProperties
     125: astore        8
     127: aload         7
     129: dup
     130: astore        9
     132: monitorenter
     133: aload         7
     135: aload_1
     136: aload_2
     137: invokestatic  #50                 // Method org/apache/cxf/ws/security/policy/interceptors/SpnegoTokenInterceptorProvider.setupClient:(Lorg/apache/cxf/ws/security/trust/STSClient;Lorg/apache/cxf/binding/soap/SoapMessage;Lorg/apache/cxf/ws/policy/AssertionInfoMap;)Ljava/lang/String;
     140: astore        10
     142: aload         8
     144: ifnull        157
     147: aload         7
     149: aload         8
     151: invokevirtual #51                 // Method org/apache/cxf/ws/addressing/AddressingProperties.getNamespaceURI:()Ljava/lang/String;
     154: invokevirtual #52                 // Method org/apache/cxf/ws/security/trust/STSClient.setAddressingNamespace:(Ljava/lang/String;)V
     157: aload         7
     159: aload         10
     161: aload         5
     163: invokevirtual #53                 // Method org/apache/wss4j/common/spnego/SpnegoTokenContext.getToken:()[B
     166: invokestatic  #54                 // Method org/apache/xml/security/utils/Base64.encode:([B)Ljava/lang/String;
     169: invokevirtual #55                 // Method org/apache/cxf/ws/security/trust/STSClient.requestSecurityToken:(Ljava/lang/String;Ljava/lang/String;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     172: astore        11
     174: aload         5
     176: aload         11
     178: invokevirtual #56                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     181: invokevirtual #57                 // Method org/apache/wss4j/common/spnego/SpnegoTokenContext.unwrapKey:([B)[B
     184: astore        12
     186: aload         11
     188: aload         12
     190: invokevirtual #58                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
     193: aload         5
     195: invokevirtual #59                 // Method org/apache/wss4j/common/spnego/SpnegoTokenContext.clear:()V
     198: aload         11
     200: astore        13
     202: aload         7
     204: aconst_null
     205: checkcast     #60                 // class org/apache/wss4j/policy/model/Trust10
     208: invokevirtual #61                 // Method org/apache/cxf/ws/security/trust/STSClient.setTrust:(Lorg/apache/wss4j/policy/model/Trust10;)V
     211: aload         7
     213: aconst_null
     214: checkcast     #62                 // class org/apache/wss4j/policy/model/Trust13
     217: invokevirtual #61                 // Method org/apache/cxf/ws/security/trust/STSClient.setTrust:(Lorg/apache/wss4j/policy/model/Trust10;)V
     220: aload         7
     222: aconst_null
     223: invokevirtual #63                 // Method org/apache/cxf/ws/security/trust/STSClient.setTemplate:(Lorg/w3c/dom/Element;)V
     226: aload         7
     228: aconst_null
     229: invokevirtual #64                 // Method org/apache/cxf/ws/security/trust/STSClient.setLocation:(Ljava/lang/String;)V
     232: aload         7
     234: aconst_null
     235: invokevirtual #52                 // Method org/apache/cxf/ws/security/trust/STSClient.setAddressingNamespace:(Ljava/lang/String;)V
     238: aload         9
     240: monitorexit
     241: aload         13
     243: areturn
     244: astore        10
     246: aload         10
     248: athrow
     249: astore        10
     251: new           #42                 // class org/apache/cxf/interceptor/Fault
     254: dup
     255: aload         10
     257: invokespecial #43                 // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     260: athrow
     261: astore        14
     263: aload         7
     265: aconst_null
     266: checkcast     #60                 // class org/apache/wss4j/policy/model/Trust10
     269: invokevirtual #61                 // Method org/apache/cxf/ws/security/trust/STSClient.setTrust:(Lorg/apache/wss4j/policy/model/Trust10;)V
     272: aload         7
     274: aconst_null
     275: checkcast     #62                 // class org/apache/wss4j/policy/model/Trust13
     278: invokevirtual #61                 // Method org/apache/cxf/ws/security/trust/STSClient.setTrust:(Lorg/apache/wss4j/policy/model/Trust10;)V
     281: aload         7
     283: aconst_null
     284: invokevirtual #63                 // Method org/apache/cxf/ws/security/trust/STSClient.setTemplate:(Lorg/w3c/dom/Element;)V
     287: aload         7
     289: aconst_null
     290: invokevirtual #64                 // Method org/apache/cxf/ws/security/trust/STSClient.setLocation:(Ljava/lang/String;)V
     293: aload         7
     295: aconst_null
     296: invokevirtual #52                 // Method org/apache/cxf/ws/security/trust/STSClient.setAddressingNamespace:(Ljava/lang/String;)V
     299: aload         14
     301: athrow
     302: astore        15
     304: aload         9
     306: monitorexit
     307: aload         15
     309: athrow
    Exception table:
       from    to  target type
          56    77    80   Class java/lang/Exception
         133   202   244   Class java/lang/RuntimeException
         133   202   249   Class java/lang/Exception
         133   202   261   any
         244   263   261   any
         133   241   302   any
         244   307   302   any

  public void handleMessage(org.apache.cxf.message.Message) throws org.apache.cxf.interceptor.Fault;
    Code:
       0: aload_0
       1: aload_1
       2: checkcast     #66                 // class org/apache/cxf/binding/soap/SoapMessage
       5: invokevirtual #67                 // Method handleMessage:(Lorg/apache/cxf/binding/soap/SoapMessage;)V
       8: return
}
