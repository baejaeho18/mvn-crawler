Compiled from "IssuedTokenPolicyValidator.java"
public class org.apache.cxf.ws.security.wss4j.policyvalidators.IssuedTokenPolicyValidator extends org.apache.cxf.ws.security.wss4j.policyvalidators.AbstractSamlPolicyValidator {
  private org.apache.cxf.ws.security.wss4j.policyvalidators.ClaimsPolicyValidator claimsValidator;

  public org.apache.cxf.ws.security.wss4j.policyvalidators.IssuedTokenPolicyValidator();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/policyvalidators/AbstractSamlPolicyValidator."<init>":()V
       4: aload_0
       5: new           #2                  // class org/apache/cxf/ws/security/wss4j/policyvalidators/DefaultClaimsPolicyValidator
       8: dup
       9: invokespecial #3                  // Method org/apache/cxf/ws/security/wss4j/policyvalidators/DefaultClaimsPolicyValidator."<init>":()V
      12: putfield      #4                  // Field claimsValidator:Lorg/apache/cxf/ws/security/wss4j/policyvalidators/ClaimsPolicyValidator;
      15: return

  public boolean canValidatePolicy(org.apache.cxf.ws.policy.AssertionInfo);
    Code:
       0: aload_1
       1: invokevirtual #5                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
       4: ifnull        47
       7: getstatic     #6                  // Field org/apache/wss4j/policy/SP12Constants.ISSUED_TOKEN:Ljavax/xml/namespace/QName;
      10: aload_1
      11: invokevirtual #5                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      14: invokeinterface #7,  1            // InterfaceMethod org/apache/neethi/Assertion.getName:()Ljavax/xml/namespace/QName;
      19: invokevirtual #8                  // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      22: ifne          43
      25: getstatic     #9                  // Field org/apache/wss4j/policy/SP11Constants.ISSUED_TOKEN:Ljavax/xml/namespace/QName;
      28: aload_1
      29: invokevirtual #5                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      32: invokeinterface #7,  1            // InterfaceMethod org/apache/neethi/Assertion.getName:()Ljavax/xml/namespace/QName;
      37: invokevirtual #8                  // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      40: ifeq          47
      43: iconst_1
      44: goto          48
      47: iconst_0
      48: ireturn

  public void validatePolicies(org.apache.cxf.ws.security.wss4j.policyvalidators.PolicyValidatorParameters, java.util.Collection<org.apache.cxf.ws.policy.AssertionInfo>);
    Code:
       0: aload_1
       1: invokevirtual #10                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getSamlResults:()Ljava/util/List;
       4: astore_3
       5: aload_3
       6: ifnull        93
       9: aload_3
      10: invokeinterface #11,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      15: astore        4
      17: aload         4
      19: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      24: ifeq          93
      27: aload         4
      29: invokeinterface #13,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      34: checkcast     #14                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
      37: astore        5
      39: aload         5
      41: ldc           #15                 // String saml-assertion
      43: invokevirtual #16                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      46: checkcast     #17                 // class org/apache/wss4j/common/saml/SamlAssertionWrapper
      49: astore        6
      51: aload_0
      52: aload_1
      53: aload         6
      55: aload_2
      56: invokespecial #18                 // Method validateSAMLToken:(Lorg/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Ljava/util/Collection;)Z
      59: ifeq          90
      62: aload_0
      63: aload         6
      65: invokespecial #19                 // Method createSecurityToken:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      68: astore        7
      70: aload_1
      71: invokevirtual #20                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getMessage:()Lorg/apache/cxf/message/Message;
      74: invokeinterface #21,  1           // InterfaceMethod org/apache/cxf/message/Message.getExchange:()Lorg/apache/cxf/message/Exchange;
      79: ldc           #22                 // String ws-security.token
      81: aload         7
      83: invokeinterface #23,  3           // InterfaceMethod org/apache/cxf/message/Exchange.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      88: pop
      89: return
      90: goto          17
      93: aload_1
      94: invokevirtual #24                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getResults:()Lorg/apache/wss4j/dom/handler/WSHandlerResult;
      97: invokevirtual #25                 // Method org/apache/wss4j/dom/handler/WSHandlerResult.getActionResults:()Ljava/util/Map;
     100: sipush        4096
     103: invokestatic  #26                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     106: invokeinterface #27,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     111: checkcast     #28                 // class java/util/List
     114: astore        4
     116: aload         4
     118: ifnull        222
     121: aload         4
     123: invokeinterface #11,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     128: astore        5
     130: aload         5
     132: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     137: ifeq          222
     140: aload         5
     142: invokeinterface #13,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     147: checkcast     #14                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     150: astore        6
     152: aload         6
     154: ldc           #29                 // String binary-security-token
     156: invokevirtual #16                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     159: checkcast     #30                 // class org/apache/wss4j/common/token/BinarySecurity
     162: astore        7
     164: getstatic     #31                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
     167: aload         6
     169: ldc           #32                 // String validated-token
     171: invokevirtual #16                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     174: invokevirtual #33                 // Method java/lang/Boolean.equals:(Ljava/lang/Object;)Z
     177: ifeq          219
     180: aload_0
     181: aload_1
     182: aload         7
     184: aload_2
     185: invokespecial #34                 // Method validateBinarySecurityToken:(Lorg/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters;Lorg/apache/wss4j/common/token/BinarySecurity;Ljava/util/Collection;)Z
     188: ifeq          219
     191: aload_0
     192: aload         7
     194: invokespecial #35                 // Method createSecurityToken:(Lorg/apache/wss4j/common/token/BinarySecurity;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     197: astore        8
     199: aload_1
     200: invokevirtual #20                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getMessage:()Lorg/apache/cxf/message/Message;
     203: invokeinterface #21,  1           // InterfaceMethod org/apache/cxf/message/Message.getExchange:()Lorg/apache/cxf/message/Exchange;
     208: ldc           #22                 // String ws-security.token
     210: aload         8
     212: invokeinterface #23,  3           // InterfaceMethod org/apache/cxf/message/Exchange.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     217: pop
     218: return
     219: goto          130
     222: return

  private boolean validateSAMLToken(org.apache.cxf.ws.security.wss4j.policyvalidators.PolicyValidatorParameters, org.apache.wss4j.common.saml.SamlAssertionWrapper, java.util.Collection<org.apache.cxf.ws.policy.AssertionInfo>);
    Code:
       0: iconst_1
       1: istore        4
       3: aload_3
       4: invokeinterface #36,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
       9: astore        5
      11: aload         5
      13: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      18: ifeq          258
      21: aload         5
      23: invokeinterface #13,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      28: checkcast     #37                 // class org/apache/cxf/ws/policy/AssertionInfo
      31: astore        6
      33: aload         6
      35: invokevirtual #5                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      38: checkcast     #38                 // class org/apache/wss4j/policy/model/IssuedToken
      41: astore        7
      43: aload         6
      45: iconst_1
      46: invokevirtual #39                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      49: aload_0
      50: aload         7
      52: aload_1
      53: invokevirtual #40                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getAssertionInfoMap:()Lorg/apache/cxf/ws/policy/AssertionInfoMap;
      56: invokespecial #41                 // Method assertToken:(Lorg/apache/wss4j/policy/model/IssuedToken;Lorg/apache/cxf/ws/policy/AssertionInfoMap;)V
      59: aload_0
      60: aload         7
      62: aload_1
      63: invokevirtual #20                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getMessage:()Lorg/apache/cxf/message/Message;
      66: invokevirtual #42                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/message/Message;)Z
      69: ifne          75
      72: goto          11
      75: aload_2
      76: ifnonnull     92
      79: iconst_0
      80: istore        4
      82: aload         6
      84: ldc           #43                 // String The received token does not match the token inclusion requirement
      86: invokevirtual #44                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
      89: goto          11
      92: aload         7
      94: invokevirtual #45                 // Method org/apache/wss4j/policy/model/IssuedToken.getRequestSecurityTokenTemplate:()Lorg/w3c/dom/Element;
      97: astore        8
      99: aload         8
     101: ifnull        127
     104: aload_0
     105: aload         8
     107: aload_2
     108: invokespecial #46                 // Method checkIssuedTokenTemplate:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)Z
     111: ifne          127
     114: iconst_0
     115: istore        4
     117: aload         6
     119: ldc           #47                 // String Error in validating the IssuedToken policy
     121: invokevirtual #44                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     124: goto          11
     127: aload         7
     129: invokevirtual #48                 // Method org/apache/wss4j/policy/model/IssuedToken.getClaims:()Lorg/w3c/dom/Element;
     132: astore        9
     134: aload         9
     136: ifnull        196
     139: aload         9
     141: aconst_null
     142: ldc           #49                 // String Dialect
     144: invokeinterface #50,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     149: astore        10
     151: aload_0
     152: getfield      #4                  // Field claimsValidator:Lorg/apache/cxf/ws/security/wss4j/policyvalidators/ClaimsPolicyValidator;
     155: invokeinterface #51,  1           // InterfaceMethod org/apache/cxf/ws/security/wss4j/policyvalidators/ClaimsPolicyValidator.getDialect:()Ljava/lang/String;
     160: aload         10
     162: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     165: ifeq          196
     168: aload_0
     169: getfield      #4                  // Field claimsValidator:Lorg/apache/cxf/ws/security/wss4j/policyvalidators/ClaimsPolicyValidator;
     172: aload         9
     174: aload_2
     175: invokeinterface #53,  3           // InterfaceMethod org/apache/cxf/ws/security/wss4j/policyvalidators/ClaimsPolicyValidator.validatePolicy:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)Z
     180: ifne          196
     183: iconst_0
     184: istore        4
     186: aload         6
     188: ldc           #54                 // String Error in validating the Claims policy
     190: invokevirtual #44                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     193: goto          11
     196: aload_1
     197: invokevirtual #20                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getMessage:()Lorg/apache/cxf/message/Message;
     200: ldc_w         #55                 // class org/apache/cxf/security/transport/TLSSessionInfo
     203: invokeinterface #56,  2           // InterfaceMethod org/apache/cxf/message/Message.get:(Ljava/lang/Class;)Ljava/lang/Object;
     208: checkcast     #55                 // class org/apache/cxf/security/transport/TLSSessionInfo
     211: astore        10
     213: aconst_null
     214: astore        11
     216: aload         10
     218: ifnull        228
     221: aload         10
     223: invokevirtual #57                 // Method org/apache/cxf/security/transport/TLSSessionInfo.getPeerCertificates:()[Ljava/security/cert/Certificate;
     226: astore        11
     228: aload_0
     229: aload_2
     230: aload_1
     231: invokevirtual #58                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getSignedResults:()Ljava/util/List;
     234: aload         11
     236: invokevirtual #59                 // Method checkHolderOfKey:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Ljava/util/List;[Ljava/security/cert/Certificate;)Z
     239: ifne          255
     242: iconst_0
     243: istore        4
     245: aload         6
     247: ldc           #60                 // String Assertion fails holder-of-key requirements
     249: invokevirtual #44                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     252: goto          11
     255: goto          11
     258: iload         4
     260: ireturn

  private boolean validateBinarySecurityToken(org.apache.cxf.ws.security.wss4j.policyvalidators.PolicyValidatorParameters, org.apache.wss4j.common.token.BinarySecurity, java.util.Collection<org.apache.cxf.ws.policy.AssertionInfo>);
    Code:
       0: iconst_1
       1: istore        4
       3: aload_3
       4: invokeinterface #36,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
       9: astore        5
      11: aload         5
      13: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      18: ifeq          133
      21: aload         5
      23: invokeinterface #13,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      28: checkcast     #37                 // class org/apache/cxf/ws/policy/AssertionInfo
      31: astore        6
      33: aload         6
      35: invokevirtual #5                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      38: checkcast     #38                 // class org/apache/wss4j/policy/model/IssuedToken
      41: astore        7
      43: aload         6
      45: iconst_1
      46: invokevirtual #39                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      49: iconst_1
      50: istore        4
      52: aload_0
      53: aload         7
      55: aload_1
      56: invokevirtual #40                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getAssertionInfoMap:()Lorg/apache/cxf/ws/policy/AssertionInfoMap;
      59: invokespecial #41                 // Method assertToken:(Lorg/apache/wss4j/policy/model/IssuedToken;Lorg/apache/cxf/ws/policy/AssertionInfoMap;)V
      62: aload_0
      63: aload         7
      65: aload_1
      66: invokevirtual #20                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getMessage:()Lorg/apache/cxf/message/Message;
      69: invokevirtual #42                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/message/Message;)Z
      72: ifne          78
      75: goto          11
      78: aload_2
      79: ifnonnull     95
      82: iconst_0
      83: istore        4
      85: aload         6
      87: ldc           #43                 // String The received token does not match the token inclusion requirement
      89: invokevirtual #44                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
      92: goto          11
      95: aload         7
      97: invokevirtual #45                 // Method org/apache/wss4j/policy/model/IssuedToken.getRequestSecurityTokenTemplate:()Lorg/w3c/dom/Element;
     100: astore        8
     102: aload         8
     104: ifnull        130
     107: aload_0
     108: aload         8
     110: aload_2
     111: invokespecial #61                 // Method checkIssuedTokenTemplate:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/token/BinarySecurity;)Z
     114: ifne          130
     117: iconst_0
     118: istore        4
     120: aload         6
     122: ldc           #47                 // String Error in validating the IssuedToken policy
     124: invokevirtual #44                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     127: goto          11
     130: goto          11
     133: iload         4
     135: ireturn

  private void assertToken(org.apache.wss4j.policy.model.IssuedToken, org.apache.cxf.ws.policy.AssertionInfoMap);
    Code:
       0: aload_1
       1: invokevirtual #62                 // Method org/apache/wss4j/policy/model/IssuedToken.getName:()Ljavax/xml/namespace/QName;
       4: invokevirtual #63                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
       7: astore_3
       8: aload_1
       9: invokevirtual #64                 // Method org/apache/wss4j/policy/model/IssuedToken.isRequireExternalReference:()Z
      12: ifeq          30
      15: aload_2
      16: new           #65                 // class javax/xml/namespace/QName
      19: dup
      20: aload_3
      21: ldc           #66                 // String RequireExternalReference
      23: invokespecial #67                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      26: invokestatic  #68                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      29: pop
      30: aload_1
      31: invokevirtual #69                 // Method org/apache/wss4j/policy/model/IssuedToken.isRequireInternalReference:()Z
      34: ifeq          52
      37: aload_2
      38: new           #65                 // class javax/xml/namespace/QName
      41: dup
      42: aload_3
      43: ldc           #70                 // String RequireInternalReference
      45: invokespecial #67                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      48: invokestatic  #68                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      51: pop
      52: return

  private boolean checkIssuedTokenTemplate(org.w3c.dom.Element, org.apache.wss4j.common.saml.SamlAssertionWrapper);
    Code:
       0: aload_1
       1: invokestatic  #71                 // Method org/apache/cxf/helpers/DOMUtils.getFirstElement:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Element;
       4: astore_3
       5: aload_3
       6: ifnull        242
       9: ldc           #72                 // String TokenType
      11: aload_3
      12: invokeinterface #73,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      17: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      20: ifeq          78
      23: aload_3
      24: invokeinterface #74,  1           // InterfaceMethod org/w3c/dom/Element.getTextContent:()Ljava/lang/String;
      29: astore        4
      31: ldc           #75                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
      33: aload         4
      35: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      38: ifeq          53
      41: aload_2
      42: invokevirtual #76                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSamlVersion:()Lorg/opensaml/saml/common/SAMLVersion;
      45: getstatic     #77                 // Field org/opensaml/saml/common/SAMLVersion.VERSION_11:Lorg/opensaml/saml/common/SAMLVersion;
      48: if_acmpeq     53
      51: iconst_0
      52: ireturn
      53: ldc           #78                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
      55: aload         4
      57: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      60: ifeq          75
      63: aload_2
      64: invokevirtual #76                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSamlVersion:()Lorg/opensaml/saml/common/SAMLVersion;
      67: getstatic     #79                 // Field org/opensaml/saml/common/SAMLVersion.VERSION_20:Lorg/opensaml/saml/common/SAMLVersion;
      70: if_acmpeq     75
      73: iconst_0
      74: ireturn
      75: goto          234
      78: ldc           #80                 // String KeyType
      80: aload_3
      81: invokeinterface #73,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      86: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      89: ifeq          176
      92: aload_3
      93: invokeinterface #74,  1           // InterfaceMethod org/w3c/dom/Element.getTextContent:()Ljava/lang/String;
      98: astore        4
     100: aload         4
     102: ldc           #81                 // String SymmetricKey
     104: invokevirtual #82                 // Method java/lang/String.endsWith:(Ljava/lang/String;)Z
     107: ifeq          134
     110: aload_2
     111: invokevirtual #83                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSubjectKeyInfo:()Lorg/apache/wss4j/common/saml/SAMLKeyInfo;
     114: astore        5
     116: aload         5
     118: ifnull        129
     121: aload         5
     123: invokevirtual #84                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getSecret:()[B
     126: ifnonnull     131
     129: iconst_0
     130: ireturn
     131: goto          173
     134: aload         4
     136: ldc           #85                 // String PublicKey
     138: invokevirtual #82                 // Method java/lang/String.endsWith:(Ljava/lang/String;)Z
     141: ifeq          173
     144: aload_2
     145: invokevirtual #83                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSubjectKeyInfo:()Lorg/apache/wss4j/common/saml/SAMLKeyInfo;
     148: astore        5
     150: aload         5
     152: ifnull        171
     155: aload         5
     157: invokevirtual #86                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getPublicKey:()Ljava/security/PublicKey;
     160: ifnonnull     173
     163: aload         5
     165: invokevirtual #87                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getCerts:()[Ljava/security/cert/X509Certificate;
     168: ifnonnull     173
     171: iconst_0
     172: ireturn
     173: goto          234
     176: ldc           #88                 // String Claims
     178: aload_3
     179: invokeinterface #73,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
     184: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     187: ifeq          234
     190: aload_3
     191: aconst_null
     192: ldc           #49                 // String Dialect
     194: invokeinterface #50,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     199: astore        4
     201: aload_0
     202: getfield      #4                  // Field claimsValidator:Lorg/apache/cxf/ws/security/wss4j/policyvalidators/ClaimsPolicyValidator;
     205: invokeinterface #51,  1           // InterfaceMethod org/apache/cxf/ws/security/wss4j/policyvalidators/ClaimsPolicyValidator.getDialect:()Ljava/lang/String;
     210: aload         4
     212: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     215: ifeq          234
     218: aload_0
     219: getfield      #4                  // Field claimsValidator:Lorg/apache/cxf/ws/security/wss4j/policyvalidators/ClaimsPolicyValidator;
     222: aload_3
     223: aload_2
     224: invokeinterface #53,  3           // InterfaceMethod org/apache/cxf/ws/security/wss4j/policyvalidators/ClaimsPolicyValidator.validatePolicy:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)Z
     229: ifne          234
     232: iconst_0
     233: ireturn
     234: aload_3
     235: invokestatic  #89                 // Method org/apache/cxf/helpers/DOMUtils.getNextElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     238: astore_3
     239: goto          5
     242: iconst_1
     243: ireturn

  private boolean checkIssuedTokenTemplate(org.w3c.dom.Element, org.apache.wss4j.common.token.BinarySecurity);
    Code:
       0: aload_1
       1: invokestatic  #71                 // Method org/apache/cxf/helpers/DOMUtils.getFirstElement:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Element;
       4: astore_3
       5: aload_3
       6: ifnull        57
       9: ldc           #72                 // String TokenType
      11: aload_3
      12: invokeinterface #73,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      17: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      20: ifeq          49
      23: aload_3
      24: invokeinterface #74,  1           // InterfaceMethod org/w3c/dom/Element.getTextContent:()Ljava/lang/String;
      29: astore        4
      31: aload_2
      32: invokevirtual #90                 // Method org/apache/wss4j/common/token/BinarySecurity.getValueType:()Ljava/lang/String;
      35: astore        5
      37: aload         4
      39: aload         5
      41: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      44: ifne          49
      47: iconst_0
      48: ireturn
      49: aload_3
      50: invokestatic  #89                 // Method org/apache/cxf/helpers/DOMUtils.getNextElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      53: astore_3
      54: goto          5
      57: iconst_1
      58: ireturn

  private org.apache.cxf.ws.security.tokenstore.SecurityToken createSecurityToken(org.apache.wss4j.common.saml.SamlAssertionWrapper);
    Code:
       0: new           #91                 // class org/apache/cxf/ws/security/tokenstore/SecurityToken
       3: dup
       4: aload_1
       5: invokevirtual #92                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getId:()Ljava/lang/String;
       8: invokespecial #93                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;)V
      11: astore_2
      12: aload_1
      13: invokevirtual #83                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSubjectKeyInfo:()Lorg/apache/wss4j/common/saml/SAMLKeyInfo;
      16: astore_3
      17: aload_3
      18: ifnull        55
      21: aload_2
      22: aload_3
      23: invokevirtual #84                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getSecret:()[B
      26: invokevirtual #94                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
      29: aload_3
      30: invokevirtual #87                 // Method org/apache/wss4j/common/saml/SAMLKeyInfo.getCerts:()[Ljava/security/cert/X509Certificate;
      33: astore        4
      35: aload         4
      37: ifnull        55
      40: aload         4
      42: arraylength
      43: ifle          55
      46: aload_2
      47: aload         4
      49: iconst_0
      50: aaload
      51: aconst_null
      52: invokevirtual #95                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setX509Certificate:(Ljava/security/cert/X509Certificate;Lorg/apache/wss4j/common/crypto/Crypto;)V
      55: aload_1
      56: invokevirtual #96                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml1:()Lorg/opensaml/saml/saml1/core/Assertion;
      59: ifnull        71
      62: aload_2
      63: ldc           #75                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
      65: invokevirtual #97                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setTokenType:(Ljava/lang/String;)V
      68: goto          84
      71: aload_1
      72: invokevirtual #98                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml2:()Lorg/opensaml/saml/saml2/core/Assertion;
      75: ifnull        84
      78: aload_2
      79: ldc           #78                 // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
      81: invokevirtual #97                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setTokenType:(Ljava/lang/String;)V
      84: aload_2
      85: aload_1
      86: invokevirtual #99                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getElement:()Lorg/w3c/dom/Element;
      89: invokevirtual #100                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setToken:(Lorg/w3c/dom/Element;)V
      92: aload_2
      93: areturn

  private org.apache.cxf.ws.security.tokenstore.SecurityToken createSecurityToken(org.apache.wss4j.common.token.BinarySecurity);
    Code:
       0: new           #91                 // class org/apache/cxf/ws/security/tokenstore/SecurityToken
       3: dup
       4: aload_1
       5: invokevirtual #101                // Method org/apache/wss4j/common/token/BinarySecurity.getID:()Ljava/lang/String;
       8: invokespecial #93                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;)V
      11: astore_2
      12: aload_2
      13: aload_1
      14: invokevirtual #102                // Method org/apache/wss4j/common/token/BinarySecurity.getElement:()Lorg/w3c/dom/Element;
      17: invokevirtual #100                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setToken:(Lorg/w3c/dom/Element;)V
      20: aload_2
      21: aload_1
      22: invokevirtual #103                // Method org/apache/wss4j/common/token/BinarySecurity.getToken:()[B
      25: invokevirtual #94                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
      28: aload_2
      29: aload_1
      30: invokevirtual #90                 // Method org/apache/wss4j/common/token/BinarySecurity.getValueType:()Ljava/lang/String;
      33: invokevirtual #97                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setTokenType:(Ljava/lang/String;)V
      36: aload_2
      37: areturn
}
