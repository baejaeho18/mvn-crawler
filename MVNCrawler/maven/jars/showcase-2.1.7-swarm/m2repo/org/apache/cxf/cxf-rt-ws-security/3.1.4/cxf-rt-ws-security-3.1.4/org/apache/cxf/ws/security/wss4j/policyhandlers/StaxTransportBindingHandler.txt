Compiled from "StaxTransportBindingHandler.java"
public class org.apache.cxf.ws.security.wss4j.policyhandlers.StaxTransportBindingHandler extends org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractStaxBindingHandler {
  private static final java.util.logging.Logger LOG;

  private org.apache.wss4j.policy.model.TransportBinding tbinding;

  public org.apache.cxf.ws.security.wss4j.policyhandlers.StaxTransportBindingHandler(org.apache.wss4j.stax.ext.WSSSecurityProperties, org.apache.cxf.binding.soap.SoapMessage, org.apache.wss4j.policy.model.TransportBinding, org.apache.xml.security.stax.ext.OutboundSecurityContext);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler."<init>":(Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;Lorg/apache/cxf/binding/soap/SoapMessage;Lorg/apache/wss4j/policy/model/AbstractBinding;Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;)V
       9: aload_0
      10: aload_3
      11: putfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
      14: return

  public void handleBinding();
    Code:
       0: aload_0
       1: invokevirtual #3                  // Method getMessage:()Lorg/apache/cxf/binding/soap/SoapMessage;
       4: ldc_w         #4                  // class org/apache/cxf/ws/policy/AssertionInfoMap
       7: invokevirtual #5                  // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      10: checkcast     #4                  // class org/apache/cxf/ws/policy/AssertionInfoMap
      13: astore_1
      14: aload_0
      15: aload_1
      16: invokevirtual #6                  // Method configureTimestamp:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;)V
      19: aload_0
      20: invokevirtual #7                  // Method isRequestor:()Z
      23: ifeq          232
      26: aload_0
      27: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
      30: ifnull        195
      33: aload_0
      34: aload_0
      35: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
      38: invokevirtual #8                  // Method org/apache/wss4j/policy/model/TransportBinding.getName:()Ljavax/xml/namespace/QName;
      41: invokevirtual #9                  // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
      44: aload_0
      45: invokevirtual #3                  // Method getMessage:()Lorg/apache/cxf/binding/soap/SoapMessage;
      48: ldc           #10                 // String ws-security.asymmetric.signature.algorithm
      50: invokevirtual #11                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      53: checkcast     #12                 // class java/lang/String
      56: astore_2
      57: aload_2
      58: ifnull        82
      61: aload_0
      62: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
      65: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
      68: ifnull        82
      71: aload_0
      72: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
      75: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
      78: aload_2
      79: invokevirtual #14                 // Method org/apache/wss4j/policy/model/AlgorithmSuite.setAsymmetricSignature:(Ljava/lang/String;)V
      82: aload_0
      83: invokevirtual #3                  // Method getMessage:()Lorg/apache/cxf/binding/soap/SoapMessage;
      86: ldc           #15                 // String ws-security.symmetric.signature.algorithm
      88: invokevirtual #11                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      91: checkcast     #12                 // class java/lang/String
      94: astore_3
      95: aload_3
      96: ifnull        120
      99: aload_0
     100: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     103: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     106: ifnull        120
     109: aload_0
     110: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     113: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     116: aload_3
     117: invokevirtual #16                 // Method org/apache/wss4j/policy/model/AlgorithmSuite.setSymmetricSignature:(Ljava/lang/String;)V
     120: aload_0
     121: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     124: invokevirtual #17                 // Method org/apache/wss4j/policy/model/TransportBinding.getTransportToken:()Lorg/apache/wss4j/policy/model/TransportToken;
     127: astore        4
     129: aload         4
     131: invokevirtual #18                 // Method org/apache/wss4j/policy/model/TransportToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     134: instanceof    #19                 // class org/apache/wss4j/policy/model/IssuedToken
     137: ifeq          180
     140: aload_0
     141: invokevirtual #20                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     144: astore        5
     146: aload         5
     148: ifnonnull     163
     151: aload_0
     152: aload         4
     154: invokevirtual #18                 // Method org/apache/wss4j/policy/model/TransportToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     157: ldc           #21                 // String No transport token id
     159: invokevirtual #22                 // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     162: return
     163: aload_0
     164: aload         4
     166: invokevirtual #18                 // Method org/apache/wss4j/policy/model/TransportToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     169: checkcast     #19                 // class org/apache/wss4j/policy/model/IssuedToken
     172: aload         5
     174: iconst_0
     175: iconst_0
     176: invokevirtual #23                 // Method addIssuedToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;ZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
     179: pop
     180: aload_0
     181: aload         4
     183: invokevirtual #18                 // Method org/apache/wss4j/policy/model/TransportToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     186: invokevirtual #24                 // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
     189: aload_0
     190: aload         4
     192: invokevirtual #25                 // Method assertTokenWrapper:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;)V
     195: aload_0
     196: aload_1
     197: invokespecial #26                 // Method handleNonEndorsingSupportingTokens:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;)V
     200: aload_0
     201: aload_1
     202: invokespecial #27                 // Method handleEndorsingSupportingTokens:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;)V
     205: goto          354
     208: astore_2
     209: getstatic     #29                 // Field LOG:Ljava/util/logging/Logger;
     212: getstatic     #30                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     215: aload_2
     216: invokevirtual #31                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     219: aload_2
     220: invokevirtual #32                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     223: new           #33                 // class org/apache/cxf/interceptor/Fault
     226: dup
     227: aload_2
     228: invokespecial #34                 // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     231: athrow
     232: aload_0
     233: aload_1
     234: invokespecial #26                 // Method handleNonEndorsingSupportingTokens:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;)V
     237: goto          264
     240: astore_2
     241: getstatic     #29                 // Field LOG:Ljava/util/logging/Logger;
     244: getstatic     #30                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     247: aload_2
     248: invokevirtual #31                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     251: aload_2
     252: invokevirtual #32                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     255: new           #33                 // class org/apache/cxf/interceptor/Fault
     258: dup
     259: aload_2
     260: invokespecial #34                 // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     263: athrow
     264: aload_0
     265: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     268: ifnull        349
     271: aload_0
     272: aload_0
     273: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     276: invokevirtual #8                  // Method org/apache/wss4j/policy/model/TransportBinding.getName:()Ljavax/xml/namespace/QName;
     279: invokevirtual #9                  // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     282: aload_0
     283: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     286: invokevirtual #17                 // Method org/apache/wss4j/policy/model/TransportBinding.getTransportToken:()Lorg/apache/wss4j/policy/model/TransportToken;
     289: ifnull        349
     292: aload_0
     293: aload_0
     294: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     297: invokevirtual #17                 // Method org/apache/wss4j/policy/model/TransportBinding.getTransportToken:()Lorg/apache/wss4j/policy/model/TransportToken;
     300: invokevirtual #25                 // Method assertTokenWrapper:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;)V
     303: aload_0
     304: aload_0
     305: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     308: invokevirtual #17                 // Method org/apache/wss4j/policy/model/TransportBinding.getTransportToken:()Lorg/apache/wss4j/policy/model/TransportToken;
     311: invokevirtual #18                 // Method org/apache/wss4j/policy/model/TransportToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     314: invokevirtual #24                 // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
     317: aload_0
     318: aload_1
     319: invokespecial #27                 // Method handleEndorsingSupportingTokens:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;)V
     322: goto          349
     325: astore_2
     326: getstatic     #29                 // Field LOG:Ljava/util/logging/Logger;
     329: getstatic     #30                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     332: aload_2
     333: invokevirtual #31                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     336: aload_2
     337: invokevirtual #32                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     340: new           #33                 // class org/apache/cxf/interceptor/Fault
     343: dup
     344: aload_2
     345: invokespecial #34                 // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     348: athrow
     349: aload_0
     350: aconst_null
     351: invokevirtual #35                 // Method addSignatureConfirmation:(Ljava/util/List;)V
     354: aload_0
     355: aload_1
     356: invokevirtual #36                 // Method configureLayout:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;)V
     359: aload_0
     360: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     363: ifnull        405
     366: aload_0
     367: aload_0
     368: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     371: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     374: invokevirtual #37                 // Method assertAlgorithmSuite:(Lorg/apache/wss4j/policy/model/AlgorithmSuite;)V
     377: aload_0
     378: aload_0
     379: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     382: invokevirtual #8                  // Method org/apache/wss4j/policy/model/TransportBinding.getName:()Ljavax/xml/namespace/QName;
     385: invokevirtual #38                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     388: invokevirtual #39                 // Method assertWSSProperties:(Ljava/lang/String;)V
     391: aload_0
     392: aload_0
     393: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     396: invokevirtual #8                  // Method org/apache/wss4j/policy/model/TransportBinding.getName:()Ljavax/xml/namespace/QName;
     399: invokevirtual #38                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     402: invokevirtual #40                 // Method assertTrustProperties:(Ljava/lang/String;)V
     405: aload_0
     406: getstatic     #41                 // Field org/apache/wss4j/policy/SP12Constants.SIGNED_PARTS:Ljavax/xml/namespace/QName;
     409: invokevirtual #9                  // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     412: aload_0
     413: getstatic     #42                 // Field org/apache/wss4j/policy/SP11Constants.SIGNED_PARTS:Ljavax/xml/namespace/QName;
     416: invokevirtual #9                  // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     419: aload_0
     420: getstatic     #43                 // Field org/apache/wss4j/policy/SP12Constants.ENCRYPTED_PARTS:Ljavax/xml/namespace/QName;
     423: invokevirtual #9                  // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     426: aload_0
     427: getstatic     #44                 // Field org/apache/wss4j/policy/SP11Constants.ENCRYPTED_PARTS:Ljavax/xml/namespace/QName;
     430: invokevirtual #9                  // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     433: aload_0
     434: invokevirtual #45                 // Method putCustomTokenAfterSignature:()V
     437: return
    Exception table:
       from    to  target type
         195   205   208   Class java/lang/Exception
         232   237   240   Class java/lang/Exception
         317   322   325   Class java/lang/Exception

  private void handleNonEndorsingSupportingTokens(org.apache.cxf.ws.policy.AssertionInfoMap) throws java.lang.Exception;
    Code:
       0: aload_1
       1: ldc           #46                 // String SignedSupportingTokens
       3: invokestatic  #47                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
       6: astore_2
       7: aload_2
       8: invokeinterface #48,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
      13: ifne          73
      16: aload_2
      17: invokeinterface #49,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      22: astore_3
      23: aload_3
      24: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      29: ifeq          73
      32: aload_3
      33: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      38: checkcast     #52                 // class org/apache/cxf/ws/policy/AssertionInfo
      41: astore        4
      43: aload         4
      45: invokevirtual #53                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      48: checkcast     #54                 // class org/apache/wss4j/policy/model/SupportingTokens
      51: astore        5
      53: aload         5
      55: ifnull        64
      58: aload_0
      59: aload         5
      61: invokespecial #55                 // Method addSignedSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;)V
      64: aload         4
      66: iconst_1
      67: invokevirtual #56                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      70: goto          23
      73: aload_1
      74: ldc           #57                 // String SignedEncryptedSupportingTokens
      76: invokestatic  #47                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      79: astore_2
      80: aload_2
      81: invokeinterface #48,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
      86: ifne          146
      89: aload_2
      90: invokeinterface #49,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      95: astore_3
      96: aload_3
      97: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     102: ifeq          146
     105: aload_3
     106: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     111: checkcast     #52                 // class org/apache/cxf/ws/policy/AssertionInfo
     114: astore        4
     116: aload         4
     118: invokevirtual #53                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     121: checkcast     #54                 // class org/apache/wss4j/policy/model/SupportingTokens
     124: astore        5
     126: aload         5
     128: ifnull        137
     131: aload_0
     132: aload         5
     134: invokespecial #55                 // Method addSignedSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     137: aload         4
     139: iconst_1
     140: invokevirtual #56                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     143: goto          96
     146: aload_1
     147: ldc           #58                 // String EncryptedSupportingTokens
     149: invokestatic  #47                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
     152: astore_2
     153: aload_2
     154: invokeinterface #48,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
     159: ifne          219
     162: aload_2
     163: invokeinterface #49,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     168: astore_3
     169: aload_3
     170: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     175: ifeq          219
     178: aload_3
     179: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     184: checkcast     #52                 // class org/apache/cxf/ws/policy/AssertionInfo
     187: astore        4
     189: aload         4
     191: invokevirtual #53                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     194: checkcast     #54                 // class org/apache/wss4j/policy/model/SupportingTokens
     197: astore        5
     199: aload         5
     201: ifnull        210
     204: aload_0
     205: aload         5
     207: invokespecial #55                 // Method addSignedSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     210: aload         4
     212: iconst_1
     213: invokevirtual #56                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     216: goto          169
     219: aload_1
     220: ldc           #59                 // String SupportingTokens
     222: invokestatic  #47                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
     225: astore_2
     226: aload_2
     227: invokeinterface #48,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
     232: ifne          316
     235: aload_2
     236: invokeinterface #49,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     241: astore_3
     242: aload_3
     243: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     248: ifeq          316
     251: aload_3
     252: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     257: checkcast     #52                 // class org/apache/cxf/ws/policy/AssertionInfo
     260: astore        4
     262: aload         4
     264: invokevirtual #53                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     267: checkcast     #54                 // class org/apache/wss4j/policy/model/SupportingTokens
     270: astore        5
     272: aload         5
     274: ifnull        307
     277: aload         5
     279: invokevirtual #60                 // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
     282: ifnull        307
     285: aload         5
     287: invokevirtual #60                 // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
     290: invokeinterface #61,  1           // InterfaceMethod java/util/List.size:()I
     295: ifle          307
     298: aload_0
     299: aload         5
     301: iconst_0
     302: iconst_0
     303: invokevirtual #62                 // Method handleSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;ZZ)Ljava/util/Map;
     306: pop
     307: aload         4
     309: iconst_1
     310: invokevirtual #56                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     313: goto          242
     316: return

  private void addSignedSupportingTokens(org.apache.wss4j.policy.model.SupportingTokens) throws java.lang.Exception;
    Code:
       0: aload_1
       1: invokevirtual #60                 // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
       4: invokeinterface #63,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
       9: astore_2
      10: aload_2
      11: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      16: ifeq          186
      19: aload_2
      20: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      25: checkcast     #64                 // class org/apache/wss4j/policy/model/AbstractToken
      28: astore_3
      29: aload_0
      30: aload_3
      31: invokevirtual #24                 // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
      34: aload_3
      35: ifnull        52
      38: aload_0
      39: aload_3
      40: invokevirtual #65                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      43: invokevirtual #66                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      46: ifne          52
      49: goto          10
      52: aload_3
      53: instanceof    #67                 // class org/apache/wss4j/policy/model/UsernameToken
      56: ifeq          71
      59: aload_0
      60: aload_3
      61: checkcast     #67                 // class org/apache/wss4j/policy/model/UsernameToken
      64: invokevirtual #68                 // Method addUsernameToken:(Lorg/apache/wss4j/policy/model/UsernameToken;)Lorg/apache/xml/security/stax/ext/SecurePart;
      67: pop
      68: goto          183
      71: aload_3
      72: instanceof    #19                 // class org/apache/wss4j/policy/model/IssuedToken
      75: ifeq          96
      78: aload_0
      79: aload_3
      80: checkcast     #19                 // class org/apache/wss4j/policy/model/IssuedToken
      83: aload_0
      84: invokevirtual #20                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      87: iconst_0
      88: iconst_0
      89: invokevirtual #23                 // Method addIssuedToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;ZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
      92: pop
      93: goto          183
      96: aload_3
      97: instanceof    #69                 // class org/apache/wss4j/policy/model/KerberosToken
     100: ifeq          118
     103: aload_0
     104: aload_3
     105: checkcast     #69                 // class org/apache/wss4j/policy/model/KerberosToken
     108: iconst_0
     109: iconst_0
     110: iconst_0
     111: invokevirtual #70                 // Method addKerberosToken:(Lorg/apache/wss4j/policy/model/KerberosToken;ZZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
     114: pop
     115: goto          183
     118: aload_3
     119: instanceof    #71                 // class org/apache/wss4j/policy/model/SamlToken
     122: ifeq          139
     125: aload_0
     126: aload_3
     127: checkcast     #71                 // class org/apache/wss4j/policy/model/SamlToken
     130: iconst_0
     131: iconst_0
     132: invokevirtual #72                 // Method addSamlToken:(Lorg/apache/wss4j/policy/model/SamlToken;ZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
     135: pop
     136: goto          183
     139: aload_3
     140: ifnull        173
     143: new           #28                 // class java/lang/Exception
     146: dup
     147: new           #73                 // class java/lang/StringBuilder
     150: dup
     151: invokespecial #74                 // Method java/lang/StringBuilder."<init>":()V
     154: aload_3
     155: invokevirtual #75                 // Method org/apache/wss4j/policy/model/AbstractToken.getName:()Ljavax/xml/namespace/QName;
     158: invokevirtual #76                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     161: ldc           #77                 // String  is not supported in the streaming code
     163: invokevirtual #78                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     166: invokevirtual #79                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     169: invokespecial #80                 // Method java/lang/Exception."<init>":(Ljava/lang/String;)V
     172: athrow
     173: new           #28                 // class java/lang/Exception
     176: dup
     177: ldc           #81                 // String A null token was supplied to the streaming code
     179: invokespecial #80                 // Method java/lang/Exception."<init>":(Ljava/lang/String;)V
     182: athrow
     183: goto          10
     186: return

  private void handleEndorsingSupportingTokens(org.apache.cxf.ws.policy.AssertionInfoMap) throws java.lang.Exception;
    Code:
       0: aload_1
       1: ldc           #82                 // String SignedEndorsingSupportingTokens
       3: invokestatic  #47                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
       6: astore_2
       7: aload_2
       8: invokeinterface #48,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
      13: ifne          113
      16: aconst_null
      17: astore_3
      18: aload_2
      19: invokeinterface #49,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      24: astore        4
      26: aload         4
      28: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      33: ifeq          66
      36: aload         4
      38: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      43: checkcast     #52                 // class org/apache/cxf/ws/policy/AssertionInfo
      46: astore        5
      48: aload         5
      50: invokevirtual #53                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      53: checkcast     #54                 // class org/apache/wss4j/policy/model/SupportingTokens
      56: astore_3
      57: aload         5
      59: iconst_1
      60: invokevirtual #56                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      63: goto          26
      66: aload_3
      67: ifnull        113
      70: aload_3
      71: invokevirtual #60                 // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
      74: invokeinterface #63,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      79: astore        4
      81: aload         4
      83: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      88: ifeq          113
      91: aload         4
      93: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      98: checkcast     #64                 // class org/apache/wss4j/policy/model/AbstractToken
     101: astore        5
     103: aload_0
     104: aload         5
     106: aload_3
     107: invokespecial #83                 // Method handleEndorsingToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     110: goto          81
     113: aload_1
     114: ldc           #84                 // String EndorsingSupportingTokens
     116: invokestatic  #47                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
     119: astore_2
     120: aload_2
     121: invokeinterface #48,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
     126: ifne          226
     129: aconst_null
     130: astore_3
     131: aload_2
     132: invokeinterface #49,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     137: astore        4
     139: aload         4
     141: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     146: ifeq          179
     149: aload         4
     151: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     156: checkcast     #52                 // class org/apache/cxf/ws/policy/AssertionInfo
     159: astore        5
     161: aload         5
     163: invokevirtual #53                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     166: checkcast     #54                 // class org/apache/wss4j/policy/model/SupportingTokens
     169: astore_3
     170: aload         5
     172: iconst_1
     173: invokevirtual #56                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     176: goto          139
     179: aload_3
     180: ifnull        226
     183: aload_3
     184: invokevirtual #60                 // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
     187: invokeinterface #63,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     192: astore        4
     194: aload         4
     196: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     201: ifeq          226
     204: aload         4
     206: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     211: checkcast     #64                 // class org/apache/wss4j/policy/model/AbstractToken
     214: astore        5
     216: aload_0
     217: aload         5
     219: aload_3
     220: invokespecial #83                 // Method handleEndorsingToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     223: goto          194
     226: aload_1
     227: ldc           #85                 // String EndorsingEncryptedSupportingTokens
     229: invokestatic  #47                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
     232: astore_2
     233: aload_2
     234: invokeinterface #48,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
     239: ifne          339
     242: aconst_null
     243: astore_3
     244: aload_2
     245: invokeinterface #49,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     250: astore        4
     252: aload         4
     254: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     259: ifeq          292
     262: aload         4
     264: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     269: checkcast     #52                 // class org/apache/cxf/ws/policy/AssertionInfo
     272: astore        5
     274: aload         5
     276: invokevirtual #53                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     279: checkcast     #54                 // class org/apache/wss4j/policy/model/SupportingTokens
     282: astore_3
     283: aload         5
     285: iconst_1
     286: invokevirtual #56                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     289: goto          252
     292: aload_3
     293: ifnull        339
     296: aload_3
     297: invokevirtual #60                 // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
     300: invokeinterface #63,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     305: astore        4
     307: aload         4
     309: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     314: ifeq          339
     317: aload         4
     319: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     324: checkcast     #64                 // class org/apache/wss4j/policy/model/AbstractToken
     327: astore        5
     329: aload_0
     330: aload         5
     332: aload_3
     333: invokespecial #83                 // Method handleEndorsingToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     336: goto          307
     339: aload_1
     340: ldc           #86                 // String SignedEndorsingEncryptedSupportingTokens
     342: invokestatic  #47                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
     345: astore_2
     346: aload_2
     347: invokeinterface #48,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
     352: ifne          452
     355: aconst_null
     356: astore_3
     357: aload_2
     358: invokeinterface #49,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     363: astore        4
     365: aload         4
     367: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     372: ifeq          405
     375: aload         4
     377: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     382: checkcast     #52                 // class org/apache/cxf/ws/policy/AssertionInfo
     385: astore        5
     387: aload         5
     389: invokevirtual #53                 // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     392: checkcast     #54                 // class org/apache/wss4j/policy/model/SupportingTokens
     395: astore_3
     396: aload         5
     398: iconst_1
     399: invokevirtual #56                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     402: goto          365
     405: aload_3
     406: ifnull        452
     409: aload_3
     410: invokevirtual #60                 // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
     413: invokeinterface #63,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     418: astore        4
     420: aload         4
     422: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     427: ifeq          452
     430: aload         4
     432: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     437: checkcast     #64                 // class org/apache/wss4j/policy/model/AbstractToken
     440: astore        5
     442: aload_0
     443: aload         5
     445: aload_3
     446: invokespecial #83                 // Method handleEndorsingToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     449: goto          420
     452: return

  private void handleEndorsingToken(org.apache.wss4j.policy.model.AbstractToken, org.apache.wss4j.policy.model.SupportingTokens) throws java.lang.Exception;
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #24                 // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
       5: aload_1
       6: ifnull        21
       9: aload_0
      10: aload_1
      11: invokevirtual #65                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      14: invokevirtual #66                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      17: ifne          21
      20: return
      21: aload_1
      22: instanceof    #19                 // class org/apache/wss4j/policy/model/IssuedToken
      25: ifeq          57
      28: aload_0
      29: invokevirtual #20                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      32: astore_3
      33: aload_0
      34: aload_1
      35: aload_3
      36: iconst_0
      37: iconst_1
      38: invokevirtual #23                 // Method addIssuedToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;ZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
      41: pop
      42: aload_0
      43: aload_2
      44: invokevirtual #87                 // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedParts:()Lorg/apache/wss4j/policy/model/SignedParts;
      47: aload_2
      48: invokevirtual #88                 // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedElements:()Lorg/apache/wss4j/policy/model/SignedElements;
      51: invokespecial #89                 // Method signPartsAndElements:(Lorg/apache/wss4j/policy/model/SignedParts;Lorg/apache/wss4j/policy/model/SignedElements;)V
      54: goto          437
      57: aload_1
      58: instanceof    #90                 // class org/apache/wss4j/policy/model/SecureConversationToken
      61: ifne          78
      64: aload_1
      65: instanceof    #91                 // class org/apache/wss4j/policy/model/SecurityContextToken
      68: ifne          78
      71: aload_1
      72: instanceof    #92                 // class org/apache/wss4j/policy/model/SpnegoContextToken
      75: ifeq          206
      78: aload_0
      79: invokevirtual #20                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      82: astore_3
      83: aload_0
      84: aload_1
      85: aload_3
      86: iconst_0
      87: iconst_1
      88: invokevirtual #23                 // Method addIssuedToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;ZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
      91: pop
      92: aload_0
      93: invokevirtual #93                 // Method getProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      96: astore        4
      98: aload_3
      99: ifnull        136
     102: aload_0
     103: aload_1
     104: aload_3
     105: invokevirtual #94                 // Method storeSecurityToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
     108: new           #95                 // class org/apache/cxf/ws/security/wss4j/TokenStoreCallbackHandler
     111: dup
     112: aload         4
     114: invokevirtual #96                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     117: aload_0
     118: getfield      #97                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     121: invokestatic  #98                 // Method org/apache/cxf/ws/security/tokenstore/TokenStoreUtils.getTokenStore:(Lorg/apache/cxf/message/Message;)Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     124: invokespecial #99                 // Method org/apache/cxf/ws/security/wss4j/TokenStoreCallbackHandler."<init>":(Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/cxf/ws/security/tokenstore/TokenStore;)V
     127: astore        5
     129: aload         4
     131: aload         5
     133: invokevirtual #100                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
     136: aload_0
     137: aload_1
     138: aload_2
     139: invokespecial #101                // Method doSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     142: aload         4
     144: iconst_1
     145: invokevirtual #102                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setIncludeSignatureToken:(Z)V
     148: aload         4
     150: aload_0
     151: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     154: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     157: invokevirtual #103                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
     160: invokevirtual #104                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureAlgorithm:(Ljava/lang/String;)V
     163: aload         4
     165: aload_0
     166: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     169: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     172: invokevirtual #105                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     175: invokevirtual #106                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     178: invokevirtual #107                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureCanonicalizationAlgorithm:(Ljava/lang/String;)V
     181: aload_0
     182: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     185: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     188: invokevirtual #108                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     191: astore        5
     193: aload         4
     195: aload         5
     197: invokevirtual #109                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getDigest:()Ljava/lang/String;
     200: invokevirtual #110                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureDigestAlgorithm:(Ljava/lang/String;)V
     203: goto          437
     206: aload_1
     207: instanceof    #111                // class org/apache/wss4j/policy/model/X509Token
     210: ifne          220
     213: aload_1
     214: instanceof    #112                // class org/apache/wss4j/policy/model/KeyValueToken
     217: ifeq          229
     220: aload_0
     221: aload_1
     222: aload_2
     223: invokespecial #101                // Method doSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/wss4j/policy/model/SupportingTokens;)V
     226: goto          437
     229: aload_1
     230: instanceof    #71                 // class org/apache/wss4j/policy/model/SamlToken
     233: ifeq          319
     236: aload_0
     237: aload_1
     238: checkcast     #71                 // class org/apache/wss4j/policy/model/SamlToken
     241: iconst_0
     242: iconst_1
     243: invokevirtual #72                 // Method addSamlToken:(Lorg/apache/wss4j/policy/model/SamlToken;ZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
     246: pop
     247: aload_0
     248: aload_2
     249: invokevirtual #87                 // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedParts:()Lorg/apache/wss4j/policy/model/SignedParts;
     252: aload_2
     253: invokevirtual #88                 // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedElements:()Lorg/apache/wss4j/policy/model/SignedElements;
     256: invokespecial #89                 // Method signPartsAndElements:(Lorg/apache/wss4j/policy/model/SignedParts;Lorg/apache/wss4j/policy/model/SignedElements;)V
     259: aload_0
     260: invokevirtual #93                 // Method getProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     263: astore_3
     264: aload_3
     265: aload_0
     266: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     269: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     272: invokevirtual #113                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAsymmetricSignature:()Ljava/lang/String;
     275: invokevirtual #104                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureAlgorithm:(Ljava/lang/String;)V
     278: aload_3
     279: aload_0
     280: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     283: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     286: invokevirtual #105                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     289: invokevirtual #106                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     292: invokevirtual #107                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureCanonicalizationAlgorithm:(Ljava/lang/String;)V
     295: aload_0
     296: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     299: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     302: invokevirtual #108                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     305: astore        4
     307: aload_3
     308: aload         4
     310: invokevirtual #109                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getDigest:()Ljava/lang/String;
     313: invokevirtual #110                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureDigestAlgorithm:(Ljava/lang/String;)V
     316: goto          437
     319: aload_1
     320: instanceof    #67                 // class org/apache/wss4j/policy/model/UsernameToken
     323: ifeq          336
     326: new           #28                 // class java/lang/Exception
     329: dup
     330: ldc           #114                // String Endorsing UsernameTokens are not supported in the streaming code
     332: invokespecial #80                 // Method java/lang/Exception."<init>":(Ljava/lang/String;)V
     335: athrow
     336: aload_1
     337: instanceof    #69                 // class org/apache/wss4j/policy/model/KerberosToken
     340: ifeq          437
     343: aload_0
     344: invokevirtual #93                 // Method getProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     347: astore_3
     348: aload_3
     349: getstatic     #115                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     352: invokevirtual #116                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.addAction:(Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     355: aload_0
     356: aload_1
     357: iconst_0
     358: invokevirtual #117                // Method configureSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Z)V
     361: aload_0
     362: aload_1
     363: checkcast     #69                 // class org/apache/wss4j/policy/model/KerberosToken
     366: iconst_0
     367: iconst_1
     368: iconst_0
     369: invokevirtual #70                 // Method addKerberosToken:(Lorg/apache/wss4j/policy/model/KerberosToken;ZZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
     372: pop
     373: aload_0
     374: aload_2
     375: invokevirtual #87                 // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedParts:()Lorg/apache/wss4j/policy/model/SignedParts;
     378: aload_2
     379: invokevirtual #88                 // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedElements:()Lorg/apache/wss4j/policy/model/SignedElements;
     382: invokespecial #89                 // Method signPartsAndElements:(Lorg/apache/wss4j/policy/model/SignedParts;Lorg/apache/wss4j/policy/model/SignedElements;)V
     385: aload_3
     386: aload_0
     387: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     390: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     393: invokevirtual #103                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
     396: invokevirtual #104                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureAlgorithm:(Ljava/lang/String;)V
     399: aload_3
     400: aload_0
     401: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     404: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     407: invokevirtual #105                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     410: invokevirtual #106                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     413: invokevirtual #107                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureCanonicalizationAlgorithm:(Ljava/lang/String;)V
     416: aload_0
     417: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
     420: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     423: invokevirtual #108                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     426: astore        4
     428: aload_3
     429: aload         4
     431: invokevirtual #109                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getDigest:()Ljava/lang/String;
     434: invokevirtual #110                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureDigestAlgorithm:(Ljava/lang/String;)V
     437: return

  private void doSignature(org.apache.wss4j.policy.model.AbstractToken, org.apache.wss4j.policy.model.SupportingTokens) throws java.lang.Exception;
    Code:
       0: aload_0
       1: aload_2
       2: invokevirtual #87                 // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedParts:()Lorg/apache/wss4j/policy/model/SignedParts;
       5: aload_2
       6: invokevirtual #88                 // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedElements:()Lorg/apache/wss4j/policy/model/SignedElements;
       9: invokespecial #89                 // Method signPartsAndElements:(Lorg/apache/wss4j/policy/model/SignedParts;Lorg/apache/wss4j/policy/model/SignedElements;)V
      12: aload_0
      13: invokevirtual #93                 // Method getProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      16: astore_3
      17: getstatic     #115                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      20: astore        4
      22: aload_1
      23: invokevirtual #118                // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
      26: getstatic     #119                // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
      29: if_acmpne     37
      32: getstatic     #120                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_WITH_DERIVED_KEY:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      35: astore        4
      37: aload_3
      38: aload         4
      40: invokevirtual #116                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.addAction:(Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
      43: aload_0
      44: aload_1
      45: iconst_0
      46: invokevirtual #117                // Method configureSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Z)V
      49: aload_1
      50: invokevirtual #118                // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
      53: getstatic     #119                // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
      56: if_acmpne     73
      59: aload_3
      60: aload_0
      61: getfield      #2                  // Field tbinding:Lorg/apache/wss4j/policy/model/TransportBinding;
      64: invokevirtual #13                 // Method org/apache/wss4j/policy/model/TransportBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
      67: invokevirtual #103                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
      70: invokevirtual #104                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureAlgorithm:(Ljava/lang/String;)V
      73: return

  private void signPartsAndElements(org.apache.wss4j.policy.model.SignedParts, org.apache.wss4j.policy.model.SignedElements) throws javax.xml.soap.SOAPException;
    Code:
       0: aload_0
       1: invokevirtual #93                 // Method getProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
       4: astore_3
       5: aload_3
       6: invokevirtual #121                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureSecureParts:()Ljava/util/List;
       9: astore        4
      11: aload_0
      12: getfield      #122                // Field timestampAdded:Z
      15: ifeq          51
      18: new           #123                // class org/apache/xml/security/stax/ext/SecurePart
      21: dup
      22: new           #124                // class javax/xml/namespace/QName
      25: dup
      26: ldc           #125                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      28: ldc           #126                // String Timestamp
      30: invokespecial #127                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      33: getstatic     #128                // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
      36: invokespecial #129                // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
      39: astore        5
      41: aload         4
      43: aload         5
      45: invokeinterface #130,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      50: pop
      51: aload_1
      52: ifnull        176
      55: aload_1
      56: invokevirtual #131                // Method org/apache/wss4j/policy/model/SignedParts.isBody:()Z
      59: ifeq          95
      62: new           #123                // class org/apache/xml/security/stax/ext/SecurePart
      65: dup
      66: new           #124                // class javax/xml/namespace/QName
      69: dup
      70: ldc           #132                // String http://schemas.xmlsoap.org/soap/envelope/
      72: ldc           #133                // String Body
      74: invokespecial #127                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      77: getstatic     #128                // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
      80: invokespecial #129                // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
      83: astore        5
      85: aload         4
      87: aload         5
      89: invokeinterface #130,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      94: pop
      95: aload_1
      96: invokevirtual #134                // Method org/apache/wss4j/policy/model/SignedParts.getHeaders:()Ljava/util/List;
      99: invokeinterface #63,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     104: astore        5
     106: aload         5
     108: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     113: ifeq          176
     116: aload         5
     118: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     123: checkcast     #135                // class org/apache/wss4j/policy/model/Header
     126: astore        6
     128: new           #123                // class org/apache/xml/security/stax/ext/SecurePart
     131: dup
     132: new           #124                // class javax/xml/namespace/QName
     135: dup
     136: aload         6
     138: invokevirtual #136                // Method org/apache/wss4j/policy/model/Header.getNamespace:()Ljava/lang/String;
     141: aload         6
     143: invokevirtual #137                // Method org/apache/wss4j/policy/model/Header.getName:()Ljava/lang/String;
     146: invokespecial #127                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     149: getstatic     #128                // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     152: invokespecial #129                // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     155: astore        7
     157: aload         7
     159: iconst_0
     160: invokevirtual #138                // Method org/apache/xml/security/stax/ext/SecurePart.setRequired:(Z)V
     163: aload         4
     165: aload         7
     167: invokeinterface #130,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     172: pop
     173: goto          106
     176: aload_2
     177: ifnull        281
     180: aload_2
     181: invokevirtual #139                // Method org/apache/wss4j/policy/model/SignedElements.getXPaths:()Ljava/util/List;
     184: ifnull        281
     187: aload_2
     188: invokevirtual #139                // Method org/apache/wss4j/policy/model/SignedElements.getXPaths:()Ljava/util/List;
     191: invokeinterface #63,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     196: astore        5
     198: aload         5
     200: invokeinterface #50,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     205: ifeq          281
     208: aload         5
     210: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     215: checkcast     #140                // class org/apache/wss4j/policy/model/XPath
     218: astore        6
     220: aload         6
     222: invokestatic  #141                // Method org/apache/wss4j/policy/stax/PolicyUtils.getElementPath:(Lorg/apache/wss4j/policy/model/XPath;)Ljava/util/List;
     225: astore        7
     227: aload         7
     229: invokeinterface #142,  1          // InterfaceMethod java/util/List.isEmpty:()Z
     234: ifne          278
     237: new           #123                // class org/apache/xml/security/stax/ext/SecurePart
     240: dup
     241: aload         7
     243: aload         7
     245: invokeinterface #61,  1           // InterfaceMethod java/util/List.size:()I
     250: iconst_1
     251: isub
     252: invokeinterface #143,  2          // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     257: checkcast     #124                // class javax/xml/namespace/QName
     260: getstatic     #128                // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     263: invokespecial #129                // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     266: astore        8
     268: aload         4
     270: aload         8
     272: invokeinterface #130,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     277: pop
     278: goto          198
     281: return

  static {};
    Code:
       0: ldc_w         #144                // class org/apache/cxf/ws/security/wss4j/policyhandlers/StaxTransportBindingHandler
       3: invokestatic  #145                // Method org/apache/cxf/common/logging/LogUtils.getL7dLogger:(Ljava/lang/Class;)Ljava/util/logging/Logger;
       6: putstatic     #29                 // Field LOG:Ljava/util/logging/Logger;
       9: return
}
