Compiled from "STSStaxTokenValidator.java"
class org.apache.cxf.ws.security.trust.STSStaxTokenValidator$STSStaxBSTValidator extends org.apache.wss4j.stax.validate.BinarySecurityTokenValidatorImpl {
  private boolean alwaysValidateToSts;

  org.apache.cxf.ws.security.trust.STSStaxTokenValidator$STSStaxBSTValidator(boolean);
    Code:
       0: aload_0
       1: invokespecial #2                  // Method org/apache/wss4j/stax/validate/BinarySecurityTokenValidatorImpl."<init>":()V
       4: aload_0
       5: iload_1
       6: putfield      #3                  // Field alwaysValidateToSts:Z
       9: return

  public org.apache.xml.security.stax.securityToken.InboundSecurityToken validate(org.apache.wss4j.binding.wss10.BinarySecurityTokenType, org.apache.wss4j.stax.validate.TokenContext) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: ldc           #4                  // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary
       2: aload_1
       3: invokevirtual #5                  // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getEncodingType:()Ljava/lang/String;
       6: invokevirtual #6                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       9: ifne          36
      12: new           #7                  // class org/apache/wss4j/common/ext/WSSecurityException
      15: dup
      16: getstatic     #8                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      19: ldc           #9                  // String badEncoding
      21: iconst_1
      22: anewarray     #10                 // class java/lang/Object
      25: dup
      26: iconst_0
      27: aload_1
      28: invokevirtual #5                  // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getEncodingType:()Ljava/lang/String;
      31: aastore
      32: invokespecial #11                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
      35: athrow
      36: aload_1
      37: invokevirtual #12                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValue:()Ljava/lang/String;
      40: invokestatic  #13                 // Method org/apache/commons/codec/binary/Base64.decodeBase64:(Ljava/lang/String;)[B
      43: astore_3
      44: aload_2
      45: invokevirtual #14                 // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      48: invokevirtual #15                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getMsgContext:()Ljava/lang/Object;
      51: checkcast     #16                 // class org/apache/cxf/binding/soap/SoapMessage
      54: astore        4
      56: iconst_0
      57: istore        5
      59: aload_0
      60: getfield      #3                  // Field alwaysValidateToSts:Z
      63: ifeq          84
      66: aload_0
      67: aload_1
      68: aload_3
      69: invokespecial #1                  // Method convertToDOM:(Lorg/apache/wss4j/binding/wss10/BinarySecurityTokenType;[B)Lorg/w3c/dom/Element;
      72: astore        6
      74: aload         6
      76: aload         4
      78: invokestatic  #17                 // Method org/apache/cxf/ws/security/trust/STSStaxTokenValidator.access$000:(Lorg/w3c/dom/Element;Lorg/apache/cxf/binding/soap/SoapMessage;)V
      81: iconst_1
      82: istore        5
      84: iload         5
      86: istore        6
      88: ldc           #18                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3
      90: aload_1
      91: invokevirtual #19                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
      94: invokevirtual #6                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      97: ifeq          169
     100: aload_0
     101: aload_2
     102: invokevirtual #14                 // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     105: invokevirtual #20                 // Method getCrypto:(Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)Lorg/apache/wss4j/common/crypto/Crypto;
     108: astore        7
     110: new           #21                 // class org/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator$1
     113: dup
     114: aload_0
     115: aload_2
     116: invokevirtual #22                 // Method org/apache/wss4j/stax/validate/TokenContext.getWsSecurityContext:()Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;
     119: aload         7
     121: aload_2
     122: invokevirtual #14                 // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     125: invokevirtual #23                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     128: aload_3
     129: aload_1
     130: invokevirtual #24                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getId:()Ljava/lang/String;
     133: aload_2
     134: invokevirtual #14                 // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     137: iload         6
     139: aload_1
     140: aload_3
     141: aload         4
     143: invokespecial #25                 // Method org/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator$1."<init>":(Lorg/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator;Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;[BLjava/lang/String;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;ZLorg/apache/wss4j/binding/wss10/BinarySecurityTokenType;[BLorg/apache/cxf/binding/soap/SoapMessage;)V
     146: astore        8
     148: aload         8
     150: aload_2
     151: invokevirtual #26                 // Method org/apache/wss4j/stax/validate/TokenContext.getElementPath:()Ljava/util/List;
     154: invokevirtual #27                 // Method org/apache/wss4j/stax/impl/securityToken/X509V3SecurityTokenImpl.setElementPath:(Ljava/util/List;)V
     157: aload         8
     159: aload_2
     160: invokevirtual #28                 // Method org/apache/wss4j/stax/validate/TokenContext.getFirstXMLSecEvent:()Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;
     163: invokevirtual #29                 // Method org/apache/wss4j/stax/impl/securityToken/X509V3SecurityTokenImpl.setXMLSecEvent:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;)V
     166: aload         8
     168: areturn
     169: ldc           #30                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1
     171: aload_1
     172: invokevirtual #19                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
     175: invokevirtual #6                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     178: ifeq          253
     181: aload_0
     182: aload_2
     183: invokevirtual #14                 // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     186: invokevirtual #20                 // Method getCrypto:(Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;)Lorg/apache/wss4j/common/crypto/Crypto;
     189: astore        7
     191: new           #31                 // class org/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator$2
     194: dup
     195: aload_0
     196: aload_2
     197: invokevirtual #22                 // Method org/apache/wss4j/stax/validate/TokenContext.getWsSecurityContext:()Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;
     200: aload         7
     202: aload_2
     203: invokevirtual #14                 // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     206: invokevirtual #23                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     209: aload_3
     210: aload_1
     211: invokevirtual #24                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getId:()Ljava/lang/String;
     214: getstatic     #32                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     217: aload_2
     218: invokevirtual #14                 // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     221: iload         6
     223: aload_1
     224: aload_3
     225: aload         4
     227: invokespecial #33                 // Method org/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator$2."<init>":(Lorg/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator;Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;Ljavax/security/auth/callback/CallbackHandler;[BLjava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;ZLorg/apache/wss4j/binding/wss10/BinarySecurityTokenType;[BLorg/apache/cxf/binding/soap/SoapMessage;)V
     230: astore        8
     232: aload         8
     234: aload_2
     235: invokevirtual #26                 // Method org/apache/wss4j/stax/validate/TokenContext.getElementPath:()Ljava/util/List;
     238: invokevirtual #34                 // Method org/apache/wss4j/stax/impl/securityToken/X509PKIPathv1SecurityTokenImpl.setElementPath:(Ljava/util/List;)V
     241: aload         8
     243: aload_2
     244: invokevirtual #28                 // Method org/apache/wss4j/stax/validate/TokenContext.getFirstXMLSecEvent:()Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;
     247: invokevirtual #35                 // Method org/apache/wss4j/stax/impl/securityToken/X509PKIPathv1SecurityTokenImpl.setXMLSecEvent:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;)V
     250: aload         8
     252: areturn
     253: ldc           #36                 // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#GSS_Kerberosv5_AP_REQ
     255: aload_1
     256: invokevirtual #19                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
     259: invokevirtual #6                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     262: ifeq          325
     265: new           #37                 // class org/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator$3
     268: dup
     269: aload_0
     270: aload_2
     271: invokevirtual #22                 // Method org/apache/wss4j/stax/validate/TokenContext.getWsSecurityContext:()Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;
     274: aload_2
     275: invokevirtual #14                 // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     278: invokevirtual #23                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     281: aload_3
     282: aload_1
     283: invokevirtual #19                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
     286: aload_1
     287: invokevirtual #24                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getId:()Ljava/lang/String;
     290: getstatic     #32                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     293: iload         6
     295: aload_1
     296: aload_3
     297: aload         4
     299: invokespecial #38                 // Method org/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator$3."<init>":(Lorg/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator;Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Ljavax/security/auth/callback/CallbackHandler;[BLjava/lang/String;Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;ZLorg/apache/wss4j/binding/wss10/BinarySecurityTokenType;[BLorg/apache/cxf/binding/soap/SoapMessage;)V
     302: astore        7
     304: aload         7
     306: aload_2
     307: invokevirtual #26                 // Method org/apache/wss4j/stax/validate/TokenContext.getElementPath:()Ljava/util/List;
     310: invokevirtual #39                 // Method org/apache/wss4j/stax/impl/securityToken/KerberosServiceSecurityTokenImpl.setElementPath:(Ljava/util/List;)V
     313: aload         7
     315: aload_2
     316: invokevirtual #28                 // Method org/apache/wss4j/stax/validate/TokenContext.getFirstXMLSecEvent:()Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;
     319: invokevirtual #40                 // Method org/apache/wss4j/stax/impl/securityToken/KerberosServiceSecurityTokenImpl.setXMLSecEvent:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;)V
     322: aload         7
     324: areturn
     325: new           #7                  // class org/apache/wss4j/common/ext/WSSecurityException
     328: dup
     329: getstatic     #8                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     332: ldc           #41                 // String invalidValueType
     334: iconst_1
     335: anewarray     #10                 // class java/lang/Object
     338: dup
     339: iconst_0
     340: aload_1
     341: invokevirtual #19                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
     344: aastore
     345: invokespecial #11                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;[Ljava/lang/Object;)V
     348: athrow
     349: astore        7
     351: new           #7                  // class org/apache/wss4j/common/ext/WSSecurityException
     354: dup
     355: getstatic     #8                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     358: aload         7
     360: invokespecial #43                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     363: athrow
    Exception table:
       from    to  target type
          88   168   349   Class org/apache/xml/security/exceptions/XMLSecurityException
         169   252   349   Class org/apache/xml/security/exceptions/XMLSecurityException
         253   324   349   Class org/apache/xml/security/exceptions/XMLSecurityException
         325   349   349   Class org/apache/xml/security/exceptions/XMLSecurityException

  private org.w3c.dom.Element convertToDOM(org.apache.wss4j.binding.wss10.BinarySecurityTokenType, byte[]) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: invokestatic  #44                 // Method org/apache/cxf/helpers/DOMUtils.newDocument:()Lorg/w3c/dom/Document;
       3: astore_3
       4: aconst_null
       5: astore        4
       7: ldc           #18                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3
       9: aload_1
      10: invokevirtual #19                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
      13: invokevirtual #6                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      16: ifeq          32
      19: new           #45                 // class org/apache/wss4j/common/token/X509Security
      22: dup
      23: aload_3
      24: invokespecial #46                 // Method org/apache/wss4j/common/token/X509Security."<init>":(Lorg/w3c/dom/Document;)V
      27: astore        4
      29: goto          93
      32: ldc           #30                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1
      34: aload_1
      35: invokevirtual #19                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
      38: invokevirtual #6                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      41: ifeq          57
      44: new           #47                 // class org/apache/wss4j/common/token/PKIPathSecurity
      47: dup
      48: aload_3
      49: invokespecial #48                 // Method org/apache/wss4j/common/token/PKIPathSecurity."<init>":(Lorg/w3c/dom/Document;)V
      52: astore        4
      54: goto          93
      57: ldc           #36                 // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#GSS_Kerberosv5_AP_REQ
      59: aload_1
      60: invokevirtual #19                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
      63: invokevirtual #6                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      66: ifeq          82
      69: new           #49                 // class org/apache/wss4j/dom/message/token/KerberosSecurity
      72: dup
      73: aload_3
      74: invokespecial #50                 // Method org/apache/wss4j/dom/message/token/KerberosSecurity."<init>":(Lorg/w3c/dom/Document;)V
      77: astore        4
      79: goto          93
      82: new           #7                  // class org/apache/wss4j/common/ext/WSSecurityException
      85: dup
      86: getstatic     #8                  // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      89: invokespecial #51                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      92: athrow
      93: aload         4
      95: invokevirtual #52                 // Method org/apache/wss4j/common/token/BinarySecurity.addWSSENamespace:()V
      98: aload         4
     100: invokevirtual #53                 // Method org/apache/wss4j/common/token/BinarySecurity.addWSUNamespace:()V
     103: aload         4
     105: aload_1
     106: invokevirtual #5                  // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getEncodingType:()Ljava/lang/String;
     109: invokevirtual #54                 // Method org/apache/wss4j/common/token/BinarySecurity.setEncodingType:(Ljava/lang/String;)V
     112: aload         4
     114: aload_1
     115: invokevirtual #19                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getValueType:()Ljava/lang/String;
     118: invokevirtual #55                 // Method org/apache/wss4j/common/token/BinarySecurity.setValueType:(Ljava/lang/String;)V
     121: aload         4
     123: aload_1
     124: invokevirtual #24                 // Method org/apache/wss4j/binding/wss10/BinarySecurityTokenType.getId:()Ljava/lang/String;
     127: invokevirtual #56                 // Method org/apache/wss4j/common/token/BinarySecurity.setID:(Ljava/lang/String;)V
     130: aload         4
     132: aload_2
     133: invokevirtual #57                 // Method org/apache/wss4j/common/token/BinarySecurity.setToken:([B)V
     136: aload         4
     138: invokevirtual #58                 // Method org/apache/wss4j/common/token/BinarySecurity.getElement:()Lorg/w3c/dom/Element;
     141: areturn

  static org.w3c.dom.Element access$100(org.apache.cxf.ws.security.trust.STSStaxTokenValidator$STSStaxBSTValidator, org.apache.wss4j.binding.wss10.BinarySecurityTokenType, byte[]) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #1                  // Method convertToDOM:(Lorg/apache/wss4j/binding/wss10/BinarySecurityTokenType;[B)Lorg/w3c/dom/Element;
       6: areturn
}
