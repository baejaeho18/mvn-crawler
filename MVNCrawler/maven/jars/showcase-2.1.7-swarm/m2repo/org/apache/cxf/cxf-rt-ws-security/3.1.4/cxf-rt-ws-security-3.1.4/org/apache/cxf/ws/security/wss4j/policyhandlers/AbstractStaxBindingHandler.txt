Compiled from "AbstractStaxBindingHandler.java"
public abstract class org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractStaxBindingHandler extends org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractCommonBindingHandler {
  protected boolean timestampAdded;

  protected boolean signatureConfirmationAdded;

  protected java.util.Set<org.apache.xml.security.stax.ext.SecurePart> encryptedTokensList;

  protected java.util.Map<org.apache.wss4j.policy.model.AbstractToken, org.apache.xml.security.stax.ext.SecurePart> endEncSuppTokMap;

  protected java.util.Map<org.apache.wss4j.policy.model.AbstractToken, org.apache.xml.security.stax.ext.SecurePart> endSuppTokMap;

  protected java.util.Map<org.apache.wss4j.policy.model.AbstractToken, org.apache.xml.security.stax.ext.SecurePart> sgndEndEncSuppTokMap;

  protected java.util.Map<org.apache.wss4j.policy.model.AbstractToken, org.apache.xml.security.stax.ext.SecurePart> sgndEndSuppTokMap;

  protected final org.apache.xml.security.stax.ext.OutboundSecurityContext outboundSecurityContext;

  private final org.apache.wss4j.stax.ext.WSSSecurityProperties properties;

  private org.apache.wss4j.policy.model.AbstractBinding binding;

  public org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractStaxBindingHandler(org.apache.wss4j.stax.ext.WSSSecurityProperties, org.apache.cxf.binding.soap.SoapMessage, org.apache.wss4j.policy.model.AbstractBinding, org.apache.xml.security.stax.ext.OutboundSecurityContext);
    Code:
       0: aload_0
       1: aload_2
       2: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractCommonBindingHandler."<init>":(Lorg/apache/cxf/binding/soap/SoapMessage;)V
       5: aload_0
       6: new           #2                  // class java/util/HashSet
       9: dup
      10: invokespecial #3                  // Method java/util/HashSet."<init>":()V
      13: putfield      #4                  // Field encryptedTokensList:Ljava/util/Set;
      16: aload_0
      17: aload_1
      18: putfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      21: aload_0
      22: aload_3
      23: putfield      #6                  // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      26: aload_0
      27: aload         4
      29: putfield      #7                  // Field outboundSecurityContext:Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      32: return

  protected org.apache.xml.security.stax.ext.SecurePart addUsernameToken(org.apache.wss4j.policy.model.UsernameToken);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #8                  // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
       5: aload_1
       6: invokevirtual #9                  // Method org/apache/wss4j/policy/model/UsernameToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
       9: astore_2
      10: aload_0
      11: aload_2
      12: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      15: ifne          20
      18: aconst_null
      19: areturn
      20: aload_0
      21: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      24: getstatic     #11                 // Field org/apache/wss4j/stax/ext/WSSConstants.USERNAMETOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      27: invokevirtual #12                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.addAction:(Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
      30: aload_1
      31: invokevirtual #13                 // Method org/apache/wss4j/policy/model/UsernameToken.getPasswordType:()Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      34: astore_3
      35: aload_3
      36: getstatic     #14                 // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.HashPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      39: if_acmpne     55
      42: aload_0
      43: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      46: getstatic     #15                 // Field org/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType.PASSWORD_DIGEST:Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;
      49: invokevirtual #16                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setUsernameTokenPasswordType:(Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;)V
      52: goto          85
      55: aload_3
      56: getstatic     #17                 // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.NoPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      59: if_acmpne     75
      62: aload_0
      63: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      66: getstatic     #18                 // Field org/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType.PASSWORD_NONE:Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;
      69: invokevirtual #16                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setUsernameTokenPasswordType:(Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;)V
      72: goto          85
      75: aload_0
      76: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      79: getstatic     #19                 // Field org/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType.PASSWORD_TEXT:Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;
      82: invokevirtual #16                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setUsernameTokenPasswordType:(Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;)V
      85: aload_1
      86: invokevirtual #20                 // Method org/apache/wss4j/policy/model/UsernameToken.isNonce:()Z
      89: ifeq          100
      92: aload_0
      93: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      96: iconst_1
      97: invokevirtual #21                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setAddUsernameTokenNonce:(Z)V
     100: aload_1
     101: invokevirtual #22                 // Method org/apache/wss4j/policy/model/UsernameToken.isCreated:()Z
     104: ifeq          115
     107: aload_0
     108: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     111: iconst_1
     112: invokevirtual #23                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setAddUsernameTokenCreated:(Z)V
     115: aload_0
     116: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     119: invokevirtual #24                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     122: ifnonnull     180
     125: ldc           #25                 // String security.password
     127: aload_0
     128: getfield      #26                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     131: invokestatic  #27                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     134: checkcast     #28                 // class java/lang/String
     137: astore        4
     139: aload         4
     141: ifnull        180
     144: ldc           #29                 // String security.username
     146: aload_0
     147: getfield      #26                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     150: invokestatic  #27                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     153: checkcast     #28                 // class java/lang/String
     156: astore        5
     158: new           #30                 // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$UTCallbackHandler
     161: dup
     162: aload         5
     164: aload         4
     166: invokespecial #31                 // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$UTCallbackHandler."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     169: astore        6
     171: aload_0
     172: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     175: aload         6
     177: invokevirtual #32                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
     180: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     183: dup
     184: getstatic     #34                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_UsernameToken:Ljavax/xml/namespace/QName;
     187: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     190: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     193: areturn

  protected org.apache.xml.security.stax.ext.SecurePart addKerberosToken(org.apache.wss4j.policy.model.KerberosToken, boolean, boolean, boolean) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #8                  // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
       5: aload_1
       6: invokevirtual #37                 // Method org/apache/wss4j/policy/model/KerberosToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
       9: astore        5
      11: aload_0
      12: aload         5
      14: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      17: ifne          22
      20: aconst_null
      21: areturn
      22: aload_0
      23: invokevirtual #38                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      26: astore        6
      28: aload         6
      30: ifnonnull     40
      33: aload_0
      34: aload_1
      35: ldc           #39                 // String Could not find KerberosToken
      37: invokevirtual #40                 // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
      40: new           #41                 // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$1
      43: dup
      44: aload_0
      45: aload         6
      47: invokevirtual #42                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getData:()[B
      50: aload         6
      52: invokevirtual #43                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getKey:()Ljava/security/Key;
      55: aload         6
      57: invokevirtual #44                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
      60: aload         6
      62: invokespecial #45                 // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$1."<init>":(Lorg/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler;[BLjava/security/Key;Ljava/lang/String;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
      65: astore        7
      67: aload         7
      69: aload         6
      71: invokevirtual #46                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
      74: invokevirtual #47                 // Method org/apache/wss4j/stax/impl/securityToken/KerberosClientSecurityToken.setSha1Identifier:(Ljava/lang/String;)V
      77: new           #48                 // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$2
      80: dup
      81: aload_0
      82: aload         7
      84: invokespecial #49                 // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$2."<init>":(Lorg/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler;Lorg/apache/wss4j/stax/impl/securityToken/KerberosClientSecurityToken;)V
      87: astore        8
      89: aload_0
      90: getfield      #7                  // Field outboundSecurityContext:Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
      93: aload         8
      95: invokeinterface #50,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getId:()Ljava/lang/String;
     100: aload         8
     102: invokeinterface #51,  3           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.registerSecurityTokenProvider:(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;)V
     107: aload_0
     108: getfield      #7                  // Field outboundSecurityContext:Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     111: ldc           #52                 // String PROP_USE_THIS_TOKEN_ID_FOR_KERBEROS
     113: aload         8
     115: invokeinterface #50,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getId:()Ljava/lang/String;
     120: invokeinterface #53,  3           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     125: iload         4
     127: ifeq          148
     130: aload_0
     131: getfield      #7                  // Field outboundSecurityContext:Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     134: ldc           #54                 // String PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTION
     136: aload         8
     138: invokeinterface #50,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getId:()Ljava/lang/String;
     143: invokeinterface #53,  3           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     148: iload_3
     149: ifeq          170
     152: aload_0
     153: getfield      #7                  // Field outboundSecurityContext:Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     156: ldc           #55                 // String PROP_USE_THIS_TOKEN_ID_FOR_SIGNATURE
     158: aload         8
     160: invokeinterface #50,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getId:()Ljava/lang/String;
     165: invokeinterface #53,  3           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     170: aload_0
     171: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     174: getstatic     #56                 // Field org/apache/wss4j/stax/ext/WSSConstants.KERBEROS_TOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     177: invokevirtual #12                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.addAction:(Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     180: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     183: dup
     184: getstatic     #57                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_BinarySecurityToken:Ljavax/xml/namespace/QName;
     187: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     190: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     193: astore        9
     195: aload         9
     197: aload         7
     199: invokevirtual #58                 // Method org/apache/wss4j/stax/impl/securityToken/KerberosClientSecurityToken.getId:()Ljava/lang/String;
     202: invokevirtual #59                 // Method org/apache/xml/security/stax/ext/SecurePart.setIdToSign:(Ljava/lang/String;)V
     205: aload         9
     207: areturn

  protected org.apache.xml.security.stax.ext.SecurePart addSamlToken(org.apache.wss4j.policy.model.SamlToken, boolean, boolean) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #8                  // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
       5: aload_1
       6: invokevirtual #60                 // Method org/apache/wss4j/policy/model/SamlToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
       9: astore        4
      11: aload_0
      12: aload         4
      14: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      17: ifne          22
      20: aconst_null
      21: areturn
      22: ldc           #61                 // String security.saml-callback-handler
      24: aload_0
      25: getfield      #26                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      28: invokestatic  #27                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      31: astore        5
      33: aload         5
      35: invokestatic  #62                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getCallbackHandler:(Ljava/lang/Object;)Ljavax/security/auth/callback/CallbackHandler;
      38: astore        6
      40: aload         6
      42: ifnonnull     54
      45: aload_0
      46: aload_1
      47: ldc           #63                 // String No SAML CallbackHandler available
      49: invokevirtual #40                 // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
      52: aconst_null
      53: areturn
      54: aload_0
      55: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      58: aload         6
      60: invokevirtual #64                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSamlCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
      63: goto          81
      66: astore        6
      68: new           #66                 // class org/apache/wss4j/common/ext/WSSecurityException
      71: dup
      72: getstatic     #67                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      75: aload         6
      77: invokespecial #68                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      80: athrow
      81: getstatic     #69                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_UNSIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      84: astore        6
      86: iload_2
      87: ifne          94
      90: iload_3
      91: ifeq          99
      94: getstatic     #70                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_SIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      97: astore        6
      99: aload_0
     100: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     103: aload         6
     105: invokevirtual #12                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.addAction:(Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     108: getstatic     #71                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_saml2_Assertion:Ljavax/xml/namespace/QName;
     111: astore        7
     113: aload_1
     114: invokevirtual #72                 // Method org/apache/wss4j/policy/model/SamlToken.getSamlTokenType:()Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
     117: astore        8
     119: aload         8
     121: getstatic     #73                 // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV11Token10:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
     124: if_acmpeq     135
     127: aload         8
     129: getstatic     #74                 // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV11Token11:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
     132: if_acmpne     140
     135: getstatic     #75                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_saml_Assertion:Ljavax/xml/namespace/QName;
     138: astore        7
     140: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     143: dup
     144: aload         7
     146: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     149: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     152: areturn
    Exception table:
       from    to  target type
          33    53    66   Class java/lang/Exception
          54    63    66   Class java/lang/Exception

  protected org.apache.xml.security.stax.ext.SecurePart addIssuedToken(org.apache.wss4j.policy.model.AbstractToken, org.apache.cxf.ws.security.tokenstore.SecurityToken, boolean, boolean);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #8                  // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
       5: aload_0
       6: aload_1
       7: invokevirtual #76                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      10: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      13: ifeq          238
      16: aload_2
      17: invokevirtual #77                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
      20: astore        5
      22: aload         5
      24: ifnull        221
      27: ldc           #78                 // String Assertion
      29: aload         5
      31: invokeinterface #79,  1           // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      36: invokevirtual #80                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      39: ifeq          221
      42: ldc           #81                 // String urn:oasis:names:tc:SAML:1.0:assertion
      44: aload         5
      46: invokeinterface #82,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      51: invokevirtual #80                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      54: ifne          72
      57: ldc           #83                 // String urn:oasis:names:tc:SAML:2.0:assertion
      59: aload         5
      61: invokeinterface #82,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      66: invokevirtual #80                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      69: ifeq          221
      72: getstatic     #69                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_UNSIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      75: astore        6
      77: iload         4
      79: ifeq          87
      82: getstatic     #70                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_SIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      85: astore        6
      87: aload_0
      88: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      91: aload         6
      93: invokevirtual #12                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.addAction:(Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
      96: iload_3
      97: ifne          105
     100: iload         4
     102: ifeq          157
     105: new           #84                 // class org/apache/wss4j/common/saml/bean/KeyInfoBean
     108: dup
     109: invokespecial #85                 // Method org/apache/wss4j/common/saml/bean/KeyInfoBean."<init>":()V
     112: astore        8
     114: aload         8
     116: aload_2
     117: invokevirtual #86                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getX509Certificate:()Ljava/security/cert/X509Certificate;
     120: invokevirtual #87                 // Method org/apache/wss4j/common/saml/bean/KeyInfoBean.setCertificate:(Ljava/security/cert/X509Certificate;)V
     123: aload         8
     125: aload_2
     126: invokevirtual #88                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     129: invokevirtual #89                 // Method org/apache/wss4j/common/saml/bean/KeyInfoBean.setEphemeralKey:([B)V
     132: new           #90                 // class org/apache/wss4j/common/saml/bean/SubjectBean
     135: dup
     136: ldc           #91                 // String
     138: ldc           #91                 // String
     140: ldc           #91                 // String
     142: invokespecial #92                 // Method org/apache/wss4j/common/saml/bean/SubjectBean."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     145: astore        7
     147: aload         7
     149: aload         8
     151: invokevirtual #93                 // Method org/apache/wss4j/common/saml/bean/SubjectBean.setKeyInfo:(Lorg/apache/wss4j/common/saml/bean/KeyInfoBean;)V
     154: goto          160
     157: aconst_null
     158: astore        7
     160: new           #94                 // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$3
     163: dup
     164: aload_0
     165: aload         5
     167: aload         7
     169: invokespecial #95                 // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$3."<init>":(Lorg/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler;Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/saml/bean/SubjectBean;)V
     172: astore        8
     174: aload_0
     175: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     178: aload         8
     180: invokevirtual #64                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSamlCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
     183: getstatic     #71                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_saml2_Assertion:Ljavax/xml/namespace/QName;
     186: astore        9
     188: ldc           #81                 // String urn:oasis:names:tc:SAML:1.0:assertion
     190: aload         5
     192: invokeinterface #82,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
     197: invokevirtual #80                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     200: ifeq          208
     203: getstatic     #75                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_saml_Assertion:Ljavax/xml/namespace/QName;
     206: astore        9
     208: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     211: dup
     212: aload         9
     214: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     217: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     220: areturn
     221: aload_0
     222: invokevirtual #96                 // Method isRequestor:()Z
     225: ifeq          238
     228: aload_0
     229: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     232: getstatic     #97                 // Field org/apache/wss4j/stax/ext/WSSConstants.CUSTOM_TOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     235: invokevirtual #12                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.addAction:(Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;)V
     238: aconst_null
     239: areturn

  protected void storeSecurityToken(org.apache.wss4j.policy.model.AbstractToken, org.apache.cxf.ws.security.tokenstore.SecurityToken);
    Code:
       0: getstatic     #98                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.EncryptedKeyToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
       3: astore_3
       4: aload_2
       5: invokevirtual #99                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
       8: ifnull        89
      11: aload_2
      12: invokevirtual #99                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
      15: ldc           #100                // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#
      17: invokevirtual #101                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      20: ifeq          30
      23: getstatic     #102                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KerberosToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
      26: astore_3
      27: goto          89
      30: aload_2
      31: invokevirtual #99                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
      34: ldc           #103                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0
      36: invokevirtual #101                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      39: ifne          54
      42: aload_2
      43: invokevirtual #99                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
      46: ldc           #104                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1
      48: invokevirtual #101                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      51: ifeq          61
      54: getstatic     #105                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.Saml11Token:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
      57: astore_3
      58: goto          89
      61: aload_2
      62: invokevirtual #99                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
      65: ldc           #106                // String http://schemas.xmlsoap.org/ws/2005/02/sc
      67: invokevirtual #101                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      70: ifne          85
      73: aload_2
      74: invokevirtual #99                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
      77: ldc           #107                // String http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512
      79: invokevirtual #101                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      82: ifeq          89
      85: getstatic     #108                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.SecureConversationToken:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;
      88: astore_3
      89: aload_2
      90: invokevirtual #43                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getKey:()Ljava/security/Key;
      93: astore        4
      95: aload_2
      96: invokevirtual #88                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
      99: astore        5
     101: iconst_1
     102: anewarray     #109                // class java/security/cert/X509Certificate
     105: astore        6
     107: aload_2
     108: invokevirtual #86                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getX509Certificate:()Ljava/security/cert/X509Certificate;
     111: ifnull        122
     114: aload         6
     116: iconst_0
     117: aload_2
     118: invokevirtual #86                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getX509Certificate:()Ljava/security/cert/X509Certificate;
     121: aastore
     122: new           #110                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$4
     125: dup
     126: aload_0
     127: aload_2
     128: invokevirtual #44                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     131: aload_3
     132: aload         4
     134: aload         6
     136: aload         5
     138: aload         4
     140: invokespecial #111                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$4."<init>":(Lorg/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler;Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$TokenType;Ljava/security/Key;[Ljava/security/cert/X509Certificate;[BLjava/security/Key;)V
     143: astore        7
     145: aload_0
     146: aload_1
     147: invokevirtual #76                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     150: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
     153: ifeq          165
     156: aload_2
     157: invokevirtual #112                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getAttachedReference:()Lorg/w3c/dom/Element;
     160: astore        8
     162: goto          171
     165: aload_2
     166: invokevirtual #113                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getUnattachedReference:()Lorg/w3c/dom/Element;
     169: astore        8
     171: aload         8
     173: ifnull        190
     176: aload_1
     177: instanceof    #114                // class org/apache/wss4j/policy/model/IssuedToken
     180: ifeq          190
     183: aload         7
     185: aload         8
     187: invokevirtual #115                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.setCustomTokenReference:(Lorg/w3c/dom/Element;)V
     190: new           #116                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$5
     193: dup
     194: aload_0
     195: aload         7
     197: invokespecial #117                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler$5."<init>":(Lorg/apache/cxf/ws/security/wss4j/policyhandlers/AbstractStaxBindingHandler;Lorg/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken;)V
     200: astore        9
     202: aload         7
     204: aload_2
     205: invokevirtual #46                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     208: invokevirtual #118                // Method org/apache/xml/security/stax/impl/securityToken/GenericOutboundSecurityToken.setSha1Identifier:(Ljava/lang/String;)V
     211: aload_0
     212: getfield      #7                  // Field outboundSecurityContext:Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     215: aload         9
     217: invokeinterface #50,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getId:()Ljava/lang/String;
     222: aload         9
     224: invokeinterface #51,  3           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.registerSecurityTokenProvider:(Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenProvider;)V
     229: aload_0
     230: getfield      #7                  // Field outboundSecurityContext:Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     233: ldc           #54                 // String PROP_USE_THIS_TOKEN_ID_FOR_ENCRYPTION
     235: aload         9
     237: invokeinterface #50,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getId:()Ljava/lang/String;
     242: invokeinterface #53,  3           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     247: aload_0
     248: getfield      #7                  // Field outboundSecurityContext:Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     251: ldc           #55                 // String PROP_USE_THIS_TOKEN_ID_FOR_SIGNATURE
     253: aload         9
     255: invokeinterface #50,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getId:()Ljava/lang/String;
     260: invokeinterface #53,  3           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     265: aload_0
     266: getfield      #7                  // Field outboundSecurityContext:Lorg/apache/xml/security/stax/ext/OutboundSecurityContext;
     269: ldc           #119                // String PROP_USE_THIS_TOKEN_ID_FOR_CUSTOM_TOKEN
     271: aload         9
     273: invokeinterface #50,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityTokenProvider.getId:()Ljava/lang/String;
     278: invokeinterface #53,  3           // InterfaceMethod org/apache/xml/security/stax/ext/OutboundSecurityContext.put:(Ljava/lang/String;Ljava/lang/Object;)V
     283: return

  protected void configureTimestamp(org.apache.cxf.ws.policy.AssertionInfoMap);
    Code:
       0: aload_0
       1: getfield      #6                  // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
       4: ifnull        45
       7: aload_0
       8: getfield      #6                  // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      11: invokevirtual #120                // Method org/apache/wss4j/policy/model/AbstractBinding.isIncludeTimestamp:()Z
      14: ifeq          45
      17: aload_0
      18: iconst_1
      19: putfield      #121                // Field timestampAdded:Z
      22: aload_0
      23: new           #122                // class javax/xml/namespace/QName
      26: dup
      27: aload_0
      28: getfield      #6                  // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      31: invokevirtual #123                // Method org/apache/wss4j/policy/model/AbstractBinding.getName:()Ljavax/xml/namespace/QName;
      34: invokevirtual #124                // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
      37: ldc           #125                // String IncludeTimestamp
      39: invokespecial #126                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      42: invokevirtual #127                // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
      45: return

  protected void configureLayout(org.apache.cxf.ws.policy.AssertionInfoMap);
    Code:
       0: aload_1
       1: ldc           #128                // String Layout
       3: invokestatic  #129                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getFirstAssertionByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Lorg/apache/cxf/ws/policy/AssertionInfo;
       6: astore_2
       7: aconst_null
       8: astore_3
       9: aload_2
      10: ifnull        26
      13: aload_2
      14: invokevirtual #130                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      17: checkcast     #131                // class org/apache/wss4j/policy/model/Layout
      20: astore_3
      21: aload_2
      22: iconst_1
      23: invokevirtual #132                // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      26: aload_3
      27: ifnull        62
      30: aload_3
      31: invokevirtual #133                // Method org/apache/wss4j/policy/model/Layout.getLayoutType:()Lorg/apache/wss4j/policy/model/Layout$LayoutType;
      34: ifnull        62
      37: aload_0
      38: new           #122                // class javax/xml/namespace/QName
      41: dup
      42: aload_3
      43: invokevirtual #134                // Method org/apache/wss4j/policy/model/Layout.getName:()Ljavax/xml/namespace/QName;
      46: invokevirtual #124                // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
      49: aload_3
      50: invokevirtual #133                // Method org/apache/wss4j/policy/model/Layout.getLayoutType:()Lorg/apache/wss4j/policy/model/Layout$LayoutType;
      53: invokevirtual #135                // Method org/apache/wss4j/policy/model/Layout$LayoutType.name:()Ljava/lang/String;
      56: invokespecial #126                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      59: invokevirtual #127                // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
      62: aload_0
      63: getfield      #121                // Field timestampAdded:Z
      66: ifne          70
      69: return
      70: aload_3
      71: ifnull        88
      74: aload_3
      75: invokevirtual #133                // Method org/apache/wss4j/policy/model/Layout.getLayoutType:()Lorg/apache/wss4j/policy/model/Layout$LayoutType;
      78: getstatic     #136                // Field org/apache/wss4j/policy/model/Layout$LayoutType.LaxTsLast:Lorg/apache/wss4j/policy/model/Layout$LayoutType;
      81: if_acmpne     88
      84: iconst_1
      85: goto          89
      88: iconst_0
      89: istore        4
      91: getstatic     #137                // Field org/apache/wss4j/stax/ext/WSSConstants.TIMESTAMP:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      94: astore        5
      96: aload_0
      97: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     100: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
     103: astore        6
     105: iload         4
     107: ifeq          123
     110: aload         6
     112: iconst_0
     113: aload         5
     115: invokeinterface #139,  3          // InterfaceMethod java/util/List.add:(ILjava/lang/Object;)V
     120: goto          133
     123: aload         6
     125: aload         5
     127: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     132: pop
     133: return

  protected org.apache.wss4j.stax.ext.WSSSecurityProperties getProperties();
    Code:
       0: aload_0
       1: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
       4: areturn

  protected void configureSignature(org.apache.wss4j.policy.model.AbstractToken, boolean) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: instanceof    #141                // class org/apache/wss4j/policy/model/X509Token
       4: ifeq          42
       7: aload_1
       8: checkcast     #141                // class org/apache/wss4j/policy/model/X509Token
      11: astore_3
      12: aload_3
      13: invokevirtual #142                // Method org/apache/wss4j/policy/model/X509Token.getTokenType:()Lorg/apache/wss4j/policy/model/X509Token$TokenType;
      16: astore        4
      18: aload         4
      20: getstatic     #143                // Field org/apache/wss4j/policy/model/X509Token$TokenType.WssX509PkiPathV1Token10:Lorg/apache/wss4j/policy/model/X509Token$TokenType;
      23: if_acmpeq     34
      26: aload         4
      28: getstatic     #144                // Field org/apache/wss4j/policy/model/X509Token$TokenType.WssX509PkiPathV1Token11:Lorg/apache/wss4j/policy/model/X509Token$TokenType;
      31: if_acmpne     42
      34: aload_0
      35: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      38: iconst_0
      39: invokevirtual #145                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setUseSingleCert:(Z)V
      42: aload_0
      43: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      46: aload_0
      47: aload_1
      48: invokevirtual #146                // Method getKeyIdentifierType:(Lorg/apache/wss4j/policy/model/AbstractToken;)Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      51: invokevirtual #147                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureKeyIdentifier:(Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;)V
      54: aload_0
      55: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      58: invokevirtual #148                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureKeyIdentifier:()Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      61: astore_3
      62: aload_1
      63: instanceof    #141                // class org/apache/wss4j/policy/model/X509Token
      66: ifeq          121
      69: aload_0
      70: aload_1
      71: invokevirtual #76                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      74: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      77: ifeq          121
      80: getstatic     #149                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_IssuerSerial:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      83: aload_3
      84: invokevirtual #150                // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
      87: ifne          110
      90: getstatic     #151                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_ThumbprintIdentifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      93: aload_3
      94: invokevirtual #150                // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
      97: ifne          110
     100: getstatic     #152                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     103: aload_3
     104: invokevirtual #150                // Method org/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier.equals:(Ljava/lang/Object;)Z
     107: ifeq          121
     110: aload_0
     111: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     114: iconst_1
     115: invokevirtual #153                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setIncludeSignatureToken:(Z)V
     118: goto          129
     121: aload_0
     122: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     125: iconst_0
     126: invokevirtual #153                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setIncludeSignatureToken:(Z)V
     129: ldc           #154                // String security.signature.username
     131: astore        4
     133: aload_0
     134: getfield      #6                  // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     137: instanceof    #155                // class org/apache/wss4j/policy/model/SymmetricBinding
     140: ifeq          167
     143: ldc           #156                // String security.encryption.username
     145: astore        4
     147: aload_0
     148: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     151: aload_0
     152: getfield      #6                  // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     155: invokevirtual #157                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     158: invokevirtual #158                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
     161: invokevirtual #159                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureAlgorithm:(Ljava/lang/String;)V
     164: goto          184
     167: aload_0
     168: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     171: aload_0
     172: getfield      #6                  // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     175: invokevirtual #157                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     178: invokevirtual #160                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAsymmetricSignature:()Ljava/lang/String;
     181: invokevirtual #159                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureAlgorithm:(Ljava/lang/String;)V
     184: aload_0
     185: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     188: aload_0
     189: getfield      #6                  // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     192: invokevirtual #157                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     195: invokevirtual #161                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     198: invokevirtual #162                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     201: invokevirtual #163                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureCanonicalizationAlgorithm:(Ljava/lang/String;)V
     204: aload         4
     206: aload_0
     207: getfield      #26                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     210: invokestatic  #27                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     213: checkcast     #28                 // class java/lang/String
     216: astore        5
     218: aload         5
     220: ifnonnull     237
     223: ldc           #29                 // String security.username
     225: aload_0
     226: getfield      #26                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     229: invokestatic  #27                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     232: checkcast     #28                 // class java/lang/String
     235: astore        5
     237: aload         5
     239: ifnull        261
     242: aload_0
     243: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     246: invokevirtual #164                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureUser:()Ljava/lang/String;
     249: ifnonnull     261
     252: aload_0
     253: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     256: aload         5
     258: invokevirtual #165                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureUser:(Ljava/lang/String;)V
     261: aload_0
     262: getfield      #6                  // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     265: invokevirtual #157                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     268: invokevirtual #166                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     271: astore        6
     273: aload_0
     274: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     277: aload         6
     279: invokevirtual #167                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getDigest:()Ljava/lang/String;
     282: invokevirtual #168                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setSignatureDigestAlgorithm:(Ljava/lang/String;)V
     285: return

  protected org.apache.xml.security.stax.securityToken.SecurityTokenConstants$KeyIdentifier getKeyIdentifierType(org.apache.wss4j.policy.model.AbstractToken);
    Code:
       0: aconst_null
       1: astore_2
       2: aload_1
       3: instanceof    #141                // class org/apache/wss4j/policy/model/X509Token
       6: ifeq          56
       9: aload_1
      10: checkcast     #141                // class org/apache/wss4j/policy/model/X509Token
      13: astore_3
      14: aload_3
      15: invokevirtual #169                // Method org/apache/wss4j/policy/model/X509Token.isRequireIssuerSerialReference:()Z
      18: ifeq          28
      21: getstatic     #149                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_IssuerSerial:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      24: astore_2
      25: goto          53
      28: aload_3
      29: invokevirtual #170                // Method org/apache/wss4j/policy/model/X509Token.isRequireKeyIdentifierReference:()Z
      32: ifeq          42
      35: getstatic     #171                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SkiKeyIdentifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      38: astore_2
      39: goto          53
      42: aload_3
      43: invokevirtual #172                // Method org/apache/wss4j/policy/model/X509Token.isRequireThumbprintReference:()Z
      46: ifeq          53
      49: getstatic     #151                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_ThumbprintIdentifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      52: astore_2
      53: goto          67
      56: aload_1
      57: instanceof    #173                // class org/apache/wss4j/policy/model/KeyValueToken
      60: ifeq          67
      63: getstatic     #174                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_KeyValue:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      66: astore_2
      67: aload_2
      68: ifnull        73
      71: aload_2
      72: areturn
      73: aload_1
      74: invokevirtual #76                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      77: getstatic     #175                // Field org/apache/wss4j/policy/SPConstants$IncludeTokenType.INCLUDE_TOKEN_NEVER:Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      80: if_acmpne     144
      83: aload_0
      84: invokevirtual #176                // Method getWss10:()Lorg/apache/wss4j/policy/model/Wss10;
      87: astore_3
      88: aload_3
      89: ifnull        99
      92: aload_3
      93: invokevirtual #177                // Method org/apache/wss4j/policy/model/Wss10.isMustSupportRefKeyIdentifier:()Z
      96: ifeq          106
      99: getstatic     #171                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SkiKeyIdentifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     102: astore_2
     103: goto          141
     106: aload_3
     107: invokevirtual #178                // Method org/apache/wss4j/policy/model/Wss10.isMustSupportRefIssuerSerial:()Z
     110: ifeq          120
     113: getstatic     #149                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_IssuerSerial:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     116: astore_2
     117: goto          141
     120: aload_3
     121: instanceof    #179                // class org/apache/wss4j/policy/model/Wss11
     124: ifeq          141
     127: aload_3
     128: checkcast     #179                // class org/apache/wss4j/policy/model/Wss11
     131: invokevirtual #180                // Method org/apache/wss4j/policy/model/Wss11.isMustSupportRefThumbprint:()Z
     134: ifeq          141
     137: getstatic     #151                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_ThumbprintIdentifier:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     140: astore_2
     141: goto          203
     144: aload_1
     145: invokevirtual #76                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     148: getstatic     #181                // Field org/apache/wss4j/policy/SPConstants$IncludeTokenType.INCLUDE_TOKEN_ALWAYS_TO_RECIPIENT:Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     151: if_acmpne     175
     154: aload_0
     155: invokevirtual #96                 // Method isRequestor:()Z
     158: ifne          175
     161: aload_1
     162: instanceof    #141                // class org/apache/wss4j/policy/model/X509Token
     165: ifeq          175
     168: getstatic     #149                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_IssuerSerial:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     171: astore_2
     172: goto          203
     175: aload_1
     176: invokevirtual #76                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     179: getstatic     #182                // Field org/apache/wss4j/policy/SPConstants$IncludeTokenType.INCLUDE_TOKEN_ALWAYS_TO_INITIATOR:Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     182: if_acmpne     203
     185: aload_0
     186: invokevirtual #96                 // Method isRequestor:()Z
     189: ifeq          203
     192: aload_1
     193: instanceof    #141                // class org/apache/wss4j/policy/model/X509Token
     196: ifeq          203
     199: getstatic     #149                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_IssuerSerial:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     202: astore_2
     203: aload_2
     204: ifnull        209
     207: aload_2
     208: areturn
     209: getstatic     #152                // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     212: areturn

  protected java.util.Map<org.apache.wss4j.policy.model.AbstractToken, org.apache.xml.security.stax.ext.SecurePart> handleSupportingTokens(java.util.Collection<org.apache.cxf.ws.policy.AssertionInfo>, boolean, boolean) throws java.lang.Exception;
    Code:
       0: aload_1
       1: ifnull        92
       4: aload_1
       5: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
      10: ifne          92
      13: new           #184                // class java/util/HashMap
      16: dup
      17: invokespecial #185                // Method java/util/HashMap."<init>":()V
      20: astore        4
      22: aload_1
      23: invokeinterface #186,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      28: astore        5
      30: aload         5
      32: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      37: ifeq          89
      40: aload         5
      42: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      47: checkcast     #189                // class org/apache/cxf/ws/policy/AssertionInfo
      50: astore        6
      52: aload         6
      54: invokevirtual #130                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      57: instanceof    #190                // class org/apache/wss4j/policy/model/SupportingTokens
      60: ifeq          86
      63: aload         6
      65: iconst_1
      66: invokevirtual #132                // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      69: aload_0
      70: aload         6
      72: invokevirtual #130                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      75: checkcast     #190                // class org/apache/wss4j/policy/model/SupportingTokens
      78: iload_2
      79: iload_3
      80: aload         4
      82: invokevirtual #191                // Method handleSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;ZZLjava/util/Map;)Ljava/util/Map;
      85: pop
      86: goto          30
      89: aload         4
      91: areturn
      92: invokestatic  #192                // Method java/util/Collections.emptyMap:()Ljava/util/Map;
      95: areturn

  protected java.util.Map<org.apache.wss4j.policy.model.AbstractToken, org.apache.xml.security.stax.ext.SecurePart> handleSupportingTokens(org.apache.wss4j.policy.model.SupportingTokens, boolean, boolean) throws java.lang.Exception;
    Code:
       0: aload_0
       1: aload_1
       2: iload_2
       3: iload_3
       4: new           #184                // class java/util/HashMap
       7: dup
       8: invokespecial #185                // Method java/util/HashMap."<init>":()V
      11: invokevirtual #191                // Method handleSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;ZZLjava/util/Map;)Ljava/util/Map;
      14: areturn

  protected java.util.Map<org.apache.wss4j.policy.model.AbstractToken, org.apache.xml.security.stax.ext.SecurePart> handleSupportingTokens(org.apache.wss4j.policy.model.SupportingTokens, boolean, boolean, java.util.Map<org.apache.wss4j.policy.model.AbstractToken, org.apache.xml.security.stax.ext.SecurePart>) throws java.lang.Exception;
    Code:
       0: aload_1
       1: ifnonnull     7
       4: aload         4
       6: areturn
       7: aload_1
       8: invokevirtual #193                // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
      11: invokeinterface #194,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      16: astore        5
      18: aload         5
      20: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      25: ifeq          366
      28: aload         5
      30: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      35: checkcast     #195                // class org/apache/wss4j/policy/model/AbstractToken
      38: astore        6
      40: aload_0
      41: aload         6
      43: invokevirtual #8                  // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
      46: aload_0
      47: aload         6
      49: invokevirtual #76                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      52: invokevirtual #10                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      55: ifne          61
      58: goto          18
      61: aload         6
      63: instanceof    #196                // class org/apache/wss4j/policy/model/UsernameToken
      66: ifeq          88
      69: aload_0
      70: aload         6
      72: checkcast     #196                // class org/apache/wss4j/policy/model/UsernameToken
      75: iload_3
      76: aload_1
      77: invokevirtual #197                // Method org/apache/wss4j/policy/model/SupportingTokens.isEncryptedToken:()Z
      80: aload         4
      82: invokevirtual #198                // Method handleUsernameTokenSupportingToken:(Lorg/apache/wss4j/policy/model/UsernameToken;ZZLjava/util/Map;)V
      85: goto          363
      88: aload         6
      90: instanceof    #114                // class org/apache/wss4j/policy/model/IssuedToken
      93: ifeq          156
      96: aload_0
      97: invokevirtual #38                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     100: astore        7
     102: aload_0
     103: aload         6
     105: checkcast     #114                // class org/apache/wss4j/policy/model/IssuedToken
     108: aload         7
     110: iload_2
     111: iload_3
     112: invokevirtual #199                // Method addIssuedToken:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;ZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
     115: astore        8
     117: aload         8
     119: ifnull        153
     122: aload         4
     124: aload         6
     126: aload         8
     128: invokeinterface #200,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     133: pop
     134: aload_1
     135: invokevirtual #197                // Method org/apache/wss4j/policy/model/SupportingTokens.isEncryptedToken:()Z
     138: ifeq          153
     141: aload_0
     142: getfield      #4                  // Field encryptedTokensList:Ljava/util/Set;
     145: aload         8
     147: invokeinterface #201,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     152: pop
     153: goto          363
     156: aload         6
     158: instanceof    #202                // class org/apache/wss4j/policy/model/KerberosToken
     161: ifeq          217
     164: aload_0
     165: aload         6
     167: checkcast     #202                // class org/apache/wss4j/policy/model/KerberosToken
     170: iload_2
     171: iload_3
     172: iconst_0
     173: invokevirtual #203                // Method addKerberosToken:(Lorg/apache/wss4j/policy/model/KerberosToken;ZZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
     176: astore        7
     178: aload         7
     180: ifnull        214
     183: aload         4
     185: aload         6
     187: aload         7
     189: invokeinterface #200,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     194: pop
     195: aload_1
     196: invokevirtual #197                // Method org/apache/wss4j/policy/model/SupportingTokens.isEncryptedToken:()Z
     199: ifeq          214
     202: aload_0
     203: getfield      #4                  // Field encryptedTokensList:Ljava/util/Set;
     206: aload         7
     208: invokeinterface #201,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     213: pop
     214: goto          363
     217: aload         6
     219: instanceof    #141                // class org/apache/wss4j/policy/model/X509Token
     222: ifne          233
     225: aload         6
     227: instanceof    #173                // class org/apache/wss4j/policy/model/KeyValueToken
     230: ifeq          306
     233: aload_0
     234: aload         6
     236: invokevirtual #8                  // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
     239: aload_0
     240: aload         6
     242: iconst_0
     243: invokevirtual #204                // Method configureSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Z)V
     246: aload_1
     247: invokevirtual #197                // Method org/apache/wss4j/policy/model/SupportingTokens.isEncryptedToken:()Z
     250: ifeq          280
     253: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     256: dup
     257: getstatic     #57                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_BinarySecurityToken:Ljavax/xml/namespace/QName;
     260: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     263: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     266: astore        7
     268: aload_0
     269: getfield      #4                  // Field encryptedTokensList:Ljava/util/Set;
     272: aload         7
     274: invokeinterface #201,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     279: pop
     280: aload         4
     282: aload         6
     284: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     287: dup
     288: getstatic     #205                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_dsig_Signature:Ljavax/xml/namespace/QName;
     291: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     294: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     297: invokeinterface #200,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     302: pop
     303: goto          363
     306: aload         6
     308: instanceof    #206                // class org/apache/wss4j/policy/model/SamlToken
     311: ifeq          363
     314: aload_0
     315: aload         6
     317: checkcast     #206                // class org/apache/wss4j/policy/model/SamlToken
     320: iload_2
     321: iload_3
     322: invokevirtual #207                // Method addSamlToken:(Lorg/apache/wss4j/policy/model/SamlToken;ZZ)Lorg/apache/xml/security/stax/ext/SecurePart;
     325: astore        7
     327: aload         7
     329: ifnull        363
     332: aload         4
     334: aload         6
     336: aload         7
     338: invokeinterface #200,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     343: pop
     344: aload_1
     345: invokevirtual #197                // Method org/apache/wss4j/policy/model/SupportingTokens.isEncryptedToken:()Z
     348: ifeq          363
     351: aload_0
     352: getfield      #4                  // Field encryptedTokensList:Ljava/util/Set;
     355: aload         7
     357: invokeinterface #201,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     362: pop
     363: goto          18
     366: aload         4
     368: areturn

  protected void handleUsernameTokenSupportingToken(org.apache.wss4j.policy.model.UsernameToken, boolean, boolean, java.util.Map<org.apache.wss4j.policy.model.AbstractToken, org.apache.xml.security.stax.ext.SecurePart>) throws java.lang.Exception;
    Code:
       0: iload_2
       1: ifeq          14
       4: new           #65                 // class java/lang/Exception
       7: dup
       8: ldc           #208                // String Endorsing UsernameTokens are not supported in the streaming code
      10: invokespecial #209                // Method java/lang/Exception."<init>":(Ljava/lang/String;)V
      13: athrow
      14: aload_0
      15: aload_1
      16: invokevirtual #210                // Method addUsernameToken:(Lorg/apache/wss4j/policy/model/UsernameToken;)Lorg/apache/xml/security/stax/ext/SecurePart;
      19: astore        5
      21: aload         5
      23: ifnull        66
      26: aload         4
      28: aload_1
      29: aload         5
      31: invokeinterface #200,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      36: pop
      37: iload_3
      38: ifne          54
      41: aload_0
      42: getfield      #26                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      45: ldc           #211                // String ws-security.username-token.always.encrypted
      47: iconst_1
      48: invokestatic  #212                // Method org/apache/cxf/message/MessageUtils.getContextualBoolean:(Lorg/apache/cxf/message/Message;Ljava/lang/String;Z)Z
      51: ifeq          66
      54: aload_0
      55: getfield      #4                  // Field encryptedTokensList:Ljava/util/Set;
      58: aload         5
      60: invokeinterface #201,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      65: pop
      66: return

  protected void addSupportingTokens() throws java.lang.Exception;
    Code:
       0: aload_0
       1: ldc           #213                // String SignedSupportingTokens
       3: invokevirtual #214                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
       6: astore_1
       7: aload_1
       8: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
      13: ifne          29
      16: aload_0
      17: aload_1
      18: iconst_1
      19: iconst_0
      20: invokevirtual #215                // Method handleSupportingTokens:(Ljava/util/Collection;ZZ)Ljava/util/Map;
      23: astore_2
      24: aload_0
      25: aload_2
      26: invokevirtual #216                // Method addSignatureParts:(Ljava/util/Map;)V
      29: aload_0
      30: ldc           #217                // String EndorsingSupportingTokens
      32: invokevirtual #214                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
      35: astore_2
      36: aload_2
      37: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
      42: ifne          56
      45: aload_0
      46: aload_0
      47: aload_2
      48: iconst_0
      49: iconst_1
      50: invokevirtual #215                // Method handleSupportingTokens:(Ljava/util/Collection;ZZ)Ljava/util/Map;
      53: putfield      #218                // Field endSuppTokMap:Ljava/util/Map;
      56: aload_0
      57: ldc           #219                // String SignedEndorsingSupportingTokens
      59: invokevirtual #214                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
      62: astore_3
      63: aload_3
      64: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
      69: ifne          91
      72: aload_0
      73: aload_0
      74: aload_3
      75: iconst_1
      76: iconst_1
      77: invokevirtual #215                // Method handleSupportingTokens:(Ljava/util/Collection;ZZ)Ljava/util/Map;
      80: putfield      #220                // Field sgndEndSuppTokMap:Ljava/util/Map;
      83: aload_0
      84: aload_0
      85: getfield      #220                // Field sgndEndSuppTokMap:Ljava/util/Map;
      88: invokevirtual #216                // Method addSignatureParts:(Ljava/util/Map;)V
      91: aload_0
      92: ldc           #221                // String SignedEncryptedSupportingTokens
      94: invokevirtual #214                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
      97: astore        4
      99: aload         4
     101: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
     106: ifne          125
     109: aload_0
     110: aload         4
     112: iconst_1
     113: iconst_0
     114: invokevirtual #215                // Method handleSupportingTokens:(Ljava/util/Collection;ZZ)Ljava/util/Map;
     117: astore        5
     119: aload_0
     120: aload         5
     122: invokevirtual #216                // Method addSignatureParts:(Ljava/util/Map;)V
     125: aload_0
     126: ldc           #222                // String EndorsingEncryptedSupportingTokens
     128: invokevirtual #214                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     131: astore        5
     133: aload         5
     135: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
     140: ifne          155
     143: aload_0
     144: aload_0
     145: aload         5
     147: iconst_0
     148: iconst_1
     149: invokevirtual #215                // Method handleSupportingTokens:(Ljava/util/Collection;ZZ)Ljava/util/Map;
     152: putfield      #223                // Field endEncSuppTokMap:Ljava/util/Map;
     155: aload_0
     156: ldc           #224                // String SignedEndorsingEncryptedSupportingTokens
     158: invokevirtual #214                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     161: astore        6
     163: aload         6
     165: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
     170: ifne          193
     173: aload_0
     174: aload_0
     175: aload         6
     177: iconst_1
     178: iconst_1
     179: invokevirtual #215                // Method handleSupportingTokens:(Ljava/util/Collection;ZZ)Ljava/util/Map;
     182: putfield      #225                // Field sgndEndEncSuppTokMap:Ljava/util/Map;
     185: aload_0
     186: aload_0
     187: getfield      #225                // Field sgndEndEncSuppTokMap:Ljava/util/Map;
     190: invokevirtual #216                // Method addSignatureParts:(Ljava/util/Map;)V
     193: aload_0
     194: ldc           #226                // String SupportingTokens
     196: invokevirtual #214                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     199: astore        7
     201: aload         7
     203: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
     208: ifne          220
     211: aload_0
     212: aload         7
     214: iconst_0
     215: iconst_0
     216: invokevirtual #215                // Method handleSupportingTokens:(Ljava/util/Collection;ZZ)Ljava/util/Map;
     219: pop
     220: aload_0
     221: ldc           #227                // String EncryptedSupportingTokens
     223: invokevirtual #214                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     226: astore        8
     228: aload         8
     230: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
     235: ifne          247
     238: aload_0
     239: aload         8
     241: iconst_0
     242: iconst_0
     243: invokevirtual #215                // Method handleSupportingTokens:(Ljava/util/Collection;ZZ)Ljava/util/Map;
     246: pop
     247: return

  protected void addSignatureParts(java.util.Map<org.apache.wss4j.policy.model.AbstractToken, org.apache.xml.security.stax.ext.SecurePart>);
    Code:
       0: aload_1
       1: ifnull        114
       4: aload_1
       5: invokeinterface #228,  1          // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
      10: invokeinterface #229,  1          // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      15: astore_2
      16: aload_2
      17: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      22: ifeq          114
      25: aload_2
      26: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      31: checkcast     #230                // class java/util/Map$Entry
      34: astore_3
      35: aload_3
      36: invokeinterface #231,  1          // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
      41: checkcast     #33                 // class org/apache/xml/security/stax/ext/SecurePart
      44: astore        4
      46: aload         4
      48: invokevirtual #232                // Method org/apache/xml/security/stax/ext/SecurePart.getName:()Ljavax/xml/namespace/QName;
      51: astore        5
      53: aload_0
      54: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      57: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
      60: astore        6
      62: getstatic     #75                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_saml_Assertion:Ljavax/xml/namespace/QName;
      65: aload         5
      67: invokevirtual #233                // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      70: ifne          84
      73: getstatic     #71                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_saml2_Assertion:Ljavax/xml/namespace/QName;
      76: aload         5
      78: invokevirtual #233                // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      81: ifeq          102
      84: aload         6
      86: ifnull        102
      89: aload         6
      91: getstatic     #70                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_SIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      94: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      99: ifne          111
     102: aload_0
     103: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     106: aload         4
     108: invokevirtual #235                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.addSignaturePart:(Lorg/apache/xml/security/stax/ext/SecurePart;)V
     111: goto          16
     114: return

  protected void addSignatureConfirmation(java.util.List<org.apache.xml.security.stax.ext.SecurePart>);
    Code:
       0: aload_0
       1: invokevirtual #176                // Method getWss10:()Lorg/apache/wss4j/policy/model/Wss10;
       4: astore_2
       5: aload_2
       6: instanceof    #179                // class org/apache/wss4j/policy/model/Wss11
       9: ifeq          22
      12: aload_2
      13: checkcast     #179                // class org/apache/wss4j/policy/model/Wss11
      16: invokevirtual #236                // Method org/apache/wss4j/policy/model/Wss11.isRequireSignatureConfirmation:()Z
      19: ifne          23
      22: return
      23: aload_0
      24: invokevirtual #96                 // Method isRequestor:()Z
      27: ifeq          41
      30: aload_0
      31: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      34: iconst_1
      35: invokevirtual #237                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.setEnableSignatureConfirmationVerification:(Z)V
      38: goto          57
      41: aload_0
      42: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      45: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
      48: getstatic     #238                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_CONFIRMATION:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      51: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      56: pop
      57: aload_1
      58: ifnull        83
      61: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
      64: dup
      65: getstatic     #239                // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse11_SignatureConfirmation:Ljavax/xml/namespace/QName;
      68: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
      71: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
      74: astore_3
      75: aload_1
      76: aload_3
      77: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      82: pop
      83: aload_0
      84: iconst_1
      85: putfield      #240                // Field signatureConfirmationAdded:Z
      88: return

  protected java.util.List<org.apache.xml.security.stax.ext.SecurePart> getSignedParts() throws javax.xml.soap.SOAPException;
    Code:
       0: aconst_null
       1: astore_1
       2: aconst_null
       3: astore_2
       4: aload_0
       5: getfield      #26                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       8: ldc_w         #241                // class org/apache/cxf/ws/policy/AssertionInfoMap
      11: invokevirtual #242                // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      14: checkcast     #241                // class org/apache/cxf/ws/policy/AssertionInfoMap
      17: astore_3
      18: aload_3
      19: ldc           #243                // String SignedParts
      21: invokestatic  #129                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getFirstAssertionByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Lorg/apache/cxf/ws/policy/AssertionInfo;
      24: astore        4
      26: aload         4
      28: ifnull        46
      31: aload         4
      33: invokevirtual #130                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      36: checkcast     #244                // class org/apache/wss4j/policy/model/SignedParts
      39: astore_1
      40: aload         4
      42: iconst_1
      43: invokevirtual #132                // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      46: aload_3
      47: ldc           #245                // String SignedElements
      49: invokestatic  #129                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getFirstAssertionByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Lorg/apache/cxf/ws/policy/AssertionInfo;
      52: astore        4
      54: aload         4
      56: ifnull        74
      59: aload         4
      61: invokevirtual #130                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      64: checkcast     #246                // class org/apache/wss4j/policy/model/SignedElements
      67: astore_2
      68: aload         4
      70: iconst_1
      71: invokevirtual #132                // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      74: new           #247                // class java/util/ArrayList
      77: dup
      78: invokespecial #248                // Method java/util/ArrayList."<init>":()V
      81: astore        5
      83: aload_1
      84: ifnull        288
      87: aload_1
      88: invokevirtual #249                // Method org/apache/wss4j/policy/model/SignedParts.isBody:()Z
      91: ifeq          131
      94: new           #122                // class javax/xml/namespace/QName
      97: dup
      98: ldc           #250                // String http://www.w3.org/2003/05/soap-envelope
     100: ldc           #251                // String Body
     102: invokespecial #126                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     105: astore        6
     107: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     110: dup
     111: aload         6
     113: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     116: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     119: astore        7
     121: aload         5
     123: aload         7
     125: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     130: pop
     131: aload_1
     132: invokevirtual #252                // Method org/apache/wss4j/policy/model/SignedParts.getHeaders:()Ljava/util/List;
     135: invokeinterface #194,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     140: astore        6
     142: aload         6
     144: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     149: ifeq          229
     152: aload         6
     154: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     159: checkcast     #253                // class org/apache/wss4j/policy/model/Header
     162: astore        7
     164: aload         7
     166: invokevirtual #254                // Method org/apache/wss4j/policy/model/Header.getName:()Ljava/lang/String;
     169: astore        8
     171: aload         8
     173: ifnonnull     180
     176: ldc           #255                // String *
     178: astore        8
     180: new           #122                // class javax/xml/namespace/QName
     183: dup
     184: aload         7
     186: invokevirtual #256                // Method org/apache/wss4j/policy/model/Header.getNamespace:()Ljava/lang/String;
     189: aload         8
     191: invokespecial #126                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     194: astore        9
     196: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     199: dup
     200: aload         9
     202: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     205: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     208: astore        10
     210: aload         10
     212: iconst_0
     213: invokevirtual #257                // Method org/apache/xml/security/stax/ext/SecurePart.setRequired:(Z)V
     216: aload         5
     218: aload         10
     220: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     225: pop
     226: goto          142
     229: aload_1
     230: invokevirtual #258                // Method org/apache/wss4j/policy/model/SignedParts.getAttachments:()Lorg/apache/wss4j/policy/model/Attachments;
     233: astore        6
     235: aload         6
     237: ifnull        288
     240: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     243: astore        7
     245: aload         6
     247: invokevirtual #259                // Method org/apache/wss4j/policy/model/Attachments.isContentSignatureTransform:()Z
     250: ifeq          258
     253: getstatic     #260                // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Content:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     256: astore        7
     258: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     261: dup
     262: ldc_w         #261                // String cid:Attachments
     265: aload         7
     267: invokespecial #262                // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljava/lang/String;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     270: astore        8
     272: aload         8
     274: iconst_0
     275: invokevirtual #257                // Method org/apache/xml/security/stax/ext/SecurePart.setRequired:(Z)V
     278: aload         5
     280: aload         8
     282: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     287: pop
     288: aload_2
     289: ifnull        393
     292: aload_2
     293: invokevirtual #263                // Method org/apache/wss4j/policy/model/SignedElements.getXPaths:()Ljava/util/List;
     296: ifnull        393
     299: aload_2
     300: invokevirtual #263                // Method org/apache/wss4j/policy/model/SignedElements.getXPaths:()Ljava/util/List;
     303: invokeinterface #194,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     308: astore        6
     310: aload         6
     312: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     317: ifeq          393
     320: aload         6
     322: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     327: checkcast     #264                // class org/apache/wss4j/policy/model/XPath
     330: astore        7
     332: aload         7
     334: invokestatic  #265                // Method org/apache/wss4j/policy/stax/PolicyUtils.getElementPath:(Lorg/apache/wss4j/policy/model/XPath;)Ljava/util/List;
     337: astore        8
     339: aload         8
     341: invokeinterface #266,  1          // InterfaceMethod java/util/List.isEmpty:()Z
     346: ifne          390
     349: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     352: dup
     353: aload         8
     355: aload         8
     357: invokeinterface #267,  1          // InterfaceMethod java/util/List.size:()I
     362: iconst_1
     363: isub
     364: invokeinterface #268,  2          // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     369: checkcast     #122                // class javax/xml/namespace/QName
     372: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     375: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     378: astore        9
     380: aload         5
     382: aload         9
     384: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     389: pop
     390: goto          310
     393: aload         5
     395: areturn

  protected java.util.List<org.apache.xml.security.stax.ext.SecurePart> getEncryptedParts() throws javax.xml.soap.SOAPException;
    Code:
       0: aconst_null
       1: astore_1
       2: aconst_null
       3: astore_2
       4: aconst_null
       5: astore_3
       6: aload_0
       7: getfield      #26                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      10: ldc_w         #241                // class org/apache/cxf/ws/policy/AssertionInfoMap
      13: invokevirtual #242                // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      16: checkcast     #241                // class org/apache/cxf/ws/policy/AssertionInfoMap
      19: astore        4
      21: aload         4
      23: ldc_w         #269                // String EncryptedParts
      26: invokestatic  #270                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      29: astore        5
      31: aload         5
      33: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
      38: ifne          90
      41: aload         5
      43: invokeinterface #186,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      48: astore        6
      50: aload         6
      52: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      57: ifeq          90
      60: aload         6
      62: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      67: checkcast     #189                // class org/apache/cxf/ws/policy/AssertionInfo
      70: astore        7
      72: aload         7
      74: invokevirtual #130                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      77: checkcast     #271                // class org/apache/wss4j/policy/model/EncryptedParts
      80: astore_1
      81: aload         7
      83: iconst_1
      84: invokevirtual #132                // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      87: goto          50
      90: aload         4
      92: ldc_w         #272                // String EncryptedElements
      95: invokestatic  #270                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      98: astore        5
     100: aload         5
     102: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
     107: ifne          159
     110: aload         5
     112: invokeinterface #186,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     117: astore        6
     119: aload         6
     121: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     126: ifeq          159
     129: aload         6
     131: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     136: checkcast     #189                // class org/apache/cxf/ws/policy/AssertionInfo
     139: astore        7
     141: aload         7
     143: invokevirtual #130                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     146: checkcast     #273                // class org/apache/wss4j/policy/model/EncryptedElements
     149: astore_2
     150: aload         7
     152: iconst_1
     153: invokevirtual #132                // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     156: goto          119
     159: aload         4
     161: ldc_w         #274                // String ContentEncryptedElements
     164: invokestatic  #270                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
     167: astore        5
     169: aload         5
     171: invokeinterface #183,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
     176: ifne          228
     179: aload         5
     181: invokeinterface #186,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     186: astore        6
     188: aload         6
     190: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     195: ifeq          228
     198: aload         6
     200: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     205: checkcast     #189                // class org/apache/cxf/ws/policy/AssertionInfo
     208: astore        7
     210: aload         7
     212: invokevirtual #130                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     215: checkcast     #275                // class org/apache/wss4j/policy/model/ContentEncryptedElements
     218: astore_3
     219: aload         7
     221: iconst_1
     222: invokevirtual #132                // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     225: goto          188
     228: new           #247                // class java/util/ArrayList
     231: dup
     232: invokespecial #248                // Method java/util/ArrayList."<init>":()V
     235: astore        6
     237: aload_1
     238: ifnull        447
     241: aload_1
     242: invokevirtual #276                // Method org/apache/wss4j/policy/model/EncryptedParts.isBody:()Z
     245: ifeq          285
     248: new           #122                // class javax/xml/namespace/QName
     251: dup
     252: ldc           #250                // String http://www.w3.org/2003/05/soap-envelope
     254: ldc           #251                // String Body
     256: invokespecial #126                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     259: astore        7
     261: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     264: dup
     265: aload         7
     267: getstatic     #260                // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Content:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     270: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     273: astore        8
     275: aload         6
     277: aload         8
     279: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     284: pop
     285: aload_1
     286: invokevirtual #277                // Method org/apache/wss4j/policy/model/EncryptedParts.getHeaders:()Ljava/util/List;
     289: invokeinterface #194,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     294: astore        7
     296: aload         7
     298: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     303: ifeq          383
     306: aload         7
     308: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     313: checkcast     #253                // class org/apache/wss4j/policy/model/Header
     316: astore        8
     318: aload         8
     320: invokevirtual #254                // Method org/apache/wss4j/policy/model/Header.getName:()Ljava/lang/String;
     323: astore        9
     325: aload         9
     327: ifnonnull     334
     330: ldc           #255                // String *
     332: astore        9
     334: new           #122                // class javax/xml/namespace/QName
     337: dup
     338: aload         8
     340: invokevirtual #256                // Method org/apache/wss4j/policy/model/Header.getNamespace:()Ljava/lang/String;
     343: aload         9
     345: invokespecial #126                // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     348: astore        10
     350: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     353: dup
     354: aload         10
     356: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     359: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     362: astore        11
     364: aload         11
     366: iconst_0
     367: invokevirtual #257                // Method org/apache/xml/security/stax/ext/SecurePart.setRequired:(Z)V
     370: aload         6
     372: aload         11
     374: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     379: pop
     380: goto          296
     383: aload_1
     384: invokevirtual #278                // Method org/apache/wss4j/policy/model/EncryptedParts.getAttachments:()Lorg/apache/wss4j/policy/model/Attachments;
     387: astore        7
     389: aload         7
     391: ifnull        447
     394: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     397: dup
     398: ldc_w         #261                // String cid:Attachments
     401: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     404: invokespecial #262                // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljava/lang/String;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     407: astore        8
     409: aload_0
     410: getfield      #26                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     413: ldc_w         #279                // String ws-security.swa.encryption.attachment.transform.content
     416: iconst_0
     417: invokestatic  #212                // Method org/apache/cxf/message/MessageUtils.getContextualBoolean:(Lorg/apache/cxf/message/Message;Ljava/lang/String;Z)Z
     420: ifeq          431
     423: aload         8
     425: getstatic     #260                // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Content:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     428: invokevirtual #280                // Method org/apache/xml/security/stax/ext/SecurePart.setModifier:(Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     431: aload         8
     433: iconst_0
     434: invokevirtual #257                // Method org/apache/xml/security/stax/ext/SecurePart.setRequired:(Z)V
     437: aload         6
     439: aload         8
     441: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     446: pop
     447: aload_2
     448: ifnull        552
     451: aload_2
     452: invokevirtual #281                // Method org/apache/wss4j/policy/model/EncryptedElements.getXPaths:()Ljava/util/List;
     455: ifnull        552
     458: aload_2
     459: invokevirtual #281                // Method org/apache/wss4j/policy/model/EncryptedElements.getXPaths:()Ljava/util/List;
     462: invokeinterface #194,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     467: astore        7
     469: aload         7
     471: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     476: ifeq          552
     479: aload         7
     481: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     486: checkcast     #264                // class org/apache/wss4j/policy/model/XPath
     489: astore        8
     491: aload         8
     493: invokestatic  #265                // Method org/apache/wss4j/policy/stax/PolicyUtils.getElementPath:(Lorg/apache/wss4j/policy/model/XPath;)Ljava/util/List;
     496: astore        9
     498: aload         9
     500: invokeinterface #266,  1          // InterfaceMethod java/util/List.isEmpty:()Z
     505: ifne          549
     508: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     511: dup
     512: aload         9
     514: aload         9
     516: invokeinterface #267,  1          // InterfaceMethod java/util/List.size:()I
     521: iconst_1
     522: isub
     523: invokeinterface #268,  2          // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     528: checkcast     #122                // class javax/xml/namespace/QName
     531: getstatic     #35                 // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Element:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     534: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     537: astore        10
     539: aload         6
     541: aload         10
     543: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     548: pop
     549: goto          469
     552: aload_3
     553: ifnull        657
     556: aload_3
     557: invokevirtual #282                // Method org/apache/wss4j/policy/model/ContentEncryptedElements.getXPaths:()Ljava/util/List;
     560: ifnull        657
     563: aload_3
     564: invokevirtual #282                // Method org/apache/wss4j/policy/model/ContentEncryptedElements.getXPaths:()Ljava/util/List;
     567: invokeinterface #194,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     572: astore        7
     574: aload         7
     576: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     581: ifeq          657
     584: aload         7
     586: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     591: checkcast     #264                // class org/apache/wss4j/policy/model/XPath
     594: astore        8
     596: aload         8
     598: invokestatic  #265                // Method org/apache/wss4j/policy/stax/PolicyUtils.getElementPath:(Lorg/apache/wss4j/policy/model/XPath;)Ljava/util/List;
     601: astore        9
     603: aload         9
     605: invokeinterface #266,  1          // InterfaceMethod java/util/List.isEmpty:()Z
     610: ifne          654
     613: new           #33                 // class org/apache/xml/security/stax/ext/SecurePart
     616: dup
     617: aload         9
     619: aload         9
     621: invokeinterface #267,  1          // InterfaceMethod java/util/List.size:()I
     626: iconst_1
     627: isub
     628: invokeinterface #268,  2          // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     633: checkcast     #122                // class javax/xml/namespace/QName
     636: getstatic     #260                // Field org/apache/xml/security/stax/ext/SecurePart$Modifier.Content:Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;
     639: invokespecial #36                 // Method org/apache/xml/security/stax/ext/SecurePart."<init>":(Ljavax/xml/namespace/QName;Lorg/apache/xml/security/stax/ext/SecurePart$Modifier;)V
     642: astore        10
     644: aload         6
     646: aload         10
     648: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     653: pop
     654: goto          574
     657: aload         6
     659: areturn

  protected org.apache.xml.security.stax.securityToken.SecurityToken findInboundSecurityToken(org.apache.xml.security.stax.securityEvent.SecurityEventConstants$Event) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_0
       1: getfield      #26                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       4: invokevirtual #283                // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
       7: new           #284                // class java/lang/StringBuilder
      10: dup
      11: invokespecial #285                // Method java/lang/StringBuilder."<init>":()V
      14: ldc_w         #286                // class org/apache/xml/security/stax/securityEvent/SecurityEvent
      17: invokevirtual #287                // Method java/lang/Class.getName:()Ljava/lang/String;
      20: invokevirtual #288                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      23: ldc_w         #289                // String .in
      26: invokevirtual #288                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      29: invokevirtual #290                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      32: invokeinterface #291,  2          // InterfaceMethod org/apache/cxf/message/Exchange.get:(Ljava/lang/Object;)Ljava/lang/Object;
      37: checkcast     #292                // class java/util/List
      40: astore_2
      41: aload_2
      42: ifnull        97
      45: aload_2
      46: invokeinterface #194,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      51: astore_3
      52: aload_3
      53: invokeinterface #187,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      58: ifeq          97
      61: aload_3
      62: invokeinterface #188,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      67: checkcast     #286                // class org/apache/xml/security/stax/securityEvent/SecurityEvent
      70: astore        4
      72: aload_1
      73: aload         4
      75: invokevirtual #293                // Method org/apache/xml/security/stax/securityEvent/SecurityEvent.getSecurityEventType:()Lorg/apache/xml/security/stax/securityEvent/SecurityEventConstants$Event;
      78: if_acmpne     94
      81: aload         4
      83: checkcast     #294                // class org/apache/xml/security/stax/securityEvent/TokenSecurityEvent
      86: invokevirtual #295                // Method org/apache/xml/security/stax/securityEvent/TokenSecurityEvent.getSecurityToken:()Lorg/apache/xml/security/stax/securityToken/SecurityToken;
      89: astore        5
      91: aload         5
      93: areturn
      94: goto          52
      97: aconst_null
      98: areturn

  protected void removeSignatureIfSignedSAML();
    Code:
       0: aload_0
       1: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
       4: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
       7: ifnull        52
      10: aload_0
      11: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      14: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
      17: astore_1
      18: aload_1
      19: getstatic     #70                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_SIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      22: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      27: ifeq          52
      30: aload_1
      31: getstatic     #296                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      34: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      39: ifeq          52
      42: aload_1
      43: getstatic     #296                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      46: invokeinterface #297,  2          // InterfaceMethod java/util/List.remove:(Ljava/lang/Object;)Z
      51: pop
      52: return

  protected void prependSignatureToSC();
    Code:
       0: aload_0
       1: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
       4: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
       7: ifnull        123
      10: aload_0
      11: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      14: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
      17: astore_1
      18: aload_1
      19: getstatic     #238                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_CONFIRMATION:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      22: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      27: istore_2
      28: iload_2
      29: ifeq          77
      32: aload_1
      33: getstatic     #296                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      36: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      41: ifeq          77
      44: aload_1
      45: getstatic     #238                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_CONFIRMATION:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      48: invokeinterface #297,  2          // InterfaceMethod java/util/List.remove:(Ljava/lang/Object;)Z
      53: pop
      54: aload_1
      55: aload_1
      56: getstatic     #296                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      59: invokeinterface #298,  2          // InterfaceMethod java/util/List.indexOf:(Ljava/lang/Object;)I
      64: iconst_1
      65: iadd
      66: getstatic     #238                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_CONFIRMATION:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      69: invokeinterface #139,  3          // InterfaceMethod java/util/List.add:(ILjava/lang/Object;)V
      74: goto          123
      77: iload_2
      78: ifeq          123
      81: aload_1
      82: getstatic     #299                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_WITH_DERIVED_KEY:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      85: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      90: ifeq          123
      93: aload_1
      94: getstatic     #238                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_CONFIRMATION:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      97: invokeinterface #297,  2          // InterfaceMethod java/util/List.remove:(Ljava/lang/Object;)Z
     102: pop
     103: aload_1
     104: aload_1
     105: getstatic     #299                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_WITH_DERIVED_KEY:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     108: invokeinterface #298,  2          // InterfaceMethod java/util/List.indexOf:(Ljava/lang/Object;)I
     113: iconst_1
     114: iadd
     115: getstatic     #238                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_CONFIRMATION:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
     118: invokeinterface #139,  3          // InterfaceMethod java/util/List.add:(ILjava/lang/Object;)V
     123: return

  protected void enforceEncryptBeforeSigningWithSignedSAML();
    Code:
       0: aload_0
       1: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
       4: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
       7: ifnull        50
      10: aload_0
      11: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      14: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
      17: astore_1
      18: aload_1
      19: getstatic     #70                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_SIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      22: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      27: ifeq          50
      30: aload_1
      31: getstatic     #70                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_SIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      34: invokeinterface #297,  2          // InterfaceMethod java/util/List.remove:(Ljava/lang/Object;)Z
      39: pop
      40: aload_1
      41: getstatic     #70                 // Field org/apache/wss4j/stax/ext/WSSConstants.SAML_TOKEN_SIGNED:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      44: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      49: pop
      50: return

  protected void putCustomTokenAfterSignature();
    Code:
       0: aload_0
       1: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
       4: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
       7: ifnull        98
      10: aload_0
      11: getfield      #5                  // Field properties:Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      14: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
      17: astore_1
      18: aload_1
      19: getstatic     #296                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      22: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      27: ifne          54
      30: aload_1
      31: getstatic     #299                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_WITH_DERIVED_KEY:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      34: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      39: ifne          54
      42: aload_1
      43: getstatic     #300                // Field org/apache/wss4j/stax/ext/WSSConstants.SIGNATURE_WITH_KERBEROS_TOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      46: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      51: ifeq          98
      54: aload_1
      55: getstatic     #97                 // Field org/apache/wss4j/stax/ext/WSSConstants.CUSTOM_TOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      58: invokeinterface #234,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      63: ifeq          98
      66: aload_0
      67: invokevirtual #301                // Method getProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      70: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
      73: getstatic     #97                 // Field org/apache/wss4j/stax/ext/WSSConstants.CUSTOM_TOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      76: invokeinterface #297,  2          // InterfaceMethod java/util/List.remove:(Ljava/lang/Object;)Z
      81: pop
      82: aload_0
      83: invokevirtual #301                // Method getProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      86: invokevirtual #138                // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getActions:()Ljava/util/List;
      89: getstatic     #97                 // Field org/apache/wss4j/stax/ext/WSSConstants.CUSTOM_TOKEN:Lorg/apache/xml/security/stax/ext/XMLSecurityConstants$Action;
      92: invokeinterface #140,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      97: pop
      98: return
}
