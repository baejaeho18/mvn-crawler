Compiled from "KerberosTokenPolicyValidator.java"
public class org.apache.cxf.ws.security.wss4j.policyvalidators.KerberosTokenPolicyValidator extends org.apache.cxf.ws.security.wss4j.policyvalidators.AbstractSecurityPolicyValidator {
  public org.apache.cxf.ws.security.wss4j.policyvalidators.KerberosTokenPolicyValidator();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/policyvalidators/AbstractSecurityPolicyValidator."<init>":()V
       4: return

  public boolean canValidatePolicy(org.apache.cxf.ws.policy.AssertionInfo);
    Code:
       0: aload_1
       1: invokevirtual #2                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
       4: ifnull        47
       7: getstatic     #3                  // Field org/apache/wss4j/policy/SP12Constants.KERBEROS_TOKEN:Ljavax/xml/namespace/QName;
      10: aload_1
      11: invokevirtual #2                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      14: invokeinterface #4,  1            // InterfaceMethod org/apache/neethi/Assertion.getName:()Ljavax/xml/namespace/QName;
      19: invokevirtual #5                  // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      22: ifne          43
      25: getstatic     #6                  // Field org/apache/wss4j/policy/SP11Constants.KERBEROS_TOKEN:Ljavax/xml/namespace/QName;
      28: aload_1
      29: invokevirtual #2                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      32: invokeinterface #4,  1            // InterfaceMethod org/apache/neethi/Assertion.getName:()Ljavax/xml/namespace/QName;
      37: invokevirtual #5                  // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      40: ifeq          47
      43: iconst_1
      44: goto          48
      47: iconst_0
      48: ireturn

  public void validatePolicies(org.apache.cxf.ws.security.wss4j.policyvalidators.PolicyValidatorParameters, java.util.Collection<org.apache.cxf.ws.policy.AssertionInfo>);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #7                  // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getResults:()Lorg/apache/wss4j/dom/handler/WSHandlerResult;
       5: invokevirtual #8                  // Method org/apache/wss4j/dom/handler/WSHandlerResult.getActionResults:()Ljava/util/Map;
       8: sipush        4096
      11: invokestatic  #9                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      14: invokeinterface #10,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      19: checkcast     #11                 // class java/util/List
      22: invokespecial #12                 // Method findKerberosResults:(Ljava/util/List;)Ljava/util/List;
      25: astore_3
      26: aload_3
      27: invokeinterface #13,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      32: astore        4
      34: aload         4
      36: invokeinterface #14,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      41: ifeq          295
      44: aload         4
      46: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      51: checkcast     #16                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
      54: astore        5
      56: aload         5
      58: ldc           #17                 // String binary-security-token
      60: invokevirtual #18                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      63: checkcast     #19                 // class org/apache/wss4j/dom/message/token/KerberosSecurity
      66: astore        6
      68: iconst_1
      69: istore        7
      71: aload_2
      72: invokeinterface #20,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      77: astore        8
      79: aload         8
      81: invokeinterface #14,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      86: ifeq          224
      89: aload         8
      91: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      96: checkcast     #21                 // class org/apache/cxf/ws/policy/AssertionInfo
      99: astore        9
     101: aload         9
     103: invokevirtual #2                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     106: checkcast     #22                 // class org/apache/wss4j/policy/model/KerberosToken
     109: astore        10
     111: aload         9
     113: iconst_1
     114: invokevirtual #23                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     117: aload_0
     118: aload         10
     120: aload_1
     121: invokevirtual #24                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getAssertionInfoMap:()Lorg/apache/cxf/ws/policy/AssertionInfoMap;
     124: invokespecial #25                 // Method assertToken:(Lorg/apache/wss4j/policy/model/KerberosToken;Lorg/apache/cxf/ws/policy/AssertionInfoMap;)V
     127: aload_0
     128: aload         10
     130: aload_1
     131: invokevirtual #26                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getMessage:()Lorg/apache/cxf/message/Message;
     134: invokevirtual #27                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/message/Message;)Z
     137: ifne          193
     140: aload_1
     141: invokevirtual #24                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getAssertionInfoMap:()Lorg/apache/cxf/ws/policy/AssertionInfoMap;
     144: new           #28                 // class javax/xml/namespace/QName
     147: dup
     148: aload         10
     150: invokevirtual #29                 // Method org/apache/wss4j/policy/model/KerberosToken.getVersion:()Lorg/apache/wss4j/policy/SPConstants$SPVersion;
     153: invokevirtual #30                 // Method org/apache/wss4j/policy/SPConstants$SPVersion.getNamespace:()Ljava/lang/String;
     156: ldc           #31                 // String WssKerberosV5ApReqToken11
     158: invokespecial #32                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     161: invokestatic  #33                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
     164: pop
     165: aload_1
     166: invokevirtual #24                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getAssertionInfoMap:()Lorg/apache/cxf/ws/policy/AssertionInfoMap;
     169: new           #28                 // class javax/xml/namespace/QName
     172: dup
     173: aload         10
     175: invokevirtual #29                 // Method org/apache/wss4j/policy/model/KerberosToken.getVersion:()Lorg/apache/wss4j/policy/SPConstants$SPVersion;
     178: invokevirtual #30                 // Method org/apache/wss4j/policy/SPConstants$SPVersion.getNamespace:()Ljava/lang/String;
     181: ldc           #34                 // String WssGssKerberosV5ApReqToken11
     183: invokespecial #32                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     186: invokestatic  #33                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
     189: pop
     190: goto          79
     193: aload_0
     194: aload_1
     195: invokevirtual #24                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getAssertionInfoMap:()Lorg/apache/cxf/ws/policy/AssertionInfoMap;
     198: aload         10
     200: aload         6
     202: invokespecial #35                 // Method checkToken:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Lorg/apache/wss4j/policy/model/KerberosToken;Lorg/apache/wss4j/dom/message/token/KerberosSecurity;)Z
     205: ifne          221
     208: iconst_0
     209: istore        7
     211: aload         9
     213: ldc           #36                 // String An incorrect Kerberos Token Type is detected
     215: invokevirtual #37                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     218: goto          79
     221: goto          79
     224: iload         7
     226: ifeq          292
     229: aload_0
     230: aload         6
     232: invokespecial #38                 // Method createSecurityToken:(Lorg/apache/wss4j/dom/message/token/KerberosSecurity;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     235: astore        8
     237: aload         8
     239: aload         5
     241: ldc           #39                 // String secret
     243: invokevirtual #18                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     246: checkcast     #40                 // class "[B"
     249: checkcast     #40                 // class "[B"
     252: invokevirtual #41                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
     255: aload_1
     256: invokevirtual #26                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getMessage:()Lorg/apache/cxf/message/Message;
     259: invokestatic  #42                 // Method org/apache/cxf/ws/security/tokenstore/TokenStoreUtils.getTokenStore:(Lorg/apache/cxf/message/Message;)Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     262: aload         8
     264: invokeinterface #43,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.add:(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
     269: aload_1
     270: invokevirtual #26                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getMessage:()Lorg/apache/cxf/message/Message;
     273: invokeinterface #44,  1           // InterfaceMethod org/apache/cxf/message/Message.getExchange:()Lorg/apache/cxf/message/Exchange;
     278: ldc           #45                 // String ws-security.token.id
     280: aload         8
     282: invokevirtual #46                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     285: invokeinterface #47,  3           // InterfaceMethod org/apache/cxf/message/Exchange.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     290: pop
     291: return
     292: goto          34
     295: return

  private void assertToken(org.apache.wss4j.policy.model.KerberosToken, org.apache.cxf.ws.policy.AssertionInfoMap);
    Code:
       0: aload_1
       1: invokevirtual #48                 // Method org/apache/wss4j/policy/model/KerberosToken.getName:()Ljavax/xml/namespace/QName;
       4: invokevirtual #49                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
       7: astore_3
       8: aload_1
       9: invokevirtual #50                 // Method org/apache/wss4j/policy/model/KerberosToken.isRequireKeyIdentifierReference:()Z
      12: ifeq          30
      15: aload_2
      16: new           #28                 // class javax/xml/namespace/QName
      19: dup
      20: aload_3
      21: ldc           #51                 // String RequireKeyIdentifierReference
      23: invokespecial #32                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      26: invokestatic  #33                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      29: pop
      30: return

  private boolean checkToken(org.apache.cxf.ws.policy.AssertionInfoMap, org.apache.wss4j.policy.model.KerberosToken, org.apache.wss4j.dom.message.token.KerberosSecurity);
    Code:
       0: aload_2
       1: invokevirtual #52                 // Method org/apache/wss4j/policy/model/KerberosToken.getApReqTokenType:()Lorg/apache/wss4j/policy/model/KerberosToken$ApReqTokenType;
       4: astore        4
       6: aload         4
       8: getstatic     #53                 // Field org/apache/wss4j/policy/model/KerberosToken$ApReqTokenType.WssKerberosV5ApReqToken11:Lorg/apache/wss4j/policy/model/KerberosToken$ApReqTokenType;
      11: if_acmpne     44
      14: aload_3
      15: invokevirtual #54                 // Method org/apache/wss4j/dom/message/token/KerberosSecurity.isV5ApReq:()Z
      18: ifeq          44
      21: aload_1
      22: new           #28                 // class javax/xml/namespace/QName
      25: dup
      26: aload_2
      27: invokevirtual #29                 // Method org/apache/wss4j/policy/model/KerberosToken.getVersion:()Lorg/apache/wss4j/policy/SPConstants$SPVersion;
      30: invokevirtual #30                 // Method org/apache/wss4j/policy/SPConstants$SPVersion.getNamespace:()Ljava/lang/String;
      33: ldc           #31                 // String WssKerberosV5ApReqToken11
      35: invokespecial #32                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      38: invokestatic  #33                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      41: pop
      42: iconst_1
      43: ireturn
      44: aload         4
      46: getstatic     #55                 // Field org/apache/wss4j/policy/model/KerberosToken$ApReqTokenType.WssGssKerberosV5ApReqToken11:Lorg/apache/wss4j/policy/model/KerberosToken$ApReqTokenType;
      49: if_acmpne     82
      52: aload_3
      53: invokevirtual #56                 // Method org/apache/wss4j/dom/message/token/KerberosSecurity.isGssV5ApReq:()Z
      56: ifeq          82
      59: aload_1
      60: new           #28                 // class javax/xml/namespace/QName
      63: dup
      64: aload_2
      65: invokevirtual #29                 // Method org/apache/wss4j/policy/model/KerberosToken.getVersion:()Lorg/apache/wss4j/policy/SPConstants$SPVersion;
      68: invokevirtual #30                 // Method org/apache/wss4j/policy/SPConstants$SPVersion.getNamespace:()Ljava/lang/String;
      71: ldc           #34                 // String WssGssKerberosV5ApReqToken11
      73: invokespecial #32                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      76: invokestatic  #33                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      79: pop
      80: iconst_1
      81: ireturn
      82: iconst_0
      83: ireturn

  private java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult> findKerberosResults(java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult>);
    Code:
       0: new           #57                 // class java/util/ArrayList
       3: dup
       4: invokespecial #58                 // Method java/util/ArrayList."<init>":()V
       7: astore_2
       8: aload_1
       9: ifnull        71
      12: aload_1
      13: invokeinterface #13,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      18: astore_3
      19: aload_3
      20: invokeinterface #14,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      25: ifeq          71
      28: aload_3
      29: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      34: checkcast     #16                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
      37: astore        4
      39: aload         4
      41: ldc           #17                 // String binary-security-token
      43: invokevirtual #18                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      46: checkcast     #59                 // class org/apache/wss4j/common/token/BinarySecurity
      49: astore        5
      51: aload         5
      53: instanceof    #19                 // class org/apache/wss4j/dom/message/token/KerberosSecurity
      56: ifeq          68
      59: aload_2
      60: aload         4
      62: invokeinterface #60,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      67: pop
      68: goto          19
      71: aload_2
      72: areturn

  private org.apache.cxf.ws.security.tokenstore.SecurityToken createSecurityToken(org.apache.wss4j.dom.message.token.KerberosSecurity);
    Code:
       0: new           #61                 // class org/apache/cxf/ws/security/tokenstore/SecurityToken
       3: dup
       4: aload_1
       5: invokevirtual #62                 // Method org/apache/wss4j/dom/message/token/KerberosSecurity.getID:()Ljava/lang/String;
       8: invokespecial #63                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;)V
      11: astore_2
      12: aload_2
      13: aload_1
      14: invokevirtual #64                 // Method org/apache/wss4j/dom/message/token/KerberosSecurity.getElement:()Lorg/w3c/dom/Element;
      17: invokevirtual #65                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setToken:(Lorg/w3c/dom/Element;)V
      20: aload_2
      21: aload_1
      22: invokevirtual #66                 // Method org/apache/wss4j/dom/message/token/KerberosSecurity.getValueType:()Ljava/lang/String;
      25: invokevirtual #67                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setTokenType:(Ljava/lang/String;)V
      28: aload_1
      29: invokevirtual #68                 // Method org/apache/wss4j/dom/message/token/KerberosSecurity.getToken:()[B
      32: astore_3
      33: aload_2
      34: aload_3
      35: invokestatic  #69                 // Method org/apache/wss4j/common/util/KeyUtils.generateDigest:([B)[B
      38: invokestatic  #70                 // Method org/apache/xml/security/utils/Base64.encode:([B)Ljava/lang/String;
      41: invokevirtual #71                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSHA1:(Ljava/lang/String;)V
      44: goto          49
      47: astore        4
      49: aload_2
      50: areturn
    Exception table:
       from    to  target type
          33    44    47   Class org/apache/wss4j/common/ext/WSSecurityException
}
