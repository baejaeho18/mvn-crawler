Compiled from "X509TokenPolicyValidator.java"
public class org.apache.cxf.ws.security.wss4j.policyvalidators.X509TokenPolicyValidator extends org.apache.cxf.ws.security.wss4j.policyvalidators.AbstractSecurityPolicyValidator {
  private static final java.util.logging.Logger LOG;

  private static final java.lang.String X509_V3_VALUETYPE;

  private static final java.lang.String PKI_VALUETYPE;

  public org.apache.cxf.ws.security.wss4j.policyvalidators.X509TokenPolicyValidator();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/policyvalidators/AbstractSecurityPolicyValidator."<init>":()V
       4: return

  public boolean canValidatePolicy(org.apache.cxf.ws.policy.AssertionInfo);
    Code:
       0: aload_1
       1: invokevirtual #2                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
       4: ifnull        47
       7: getstatic     #3                  // Field org/apache/wss4j/policy/SP12Constants.X509_TOKEN:Ljavax/xml/namespace/QName;
      10: aload_1
      11: invokevirtual #2                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      14: invokeinterface #4,  1            // InterfaceMethod org/apache/neethi/Assertion.getName:()Ljavax/xml/namespace/QName;
      19: invokevirtual #5                  // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      22: ifne          43
      25: getstatic     #6                  // Field org/apache/wss4j/policy/SP11Constants.X509_TOKEN:Ljavax/xml/namespace/QName;
      28: aload_1
      29: invokevirtual #2                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      32: invokeinterface #4,  1            // InterfaceMethod org/apache/neethi/Assertion.getName:()Ljavax/xml/namespace/QName;
      37: invokevirtual #5                  // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      40: ifeq          47
      43: iconst_1
      44: goto          48
      47: iconst_0
      48: ireturn

  public void validatePolicies(org.apache.cxf.ws.security.wss4j.policyvalidators.PolicyValidatorParameters, java.util.Collection<org.apache.cxf.ws.policy.AssertionInfo>);
    Code:
       0: aload_1
       1: invokevirtual #7                  // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getResults:()Lorg/apache/wss4j/dom/handler/WSHandlerResult;
       4: invokevirtual #8                  // Method org/apache/wss4j/dom/handler/WSHandlerResult.getActionResults:()Ljava/util/Map;
       7: sipush        4096
      10: invokestatic  #9                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      13: invokeinterface #10,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      18: checkcast     #11                 // class java/util/List
      21: astore_3
      22: aload_2
      23: invokeinterface #12,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      28: astore        4
      30: aload         4
      32: invokeinterface #13,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      37: ifeq          159
      40: aload         4
      42: invokeinterface #14,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      47: checkcast     #15                 // class org/apache/cxf/ws/policy/AssertionInfo
      50: astore        5
      52: aload         5
      54: invokevirtual #2                  // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      57: checkcast     #16                 // class org/apache/wss4j/policy/model/X509Token
      60: astore        6
      62: aload         5
      64: iconst_1
      65: invokevirtual #17                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      68: aload_0
      69: aload         6
      71: aload_1
      72: invokevirtual #18                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getAssertionInfoMap:()Lorg/apache/cxf/ws/policy/AssertionInfoMap;
      75: invokespecial #19                 // Method assertToken:(Lorg/apache/wss4j/policy/model/X509Token;Lorg/apache/cxf/ws/policy/AssertionInfoMap;)V
      78: aload_0
      79: aload         6
      81: aload_1
      82: invokevirtual #20                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getMessage:()Lorg/apache/cxf/message/Message;
      85: invokevirtual #21                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/message/Message;)Z
      88: ifne          94
      91: goto          30
      94: aload_3
      95: ifnull        107
      98: aload_3
      99: invokeinterface #22,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     104: ifeq          129
     107: aload_1
     108: invokevirtual #23                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getSignedResults:()Ljava/util/List;
     111: invokeinterface #22,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     116: ifeq          129
     119: aload         5
     121: ldc           #24                 // String The received token does not match the token inclusion requirement
     123: invokevirtual #25                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     126: goto          30
     129: aload_0
     130: aload         6
     132: invokevirtual #26                 // Method org/apache/wss4j/policy/model/X509Token.getTokenType:()Lorg/apache/wss4j/policy/model/X509Token$TokenType;
     135: aload_3
     136: aload_1
     137: invokevirtual #23                 // Method org/apache/cxf/ws/security/wss4j/policyvalidators/PolicyValidatorParameters.getSignedResults:()Ljava/util/List;
     140: invokespecial #27                 // Method checkTokenType:(Lorg/apache/wss4j/policy/model/X509Token$TokenType;Ljava/util/List;Ljava/util/List;)Z
     143: ifne          156
     146: aload         5
     148: ldc           #28                 // String An incorrect X.509 Token Type is detected
     150: invokevirtual #25                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     153: goto          30
     156: goto          30
     159: return

  private void assertToken(org.apache.wss4j.policy.model.X509Token, org.apache.cxf.ws.policy.AssertionInfoMap);
    Code:
       0: aload_1
       1: invokevirtual #29                 // Method org/apache/wss4j/policy/model/X509Token.getName:()Ljavax/xml/namespace/QName;
       4: invokevirtual #30                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
       7: astore_3
       8: aload_1
       9: invokevirtual #31                 // Method org/apache/wss4j/policy/model/X509Token.isRequireIssuerSerialReference:()Z
      12: ifeq          30
      15: aload_2
      16: new           #32                 // class javax/xml/namespace/QName
      19: dup
      20: aload_3
      21: ldc           #33                 // String RequireIssuerSerialReference
      23: invokespecial #34                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      26: invokestatic  #35                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      29: pop
      30: aload_1
      31: invokevirtual #36                 // Method org/apache/wss4j/policy/model/X509Token.isRequireThumbprintReference:()Z
      34: ifeq          52
      37: aload_2
      38: new           #32                 // class javax/xml/namespace/QName
      41: dup
      42: aload_3
      43: ldc           #37                 // String RequireThumbprintReference
      45: invokespecial #34                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      48: invokestatic  #35                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      51: pop
      52: aload_1
      53: invokevirtual #38                 // Method org/apache/wss4j/policy/model/X509Token.isRequireEmbeddedTokenReference:()Z
      56: ifeq          74
      59: aload_2
      60: new           #32                 // class javax/xml/namespace/QName
      63: dup
      64: aload_3
      65: ldc           #39                 // String RequireEmbeddedTokenReference
      67: invokespecial #34                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      70: invokestatic  #35                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      73: pop
      74: aload_1
      75: invokevirtual #40                 // Method org/apache/wss4j/policy/model/X509Token.isRequireKeyIdentifierReference:()Z
      78: ifeq          96
      81: aload_2
      82: new           #32                 // class javax/xml/namespace/QName
      85: dup
      86: aload_3
      87: ldc           #41                 // String RequireKeyIdentifierReference
      89: invokespecial #34                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      92: invokestatic  #35                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      95: pop
      96: aload_1
      97: invokevirtual #26                 // Method org/apache/wss4j/policy/model/X509Token.getTokenType:()Lorg/apache/wss4j/policy/model/X509Token$TokenType;
     100: astore        4
     102: aload         4
     104: ifnull        125
     107: aload_2
     108: new           #32                 // class javax/xml/namespace/QName
     111: dup
     112: aload_3
     113: aload         4
     115: invokevirtual #42                 // Method org/apache/wss4j/policy/model/X509Token$TokenType.name:()Ljava/lang/String;
     118: invokespecial #34                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     121: invokestatic  #35                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
     124: pop
     125: return

  private boolean checkTokenType(org.apache.wss4j.policy.model.X509Token$TokenType, java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult>, java.util.List<org.apache.wss4j.dom.engine.WSSecurityEngineResult>);
    Code:
       0: aload_2
       1: ifnull        13
       4: aload_2
       5: invokeinterface #22,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      10: ifeq          24
      13: aload_3
      14: invokeinterface #22,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      19: ifeq          24
      22: iconst_0
      23: ireturn
      24: ldc           #43                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3
      26: astore        4
      28: iconst_0
      29: istore        5
      31: aload_1
      32: getstatic     #44                 // Field org/apache/wss4j/policy/model/X509Token$TokenType.WssX509PkiPathV1Token10:Lorg/apache/wss4j/policy/model/X509Token$TokenType;
      35: if_acmpeq     45
      38: aload_1
      39: getstatic     #45                 // Field org/apache/wss4j/policy/model/X509Token$TokenType.WssX509PkiPathV1Token11:Lorg/apache/wss4j/policy/model/X509Token$TokenType;
      42: if_acmpne     52
      45: ldc           #46                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509PKIPathv1
      47: astore        4
      49: goto          69
      52: aload_1
      53: getstatic     #47                 // Field org/apache/wss4j/policy/model/X509Token$TokenType.WssX509V3Token10:Lorg/apache/wss4j/policy/model/X509Token$TokenType;
      56: if_acmpeq     66
      59: aload_1
      60: getstatic     #48                 // Field org/apache/wss4j/policy/model/X509Token$TokenType.WssX509V3Token11:Lorg/apache/wss4j/policy/model/X509Token$TokenType;
      63: if_acmpne     69
      66: iconst_1
      67: istore        5
      69: aload_2
      70: ifnull        200
      73: aload_2
      74: invokeinterface #49,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      79: astore        6
      81: aload         6
      83: invokeinterface #13,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      88: ifeq          200
      91: aload         6
      93: invokeinterface #14,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      98: checkcast     #50                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     101: astore        7
     103: aload         7
     105: ldc           #51                 // String binary-security-token
     107: invokevirtual #52                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     110: checkcast     #53                 // class org/apache/wss4j/common/token/BinarySecurity
     113: astore        8
     115: aload         8
     117: ifnull        197
     120: aload         4
     122: aload         8
     124: invokevirtual #54                 // Method org/apache/wss4j/common/token/BinarySecurity.getValueType:()Ljava/lang/String;
     127: invokevirtual #55                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     130: ifeq          197
     133: iload         5
     135: ifeq          195
     138: aload         8
     140: instanceof    #56                 // class org/apache/wss4j/common/token/X509Security
     143: ifeq          195
     146: aload         8
     148: checkcast     #56                 // class org/apache/wss4j/common/token/X509Security
     151: aconst_null
     152: invokevirtual #57                 // Method org/apache/wss4j/common/token/X509Security.getX509Certificate:(Lorg/apache/wss4j/common/crypto/Crypto;)Ljava/security/cert/X509Certificate;
     155: astore        9
     157: aload         9
     159: ifnull        173
     162: aload         9
     164: invokevirtual #58                 // Method java/security/cert/X509Certificate.getVersion:()I
     167: iconst_3
     168: if_icmpne     173
     171: iconst_1
     172: ireturn
     173: goto          197
     176: astore        9
     178: getstatic     #60                 // Field LOG:Ljava/util/logging/Logger;
     181: getstatic     #61                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     184: aload         9
     186: invokevirtual #62                 // Method org/apache/wss4j/common/ext/WSSecurityException.getMessage:()Ljava/lang/String;
     189: invokevirtual #63                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;)V
     192: goto          197
     195: iconst_1
     196: ireturn
     197: goto          81
     200: ldc           #43                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3
     202: aload         4
     204: invokevirtual #55                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     207: ifeq          368
     210: aload_3
     211: invokeinterface #49,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     216: astore        6
     218: aload         6
     220: invokeinterface #13,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     225: ifeq          368
     228: aload         6
     230: invokeinterface #14,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     235: checkcast     #50                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     238: astore        7
     240: aload         7
     242: ldc           #64                 // String x509-reference-type
     244: invokevirtual #52                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     247: checkcast     #65                 // class org/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE
     250: astore        8
     252: getstatic     #66                 // Field org/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE.KEY_IDENTIFIER:Lorg/apache/wss4j/dom/str/STRParser$REFERENCE_TYPE;
     255: aload         8
     257: if_acmpne     365
     260: aload         7
     262: ldc           #67                 // String token-element
     264: invokevirtual #52                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     267: checkcast     #68                 // class org/w3c/dom/Element
     270: astore        9
     272: aload_0
     273: aload         9
     275: invokespecial #69                 // Method getKeyIdentifier:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     278: astore        10
     280: aload         10
     282: ifnull        365
     285: ldc           #43                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3
     287: aload         10
     289: aconst_null
     290: ldc           #70                 // String ValueType
     292: invokeinterface #71,  3           // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     297: invokevirtual #55                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     300: ifeq          365
     303: new           #56                 // class org/apache/wss4j/common/token/X509Security
     306: dup
     307: aload         10
     309: new           #72                 // class org/apache/wss4j/common/bsp/BSPEnforcer
     312: dup
     313: iconst_1
     314: invokespecial #73                 // Method org/apache/wss4j/common/bsp/BSPEnforcer."<init>":(Z)V
     317: invokespecial #74                 // Method org/apache/wss4j/common/token/X509Security."<init>":(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     320: astore        11
     322: aload         11
     324: aconst_null
     325: invokevirtual #57                 // Method org/apache/wss4j/common/token/X509Security.getX509Certificate:(Lorg/apache/wss4j/common/crypto/Crypto;)Ljava/security/cert/X509Certificate;
     328: astore        12
     330: aload         12
     332: ifnull        346
     335: aload         12
     337: invokevirtual #58                 // Method java/security/cert/X509Certificate.getVersion:()I
     340: iconst_3
     341: if_icmpne     346
     344: iconst_1
     345: ireturn
     346: goto          365
     349: astore        11
     351: getstatic     #60                 // Field LOG:Ljava/util/logging/Logger;
     354: getstatic     #61                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     357: aload         11
     359: invokevirtual #62                 // Method org/apache/wss4j/common/ext/WSSecurityException.getMessage:()Ljava/lang/String;
     362: invokevirtual #63                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;)V
     365: goto          218
     368: iconst_0
     369: ireturn
    Exception table:
       from    to  target type
         146   172   176   Class org/apache/wss4j/common/ext/WSSecurityException
         303   345   349   Class org/apache/wss4j/common/ext/WSSecurityException

  private org.w3c.dom.Element getKeyIdentifier(org.w3c.dom.Element);
    Code:
       0: aload_1
       1: ifnull        43
       4: aload_1
       5: ldc           #75                 // String KeyInfo
       7: ldc           #76                 // String http://www.w3.org/2000/09/xmldsig#
       9: invokestatic  #77                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      12: astore_2
      13: aload_2
      14: ifnull        43
      17: aload_2
      18: ldc           #78                 // String SecurityTokenReference
      20: ldc           #79                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
      22: invokestatic  #77                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      25: astore_3
      26: aload_3
      27: ifnull        43
      30: aload_3
      31: ldc           #80                 // String KeyIdentifier
      33: ldc           #79                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
      35: invokestatic  #77                 // Method org/apache/wss4j/common/util/XMLUtils.getDirectChildElement:(Lorg/w3c/dom/Node;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
      38: astore        4
      40: aload         4
      42: areturn
      43: aconst_null
      44: areturn

  static {};
    Code:
       0: ldc_w         #81                 // class org/apache/cxf/ws/security/wss4j/policyvalidators/X509TokenPolicyValidator
       3: invokestatic  #82                 // Method org/apache/cxf/common/logging/LogUtils.getL7dLogger:(Ljava/lang/Class;)Ljava/util/logging/Logger;
       6: putstatic     #60                 // Field LOG:Ljava/util/logging/Logger;
       9: return
}
