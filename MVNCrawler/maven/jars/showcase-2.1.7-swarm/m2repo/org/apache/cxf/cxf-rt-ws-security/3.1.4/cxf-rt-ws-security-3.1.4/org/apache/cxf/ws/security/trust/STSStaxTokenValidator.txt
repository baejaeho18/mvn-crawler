Compiled from "STSStaxTokenValidator.java"
public class org.apache.cxf.ws.security.trust.STSStaxTokenValidator extends org.apache.wss4j.stax.validate.SamlTokenValidatorImpl implements org.apache.wss4j.stax.validate.BinarySecurityTokenValidator,org.apache.wss4j.stax.validate.UsernameTokenValidator {
  private boolean alwaysValidateToSts;

  public org.apache.cxf.ws.security.trust.STSStaxTokenValidator();
    Code:
       0: aload_0
       1: invokespecial #2                  // Method org/apache/wss4j/stax/validate/SamlTokenValidatorImpl."<init>":()V
       4: return

  public org.apache.cxf.ws.security.trust.STSStaxTokenValidator(boolean);
    Code:
       0: aload_0
       1: invokespecial #2                  // Method org/apache/wss4j/stax/validate/SamlTokenValidatorImpl."<init>":()V
       4: aload_0
       5: iload_1
       6: putfield      #3                  // Field alwaysValidateToSts:Z
       9: return

  public <T extends org.apache.wss4j.stax.securityToken.SamlSecurityToken & org.apache.xml.security.stax.securityToken.InboundSecurityToken> T validate(org.apache.wss4j.common.saml.SamlAssertionWrapper, org.apache.xml.security.stax.securityToken.InboundSecurityToken, org.apache.wss4j.stax.validate.TokenContext) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #4                  // Method checkConditions:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)V
       5: aload_0
       6: aload_1
       7: aload_3
       8: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      11: invokevirtual #6                  // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSamlOneTimeUseReplayCache:()Lorg/apache/wss4j/common/cache/ReplayCache;
      14: invokevirtual #7                  // Method checkOneTimeUse:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/wss4j/common/cache/ReplayCache;)V
      17: aload_0
      18: aload_1
      19: invokevirtual #8                  // Method validateAssertion:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)V
      22: aconst_null
      23: astore        4
      25: aload_1
      26: invokevirtual #9                  // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.isSigned:()Z
      29: ifeq          41
      32: aload_3
      33: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      36: invokevirtual #10                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getSignatureVerificationCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
      39: astore        4
      41: aload_3
      42: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      45: invokevirtual #11                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getMsgContext:()Ljava/lang/Object;
      48: checkcast     #12                 // class org/apache/cxf/binding/soap/SoapMessage
      51: astore        5
      53: iconst_0
      54: istore        6
      56: aload_0
      57: getfield      #3                  // Field alwaysValidateToSts:Z
      60: ifeq          79
      63: aload_1
      64: invokevirtual #13                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getElement:()Lorg/w3c/dom/Element;
      67: astore        7
      69: aload         7
      71: aload         5
      73: invokestatic  #1                  // Method validateTokenToSTS:(Lorg/w3c/dom/Element;Lorg/apache/cxf/binding/soap/SoapMessage;)V
      76: iconst_1
      77: istore        6
      79: iload         6
      81: istore        7
      83: new           #14                 // class org/apache/cxf/ws/security/trust/STSStaxTokenValidator$1
      86: dup
      87: aload_0
      88: aload_1
      89: aload_2
      90: aload_3
      91: invokevirtual #15                 // Method org/apache/wss4j/stax/validate/TokenContext.getWsSecurityContext:()Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;
      94: aload         4
      96: getstatic     #16                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_NoKeyInfo:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
      99: aload_3
     100: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     103: iload         7
     105: aload         5
     107: invokespecial #17                 // Method org/apache/cxf/ws/security/trust/STSStaxTokenValidator$1."<init>":(Lorg/apache/cxf/ws/security/trust/STSStaxTokenValidator;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;ZLorg/apache/cxf/binding/soap/SoapMessage;)V
     110: astore        8
     112: aload         8
     114: aload_3
     115: invokevirtual #18                 // Method org/apache/wss4j/stax/validate/TokenContext.getElementPath:()Ljava/util/List;
     118: invokevirtual #19                 // Method org/apache/wss4j/stax/impl/securityToken/SamlSecurityTokenImpl.setElementPath:(Ljava/util/List;)V
     121: aload         8
     123: aload_3
     124: invokevirtual #20                 // Method org/apache/wss4j/stax/validate/TokenContext.getFirstXMLSecEvent:()Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;
     127: invokevirtual #21                 // Method org/apache/wss4j/stax/impl/securityToken/SamlSecurityTokenImpl.setXMLSecEvent:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;)V
     130: aload         8
     132: areturn

  public org.apache.xml.security.stax.securityToken.InboundSecurityToken validate(org.apache.wss4j.binding.wss10.BinarySecurityTokenType, org.apache.wss4j.stax.validate.TokenContext) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #22                 // class org/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator
       3: dup
       4: aload_0
       5: getfield      #3                  // Field alwaysValidateToSts:Z
       8: invokespecial #23                 // Method org/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator."<init>":(Z)V
      11: astore_3
      12: aload_3
      13: aload_1
      14: aload_2
      15: invokevirtual #24                 // Method org/apache/cxf/ws/security/trust/STSStaxTokenValidator$STSStaxBSTValidator.validate:(Lorg/apache/wss4j/binding/wss10/BinarySecurityTokenType;Lorg/apache/wss4j/stax/validate/TokenContext;)Lorg/apache/xml/security/stax/securityToken/InboundSecurityToken;
      18: areturn

  public <T extends org.apache.wss4j.stax.securityToken.UsernameSecurityToken & org.apache.xml.security.stax.securityToken.InboundSecurityToken> T validate(org.apache.wss4j.binding.wss10.UsernameTokenType, org.apache.wss4j.stax.validate.TokenContext) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: invokevirtual #25                 // Method org/apache/wss4j/binding/wss10/UsernameTokenType.getAny:()Ljava/util/List;
       4: getstatic     #26                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse11_Salt:Ljavax/xml/namespace/QName;
       7: invokestatic  #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      10: checkcast     #28                 // class "[B"
      13: astore_3
      14: aload_1
      15: invokevirtual #25                 // Method org/apache/wss4j/binding/wss10/UsernameTokenType.getAny:()Ljava/util/List;
      18: getstatic     #29                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_Password:Ljavax/xml/namespace/QName;
      21: invokestatic  #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      24: checkcast     #30                 // class org/apache/wss4j/binding/wss10/PasswordString
      27: astore        4
      29: aload_1
      30: invokevirtual #25                 // Method org/apache/wss4j/binding/wss10/UsernameTokenType.getAny:()Ljava/util/List;
      33: getstatic     #31                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse11_Iteration:Ljavax/xml/namespace/QName;
      36: invokestatic  #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
      39: checkcast     #32                 // class java/lang/Long
      42: astore        5
      44: aload_3
      45: ifnull        71
      48: aload         4
      50: ifnonnull     58
      53: aload         5
      55: ifnonnull     71
      58: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
      61: dup
      62: getstatic     #34                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      65: ldc           #35                 // String badTokenType01
      67: invokespecial #36                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      70: athrow
      71: aload_2
      72: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      75: invokevirtual #37                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getHandleCustomPasswordTypes:()Z
      78: istore        6
      80: aload_2
      81: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      84: invokevirtual #38                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.isAllowUsernameTokenNoPassword:()Z
      87: ifne          110
      90: aload_2
      91: invokevirtual #15                 // Method org/apache/wss4j/stax/validate/TokenContext.getWsSecurityContext:()Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;
      94: ldc           #39                 // String secureProcessing.AllowUsernameTokenNoPassword
      96: invokeinterface #40,  2           // InterfaceMethod org/apache/wss4j/stax/ext/WSInboundSecurityContext.get:(Ljava/lang/String;)Ljava/lang/Object;
     101: checkcast     #41                 // class java/lang/String
     104: invokestatic  #42                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
     107: ifeq          114
     110: iconst_1
     111: goto          115
     114: iconst_0
     115: istore        7
     117: aload_2
     118: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     121: invokevirtual #43                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getUsernameTokenPasswordType:()Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;
     124: astore        8
     126: aload         8
     128: ifnull        183
     131: aload         4
     133: ifnull        144
     136: aload         4
     138: invokevirtual #44                 // Method org/apache/wss4j/binding/wss10/PasswordString.getType:()Ljava/lang/String;
     141: ifnonnull     155
     144: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
     147: dup
     148: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     151: invokespecial #46                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     154: athrow
     155: aload         4
     157: invokevirtual #44                 // Method org/apache/wss4j/binding/wss10/PasswordString.getType:()Ljava/lang/String;
     160: invokestatic  #47                 // Method org/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType.getUsernameTokenPasswordType:(Ljava/lang/String;)Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;
     163: astore        9
     165: aload         8
     167: aload         9
     169: if_acmpeq     183
     172: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
     175: dup
     176: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     179: invokespecial #46                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     182: athrow
     183: getstatic     #48                 // Field org/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType.PASSWORD_NONE:Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;
     186: astore        9
     188: aload         4
     190: ifnull        211
     193: aload         4
     195: invokevirtual #44                 // Method org/apache/wss4j/binding/wss10/PasswordString.getType:()Ljava/lang/String;
     198: ifnull        211
     201: aload         4
     203: invokevirtual #44                 // Method org/apache/wss4j/binding/wss10/PasswordString.getType:()Ljava/lang/String;
     206: invokestatic  #47                 // Method org/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType.getUsernameTokenPasswordType:(Ljava/lang/String;)Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;
     209: astore        9
     211: aload_1
     212: invokevirtual #49                 // Method org/apache/wss4j/binding/wss10/UsernameTokenType.getUsername:()Lorg/apache/wss4j/binding/wss10/AttributedString;
     215: astore        10
     217: aload         10
     219: ifnonnull     235
     222: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
     225: dup
     226: getstatic     #34                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     229: ldc           #35                 // String badTokenType01
     231: invokespecial #36                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     234: athrow
     235: aload_1
     236: invokevirtual #25                 // Method org/apache/wss4j/binding/wss10/UsernameTokenType.getAny:()Ljava/util/List;
     239: getstatic     #50                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsse_Nonce:Ljavax/xml/namespace/QName;
     242: invokestatic  #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
     245: checkcast     #51                 // class org/apache/wss4j/binding/wss10/EncodedString
     248: astore        11
     250: aconst_null
     251: astore        12
     253: aload         11
     255: ifnull        276
     258: aload         11
     260: invokevirtual #52                 // Method org/apache/wss4j/binding/wss10/EncodedString.getValue:()Ljava/lang/String;
     263: ifnull        276
     266: aload         11
     268: invokevirtual #52                 // Method org/apache/wss4j/binding/wss10/EncodedString.getValue:()Ljava/lang/String;
     271: invokestatic  #53                 // Method org/apache/commons/codec/binary/Base64.decodeBase64:(Ljava/lang/String;)[B
     274: astore        12
     276: aload_1
     277: invokevirtual #25                 // Method org/apache/wss4j/binding/wss10/UsernameTokenType.getAny:()Ljava/util/List;
     280: getstatic     #54                 // Field org/apache/wss4j/stax/ext/WSSConstants.TAG_wsu_Created:Ljavax/xml/namespace/QName;
     283: invokestatic  #27                 // Method org/apache/xml/security/stax/ext/XMLSecurityUtils.getQNameType:(Ljava/util/List;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
     286: checkcast     #55                 // class org/apache/wss4j/binding/wsu10/AttributedDateTime
     289: astore        13
     291: aconst_null
     292: astore        14
     294: aload         13
     296: ifnull        306
     299: aload         13
     301: invokevirtual #56                 // Method org/apache/wss4j/binding/wsu10/AttributedDateTime.getValue:()Ljava/lang/String;
     304: astore        14
     306: iconst_0
     307: istore        15
     309: aload_2
     310: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     313: invokevirtual #11                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getMsgContext:()Ljava/lang/Object;
     316: checkcast     #12                 // class org/apache/cxf/binding/soap/SoapMessage
     319: astore        16
     321: aload_0
     322: getfield      #3                  // Field alwaysValidateToSts:Z
     325: ifeq          363
     328: aload_0
     329: aload         10
     331: invokevirtual #57                 // Method org/apache/wss4j/binding/wss10/AttributedString.getValue:()Ljava/lang/String;
     334: aload         4
     336: invokevirtual #58                 // Method org/apache/wss4j/binding/wss10/PasswordString.getValue:()Ljava/lang/String;
     339: aload         4
     341: invokevirtual #44                 // Method org/apache/wss4j/binding/wss10/PasswordString.getType:()Ljava/lang/String;
     344: aload_1
     345: invokevirtual #59                 // Method org/apache/wss4j/binding/wss10/UsernameTokenType.getId:()Ljava/lang/String;
     348: invokespecial #60                 // Method convertToDOM:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     351: astore        17
     353: aload         17
     355: aload         16
     357: invokestatic  #1                  // Method validateTokenToSTS:(Lorg/w3c/dom/Element;Lorg/apache/cxf/binding/soap/SoapMessage;)V
     360: iconst_1
     361: istore        15
     363: iload         15
     365: ifne          585
     368: aload         9
     370: getstatic     #61                 // Field org/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType.PASSWORD_DIGEST:Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;
     373: if_acmpne     444
     376: aload         11
     378: ifnull        386
     381: aload         13
     383: ifnonnull     399
     386: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
     389: dup
     390: getstatic     #34                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.INVALID_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     393: ldc           #35                 // String badTokenType01
     395: invokespecial #36                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     398: athrow
     399: ldc           #62                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary
     401: aload         11
     403: invokevirtual #63                 // Method org/apache/wss4j/binding/wss10/EncodedString.getEncodingType:()Ljava/lang/String;
     406: invokevirtual #64                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     409: ifne          425
     412: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
     415: dup
     416: getstatic     #65                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.UNSUPPORTED_SECURITY_TOKEN:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     419: ldc           #35                 // String badTokenType01
     421: invokespecial #36                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
     424: athrow
     425: aload_0
     426: aload         10
     428: invokevirtual #57                 // Method org/apache/wss4j/binding/wss10/AttributedString.getValue:()Ljava/lang/String;
     431: aload         4
     433: aload         12
     435: aload         14
     437: aload_2
     438: invokespecial #66                 // Method verifyDigestPassword:(Ljava/lang/String;Lorg/apache/wss4j/binding/wss10/PasswordString;[BLjava/lang/String;Lorg/apache/wss4j/stax/validate/TokenContext;)V
     441: goto          548
     444: aload         9
     446: getstatic     #67                 // Field org/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType.PASSWORD_TEXT:Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;
     449: if_acmpeq     473
     452: aload         4
     454: ifnull        488
     457: aload         4
     459: invokevirtual #58                 // Method org/apache/wss4j/binding/wss10/PasswordString.getValue:()Ljava/lang/String;
     462: ifnull        488
     465: aload         9
     467: getstatic     #48                 // Field org/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType.PASSWORD_NONE:Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;
     470: if_acmpne     488
     473: aload_0
     474: aload         10
     476: invokevirtual #57                 // Method org/apache/wss4j/binding/wss10/AttributedString.getValue:()Ljava/lang/String;
     479: aload         4
     481: aload_2
     482: invokespecial #68                 // Method verifyPlaintextPassword:(Ljava/lang/String;Lorg/apache/wss4j/binding/wss10/PasswordString;Lorg/apache/wss4j/stax/validate/TokenContext;)V
     485: goto          548
     488: aload         4
     490: ifnull        532
     493: aload         4
     495: invokevirtual #58                 // Method org/apache/wss4j/binding/wss10/PasswordString.getValue:()Ljava/lang/String;
     498: ifnull        532
     501: iload         6
     503: ifne          517
     506: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
     509: dup
     510: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     513: invokespecial #46                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     516: athrow
     517: aload_0
     518: aload         10
     520: invokevirtual #57                 // Method org/apache/wss4j/binding/wss10/AttributedString.getValue:()Ljava/lang/String;
     523: aload         4
     525: aload_2
     526: invokespecial #68                 // Method verifyPlaintextPassword:(Ljava/lang/String;Lorg/apache/wss4j/binding/wss10/PasswordString;Lorg/apache/wss4j/stax/validate/TokenContext;)V
     529: goto          548
     532: iload         7
     534: ifne          548
     537: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
     540: dup
     541: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     544: invokespecial #46                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     547: athrow
     548: goto          585
     551: astore        17
     553: aload_0
     554: aload         10
     556: invokevirtual #57                 // Method org/apache/wss4j/binding/wss10/AttributedString.getValue:()Ljava/lang/String;
     559: aload         4
     561: invokevirtual #58                 // Method org/apache/wss4j/binding/wss10/PasswordString.getValue:()Ljava/lang/String;
     564: aload         4
     566: invokevirtual #44                 // Method org/apache/wss4j/binding/wss10/PasswordString.getType:()Ljava/lang/String;
     569: aload_1
     570: invokevirtual #59                 // Method org/apache/wss4j/binding/wss10/UsernameTokenType.getId:()Ljava/lang/String;
     573: invokespecial #60                 // Method convertToDOM:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     576: astore        18
     578: aload         18
     580: aload         16
     582: invokestatic  #1                  // Method validateTokenToSTS:(Lorg/w3c/dom/Element;Lorg/apache/cxf/binding/soap/SoapMessage;)V
     585: aload         4
     587: ifnull        600
     590: aload         4
     592: invokevirtual #58                 // Method org/apache/wss4j/binding/wss10/PasswordString.getValue:()Ljava/lang/String;
     595: astore        17
     597: goto          662
     600: aload_3
     601: ifnull        659
     604: new           #69                 // class org/apache/wss4j/common/ext/WSPasswordCallback
     607: dup
     608: aload         10
     610: invokevirtual #57                 // Method org/apache/wss4j/binding/wss10/AttributedString.getValue:()Ljava/lang/String;
     613: iconst_2
     614: invokespecial #70                 // Method org/apache/wss4j/common/ext/WSPasswordCallback."<init>":(Ljava/lang/String;I)V
     617: astore        18
     619: aload_2
     620: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
     623: invokevirtual #71                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
     626: aload         18
     628: invokestatic  #72                 // Method org/apache/wss4j/stax/utils/WSSUtils.doPasswordCallback:(Ljavax/security/auth/callback/CallbackHandler;Ljavax/security/auth/callback/Callback;)V
     631: goto          649
     634: astore        19
     636: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
     639: dup
     640: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     643: aload         19
     645: invokespecial #73                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     648: athrow
     649: aload         18
     651: invokevirtual #74                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
     654: astore        17
     656: goto          662
     659: aconst_null
     660: astore        17
     662: new           #75                 // class org/apache/wss4j/stax/impl/securityToken/UsernameSecurityTokenImpl
     665: dup
     666: aload         9
     668: aload         10
     670: invokevirtual #57                 // Method org/apache/wss4j/binding/wss10/AttributedString.getValue:()Ljava/lang/String;
     673: aload         17
     675: aload         14
     677: aload         12
     679: aload_3
     680: aload         5
     682: aload_2
     683: invokevirtual #15                 // Method org/apache/wss4j/stax/validate/TokenContext.getWsSecurityContext:()Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;
     686: aload_1
     687: invokevirtual #59                 // Method org/apache/wss4j/binding/wss10/UsernameTokenType.getId:()Ljava/lang/String;
     690: getstatic     #76                 // Field org/apache/wss4j/stax/securityToken/WSSecurityTokenConstants.KeyIdentifier_SecurityTokenDirectReference:Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;
     693: invokespecial #77                 // Method org/apache/wss4j/stax/impl/securityToken/UsernameSecurityTokenImpl."<init>":(Lorg/apache/wss4j/stax/ext/WSSConstants$UsernameTokenPasswordType;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;[B[BLjava/lang/Long;Lorg/apache/wss4j/stax/ext/WSInboundSecurityContext;Ljava/lang/String;Lorg/apache/xml/security/stax/securityToken/SecurityTokenConstants$KeyIdentifier;)V
     696: astore        18
     698: aload         18
     700: aload_2
     701: invokevirtual #18                 // Method org/apache/wss4j/stax/validate/TokenContext.getElementPath:()Ljava/util/List;
     704: invokevirtual #78                 // Method org/apache/wss4j/stax/impl/securityToken/UsernameSecurityTokenImpl.setElementPath:(Ljava/util/List;)V
     707: aload         18
     709: aload_2
     710: invokevirtual #20                 // Method org/apache/wss4j/stax/validate/TokenContext.getFirstXMLSecEvent:()Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;
     713: invokevirtual #79                 // Method org/apache/wss4j/stax/impl/securityToken/UsernameSecurityTokenImpl.setXMLSecEvent:(Lorg/apache/xml/security/stax/ext/stax/XMLSecEvent;)V
     716: aload         18
     718: areturn
    Exception table:
       from    to  target type
         368   548   551   Class org/apache/wss4j/common/ext/WSSecurityException
         619   631   634   Class org/apache/wss4j/common/ext/WSSecurityException

  private void verifyDigestPassword(java.lang.String, org.apache.wss4j.binding.wss10.PasswordString, byte[], java.lang.String, org.apache.wss4j.stax.validate.TokenContext) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #69                 // class org/apache/wss4j/common/ext/WSPasswordCallback
       3: dup
       4: aload_1
       5: aconst_null
       6: aload_2
       7: invokevirtual #44                 // Method org/apache/wss4j/binding/wss10/PasswordString.getType:()Ljava/lang/String;
      10: iconst_2
      11: invokespecial #80                 // Method org/apache/wss4j/common/ext/WSPasswordCallback."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;I)V
      14: astore        6
      16: aload         5
      18: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      21: invokevirtual #71                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      24: aload         6
      26: invokestatic  #72                 // Method org/apache/wss4j/stax/utils/WSSUtils.doPasswordCallback:(Ljavax/security/auth/callback/CallbackHandler;Ljavax/security/auth/callback/Callback;)V
      29: goto          47
      32: astore        7
      34: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
      37: dup
      38: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      41: aload         7
      43: invokespecial #73                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      46: athrow
      47: aload         6
      49: invokevirtual #74                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
      52: ifnonnull     66
      55: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
      58: dup
      59: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      62: invokespecial #46                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      65: athrow
      66: aload_3
      67: aload         4
      69: aload         6
      71: invokevirtual #74                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
      74: invokestatic  #81                 // Method org/apache/wss4j/stax/utils/WSSUtils.doPasswordDigest:([BLjava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      77: astore        7
      79: aload_2
      80: invokevirtual #58                 // Method org/apache/wss4j/binding/wss10/PasswordString.getValue:()Ljava/lang/String;
      83: aload         7
      85: invokevirtual #64                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      88: ifne          102
      91: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
      94: dup
      95: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      98: invokespecial #46                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
     101: athrow
     102: aload_2
     103: aload         6
     105: invokevirtual #74                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
     108: invokevirtual #82                 // Method org/apache/wss4j/binding/wss10/PasswordString.setValue:(Ljava/lang/String;)V
     111: return
    Exception table:
       from    to  target type
          16    29    32   Class org/apache/wss4j/common/ext/WSSecurityException

  private void verifyPlaintextPassword(java.lang.String, org.apache.wss4j.binding.wss10.PasswordString, org.apache.wss4j.stax.validate.TokenContext) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #69                 // class org/apache/wss4j/common/ext/WSPasswordCallback
       3: dup
       4: aload_1
       5: aconst_null
       6: aload_2
       7: invokevirtual #44                 // Method org/apache/wss4j/binding/wss10/PasswordString.getType:()Ljava/lang/String;
      10: iconst_2
      11: invokespecial #80                 // Method org/apache/wss4j/common/ext/WSPasswordCallback."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;I)V
      14: astore        4
      16: aload_3
      17: invokevirtual #5                  // Method org/apache/wss4j/stax/validate/TokenContext.getWssSecurityProperties:()Lorg/apache/wss4j/stax/ext/WSSSecurityProperties;
      20: invokevirtual #71                 // Method org/apache/wss4j/stax/ext/WSSSecurityProperties.getCallbackHandler:()Ljavax/security/auth/callback/CallbackHandler;
      23: aload         4
      25: invokestatic  #72                 // Method org/apache/wss4j/stax/utils/WSSUtils.doPasswordCallback:(Ljavax/security/auth/callback/CallbackHandler;Ljavax/security/auth/callback/Callback;)V
      28: goto          46
      31: astore        5
      33: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
      36: dup
      37: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      40: aload         5
      42: invokespecial #73                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      45: athrow
      46: aload         4
      48: invokevirtual #74                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
      51: ifnonnull     65
      54: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
      57: dup
      58: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      61: invokespecial #46                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      64: athrow
      65: aload_2
      66: invokevirtual #58                 // Method org/apache/wss4j/binding/wss10/PasswordString.getValue:()Ljava/lang/String;
      69: aload         4
      71: invokevirtual #74                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
      74: invokevirtual #64                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      77: ifne          91
      80: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
      83: dup
      84: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      87: invokespecial #46                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;)V
      90: athrow
      91: aload_2
      92: aload         4
      94: invokevirtual #74                 // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
      97: invokevirtual #82                 // Method org/apache/wss4j/binding/wss10/PasswordString.setValue:(Ljava/lang/String;)V
     100: return
    Exception table:
       from    to  target type
          16    28    31   Class org/apache/wss4j/common/ext/WSSecurityException

  private org.w3c.dom.Element convertToDOM(java.lang.String, java.lang.String, java.lang.String, java.lang.String);
    Code:
       0: invokestatic  #83                 // Method org/apache/cxf/helpers/DOMUtils.newDocument:()Lorg/w3c/dom/Document;
       3: astore        5
       5: new           #84                 // class org/apache/wss4j/dom/message/token/UsernameToken
       8: dup
       9: iconst_1
      10: aload         5
      12: aload_3
      13: invokespecial #85                 // Method org/apache/wss4j/dom/message/token/UsernameToken."<init>":(ZLorg/w3c/dom/Document;Ljava/lang/String;)V
      16: astore        6
      18: aload         6
      20: aload_1
      21: invokevirtual #86                 // Method org/apache/wss4j/dom/message/token/UsernameToken.setName:(Ljava/lang/String;)V
      24: aload         6
      26: aload_2
      27: invokevirtual #87                 // Method org/apache/wss4j/dom/message/token/UsernameToken.setPassword:(Ljava/lang/String;)V
      30: aload         6
      32: aload         4
      34: invokevirtual #88                 // Method org/apache/wss4j/dom/message/token/UsernameToken.setID:(Ljava/lang/String;)V
      37: aload         6
      39: invokevirtual #89                 // Method org/apache/wss4j/dom/message/token/UsernameToken.addWSSENamespace:()V
      42: aload         6
      44: invokevirtual #90                 // Method org/apache/wss4j/dom/message/token/UsernameToken.addWSUNamespace:()V
      47: aload         6
      49: invokevirtual #91                 // Method org/apache/wss4j/dom/message/token/UsernameToken.getElement:()Lorg/w3c/dom/Element;
      52: areturn

  private static void validateTokenToSTS(org.w3c.dom.Element, org.apache.cxf.binding.soap.SoapMessage) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #92                 // class org/apache/cxf/ws/security/tokenstore/SecurityToken
       3: dup
       4: invokespecial #93                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":()V
       7: astore_2
       8: aload_2
       9: aload_0
      10: invokevirtual #94                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setToken:(Lorg/w3c/dom/Element;)V
      13: aload_1
      14: ldc           #95                 // String sts
      16: invokestatic  #96                 // Method org/apache/cxf/ws/security/trust/STSUtils.getClient:(Lorg/apache/cxf/message/Message;Ljava/lang/String;)Lorg/apache/cxf/ws/security/trust/STSClient;
      19: astore_3
      20: aload_3
      21: dup
      22: astore        4
      24: monitorenter
      25: ldc           #97                 // String noprint
      27: ldc           #98                 // String true
      29: invokestatic  #99                 // Method java/lang/System.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      32: pop
      33: aload_3
      34: aload_2
      35: invokevirtual #100                // Method org/apache/cxf/ws/security/trust/STSClient.validateSecurityToken:(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)Ljava/util/List;
      38: pop
      39: goto          57
      42: astore        5
      44: new           #33                 // class org/apache/wss4j/common/ext/WSSecurityException
      47: dup
      48: getstatic     #45                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILED_AUTHENTICATION:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      51: aload         5
      53: invokespecial #73                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      56: athrow
      57: aload         4
      59: monitorexit
      60: goto          71
      63: astore        6
      65: aload         4
      67: monitorexit
      68: aload         6
      70: athrow
      71: return
    Exception table:
       from    to  target type
          33    39    42   Class java/lang/Exception
          25    60    63   any
          63    68    63   any

  static void access$000(org.w3c.dom.Element, org.apache.cxf.binding.soap.SoapMessage) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: invokestatic  #1                  // Method validateTokenToSTS:(Lorg/w3c/dom/Element;Lorg/apache/cxf/binding/soap/SoapMessage;)V
       5: return
}
