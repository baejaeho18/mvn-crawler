Compiled from "SAMLDelegationHandler.java"
public class org.apache.cxf.sts.token.delegation.SAMLDelegationHandler implements org.apache.cxf.sts.token.delegation.TokenDelegationHandler {
  private static final java.util.logging.Logger LOG;

  private boolean checkAudienceRestriction;

  public org.apache.cxf.sts.token.delegation.SAMLDelegationHandler();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public boolean canHandleToken(org.apache.cxf.sts.request.ReceivedToken);
    Code:
       0: aload_1
       1: invokevirtual #2                  // Method org/apache/cxf/sts/request/ReceivedToken.getToken:()Ljava/lang/Object;
       4: astore_2
       5: aload_2
       6: instanceof    #3                  // class org/w3c/dom/Element
       9: ifeq          65
      12: aload_2
      13: checkcast     #3                  // class org/w3c/dom/Element
      16: astore_3
      17: aload_3
      18: invokeinterface #4,  1            // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      23: astore        4
      25: aload_3
      26: invokeinterface #5,  1            // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      31: astore        5
      33: ldc           #6                  // String urn:oasis:names:tc:SAML:1.0:assertion
      35: aload         4
      37: invokevirtual #7                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      40: ifne          53
      43: ldc           #8                  // String urn:oasis:names:tc:SAML:2.0:assertion
      45: aload         4
      47: invokevirtual #7                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      50: ifeq          65
      53: ldc           #9                  // String Assertion
      55: aload         5
      57: invokevirtual #7                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      60: ifeq          65
      63: iconst_1
      64: ireturn
      65: iconst_0
      66: ireturn

  public org.apache.cxf.sts.token.delegation.TokenDelegationResponse isDelegationAllowed(org.apache.cxf.sts.token.delegation.TokenDelegationParameters);
    Code:
       0: new           #10                 // class org/apache/cxf/sts/token/delegation/TokenDelegationResponse
       3: dup
       4: invokespecial #11                 // Method org/apache/cxf/sts/token/delegation/TokenDelegationResponse."<init>":()V
       7: astore_2
       8: aload_1
       9: invokevirtual #12                 // Method org/apache/cxf/sts/token/delegation/TokenDelegationParameters.getToken:()Lorg/apache/cxf/sts/request/ReceivedToken;
      12: astore_3
      13: aload_2
      14: aload_3
      15: invokevirtual #13                 // Method org/apache/cxf/sts/token/delegation/TokenDelegationResponse.setToken:(Lorg/apache/cxf/sts/request/ReceivedToken;)V
      18: aload_3
      19: invokevirtual #14                 // Method org/apache/cxf/sts/request/ReceivedToken.getState:()Lorg/apache/cxf/sts/request/ReceivedToken$STATE;
      22: getstatic     #15                 // Field org/apache/cxf/sts/request/ReceivedToken$STATE.VALID:Lorg/apache/cxf/sts/request/ReceivedToken$STATE;
      25: if_acmpne     35
      28: aload_3
      29: invokevirtual #16                 // Method org/apache/cxf/sts/request/ReceivedToken.isDOMElement:()Z
      32: ifne          45
      35: getstatic     #17                 // Field LOG:Ljava/util/logging/Logger;
      38: ldc           #18                 // String Delegation token is not valid
      40: invokevirtual #19                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
      43: aload_2
      44: areturn
      45: aload_0
      46: aload_3
      47: aload_1
      48: invokevirtual #20                 // Method org/apache/cxf/sts/token/delegation/TokenDelegationParameters.getAppliesToAddress:()Ljava/lang/String;
      51: invokevirtual #21                 // Method isDelegationAllowed:(Lorg/apache/cxf/sts/request/ReceivedToken;Ljava/lang/String;)Z
      54: ifeq          105
      57: getstatic     #17                 // Field LOG:Ljava/util/logging/Logger;
      60: getstatic     #22                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
      63: invokevirtual #23                 // Method java/util/logging/Logger.isLoggable:(Ljava/util/logging/Level;)Z
      66: ifeq          97
      69: getstatic     #17                 // Field LOG:Ljava/util/logging/Logger;
      72: new           #24                 // class java/lang/StringBuilder
      75: dup
      76: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      79: ldc           #26                 // String Delegation is allowed for principal
      81: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      84: aload_1
      85: invokevirtual #28                 // Method org/apache/cxf/sts/token/delegation/TokenDelegationParameters.getPrincipal:()Ljava/security/Principal;
      88: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      91: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      94: invokevirtual #19                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
      97: aload_2
      98: iconst_1
      99: invokevirtual #31                 // Method org/apache/cxf/sts/token/delegation/TokenDelegationResponse.setDelegationAllowed:(Z)V
     102: goto          145
     105: getstatic     #17                 // Field LOG:Ljava/util/logging/Logger;
     108: getstatic     #22                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     111: invokevirtual #23                 // Method java/util/logging/Logger.isLoggable:(Ljava/util/logging/Level;)Z
     114: ifeq          145
     117: getstatic     #17                 // Field LOG:Ljava/util/logging/Logger;
     120: new           #24                 // class java/lang/StringBuilder
     123: dup
     124: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
     127: ldc           #32                 // String Delegation is not allowed for principal
     129: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     132: aload_1
     133: invokevirtual #28                 // Method org/apache/cxf/sts/token/delegation/TokenDelegationParameters.getPrincipal:()Ljava/security/Principal;
     136: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     139: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     142: invokevirtual #19                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
     145: aload_2
     146: areturn

  protected boolean isDelegationAllowed(org.apache.cxf.sts.request.ReceivedToken, java.lang.String);
    Code:
       0: aload_1
       1: invokevirtual #2                  // Method org/apache/cxf/sts/request/ReceivedToken.getToken:()Ljava/lang/Object;
       4: checkcast     #3                  // class org/w3c/dom/Element
       7: astore_3
       8: new           #33                 // class org/apache/wss4j/common/saml/SamlAssertionWrapper
      11: dup
      12: aload_3
      13: invokespecial #34                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper."<init>":(Lorg/w3c/dom/Element;)V
      16: astore        4
      18: aload         4
      20: invokevirtual #35                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getConfirmationMethods:()Ljava/util/List;
      23: invokeinterface #36,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      28: astore        5
      30: aload         5
      32: invokeinterface #37,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      37: ifeq          103
      40: aload         5
      42: invokeinterface #38,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      47: checkcast     #39                 // class java/lang/String
      50: astore        6
      52: ldc           #40                 // String urn:oasis:names:tc:SAML:1.0:cm:bearer
      54: aload         6
      56: invokevirtual #7                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      59: ifne          100
      62: ldc           #41                 // String urn:oasis:names:tc:SAML:2.0:cm:bearer
      64: aload         6
      66: invokevirtual #7                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      69: ifne          100
      72: getstatic     #17                 // Field LOG:Ljava/util/logging/Logger;
      75: new           #24                 // class java/lang/StringBuilder
      78: dup
      79: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      82: ldc           #42                 // String An unsupported Confirmation Method was used:
      84: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      87: aload         6
      89: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      92: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      95: invokevirtual #19                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
      98: iconst_0
      99: ireturn
     100: goto          30
     103: aload_0
     104: getfield      #43                 // Field checkAudienceRestriction:Z
     107: ifeq          180
     110: aload_2
     111: ifnull        180
     114: aload_0
     115: aload         4
     117: invokevirtual #44                 // Method getAudienceRestrictions:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)Ljava/util/List;
     120: astore        5
     122: aload         5
     124: invokeinterface #45,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     129: ifne          180
     132: aload         5
     134: aload_2
     135: invokeinterface #46,  2           // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
     140: ifne          180
     143: getstatic     #17                 // Field LOG:Ljava/util/logging/Logger;
     146: new           #24                 // class java/lang/StringBuilder
     149: dup
     150: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
     153: ldc           #47                 // String The AppliesTo address
     155: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     158: aload_2
     159: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     162: ldc           #48                 // String  is not contained
     164: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     167: ldc           #49                 // String  in the Audience Restriction addresses in the assertion
     169: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     172: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     175: invokevirtual #19                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
     178: iconst_0
     179: ireturn
     180: goto          200
     183: astore        4
     185: getstatic     #17                 // Field LOG:Ljava/util/logging/Logger;
     188: getstatic     #51                 // Field java/util/logging/Level.WARNING:Ljava/util/logging/Level;
     191: ldc           #52                 // String Error in ascertaining whether delegation is allowed
     193: aload         4
     195: invokevirtual #53                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     198: iconst_0
     199: ireturn
     200: iconst_1
     201: ireturn
    Exception table:
       from    to  target type
           8    99   183   Class org/apache/wss4j/common/ext/WSSecurityException
         100   179   183   Class org/apache/wss4j/common/ext/WSSecurityException

  protected java.util.List<java.lang.String> getAudienceRestrictions(org.apache.wss4j.common.saml.SamlAssertionWrapper);
    Code:
       0: new           #54                 // class java/util/ArrayList
       3: dup
       4: invokespecial #55                 // Method java/util/ArrayList."<init>":()V
       7: astore_2
       8: aload_1
       9: invokevirtual #56                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml1:()Lorg/opensaml/saml/saml1/core/Assertion;
      12: ifnull        114
      15: aload_1
      16: invokevirtual #56                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml1:()Lorg/opensaml/saml/saml1/core/Assertion;
      19: invokeinterface #57,  1           // InterfaceMethod org/opensaml/saml/saml1/core/Assertion.getConditions:()Lorg/opensaml/saml/saml1/core/Conditions;
      24: invokeinterface #58,  1           // InterfaceMethod org/opensaml/saml/saml1/core/Conditions.getAudienceRestrictionConditions:()Ljava/util/List;
      29: invokeinterface #36,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      34: astore_3
      35: aload_3
      36: invokeinterface #37,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      41: ifeq          111
      44: aload_3
      45: invokeinterface #38,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      50: checkcast     #59                 // class org/opensaml/saml/saml1/core/AudienceRestrictionCondition
      53: astore        4
      55: aload         4
      57: invokeinterface #60,  1           // InterfaceMethod org/opensaml/saml/saml1/core/AudienceRestrictionCondition.getAudiences:()Ljava/util/List;
      62: invokeinterface #36,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      67: astore        5
      69: aload         5
      71: invokeinterface #37,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      76: ifeq          108
      79: aload         5
      81: invokeinterface #38,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      86: checkcast     #61                 // class org/opensaml/saml/saml1/core/Audience
      89: astore        6
      91: aload_2
      92: aload         6
      94: invokeinterface #62,  1           // InterfaceMethod org/opensaml/saml/saml1/core/Audience.getUri:()Ljava/lang/String;
      99: invokeinterface #63,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     104: pop
     105: goto          69
     108: goto          35
     111: goto          217
     114: aload_1
     115: invokevirtual #64                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml2:()Lorg/opensaml/saml/saml2/core/Assertion;
     118: ifnull        217
     121: aload_1
     122: invokevirtual #64                 // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml2:()Lorg/opensaml/saml/saml2/core/Assertion;
     125: invokeinterface #65,  1           // InterfaceMethod org/opensaml/saml/saml2/core/Assertion.getConditions:()Lorg/opensaml/saml/saml2/core/Conditions;
     130: invokeinterface #66,  1           // InterfaceMethod org/opensaml/saml/saml2/core/Conditions.getAudienceRestrictions:()Ljava/util/List;
     135: invokeinterface #36,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     140: astore_3
     141: aload_3
     142: invokeinterface #37,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     147: ifeq          217
     150: aload_3
     151: invokeinterface #38,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     156: checkcast     #67                 // class org/opensaml/saml/saml2/core/AudienceRestriction
     159: astore        4
     161: aload         4
     163: invokeinterface #68,  1           // InterfaceMethod org/opensaml/saml/saml2/core/AudienceRestriction.getAudiences:()Ljava/util/List;
     168: invokeinterface #36,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     173: astore        5
     175: aload         5
     177: invokeinterface #37,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     182: ifeq          214
     185: aload         5
     187: invokeinterface #38,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     192: checkcast     #69                 // class org/opensaml/saml/saml2/core/Audience
     195: astore        6
     197: aload_2
     198: aload         6
     200: invokeinterface #70,  1           // InterfaceMethod org/opensaml/saml/saml2/core/Audience.getAudienceURI:()Ljava/lang/String;
     205: invokeinterface #63,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     210: pop
     211: goto          175
     214: goto          141
     217: aload_2
     218: areturn

  public boolean isCheckAudienceRestriction();
    Code:
       0: aload_0
       1: getfield      #43                 // Field checkAudienceRestriction:Z
       4: ireturn

  public void setCheckAudienceRestriction(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #43                 // Field checkAudienceRestriction:Z
       5: return

  static {};
    Code:
       0: ldc_w         #71                 // class org/apache/cxf/sts/token/delegation/SAMLDelegationHandler
       3: invokestatic  #72                 // Method org/apache/cxf/common/logging/LogUtils.getL7dLogger:(Ljava/lang/Class;)Ljava/util/logging/Logger;
       6: putstatic     #17                 // Field LOG:Ljava/util/logging/Logger;
       9: return
}
