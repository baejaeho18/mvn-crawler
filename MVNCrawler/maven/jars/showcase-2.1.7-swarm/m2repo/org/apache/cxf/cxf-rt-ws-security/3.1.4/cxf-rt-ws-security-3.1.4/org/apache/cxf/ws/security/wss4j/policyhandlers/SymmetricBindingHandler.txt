Compiled from "SymmetricBindingHandler.java"
public class org.apache.cxf.ws.security.wss4j.policyhandlers.SymmetricBindingHandler extends org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder {
  private final org.apache.wss4j.policy.model.SymmetricBinding sbinding;

  private final org.apache.cxf.ws.security.tokenstore.TokenStore tokenStore;

  public org.apache.cxf.ws.security.wss4j.policyhandlers.SymmetricBindingHandler(org.apache.wss4j.dom.engine.WSSConfig, org.apache.wss4j.policy.model.SymmetricBinding, javax.xml.soap.SOAPMessage, org.apache.wss4j.dom.message.WSSecHeader, org.apache.cxf.ws.policy.AssertionInfoMap, org.apache.cxf.binding.soap.SoapMessage) throws javax.xml.soap.SOAPException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: aload         5
       8: aload         6
      10: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder."<init>":(Lorg/apache/wss4j/dom/engine/WSSConfig;Lorg/apache/wss4j/policy/model/AbstractBinding;Ljavax/xml/soap/SOAPMessage;Lorg/apache/wss4j/dom/message/WSSecHeader;Lorg/apache/cxf/ws/policy/AssertionInfoMap;Lorg/apache/cxf/binding/soap/SoapMessage;)V
      13: aload_0
      14: aload_2
      15: putfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
      18: aload_0
      19: aload_0
      20: invokevirtual #3                  // Method getTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      23: putfield      #4                  // Field tokenStore:Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      26: aload_0
      27: aload_2
      28: invokevirtual #5                  // Method org/apache/wss4j/policy/model/SymmetricBinding.getProtectionOrder:()Lorg/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder;
      31: putfield      #6                  // Field protectionOrder:Lorg/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder;
      34: return

  private org.apache.wss4j.policy.model.AbstractTokenWrapper getSignatureToken();
    Code:
       0: aload_0
       1: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
       4: invokevirtual #7                  // Method org/apache/wss4j/policy/model/SymmetricBinding.getProtectionToken:()Lorg/apache/wss4j/policy/model/ProtectionToken;
       7: ifnull        18
      10: aload_0
      11: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
      14: invokevirtual #7                  // Method org/apache/wss4j/policy/model/SymmetricBinding.getProtectionToken:()Lorg/apache/wss4j/policy/model/ProtectionToken;
      17: areturn
      18: aload_0
      19: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
      22: invokevirtual #8                  // Method org/apache/wss4j/policy/model/SymmetricBinding.getSignatureToken:()Lorg/apache/wss4j/policy/model/SignatureToken;
      25: areturn

  private org.apache.wss4j.policy.model.AbstractTokenWrapper getEncryptionToken();
    Code:
       0: aload_0
       1: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
       4: invokevirtual #7                  // Method org/apache/wss4j/policy/model/SymmetricBinding.getProtectionToken:()Lorg/apache/wss4j/policy/model/ProtectionToken;
       7: ifnull        18
      10: aload_0
      11: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
      14: invokevirtual #7                  // Method org/apache/wss4j/policy/model/SymmetricBinding.getProtectionToken:()Lorg/apache/wss4j/policy/model/ProtectionToken;
      17: areturn
      18: aload_0
      19: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
      22: invokevirtual #9                  // Method org/apache/wss4j/policy/model/SymmetricBinding.getEncryptionToken:()Lorg/apache/wss4j/policy/model/EncryptionToken;
      25: areturn

  public void handleBinding();
    Code:
       0: aload_0
       1: invokevirtual #10                 // Method createTimestamp:()Lorg/apache/wss4j/dom/message/WSSecTimestamp;
       4: astore_1
       5: aload_0
       6: aload_1
       7: invokevirtual #11                 // Method handleLayout:(Lorg/apache/wss4j/dom/message/WSSecTimestamp;)Lorg/apache/wss4j/dom/message/WSSecTimestamp;
      10: pop
      11: aload_0
      12: aload_0
      13: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
      16: invokevirtual #12                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getName:()Ljavax/xml/namespace/QName;
      19: invokevirtual #13                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
      22: aload_0
      23: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
      26: invokevirtual #5                  // Method org/apache/wss4j/policy/model/SymmetricBinding.getProtectionOrder:()Lorg/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder;
      29: getstatic     #14                 // Field org/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder.EncryptBeforeSigning:Lorg/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder;
      32: if_acmpne     65
      35: aload_0
      36: invokespecial #15                 // Method doEncryptBeforeSign:()V
      39: aload_0
      40: new           #16                 // class javax/xml/namespace/QName
      43: dup
      44: aload_0
      45: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
      48: invokevirtual #12                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getName:()Ljavax/xml/namespace/QName;
      51: invokevirtual #17                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
      54: ldc           #18                 // String EncryptBeforeSigning
      56: invokespecial #19                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      59: invokevirtual #13                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
      62: goto          92
      65: aload_0
      66: invokespecial #20                 // Method doSignBeforeEncrypt:()V
      69: aload_0
      70: new           #16                 // class javax/xml/namespace/QName
      73: dup
      74: aload_0
      75: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
      78: invokevirtual #12                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getName:()Ljavax/xml/namespace/QName;
      81: invokevirtual #17                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
      84: ldc           #21                 // String SignBeforeEncrypting
      86: invokespecial #19                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      89: invokevirtual #13                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
      92: aload_0
      93: invokevirtual #22                 // Method reshuffleTimestamp:()V
      96: aload_0
      97: aload_0
      98: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     101: invokevirtual #23                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     104: invokevirtual #24                 // Method assertAlgorithmSuite:(Lorg/apache/wss4j/policy/model/AlgorithmSuite;)V
     107: aload_0
     108: aload_0
     109: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     112: invokevirtual #12                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getName:()Ljavax/xml/namespace/QName;
     115: invokevirtual #17                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     118: invokevirtual #25                 // Method assertWSSProperties:(Ljava/lang/String;)V
     121: aload_0
     122: aload_0
     123: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     126: invokevirtual #12                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getName:()Ljavax/xml/namespace/QName;
     129: invokevirtual #17                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     132: invokevirtual #26                 // Method assertTrustProperties:(Ljava/lang/String;)V
     135: aload_0
     136: new           #16                 // class javax/xml/namespace/QName
     139: dup
     140: aload_0
     141: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     144: invokevirtual #12                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getName:()Ljavax/xml/namespace/QName;
     147: invokevirtual #17                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     150: ldc           #27                 // String OnlySignEntireHeadersAndBody
     152: invokespecial #19                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     155: invokevirtual #13                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     158: return

  private void doEncryptBeforeSign();
    Code:
       0: aload_0
       1: invokespecial #28                 // Method getEncryptionToken:()Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;
       4: astore_1
       5: aload_0
       6: aload_1
       7: invokevirtual #29                 // Method assertTokenWrapper:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;)V
      10: aload_1
      11: invokevirtual #30                 // Method org/apache/wss4j/policy/model/AbstractTokenWrapper.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
      14: astore_2
      15: aload_2
      16: ifnull        609
      19: aconst_null
      20: astore_3
      21: aconst_null
      22: astore        4
      24: aload_2
      25: instanceof    #31                 // class org/apache/wss4j/policy/model/IssuedToken
      28: ifne          59
      31: aload_2
      32: instanceof    #32                 // class org/apache/wss4j/policy/model/KerberosToken
      35: ifne          59
      38: aload_2
      39: instanceof    #33                 // class org/apache/wss4j/policy/model/SecureConversationToken
      42: ifne          59
      45: aload_2
      46: instanceof    #34                 // class org/apache/wss4j/policy/model/SecurityContextToken
      49: ifne          59
      52: aload_2
      53: instanceof    #35                 // class org/apache/wss4j/policy/model/SpnegoContextToken
      56: ifeq          68
      59: aload_0
      60: invokevirtual #36                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      63: astore        4
      65: goto          131
      68: aload_2
      69: instanceof    #37                 // class org/apache/wss4j/policy/model/X509Token
      72: ifeq          100
      75: aload_0
      76: invokevirtual #38                 // Method isRequestor:()Z
      79: ifeq          92
      82: aload_0
      83: aload_1
      84: aload_2
      85: invokespecial #39                 // Method setupEncryptedKey:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;Lorg/apache/wss4j/policy/model/AbstractToken;)Ljava/lang/String;
      88: astore_3
      89: goto          131
      92: aload_0
      93: invokespecial #40                 // Method getEncryptedKey:()Ljava/lang/String;
      96: astore_3
      97: goto          131
     100: aload_2
     101: instanceof    #41                 // class org/apache/wss4j/policy/model/UsernameToken
     104: ifeq          131
     107: aload_0
     108: invokevirtual #38                 // Method isRequestor:()Z
     111: ifeq          126
     114: aload_0
     115: aload_2
     116: checkcast     #41                 // class org/apache/wss4j/policy/model/UsernameToken
     119: invokespecial #42                 // Method setupUTDerivedKey:(Lorg/apache/wss4j/policy/model/UsernameToken;)Ljava/lang/String;
     122: astore_3
     123: goto          131
     126: aload_0
     127: invokespecial #43                 // Method getUTDerivedKey:()Ljava/lang/String;
     130: astore_3
     131: aload         4
     133: ifnonnull     167
     136: aload_3
     137: ifnull        155
     140: aload_3
     141: ldc           #44                 // String #
     143: invokevirtual #45                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     146: ifeq          155
     149: aload_3
     150: iconst_1
     151: invokevirtual #46                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     154: astore_3
     155: aload_0
     156: getfield      #4                  // Field tokenStore:Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     159: aload_3
     160: invokeinterface #47,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.getToken:(Ljava/lang/String;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     165: astore        4
     167: iconst_0
     168: istore        5
     170: aload_0
     171: aload_2
     172: invokevirtual #48                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     175: invokevirtual #49                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
     178: ifeq          204
     181: aload         4
     183: invokevirtual #50                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
     186: astore        6
     188: aload_0
     189: aload_0
     190: aload         6
     192: invokevirtual #51                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     195: invokevirtual #52                 // Method addEncryptedKeyElement:(Lorg/w3c/dom/Element;)V
     198: iconst_1
     199: istore        5
     201: goto          238
     204: aload_2
     205: instanceof    #37                 // class org/apache/wss4j/policy/model/X509Token
     208: ifeq          238
     211: aload_0
     212: invokevirtual #38                 // Method isRequestor:()Z
     215: ifeq          238
     218: aload         4
     220: invokevirtual #50                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
     223: astore        6
     225: aload_0
     226: aload_0
     227: aload         6
     229: invokevirtual #51                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     232: invokevirtual #52                 // Method addEncryptedKeyElement:(Lorg/w3c/dom/Element;)V
     235: iconst_1
     236: istore        5
     238: new           #53                 // class java/util/ArrayList
     241: dup
     242: invokespecial #54                 // Method java/util/ArrayList."<init>":()V
     245: astore        6
     247: aload_0
     248: getfield      #55                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     251: ifnull        277
     254: aload_0
     255: aload_0
     256: getfield      #55                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     259: invokevirtual #56                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
     262: invokevirtual #57                 // Method convertToEncryptionPart:(Lorg/w3c/dom/Element;)Lorg/apache/wss4j/common/WSEncryptionPart;
     265: astore        7
     267: aload         6
     269: aload         7
     271: invokeinterface #58,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     276: pop
     277: aload_0
     278: aload         6
     280: invokevirtual #59                 // Method addSupportingTokens:(Ljava/util/List;)V
     283: aload         6
     285: aload_0
     286: aconst_null
     287: invokevirtual #60                 // Method getSignedParts:(Lorg/apache/wss4j/policy/model/SupportingTokens;)Ljava/util/List;
     290: invokeinterface #61,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     295: pop
     296: aload_0
     297: invokevirtual #62                 // Method getEncryptedParts:()Ljava/util/List;
     300: astore        7
     302: aload_0
     303: aload_1
     304: aload         4
     306: iload         5
     308: aload         7
     310: iconst_1
     311: invokespecial #63                 // Method doEncryption:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;ZLjava/util/List;Z)Lorg/apache/wss4j/dom/message/WSSecBase;
     314: astore        8
     316: aload_0
     317: aload         7
     319: aload         6
     321: invokevirtual #64                 // Method handleEncryptedSignedHeaders:(Ljava/util/List;Ljava/util/List;)V
     324: aload_0
     325: invokevirtual #38                 // Method isRequestor:()Z
     328: ifne          337
     331: aload_0
     332: aload         6
     334: invokevirtual #65                 // Method addSignatureConfirmation:(Ljava/util/List;)V
     337: aload         6
     339: invokeinterface #66,  1           // InterfaceMethod java/util/List.size:()I
     344: ifle          363
     347: aload_0
     348: aload_0
     349: aload         6
     351: aload_1
     352: aload_2
     353: aload         4
     355: iload         5
     357: invokespecial #67                 // Method doSignature:(Ljava/util/List;Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;Z)[B
     360: invokevirtual #68                 // Method addSig:([B)V
     363: aload_0
     364: invokevirtual #38                 // Method isRequestor:()Z
     367: ifeq          374
     370: aload_0
     371: invokevirtual #69                 // Method doEndorse:()V
     374: aload_0
     375: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     378: invokevirtual #70                 // Method org/apache/wss4j/policy/model/SymmetricBinding.isEncryptSignature:()Z
     381: ifne          403
     384: aload_0
     385: getfield      #71                 // Field encryptedTokensList:Ljava/util/Set;
     388: invokeinterface #72,  1           // InterfaceMethod java/util/Set.size:()I
     393: ifle          609
     396: aload_0
     397: invokevirtual #38                 // Method isRequestor:()Z
     400: ifeq          609
     403: new           #53                 // class java/util/ArrayList
     406: dup
     407: invokespecial #54                 // Method java/util/ArrayList."<init>":()V
     410: astore        9
     412: aload_0
     413: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     416: invokevirtual #70                 // Method org/apache/wss4j/policy/model/SymmetricBinding.isEncryptSignature:()Z
     419: ifeq          517
     422: aload_0
     423: getfield      #73                 // Field mainSigId:Ljava/lang/String;
     426: ifnull        463
     429: new           #74                 // class org/apache/wss4j/common/WSEncryptionPart
     432: dup
     433: aload_0
     434: getfield      #73                 // Field mainSigId:Ljava/lang/String;
     437: ldc           #75                 // String Element
     439: invokespecial #76                 // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     442: astore        10
     444: aload         10
     446: aload_0
     447: getfield      #77                 // Field bottomUpElement:Lorg/w3c/dom/Element;
     450: invokevirtual #78                 // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     453: aload         9
     455: aload         10
     457: invokeinterface #58,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     462: pop
     463: aload_0
     464: getfield      #79                 // Field sigConfList:Ljava/util/List;
     467: ifnull        494
     470: aload_0
     471: getfield      #79                 // Field sigConfList:Ljava/util/List;
     474: invokeinterface #80,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     479: ifne          494
     482: aload         9
     484: aload_0
     485: getfield      #79                 // Field sigConfList:Ljava/util/List;
     488: invokeinterface #61,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     493: pop
     494: aload_0
     495: new           #16                 // class javax/xml/namespace/QName
     498: dup
     499: aload_0
     500: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     503: invokevirtual #12                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getName:()Ljavax/xml/namespace/QName;
     506: invokevirtual #17                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     509: ldc           #81                 // String EncryptSignature
     511: invokespecial #19                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     514: invokevirtual #13                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     517: aload_0
     518: invokevirtual #38                 // Method isRequestor:()Z
     521: ifeq          536
     524: aload         9
     526: aload_0
     527: getfield      #71                 // Field encryptedTokensList:Ljava/util/Set;
     530: invokeinterface #61,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     535: pop
     536: aconst_null
     537: astore        10
     539: aload_2
     540: invokevirtual #82                 // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
     543: getstatic     #83                 // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
     546: if_acmpne     575
     549: aload         9
     551: invokeinterface #80,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     556: ifne          575
     559: aload         8
     561: checkcast     #84                 // class org/apache/wss4j/dom/message/WSSecDKEncrypt
     564: aconst_null
     565: aload         9
     567: invokevirtual #85                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.encryptForExternalRef:(Lorg/w3c/dom/Element;Ljava/util/List;)Lorg/w3c/dom/Element;
     570: astore        10
     572: goto          598
     575: aload         9
     577: invokeinterface #80,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     582: ifne          598
     585: aload         8
     587: checkcast     #86                 // class org/apache/wss4j/dom/message/WSSecEncrypt
     590: aconst_null
     591: aload         9
     593: invokevirtual #87                 // Method org/apache/wss4j/dom/message/WSSecEncrypt.encryptForRef:(Lorg/w3c/dom/Element;Ljava/util/List;)Lorg/w3c/dom/Element;
     596: astore        10
     598: aload         10
     600: ifnull        609
     603: aload_0
     604: aload         10
     606: invokevirtual #88                 // Method addDerivedKeyElement:(Lorg/w3c/dom/Element;)V
     609: goto          653
     612: astore_1
     613: getstatic     #90                 // Field LOG:Ljava/util/logging/Logger;
     616: getstatic     #91                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     619: aload_1
     620: invokevirtual #92                 // Method java/lang/RuntimeException.getMessage:()Ljava/lang/String;
     623: aload_1
     624: invokevirtual #93                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     627: aload_1
     628: athrow
     629: astore_1
     630: getstatic     #90                 // Field LOG:Ljava/util/logging/Logger;
     633: getstatic     #91                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     636: aload_1
     637: invokevirtual #95                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     640: aload_1
     641: invokevirtual #93                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     644: new           #96                 // class org/apache/cxf/interceptor/Fault
     647: dup
     648: aload_1
     649: invokespecial #97                 // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     652: athrow
     653: return
    Exception table:
       from    to  target type
           0   609   612   Class java/lang/RuntimeException
           0   609   629   Class java/lang/Exception

  private void doSignBeforeEncrypt();
    Code:
       0: aload_0
       1: invokespecial #98                 // Method getSignatureToken:()Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;
       4: astore_1
       5: aload_0
       6: aload_1
       7: invokevirtual #29                 // Method assertTokenWrapper:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;)V
      10: aload_1
      11: invokevirtual #30                 // Method org/apache/wss4j/policy/model/AbstractTokenWrapper.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
      14: astore_2
      15: aconst_null
      16: astore_3
      17: aconst_null
      18: astore        4
      20: aconst_null
      21: astore        5
      23: aload_2
      24: ifnull        137
      27: aload_2
      28: instanceof    #33                 // class org/apache/wss4j/policy/model/SecureConversationToken
      31: ifne          62
      34: aload_2
      35: instanceof    #34                 // class org/apache/wss4j/policy/model/SecurityContextToken
      38: ifne          62
      41: aload_2
      42: instanceof    #31                 // class org/apache/wss4j/policy/model/IssuedToken
      45: ifne          62
      48: aload_2
      49: instanceof    #32                 // class org/apache/wss4j/policy/model/KerberosToken
      52: ifne          62
      55: aload_2
      56: instanceof    #35                 // class org/apache/wss4j/policy/model/SpnegoContextToken
      59: ifeq          71
      62: aload_0
      63: invokevirtual #36                 // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      66: astore        5
      68: goto          148
      71: aload_2
      72: instanceof    #37                 // class org/apache/wss4j/policy/model/X509Token
      75: ifeq          103
      78: aload_0
      79: invokevirtual #38                 // Method isRequestor:()Z
      82: ifeq          95
      85: aload_0
      86: aload_1
      87: aload_2
      88: invokespecial #39                 // Method setupEncryptedKey:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;Lorg/apache/wss4j/policy/model/AbstractToken;)Ljava/lang/String;
      91: astore_3
      92: goto          148
      95: aload_0
      96: invokespecial #40                 // Method getEncryptedKey:()Ljava/lang/String;
      99: astore_3
     100: goto          148
     103: aload_2
     104: instanceof    #41                 // class org/apache/wss4j/policy/model/UsernameToken
     107: ifeq          148
     110: aload_0
     111: invokevirtual #38                 // Method isRequestor:()Z
     114: ifeq          129
     117: aload_0
     118: aload_2
     119: checkcast     #41                 // class org/apache/wss4j/policy/model/UsernameToken
     122: invokespecial #42                 // Method setupUTDerivedKey:(Lorg/apache/wss4j/policy/model/UsernameToken;)Ljava/lang/String;
     125: astore_3
     126: goto          148
     129: aload_0
     130: invokespecial #43                 // Method getUTDerivedKey:()Ljava/lang/String;
     133: astore_3
     134: goto          148
     137: aload_0
     138: aload_0
     139: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     142: ldc           #99                 // String No signature token
     144: invokevirtual #100                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     147: return
     148: aload         5
     150: ifnonnull     168
     153: aload_3
     154: invokestatic  #101                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     157: ifeq          168
     160: aload_0
     161: aload_1
     162: ldc           #102                // String No signature token id
     164: invokevirtual #100                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     167: return
     168: aload_0
     169: aload_1
     170: invokevirtual #103                // Method assertPolicy:(Lorg/apache/neethi/Assertion;)V
     173: aload         5
     175: ifnonnull     190
     178: aload_0
     179: getfield      #4                  // Field tokenStore:Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     182: aload_3
     183: invokeinterface #47,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.getToken:(Ljava/lang/String;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     188: astore        5
     190: iconst_1
     191: istore        6
     193: aload_0
     194: aload_2
     195: invokevirtual #48                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     198: invokevirtual #49                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
     201: ifeq          228
     204: aload         5
     206: invokevirtual #50                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
     209: astore        7
     211: aload_0
     212: aload         7
     214: invokevirtual #51                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     217: astore        4
     219: aload_0
     220: aload         4
     222: invokevirtual #52                 // Method addEncryptedKeyElement:(Lorg/w3c/dom/Element;)V
     225: goto          269
     228: aload_0
     229: invokevirtual #38                 // Method isRequestor:()Z
     232: ifeq          266
     235: aload_2
     236: instanceof    #37                 // class org/apache/wss4j/policy/model/X509Token
     239: ifeq          266
     242: aload         5
     244: invokevirtual #50                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
     247: astore        7
     249: aload_0
     250: aload         7
     252: invokevirtual #51                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     255: astore        4
     257: aload_0
     258: aload         4
     260: invokevirtual #52                 // Method addEncryptedKeyElement:(Lorg/w3c/dom/Element;)V
     263: goto          269
     266: iconst_0
     267: istore        6
     269: new           #53                 // class java/util/ArrayList
     272: dup
     273: invokespecial #54                 // Method java/util/ArrayList."<init>":()V
     276: astore        7
     278: aload_0
     279: getfield      #55                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     282: ifnull        308
     285: aload_0
     286: aload_0
     287: getfield      #55                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     290: invokevirtual #56                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
     293: invokevirtual #57                 // Method convertToEncryptionPart:(Lorg/w3c/dom/Element;)Lorg/apache/wss4j/common/WSEncryptionPart;
     296: astore        8
     298: aload         7
     300: aload         8
     302: invokeinterface #58,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     307: pop
     308: aload_0
     309: aload         7
     311: invokevirtual #59                 // Method addSupportingTokens:(Ljava/util/List;)V
     314: aload         7
     316: aload_0
     317: aconst_null
     318: invokevirtual #60                 // Method getSignedParts:(Lorg/apache/wss4j/policy/model/SupportingTokens;)Ljava/util/List;
     321: invokeinterface #61,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     326: pop
     327: aload_0
     328: invokevirtual #38                 // Method isRequestor:()Z
     331: ifeq          367
     334: aload         7
     336: invokeinterface #80,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     341: ifne          360
     344: aload_0
     345: aload_0
     346: aload         7
     348: aload_1
     349: aload_2
     350: aload         5
     352: iload         6
     354: invokespecial #67                 // Method doSignature:(Ljava/util/List;Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;Z)[B
     357: invokevirtual #68                 // Method addSig:([B)V
     360: aload_0
     361: invokevirtual #69                 // Method doEndorse:()V
     364: goto          396
     367: aload_0
     368: aload         7
     370: invokevirtual #65                 // Method addSignatureConfirmation:(Ljava/util/List;)V
     373: aload         7
     375: invokeinterface #80,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     380: ifne          396
     383: aload_0
     384: aload         7
     386: aload_1
     387: aload_2
     388: aload         5
     390: iload         6
     392: invokespecial #67                 // Method doSignature:(Ljava/util/List;Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;Z)[B
     395: pop
     396: aload_0
     397: invokespecial #28                 // Method getEncryptionToken:()Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;
     400: astore        8
     402: aload         8
     404: invokevirtual #30                 // Method org/apache/wss4j/policy/model/AbstractTokenWrapper.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     407: astore        9
     409: aconst_null
     410: astore        10
     412: aload_2
     413: aload         9
     415: invokevirtual #104                // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
     418: ifeq          428
     421: aload         5
     423: astore        10
     425: goto          439
     428: aload_0
     429: aload_0
     430: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     433: ldc           #105                // String Encryption token does not equal signature token
     435: invokevirtual #100                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     438: return
     439: aload_0
     440: invokevirtual #62                 // Method getEncryptedParts:()Ljava/util/List;
     443: astore        11
     445: aload_0
     446: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     449: invokevirtual #70                 // Method org/apache/wss4j/policy/model/SymmetricBinding.isEncryptSignature:()Z
     452: ifeq          550
     455: aload_0
     456: getfield      #73                 // Field mainSigId:Ljava/lang/String;
     459: ifnull        496
     462: new           #74                 // class org/apache/wss4j/common/WSEncryptionPart
     465: dup
     466: aload_0
     467: getfield      #73                 // Field mainSigId:Ljava/lang/String;
     470: ldc           #75                 // String Element
     472: invokespecial #76                 // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     475: astore        12
     477: aload         12
     479: aload_0
     480: getfield      #77                 // Field bottomUpElement:Lorg/w3c/dom/Element;
     483: invokevirtual #78                 // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     486: aload         11
     488: aload         12
     490: invokeinterface #58,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     495: pop
     496: aload_0
     497: getfield      #79                 // Field sigConfList:Ljava/util/List;
     500: ifnull        527
     503: aload_0
     504: getfield      #79                 // Field sigConfList:Ljava/util/List;
     507: invokeinterface #80,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     512: ifne          527
     515: aload         11
     517: aload_0
     518: getfield      #79                 // Field sigConfList:Ljava/util/List;
     521: invokeinterface #61,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     526: pop
     527: aload_0
     528: new           #16                 // class javax/xml/namespace/QName
     531: dup
     532: aload_0
     533: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     536: invokevirtual #12                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getName:()Ljavax/xml/namespace/QName;
     539: invokevirtual #17                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     542: ldc           #81                 // String EncryptSignature
     544: invokespecial #19                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     547: invokevirtual #13                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     550: aload_0
     551: invokevirtual #38                 // Method isRequestor:()Z
     554: ifeq          569
     557: aload         11
     559: aload_0
     560: getfield      #71                 // Field encryptedTokensList:Ljava/util/Set;
     563: invokeinterface #61,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     568: pop
     569: aload_0
     570: aload         8
     572: aload         10
     574: iload         6
     576: aload         11
     578: iconst_0
     579: invokespecial #63                 // Method doEncryption:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;ZLjava/util/List;Z)Lorg/apache/wss4j/dom/message/WSSecBase;
     582: pop
     583: goto          614
     586: astore        5
     588: getstatic     #90                 // Field LOG:Ljava/util/logging/Logger;
     591: getstatic     #91                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     594: aload         5
     596: invokevirtual #95                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     599: aload         5
     601: invokevirtual #93                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     604: new           #96                 // class org/apache/cxf/interceptor/Fault
     607: dup
     608: aload         5
     610: invokespecial #97                 // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     613: athrow
     614: return
    Exception table:
       from    to  target type
          20   147   586   Class java/lang/Exception
         148   167   586   Class java/lang/Exception
         168   438   586   Class java/lang/Exception
         439   583   586   Class java/lang/Exception

  private org.apache.wss4j.dom.message.WSSecBase doEncryptionDerived(org.apache.wss4j.policy.model.AbstractTokenWrapper, org.apache.cxf.ws.security.tokenstore.SecurityToken, org.apache.wss4j.policy.model.AbstractToken, boolean, java.util.List<org.apache.wss4j.common.WSEncryptionPart>, boolean);
    Code:
       0: new           #84                 // class org/apache/wss4j/dom/message/WSSecDKEncrypt
       3: dup
       4: invokespecial #106                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt."<init>":()V
       7: astore        7
       9: aload         7
      11: aload_0
      12: getfield      #107                // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      15: invokevirtual #108                // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      18: invokevirtual #109                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      21: aload         7
      23: aload_0
      24: getfield      #110                // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      27: invokevirtual #111                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
      30: aload         7
      32: new           #112                // class org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler
      35: dup
      36: aload_0
      37: getfield      #113                // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      40: invokespecial #114                // Method org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler."<init>":(Lorg/apache/cxf/binding/soap/SoapMessage;)V
      43: invokevirtual #115                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setAttachmentCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
      46: aload         7
      48: aload_0
      49: getfield      #116                // Field storeBytesInAttachment:Z
      52: invokevirtual #117                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setStoreBytesInAttachment:(Z)V
      55: aload_1
      56: invokevirtual #30                 // Method org/apache/wss4j/policy/model/AbstractTokenWrapper.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
      59: invokevirtual #118                // Method org/apache/wss4j/policy/model/AbstractToken.getVersion:()Lorg/apache/wss4j/policy/SPConstants$SPVersion;
      62: getstatic     #119                // Field org/apache/wss4j/policy/SPConstants$SPVersion.SP11:Lorg/apache/wss4j/policy/SPConstants$SPVersion;
      65: if_acmpne     74
      68: aload         7
      70: iconst_1
      71: invokevirtual #120                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setWscVersion:(I)V
      74: iload         4
      76: ifeq          106
      79: aload_2
      80: invokevirtual #121                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getAttachedReference:()Lorg/w3c/dom/Element;
      83: ifnull        106
      86: aload         7
      88: aload_2
      89: invokevirtual #122                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
      92: aload_0
      93: aload_2
      94: invokevirtual #121                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getAttachedReference:()Lorg/w3c/dom/Element;
      97: invokevirtual #51                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     100: invokevirtual #123                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setExternalKey:([BLorg/w3c/dom/Element;)V
     103: goto          349
     106: aload_2
     107: invokevirtual #124                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getUnattachedReference:()Lorg/w3c/dom/Element;
     110: ifnull        133
     113: aload         7
     115: aload_2
     116: invokevirtual #122                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     119: aload_0
     120: aload_2
     121: invokevirtual #124                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getUnattachedReference:()Lorg/w3c/dom/Element;
     124: invokevirtual #51                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     127: invokevirtual #123                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setExternalKey:([BLorg/w3c/dom/Element;)V
     130: goto          349
     133: aload_0
     134: invokevirtual #38                 // Method isRequestor:()Z
     137: ifne          242
     140: aload_2
     141: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     144: ifnull        242
     147: new           #126                // class org/apache/wss4j/common/token/SecurityTokenReference
     150: dup
     151: aload_0
     152: getfield      #127                // Field saaj:Ljavax/xml/soap/SOAPMessage;
     155: invokevirtual #128                // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     158: invokespecial #129                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     161: astore        8
     163: aload_2
     164: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     167: astore        9
     169: aload_3
     170: instanceof    #32                 // class org/apache/wss4j/policy/model/KerberosToken
     173: ifeq          200
     176: aload         8
     178: ldc           #131                // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#Kerberosv5APREQSHA1
     180: aload_2
     181: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     184: iconst_1
     185: invokevirtual #132                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/lang/String;Ljava/lang/String;Z)V
     188: aload         9
     190: ifnonnull     218
     193: ldc           #133                // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#GSS_Kerberosv5_AP_REQ
     195: astore        9
     197: goto          218
     200: aload         8
     202: aload_2
     203: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     206: invokevirtual #134                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierEncKeySHA1:(Ljava/lang/String;)V
     209: aload         9
     211: ifnonnull     218
     214: ldc           #135                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     216: astore        9
     218: aload         8
     220: aload         9
     222: invokevirtual #136                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     225: aload         7
     227: aload_2
     228: invokevirtual #122                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     231: aload         8
     233: invokevirtual #137                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     236: invokevirtual #123                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setExternalKey:([BLorg/w3c/dom/Element;)V
     239: goto          349
     242: iload         4
     244: ifeq          330
     247: aload_2
     248: invokevirtual #138                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getWsuId:()Ljava/lang/String;
     251: astore        8
     253: aload         8
     255: ifnonnull     287
     258: aload_3
     259: instanceof    #33                 // class org/apache/wss4j/policy/model/SecureConversationToken
     262: ifne          272
     265: aload_3
     266: instanceof    #34                 // class org/apache/wss4j/policy/model/SecurityContextToken
     269: ifeq          287
     272: aload         7
     274: iconst_1
     275: invokevirtual #139                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setTokenIdDirectId:(Z)V
     278: aload_2
     279: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     282: astore        8
     284: goto          298
     287: aload         8
     289: ifnonnull     298
     292: aload_2
     293: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     296: astore        8
     298: aload         8
     300: ldc           #44                 // String #
     302: invokevirtual #45                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     305: ifeq          316
     308: aload         8
     310: iconst_1
     311: invokevirtual #46                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     314: astore        8
     316: aload         7
     318: aload_2
     319: invokevirtual #122                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     322: aload         8
     324: invokevirtual #141                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setExternalKey:([BLjava/lang/String;)V
     327: goto          349
     330: aload         7
     332: iconst_1
     333: invokevirtual #139                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setTokenIdDirectId:(Z)V
     336: aload         7
     338: aload_2
     339: invokevirtual #122                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     342: aload_2
     343: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     346: invokevirtual #141                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setExternalKey:([BLjava/lang/String;)V
     349: aload_2
     350: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     353: ifnull        381
     356: aload_2
     357: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     360: astore        8
     362: aload         8
     364: ifnonnull     371
     367: ldc           #135                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     369: astore        8
     371: aload         7
     373: aload         8
     375: invokevirtual #142                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setCustomValueType:(Ljava/lang/String;)V
     378: goto          485
     381: aload_2
     382: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     385: astore        8
     387: ldc           #143                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     389: aload         8
     391: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     394: ifne          407
     397: ldc           #145                // String urn:oasis:names:tc:SAML:1.0:assertion
     399: aload         8
     401: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     404: ifeq          424
     407: aload         7
     409: bipush        12
     411: invokevirtual #146                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setKeyIdentifierType:(I)V
     414: aload         7
     416: ldc           #147                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     418: invokevirtual #142                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setCustomValueType:(Ljava/lang/String;)V
     421: goto          485
     424: ldc           #148                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     426: aload         8
     428: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     431: ifne          444
     434: ldc           #149                // String urn:oasis:names:tc:SAML:2.0:assertion
     436: aload         8
     438: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     441: ifeq          461
     444: aload         7
     446: bipush        12
     448: invokevirtual #146                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setKeyIdentifierType:(I)V
     451: aload         7
     453: ldc           #150                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     455: invokevirtual #142                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setCustomValueType:(Ljava/lang/String;)V
     458: goto          485
     461: aload_3
     462: instanceof    #41                 // class org/apache/wss4j/policy/model/UsernameToken
     465: ifeq          478
     468: aload         7
     470: ldc           #151                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
     472: invokevirtual #142                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setCustomValueType:(Ljava/lang/String;)V
     475: goto          485
     478: aload         7
     480: aload         8
     482: invokevirtual #142                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setCustomValueType:(Ljava/lang/String;)V
     485: aload_0
     486: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     489: invokevirtual #23                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     492: invokevirtual #152                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     495: astore        8
     497: aload         7
     499: aload         8
     501: invokevirtual #153                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getEncryption:()Ljava/lang/String;
     504: invokevirtual #154                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setSymmetricEncAlgorithm:(Ljava/lang/String;)V
     507: aload         7
     509: aload         8
     511: invokevirtual #155                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getEncryptionDerivedKeyLength:()I
     514: bipush        8
     516: idiv
     517: invokevirtual #156                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.setDerivedKeyLength:(I)V
     520: aload         7
     522: aload_0
     523: getfield      #127                // Field saaj:Ljavax/xml/soap/SOAPMessage;
     526: invokevirtual #128                // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     529: invokevirtual #157                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.prepare:(Lorg/w3c/dom/Document;)V
     532: aconst_null
     533: astore        9
     535: aload         7
     537: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.getdktElement:()Lorg/w3c/dom/Element;
     540: astore        9
     542: aload_0
     543: aload         9
     545: invokevirtual #88                 // Method addDerivedKeyElement:(Lorg/w3c/dom/Element;)V
     548: aload         7
     550: aconst_null
     551: aload         5
     553: invokevirtual #85                 // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.encryptForExternalRef:(Lorg/w3c/dom/Element;Ljava/util/List;)Lorg/w3c/dom/Element;
     556: astore        10
     558: aload         7
     560: invokevirtual #159                // Method org/apache/wss4j/dom/message/WSSecDKEncrypt.getAttachmentEncryptedDataElements:()Ljava/util/List;
     563: astore        11
     565: aload_0
     566: iload         6
     568: aload         10
     570: aload         11
     572: invokespecial #160                // Method addAttachmentsForEncryption:(ZLorg/w3c/dom/Element;Ljava/util/List;)V
     575: aload         7
     577: areturn
     578: astore        7
     580: getstatic     #90                 // Field LOG:Ljava/util/logging/Logger;
     583: getstatic     #91                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     586: aload         7
     588: invokevirtual #95                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     591: aload         7
     593: invokevirtual #93                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     596: aload_0
     597: aload_1
     598: aload         7
     600: invokevirtual #161                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/Exception;)V
     603: aconst_null
     604: areturn
    Exception table:
       from    to  target type
           0   577   578   Class java/lang/Exception

  private org.apache.wss4j.dom.message.WSSecBase doEncryption(org.apache.wss4j.policy.model.AbstractTokenWrapper, org.apache.cxf.ws.security.tokenstore.SecurityToken, boolean, java.util.List<org.apache.wss4j.common.WSEncryptionPart>, boolean);
    Code:
       0: aload_1
       1: ifnull        678
       4: aload_1
       5: invokevirtual #30                 // Method org/apache/wss4j/policy/model/AbstractTokenWrapper.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
       8: ifnull        678
      11: aload         4
      13: invokeinterface #66,  1           // InterfaceMethod java/util/List.size:()I
      18: ifle          678
      21: aload_1
      22: invokevirtual #30                 // Method org/apache/wss4j/policy/model/AbstractTokenWrapper.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
      25: astore        6
      27: aload_0
      28: aload_1
      29: invokevirtual #103                // Method assertPolicy:(Lorg/apache/neethi/Assertion;)V
      32: aload_0
      33: aload         6
      35: invokevirtual #103                // Method assertPolicy:(Lorg/apache/neethi/Assertion;)V
      38: aload_0
      39: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
      42: invokevirtual #23                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
      45: astore        7
      47: aload         6
      49: invokevirtual #82                 // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
      52: getstatic     #83                 // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
      55: if_acmpne     72
      58: aload_0
      59: aload_1
      60: aload_2
      61: aload         6
      63: iload_3
      64: aload         4
      66: iload         5
      68: invokespecial #162                // Method doEncryptionDerived:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;Lorg/apache/wss4j/policy/model/AbstractToken;ZLjava/util/List;Z)Lorg/apache/wss4j/dom/message/WSSecBase;
      71: areturn
      72: new           #86                 // class org/apache/wss4j/dom/message/WSSecEncrypt
      75: dup
      76: invokespecial #163                // Method org/apache/wss4j/dom/message/WSSecEncrypt."<init>":()V
      79: astore        8
      81: aload         8
      83: aload_0
      84: getfield      #107                // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      87: invokevirtual #108                // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      90: invokevirtual #164                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      93: aload         8
      95: aload_0
      96: getfield      #110                // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      99: invokevirtual #165                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
     102: aload         8
     104: new           #112                // class org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler
     107: dup
     108: aload_0
     109: getfield      #113                // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     112: invokespecial #114                // Method org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler."<init>":(Lorg/apache/cxf/binding/soap/SoapMessage;)V
     115: invokevirtual #166                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setAttachmentCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
     118: aload         8
     120: aload_0
     121: getfield      #116                // Field storeBytesInAttachment:Z
     124: invokevirtual #167                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setStoreBytesInAttachment:(Z)V
     127: aload_2
     128: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     131: astore        9
     133: iload_3
     134: ifeq          211
     137: aload_2
     138: invokevirtual #138                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getWsuId:()Ljava/lang/String;
     141: astore        9
     143: aload         9
     145: ifnonnull     179
     148: aload         6
     150: instanceof    #33                 // class org/apache/wss4j/policy/model/SecureConversationToken
     153: ifne          164
     156: aload         6
     158: instanceof    #34                 // class org/apache/wss4j/policy/model/SecurityContextToken
     161: ifeq          179
     164: aload         8
     166: iconst_1
     167: invokevirtual #168                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setEncKeyIdDirectId:(Z)V
     170: aload_2
     171: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     174: astore        9
     176: goto          190
     179: aload         9
     181: ifnonnull     190
     184: aload_2
     185: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     188: astore        9
     190: aload         9
     192: ldc           #44                 // String #
     194: invokevirtual #45                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     197: ifeq          217
     200: aload         9
     202: iconst_1
     203: invokevirtual #46                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     206: astore        9
     208: goto          217
     211: aload         8
     213: iconst_1
     214: invokevirtual #168                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setEncKeyIdDirectId:(Z)V
     217: aload_2
     218: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     221: ifnull        233
     224: aload         8
     226: aload_2
     227: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     230: invokevirtual #169                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setCustomReferenceValue:(Ljava/lang/String;)V
     233: aload         8
     235: aload         9
     237: invokevirtual #170                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setEncKeyId:(Ljava/lang/String;)V
     240: aload         8
     242: aload_2
     243: invokevirtual #122                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     246: invokevirtual #171                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setEphemeralKey:([B)V
     249: aload_0
     250: invokevirtual #172                // Method getEncryptionCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     253: astore        10
     255: aload         10
     257: ifnull        289
     260: aload_0
     261: getfield      #113                // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     264: invokevirtual #173                // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
     267: ldc           #174                // String security.encryption.crypto
     269: aload         10
     271: invokeinterface #175,  3          // InterfaceMethod org/apache/cxf/message/Exchange.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     276: pop
     277: aload_0
     278: aload         8
     280: aload         6
     282: iconst_0
     283: aload         10
     285: invokevirtual #176                // Method setEncryptionUser:(Lorg/apache/wss4j/dom/message/WSSecEncryptedKey;Lorg/apache/wss4j/policy/model/AbstractToken;ZLorg/apache/wss4j/common/crypto/Crypto;)Ljava/lang/String;
     288: pop
     289: aload         8
     291: aload_0
     292: getfield      #127                // Field saaj:Ljavax/xml/soap/SOAPMessage;
     295: invokevirtual #128                // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     298: invokevirtual #177                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setDocument:(Lorg/w3c/dom/Document;)V
     301: aload         8
     303: iconst_0
     304: invokevirtual #178                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setEncryptSymmKey:(Z)V
     307: aload         8
     309: aload         7
     311: invokevirtual #152                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     314: invokevirtual #153                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getEncryption:()Ljava/lang/String;
     317: invokevirtual #179                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setSymmetricEncAlgorithm:(Ljava/lang/String;)V
     320: aload         8
     322: aload         7
     324: invokevirtual #152                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     327: invokevirtual #180                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getMGFAlgo:()Ljava/lang/String;
     330: invokevirtual #181                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setMGFAlgorithm:(Ljava/lang/String;)V
     333: aload         6
     335: instanceof    #31                 // class org/apache/wss4j/policy/model/IssuedToken
     338: ifne          357
     341: aload         6
     343: instanceof    #35                 // class org/apache/wss4j/policy/model/SpnegoContextToken
     346: ifne          357
     349: aload         6
     351: instanceof    #33                 // class org/apache/wss4j/policy/model/SecureConversationToken
     354: ifeq          510
     357: iload_3
     358: ifeq          370
     361: aload_2
     362: invokevirtual #121                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getAttachedReference:()Lorg/w3c/dom/Element;
     365: astore        11
     367: goto          376
     370: aload_2
     371: invokevirtual #124                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getUnattachedReference:()Lorg/w3c/dom/Element;
     374: astore        11
     376: aload_2
     377: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     380: astore        12
     382: aload         11
     384: ifnull        419
     387: new           #126                // class org/apache/wss4j/common/token/SecurityTokenReference
     390: dup
     391: aload_0
     392: aload         11
     394: invokevirtual #51                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     397: new           #182                // class org/apache/wss4j/common/bsp/BSPEnforcer
     400: dup
     401: invokespecial #183                // Method org/apache/wss4j/common/bsp/BSPEnforcer."<init>":()V
     404: invokespecial #184                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     407: astore        13
     409: aload         8
     411: aload         13
     413: invokevirtual #185                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setSecurityTokenReference:(Lorg/apache/wss4j/common/token/SecurityTokenReference;)V
     416: goto          507
     419: ldc           #143                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     421: aload         12
     423: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     426: ifne          439
     429: ldc           #145                // String urn:oasis:names:tc:SAML:1.0:assertion
     431: aload         12
     433: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     436: ifeq          456
     439: aload         8
     441: ldc           #147                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     443: invokevirtual #169                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setCustomReferenceValue:(Ljava/lang/String;)V
     446: aload         8
     448: bipush        12
     450: invokevirtual #186                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setKeyIdentifierType:(I)V
     453: goto          507
     456: ldc           #148                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     458: aload         12
     460: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     463: ifne          476
     466: ldc           #149                // String urn:oasis:names:tc:SAML:2.0:assertion
     468: aload         12
     470: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     473: ifeq          493
     476: aload         8
     478: ldc           #150                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     480: invokevirtual #169                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setCustomReferenceValue:(Ljava/lang/String;)V
     483: aload         8
     485: bipush        12
     487: invokevirtual #186                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setKeyIdentifierType:(I)V
     490: goto          507
     493: aload         8
     495: aload         12
     497: invokevirtual #169                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setCustomReferenceValue:(Ljava/lang/String;)V
     500: aload         8
     502: bipush        12
     504: invokevirtual #186                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setKeyIdentifierType:(I)V
     507: goto          592
     510: aload         6
     512: instanceof    #41                 // class org/apache/wss4j/policy/model/UsernameToken
     515: ifeq          528
     518: aload         8
     520: ldc           #151                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
     522: invokevirtual #169                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setCustomReferenceValue:(Ljava/lang/String;)V
     525: goto          592
     528: aload         6
     530: instanceof    #32                 // class org/apache/wss4j/policy/model/KerberosToken
     533: ifeq          562
     536: aload_0
     537: invokevirtual #38                 // Method isRequestor:()Z
     540: ifne          562
     543: aload         8
     545: ldc           #131                // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#Kerberosv5APREQSHA1
     547: invokevirtual #169                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setCustomReferenceValue:(Ljava/lang/String;)V
     550: aload         8
     552: aload_2
     553: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     556: invokevirtual #170                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setEncKeyId:(Ljava/lang/String;)V
     559: goto          592
     562: aload_0
     563: invokevirtual #38                 // Method isRequestor:()Z
     566: ifne          592
     569: aload_2
     570: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     573: ifnull        592
     576: aload         8
     578: aload_2
     579: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     582: invokevirtual #169                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setCustomReferenceValue:(Ljava/lang/String;)V
     585: aload         8
     587: bipush        10
     589: invokevirtual #186                // Method org/apache/wss4j/dom/message/WSSecEncrypt.setKeyIdentifierType:(I)V
     592: aload         8
     594: aload_0
     595: getfield      #127                // Field saaj:Ljavax/xml/soap/SOAPMessage;
     598: invokevirtual #128                // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     601: aload         10
     603: invokevirtual #187                // Method org/apache/wss4j/dom/message/WSSecEncrypt.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;)V
     606: aload         8
     608: invokevirtual #188                // Method org/apache/wss4j/dom/message/WSSecEncrypt.getBSTTokenId:()Ljava/lang/String;
     611: ifnull        623
     614: aload         8
     616: aload_0
     617: getfield      #189                // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     620: invokevirtual #190                // Method org/apache/wss4j/dom/message/WSSecEncrypt.prependBSTElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     623: aload         8
     625: aconst_null
     626: aload         4
     628: invokevirtual #87                 // Method org/apache/wss4j/dom/message/WSSecEncrypt.encryptForRef:(Lorg/w3c/dom/Element;Ljava/util/List;)Lorg/w3c/dom/Element;
     631: astore        11
     633: aload         8
     635: invokevirtual #191                // Method org/apache/wss4j/dom/message/WSSecEncrypt.getAttachmentEncryptedDataElements:()Ljava/util/List;
     638: astore        12
     640: aload_0
     641: iload         5
     643: aload         11
     645: aload         12
     647: invokespecial #160                // Method addAttachmentsForEncryption:(ZLorg/w3c/dom/Element;Ljava/util/List;)V
     650: aload         8
     652: areturn
     653: astore        8
     655: getstatic     #90                 // Field LOG:Ljava/util/logging/Logger;
     658: getstatic     #91                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     661: aload         8
     663: invokevirtual #193                // Method org/apache/wss4j/common/ext/WSSecurityException.getMessage:()Ljava/lang/String;
     666: aload         8
     668: invokevirtual #93                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     671: aload_0
     672: aload_1
     673: aload         8
     675: invokevirtual #161                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/Exception;)V
     678: aconst_null
     679: areturn
    Exception table:
       from    to  target type
          72   652   653   Class org/apache/wss4j/common/ext/WSSecurityException

  private void addAttachmentsForEncryption(boolean, org.w3c.dom.Element, java.util.List<org.w3c.dom.Element>);
    Code:
       0: iload_1
       1: ifeq          59
       4: aload_2
       5: ifnull        13
       8: aload_0
       9: aload_2
      10: invokevirtual #194                // Method insertBeforeBottomUp:(Lorg/w3c/dom/Element;)V
      13: aload_3
      14: ifnull        111
      17: aload_3
      18: invokeinterface #195,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      23: astore        4
      25: aload         4
      27: invokeinterface #196,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      32: ifeq          56
      35: aload         4
      37: invokeinterface #197,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      42: checkcast     #198                // class org/w3c/dom/Element
      45: astore        5
      47: aload_0
      48: aload         5
      50: invokevirtual #194                // Method insertBeforeBottomUp:(Lorg/w3c/dom/Element;)V
      53: goto          25
      56: goto          111
      59: aload_2
      60: ifnull        68
      63: aload_0
      64: aload_2
      65: invokevirtual #88                 // Method addDerivedKeyElement:(Lorg/w3c/dom/Element;)V
      68: aload_3
      69: ifnull        111
      72: aload_3
      73: invokeinterface #195,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      78: astore        4
      80: aload         4
      82: invokeinterface #196,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      87: ifeq          111
      90: aload         4
      92: invokeinterface #197,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      97: checkcast     #198                // class org/w3c/dom/Element
     100: astore        5
     102: aload_0
     103: aload         5
     105: invokevirtual #88                 // Method addDerivedKeyElement:(Lorg/w3c/dom/Element;)V
     108: goto          80
     111: return

  private byte[] doSignatureDK(java.util.List<org.apache.wss4j.common.WSEncryptionPart>, org.apache.wss4j.policy.model.AbstractTokenWrapper, org.apache.wss4j.policy.model.AbstractToken, org.apache.cxf.ws.security.tokenstore.SecurityToken, boolean) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #127                // Field saaj:Ljavax/xml/soap/SOAPMessage;
       4: invokevirtual #128                // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
       7: astore        6
       9: new           #199                // class org/apache/wss4j/dom/message/WSSecDKSign
      12: dup
      13: invokespecial #200                // Method org/apache/wss4j/dom/message/WSSecDKSign."<init>":()V
      16: astore        7
      18: aload         7
      20: aload_0
      21: getfield      #107                // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      24: invokevirtual #108                // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      27: invokevirtual #201                // Method org/apache/wss4j/dom/message/WSSecDKSign.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      30: aload         7
      32: aload_0
      33: getfield      #110                // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      36: invokevirtual #202                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
      39: aload         7
      41: new           #112                // class org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler
      44: dup
      45: aload_0
      46: getfield      #113                // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      49: invokespecial #114                // Method org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler."<init>":(Lorg/apache/cxf/binding/soap/SoapMessage;)V
      52: invokevirtual #203                // Method org/apache/wss4j/dom/message/WSSecDKSign.setAttachmentCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
      55: aload         7
      57: aload_0
      58: getfield      #116                // Field storeBytesInAttachment:Z
      61: invokevirtual #204                // Method org/apache/wss4j/dom/message/WSSecDKSign.setStoreBytesInAttachment:(Z)V
      64: aload_2
      65: invokevirtual #30                 // Method org/apache/wss4j/policy/model/AbstractTokenWrapper.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
      68: invokevirtual #118                // Method org/apache/wss4j/policy/model/AbstractToken.getVersion:()Lorg/apache/wss4j/policy/SPConstants$SPVersion;
      71: getstatic     #119                // Field org/apache/wss4j/policy/SPConstants$SPVersion.SP11:Lorg/apache/wss4j/policy/SPConstants$SPVersion;
      74: if_acmpne     83
      77: aload         7
      79: iconst_1
      80: invokevirtual #205                // Method org/apache/wss4j/dom/message/WSSecDKSign.setWscVersion:(I)V
      83: iconst_0
      84: istore        8
      86: aload_0
      87: aload_3
      88: invokevirtual #48                 // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      91: invokevirtual #49                 // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      94: ifeq          100
      97: iconst_1
      98: istore        8
     100: iload         8
     102: ifeq          115
     105: aload         4
     107: invokevirtual #121                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getAttachedReference:()Lorg/w3c/dom/Element;
     110: astore        9
     112: goto          122
     115: aload         4
     117: invokevirtual #124                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getUnattachedReference:()Lorg/w3c/dom/Element;
     120: astore        9
     122: aload         9
     124: ifnull        146
     127: aload         7
     129: aload         4
     131: invokevirtual #122                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     134: aload_0
     135: aload         9
     137: invokevirtual #51                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     140: invokevirtual #206                // Method org/apache/wss4j/dom/message/WSSecDKSign.setExternalKey:([BLorg/w3c/dom/Element;)V
     143: goto          320
     146: aload_0
     147: invokevirtual #38                 // Method isRequestor:()Z
     150: ifne          273
     153: aload_3
     154: invokevirtual #82                 // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
     157: getstatic     #83                 // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
     160: if_acmpne     273
     163: aload         4
     165: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     168: ifnull        273
     171: new           #126                // class org/apache/wss4j/common/token/SecurityTokenReference
     174: dup
     175: aload         6
     177: invokespecial #129                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     180: astore        10
     182: aload         4
     184: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     187: ifnull        255
     190: aload         4
     192: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     195: astore        11
     197: aload_3
     198: instanceof    #32                 // class org/apache/wss4j/policy/model/KerberosToken
     201: ifeq          229
     204: aload         10
     206: ldc           #131                // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#Kerberosv5APREQSHA1
     208: aload         4
     210: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     213: iconst_1
     214: invokevirtual #132                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifier:(Ljava/lang/String;Ljava/lang/String;Z)V
     217: aload         11
     219: ifnonnull     248
     222: ldc           #133                // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#GSS_Kerberosv5_AP_REQ
     224: astore        11
     226: goto          248
     229: aload         10
     231: aload         4
     233: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     236: invokevirtual #134                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierEncKeySHA1:(Ljava/lang/String;)V
     239: aload         11
     241: ifnonnull     248
     244: ldc           #135                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     246: astore        11
     248: aload         10
     250: aload         11
     252: invokevirtual #136                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     255: aload         7
     257: aload         4
     259: invokevirtual #122                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     262: aload         10
     264: invokevirtual #137                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     267: invokevirtual #206                // Method org/apache/wss4j/dom/message/WSSecDKSign.setExternalKey:([BLorg/w3c/dom/Element;)V
     270: goto          320
     273: iload         8
     275: ifne          285
     278: aload_0
     279: invokevirtual #38                 // Method isRequestor:()Z
     282: ifeq          299
     285: aload_3
     286: instanceof    #33                 // class org/apache/wss4j/policy/model/SecureConversationToken
     289: ifne          299
     292: aload_3
     293: instanceof    #34                 // class org/apache/wss4j/policy/model/SecurityContextToken
     296: ifeq          305
     299: aload         7
     301: iconst_1
     302: invokevirtual #207                // Method org/apache/wss4j/dom/message/WSSecDKSign.setTokenIdDirectId:(Z)V
     305: aload         7
     307: aload         4
     309: invokevirtual #122                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     312: aload         4
     314: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     317: invokevirtual #208                // Method org/apache/wss4j/dom/message/WSSecDKSign.setExternalKey:([BLjava/lang/String;)V
     320: aload         7
     322: aload_0
     323: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     326: invokevirtual #23                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     329: invokevirtual #209                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
     332: invokevirtual #210                // Method org/apache/wss4j/dom/message/WSSecDKSign.setSignatureAlgorithm:(Ljava/lang/String;)V
     335: aload         7
     337: aload_0
     338: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     341: invokevirtual #23                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     344: invokevirtual #211                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     347: invokevirtual #212                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     350: invokevirtual #213                // Method org/apache/wss4j/dom/message/WSSecDKSign.setSigCanonicalization:(Ljava/lang/String;)V
     353: aload_0
     354: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     357: invokevirtual #23                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     360: invokevirtual #152                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     363: astore        10
     365: aload         7
     367: aload         10
     369: invokevirtual #214                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getDigest:()Ljava/lang/String;
     372: invokevirtual #215                // Method org/apache/wss4j/dom/message/WSSecDKSign.setDigestAlgorithm:(Ljava/lang/String;)V
     375: aload         7
     377: aload         10
     379: invokevirtual #216                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getSignatureDerivedKeyLength:()I
     382: bipush        8
     384: idiv
     385: invokevirtual #217                // Method org/apache/wss4j/dom/message/WSSecDKSign.setDerivedKeyLength:(I)V
     388: aload         4
     390: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     393: ifnull        422
     396: aload         4
     398: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     401: astore        11
     403: aload         11
     405: ifnonnull     412
     408: ldc           #135                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     410: astore        11
     412: aload         7
     414: aload         11
     416: invokevirtual #218                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCustomValueType:(Ljava/lang/String;)V
     419: goto          527
     422: aload         4
     424: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     427: astore        11
     429: ldc           #143                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     431: aload         11
     433: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     436: ifne          449
     439: ldc           #145                // String urn:oasis:names:tc:SAML:1.0:assertion
     441: aload         11
     443: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     446: ifeq          466
     449: aload         7
     451: bipush        12
     453: invokevirtual #219                // Method org/apache/wss4j/dom/message/WSSecDKSign.setKeyIdentifierType:(I)V
     456: aload         7
     458: ldc           #147                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     460: invokevirtual #218                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCustomValueType:(Ljava/lang/String;)V
     463: goto          527
     466: ldc           #148                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     468: aload         11
     470: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     473: ifne          486
     476: ldc           #149                // String urn:oasis:names:tc:SAML:2.0:assertion
     478: aload         11
     480: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     483: ifeq          503
     486: aload         7
     488: bipush        12
     490: invokevirtual #219                // Method org/apache/wss4j/dom/message/WSSecDKSign.setKeyIdentifierType:(I)V
     493: aload         7
     495: ldc           #150                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     497: invokevirtual #218                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCustomValueType:(Ljava/lang/String;)V
     500: goto          527
     503: aload_3
     504: instanceof    #41                 // class org/apache/wss4j/policy/model/UsernameToken
     507: ifeq          520
     510: aload         7
     512: ldc           #151                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
     514: invokevirtual #218                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCustomValueType:(Ljava/lang/String;)V
     517: goto          527
     520: aload         7
     522: aload         11
     524: invokevirtual #218                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCustomValueType:(Ljava/lang/String;)V
     527: aload         7
     529: aload         6
     531: aload_0
     532: getfield      #189                // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     535: invokevirtual #220                // Method org/apache/wss4j/dom/message/WSSecDKSign.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     538: aload_0
     539: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     542: invokevirtual #221                // Method org/apache/wss4j/policy/model/SymmetricBinding.isProtectTokens:()Z
     545: ifeq          636
     548: aload         4
     550: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     553: astore        11
     555: iload         5
     557: ifeq          597
     560: aload         4
     562: invokevirtual #138                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getWsuId:()Ljava/lang/String;
     565: astore        11
     567: aload         11
     569: ifnonnull     579
     572: aload         4
     574: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     577: astore        11
     579: aload         11
     581: ldc           #44                 // String #
     583: invokevirtual #45                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     586: ifeq          597
     589: aload         11
     591: iconst_1
     592: invokevirtual #46                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     595: astore        11
     597: aload_1
     598: new           #74                 // class org/apache/wss4j/common/WSEncryptionPart
     601: dup
     602: aload         11
     604: invokespecial #222                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
     607: invokeinterface #58,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     612: pop
     613: aload_0
     614: new           #16                 // class javax/xml/namespace/QName
     617: dup
     618: aload_0
     619: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     622: invokevirtual #12                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getName:()Ljavax/xml/namespace/QName;
     625: invokevirtual #17                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     628: ldc           #223                // String ProtectTokens
     630: invokespecial #19                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     633: invokevirtual #13                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     636: aload         7
     638: invokevirtual #224                // Method org/apache/wss4j/dom/message/WSSecDKSign.getParts:()Ljava/util/List;
     641: aload_1
     642: invokeinterface #61,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     647: pop
     648: aload         7
     650: aload_1
     651: aload_0
     652: getfield      #189                // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     655: invokevirtual #225                // Method org/apache/wss4j/dom/message/WSSecDKSign.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     658: astore        11
     660: aload         7
     662: invokevirtual #226                // Method org/apache/wss4j/dom/message/WSSecDKSign.getdktElement:()Lorg/w3c/dom/Element;
     665: astore        12
     667: aload_0
     668: aload         12
     670: invokevirtual #88                 // Method addDerivedKeyElement:(Lorg/w3c/dom/Element;)V
     673: aload_0
     674: getfield      #77                 // Field bottomUpElement:Lorg/w3c/dom/Element;
     677: ifnonnull     692
     680: aload         7
     682: aload         11
     684: iconst_0
     685: aconst_null
     686: invokevirtual #227                // Method org/apache/wss4j/dom/message/WSSecDKSign.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     689: goto          704
     692: aload         7
     694: aload         11
     696: iconst_1
     697: aload_0
     698: getfield      #77                 // Field bottomUpElement:Lorg/w3c/dom/Element;
     701: invokevirtual #227                // Method org/apache/wss4j/dom/message/WSSecDKSign.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     704: aload_0
     705: aload         7
     707: invokevirtual #228                // Method org/apache/wss4j/dom/message/WSSecDKSign.getSignatureElement:()Lorg/w3c/dom/Element;
     710: putfield      #77                 // Field bottomUpElement:Lorg/w3c/dom/Element;
     713: aload_0
     714: aload         7
     716: invokevirtual #229                // Method org/apache/wss4j/dom/message/WSSecDKSign.getSignatureId:()Ljava/lang/String;
     719: putfield      #73                 // Field mainSigId:Ljava/lang/String;
     722: aload         7
     724: invokevirtual #230                // Method org/apache/wss4j/dom/message/WSSecDKSign.getSignatureValue:()[B
     727: areturn

  private byte[] doSignature(java.util.List<org.apache.wss4j.common.WSEncryptionPart>, org.apache.wss4j.policy.model.AbstractTokenWrapper, org.apache.wss4j.policy.model.AbstractToken, org.apache.cxf.ws.security.tokenstore.SecurityToken, boolean) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_3
       1: invokevirtual #82                 // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
       4: getstatic     #83                 // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
       7: if_acmpne     22
      10: aload_0
      11: aload_1
      12: aload_2
      13: aload_3
      14: aload         4
      16: iload         5
      18: invokespecial #231                // Method doSignatureDK:(Ljava/util/List;Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;Z)[B
      21: areturn
      22: new           #232                // class org/apache/wss4j/dom/message/WSSecSignature
      25: dup
      26: invokespecial #233                // Method org/apache/wss4j/dom/message/WSSecSignature."<init>":()V
      29: astore        6
      31: aload         6
      33: aload_0
      34: getfield      #107                // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      37: invokevirtual #108                // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      40: invokevirtual #234                // Method org/apache/wss4j/dom/message/WSSecSignature.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      43: aload         6
      45: aload_0
      46: getfield      #110                // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      49: invokevirtual #235                // Method org/apache/wss4j/dom/message/WSSecSignature.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
      52: aload         6
      54: new           #112                // class org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler
      57: dup
      58: aload_0
      59: getfield      #113                // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      62: invokespecial #114                // Method org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler."<init>":(Lorg/apache/cxf/binding/soap/SoapMessage;)V
      65: invokevirtual #236                // Method org/apache/wss4j/dom/message/WSSecSignature.setAttachmentCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
      68: aload         6
      70: aload_0
      71: getfield      #116                // Field storeBytesInAttachment:Z
      74: invokevirtual #237                // Method org/apache/wss4j/dom/message/WSSecSignature.setStoreBytesInAttachment:(Z)V
      77: iload         5
      79: ifeq          87
      82: bipush        9
      84: goto          89
      87: bipush        11
      89: istore        7
      91: aload         4
      93: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
      96: astore        8
      98: aload_3
      99: instanceof    #37                 // class org/apache/wss4j/policy/model/X509Token
     102: ifeq          149
     105: aload_0
     106: invokevirtual #38                 // Method isRequestor:()Z
     109: ifeq          129
     112: aload         6
     114: ldc           #135                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     116: invokevirtual #238                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     119: aload         6
     121: iload         7
     123: invokevirtual #239                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     126: goto          392
     129: aload         6
     131: aload         4
     133: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     136: invokevirtual #240                // Method org/apache/wss4j/dom/message/WSSecSignature.setEncrKeySha1value:(Ljava/lang/String;)V
     139: aload         6
     141: bipush        10
     143: invokevirtual #239                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     146: goto          392
     149: aload_3
     150: instanceof    #41                 // class org/apache/wss4j/policy/model/UsernameToken
     153: ifeq          173
     156: aload         6
     158: ldc           #151                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
     160: invokevirtual #238                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     163: aload         6
     165: iload         7
     167: invokevirtual #239                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     170: goto          392
     173: aload_3
     174: instanceof    #32                 // class org/apache/wss4j/policy/model/KerberosToken
     177: ifeq          231
     180: aload_0
     181: invokevirtual #38                 // Method isRequestor:()Z
     184: ifeq          207
     187: aload         6
     189: aload         4
     191: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     194: invokevirtual #238                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     197: aload         6
     199: iload         7
     201: invokevirtual #239                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     204: goto          392
     207: aload         6
     209: ldc           #131                // String http://docs.oasis-open.org/wss/oasis-wss-kerberos-token-profile-1.1#Kerberosv5APREQSHA1
     211: invokevirtual #238                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     214: aload         6
     216: bipush        12
     218: invokevirtual #239                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     221: aload         4
     223: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     226: astore        8
     228: goto          392
     231: iload         5
     233: ifeq          246
     236: aload         4
     238: invokevirtual #121                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getAttachedReference:()Lorg/w3c/dom/Element;
     241: astore        9
     243: goto          253
     246: aload         4
     248: invokevirtual #124                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getUnattachedReference:()Lorg/w3c/dom/Element;
     251: astore        9
     253: aload         9
     255: ifnull        297
     258: new           #126                // class org/apache/wss4j/common/token/SecurityTokenReference
     261: dup
     262: aload_0
     263: aload         9
     265: invokevirtual #51                 // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     268: new           #182                // class org/apache/wss4j/common/bsp/BSPEnforcer
     271: dup
     272: invokespecial #183                // Method org/apache/wss4j/common/bsp/BSPEnforcer."<init>":()V
     275: invokespecial #184                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     278: astore        10
     280: aload         6
     282: aload         10
     284: invokevirtual #241                // Method org/apache/wss4j/dom/message/WSSecSignature.setSecurityTokenReference:(Lorg/apache/wss4j/common/token/SecurityTokenReference;)V
     287: aload         6
     289: bipush        12
     291: invokevirtual #239                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     294: goto          392
     297: aload         4
     299: invokevirtual #130                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     302: astore        10
     304: ldc           #143                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     306: aload         10
     308: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     311: ifne          324
     314: ldc           #145                // String urn:oasis:names:tc:SAML:1.0:assertion
     316: aload         10
     318: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     321: ifeq          341
     324: aload         6
     326: ldc           #147                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     328: invokevirtual #238                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     331: aload         6
     333: bipush        12
     335: invokevirtual #239                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     338: goto          392
     341: ldc           #148                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     343: aload         10
     345: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     348: ifne          361
     351: ldc           #149                // String urn:oasis:names:tc:SAML:2.0:assertion
     353: aload         10
     355: invokevirtual #144                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     358: ifeq          378
     361: aload         6
     363: ldc           #150                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     365: invokevirtual #238                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     368: aload         6
     370: bipush        12
     372: invokevirtual #239                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     375: goto          392
     378: aload         6
     380: aload         10
     382: invokevirtual #238                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     385: aload         6
     387: iload         7
     389: invokevirtual #239                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     392: iload         5
     394: ifeq          455
     397: aload         4
     399: invokevirtual #138                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getWsuId:()Ljava/lang/String;
     402: astore        8
     404: aload         8
     406: ifnonnull     437
     409: aload_3
     410: instanceof    #33                 // class org/apache/wss4j/policy/model/SecureConversationToken
     413: ifne          423
     416: aload_3
     417: instanceof    #34                 // class org/apache/wss4j/policy/model/SecurityContextToken
     420: ifeq          430
     423: aload         6
     425: bipush        11
     427: invokevirtual #239                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     430: aload         4
     432: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     435: astore        8
     437: aload         8
     439: ldc           #44                 // String #
     441: invokevirtual #45                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     444: ifeq          455
     447: aload         8
     449: iconst_1
     450: invokevirtual #46                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     453: astore        8
     455: aload_0
     456: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     459: invokevirtual #221                // Method org/apache/wss4j/policy/model/SymmetricBinding.isProtectTokens:()Z
     462: ifeq          509
     465: aload_0
     466: new           #16                 // class javax/xml/namespace/QName
     469: dup
     470: aload_0
     471: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     474: invokevirtual #12                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getName:()Ljavax/xml/namespace/QName;
     477: invokevirtual #17                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     480: ldc           #223                // String ProtectTokens
     482: invokespecial #19                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     485: invokevirtual #13                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     488: iload         5
     490: ifeq          509
     493: aload_1
     494: new           #74                 // class org/apache/wss4j/common/WSEncryptionPart
     497: dup
     498: aload         8
     500: invokespecial #222                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
     503: invokeinterface #58,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     508: pop
     509: aload         6
     511: aload         8
     513: invokevirtual #242                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenId:(Ljava/lang/String;)V
     516: aload         6
     518: aload         4
     520: invokevirtual #122                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     523: invokevirtual #243                // Method org/apache/wss4j/dom/message/WSSecSignature.setSecretKey:([B)V
     526: aload         6
     528: aload_0
     529: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     532: invokevirtual #23                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     535: invokevirtual #209                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
     538: invokevirtual #244                // Method org/apache/wss4j/dom/message/WSSecSignature.setSignatureAlgorithm:(Ljava/lang/String;)V
     541: aload_0
     542: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     545: invokevirtual #23                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     548: invokevirtual #152                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     551: astore        9
     553: aload         6
     555: aload         9
     557: invokevirtual #214                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getDigest:()Ljava/lang/String;
     560: invokevirtual #245                // Method org/apache/wss4j/dom/message/WSSecSignature.setDigestAlgo:(Ljava/lang/String;)V
     563: aload         6
     565: aload_0
     566: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     569: invokevirtual #23                 // Method org/apache/wss4j/policy/model/SymmetricBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     572: invokevirtual #211                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     575: invokevirtual #212                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     578: invokevirtual #246                // Method org/apache/wss4j/dom/message/WSSecSignature.setSigCanonicalization:(Ljava/lang/String;)V
     581: aconst_null
     582: astore        10
     584: aload_0
     585: getfield      #2                  // Field sbinding:Lorg/apache/wss4j/policy/model/SymmetricBinding;
     588: invokevirtual #7                  // Method org/apache/wss4j/policy/model/SymmetricBinding.getProtectionToken:()Lorg/apache/wss4j/policy/model/ProtectionToken;
     591: ifnull        603
     594: aload_0
     595: invokevirtual #172                // Method getEncryptionCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     598: astore        10
     600: goto          609
     603: aload_0
     604: invokevirtual #247                // Method getSignatureCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     607: astore        10
     609: aload_0
     610: getfield      #113                // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     613: invokevirtual #173                // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
     616: ldc           #248                // String security.signature.crypto
     618: aload         10
     620: invokeinterface #175,  3          // InterfaceMethod org/apache/cxf/message/Exchange.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     625: pop
     626: aload         6
     628: aload_0
     629: getfield      #127                // Field saaj:Ljavax/xml/soap/SOAPMessage;
     632: invokevirtual #128                // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     635: aload         10
     637: aload_0
     638: getfield      #189                // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     641: invokevirtual #249                // Method org/apache/wss4j/dom/message/WSSecSignature.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     644: aload         6
     646: invokevirtual #250                // Method org/apache/wss4j/dom/message/WSSecSignature.getParts:()Ljava/util/List;
     649: aload_1
     650: invokeinterface #61,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     655: pop
     656: aload         6
     658: aload_1
     659: aload_0
     660: getfield      #189                // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     663: invokevirtual #251                // Method org/apache/wss4j/dom/message/WSSecSignature.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     666: astore        11
     668: aload_0
     669: getfield      #77                 // Field bottomUpElement:Lorg/w3c/dom/Element;
     672: ifnonnull     687
     675: aload         6
     677: aload         11
     679: iconst_0
     680: aconst_null
     681: invokevirtual #252                // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     684: goto          699
     687: aload         6
     689: aload         11
     691: iconst_1
     692: aload_0
     693: getfield      #77                 // Field bottomUpElement:Lorg/w3c/dom/Element;
     696: invokevirtual #252                // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     699: aload_0
     700: aload         6
     702: invokevirtual #253                // Method org/apache/wss4j/dom/message/WSSecSignature.getSignatureElement:()Lorg/w3c/dom/Element;
     705: putfield      #77                 // Field bottomUpElement:Lorg/w3c/dom/Element;
     708: aload_0
     709: aload         6
     711: invokevirtual #254                // Method org/apache/wss4j/dom/message/WSSecSignature.getId:()Ljava/lang/String;
     714: putfield      #73                 // Field mainSigId:Ljava/lang/String;
     717: aload         6
     719: invokevirtual #255                // Method org/apache/wss4j/dom/message/WSSecSignature.getSignatureValue:()[B
     722: areturn

  private java.lang.String setupEncryptedKey(org.apache.wss4j.policy.model.AbstractTokenWrapper, org.apache.wss4j.policy.model.AbstractToken) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_2
       2: invokevirtual #256                // Method getEncryptedKeyBuilder:(Lorg/apache/wss4j/policy/model/AbstractToken;)Lorg/apache/wss4j/dom/message/WSSecEncryptedKey;
       5: astore_3
       6: aload_0
       7: aload_1
       8: invokevirtual #29                 // Method assertTokenWrapper:(Lorg/apache/wss4j/policy/model/AbstractTokenWrapper;)V
      11: aload_3
      12: invokevirtual #257                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.getId:()Ljava/lang/String;
      15: astore        4
      17: aload_3
      18: invokevirtual #258                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.getEphemeralKey:()[B
      21: astore        5
      23: new           #259                // class java/util/Date
      26: dup
      27: invokespecial #260                // Method java/util/Date."<init>":()V
      30: astore        6
      32: new           #259                // class java/util/Date
      35: dup
      36: invokespecial #260                // Method java/util/Date."<init>":()V
      39: astore        7
      41: aload         7
      43: aload         6
      45: invokevirtual #261                // Method java/util/Date.getTime:()J
      48: ldc2_w        #262                // long 300000l
      51: ladd
      52: invokevirtual #264                // Method java/util/Date.setTime:(J)V
      55: new           #265                // class org/apache/cxf/ws/security/tokenstore/SecurityToken
      58: dup
      59: aload         4
      61: aload_3
      62: invokevirtual #266                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.getEncryptedKeyElement:()Lorg/w3c/dom/Element;
      65: aload         6
      67: aload         7
      69: invokespecial #267                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;Lorg/w3c/dom/Element;Ljava/util/Date;Ljava/util/Date;)V
      72: astore        8
      74: aload         8
      76: aload         5
      78: invokevirtual #268                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
      81: aload         8
      83: aload_3
      84: invokevirtual #269                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.getEncryptedEphemeralKey:()[B
      87: invokestatic  #270                // Method getSHA1:([B)Ljava/lang/String;
      90: invokevirtual #271                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSHA1:(Ljava/lang/String;)V
      93: aload_0
      94: getfield      #4                  // Field tokenStore:Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      97: aload         8
      99: invokeinterface #272,  2          // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.add:(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
     104: aload_0
     105: getfield      #4                  // Field tokenStore:Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     108: aload         8
     110: invokevirtual #125                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     113: aload         8
     115: invokeinterface #273,  3          // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.add:(Ljava/lang/String;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
     120: aload_3
     121: invokevirtual #274                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.getBSTTokenId:()Ljava/lang/String;
     124: astore        9
     126: aload         9
     128: ifnull        147
     131: aload         9
     133: invokevirtual #275                // Method java/lang/String.length:()I
     136: ifle          147
     139: aload_3
     140: aload_0
     141: getfield      #189                // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     144: invokevirtual #276                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.prependBSTElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     147: aload         4
     149: areturn

  private static java.lang.String getSHA1(byte[]);
    Code:
       0: aload_0
       1: invokestatic  #277                // Method org/apache/wss4j/common/util/KeyUtils.generateDigest:([B)[B
       4: astore_1
       5: aload_1
       6: invokestatic  #278                // Method org/apache/xml/security/utils/Base64.encode:([B)Ljava/lang/String;
       9: areturn
      10: astore_1
      11: aconst_null
      12: areturn
    Exception table:
       from    to  target type
           0     9    10   Class org/apache/wss4j/common/ext/WSSecurityException

  private java.lang.String setupUTDerivedKey(org.apache.wss4j.policy.model.UsernameToken) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: invokespecial #279                // Method hasSignedPartsOrElements:()Z
       4: istore_2
       5: aload_0
       6: aload_1
       7: iload_2
       8: invokevirtual #280                // Method addDKUsernameToken:(Lorg/apache/wss4j/policy/model/UsernameToken;Z)Lorg/apache/wss4j/dom/message/WSSecUsernameToken;
      11: astore_3
      12: aload_3
      13: invokevirtual #281                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getId:()Ljava/lang/String;
      16: astore        4
      18: aload_3
      19: invokevirtual #282                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getDerivedKey:()[B
      22: astore        5
      24: new           #259                // class java/util/Date
      27: dup
      28: invokespecial #260                // Method java/util/Date."<init>":()V
      31: astore        6
      33: new           #259                // class java/util/Date
      36: dup
      37: invokespecial #260                // Method java/util/Date."<init>":()V
      40: astore        7
      42: aload         7
      44: aload         6
      46: invokevirtual #261                // Method java/util/Date.getTime:()J
      49: ldc2_w        #262                // long 300000l
      52: ladd
      53: invokevirtual #264                // Method java/util/Date.setTime:(J)V
      56: new           #265                // class org/apache/cxf/ws/security/tokenstore/SecurityToken
      59: dup
      60: aload         4
      62: aload_3
      63: invokevirtual #283                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getUsernameTokenElement:()Lorg/w3c/dom/Element;
      66: aload         6
      68: aload         7
      70: invokespecial #267                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;Lorg/w3c/dom/Element;Ljava/util/Date;Ljava/util/Date;)V
      73: astore        8
      75: aload         8
      77: aload         5
      79: invokevirtual #268                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
      82: aload_0
      83: getfield      #4                  // Field tokenStore:Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      86: aload         8
      88: invokeinterface #272,  2          // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.add:(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
      93: aload         4
      95: areturn

  private java.lang.String getEncryptedKey();
    Code:
       0: aload_0
       1: invokevirtual #284                // Method getEncryptedKeyResult:()Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;
       4: astore_1
       5: aload_1
       6: ifnull        115
       9: new           #259                // class java/util/Date
      12: dup
      13: invokespecial #260                // Method java/util/Date."<init>":()V
      16: astore_2
      17: new           #259                // class java/util/Date
      20: dup
      21: invokespecial #260                // Method java/util/Date."<init>":()V
      24: astore_3
      25: aload_3
      26: aload_2
      27: invokevirtual #261                // Method java/util/Date.getTime:()J
      30: ldc2_w        #262                // long 300000l
      33: ladd
      34: invokevirtual #264                // Method java/util/Date.setTime:(J)V
      37: aload_1
      38: ldc_w         #285                // String id
      41: invokevirtual #286                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      44: checkcast     #287                // class java/lang/String
      47: astore        4
      49: new           #265                // class org/apache/cxf/ws/security/tokenstore/SecurityToken
      52: dup
      53: aload         4
      55: aload_2
      56: aload_3
      57: invokespecial #288                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;Ljava/util/Date;Ljava/util/Date;)V
      60: astore        5
      62: aload         5
      64: aload_1
      65: ldc_w         #289                // String secret
      68: invokevirtual #286                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      71: checkcast     #290                // class "[B"
      74: checkcast     #290                // class "[B"
      77: invokevirtual #268                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
      80: aload         5
      82: aload_1
      83: ldc_w         #291                // String encrypted-ephemeral-key-bytes
      86: invokevirtual #286                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      89: checkcast     #290                // class "[B"
      92: checkcast     #290                // class "[B"
      95: invokestatic  #270                // Method getSHA1:([B)Ljava/lang/String;
      98: invokevirtual #271                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSHA1:(Ljava/lang/String;)V
     101: aload_0
     102: getfield      #4                  // Field tokenStore:Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     105: aload         5
     107: invokeinterface #272,  2          // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.add:(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
     112: aload         4
     114: areturn
     115: aconst_null
     116: areturn

  private java.lang.String getUTDerivedKey() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #113                // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       4: invokevirtual #173                // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
       7: invokeinterface #292,  1          // InterfaceMethod org/apache/cxf/message/Exchange.getInMessage:()Lorg/apache/cxf/message/Message;
      12: ldc_w         #293                // String RECV_RESULTS
      15: invokeinterface #294,  2          // InterfaceMethod org/apache/cxf/message/Message.get:(Ljava/lang/Object;)Ljava/lang/Object;
      20: checkcast     #295                // class java/util/List
      23: invokestatic  #296                // Method org/apache/cxf/helpers/CastUtils.cast:(Ljava/util/List;)Ljava/util/List;
      26: astore_1
      27: aload_1
      28: invokeinterface #195,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      33: astore_2
      34: aload_2
      35: invokeinterface #196,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      40: ifeq          240
      43: aload_2
      44: invokeinterface #197,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      49: checkcast     #297                // class org/apache/wss4j/dom/handler/WSHandlerResult
      52: astore_3
      53: aload_3
      54: invokevirtual #298                // Method org/apache/wss4j/dom/handler/WSHandlerResult.getActionResults:()Ljava/util/Map;
      57: sipush        8192
      60: invokestatic  #299                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      63: invokeinterface #300,  2          // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      68: checkcast     #295                // class java/util/List
      71: astore        4
      73: aload         4
      75: ifnull        237
      78: aload         4
      80: invokeinterface #195,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      85: astore        5
      87: aload         5
      89: invokeinterface #196,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      94: ifeq          237
      97: aload         5
      99: invokeinterface #197,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     104: checkcast     #301                // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     107: astore        6
     109: aload         6
     111: ldc_w         #285                // String id
     114: invokevirtual #286                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     117: checkcast     #287                // class java/lang/String
     120: astore        7
     122: aload         7
     124: ifnull        135
     127: aload         7
     129: invokevirtual #275                // Method java/lang/String.length:()I
     132: ifne          153
     135: aload_0
     136: getfield      #107                // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
     139: invokevirtual #108                // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     142: ldc_w         #302                // String UsernameToken-
     145: aconst_null
     146: invokeinterface #303,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     151: astore        7
     153: new           #259                // class java/util/Date
     156: dup
     157: invokespecial #260                // Method java/util/Date."<init>":()V
     160: astore        8
     162: new           #259                // class java/util/Date
     165: dup
     166: invokespecial #260                // Method java/util/Date."<init>":()V
     169: astore        9
     171: aload         9
     173: aload         8
     175: invokevirtual #261                // Method java/util/Date.getTime:()J
     178: ldc2_w        #262                // long 300000l
     181: ladd
     182: invokevirtual #264                // Method java/util/Date.setTime:(J)V
     185: new           #265                // class org/apache/cxf/ws/security/tokenstore/SecurityToken
     188: dup
     189: aload         7
     191: aload         8
     193: aload         9
     195: invokespecial #288                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;Ljava/util/Date;Ljava/util/Date;)V
     198: astore        10
     200: aload         6
     202: ldc_w         #289                // String secret
     205: invokevirtual #286                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     208: checkcast     #290                // class "[B"
     211: checkcast     #290                // class "[B"
     214: astore        11
     216: aload         10
     218: aload         11
     220: invokevirtual #268                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
     223: aload_0
     224: getfield      #4                  // Field tokenStore:Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     227: aload         10
     229: invokeinterface #272,  2          // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.add:(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
     234: aload         7
     236: areturn
     237: goto          34
     240: aconst_null
     241: areturn

  private boolean hasSignedPartsOrElements();
    Code:
       0: aload_0
       1: getfield      #304                // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
       4: ldc_w         #305                // String SignedParts
       7: invokestatic  #306                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getFirstAssertionByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Lorg/apache/cxf/ws/policy/AssertionInfo;
      10: ifnonnull     26
      13: aload_0
      14: getfield      #304                // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
      17: ldc_w         #307                // String SignedElements
      20: invokestatic  #306                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getFirstAssertionByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Lorg/apache/cxf/ws/policy/AssertionInfo;
      23: ifnull        30
      26: iconst_1
      27: goto          31
      30: iconst_0
      31: ireturn
}
