Compiled from "AbstractBindingBuilder.java"
public abstract class org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder extends org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractCommonBindingHandler {
  public static final java.lang.String CRYPTO_CACHE;

  protected static final java.util.logging.Logger LOG;

  protected org.apache.wss4j.policy.model.AbstractSymmetricAsymmetricBinding$ProtectionOrder protectionOrder;

  protected final org.apache.wss4j.dom.engine.WSSConfig wssConfig;

  protected javax.xml.soap.SOAPMessage saaj;

  protected org.apache.wss4j.dom.message.WSSecHeader secHeader;

  protected org.apache.cxf.ws.policy.AssertionInfoMap aim;

  protected org.apache.wss4j.policy.model.AbstractBinding binding;

  protected org.apache.wss4j.dom.message.WSSecTimestamp timestampEl;

  protected java.lang.String mainSigId;

  protected java.util.List<org.apache.wss4j.common.WSEncryptionPart> sigConfList;

  protected java.util.Set<org.apache.wss4j.common.WSEncryptionPart> encryptedTokensList;

  protected java.util.Set<java.lang.Integer> signatures;

  protected org.w3c.dom.Element bottomUpElement;

  protected org.w3c.dom.Element topDownElement;

  protected org.w3c.dom.Element bstElement;

  protected org.w3c.dom.Element lastEncryptedKeyElement;

  protected final org.apache.wss4j.dom.callback.CallbackLookup callbackLookup;

  protected boolean storeBytesInAttachment;

  private org.w3c.dom.Element lastSupportingTokenElement;

  private org.w3c.dom.Element lastDerivedKeyElement;

  private java.util.List<org.apache.wss4j.policy.model.AbstractSecurityAssertion> suppTokenParts;

  private java.util.List<org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder$SupportingToken> endSuppTokList;

  private java.util.List<org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder$SupportingToken> sgndEndSuppTokList;

  public org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder(org.apache.wss4j.dom.engine.WSSConfig, org.apache.wss4j.policy.model.AbstractBinding, javax.xml.soap.SOAPMessage, org.apache.wss4j.dom.message.WSSecHeader, org.apache.cxf.ws.policy.AssertionInfoMap, org.apache.cxf.binding.soap.SoapMessage) throws javax.xml.soap.SOAPException;
    Code:
       0: aload_0
       1: aload         6
       3: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractCommonBindingHandler."<init>":(Lorg/apache/cxf/binding/soap/SoapMessage;)V
       6: aload_0
       7: getstatic     #2                  // Field org/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder.SignBeforeEncrypting:Lorg/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder;
      10: putfield      #3                  // Field protectionOrder:Lorg/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder;
      13: aload_0
      14: new           #4                  // class java/util/HashSet
      17: dup
      18: invokespecial #5                  // Method java/util/HashSet."<init>":()V
      21: putfield      #6                  // Field encryptedTokensList:Ljava/util/Set;
      24: aload_0
      25: new           #4                  // class java/util/HashSet
      28: dup
      29: invokespecial #5                  // Method java/util/HashSet."<init>":()V
      32: putfield      #7                  // Field signatures:Ljava/util/Set;
      35: aload_0
      36: new           #8                  // class java/util/ArrayList
      39: dup
      40: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
      43: putfield      #10                 // Field suppTokenParts:Ljava/util/List;
      46: aload_0
      47: aload_1
      48: putfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      51: aload_0
      52: aload_2
      53: putfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      56: aload_0
      57: aload         5
      59: putfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
      62: aload_0
      63: aload         4
      65: putfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      68: aload_0
      69: aload_3
      70: putfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
      73: aload         6
      75: invokevirtual #16                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
      78: ldc           #17                 // String _sendSignatureValues_
      80: aload_0
      81: getfield      #7                  // Field signatures:Ljava/util/Set;
      84: invokeinterface #18,  3           // InterfaceMethod org/apache/cxf/message/Exchange.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      89: pop
      90: aload         6
      92: ldc           #19                 // String ws-security.store.bytes.in.attachment
      94: iconst_1
      95: invokestatic  #20                 // Method org/apache/cxf/message/MessageUtils.getContextualBoolean:(Lorg/apache/cxf/message/Message;Ljava/lang/String;Z)Z
      98: istore        7
     100: iload         7
     102: ifeq          161
     105: aload         6
     107: invokestatic  #21                 // Method org/apache/cxf/attachment/AttachmentUtil.isMtomEnabled:(Lorg/apache/cxf/message/Message;)Z
     110: ifeq          161
     113: aload_0
     114: iconst_1
     115: putfield      #22                 // Field storeBytesInAttachment:Z
     118: aload_2
     119: instanceof    #23                 // class org/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding
     122: ifeq          138
     125: getstatic     #24                 // Field org/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder.EncryptBeforeSigning:Lorg/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder;
     128: aload_2
     129: checkcast     #23                 // class org/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding
     132: invokevirtual #25                 // Method org/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding.getProtectionOrder:()Lorg/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding$ProtectionOrder;
     135: if_acmpeq     148
     138: aload_2
     139: checkcast     #23                 // class org/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding
     142: invokevirtual #26                 // Method org/apache/wss4j/policy/model/AbstractSymmetricAsymmetricBinding.isProtectTokens:()Z
     145: ifeq          161
     148: getstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
     151: ldc           #28                 // String Disabling SecurityConstants.STORE_BYTES_IN_ATTACHMENT due to EncryptBeforeSigning or ProtectTokens policy.
     153: invokevirtual #29                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
     156: aload_0
     157: iconst_0
     158: putfield      #22                 // Field storeBytesInAttachment:Z
     161: aload_3
     162: invokestatic  #30                 // Method org/apache/cxf/binding/soap/saaj/SAAJUtils.getBody:(Ljavax/xml/soap/SOAPMessage;)Ljavax/xml/soap/SOAPBody;
     165: astore        8
     167: aload         8
     169: ifnull        195
     172: aload_0
     173: new           #31                 // class org/apache/cxf/ws/security/wss4j/CXFCallbackLookup
     176: dup
     177: aload         8
     179: invokeinterface #32,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     184: aload         8
     186: invokespecial #33                 // Method org/apache/cxf/ws/security/wss4j/CXFCallbackLookup."<init>":(Lorg/w3c/dom/Document;Lorg/w3c/dom/Element;)V
     189: putfield      #34                 // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
     192: goto          200
     195: aload_0
     196: aconst_null
     197: putfield      #34                 // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
     200: return

  protected void insertAfter(org.w3c.dom.Element, org.w3c.dom.Element);
    Code:
       0: aload_2
       1: invokeinterface #35,  1           // InterfaceMethod org/w3c/dom/Element.getNextSibling:()Lorg/w3c/dom/Node;
       6: ifnonnull     26
       9: aload_0
      10: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      13: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      16: aload_1
      17: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      22: pop
      23: goto          46
      26: aload_0
      27: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      30: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      33: aload_1
      34: aload_2
      35: invokeinterface #35,  1           // InterfaceMethod org/w3c/dom/Element.getNextSibling:()Lorg/w3c/dom/Node;
      40: invokeinterface #38,  3           // InterfaceMethod org/w3c/dom/Element.insertBefore:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      45: pop
      46: return

  protected void addDerivedKeyElement(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: getfield      #39                 // Field lastDerivedKeyElement:Lorg/w3c/dom/Element;
       4: ifnull        19
       7: aload_0
       8: aload_1
       9: aload_0
      10: getfield      #39                 // Field lastDerivedKeyElement:Lorg/w3c/dom/Element;
      13: invokevirtual #40                 // Method insertAfter:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)V
      16: goto          115
      19: aload_0
      20: getfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
      23: ifnull        38
      26: aload_0
      27: aload_1
      28: aload_0
      29: getfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
      32: invokevirtual #40                 // Method insertAfter:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)V
      35: goto          115
      38: aload_0
      39: getfield      #42                 // Field topDownElement:Lorg/w3c/dom/Element;
      42: ifnull        57
      45: aload_0
      46: aload_1
      47: aload_0
      48: getfield      #42                 // Field topDownElement:Lorg/w3c/dom/Element;
      51: invokevirtual #40                 // Method insertAfter:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)V
      54: goto          115
      57: aload_0
      58: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      61: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      64: invokeinterface #43,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      69: ifnull        101
      72: aload_0
      73: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      76: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      79: aload_1
      80: aload_0
      81: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      84: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      87: invokeinterface #43,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      92: invokeinterface #38,  3           // InterfaceMethod org/w3c/dom/Element.insertBefore:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      97: pop
      98: goto          115
     101: aload_0
     102: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     105: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     108: aload_1
     109: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     114: pop
     115: aload_0
     116: aload_1
     117: putfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
     120: return

  protected void addEncryptedKeyElement(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: getfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
       4: ifnull        19
       7: aload_0
       8: aload_1
       9: aload_0
      10: getfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
      13: invokevirtual #40                 // Method insertAfter:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)V
      16: goto          124
      19: aload_0
      20: getfield      #39                 // Field lastDerivedKeyElement:Lorg/w3c/dom/Element;
      23: ifnull        47
      26: aload_0
      27: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      30: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      33: aload_1
      34: aload_0
      35: getfield      #39                 // Field lastDerivedKeyElement:Lorg/w3c/dom/Element;
      38: invokeinterface #38,  3           // InterfaceMethod org/w3c/dom/Element.insertBefore:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      43: pop
      44: goto          124
      47: aload_0
      48: getfield      #42                 // Field topDownElement:Lorg/w3c/dom/Element;
      51: ifnull        66
      54: aload_0
      55: aload_1
      56: aload_0
      57: getfield      #42                 // Field topDownElement:Lorg/w3c/dom/Element;
      60: invokevirtual #40                 // Method insertAfter:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)V
      63: goto          124
      66: aload_0
      67: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      70: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      73: invokeinterface #43,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      78: ifnull        110
      81: aload_0
      82: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      85: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      88: aload_1
      89: aload_0
      90: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      93: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      96: invokeinterface #43,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
     101: invokeinterface #38,  3           // InterfaceMethod org/w3c/dom/Element.insertBefore:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     106: pop
     107: goto          124
     110: aload_0
     111: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     114: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     117: aload_1
     118: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     123: pop
     124: aload_0
     125: aload_1
     126: putfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
     129: return

  protected void addSupportingElement(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: getfield      #44                 // Field lastSupportingTokenElement:Lorg/w3c/dom/Element;
       4: ifnull        19
       7: aload_0
       8: aload_1
       9: aload_0
      10: getfield      #44                 // Field lastSupportingTokenElement:Lorg/w3c/dom/Element;
      13: invokevirtual #40                 // Method insertAfter:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)V
      16: goto          118
      19: aload_0
      20: getfield      #39                 // Field lastDerivedKeyElement:Lorg/w3c/dom/Element;
      23: ifnull        38
      26: aload_0
      27: aload_1
      28: aload_0
      29: getfield      #39                 // Field lastDerivedKeyElement:Lorg/w3c/dom/Element;
      32: invokevirtual #40                 // Method insertAfter:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)V
      35: goto          118
      38: aload_0
      39: getfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
      42: ifnull        57
      45: aload_0
      46: aload_1
      47: aload_0
      48: getfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
      51: invokevirtual #40                 // Method insertAfter:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)V
      54: goto          118
      57: aload_0
      58: getfield      #42                 // Field topDownElement:Lorg/w3c/dom/Element;
      61: ifnull        76
      64: aload_0
      65: aload_1
      66: aload_0
      67: getfield      #42                 // Field topDownElement:Lorg/w3c/dom/Element;
      70: invokevirtual #40                 // Method insertAfter:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)V
      73: goto          118
      76: aload_0
      77: getfield      #45                 // Field bottomUpElement:Lorg/w3c/dom/Element;
      80: ifnull        104
      83: aload_0
      84: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      87: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      90: aload_1
      91: aload_0
      92: getfield      #45                 // Field bottomUpElement:Lorg/w3c/dom/Element;
      95: invokeinterface #38,  3           // InterfaceMethod org/w3c/dom/Element.insertBefore:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     100: pop
     101: goto          118
     104: aload_0
     105: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     108: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     111: aload_1
     112: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     117: pop
     118: aload_0
     119: aload_1
     120: putfield      #44                 // Field lastSupportingTokenElement:Lorg/w3c/dom/Element;
     123: return

  protected void insertBeforeBottomUp(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: getfield      #45                 // Field bottomUpElement:Lorg/w3c/dom/Element;
       4: ifnonnull     24
       7: aload_0
       8: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      11: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      14: aload_1
      15: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      20: pop
      21: goto          42
      24: aload_0
      25: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      28: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      31: aload_1
      32: aload_0
      33: getfield      #45                 // Field bottomUpElement:Lorg/w3c/dom/Element;
      36: invokeinterface #38,  3           // InterfaceMethod org/w3c/dom/Element.insertBefore:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      41: pop
      42: aload_0
      43: aload_1
      44: putfield      #45                 // Field bottomUpElement:Lorg/w3c/dom/Element;
      47: return

  protected void addTopDownElement(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: getfield      #42                 // Field topDownElement:Lorg/w3c/dom/Element;
       4: ifnonnull     68
       7: aload_0
       8: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      11: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      14: invokeinterface #43,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      19: ifnonnull     39
      22: aload_0
      23: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      26: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      29: aload_1
      30: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      35: pop
      36: goto          77
      39: aload_0
      40: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      43: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      46: aload_1
      47: aload_0
      48: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      51: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      54: invokeinterface #43,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      59: invokeinterface #38,  3           // InterfaceMethod org/w3c/dom/Element.insertBefore:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      64: pop
      65: goto          77
      68: aload_0
      69: aload_1
      70: aload_0
      71: getfield      #42                 // Field topDownElement:Lorg/w3c/dom/Element;
      74: invokevirtual #40                 // Method insertAfter:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)V
      77: aload_0
      78: aload_1
      79: putfield      #42                 // Field topDownElement:Lorg/w3c/dom/Element;
      82: return

  protected final java.util.Map<java.lang.Object, org.apache.wss4j.common.crypto.Crypto> getCryptoCache();
    Code:
       0: aload_0
       1: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       4: invokevirtual #16                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
       7: invokeinterface #47,  1           // InterfaceMethod org/apache/cxf/message/Exchange.getEndpoint:()Lorg/apache/cxf/endpoint/Endpoint;
      12: invokeinterface #48,  1           // InterfaceMethod org/apache/cxf/endpoint/Endpoint.getEndpointInfo:()Lorg/apache/cxf/service/model/EndpointInfo;
      17: astore_1
      18: aload_1
      19: dup
      20: astore_2
      21: monitorenter
      22: aload_0
      23: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      26: ldc           #49                 // String ws-security.crypto.cache
      28: invokevirtual #50                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      31: checkcast     #51                 // class java/util/Map
      34: invokestatic  #52                 // Method org/apache/cxf/helpers/CastUtils.cast:(Ljava/util/Map;)Ljava/util/Map;
      37: astore_3
      38: aload_3
      39: ifnonnull     57
      42: new           #53                 // class java/util/concurrent/ConcurrentHashMap
      45: dup
      46: invokespecial #54                 // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      49: astore_3
      50: aload_1
      51: ldc           #49                 // String ws-security.crypto.cache
      53: aload_3
      54: invokevirtual #55                 // Method org/apache/cxf/service/model/EndpointInfo.setProperty:(Ljava/lang/String;Ljava/lang/Object;)V
      57: aload_3
      58: aload_2
      59: monitorexit
      60: areturn
      61: astore        4
      63: aload_2
      64: monitorexit
      65: aload         4
      67: athrow
    Exception table:
       from    to  target type
          22    60    61   any
          61    65    61   any

  protected final org.apache.cxf.ws.security.tokenstore.TokenStore getTokenStore();
    Code:
       0: aload_0
       1: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       4: invokestatic  #56                 // Method org/apache/cxf/ws/security/tokenstore/TokenStoreUtils.getTokenStore:(Lorg/apache/cxf/message/Message;)Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
       7: areturn

  protected org.apache.wss4j.dom.message.WSSecTimestamp createTimestamp();
    Code:
       0: aload_0
       1: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
       4: invokevirtual #57                 // Method org/apache/wss4j/policy/model/AbstractBinding.isIncludeTimestamp:()Z
       7: ifeq          155
      10: aload_0
      11: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      14: ldc           #58                 // String ws-security.timestamp.timeToLive
      16: invokevirtual #50                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      19: astore_1
      20: sipush        300
      23: istore_2
      24: aload_1
      25: instanceof    #59                 // class java/lang/Number
      28: ifeq          42
      31: aload_1
      32: checkcast     #59                 // class java/lang/Number
      35: invokevirtual #60                 // Method java/lang/Number.intValue:()I
      38: istore_2
      39: goto          57
      42: aload_1
      43: instanceof    #61                 // class java/lang/String
      46: ifeq          57
      49: aload_1
      50: checkcast     #61                 // class java/lang/String
      53: invokestatic  #62                 // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
      56: istore_2
      57: iload_2
      58: ifgt          65
      61: sipush        300
      64: istore_2
      65: aload_0
      66: new           #63                 // class org/apache/wss4j/dom/message/WSSecTimestamp
      69: dup
      70: invokespecial #64                 // Method org/apache/wss4j/dom/message/WSSecTimestamp."<init>":()V
      73: putfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
      76: aload_0
      77: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
      80: aload_0
      81: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      84: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      87: invokevirtual #67                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      90: aload_0
      91: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
      94: aload_0
      95: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      98: invokevirtual #68                 // Method org/apache/wss4j/dom/engine/WSSConfig.getCurrentTime:()Lorg/apache/wss4j/common/util/WSTimeSource;
     101: invokevirtual #69                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.setWsTimeSource:(Lorg/apache/wss4j/common/util/WSTimeSource;)V
     104: aload_0
     105: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     108: iload_2
     109: invokevirtual #70                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.setTimeToLive:(I)V
     112: aload_0
     113: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     116: aload_0
     117: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     120: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     123: invokevirtual #72                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.prepare:(Lorg/w3c/dom/Document;)V
     126: aload_0
     127: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     130: invokevirtual #73                 // Method org/apache/wss4j/policy/model/AbstractBinding.getName:()Ljavax/xml/namespace/QName;
     133: invokevirtual #74                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     136: astore_3
     137: aload_0
     138: getfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
     141: new           #75                 // class javax/xml/namespace/QName
     144: dup
     145: aload_3
     146: ldc           #76                 // String IncludeTimestamp
     148: invokespecial #77                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     151: invokestatic  #78                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
     154: pop
     155: aload_0
     156: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     159: areturn

  protected org.apache.wss4j.dom.message.WSSecTimestamp handleLayout(org.apache.wss4j.dom.message.WSSecTimestamp);
    Code:
       0: aload_0
       1: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
       4: invokevirtual #79                 // Method org/apache/wss4j/policy/model/AbstractBinding.getLayout:()Lorg/apache/wss4j/policy/model/Layout;
       7: ifnull        282
      10: aload_0
      11: getfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
      14: ldc           #80                 // String Layout
      16: invokestatic  #81                 // Method org/apache/cxf/ws/security/policy/PolicyUtils.getFirstAssertionByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Lorg/apache/cxf/ws/policy/AssertionInfo;
      19: astore_2
      20: aload_0
      21: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      24: invokevirtual #79                 // Method org/apache/wss4j/policy/model/AbstractBinding.getLayout:()Lorg/apache/wss4j/policy/model/Layout;
      27: invokevirtual #82                 // Method org/apache/wss4j/policy/model/Layout.getLayoutType:()Lorg/apache/wss4j/policy/model/Layout$LayoutType;
      30: getstatic     #83                 // Field org/apache/wss4j/policy/model/Layout$LayoutType.LaxTsLast:Lorg/apache/wss4j/policy/model/Layout$LayoutType;
      33: if_acmpne     114
      36: aload_1
      37: ifnonnull     49
      40: aload_2
      41: ldc           #84                 // String LaxTsLast requires a timestamp
      43: invokevirtual #85                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
      46: goto          227
      49: aload_2
      50: iconst_1
      51: invokevirtual #86                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      54: aload_0
      55: new           #75                 // class javax/xml/namespace/QName
      58: dup
      59: aload_0
      60: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      63: invokevirtual #79                 // Method org/apache/wss4j/policy/model/AbstractBinding.getLayout:()Lorg/apache/wss4j/policy/model/Layout;
      66: invokevirtual #87                 // Method org/apache/wss4j/policy/model/Layout.getName:()Ljavax/xml/namespace/QName;
      69: invokevirtual #74                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
      72: ldc           #88                 // String LaxTsLast
      74: invokespecial #77                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      77: invokevirtual #89                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
      80: aload_1
      81: invokevirtual #90                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
      84: astore_3
      85: aload_0
      86: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      89: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      92: aload_3
      93: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
      98: pop
      99: aload_0
     100: getfield      #45                 // Field bottomUpElement:Lorg/w3c/dom/Element;
     103: ifnonnull     111
     106: aload_0
     107: aload_3
     108: putfield      #45                 // Field bottomUpElement:Lorg/w3c/dom/Element;
     111: goto          227
     114: aload_0
     115: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     118: invokevirtual #79                 // Method org/apache/wss4j/policy/model/AbstractBinding.getLayout:()Lorg/apache/wss4j/policy/model/Layout;
     121: invokevirtual #82                 // Method org/apache/wss4j/policy/model/Layout.getLayoutType:()Lorg/apache/wss4j/policy/model/Layout$LayoutType;
     124: getstatic     #91                 // Field org/apache/wss4j/policy/model/Layout$LayoutType.LaxTsFirst:Lorg/apache/wss4j/policy/model/Layout$LayoutType;
     127: if_acmpne     188
     130: aload_1
     131: ifnonnull     143
     134: aload_2
     135: ldc           #92                 // String LaxTsFirst requires a timestamp
     137: invokevirtual #85                 // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     140: goto          227
     143: aload_0
     144: aload_0
     145: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     148: invokevirtual #90                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
     151: invokevirtual #93                 // Method addTopDownElement:(Lorg/w3c/dom/Element;)V
     154: aload_2
     155: iconst_1
     156: invokevirtual #86                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     159: aload_0
     160: new           #75                 // class javax/xml/namespace/QName
     163: dup
     164: aload_0
     165: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     168: invokevirtual #79                 // Method org/apache/wss4j/policy/model/AbstractBinding.getLayout:()Lorg/apache/wss4j/policy/model/Layout;
     171: invokevirtual #87                 // Method org/apache/wss4j/policy/model/Layout.getName:()Ljavax/xml/namespace/QName;
     174: invokevirtual #74                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     177: ldc           #94                 // String LaxTsFirst
     179: invokespecial #77                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     182: invokevirtual #89                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     185: goto          227
     188: aload_0
     189: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     192: ifnull        218
     195: aload_2
     196: ifnull        204
     199: aload_2
     200: iconst_1
     201: invokevirtual #86                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     204: aload_0
     205: aload_0
     206: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     209: invokevirtual #90                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
     212: invokevirtual #93                 // Method addTopDownElement:(Lorg/w3c/dom/Element;)V
     215: goto          227
     218: aload_2
     219: ifnull        227
     222: aload_2
     223: iconst_1
     224: invokevirtual #86                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     227: aload_0
     228: new           #75                 // class javax/xml/namespace/QName
     231: dup
     232: aload_0
     233: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     236: invokevirtual #79                 // Method org/apache/wss4j/policy/model/AbstractBinding.getLayout:()Lorg/apache/wss4j/policy/model/Layout;
     239: invokevirtual #87                 // Method org/apache/wss4j/policy/model/Layout.getName:()Ljavax/xml/namespace/QName;
     242: invokevirtual #74                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     245: ldc           #95                 // String Lax
     247: invokespecial #77                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     250: invokevirtual #89                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     253: aload_0
     254: new           #75                 // class javax/xml/namespace/QName
     257: dup
     258: aload_0
     259: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     262: invokevirtual #79                 // Method org/apache/wss4j/policy/model/AbstractBinding.getLayout:()Lorg/apache/wss4j/policy/model/Layout;
     265: invokevirtual #87                 // Method org/apache/wss4j/policy/model/Layout.getName:()Ljavax/xml/namespace/QName;
     268: invokevirtual #74                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     271: ldc           #96                 // String Strict
     273: invokespecial #77                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     276: invokevirtual #89                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     279: goto          300
     282: aload_0
     283: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     286: ifnull        300
     289: aload_0
     290: aload_0
     291: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     294: invokevirtual #90                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
     297: invokevirtual #93                 // Method addTopDownElement:(Lorg/w3c/dom/Element;)V
     300: aload_1
     301: areturn

  protected void reshuffleTimestamp();
    Code:
       0: aload_0
       1: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
       4: invokevirtual #79                 // Method org/apache/wss4j/policy/model/AbstractBinding.getLayout:()Lorg/apache/wss4j/policy/model/Layout;
       7: ifnull        189
      10: aload_0
      11: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
      14: ifnull        189
      17: aload_0
      18: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      21: invokevirtual #79                 // Method org/apache/wss4j/policy/model/AbstractBinding.getLayout:()Lorg/apache/wss4j/policy/model/Layout;
      24: invokevirtual #82                 // Method org/apache/wss4j/policy/model/Layout.getLayoutType:()Lorg/apache/wss4j/policy/model/Layout$LayoutType;
      27: getstatic     #91                 // Field org/apache/wss4j/policy/model/Layout$LayoutType.LaxTsFirst:Lorg/apache/wss4j/policy/model/Layout$LayoutType;
      30: if_acmpne     131
      33: aload_0
      34: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      37: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      40: invokeinterface #43,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      45: aload_0
      46: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
      49: invokevirtual #90                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
      52: if_acmpeq     131
      55: aload_0
      56: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
      59: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
      62: invokeinterface #43,  1           // InterfaceMethod org/w3c/dom/Element.getFirstChild:()Lorg/w3c/dom/Node;
      67: astore_1
      68: aload_1
      69: ifnull        92
      72: aload_1
      73: invokeinterface #97,  1           // InterfaceMethod org/w3c/dom/Node.getNodeType:()S
      78: iconst_1
      79: if_icmpeq     92
      82: aload_1
      83: invokeinterface #98,  1           // InterfaceMethod org/w3c/dom/Node.getNextSibling:()Lorg/w3c/dom/Node;
      88: astore_1
      89: goto          68
      92: aload_1
      93: ifnull        128
      96: aload_1
      97: aload_0
      98: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     101: invokevirtual #90                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
     104: if_acmpeq     128
     107: aload_0
     108: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     111: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     114: aload_0
     115: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     118: invokevirtual #90                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
     121: aload_1
     122: invokeinterface #38,  3           // InterfaceMethod org/w3c/dom/Element.insertBefore:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     127: pop
     128: goto          189
     131: aload_0
     132: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     135: invokevirtual #79                 // Method org/apache/wss4j/policy/model/AbstractBinding.getLayout:()Lorg/apache/wss4j/policy/model/Layout;
     138: invokevirtual #82                 // Method org/apache/wss4j/policy/model/Layout.getLayoutType:()Lorg/apache/wss4j/policy/model/Layout$LayoutType;
     141: getstatic     #83                 // Field org/apache/wss4j/policy/model/Layout$LayoutType.LaxTsLast:Lorg/apache/wss4j/policy/model/Layout$LayoutType;
     144: if_acmpne     189
     147: aload_0
     148: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     151: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     154: invokeinterface #99,  1           // InterfaceMethod org/w3c/dom/Element.getLastChild:()Lorg/w3c/dom/Node;
     159: aload_0
     160: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     163: invokevirtual #90                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
     166: if_acmpeq     189
     169: aload_0
     170: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     173: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     176: aload_0
     177: getfield      #65                 // Field timestampEl:Lorg/apache/wss4j/dom/message/WSSecTimestamp;
     180: invokevirtual #90                 // Method org/apache/wss4j/dom/message/WSSecTimestamp.getElement:()Lorg/w3c/dom/Element;
     183: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     188: pop
     189: return

  private java.util.List<org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder$SupportingToken> handleSupportingTokens(java.util.Collection<org.apache.cxf.ws.policy.AssertionInfo>, boolean) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #8                  // class java/util/ArrayList
       3: dup
       4: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
       7: astore_3
       8: aload_1
       9: ifnull        95
      12: aload_1
      13: invokeinterface #100,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      18: astore        4
      20: aload         4
      22: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      27: ifeq          95
      30: aload         4
      32: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      37: checkcast     #103                // class org/apache/cxf/ws/policy/AssertionInfo
      40: astore        5
      42: aload         5
      44: invokevirtual #104                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      47: instanceof    #105                // class org/apache/wss4j/policy/model/SupportingTokens
      50: ifeq          92
      53: aload         5
      55: iconst_1
      56: invokevirtual #86                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      59: aload_0
      60: aload         5
      62: invokevirtual #104                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      65: checkcast     #105                // class org/apache/wss4j/policy/model/SupportingTokens
      68: iload_2
      69: aload_3
      70: invokevirtual #106                // Method handleSupportingTokens:(Lorg/apache/wss4j/policy/model/SupportingTokens;ZLjava/util/List;)Ljava/util/List;
      73: pop
      74: goto          92
      77: astore        6
      79: new           #108                // class org/apache/wss4j/common/ext/WSSecurityException
      82: dup
      83: getstatic     #109                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      86: aload         6
      88: invokespecial #110                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      91: athrow
      92: goto          20
      95: aload_3
      96: areturn
    Exception table:
       from    to  target type
          59    74    77   Class javax/xml/soap/SOAPException

  protected java.util.List<org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder$SupportingToken> handleSupportingTokens(org.apache.wss4j.policy.model.SupportingTokens, boolean, java.util.List<org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder$SupportingToken>) throws org.apache.wss4j.common.ext.WSSecurityException, javax.xml.soap.SOAPException;
    Code:
       0: aload_1
       1: ifnonnull     6
       4: aload_3
       5: areturn
       6: aload_1
       7: invokevirtual #111                // Method org/apache/wss4j/policy/model/SupportingTokens.getTokens:()Ljava/util/List;
      10: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      15: astore        4
      17: aload         4
      19: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      24: ifeq          966
      27: aload         4
      29: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      34: checkcast     #113                // class org/apache/wss4j/policy/model/AbstractToken
      37: astore        5
      39: aload_0
      40: aload         5
      42: invokevirtual #114                // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
      45: aload_0
      46: aload         5
      48: invokevirtual #115                // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      51: invokevirtual #116                // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      54: ifne          66
      57: aload_0
      58: aload_1
      59: invokevirtual #117                // Method getSignedParts:(Lorg/apache/wss4j/policy/model/SupportingTokens;)Ljava/util/List;
      62: pop
      63: goto          17
      66: aload         5
      68: instanceof    #118                // class org/apache/wss4j/policy/model/UsernameToken
      71: ifeq          92
      74: aload_0
      75: aload         5
      77: checkcast     #118                // class org/apache/wss4j/policy/model/UsernameToken
      80: iload_2
      81: aload_1
      82: invokevirtual #119                // Method org/apache/wss4j/policy/model/SupportingTokens.isEncryptedToken:()Z
      85: aload_3
      86: invokevirtual #120                // Method handleUsernameTokenSupportingToken:(Lorg/apache/wss4j/policy/model/UsernameToken;ZZLjava/util/List;)V
      89: goto          963
      92: aload         5
      94: instanceof    #121                // class org/apache/wss4j/policy/model/IssuedToken
      97: ifne          132
     100: aload         5
     102: instanceof    #122                // class org/apache/wss4j/policy/model/SecureConversationToken
     105: ifne          132
     108: aload         5
     110: instanceof    #123                // class org/apache/wss4j/policy/model/SecurityContextToken
     113: ifne          132
     116: aload         5
     118: instanceof    #124                // class org/apache/wss4j/policy/model/KerberosToken
     121: ifne          132
     124: aload         5
     126: instanceof    #125                // class org/apache/wss4j/policy/model/SpnegoContextToken
     129: ifeq          594
     132: aload_0
     133: invokevirtual #126                // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     136: astore        6
     138: aload         6
     140: ifnonnull     151
     143: aload_0
     144: aload         5
     146: ldc           #127                // String Could not find IssuedToken
     148: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     151: aload_0
     152: aload         6
     154: invokevirtual #129                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
     157: invokevirtual #130                // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     160: astore        7
     162: aload         6
     164: aload         7
     166: invokevirtual #131                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setToken:(Lorg/w3c/dom/Element;)V
     169: aload_0
     170: aload         7
     172: invokevirtual #132                // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
     175: aload         6
     177: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     180: invokestatic  #134                // Method org/apache/wss4j/common/util/XMLUtils.getIDFromReference:(Ljava/lang/String;)Ljava/lang/String;
     183: astore        8
     185: aload_1
     186: invokevirtual #119                // Method org/apache/wss4j/policy/model/SupportingTokens.isEncryptedToken:()Z
     189: ifeq          224
     192: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     195: dup
     196: aload         8
     198: ldc           #136                // String Element
     200: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     203: astore        9
     205: aload         9
     207: aload         7
     209: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     212: aload_0
     213: getfield      #6                  // Field encryptedTokensList:Ljava/util/Set;
     216: aload         9
     218: invokeinterface #139,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     223: pop
     224: aload         6
     226: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getX509Certificate:()Ljava/security/cert/X509Certificate;
     229: ifnonnull     265
     232: aload_3
     233: new           #141                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken
     236: dup
     237: aload         5
     239: new           #142                // class org/apache/cxf/ws/security/wss4j/policyhandlers/WSSecurityTokenHolder
     242: dup
     243: aload         6
     245: invokespecial #143                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/WSSecurityTokenHolder."<init>":(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
     248: aload_0
     249: aload_1
     250: invokevirtual #117                // Method getSignedParts:(Lorg/apache/wss4j/policy/model/SupportingTokens;)Ljava/util/List;
     253: invokespecial #144                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken."<init>":(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/Object;Ljava/util/List;)V
     256: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     261: pop
     262: goto          591
     265: new           #146                // class org/apache/wss4j/dom/message/WSSecSignature
     268: dup
     269: invokespecial #147                // Method org/apache/wss4j/dom/message/WSSecSignature."<init>":()V
     272: astore        9
     274: aload         9
     276: aload_0
     277: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
     280: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     283: invokevirtual #148                // Method org/apache/wss4j/dom/message/WSSecSignature.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
     286: aload         9
     288: aload_0
     289: getfield      #34                 // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
     292: invokevirtual #149                // Method org/apache/wss4j/dom/message/WSSecSignature.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
     295: aload         9
     297: aload         6
     299: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getX509Certificate:()Ljava/security/cert/X509Certificate;
     302: invokevirtual #150                // Method org/apache/wss4j/dom/message/WSSecSignature.setX509Certificate:(Ljava/security/cert/X509Certificate;)V
     305: aload         9
     307: aload         8
     309: invokevirtual #151                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenId:(Ljava/lang/String;)V
     312: aload         9
     314: bipush        12
     316: invokevirtual #152                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     319: aload         6
     321: invokevirtual #153                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     324: astore        10
     326: ldc           #154                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     328: aload         10
     330: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     333: ifne          346
     336: ldc           #156                // String urn:oasis:names:tc:SAML:1.0:assertion
     338: aload         10
     340: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     343: ifeq          356
     346: aload         9
     348: ldc           #157                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     350: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     353: goto          408
     356: ldc           #159                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     358: aload         10
     360: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     363: ifne          376
     366: ldc           #160                // String urn:oasis:names:tc:SAML:2.0:assertion
     368: aload         10
     370: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     373: ifeq          386
     376: aload         9
     378: ldc           #161                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     380: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     383: goto          408
     386: aload         10
     388: ifnull        401
     391: aload         9
     393: aload         10
     395: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     398: goto          408
     401: aload         9
     403: ldc           #157                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     405: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     408: aload         9
     410: aload_0
     411: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     414: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     417: invokevirtual #163                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAsymmetricSignature:()Ljava/lang/String;
     420: invokevirtual #164                // Method org/apache/wss4j/dom/message/WSSecSignature.setSignatureAlgorithm:(Ljava/lang/String;)V
     423: aload         9
     425: aload_0
     426: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     429: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     432: invokevirtual #165                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     435: invokevirtual #166                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     438: invokevirtual #167                // Method org/apache/wss4j/dom/message/WSSecSignature.setSigCanonicalization:(Ljava/lang/String;)V
     441: aload         6
     443: invokevirtual #168                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     446: astore        11
     448: aconst_null
     449: astore        12
     451: aload         11
     453: aload         6
     455: invokevirtual #140                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getX509Certificate:()Ljava/security/cert/X509Certificate;
     458: invokeinterface #169,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Identifier:(Ljava/security/cert/X509Certificate;)Ljava/lang/String;
     463: astore        12
     465: goto          496
     468: astore        13
     470: getstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
     473: getstatic     #170                // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     476: aload         13
     478: invokevirtual #171                // Method org/apache/wss4j/common/ext/WSSecurityException.getMessage:()Ljava/lang/String;
     481: aload         13
     483: invokevirtual #172                // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     486: new           #173                // class org/apache/cxf/interceptor/Fault
     489: dup
     490: aload         13
     492: invokespecial #174                // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     495: athrow
     496: aload_0
     497: aload         12
     499: aload         5
     501: iconst_3
     502: invokevirtual #175                // Method getPassword:(Ljava/lang/String;Lorg/apache/neethi/Assertion;I)Ljava/lang/String;
     505: astore        13
     507: aload         9
     509: aload         12
     511: aload         13
     513: invokevirtual #176                // Method org/apache/wss4j/dom/message/WSSecSignature.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
     516: aload         9
     518: aload_0
     519: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     522: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     525: aload         6
     527: invokevirtual #168                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     530: aload_0
     531: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     534: invokevirtual #177                // Method org/apache/wss4j/dom/message/WSSecSignature.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     537: goto          568
     540: astore        14
     542: getstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
     545: getstatic     #170                // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     548: aload         14
     550: invokevirtual #171                // Method org/apache/wss4j/common/ext/WSSecurityException.getMessage:()Ljava/lang/String;
     553: aload         14
     555: invokevirtual #172                // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     558: new           #173                // class org/apache/cxf/interceptor/Fault
     561: dup
     562: aload         14
     564: invokespecial #174                // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     567: athrow
     568: aload_3
     569: new           #141                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken
     572: dup
     573: aload         5
     575: aload         9
     577: aload_0
     578: aload_1
     579: invokevirtual #117                // Method getSignedParts:(Lorg/apache/wss4j/policy/model/SupportingTokens;)Ljava/util/List;
     582: invokespecial #144                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken."<init>":(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/Object;Ljava/util/List;)V
     585: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     590: pop
     591: goto          963
     594: aload         5
     596: instanceof    #178                // class org/apache/wss4j/policy/model/X509Token
     599: ifeq          770
     602: aload_0
     603: aload         5
     605: iconst_0
     606: iload_2
     607: invokevirtual #179                // Method getSignatureBuilder:(Lorg/apache/wss4j/policy/model/AbstractToken;ZZ)Lorg/apache/wss4j/dom/message/WSSecSignature;
     610: astore        6
     612: aload_0
     613: aload_1
     614: invokevirtual #180                // Method assertPolicy:(Lorg/apache/neethi/Assertion;)V
     617: aload         6
     619: invokevirtual #181                // Method org/apache/wss4j/dom/message/WSSecSignature.getBinarySecurityTokenElement:()Lorg/w3c/dom/Element;
     622: astore        7
     624: aload         7
     626: ifnull        744
     629: aload_0
     630: getfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
     633: ifnull        693
     636: aload_0
     637: getfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
     640: invokeinterface #35,  1           // InterfaceMethod org/w3c/dom/Element.getNextSibling:()Lorg/w3c/dom/Node;
     645: ifnull        675
     648: aload_0
     649: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     652: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     655: aload         7
     657: aload_0
     658: getfield      #41                 // Field lastEncryptedKeyElement:Lorg/w3c/dom/Element;
     661: invokeinterface #35,  1           // InterfaceMethod org/w3c/dom/Element.getNextSibling:()Lorg/w3c/dom/Node;
     666: invokeinterface #38,  3           // InterfaceMethod org/w3c/dom/Element.insertBefore:(Lorg/w3c/dom/Node;Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     671: pop
     672: goto          702
     675: aload_0
     676: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     679: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     682: aload         7
     684: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     689: pop
     690: goto          702
     693: aload         6
     695: aload_0
     696: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     699: invokevirtual #182                // Method org/apache/wss4j/dom/message/WSSecSignature.prependBSTElementToHeader:(Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     702: aload_1
     703: invokevirtual #119                // Method org/apache/wss4j/policy/model/SupportingTokens.isEncryptedToken:()Z
     706: ifeq          744
     709: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     712: dup
     713: aload         6
     715: invokevirtual #183                // Method org/apache/wss4j/dom/message/WSSecSignature.getBSTTokenId:()Ljava/lang/String;
     718: ldc           #136                // String Element
     720: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     723: astore        8
     725: aload         8
     727: aload         7
     729: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     732: aload_0
     733: getfield      #6                  // Field encryptedTokensList:Ljava/util/Set;
     736: aload         8
     738: invokeinterface #139,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     743: pop
     744: aload_3
     745: new           #141                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken
     748: dup
     749: aload         5
     751: aload         6
     753: aload_0
     754: aload_1
     755: invokevirtual #117                // Method getSignedParts:(Lorg/apache/wss4j/policy/model/SupportingTokens;)Ljava/util/List;
     758: invokespecial #144                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken."<init>":(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/Object;Ljava/util/List;)V
     761: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     766: pop
     767: goto          963
     770: aload         5
     772: instanceof    #184                // class org/apache/wss4j/policy/model/KeyValueToken
     775: ifeq          854
     778: aload_0
     779: aload         5
     781: iconst_0
     782: iload_2
     783: invokevirtual #179                // Method getSignatureBuilder:(Lorg/apache/wss4j/policy/model/AbstractToken;ZZ)Lorg/apache/wss4j/dom/message/WSSecSignature;
     786: astore        6
     788: aload_0
     789: aload_1
     790: invokevirtual #180                // Method assertPolicy:(Lorg/apache/neethi/Assertion;)V
     793: aload_1
     794: invokevirtual #119                // Method org/apache/wss4j/policy/model/SupportingTokens.isEncryptedToken:()Z
     797: ifeq          828
     800: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     803: dup
     804: aload         6
     806: invokevirtual #183                // Method org/apache/wss4j/dom/message/WSSecSignature.getBSTTokenId:()Ljava/lang/String;
     809: ldc           #136                // String Element
     811: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     814: astore        7
     816: aload_0
     817: getfield      #6                  // Field encryptedTokensList:Ljava/util/Set;
     820: aload         7
     822: invokeinterface #139,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     827: pop
     828: aload_3
     829: new           #141                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken
     832: dup
     833: aload         5
     835: aload         6
     837: aload_0
     838: aload_1
     839: invokevirtual #117                // Method getSignedParts:(Lorg/apache/wss4j/policy/model/SupportingTokens;)Ljava/util/List;
     842: invokespecial #144                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken."<init>":(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/Object;Ljava/util/List;)V
     845: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     850: pop
     851: goto          963
     854: aload         5
     856: instanceof    #185                // class org/apache/wss4j/policy/model/SamlToken
     859: ifeq          963
     862: aload_0
     863: aload         5
     865: checkcast     #185                // class org/apache/wss4j/policy/model/SamlToken
     868: invokevirtual #186                // Method addSamlToken:(Lorg/apache/wss4j/policy/model/SamlToken;)Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;
     871: astore        6
     873: aload         6
     875: ifnull        963
     878: aload         6
     880: aload_0
     881: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     884: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     887: invokevirtual #187                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.toDOM:(Lorg/w3c/dom/Document;)Lorg/w3c/dom/Element;
     890: astore        7
     892: aload_0
     893: aload         7
     895: invokevirtual #132                // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
     898: aload_3
     899: new           #141                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken
     902: dup
     903: aload         5
     905: aload         6
     907: aload_0
     908: aload_1
     909: invokevirtual #117                // Method getSignedParts:(Lorg/apache/wss4j/policy/model/SupportingTokens;)Ljava/util/List;
     912: invokespecial #144                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken."<init>":(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/Object;Ljava/util/List;)V
     915: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     920: pop
     921: aload_1
     922: invokevirtual #119                // Method org/apache/wss4j/policy/model/SupportingTokens.isEncryptedToken:()Z
     925: ifeq          963
     928: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     931: dup
     932: aload         6
     934: invokevirtual #188                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getId:()Ljava/lang/String;
     937: ldc           #136                // String Element
     939: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     942: astore        8
     944: aload         8
     946: aload         7
     948: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     951: aload_0
     952: getfield      #6                  // Field encryptedTokensList:Ljava/util/Set;
     955: aload         8
     957: invokeinterface #139,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     962: pop
     963: goto          17
     966: aload_3
     967: areturn
    Exception table:
       from    to  target type
         451   465   468   Class org/apache/wss4j/common/ext/WSSecurityException
         516   537   540   Class org/apache/wss4j/common/ext/WSSecurityException

  protected void handleUsernameTokenSupportingToken(org.apache.wss4j.policy.model.UsernameToken, boolean, boolean, java.util.List<org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder$SupportingToken>) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: iload_2
       1: ifeq          102
       4: aload_0
       5: aload_1
       6: iconst_1
       7: invokevirtual #189                // Method addDKUsernameToken:(Lorg/apache/wss4j/policy/model/UsernameToken;Z)Lorg/apache/wss4j/dom/message/WSSecUsernameToken;
      10: astore        5
      12: aload         5
      14: ifnull        99
      17: aload         5
      19: aload_0
      20: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
      23: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
      26: invokevirtual #190                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.prepare:(Lorg/w3c/dom/Document;)V
      29: aload_0
      30: aload         5
      32: invokevirtual #191                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getUsernameTokenElement:()Lorg/w3c/dom/Element;
      35: invokevirtual #132                // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
      38: aload         4
      40: new           #141                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken
      43: dup
      44: aload_1
      45: aload         5
      47: aconst_null
      48: invokespecial #144                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken."<init>":(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/Object;Ljava/util/List;)V
      51: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      56: pop
      57: iload_3
      58: ifeq          99
      61: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
      64: dup
      65: aload         5
      67: invokevirtual #192                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getId:()Ljava/lang/String;
      70: ldc           #136                // String Element
      72: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      75: astore        6
      77: aload         6
      79: aload         5
      81: invokevirtual #191                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getUsernameTokenElement:()Lorg/w3c/dom/Element;
      84: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
      87: aload_0
      88: getfield      #6                  // Field encryptedTokensList:Ljava/util/Set;
      91: aload         6
      93: invokeinterface #139,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      98: pop
      99: goto          209
     102: aload_0
     103: aload_1
     104: invokevirtual #193                // Method addUsernameToken:(Lorg/apache/wss4j/policy/model/UsernameToken;)Lorg/apache/wss4j/dom/message/WSSecUsernameToken;
     107: astore        5
     109: aload         5
     111: ifnull        209
     114: aload         5
     116: aload_0
     117: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     120: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     123: invokevirtual #190                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.prepare:(Lorg/w3c/dom/Document;)V
     126: aload_0
     127: aload         5
     129: invokevirtual #191                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getUsernameTokenElement:()Lorg/w3c/dom/Element;
     132: invokevirtual #132                // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
     135: aload         4
     137: new           #141                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken
     140: dup
     141: aload_1
     142: aload         5
     144: aconst_null
     145: invokespecial #144                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken."<init>":(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/Object;Ljava/util/List;)V
     148: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     153: pop
     154: iload_3
     155: ifne          171
     158: aload_0
     159: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     162: ldc           #194                // String ws-security.username-token.always.encrypted
     164: iconst_1
     165: invokestatic  #20                 // Method org/apache/cxf/message/MessageUtils.getContextualBoolean:(Lorg/apache/cxf/message/Message;Ljava/lang/String;Z)Z
     168: ifeq          209
     171: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     174: dup
     175: aload         5
     177: invokevirtual #192                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getId:()Ljava/lang/String;
     180: ldc           #136                // String Element
     182: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     185: astore        6
     187: aload         6
     189: aload         5
     191: invokevirtual #191                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getUsernameTokenElement:()Lorg/w3c/dom/Element;
     194: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     197: aload_0
     198: getfield      #6                  // Field encryptedTokensList:Ljava/util/Set;
     201: aload         6
     203: invokeinterface #139,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     208: pop
     209: return

  protected org.w3c.dom.Element cloneElement(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
       4: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
       7: invokeinterface #32,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
      12: aload_1
      13: iconst_1
      14: invokeinterface #195,  3          // InterfaceMethod org/w3c/dom/Document.importNode:(Lorg/w3c/dom/Node;Z)Lorg/w3c/dom/Node;
      19: checkcast     #196                // class org/w3c/dom/Element
      22: areturn

  protected void addSignatureParts(java.util.List<org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder$SupportingToken>, java.util.List<org.apache.wss4j.common.WSEncryptionPart>);
    Code:
       0: aload_1
       1: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
       6: astore_3
       7: aload_3
       8: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      13: ifeq          672
      16: aload_3
      17: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      22: checkcast     #141                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken
      25: astore        4
      27: aload         4
      29: invokevirtual #197                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getTokenImplementation:()Ljava/lang/Object;
      32: astore        5
      34: aconst_null
      35: astore        6
      37: aload         5
      39: instanceof    #146                // class org/apache/wss4j/dom/message/WSSecSignature
      42: ifeq          171
      45: aload         5
      47: checkcast     #146                // class org/apache/wss4j/dom/message/WSSecSignature
      50: astore        7
      52: aload         7
      54: invokevirtual #198                // Method org/apache/wss4j/dom/message/WSSecSignature.getSecurityTokenReference:()Lorg/apache/wss4j/common/token/SecurityTokenReference;
      57: astore        8
      59: ldc           #157                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
      61: aload         8
      63: invokevirtual #199                // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValueType:()Ljava/lang/String;
      66: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      69: ifne          85
      72: ldc           #161                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
      74: aload         8
      76: invokevirtual #199                // Method org/apache/wss4j/common/token/SecurityTokenReference.getKeyIdentifierValueType:()Ljava/lang/String;
      79: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      82: ifeq          136
      85: aload_0
      86: aload         8
      88: invokevirtual #200                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
      91: invokevirtual #130                // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
      94: astore        9
      96: aload_0
      97: aload         9
      99: invokevirtual #132                // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
     102: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     105: dup
     106: ldc           #201                // String STRTransform
     108: aconst_null
     109: ldc           #136                // String Element
     111: invokespecial #202                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     114: astore        6
     116: aload         6
     118: aload         7
     120: invokevirtual #203                // Method org/apache/wss4j/dom/message/WSSecSignature.getSecurityTokenReferenceURI:()Ljava/lang/String;
     123: invokevirtual #204                // Method org/apache/wss4j/common/WSEncryptionPart.setId:(Ljava/lang/String;)V
     126: aload         6
     128: aload         9
     130: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     133: goto          168
     136: aload         7
     138: invokevirtual #183                // Method org/apache/wss4j/dom/message/WSSecSignature.getBSTTokenId:()Ljava/lang/String;
     141: ifnull        168
     144: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     147: dup
     148: aload         7
     150: invokevirtual #183                // Method org/apache/wss4j/dom/message/WSSecSignature.getBSTTokenId:()Ljava/lang/String;
     153: invokespecial #205                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
     156: astore        6
     158: aload         6
     160: aload         7
     162: invokevirtual #181                // Method org/apache/wss4j/dom/message/WSSecSignature.getBinarySecurityTokenElement:()Lorg/w3c/dom/Element;
     165: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     168: goto          655
     171: aload         5
     173: instanceof    #206                // class org/apache/wss4j/dom/message/WSSecUsernameToken
     176: ifeq          213
     179: aload         5
     181: checkcast     #206                // class org/apache/wss4j/dom/message/WSSecUsernameToken
     184: astore        7
     186: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     189: dup
     190: aload         7
     192: invokevirtual #192                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getId:()Ljava/lang/String;
     195: invokespecial #205                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
     198: astore        6
     200: aload         6
     202: aload         7
     204: invokevirtual #191                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getUsernameTokenElement:()Lorg/w3c/dom/Element;
     207: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     210: goto          655
     213: aload         5
     215: instanceof    #207                // class org/apache/wss4j/common/token/BinarySecurity
     218: ifeq          255
     221: aload         5
     223: checkcast     #207                // class org/apache/wss4j/common/token/BinarySecurity
     226: astore        7
     228: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     231: dup
     232: aload         7
     234: invokevirtual #208                // Method org/apache/wss4j/common/token/BinarySecurity.getID:()Ljava/lang/String;
     237: invokespecial #205                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
     240: astore        6
     242: aload         6
     244: aload         7
     246: invokevirtual #209                // Method org/apache/wss4j/common/token/BinarySecurity.getElement:()Lorg/w3c/dom/Element;
     249: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     252: goto          655
     255: aload         5
     257: instanceof    #210                // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     260: ifeq          364
     263: aload         5
     265: checkcast     #210                // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     268: astore        7
     270: aload         7
     272: invokevirtual #211                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getElement:()Lorg/w3c/dom/Element;
     275: invokeinterface #32,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     280: astore        8
     282: aload         7
     284: invokevirtual #212                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml1:()Lorg/opensaml/saml/saml1/core/Assertion;
     287: ifnull        294
     290: iconst_1
     291: goto          295
     294: iconst_0
     295: istore        9
     297: aload_0
     298: aload         8
     300: aload         7
     302: invokevirtual #188                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getId:()Ljava/lang/String;
     305: iload         9
     307: iconst_0
     308: invokespecial #213                // Method createSTRForSamlAssertion:(Lorg/w3c/dom/Document;Ljava/lang/String;ZZ)Lorg/apache/wss4j/common/token/SecurityTokenReference;
     311: astore        10
     313: aload_0
     314: aload         10
     316: invokevirtual #200                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     319: invokevirtual #130                // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     322: astore        11
     324: aload_0
     325: aload         11
     327: invokevirtual #132                // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
     330: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     333: dup
     334: ldc           #201                // String STRTransform
     336: aconst_null
     337: ldc           #136                // String Element
     339: invokespecial #202                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     342: astore        6
     344: aload         6
     346: aload         10
     348: invokevirtual #214                // Method org/apache/wss4j/common/token/SecurityTokenReference.getID:()Ljava/lang/String;
     351: invokevirtual #204                // Method org/apache/wss4j/common/WSEncryptionPart.setId:(Ljava/lang/String;)V
     354: aload         6
     356: aload         11
     358: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     361: goto          655
     364: aload         5
     366: instanceof    #142                // class org/apache/cxf/ws/security/wss4j/policyhandlers/WSSecurityTokenHolder
     369: ifeq          626
     372: aload         5
     374: checkcast     #142                // class org/apache/cxf/ws/security/wss4j/policyhandlers/WSSecurityTokenHolder
     377: invokevirtual #215                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/WSSecurityTokenHolder.getToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     380: astore        7
     382: aload         7
     384: invokevirtual #153                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
     387: astore        8
     389: ldc           #154                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     391: aload         8
     393: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     396: ifne          429
     399: ldc           #156                // String urn:oasis:names:tc:SAML:1.0:assertion
     401: aload         8
     403: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     406: ifne          429
     409: ldc           #159                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     411: aload         8
     413: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     416: ifne          429
     419: ldc           #160                // String urn:oasis:names:tc:SAML:2.0:assertion
     421: aload         8
     423: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     426: ifeq          592
     429: aload         7
     431: invokevirtual #129                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
     434: invokeinterface #32,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     439: astore        9
     441: ldc           #154                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     443: aload         8
     445: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     448: ifne          461
     451: ldc           #156                // String urn:oasis:names:tc:SAML:1.0:assertion
     453: aload         8
     455: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     458: ifeq          465
     461: iconst_1
     462: goto          466
     465: iconst_0
     466: istore        10
     468: aload         7
     470: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     473: astore        11
     475: aload         11
     477: ifnull        490
     480: ldc           #216                // String
     482: aload         11
     484: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     487: ifeq          528
     490: iload         10
     492: ifeq          513
     495: aload         7
     497: invokevirtual #129                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
     500: aconst_null
     501: ldc           #217                // String AssertionID
     503: invokeinterface #218,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     508: astore        11
     510: goto          528
     513: aload         7
     515: invokevirtual #129                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
     518: aconst_null
     519: ldc           #219                // String ID
     521: invokeinterface #218,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     526: astore        11
     528: aload_0
     529: aload         9
     531: aload         11
     533: iload         10
     535: iconst_0
     536: invokespecial #213                // Method createSTRForSamlAssertion:(Lorg/w3c/dom/Document;Ljava/lang/String;ZZ)Lorg/apache/wss4j/common/token/SecurityTokenReference;
     539: astore        12
     541: aload_0
     542: aload         12
     544: invokevirtual #200                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     547: invokevirtual #130                // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     550: astore        13
     552: aload_0
     553: aload         13
     555: invokevirtual #132                // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
     558: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     561: dup
     562: ldc           #201                // String STRTransform
     564: aconst_null
     565: ldc           #136                // String Element
     567: invokespecial #202                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     570: astore        6
     572: aload         6
     574: aload         12
     576: invokevirtual #214                // Method org/apache/wss4j/common/token/SecurityTokenReference.getID:()Ljava/lang/String;
     579: invokevirtual #204                // Method org/apache/wss4j/common/WSEncryptionPart.setId:(Ljava/lang/String;)V
     582: aload         6
     584: aload         13
     586: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     589: goto          623
     592: aload         7
     594: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     597: invokestatic  #134                // Method org/apache/wss4j/common/util/XMLUtils.getIDFromReference:(Ljava/lang/String;)Ljava/lang/String;
     600: astore        9
     602: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     605: dup
     606: aload         9
     608: invokespecial #205                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
     611: astore        6
     613: aload         6
     615: aload         7
     617: invokevirtual #129                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
     620: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     623: goto          655
     626: aload_0
     627: aload         4
     629: invokevirtual #220                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     632: new           #221                // class java/lang/StringBuilder
     635: dup
     636: invokespecial #222                // Method java/lang/StringBuilder."<init>":()V
     639: ldc           #223                // String UnsupportedTokenInSupportingToken:
     641: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     644: aload         5
     646: invokevirtual #225                // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     649: invokevirtual #226                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     652: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     655: aload         6
     657: ifnull        669
     660: aload_2
     661: aload         6
     663: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     668: pop
     669: goto          7
     672: return

  private org.apache.wss4j.common.token.SecurityTokenReference createSTRForSamlAssertion(org.w3c.dom.Document, java.lang.String, boolean, boolean);
    Code:
       0: new           #227                // class org/apache/wss4j/common/token/SecurityTokenReference
       3: dup
       4: aload_1
       5: invokespecial #228                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
       8: astore        5
      10: aload_0
      11: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      14: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      17: ldc           #229                // String STR-
      19: aload         5
      21: invokeinterface #230,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createSecureId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
      26: astore        6
      28: aload         5
      30: aload         6
      32: invokevirtual #231                // Method org/apache/wss4j/common/token/SecurityTokenReference.setID:(Ljava/lang/String;)V
      35: iload         4
      37: ifeq          112
      40: new           #232                // class org/apache/wss4j/common/token/Reference
      43: dup
      44: aload_1
      45: invokespecial #233                // Method org/apache/wss4j/common/token/Reference."<init>":(Lorg/w3c/dom/Document;)V
      48: astore        7
      50: aload         7
      52: new           #221                // class java/lang/StringBuilder
      55: dup
      56: invokespecial #222                // Method java/lang/StringBuilder."<init>":()V
      59: ldc           #234                // String #
      61: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      64: aload_2
      65: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      68: invokevirtual #226                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      71: invokevirtual #235                // Method org/apache/wss4j/common/token/Reference.setURI:(Ljava/lang/String;)V
      74: iload_3
      75: ifeq          95
      78: aload         7
      80: ldc           #157                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
      82: invokevirtual #236                // Method org/apache/wss4j/common/token/Reference.setValueType:(Ljava/lang/String;)V
      85: aload         5
      87: ldc           #154                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
      89: invokevirtual #237                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
      92: goto          102
      95: aload         5
      97: ldc           #159                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
      99: invokevirtual #237                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     102: aload         5
     104: aload         7
     106: invokevirtual #238                // Method org/apache/wss4j/common/token/SecurityTokenReference.setReference:(Lorg/apache/wss4j/common/token/Reference;)V
     109: goto          200
     112: aload_1
     113: ldc           #239                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
     115: ldc           #240                // String wsse:KeyIdentifier
     117: invokeinterface #241,  3          // InterfaceMethod org/w3c/dom/Document.createElementNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Element;
     122: astore        7
     124: aconst_null
     125: astore        8
     127: iload_3
     128: ifeq          145
     131: ldc           #157                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     133: astore        8
     135: aload         5
     137: ldc           #154                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     139: invokevirtual #237                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     142: goto          156
     145: ldc           #161                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     147: astore        8
     149: aload         5
     151: ldc           #159                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     153: invokevirtual #237                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     156: aload         7
     158: aconst_null
     159: ldc           #242                // String ValueType
     161: aload         8
     163: invokeinterface #243,  4          // InterfaceMethod org/w3c/dom/Element.setAttributeNS:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     168: aload         7
     170: aload_1
     171: aload_2
     172: invokeinterface #244,  2          // InterfaceMethod org/w3c/dom/Document.createTextNode:(Ljava/lang/String;)Lorg/w3c/dom/Text;
     177: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     182: pop
     183: aload         5
     185: invokevirtual #200                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     188: astore        9
     190: aload         9
     192: aload         7
     194: invokeinterface #37,  2           // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     199: pop
     200: aload         5
     202: areturn

  protected org.apache.wss4j.dom.message.WSSecUsernameToken addUsernameToken(org.apache.wss4j.policy.model.UsernameToken);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #114                // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
       5: aload_0
       6: aload_1
       7: invokevirtual #245                // Method org/apache/wss4j/policy/model/UsernameToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      10: invokevirtual #116                // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      13: ifne          18
      16: aconst_null
      17: areturn
      18: ldc           #246                // String security.username
      20: aload_0
      21: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      24: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      27: checkcast     #61                 // class java/lang/String
      30: astore_2
      31: aload_2
      32: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
      35: ifne          223
      38: new           #206                // class org/apache/wss4j/dom/message/WSSecUsernameToken
      41: dup
      42: invokespecial #249                // Method org/apache/wss4j/dom/message/WSSecUsernameToken."<init>":()V
      45: astore_3
      46: aload_3
      47: aload_0
      48: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      51: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      54: invokevirtual #250                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      57: aload_3
      58: aload_0
      59: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      62: invokevirtual #68                 // Method org/apache/wss4j/dom/engine/WSSConfig.getCurrentTime:()Lorg/apache/wss4j/common/util/WSTimeSource;
      65: invokevirtual #251                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setWsTimeSource:(Lorg/apache/wss4j/common/util/WSTimeSource;)V
      68: aload_1
      69: invokevirtual #252                // Method org/apache/wss4j/policy/model/UsernameToken.getPasswordType:()Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      72: getstatic     #253                // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.NoPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      75: if_acmpne     92
      78: aload_3
      79: aload_2
      80: aconst_null
      81: invokevirtual #254                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
      84: aload_3
      85: aconst_null
      86: invokevirtual #255                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setPasswordType:(Ljava/lang/String;)V
      89: goto          179
      92: ldc_w         #256                // String security.password
      95: aload_0
      96: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      99: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     102: checkcast     #61                 // class java/lang/String
     105: astore        4
     107: aload         4
     109: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     112: ifeq          124
     115: aload_0
     116: aload_2
     117: aload_1
     118: iconst_2
     119: invokevirtual #175                // Method getPassword:(Ljava/lang/String;Lorg/apache/neethi/Assertion;I)Ljava/lang/String;
     122: astore        4
     124: aload         4
     126: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     129: ifne          169
     132: aload_1
     133: invokevirtual #252                // Method org/apache/wss4j/policy/model/UsernameToken.getPasswordType:()Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
     136: getstatic     #257                // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.HashPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
     139: if_acmpne     152
     142: aload_3
     143: ldc_w         #258                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest
     146: invokevirtual #255                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setPasswordType:(Ljava/lang/String;)V
     149: goto          159
     152: aload_3
     153: ldc_w         #259                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText
     156: invokevirtual #255                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setPasswordType:(Ljava/lang/String;)V
     159: aload_3
     160: aload_2
     161: aload         4
     163: invokevirtual #254                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
     166: goto          179
     169: aload_0
     170: aload_1
     171: ldc_w         #260                // String No password available
     174: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     177: aconst_null
     178: areturn
     179: aload_1
     180: invokevirtual #261                // Method org/apache/wss4j/policy/model/UsernameToken.isCreated:()Z
     183: ifeq          200
     186: aload_1
     187: invokevirtual #252                // Method org/apache/wss4j/policy/model/UsernameToken.getPasswordType:()Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
     190: getstatic     #257                // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.HashPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
     193: if_acmpeq     200
     196: aload_3
     197: invokevirtual #262                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.addCreated:()V
     200: aload_1
     201: invokevirtual #263                // Method org/apache/wss4j/policy/model/UsernameToken.isNonce:()Z
     204: ifeq          221
     207: aload_1
     208: invokevirtual #252                // Method org/apache/wss4j/policy/model/UsernameToken.getPasswordType:()Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
     211: getstatic     #257                // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.HashPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
     214: if_acmpeq     221
     217: aload_3
     218: invokevirtual #264                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.addNonce:()V
     221: aload_3
     222: areturn
     223: aload_0
     224: aload_1
     225: ldc_w         #265                // String No username available
     228: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     231: aconst_null
     232: areturn

  protected org.apache.wss4j.dom.message.WSSecUsernameToken addDKUsernameToken(org.apache.wss4j.policy.model.UsernameToken, boolean);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #114                // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
       5: aload_0
       6: aload_1
       7: invokevirtual #245                // Method org/apache/wss4j/policy/model/UsernameToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      10: invokevirtual #116                // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      13: ifne          18
      16: aconst_null
      17: areturn
      18: ldc           #246                // String security.username
      20: aload_0
      21: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      24: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      27: checkcast     #61                 // class java/lang/String
      30: astore_3
      31: aload_3
      32: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
      35: ifne          157
      38: new           #206                // class org/apache/wss4j/dom/message/WSSecUsernameToken
      41: dup
      42: invokespecial #249                // Method org/apache/wss4j/dom/message/WSSecUsernameToken."<init>":()V
      45: astore        4
      47: aload         4
      49: aload_0
      50: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      53: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      56: invokevirtual #250                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      59: aload         4
      61: aload_0
      62: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      65: invokevirtual #68                 // Method org/apache/wss4j/dom/engine/WSSConfig.getCurrentTime:()Lorg/apache/wss4j/common/util/WSTimeSource;
      68: invokevirtual #251                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setWsTimeSource:(Lorg/apache/wss4j/common/util/WSTimeSource;)V
      71: ldc_w         #256                // String security.password
      74: aload_0
      75: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      78: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      81: checkcast     #61                 // class java/lang/String
      84: astore        5
      86: aload         5
      88: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
      91: ifeq          103
      94: aload_0
      95: aload_3
      96: aload_1
      97: iconst_2
      98: invokevirtual #175                // Method getPassword:(Ljava/lang/String;Lorg/apache/neethi/Assertion;I)Ljava/lang/String;
     101: astore        5
     103: aload         5
     105: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     108: ifne          144
     111: aload         4
     113: aload_3
     114: aload         5
     116: invokevirtual #254                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
     119: aload         4
     121: iload_2
     122: aconst_null
     123: sipush        1000
     126: invokevirtual #266                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.addDerivedKey:(Z[BI)V
     129: aload         4
     131: aload_0
     132: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     135: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     138: invokevirtual #190                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.prepare:(Lorg/w3c/dom/Document;)V
     141: goto          154
     144: aload_0
     145: aload_1
     146: ldc_w         #260                // String No password available
     149: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     152: aconst_null
     153: areturn
     154: aload         4
     156: areturn
     157: aload_0
     158: aload_1
     159: ldc_w         #265                // String No username available
     162: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     165: aconst_null
     166: areturn

  protected org.apache.wss4j.common.saml.SamlAssertionWrapper addSamlToken(org.apache.wss4j.policy.model.SamlToken) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #114                // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
       5: aload_0
       6: aload_1
       7: invokevirtual #267                // Method org/apache/wss4j/policy/model/SamlToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      10: invokevirtual #116                // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      13: ifne          18
      16: aconst_null
      17: areturn
      18: ldc_w         #268                // String security.saml-callback-handler
      21: aload_0
      22: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      25: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      28: astore_2
      29: aload_2
      30: ifnonnull     158
      33: aload_0
      34: invokevirtual #126                // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      37: astore_3
      38: aload_3
      39: ifnull        158
      42: aload_3
      43: invokevirtual #129                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getToken:()Lorg/w3c/dom/Element;
      46: astore        4
      48: aload         4
      50: invokeinterface #269,  1          // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      55: astore        5
      57: aload         4
      59: invokeinterface #270,  1          // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      64: astore        6
      66: aload_1
      67: invokevirtual #271                // Method org/apache/wss4j/policy/model/SamlToken.getSamlTokenType:()Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
      70: astore        7
      72: aload         7
      74: getstatic     #272                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV11Token10:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
      77: if_acmpeq     88
      80: aload         7
      82: getstatic     #273                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV11Token11:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
      85: if_acmpne     119
      88: ldc           #156                // String urn:oasis:names:tc:SAML:1.0:assertion
      90: aload         5
      92: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      95: ifeq          119
      98: ldc_w         #274                // String Assertion
     101: aload         6
     103: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     106: ifeq          119
     109: new           #210                // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     112: dup
     113: aload         4
     115: invokespecial #275                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper."<init>":(Lorg/w3c/dom/Element;)V
     118: areturn
     119: aload         7
     121: getstatic     #276                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV20Token11:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
     124: if_acmpne     158
     127: ldc           #160                // String urn:oasis:names:tc:SAML:2.0:assertion
     129: aload         5
     131: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     134: ifeq          158
     137: ldc_w         #274                // String Assertion
     140: aload         6
     142: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     145: ifeq          158
     148: new           #210                // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     151: dup
     152: aload         4
     154: invokespecial #275                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper."<init>":(Lorg/w3c/dom/Element;)V
     157: areturn
     158: new           #277                // class org/apache/wss4j/common/saml/SAMLCallback
     161: dup
     162: invokespecial #278                // Method org/apache/wss4j/common/saml/SAMLCallback."<init>":()V
     165: astore_3
     166: aload_1
     167: invokevirtual #271                // Method org/apache/wss4j/policy/model/SamlToken.getSamlTokenType:()Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
     170: astore        4
     172: aload         4
     174: getstatic     #272                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV11Token10:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
     177: if_acmpeq     188
     180: aload         4
     182: getstatic     #273                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV11Token11:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
     185: if_acmpne     198
     188: aload_3
     189: getstatic     #279                // Field org/apache/wss4j/common/saml/bean/Version.SAML_11:Lorg/apache/wss4j/common/saml/bean/Version;
     192: invokevirtual #280                // Method org/apache/wss4j/common/saml/SAMLCallback.setSamlVersion:(Lorg/apache/wss4j/common/saml/bean/Version;)V
     195: goto          213
     198: aload         4
     200: getstatic     #276                // Field org/apache/wss4j/policy/model/SamlToken$SamlTokenType.WssSamlV20Token11:Lorg/apache/wss4j/policy/model/SamlToken$SamlTokenType;
     203: if_acmpne     213
     206: aload_3
     207: getstatic     #281                // Field org/apache/wss4j/common/saml/bean/Version.SAML_20:Lorg/apache/wss4j/common/saml/bean/Version;
     210: invokevirtual #280                // Method org/apache/wss4j/common/saml/SAMLCallback.setSamlVersion:(Lorg/apache/wss4j/common/saml/bean/Version;)V
     213: aload_2
     214: invokestatic  #282                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getCallbackHandler:(Ljava/lang/Object;)Ljavax/security/auth/callback/CallbackHandler;
     217: astore        5
     219: aload         5
     221: ifnonnull     234
     224: aload_0
     225: aload_1
     226: ldc_w         #283                // String No SAML CallbackHandler available
     229: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     232: aconst_null
     233: areturn
     234: aload         5
     236: aload_3
     237: invokestatic  #284                // Method org/apache/wss4j/common/saml/SAMLUtil.doSAMLCallback:(Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/wss4j/common/saml/SAMLCallback;)V
     240: goto          258
     243: astore        5
     245: new           #108                // class org/apache/wss4j/common/ext/WSSecurityException
     248: dup
     249: getstatic     #109                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
     252: aload         5
     254: invokespecial #110                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
     257: athrow
     258: new           #210                // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     261: dup
     262: aload_3
     263: invokespecial #286                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper."<init>":(Lorg/apache/wss4j/common/saml/SAMLCallback;)V
     266: astore        5
     268: aload_3
     269: invokevirtual #287                // Method org/apache/wss4j/common/saml/SAMLCallback.isSignAssertion:()Z
     272: ifeq          370
     275: aload_3
     276: invokevirtual #288                // Method org/apache/wss4j/common/saml/SAMLCallback.getIssuerKeyName:()Ljava/lang/String;
     279: astore        6
     281: aload         6
     283: ifnonnull     305
     286: ldc_w         #289                // String security.signature.username
     289: astore        7
     291: aload         7
     293: aload_0
     294: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     297: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     300: checkcast     #61                 // class java/lang/String
     303: astore        6
     305: aload_3
     306: invokevirtual #290                // Method org/apache/wss4j/common/saml/SAMLCallback.getIssuerKeyPassword:()Ljava/lang/String;
     309: astore        7
     311: aload         7
     313: ifnonnull     326
     316: aload_0
     317: aload         6
     319: aload_1
     320: iconst_3
     321: invokevirtual #175                // Method getPassword:(Ljava/lang/String;Lorg/apache/neethi/Assertion;I)Ljava/lang/String;
     324: astore        7
     326: aload_3
     327: invokevirtual #291                // Method org/apache/wss4j/common/saml/SAMLCallback.getIssuerCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     330: astore        8
     332: aload         8
     334: ifnonnull     343
     337: aload_0
     338: invokevirtual #292                // Method getSignatureCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     341: astore        8
     343: aload         5
     345: aload         6
     347: aload         7
     349: aload         8
     351: aload_3
     352: invokevirtual #293                // Method org/apache/wss4j/common/saml/SAMLCallback.isSendKeyValue:()Z
     355: aload_3
     356: invokevirtual #294                // Method org/apache/wss4j/common/saml/SAMLCallback.getCanonicalizationAlgorithm:()Ljava/lang/String;
     359: aload_3
     360: invokevirtual #295                // Method org/apache/wss4j/common/saml/SAMLCallback.getSignatureAlgorithm:()Ljava/lang/String;
     363: aload_3
     364: invokevirtual #296                // Method org/apache/wss4j/common/saml/SAMLCallback.getSignatureDigestAlgorithm:()Ljava/lang/String;
     367: invokevirtual #297                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.signAssertion:(Ljava/lang/String;Ljava/lang/String;Lorg/apache/wss4j/common/crypto/Crypto;ZLjava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     370: aload         5
     372: areturn
    Exception table:
       from    to  target type
         213   233   243   Class java/lang/Exception
         234   240   243   Class java/lang/Exception

  protected void storeAssertionAsSecurityToken(org.apache.wss4j.common.saml.SamlAssertionWrapper);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #211                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getElement:()Lorg/w3c/dom/Element;
       5: invokevirtual #298                // Method findIDFromSamlToken:(Lorg/w3c/dom/Element;)Ljava/lang/String;
       8: astore_2
       9: aload_2
      10: ifnonnull     14
      13: return
      14: new           #299                // class org/apache/cxf/ws/security/tokenstore/SecurityToken
      17: dup
      18: aload_2
      19: invokespecial #300                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;)V
      22: astore_3
      23: aload_1
      24: invokevirtual #301                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getSaml2:()Lorg/opensaml/saml/saml2/core/Assertion;
      27: ifnull        39
      30: aload_3
      31: ldc           #159                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
      33: invokevirtual #302                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setTokenType:(Ljava/lang/String;)V
      36: goto          45
      39: aload_3
      40: ldc           #154                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
      42: invokevirtual #302                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setTokenType:(Ljava/lang/String;)V
      45: aload_3
      46: aload_1
      47: invokevirtual #211                // Method org/apache/wss4j/common/saml/SamlAssertionWrapper.getElement:()Lorg/w3c/dom/Element;
      50: invokevirtual #131                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setToken:(Lorg/w3c/dom/Element;)V
      53: aload_0
      54: invokevirtual #303                // Method getTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      57: aload_3
      58: invokeinterface #304,  2          // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.add:(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
      63: aload_0
      64: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      67: ldc_w         #305                // String ws-security.token.id
      70: aload_3
      71: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
      74: invokevirtual #306                // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
      77: pop
      78: return

  protected java.lang.String findIDFromSamlToken(org.w3c.dom.Element);
    Code:
       0: aconst_null
       1: astore_2
       2: aload_1
       3: ifnull        113
       6: aload_1
       7: invokestatic  #307                // Method org/apache/cxf/helpers/DOMUtils.getElementQName:(Lorg/w3c/dom/Element;)Ljavax/xml/namespace/QName;
      10: astore_3
      11: aload_3
      12: new           #75                 // class javax/xml/namespace/QName
      15: dup
      16: ldc           #156                // String urn:oasis:names:tc:SAML:1.0:assertion
      18: ldc_w         #274                // String Assertion
      21: invokespecial #77                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      24: invokevirtual #308                // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      27: ifeq          55
      30: aload_1
      31: aconst_null
      32: ldc           #217                // String AssertionID
      34: invokeinterface #309,  3          // InterfaceMethod org/w3c/dom/Element.hasAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Z
      39: ifeq          55
      42: aload_1
      43: aconst_null
      44: ldc           #217                // String AssertionID
      46: invokeinterface #218,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      51: astore_2
      52: goto          96
      55: aload_3
      56: new           #75                 // class javax/xml/namespace/QName
      59: dup
      60: ldc           #160                // String urn:oasis:names:tc:SAML:2.0:assertion
      62: ldc_w         #274                // String Assertion
      65: invokespecial #77                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      68: invokevirtual #308                // Method javax/xml/namespace/QName.equals:(Ljava/lang/Object;)Z
      71: ifeq          96
      74: aload_1
      75: aconst_null
      76: ldc           #219                // String ID
      78: invokeinterface #309,  3          // InterfaceMethod org/w3c/dom/Element.hasAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Z
      83: ifeq          96
      86: aload_1
      87: aconst_null
      88: ldc           #219                // String ID
      90: invokeinterface #218,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      95: astore_2
      96: aload_2
      97: ifnonnull     113
     100: aload_1
     101: ldc_w         #310                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
     104: ldc_w         #311                // String Id
     107: invokeinterface #218,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     112: astore_2
     113: aload_2
     114: areturn

  protected java.lang.String getPassword(java.lang.String, org.apache.neethi.Assertion, int);
    Code:
       0: ldc_w         #312                // String security.callback-handler
       3: aload_0
       4: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       7: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      10: astore        4
      12: aconst_null
      13: astore        5
      15: aload         4
      17: invokestatic  #282                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getCallbackHandler:(Ljava/lang/Object;)Ljavax/security/auth/callback/CallbackHandler;
      20: astore        5
      22: aload         5
      24: ifnonnull     54
      27: iload_3
      28: iconst_3
      29: if_icmpne     44
      32: getstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
      35: ldc_w         #313                // String No CallbackHandler available to retrieve a password. We will now try the crypto properties file for a private password
      38: invokevirtual #314                // Method java/util/logging/Logger.info:(Ljava/lang/String;)V
      41: goto          52
      44: aload_0
      45: aload_2
      46: ldc_w         #315                // String No callback handler and no password available
      49: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
      52: aconst_null
      53: areturn
      54: goto          86
      57: astore        6
      59: iload_3
      60: iconst_3
      61: if_icmpne     76
      64: getstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
      67: ldc_w         #313                // String No CallbackHandler available to retrieve a password. We will now try the crypto properties file for a private password
      70: invokevirtual #314                // Method java/util/logging/Logger.info:(Ljava/lang/String;)V
      73: goto          84
      76: aload_0
      77: aload_2
      78: ldc_w         #315                // String No callback handler and no password available
      81: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
      84: aconst_null
      85: areturn
      86: iconst_1
      87: anewarray     #316                // class org/apache/wss4j/common/ext/WSPasswordCallback
      90: dup
      91: iconst_0
      92: new           #316                // class org/apache/wss4j/common/ext/WSPasswordCallback
      95: dup
      96: aload_1
      97: iload_3
      98: invokespecial #317                // Method org/apache/wss4j/common/ext/WSPasswordCallback."<init>":(Ljava/lang/String;I)V
     101: aastore
     102: astore        6
     104: aload         5
     106: aload         6
     108: invokeinterface #318,  2          // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     113: goto          125
     116: astore        7
     118: aload_0
     119: aload_2
     120: aload         7
     122: invokevirtual #319                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/Exception;)V
     125: aload         6
     127: iconst_0
     128: aaload
     129: invokevirtual #320                // Method org/apache/wss4j/common/ext/WSPasswordCallback.getPassword:()Ljava/lang/String;
     132: areturn
    Exception table:
       from    to  target type
          15    53    57   Class java/lang/Exception
         104   113   116   Class java/lang/Exception

  public java.lang.String addWsuIdToElement(org.w3c.dom.Element);
    Code:
       0: aload_1
       1: aconst_null
       2: ldc_w         #311                // String Id
       5: invokeinterface #321,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNodeNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Attr;
      10: astore_3
      11: aload_3
      12: ifnonnull     28
      15: aload_1
      16: ldc_w         #310                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      19: ldc_w         #311                // String Id
      22: invokeinterface #321,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNodeNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Attr;
      27: astore_3
      28: aload_3
      29: ifnull        42
      32: aload_3
      33: invokeinterface #322,  1          // InterfaceMethod org/w3c/dom/Attr.getValue:()Ljava/lang/String;
      38: astore_2
      39: goto          298
      42: aload_0
      43: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      46: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      49: ldc_w         #323                // String _
      52: aload_1
      53: invokeinterface #324,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
      58: astore_2
      59: aconst_null
      60: astore        4
      62: aload_1
      63: ldc_w         #310                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      66: invokeinterface #325,  2          // InterfaceMethod org/w3c/dom/Element.lookupPrefix:(Ljava/lang/String;)Ljava/lang/String;
      71: astore        4
      73: goto          87
      76: astore        5
      78: aload_1
      79: ldc_w         #310                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      82: invokestatic  #327                // Method org/apache/cxf/helpers/DOMUtils.getPrefixRecursive:(Lorg/w3c/dom/Element;Ljava/lang/String;)Ljava/lang/String;
      85: astore        4
      87: aload         4
      89: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
      92: ifne          99
      95: iconst_1
      96: goto          100
      99: iconst_0
     100: istore        5
     102: iconst_0
     103: istore        6
     105: aload         4
     107: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     110: ifeq          189
     113: new           #221                // class java/lang/StringBuilder
     116: dup
     117: invokespecial #222                // Method java/lang/StringBuilder."<init>":()V
     120: ldc_w         #328                // String wsu
     123: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     126: iload         6
     128: ifne          136
     131: ldc           #216                // String
     133: goto          141
     136: iload         6
     138: invokestatic  #329                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     141: invokevirtual #225                // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     144: invokevirtual #226                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     147: astore        4
     149: aload_1
     150: aload         4
     152: invokeinterface #330,  2          // InterfaceMethod org/w3c/dom/Element.lookupNamespaceURI:(Ljava/lang/String;)Ljava/lang/String;
     157: astore        7
     159: goto          172
     162: astore        8
     164: aload_1
     165: aload         4
     167: invokestatic  #331                // Method org/apache/cxf/helpers/DOMUtils.getNamespace:(Lorg/w3c/dom/Node;Ljava/lang/String;)Ljava/lang/String;
     170: astore        7
     172: aload         7
     174: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     177: ifne          186
     180: aconst_null
     181: astore        4
     183: iinc          6, 1
     186: goto          105
     189: iload         5
     191: ifne          247
     194: aload_1
     195: invokeinterface #32,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     200: ldc_w         #332                // String http://www.w3.org/2000/xmlns/
     203: new           #221                // class java/lang/StringBuilder
     206: dup
     207: invokespecial #222                // Method java/lang/StringBuilder."<init>":()V
     210: ldc_w         #333                // String xmlns:
     213: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     216: aload         4
     218: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     221: invokevirtual #226                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     224: invokeinterface #334,  3          // InterfaceMethod org/w3c/dom/Document.createAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Attr;
     229: astore_3
     230: aload_3
     231: ldc_w         #310                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
     234: invokeinterface #335,  2          // InterfaceMethod org/w3c/dom/Attr.setValue:(Ljava/lang/String;)V
     239: aload_1
     240: aload_3
     241: invokeinterface #336,  2          // InterfaceMethod org/w3c/dom/Element.setAttributeNodeNS:(Lorg/w3c/dom/Attr;)Lorg/w3c/dom/Attr;
     246: pop
     247: aload_1
     248: invokeinterface #32,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     253: ldc_w         #310                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
     256: new           #221                // class java/lang/StringBuilder
     259: dup
     260: invokespecial #222                // Method java/lang/StringBuilder."<init>":()V
     263: aload         4
     265: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     268: ldc_w         #337                // String :Id
     271: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     274: invokevirtual #226                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     277: invokeinterface #334,  3          // InterfaceMethod org/w3c/dom/Document.createAttributeNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Attr;
     282: astore_3
     283: aload_3
     284: aload_2
     285: invokeinterface #335,  2          // InterfaceMethod org/w3c/dom/Attr.setValue:(Ljava/lang/String;)V
     290: aload_1
     291: aload_3
     292: invokeinterface #336,  2          // InterfaceMethod org/w3c/dom/Element.setAttributeNodeNS:(Lorg/w3c/dom/Attr;)Lorg/w3c/dom/Attr;
     297: pop
     298: aload_2
     299: areturn
    Exception table:
       from    to  target type
          62    73    76   Class java/lang/Throwable
         149   159   162   Class java/lang/Throwable

  public java.util.List<org.apache.wss4j.common.WSEncryptionPart> getEncryptedParts() throws javax.xml.soap.SOAPException;
    Code:
       0: aconst_null
       1: astore_1
       2: aconst_null
       3: astore_2
       4: aconst_null
       5: astore_3
       6: aload_0
       7: ldc_w         #338                // String EncryptedParts
      10: invokevirtual #339                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
      13: astore        4
      15: aload         4
      17: invokeinterface #340,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
      22: ifne          74
      25: aload         4
      27: invokeinterface #100,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      32: astore        5
      34: aload         5
      36: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      41: ifeq          74
      44: aload         5
      46: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      51: checkcast     #103                // class org/apache/cxf/ws/policy/AssertionInfo
      54: astore        6
      56: aload         6
      58: invokevirtual #104                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      61: checkcast     #341                // class org/apache/wss4j/policy/model/EncryptedParts
      64: astore_1
      65: aload         6
      67: iconst_1
      68: invokevirtual #86                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      71: goto          34
      74: aload_0
      75: ldc_w         #342                // String EncryptedElements
      78: invokevirtual #339                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
      81: astore        4
      83: aload         4
      85: invokeinterface #340,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
      90: ifne          142
      93: aload         4
      95: invokeinterface #100,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     100: astore        5
     102: aload         5
     104: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     109: ifeq          142
     112: aload         5
     114: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     119: checkcast     #103                // class org/apache/cxf/ws/policy/AssertionInfo
     122: astore        6
     124: aload         6
     126: invokevirtual #104                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     129: checkcast     #343                // class org/apache/wss4j/policy/model/EncryptedElements
     132: astore_2
     133: aload         6
     135: iconst_1
     136: invokevirtual #86                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     139: goto          102
     142: aload_0
     143: ldc_w         #344                // String ContentEncryptedElements
     146: invokevirtual #339                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     149: astore        4
     151: aload         4
     153: invokeinterface #340,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
     158: ifne          210
     161: aload         4
     163: invokeinterface #100,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     168: astore        5
     170: aload         5
     172: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     177: ifeq          210
     180: aload         5
     182: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     187: checkcast     #103                // class org/apache/cxf/ws/policy/AssertionInfo
     190: astore        6
     192: aload         6
     194: invokevirtual #104                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     197: checkcast     #345                // class org/apache/wss4j/policy/model/ContentEncryptedElements
     200: astore_3
     201: aload         6
     203: iconst_1
     204: invokevirtual #86                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     207: goto          170
     210: aload_1
     211: ifnonnull     230
     214: aload_2
     215: ifnonnull     230
     218: aload_3
     219: ifnonnull     230
     222: new           #8                  // class java/util/ArrayList
     225: dup
     226: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
     229: areturn
     230: new           #8                  // class java/util/ArrayList
     233: dup
     234: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
     237: astore        5
     239: iconst_0
     240: istore        6
     242: aload_1
     243: ifnull        378
     246: aload_1
     247: invokevirtual #346                // Method org/apache/wss4j/policy/model/EncryptedParts.isBody:()Z
     250: istore        6
     252: aload_1
     253: invokevirtual #347                // Method org/apache/wss4j/policy/model/EncryptedParts.getHeaders:()Ljava/util/List;
     256: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     261: astore        7
     263: aload         7
     265: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     270: ifeq          320
     273: aload         7
     275: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     280: checkcast     #348                // class org/apache/wss4j/policy/model/Header
     283: astore        8
     285: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     288: dup
     289: aload         8
     291: invokevirtual #349                // Method org/apache/wss4j/policy/model/Header.getName:()Ljava/lang/String;
     294: aload         8
     296: invokevirtual #350                // Method org/apache/wss4j/policy/model/Header.getNamespace:()Ljava/lang/String;
     299: ldc_w         #351                // String Header
     302: invokespecial #202                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     305: astore        9
     307: aload         5
     309: aload         9
     311: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     316: pop
     317: goto          263
     320: aload_1
     321: invokevirtual #352                // Method org/apache/wss4j/policy/model/EncryptedParts.getAttachments:()Lorg/apache/wss4j/policy/model/Attachments;
     324: astore        7
     326: aload         7
     328: ifnull        378
     331: ldc           #136                // String Element
     333: astore        8
     335: aload_0
     336: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     339: ldc_w         #353                // String ws-security.swa.encryption.attachment.transform.content
     342: iconst_0
     343: invokestatic  #20                 // Method org/apache/cxf/message/MessageUtils.getContextualBoolean:(Lorg/apache/cxf/message/Message;Ljava/lang/String;Z)Z
     346: ifeq          354
     349: ldc_w         #354                // String Content
     352: astore        8
     354: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     357: dup
     358: ldc_w         #355                // String cid:Attachments
     361: aload         8
     363: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     366: astore        9
     368: aload         5
     370: aload         9
     372: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     377: pop
     378: aload_0
     379: iconst_0
     380: iload         6
     382: aload         5
     384: aload_2
     385: ifnonnull     392
     388: aconst_null
     389: goto          396
     392: aload_2
     393: invokevirtual #356                // Method org/apache/wss4j/policy/model/EncryptedElements.getXPaths:()Ljava/util/List;
     396: aload_3
     397: ifnonnull     404
     400: aconst_null
     401: goto          408
     404: aload_3
     405: invokevirtual #357                // Method org/apache/wss4j/policy/model/ContentEncryptedElements.getXPaths:()Ljava/util/List;
     408: invokevirtual #358                // Method getPartsAndElements:(ZZLjava/util/List;Ljava/util/List;Ljava/util/List;)Ljava/util/List;
     411: areturn

  public java.util.List<org.apache.wss4j.common.WSEncryptionPart> getSignedParts(org.apache.wss4j.policy.model.SupportingTokens) throws javax.xml.soap.SOAPException;
    Code:
       0: iconst_0
       1: istore_2
       2: aconst_null
       3: astore_3
       4: aconst_null
       5: astore        4
       7: aload_1
       8: ifnull        81
      11: aload_1
      12: invokevirtual #359                // Method org/apache/wss4j/policy/model/SupportingTokens.isEndorsing:()Z
      15: ifeq          81
      18: aload_1
      19: invokevirtual #360                // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedParts:()Lorg/apache/wss4j/policy/model/SignedParts;
      22: astore_3
      23: aload_1
      24: invokevirtual #361                // Method org/apache/wss4j/policy/model/SupportingTokens.getSignedElements:()Lorg/apache/wss4j/policy/model/SignedElements;
      27: astore        4
      29: aload_3
      30: ifnull        52
      33: aload_0
      34: getfield      #10                 // Field suppTokenParts:Ljava/util/List;
      37: aload_3
      38: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      43: pop
      44: aload_0
      45: aload_3
      46: invokevirtual #362                // Method org/apache/wss4j/policy/model/SignedParts.getName:()Ljavax/xml/namespace/QName;
      49: invokevirtual #89                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
      52: aload         4
      54: ifnull        254
      57: aload_0
      58: getfield      #10                 // Field suppTokenParts:Ljava/util/List;
      61: aload         4
      63: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      68: pop
      69: aload_0
      70: aload         4
      72: invokevirtual #363                // Method org/apache/wss4j/policy/model/SignedElements.getName:()Ljavax/xml/namespace/QName;
      75: invokevirtual #89                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
      78: goto          254
      81: aload_0
      82: ldc_w         #364                // String SignedParts
      85: invokevirtual #339                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
      88: astore        5
      90: aload         5
      92: invokeinterface #340,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
      97: ifne          167
     100: aload         5
     102: invokeinterface #100,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     107: astore        6
     109: aload         6
     111: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     116: ifeq          167
     119: aload         6
     121: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     126: checkcast     #103                // class org/apache/cxf/ws/policy/AssertionInfo
     129: astore        7
     131: aload         7
     133: invokevirtual #104                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     136: checkcast     #365                // class org/apache/wss4j/policy/model/SignedParts
     139: astore        8
     141: aload         7
     143: iconst_1
     144: invokevirtual #86                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     147: aload_0
     148: getfield      #10                 // Field suppTokenParts:Ljava/util/List;
     151: aload         8
     153: invokeinterface #366,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
     158: ifne          164
     161: aload         8
     163: astore_3
     164: goto          109
     167: aload_0
     168: ldc_w         #367                // String SignedElements
     171: invokevirtual #339                // Method getAllAssertionsByLocalname:(Ljava/lang/String;)Ljava/util/Collection;
     174: astore        5
     176: aload         5
     178: invokeinterface #340,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
     183: ifne          254
     186: aload         5
     188: invokeinterface #100,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     193: astore        6
     195: aload         6
     197: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     202: ifeq          254
     205: aload         6
     207: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     212: checkcast     #103                // class org/apache/cxf/ws/policy/AssertionInfo
     215: astore        7
     217: aload         7
     219: invokevirtual #104                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
     222: checkcast     #368                // class org/apache/wss4j/policy/model/SignedElements
     225: astore        8
     227: aload         7
     229: iconst_1
     230: invokevirtual #86                 // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
     233: aload_0
     234: getfield      #10                 // Field suppTokenParts:Ljava/util/List;
     237: aload         8
     239: invokeinterface #366,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
     244: ifne          251
     247: aload         8
     249: astore        4
     251: goto          195
     254: aload_3
     255: ifnonnull     271
     258: aload         4
     260: ifnonnull     271
     263: new           #8                  // class java/util/ArrayList
     266: dup
     267: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
     270: areturn
     271: new           #8                  // class java/util/ArrayList
     274: dup
     275: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
     278: astore        5
     280: aload_3
     281: ifnull        409
     284: aload_3
     285: invokevirtual #369                // Method org/apache/wss4j/policy/model/SignedParts.isBody:()Z
     288: istore_2
     289: aload_3
     290: invokevirtual #370                // Method org/apache/wss4j/policy/model/SignedParts.getHeaders:()Ljava/util/List;
     293: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     298: astore        6
     300: aload         6
     302: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     307: ifeq          357
     310: aload         6
     312: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     317: checkcast     #348                // class org/apache/wss4j/policy/model/Header
     320: astore        7
     322: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     325: dup
     326: aload         7
     328: invokevirtual #349                // Method org/apache/wss4j/policy/model/Header.getName:()Ljava/lang/String;
     331: aload         7
     333: invokevirtual #350                // Method org/apache/wss4j/policy/model/Header.getNamespace:()Ljava/lang/String;
     336: ldc_w         #351                // String Header
     339: invokespecial #202                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     342: astore        8
     344: aload         5
     346: aload         8
     348: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     353: pop
     354: goto          300
     357: aload_3
     358: invokevirtual #371                // Method org/apache/wss4j/policy/model/SignedParts.getAttachments:()Lorg/apache/wss4j/policy/model/Attachments;
     361: astore        6
     363: aload         6
     365: ifnull        409
     368: ldc           #136                // String Element
     370: astore        7
     372: aload         6
     374: invokevirtual #372                // Method org/apache/wss4j/policy/model/Attachments.isContentSignatureTransform:()Z
     377: ifeq          385
     380: ldc_w         #354                // String Content
     383: astore        7
     385: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     388: dup
     389: ldc_w         #355                // String cid:Attachments
     392: aload         7
     394: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     397: astore        8
     399: aload         5
     401: aload         8
     403: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     408: pop
     409: aload_0
     410: iconst_1
     411: iload_2
     412: aload         5
     414: aload         4
     416: ifnonnull     423
     419: aconst_null
     420: goto          428
     423: aload         4
     425: invokevirtual #373                // Method org/apache/wss4j/policy/model/SignedElements.getXPaths:()Ljava/util/List;
     428: aconst_null
     429: invokevirtual #358                // Method getPartsAndElements:(ZZLjava/util/List;Ljava/util/List;Ljava/util/List;)Ljava/util/List;
     432: areturn

  public java.util.List<org.apache.wss4j.common.WSEncryptionPart> getPartsAndElements(boolean, boolean, java.util.List<org.apache.wss4j.common.WSEncryptionPart>, java.util.List<org.apache.wss4j.policy.model.XPath>, java.util.List<org.apache.wss4j.policy.model.XPath>) throws javax.xml.soap.SOAPException;
    Code:
       0: new           #8                  // class java/util/ArrayList
       3: dup
       4: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
       7: astore        6
       9: new           #8                  // class java/util/ArrayList
      12: dup
      13: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
      16: astore        7
      18: aload         6
      20: aload_0
      21: iload_1
      22: iload_2
      23: aload_3
      24: aload         7
      26: invokevirtual #374                // Method getParts:(ZZLjava/util/List;Ljava/util/List;)Ljava/util/List;
      29: invokeinterface #375,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
      34: pop
      35: aload         6
      37: aload_0
      38: ldc_w         #351                // String Header
      41: aload         4
      43: aload         7
      45: iload_1
      46: invokevirtual #376                // Method getElements:(Ljava/lang/String;Ljava/util/List;Ljava/util/List;Z)Ljava/util/List;
      49: invokeinterface #375,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
      54: pop
      55: iload_1
      56: ifne          79
      59: aload         6
      61: aload_0
      62: ldc_w         #354                // String Content
      65: aload         5
      67: aload         7
      69: iload_1
      70: invokevirtual #376                // Method getElements:(Ljava/lang/String;Ljava/util/List;Ljava/util/List;Z)Ljava/util/List;
      73: invokeinterface #375,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
      78: pop
      79: aload         6
      81: areturn

  protected java.util.List<org.apache.wss4j.common.WSEncryptionPart> getParts(boolean, boolean, java.util.List<org.apache.wss4j.common.WSEncryptionPart>, java.util.List<org.w3c.dom.Element>) throws javax.xml.soap.SOAPException;
    Code:
       0: new           #8                  // class java/util/ArrayList
       3: dup
       4: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
       7: astore        5
       9: iload_2
      10: ifeq          136
      13: aload         4
      15: aload_0
      16: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
      19: invokestatic  #30                 // Method org/apache/cxf/binding/soap/saaj/SAAJUtils.getBody:(Ljavax/xml/soap/SOAPMessage;)Ljavax/xml/soap/SOAPBody;
      22: invokeinterface #366,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
      27: ifne          136
      30: aload         4
      32: aload_0
      33: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
      36: invokestatic  #30                 // Method org/apache/cxf/binding/soap/saaj/SAAJUtils.getBody:(Ljavax/xml/soap/SOAPMessage;)Ljavax/xml/soap/SOAPBody;
      39: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      44: pop
      45: aload_0
      46: aload_0
      47: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
      50: invokestatic  #30                 // Method org/apache/cxf/binding/soap/saaj/SAAJUtils.getBody:(Ljavax/xml/soap/SOAPMessage;)Ljavax/xml/soap/SOAPBody;
      53: invokevirtual #377                // Method addWsuIdToElement:(Lorg/w3c/dom/Element;)Ljava/lang/String;
      56: astore        6
      58: iload_1
      59: ifeq          100
      62: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
      65: dup
      66: aload         6
      68: ldc           #136                // String Element
      70: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      73: astore        7
      75: aload         7
      77: aload_0
      78: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
      81: invokestatic  #30                 // Method org/apache/cxf/binding/soap/saaj/SAAJUtils.getBody:(Ljavax/xml/soap/SOAPMessage;)Ljavax/xml/soap/SOAPBody;
      84: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
      87: aload         5
      89: aload         7
      91: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      96: pop
      97: goto          136
     100: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     103: dup
     104: aload         6
     106: ldc_w         #354                // String Content
     109: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     112: astore        7
     114: aload         7
     116: aload_0
     117: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     120: invokestatic  #30                 // Method org/apache/cxf/binding/soap/saaj/SAAJUtils.getBody:(Ljavax/xml/soap/SOAPMessage;)Ljavax/xml/soap/SOAPBody;
     123: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     126: aload         5
     128: aload         7
     130: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     135: pop
     136: aload_0
     137: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     140: invokestatic  #378                // Method org/apache/cxf/binding/soap/saaj/SAAJUtils.getHeader:(Ljavax/xml/soap/SOAPMessage;)Ljavax/xml/soap/SOAPHeader;
     143: astore        6
     145: aload_3
     146: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     151: astore        7
     153: aload         7
     155: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     160: ifeq          353
     163: aload         7
     165: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     170: checkcast     #135                // class org/apache/wss4j/common/WSEncryptionPart
     173: astore        8
     175: aload         8
     177: invokevirtual #379                // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
     180: ifnull        210
     183: aload         8
     185: invokevirtual #379                // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
     188: ldc_w         #380                // String cid:
     191: invokevirtual #381                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     194: ifeq          210
     197: aload         5
     199: aload         8
     201: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     206: pop
     207: goto          153
     210: aload         8
     212: invokevirtual #382                // Method org/apache/wss4j/common/WSEncryptionPart.getName:()Ljava/lang/String;
     215: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     218: ifeq          236
     221: aload         6
     223: aload         8
     225: invokevirtual #383                // Method org/apache/wss4j/common/WSEncryptionPart.getNamespace:()Ljava/lang/String;
     228: invokestatic  #384                // Method org/apache/cxf/helpers/DOMUtils.getChildrenWithNamespace:(Lorg/w3c/dom/Element;Ljava/lang/String;)Ljava/util/List;
     231: astore        9
     233: goto          253
     236: aload         6
     238: aload         8
     240: invokevirtual #383                // Method org/apache/wss4j/common/WSEncryptionPart.getNamespace:()Ljava/lang/String;
     243: aload         8
     245: invokevirtual #382                // Method org/apache/wss4j/common/WSEncryptionPart.getName:()Ljava/lang/String;
     248: invokestatic  #385                // Method org/apache/cxf/helpers/DOMUtils.getChildrenWithName:(Lorg/w3c/dom/Element;Ljava/lang/String;Ljava/lang/String;)Ljava/util/List;
     251: astore        9
     253: aload         9
     255: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     260: astore        10
     262: aload         10
     264: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     269: ifeq          350
     272: aload         10
     274: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     279: checkcast     #196                // class org/w3c/dom/Element
     282: astore        11
     284: aload         4
     286: aload         11
     288: invokeinterface #366,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
     293: ifne          347
     296: aload         4
     298: aload         11
     300: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     305: pop
     306: aload_0
     307: aload         11
     309: invokevirtual #377                // Method addWsuIdToElement:(Lorg/w3c/dom/Element;)Ljava/lang/String;
     312: astore        12
     314: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     317: dup
     318: aload         12
     320: aload         8
     322: invokevirtual #386                // Method org/apache/wss4j/common/WSEncryptionPart.getEncModifier:()Ljava/lang/String;
     325: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     328: astore        13
     330: aload         13
     332: aload         11
     334: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     337: aload         5
     339: aload         13
     341: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     346: pop
     347: goto          262
     350: goto          153
     353: aload         5
     355: areturn

  protected java.util.List<org.apache.wss4j.common.WSEncryptionPart> getElements(java.lang.String, java.util.List<org.apache.wss4j.policy.model.XPath>, java.util.List<org.w3c.dom.Element>, boolean) throws javax.xml.soap.SOAPException;
    Code:
       0: new           #8                  // class java/util/ArrayList
       3: dup
       4: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
       7: astore        5
       9: aload_2
      10: ifnull        255
      13: aload_2
      14: invokeinterface #387,  1          // InterfaceMethod java/util/List.isEmpty:()Z
      19: ifne          255
      22: invokestatic  #388                // Method javax/xml/xpath/XPathFactory.newInstance:()Ljavax/xml/xpath/XPathFactory;
      25: astore        6
      27: aload_2
      28: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      33: astore        7
      35: aload         7
      37: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      42: ifeq          255
      45: aload         7
      47: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      52: checkcast     #389                // class org/apache/wss4j/policy/model/XPath
      55: astore        8
      57: aload         6
      59: invokevirtual #390                // Method javax/xml/xpath/XPathFactory.newXPath:()Ljavax/xml/xpath/XPath;
      62: astore        9
      64: aload         8
      66: invokevirtual #391                // Method org/apache/wss4j/policy/model/XPath.getPrefixNamespaceMap:()Ljava/util/Map;
      69: ifnull        91
      72: aload         9
      74: new           #392                // class org/apache/cxf/helpers/MapNamespaceContext
      77: dup
      78: aload         8
      80: invokevirtual #391                // Method org/apache/wss4j/policy/model/XPath.getPrefixNamespaceMap:()Ljava/util/Map;
      83: invokespecial #393                // Method org/apache/cxf/helpers/MapNamespaceContext."<init>":(Ljava/util/Map;)V
      86: invokeinterface #394,  2          // InterfaceMethod javax/xml/xpath/XPath.setNamespaceContext:(Ljavax/xml/namespace/NamespaceContext;)V
      91: aconst_null
      92: astore        10
      94: aload         9
      96: aload         8
      98: invokevirtual #395                // Method org/apache/wss4j/policy/model/XPath.getXPath:()Ljava/lang/String;
     101: aload_0
     102: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     105: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     108: invokevirtual #396                // Method javax/xml/soap/SOAPPart.getEnvelope:()Ljavax/xml/soap/SOAPEnvelope;
     111: getstatic     #397                // Field javax/xml/xpath/XPathConstants.NODESET:Ljavax/xml/namespace/QName;
     114: invokeinterface #398,  4          // InterfaceMethod javax/xml/xpath/XPath.evaluate:(Ljava/lang/String;Ljava/lang/Object;Ljavax/xml/namespace/QName;)Ljava/lang/Object;
     119: checkcast     #399                // class org/w3c/dom/NodeList
     122: astore        10
     124: goto          143
     127: astore        11
     129: getstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
     132: getstatic     #401                // Field java/util/logging/Level.WARNING:Ljava/util/logging/Level;
     135: ldc_w         #402                // String Failure in evaluating an XPath expression
     138: aload         11
     140: invokevirtual #172                // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     143: aload         10
     145: ifnull        252
     148: iconst_0
     149: istore        11
     151: iload         11
     153: aload         10
     155: invokeinterface #403,  1          // InterfaceMethod org/w3c/dom/NodeList.getLength:()I
     160: if_icmpge     252
     163: aload         10
     165: iload         11
     167: invokeinterface #404,  2          // InterfaceMethod org/w3c/dom/NodeList.item:(I)Lorg/w3c/dom/Node;
     172: checkcast     #196                // class org/w3c/dom/Element
     175: astore        12
     177: aload_3
     178: aload         12
     180: invokeinterface #366,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
     185: ifne          246
     188: aload_3
     189: aload         12
     191: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     196: pop
     197: aload_0
     198: aload         12
     200: iload         4
     202: invokespecial #405                // Method setIdOnElement:(Lorg/w3c/dom/Element;Z)Ljava/lang/String;
     205: astore        13
     207: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     210: dup
     211: aload         13
     213: aload_1
     214: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     217: astore        14
     219: aload         14
     221: aload         12
     223: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     226: aload         14
     228: aload         8
     230: invokevirtual #395                // Method org/apache/wss4j/policy/model/XPath.getXPath:()Ljava/lang/String;
     233: invokevirtual #406                // Method org/apache/wss4j/common/WSEncryptionPart.setXpath:(Ljava/lang/String;)V
     236: aload         5
     238: aload         14
     240: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     245: pop
     246: iinc          11, 1
     249: goto          151
     252: goto          35
     255: aload         5
     257: areturn
    Exception table:
       from    to  target type
          94   124   127   Class javax/xml/xpath/XPathExpressionException

  private java.lang.String setIdOnElement(org.w3c.dom.Element, boolean);
    Code:
       0: iload_2
       1: ifeq          10
       4: aload_0
       5: aload_1
       6: invokevirtual #377                // Method addWsuIdToElement:(Lorg/w3c/dom/Element;)Ljava/lang/String;
       9: areturn
      10: aload_1
      11: aconst_null
      12: ldc_w         #311                // String Id
      15: invokeinterface #321,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNodeNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Attr;
      20: astore_3
      21: aload_3
      22: ifnonnull     38
      25: aload_1
      26: ldc_w         #310                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd
      29: ldc_w         #311                // String Id
      32: invokeinterface #321,  3          // InterfaceMethod org/w3c/dom/Element.getAttributeNodeNS:(Ljava/lang/String;Ljava/lang/String;)Lorg/w3c/dom/Attr;
      37: astore_3
      38: aload_3
      39: ifnull        49
      42: aload_3
      43: invokeinterface #322,  1          // InterfaceMethod org/w3c/dom/Attr.getValue:()Ljava/lang/String;
      48: areturn
      49: aconst_null
      50: areturn

  protected org.apache.wss4j.dom.message.WSSecEncryptedKey getEncryptedKeyBuilder(org.apache.wss4j.policy.model.AbstractToken) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #407                // class org/apache/wss4j/dom/message/WSSecEncryptedKey
       3: dup
       4: invokespecial #408                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey."<init>":()V
       7: astore_2
       8: aload_2
       9: aload_0
      10: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      13: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      16: invokevirtual #409                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      19: aload_2
      20: aload_0
      21: getfield      #34                 // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      24: invokevirtual #410                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
      27: aload_2
      28: new           #411                // class org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler
      31: dup
      32: aload_0
      33: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      36: invokespecial #412                // Method org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler."<init>":(Lorg/apache/cxf/binding/soap/SoapMessage;)V
      39: invokevirtual #413                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setAttachmentCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
      42: aload_2
      43: aload_0
      44: getfield      #22                 // Field storeBytesInAttachment:Z
      47: invokevirtual #414                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setStoreBytesInAttachment:(Z)V
      50: aload_0
      51: invokevirtual #415                // Method getEncryptionCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
      54: astore_3
      55: aload_0
      56: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      59: invokevirtual #16                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
      62: ldc_w         #416                // String security.encryption.crypto
      65: aload_3
      66: invokeinterface #18,  3           // InterfaceMethod org/apache/cxf/message/Exchange.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      71: pop
      72: aload_0
      73: aload_2
      74: aload_1
      75: invokevirtual #417                // Method setKeyIdentifierType:(Lorg/apache/wss4j/dom/message/WSSecBase;Lorg/apache/wss4j/policy/model/AbstractToken;)V
      78: iconst_0
      79: istore        4
      81: aload_1
      82: instanceof    #178                // class org/apache/wss4j/policy/model/X509Token
      85: ifeq          109
      88: aload_1
      89: invokevirtual #115                // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      92: getstatic     #418                // Field org/apache/wss4j/policy/SPConstants$IncludeTokenType.INCLUDE_TOKEN_NEVER:Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      95: if_acmpeq     109
      98: aload_2
      99: invokevirtual #419                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.getKeyIdentifierType:()I
     102: iconst_1
     103: if_icmpeq     109
     106: iconst_1
     107: istore        4
     109: aload_0
     110: aload_2
     111: aload_1
     112: iconst_0
     113: aload_3
     114: invokevirtual #420                // Method setEncryptionUser:(Lorg/apache/wss4j/dom/message/WSSecEncryptedKey;Lorg/apache/wss4j/policy/model/AbstractToken;ZLorg/apache/wss4j/common/crypto/Crypto;)Ljava/lang/String;
     117: astore        5
     119: aload_0
     120: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     123: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     126: invokevirtual #421                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     129: astore        6
     131: aload_2
     132: aload         6
     134: invokevirtual #422                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getEncryption:()Ljava/lang/String;
     137: invokevirtual #423                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setSymmetricEncAlgorithm:(Ljava/lang/String;)V
     140: aload_2
     141: aload         6
     143: invokevirtual #424                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getAsymmetricKeyWrap:()Ljava/lang/String;
     146: invokevirtual #425                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setKeyEncAlgo:(Ljava/lang/String;)V
     149: aload_2
     150: aload         6
     152: invokevirtual #426                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getMGFAlgo:()Ljava/lang/String;
     155: invokevirtual #427                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setMGFAlgorithm:(Ljava/lang/String;)V
     158: aload_2
     159: aload_0
     160: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     163: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     166: aload_3
     167: invokevirtual #428                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;)V
     170: iload         4
     172: ifeq          262
     175: aload_0
     176: aload_3
     177: aload         5
     179: invokespecial #429                // Method getEncryptCert:(Lorg/apache/wss4j/common/crypto/Crypto;Ljava/lang/String;)Ljava/security/cert/X509Certificate;
     182: astore        7
     184: new           #430                // class org/apache/wss4j/common/token/X509Security
     187: dup
     188: aload_0
     189: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     192: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     195: invokespecial #431                // Method org/apache/wss4j/common/token/X509Security."<init>":(Lorg/w3c/dom/Document;)V
     198: astore        8
     200: aload         8
     202: checkcast     #430                // class org/apache/wss4j/common/token/X509Security
     205: aload         7
     207: invokevirtual #432                // Method org/apache/wss4j/common/token/X509Security.setX509Certificate:(Ljava/security/cert/X509Certificate;)V
     210: aload         8
     212: invokevirtual #433                // Method org/apache/wss4j/common/token/BinarySecurity.addWSUNamespace:()V
     215: aload         8
     217: aload_0
     218: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
     221: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     224: ldc_w         #434                // String X509-
     227: aload         7
     229: invokeinterface #230,  3          // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createSecureId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     234: invokevirtual #435                // Method org/apache/wss4j/common/token/BinarySecurity.setID:(Ljava/lang/String;)V
     237: aload_0
     238: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     241: invokevirtual #36                 // Method org/apache/wss4j/dom/message/WSSecHeader.getSecurityHeader:()Lorg/w3c/dom/Element;
     244: aload         8
     246: invokevirtual #209                // Method org/apache/wss4j/common/token/BinarySecurity.getElement:()Lorg/w3c/dom/Element;
     249: invokestatic  #436                // Method org/apache/wss4j/dom/util/WSSecurityUtil.prependChildElement:(Lorg/w3c/dom/Element;Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     252: pop
     253: aload_0
     254: aload         8
     256: invokevirtual #209                // Method org/apache/wss4j/common/token/BinarySecurity.getElement:()Lorg/w3c/dom/Element;
     259: putfield      #437                // Field bstElement:Lorg/w3c/dom/Element;
     262: aload_2
     263: areturn

  private java.security.cert.X509Certificate getEncryptCert(org.apache.wss4j.common.crypto.Crypto, java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: ldc_w         #438                // String security.encryption.certificate
       3: aload_0
       4: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       7: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      10: checkcast     #439                // class java/security/cert/X509Certificate
      13: astore_3
      14: aload_3
      15: ifnull        20
      18: aload_3
      19: areturn
      20: new           #440                // class org/apache/wss4j/common/crypto/CryptoType
      23: dup
      24: getstatic     #441                // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ALIAS:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
      27: invokespecial #442                // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
      30: astore        4
      32: aload         4
      34: aload_2
      35: invokevirtual #443                // Method org/apache/wss4j/common/crypto/CryptoType.setAlias:(Ljava/lang/String;)V
      38: aload_1
      39: aload         4
      41: invokeinterface #444,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
      46: astore        5
      48: aload         5
      50: ifnull        64
      53: aload         5
      55: arraylength
      56: ifle          64
      59: aload         5
      61: iconst_0
      62: aaload
      63: areturn
      64: aconst_null
      65: areturn

  public org.apache.wss4j.common.crypto.Crypto getSignatureCrypto() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: ldc_w         #445                // String security.signature.crypto
       4: ldc_w         #446                // String security.signature.properties
       7: invokevirtual #447                // Method getCrypto:(Ljava/lang/String;Ljava/lang/String;)Lorg/apache/wss4j/common/crypto/Crypto;
      10: areturn

  public org.apache.wss4j.common.crypto.Crypto getEncryptionCrypto() throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: ldc_w         #416                // String security.encryption.crypto
       4: ldc_w         #448                // String security.encryption.properties
       7: invokevirtual #447                // Method getCrypto:(Ljava/lang/String;Ljava/lang/String;)Lorg/apache/wss4j/common/crypto/Crypto;
      10: astore_1
      11: iconst_0
      12: istore_2
      13: ldc_w         #449                // String security.enableRevocation
      16: aload_0
      17: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      20: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      23: checkcast     #61                 // class java/lang/String
      26: astore_3
      27: aload_3
      28: ifnull        36
      31: aload_3
      32: invokestatic  #450                // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
      35: istore_2
      36: iload_2
      37: ifeq          137
      40: aload_1
      41: ifnull        137
      44: new           #440                // class org/apache/wss4j/common/crypto/CryptoType
      47: dup
      48: getstatic     #441                // Field org/apache/wss4j/common/crypto/CryptoType$TYPE.ALIAS:Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;
      51: invokespecial #442                // Method org/apache/wss4j/common/crypto/CryptoType."<init>":(Lorg/apache/wss4j/common/crypto/CryptoType$TYPE;)V
      54: astore        4
      56: ldc_w         #451                // String security.encryption.username
      59: aload_0
      60: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      63: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      66: checkcast     #61                 // class java/lang/String
      69: astore        5
      71: aload         5
      73: ifnonnull     99
      76: aload_1
      77: invokeinterface #452,  1          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getDefaultX509Identifier:()Ljava/lang/String;
      82: astore        5
      84: goto          99
      87: astore        6
      89: new           #173                // class org/apache/cxf/interceptor/Fault
      92: dup
      93: aload         6
      95: invokespecial #174                // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
      98: athrow
      99: aload         4
     101: aload         5
     103: invokevirtual #443                // Method org/apache/wss4j/common/crypto/CryptoType.setAlias:(Ljava/lang/String;)V
     106: aload_1
     107: aload         4
     109: invokeinterface #444,  2          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getX509Certificates:(Lorg/apache/wss4j/common/crypto/CryptoType;)[Ljava/security/cert/X509Certificate;
     114: astore        6
     116: aload         6
     118: ifnull        137
     121: aload         6
     123: arraylength
     124: ifle          137
     127: aload_1
     128: aload         6
     130: iload_2
     131: aconst_null
     132: invokeinterface #453,  4          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.verifyTrust:([Ljava/security/cert/X509Certificate;ZLjava/util/Collection;)V
     137: aload_1
     138: areturn
    Exception table:
       from    to  target type
          76    84    87   Class org/apache/wss4j/common/ext/WSSecurityException

  protected org.apache.wss4j.common.crypto.Crypto getCrypto(java.lang.String, java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: aload_0
       2: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       5: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
       8: checkcast     #454                // class org/apache/wss4j/common/crypto/Crypto
      11: astore_3
      12: aload_3
      13: ifnull        18
      16: aload_3
      17: areturn
      18: aload_2
      19: aload_0
      20: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      23: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      26: astore        4
      28: aload         4
      30: ifnonnull     35
      33: aconst_null
      34: areturn
      35: aload_0
      36: invokevirtual #455                // Method getCryptoCache:()Ljava/util/Map;
      39: aload         4
      41: invokeinterface #456,  2          // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      46: checkcast     #454                // class org/apache/wss4j/common/crypto/Crypto
      49: astore_3
      50: aload_3
      51: ifnull        56
      54: aload_3
      55: areturn
      56: aload_0
      57: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      60: aload         4
      62: invokestatic  #457                // Method org/apache/cxf/rt/security/utils/SecurityUtils.loadResource:(Lorg/apache/cxf/message/Message;Ljava/lang/Object;)Ljava/net/URL;
      65: astore        5
      67: aload         4
      69: aload         5
      71: invokestatic  #458                // Method org/apache/cxf/ws/security/wss4j/WSS4JUtils.getProps:(Ljava/lang/Object;Ljava/net/URL;)Ljava/util/Properties;
      74: astore        6
      76: aload         6
      78: ifnull        110
      81: aload         6
      83: ldc_w         #459                // class org/apache/wss4j/common/crypto/CryptoFactory
      86: invokestatic  #460                // Method org/apache/wss4j/common/util/Loader.getClassLoader:(Ljava/lang/Class;)Ljava/lang/ClassLoader;
      89: aload_0
      90: invokevirtual #461                // Method getPasswordEncryptor:()Lorg/apache/wss4j/common/crypto/PasswordEncryptor;
      93: invokestatic  #462                // Method org/apache/wss4j/common/crypto/CryptoFactory.getInstance:(Ljava/util/Properties;Ljava/lang/ClassLoader;Lorg/apache/wss4j/common/crypto/PasswordEncryptor;)Lorg/apache/wss4j/common/crypto/Crypto;
      96: astore_3
      97: aload_0
      98: invokevirtual #455                // Method getCryptoCache:()Ljava/util/Map;
     101: aload         4
     103: aload_3
     104: invokeinterface #463,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     109: pop
     110: aload_3
     111: areturn

  protected org.apache.wss4j.common.crypto.PasswordEncryptor getPasswordEncryptor();
    Code:
       0: aload_0
       1: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       4: ldc_w         #464                // String ws-security.password.encryptor.instance
       7: invokevirtual #50                 // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      10: checkcast     #465                // class org/apache/wss4j/common/crypto/PasswordEncryptor
      13: astore_1
      14: aload_1
      15: ifnull        20
      18: aload_1
      19: areturn
      20: ldc_w         #312                // String security.callback-handler
      23: aload_0
      24: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      27: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      30: astore_2
      31: aload_2
      32: invokestatic  #282                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getCallbackHandler:(Ljava/lang/Object;)Ljavax/security/auth/callback/CallbackHandler;
      35: astore_3
      36: aload_3
      37: ifnull        49
      40: new           #466                // class org/apache/wss4j/common/crypto/JasyptPasswordEncryptor
      43: dup
      44: aload_3
      45: invokespecial #467                // Method org/apache/wss4j/common/crypto/JasyptPasswordEncryptor."<init>":(Ljavax/security/auth/callback/CallbackHandler;)V
      48: areturn
      49: goto          55
      52: astore_3
      53: aconst_null
      54: areturn
      55: aconst_null
      56: areturn
    Exception table:
       from    to  target type
          31    48    52   Class java/lang/Exception

  public void setKeyIdentifierType(org.apache.wss4j.dom.message.WSSecBase, org.apache.wss4j.policy.model.AbstractToken);
    Code:
       0: iconst_0
       1: istore_3
       2: aload_2
       3: instanceof    #178                // class org/apache/wss4j/policy/model/X509Token
       6: ifeq          70
       9: aload_2
      10: checkcast     #178                // class org/apache/wss4j/policy/model/X509Token
      13: astore        4
      15: aload         4
      17: invokevirtual #468                // Method org/apache/wss4j/policy/model/X509Token.isRequireIssuerSerialReference:()Z
      20: ifeq          33
      23: aload_1
      24: iconst_2
      25: invokevirtual #469                // Method org/apache/wss4j/dom/message/WSSecBase.setKeyIdentifierType:(I)V
      28: iconst_1
      29: istore_3
      30: goto          67
      33: aload         4
      35: invokevirtual #470                // Method org/apache/wss4j/policy/model/X509Token.isRequireKeyIdentifierReference:()Z
      38: ifeq          51
      41: aload_1
      42: iconst_4
      43: invokevirtual #469                // Method org/apache/wss4j/dom/message/WSSecBase.setKeyIdentifierType:(I)V
      46: iconst_1
      47: istore_3
      48: goto          67
      51: aload         4
      53: invokevirtual #471                // Method org/apache/wss4j/policy/model/X509Token.isRequireThumbprintReference:()Z
      56: ifeq          67
      59: aload_1
      60: bipush        8
      62: invokevirtual #469                // Method org/apache/wss4j/dom/message/WSSecBase.setKeyIdentifierType:(I)V
      65: iconst_1
      66: istore_3
      67: goto          85
      70: aload_2
      71: instanceof    #184                // class org/apache/wss4j/policy/model/KeyValueToken
      74: ifeq          85
      77: aload_1
      78: bipush        13
      80: invokevirtual #469                // Method org/apache/wss4j/dom/message/WSSecBase.setKeyIdentifierType:(I)V
      83: iconst_1
      84: istore_3
      85: aload_0
      86: aload_2
      87: invokevirtual #114                // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
      90: iload_3
      91: ifne          237
      94: aload_0
      95: invokevirtual #472                // Method isRequestor:()Z
      98: istore        4
     100: aload_2
     101: invokevirtual #115                // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     104: getstatic     #418                // Field org/apache/wss4j/policy/SPConstants$IncludeTokenType.INCLUDE_TOKEN_NEVER:Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     107: if_acmpeq     147
     110: aload_2
     111: instanceof    #178                // class org/apache/wss4j/policy/model/X509Token
     114: ifeq          232
     117: aload_2
     118: invokevirtual #115                // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     121: getstatic     #473                // Field org/apache/wss4j/policy/SPConstants$IncludeTokenType.INCLUDE_TOKEN_ALWAYS_TO_RECIPIENT:Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     124: if_acmpne     132
     127: iload         4
     129: ifeq          147
     132: aload_2
     133: invokevirtual #115                // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     136: getstatic     #474                // Field org/apache/wss4j/policy/SPConstants$IncludeTokenType.INCLUDE_TOKEN_ALWAYS_TO_INITIATOR:Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     139: if_acmpne     232
     142: iload         4
     144: ifeq          232
     147: aload_0
     148: invokevirtual #475                // Method getWss10:()Lorg/apache/wss4j/policy/model/Wss10;
     151: astore        5
     153: aload_0
     154: aload         5
     156: invokevirtual #180                // Method assertPolicy:(Lorg/apache/neethi/Assertion;)V
     159: aload         5
     161: ifnull        172
     164: aload         5
     166: invokevirtual #476                // Method org/apache/wss4j/policy/model/Wss10.isMustSupportRefKeyIdentifier:()Z
     169: ifeq          180
     172: aload_1
     173: iconst_4
     174: invokevirtual #469                // Method org/apache/wss4j/dom/message/WSSecBase.setKeyIdentifierType:(I)V
     177: goto          229
     180: aload         5
     182: invokevirtual #477                // Method org/apache/wss4j/policy/model/Wss10.isMustSupportRefIssuerSerial:()Z
     185: ifeq          196
     188: aload_1
     189: iconst_2
     190: invokevirtual #469                // Method org/apache/wss4j/dom/message/WSSecBase.setKeyIdentifierType:(I)V
     193: goto          229
     196: aload         5
     198: instanceof    #478                // class org/apache/wss4j/policy/model/Wss11
     201: ifeq          224
     204: aload         5
     206: checkcast     #478                // class org/apache/wss4j/policy/model/Wss11
     209: invokevirtual #479                // Method org/apache/wss4j/policy/model/Wss11.isMustSupportRefThumbprint:()Z
     212: ifeq          224
     215: aload_1
     216: bipush        8
     218: invokevirtual #469                // Method org/apache/wss4j/dom/message/WSSecBase.setKeyIdentifierType:(I)V
     221: goto          229
     224: aload_1
     225: iconst_2
     226: invokevirtual #469                // Method org/apache/wss4j/dom/message/WSSecBase.setKeyIdentifierType:(I)V
     229: goto          237
     232: aload_1
     233: iconst_1
     234: invokevirtual #469                // Method org/apache/wss4j/dom/message/WSSecBase.setKeyIdentifierType:(I)V
     237: return

  public java.lang.String setEncryptionUser(org.apache.wss4j.dom.message.WSSecEncryptedKey, org.apache.wss4j.policy.model.AbstractToken, boolean, org.apache.wss4j.common.crypto.Crypto);
    Code:
       0: ldc_w         #438                // String security.encryption.certificate
       3: aload_0
       4: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       7: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      10: checkcast     #439                // class java/security/cert/X509Certificate
      13: astore        5
      15: aload         5
      17: ifnull        28
      20: aload_1
      21: aload         5
      23: invokevirtual #480                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setUseThisCert:(Ljava/security/cert/X509Certificate;)V
      26: aconst_null
      27: areturn
      28: iload_3
      29: ifeq          38
      32: ldc_w         #289                // String security.signature.username
      35: goto          41
      38: ldc_w         #451                // String security.encryption.username
      41: astore        6
      43: aload         6
      45: aload_0
      46: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      49: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      52: checkcast     #61                 // class java/lang/String
      55: astore        7
      57: aload         4
      59: ifnull        101
      62: aload         7
      64: ifnull        77
      67: ldc           #216                // String
      69: aload         7
      71: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      74: ifeq          101
      77: aload         4
      79: invokeinterface #452,  1          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getDefaultX509Identifier:()Ljava/lang/String;
      84: astore        7
      86: goto          101
      89: astore        8
      91: new           #173                // class org/apache/cxf/interceptor/Fault
      94: dup
      95: aload         8
      97: invokespecial #174                // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     100: athrow
     101: aload         7
     103: ifnull        116
     106: ldc           #216                // String
     108: aload         7
     110: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     113: ifeq          159
     116: aload_0
     117: aload_2
     118: new           #221                // class java/lang/StringBuilder
     121: dup
     122: invokespecial #222                // Method java/lang/StringBuilder."<init>":()V
     125: ldc_w         #481                // String A
     128: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     131: iload_3
     132: ifeq          141
     135: ldc_w         #482                // String signature
     138: goto          144
     141: ldc_w         #483                // String encryption
     144: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     147: ldc_w         #484                // String  username needs to be declared.
     150: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     153: invokevirtual #226                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     156: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     159: ldc_w         #485                // String useReqSigCert
     162: aload         7
     164: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     167: ifeq          242
     170: aload_0
     171: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     174: invokevirtual #16                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
     177: invokeinterface #486,  1          // InterfaceMethod org/apache/cxf/message/Exchange.getInMessage:()Lorg/apache/cxf/message/Message;
     182: ldc_w         #487                // String RECV_RESULTS
     185: invokeinterface #488,  2          // InterfaceMethod org/apache/cxf/message/Message.get:(Ljava/lang/Object;)Ljava/lang/Object;
     190: checkcast     #489                // class java/util/List
     193: invokestatic  #490                // Method org/apache/cxf/helpers/CastUtils.cast:(Ljava/util/List;)Ljava/util/List;
     196: astore        8
     198: aload         8
     200: ifnull        231
     203: aload_1
     204: aload         8
     206: invokestatic  #491                // Method org/apache/cxf/ws/security/wss4j/WSS4JUtils.getReqSigCert:(Ljava/util/List;)Ljava/security/cert/X509Certificate;
     209: invokevirtual #480                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setUseThisCert:(Ljava/security/cert/X509Certificate;)V
     212: aload_1
     213: invokevirtual #492                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.isCertSet:()Z
     216: ifeq          239
     219: aload_1
     220: aload         8
     222: invokestatic  #493                // Method getUsername:(Ljava/util/List;)Ljava/lang/String;
     225: invokevirtual #494                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setUserInfo:(Ljava/lang/String;)V
     228: goto          239
     231: aload_0
     232: aload_2
     233: ldc_w         #495                // String No security results in incoming message
     236: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     239: goto          248
     242: aload_1
     243: aload         7
     245: invokevirtual #494                // Method org/apache/wss4j/dom/message/WSSecEncryptedKey.setUserInfo:(Ljava/lang/String;)V
     248: aload         7
     250: areturn
    Exception table:
       from    to  target type
          77    86    89   Class org/apache/wss4j/common/ext/WSSecurityException

  public static java.lang.String getUsername(java.util.List<org.apache.wss4j.dom.handler.WSHandlerResult>);
    Code:
       0: aload_0
       1: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
       6: astore_1
       7: aload_1
       8: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      13: ifeq          110
      16: aload_1
      17: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      22: checkcast     #496                // class org/apache/wss4j/dom/handler/WSHandlerResult
      25: astore_2
      26: aload_2
      27: invokevirtual #497                // Method org/apache/wss4j/dom/handler/WSHandlerResult.getResults:()Ljava/util/List;
      30: astore_3
      31: aload_3
      32: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      37: astore        4
      39: aload         4
      41: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      46: ifeq          107
      49: aload         4
      51: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      56: checkcast     #498                // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
      59: astore        5
      61: aload         5
      63: ldc_w         #499                // String action
      66: invokevirtual #500                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      69: checkcast     #501                // class java/lang/Integer
      72: astore        6
      74: aload         6
      76: invokevirtual #502                // Method java/lang/Integer.intValue:()I
      79: iconst_1
      80: if_icmpne     104
      83: aload         5
      85: ldc_w         #503                // String principal
      88: invokevirtual #500                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
      91: checkcast     #504                // class org/apache/wss4j/common/principal/UsernameTokenPrincipal
      94: astore        7
      96: aload         7
      98: invokeinterface #505,  1          // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.getName:()Ljava/lang/String;
     103: areturn
     104: goto          39
     107: goto          7
     110: aconst_null
     111: areturn

  protected org.apache.wss4j.dom.engine.WSSecurityEngineResult getEncryptedKeyResult();
    Code:
       0: aload_0
       1: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
       4: invokevirtual #16                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
       7: invokeinterface #486,  1          // InterfaceMethod org/apache/cxf/message/Exchange.getInMessage:()Lorg/apache/cxf/message/Message;
      12: ldc_w         #487                // String RECV_RESULTS
      15: invokeinterface #488,  2          // InterfaceMethod org/apache/cxf/message/Message.get:(Ljava/lang/Object;)Ljava/lang/Object;
      20: checkcast     #489                // class java/util/List
      23: invokestatic  #490                // Method org/apache/cxf/helpers/CastUtils.cast:(Ljava/util/List;)Ljava/util/List;
      26: astore_1
      27: aload_1
      28: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      33: astore_2
      34: aload_2
      35: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      40: ifeq          142
      43: aload_2
      44: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      49: checkcast     #496                // class org/apache/wss4j/dom/handler/WSHandlerResult
      52: astore_3
      53: aload_3
      54: invokevirtual #506                // Method org/apache/wss4j/dom/handler/WSHandlerResult.getActionResults:()Ljava/util/Map;
      57: iconst_4
      58: invokestatic  #329                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      61: invokeinterface #456,  2          // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      66: checkcast     #489                // class java/util/List
      69: astore        4
      71: aload         4
      73: ifnull        139
      76: aload         4
      78: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      83: astore        5
      85: aload         5
      87: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      92: ifeq          139
      95: aload         5
      97: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     102: checkcast     #498                // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     105: astore        6
     107: aload         6
     109: ldc_w         #507                // String id
     112: invokevirtual #500                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     115: checkcast     #61                 // class java/lang/String
     118: astore        7
     120: aload         7
     122: ifnull        136
     125: aload         7
     127: invokevirtual #508                // Method java/lang/String.length:()I
     130: ifeq          136
     133: aload         6
     135: areturn
     136: goto          85
     139: goto          34
     142: aconst_null
     143: areturn

  private void checkForX509PkiPath(org.apache.wss4j.dom.message.WSSecSignature, org.apache.wss4j.policy.model.AbstractToken);
    Code:
       0: aload_2
       1: instanceof    #178                // class org/apache/wss4j/policy/model/X509Token
       4: ifeq          39
       7: aload_2
       8: checkcast     #178                // class org/apache/wss4j/policy/model/X509Token
      11: astore_3
      12: aload_3
      13: invokevirtual #509                // Method org/apache/wss4j/policy/model/X509Token.getTokenType:()Lorg/apache/wss4j/policy/model/X509Token$TokenType;
      16: astore        4
      18: aload         4
      20: getstatic     #510                // Field org/apache/wss4j/policy/model/X509Token$TokenType.WssX509PkiPathV1Token10:Lorg/apache/wss4j/policy/model/X509Token$TokenType;
      23: if_acmpeq     34
      26: aload         4
      28: getstatic     #511                // Field org/apache/wss4j/policy/model/X509Token$TokenType.WssX509PkiPathV1Token11:Lorg/apache/wss4j/policy/model/X509Token$TokenType;
      31: if_acmpne     39
      34: aload_1
      35: iconst_0
      36: invokevirtual #512                // Method org/apache/wss4j/dom/message/WSSecSignature.setUseSingleCertificate:(Z)V
      39: return

  protected org.apache.wss4j.dom.message.WSSecSignature getSignatureBuilder(org.apache.wss4j.policy.model.AbstractToken, boolean, boolean) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: new           #146                // class org/apache/wss4j/dom/message/WSSecSignature
       3: dup
       4: invokespecial #147                // Method org/apache/wss4j/dom/message/WSSecSignature."<init>":()V
       7: astore        4
       9: aload         4
      11: aload_0
      12: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      15: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      18: invokevirtual #148                // Method org/apache/wss4j/dom/message/WSSecSignature.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      21: aload         4
      23: aload_0
      24: getfield      #34                 // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      27: invokevirtual #149                // Method org/apache/wss4j/dom/message/WSSecSignature.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
      30: aload         4
      32: new           #411                // class org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler
      35: dup
      36: aload_0
      37: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      40: invokespecial #412                // Method org/apache/cxf/ws/security/wss4j/AttachmentCallbackHandler."<init>":(Lorg/apache/cxf/binding/soap/SoapMessage;)V
      43: invokevirtual #513                // Method org/apache/wss4j/dom/message/WSSecSignature.setAttachmentCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
      46: aload         4
      48: aload_0
      49: getfield      #22                 // Field storeBytesInAttachment:Z
      52: invokevirtual #514                // Method org/apache/wss4j/dom/message/WSSecSignature.setStoreBytesInAttachment:(Z)V
      55: aload_0
      56: aload         4
      58: aload_1
      59: invokespecial #515                // Method checkForX509PkiPath:(Lorg/apache/wss4j/dom/message/WSSecSignature;Lorg/apache/wss4j/policy/model/AbstractToken;)V
      62: aload_1
      63: instanceof    #121                // class org/apache/wss4j/policy/model/IssuedToken
      66: ifne          76
      69: aload_1
      70: instanceof    #185                // class org/apache/wss4j/policy/model/SamlToken
      73: ifeq          321
      76: aload_0
      77: aload_1
      78: invokevirtual #114                // Method assertToken:(Lorg/apache/wss4j/policy/model/AbstractToken;)V
      81: aload_0
      82: invokevirtual #126                // Method getSecurityToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
      85: astore        5
      87: aload         5
      89: invokevirtual #153                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
      92: astore        6
      94: iload_2
      95: ifeq          108
      98: aload         5
     100: invokevirtual #516                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getAttachedReference:()Lorg/w3c/dom/Element;
     103: astore        7
     105: goto          115
     108: aload         5
     110: invokevirtual #517                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getUnattachedReference:()Lorg/w3c/dom/Element;
     113: astore        7
     115: aload         7
     117: ifnull        159
     120: new           #227                // class org/apache/wss4j/common/token/SecurityTokenReference
     123: dup
     124: aload_0
     125: aload         7
     127: invokevirtual #130                // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     130: new           #518                // class org/apache/wss4j/common/bsp/BSPEnforcer
     133: dup
     134: invokespecial #519                // Method org/apache/wss4j/common/bsp/BSPEnforcer."<init>":()V
     137: invokespecial #520                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Element;Lorg/apache/wss4j/common/bsp/BSPEnforcer;)V
     140: astore        8
     142: aload         4
     144: aload         8
     146: invokevirtual #521                // Method org/apache/wss4j/dom/message/WSSecSignature.setSecurityTokenReference:(Lorg/apache/wss4j/common/token/SecurityTokenReference;)V
     149: aload         4
     151: bipush        12
     153: invokevirtual #152                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     156: goto          260
     159: iload_2
     160: ifeq          168
     163: bipush        9
     165: goto          170
     168: bipush        11
     170: istore        8
     172: ldc           #154                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
     174: aload         6
     176: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     179: ifne          192
     182: ldc           #156                // String urn:oasis:names:tc:SAML:1.0:assertion
     184: aload         6
     186: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     189: ifeq          209
     192: aload         4
     194: ldc           #157                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     196: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     199: aload         4
     201: bipush        12
     203: invokevirtual #152                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     206: goto          260
     209: ldc           #159                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     211: aload         6
     213: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     216: ifne          229
     219: ldc           #160                // String urn:oasis:names:tc:SAML:2.0:assertion
     221: aload         6
     223: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     226: ifeq          246
     229: aload         4
     231: ldc           #161                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     233: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     236: aload         4
     238: bipush        12
     240: invokevirtual #152                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     243: goto          260
     246: aload         4
     248: aload         6
     250: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     253: aload         4
     255: iload         8
     257: invokevirtual #152                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     260: iload_2
     261: ifeq          304
     264: aload         5
     266: invokevirtual #522                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getWsuId:()Ljava/lang/String;
     269: astore        8
     271: aload         8
     273: ifnonnull     283
     276: aload         5
     278: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     281: astore        8
     283: aload         8
     285: ldc           #234                // String #
     287: invokevirtual #381                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     290: ifeq          311
     293: aload         8
     295: iconst_1
     296: invokevirtual #523                // Method java/lang/String.substring:(I)Ljava/lang/String;
     299: astore        8
     301: goto          311
     304: aload         5
     306: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     309: astore        8
     311: aload         4
     313: aload         8
     315: invokevirtual #151                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenId:(Ljava/lang/String;)V
     318: goto          370
     321: aload_0
     322: aload         4
     324: aload_1
     325: invokevirtual #417                // Method setKeyIdentifierType:(Lorg/apache/wss4j/dom/message/WSSecBase;Lorg/apache/wss4j/policy/model/AbstractToken;)V
     328: aload_1
     329: instanceof    #178                // class org/apache/wss4j/policy/model/X509Token
     332: ifeq          370
     335: aload_1
     336: invokevirtual #115                // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     339: getstatic     #418                // Field org/apache/wss4j/policy/SPConstants$IncludeTokenType.INCLUDE_TOKEN_NEVER:Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
     342: if_acmpeq     370
     345: aload         4
     347: invokevirtual #524                // Method org/apache/wss4j/dom/message/WSSecSignature.getKeyIdentifierType:()I
     350: iconst_1
     351: if_icmpeq     370
     354: aload         4
     356: invokevirtual #524                // Method org/apache/wss4j/dom/message/WSSecSignature.getKeyIdentifierType:()I
     359: bipush        13
     361: if_icmpeq     370
     364: aload         4
     366: iconst_1
     367: invokevirtual #525                // Method org/apache/wss4j/dom/message/WSSecSignature.setIncludeSignatureToken:(Z)V
     370: iconst_0
     371: istore        5
     373: ldc_w         #289                // String security.signature.username
     376: astore        6
     378: ldc_w         #482                // String signature
     381: astore        7
     383: aload_0
     384: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     387: instanceof    #526                // class org/apache/wss4j/policy/model/SymmetricBinding
     390: ifeq          422
     393: iload_3
     394: ifne          422
     397: aload_0
     398: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     401: checkcast     #526                // class org/apache/wss4j/policy/model/SymmetricBinding
     404: invokevirtual #527                // Method org/apache/wss4j/policy/model/SymmetricBinding.getProtectionToken:()Lorg/apache/wss4j/policy/model/ProtectionToken;
     407: ifnull        414
     410: iconst_1
     411: goto          415
     414: iconst_0
     415: istore        5
     417: ldc_w         #451                // String security.encryption.username
     420: astore        6
     422: iload         5
     424: ifeq          434
     427: aload_0
     428: invokevirtual #415                // Method getEncryptionCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     431: goto          438
     434: aload_0
     435: invokevirtual #292                // Method getSignatureCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     438: astore        8
     440: iload_3
     441: ifeq          475
     444: aload         8
     446: ifnonnull     475
     449: aload_0
     450: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     453: instanceof    #526                // class org/apache/wss4j/policy/model/SymmetricBinding
     456: ifeq          475
     459: ldc_w         #483                // String encryption
     462: astore        7
     464: ldc_w         #451                // String security.encryption.username
     467: astore        6
     469: aload_0
     470: invokevirtual #415                // Method getEncryptionCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     473: astore        8
     475: iload_3
     476: ifne          497
     479: aload_0
     480: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     483: invokevirtual #16                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
     486: ldc_w         #445                // String security.signature.crypto
     489: aload         8
     491: invokeinterface #18,  3           // InterfaceMethod org/apache/cxf/message/Exchange.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     496: pop
     497: aload         6
     499: aload_0
     500: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
     503: invokestatic  #247                // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     506: checkcast     #61                 // class java/lang/String
     509: astore        9
     511: aload         9
     513: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     516: ifeq          616
     519: aload         8
     521: ifnull        606
     524: aload         8
     526: invokeinterface #452,  1          // InterfaceMethod org/apache/wss4j/common/crypto/Crypto.getDefaultX509Identifier:()Ljava/lang/String;
     531: astore        9
     533: aload         9
     535: invokestatic  #248                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     538: ifeq          575
     541: aload_0
     542: aload_1
     543: new           #221                // class java/lang/StringBuilder
     546: dup
     547: invokespecial #222                // Method java/lang/StringBuilder."<init>":()V
     550: ldc_w         #528                // String No configured
     553: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     556: aload         7
     558: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     561: ldc_w         #529                // String  username detected
     564: invokevirtual #224                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     567: invokevirtual #226                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     570: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     573: aconst_null
     574: areturn
     575: goto          616
     578: astore        10
     580: getstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
     583: getstatic     #170                // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     586: aload         10
     588: invokevirtual #171                // Method org/apache/wss4j/common/ext/WSSecurityException.getMessage:()Ljava/lang/String;
     591: aload         10
     593: invokevirtual #172                // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     596: new           #173                // class org/apache/cxf/interceptor/Fault
     599: dup
     600: aload         10
     602: invokespecial #174                // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     605: athrow
     606: aload_0
     607: aload_1
     608: ldc_w         #530                // String Security configuration could not be detected. Potential cause: Make sure jaxws:client element with name attribute value matching endpoint port is defined as well as a security.signature.properties element within it.
     611: invokevirtual #128                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/String;)V
     614: aconst_null
     615: areturn
     616: aload_0
     617: aload         9
     619: aload_1
     620: iconst_3
     621: invokevirtual #175                // Method getPassword:(Ljava/lang/String;Lorg/apache/neethi/Assertion;I)Ljava/lang/String;
     624: astore        10
     626: aload         4
     628: aload         9
     630: aload         10
     632: invokevirtual #176                // Method org/apache/wss4j/dom/message/WSSecSignature.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
     635: aload         4
     637: aload_0
     638: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     641: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     644: invokevirtual #163                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAsymmetricSignature:()Ljava/lang/String;
     647: invokevirtual #164                // Method org/apache/wss4j/dom/message/WSSecSignature.setSignatureAlgorithm:(Ljava/lang/String;)V
     650: aload_0
     651: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     654: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     657: invokevirtual #421                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     660: astore        11
     662: aload         4
     664: aload         11
     666: invokevirtual #531                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getDigest:()Ljava/lang/String;
     669: invokevirtual #532                // Method org/apache/wss4j/dom/message/WSSecSignature.setDigestAlgo:(Ljava/lang/String;)V
     672: aload         4
     674: aload_0
     675: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     678: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     681: invokevirtual #165                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     684: invokevirtual #166                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     687: invokevirtual #167                // Method org/apache/wss4j/dom/message/WSSecSignature.setSigCanonicalization:(Ljava/lang/String;)V
     690: aload         4
     692: aload_0
     693: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     696: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     699: aload         8
     701: aload_0
     702: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     705: invokevirtual #177                // Method org/apache/wss4j/dom/message/WSSecSignature.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     708: goto          736
     711: astore        12
     713: getstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
     716: getstatic     #170                // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     719: aload         12
     721: invokevirtual #171                // Method org/apache/wss4j/common/ext/WSSecurityException.getMessage:()Ljava/lang/String;
     724: aload         12
     726: invokevirtual #172                // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     729: aload_0
     730: aload_1
     731: aload         12
     733: invokevirtual #319                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/Exception;)V
     736: aload         4
     738: areturn
    Exception table:
       from    to  target type
         524   574   578   Class org/apache/wss4j/common/ext/WSSecurityException
         690   708   711   Class org/apache/wss4j/common/ext/WSSecurityException

  protected void doEndorsedSignatures(java.util.List<org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder$SupportingToken>, boolean, boolean);
    Code:
       0: aload_1
       1: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
       6: astore        4
       8: aload         4
      10: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      15: ifeq          572
      18: aload         4
      20: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      25: checkcast     #141                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken
      28: astore        5
      30: aload         5
      32: invokevirtual #197                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getTokenImplementation:()Ljava/lang/Object;
      35: astore        6
      37: new           #8                  // class java/util/ArrayList
      40: dup
      41: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
      44: astore        7
      46: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
      49: dup
      50: aload_0
      51: getfield      #533                // Field mainSigId:Ljava/lang/String;
      54: invokespecial #205                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
      57: astore        8
      59: aload         8
      61: aload_0
      62: getfield      #45                 // Field bottomUpElement:Lorg/w3c/dom/Element;
      65: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
      68: aload         7
      70: aload         8
      72: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      77: pop
      78: aload         5
      80: invokevirtual #534                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getSignedParts:()Ljava/util/List;
      83: ifnull        133
      86: aload         5
      88: invokevirtual #534                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getSignedParts:()Ljava/util/List;
      91: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      96: astore        9
      98: aload         9
     100: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     105: ifeq          133
     108: aload         9
     110: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     115: checkcast     #135                // class org/apache/wss4j/common/WSEncryptionPart
     118: astore        10
     120: aload         7
     122: aload         10
     124: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     129: pop
     130: goto          98
     133: aload         6
     135: instanceof    #146                // class org/apache/wss4j/dom/message/WSSecSignature
     138: ifeq          276
     141: aload         6
     143: checkcast     #146                // class org/apache/wss4j/dom/message/WSSecSignature
     146: astore        9
     148: iload_2
     149: ifeq          194
     152: aload         9
     154: invokevirtual #183                // Method org/apache/wss4j/dom/message/WSSecSignature.getBSTTokenId:()Ljava/lang/String;
     157: ifnull        194
     160: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     163: dup
     164: aload         9
     166: invokevirtual #183                // Method org/apache/wss4j/dom/message/WSSecSignature.getBSTTokenId:()Ljava/lang/String;
     169: invokespecial #205                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
     172: astore        10
     174: aload         10
     176: aload         9
     178: invokevirtual #181                // Method org/apache/wss4j/dom/message/WSSecSignature.getBinarySecurityTokenElement:()Lorg/w3c/dom/Element;
     181: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     184: aload         7
     186: aload         10
     188: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     193: pop
     194: aload         9
     196: aload         7
     198: aload_0
     199: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     202: invokevirtual #535                // Method org/apache/wss4j/dom/message/WSSecSignature.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     205: astore        10
     207: aload         9
     209: aload         10
     211: iconst_0
     212: aconst_null
     213: invokevirtual #536                // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     216: aload_0
     217: aload         9
     219: invokevirtual #537                // Method org/apache/wss4j/dom/message/WSSecSignature.getSignatureValue:()[B
     222: invokevirtual #538                // Method addSig:([B)V
     225: iload_3
     226: ifeq          257
     229: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     232: dup
     233: aload         9
     235: invokevirtual #539                // Method org/apache/wss4j/dom/message/WSSecSignature.getId:()Ljava/lang/String;
     238: ldc           #136                // String Element
     240: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     243: astore        11
     245: aload_0
     246: getfield      #6                  // Field encryptedTokensList:Ljava/util/Set;
     249: aload         11
     251: invokeinterface #139,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     256: pop
     257: goto          273
     260: astore        10
     262: aload_0
     263: aload         5
     265: invokevirtual #220                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     268: aload         10
     270: invokevirtual #319                // Method unassertPolicy:(Lorg/apache/neethi/Assertion;Ljava/lang/Exception;)V
     273: goto          569
     276: aload         6
     278: instanceof    #142                // class org/apache/cxf/ws/security/wss4j/policyhandlers/WSSecurityTokenHolder
     281: ifeq          389
     284: aload         6
     286: checkcast     #142                // class org/apache/cxf/ws/security/wss4j/policyhandlers/WSSecurityTokenHolder
     289: invokevirtual #215                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/WSSecurityTokenHolder.getToken:()Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     292: astore        9
     294: iload_2
     295: ifeq          318
     298: aload         7
     300: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     303: dup
     304: aload         9
     306: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     309: invokespecial #205                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
     312: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     317: pop
     318: aload         5
     320: invokevirtual #220                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     323: invokevirtual #540                // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
     326: getstatic     #541                // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
     329: if_acmpne     350
     332: aload_0
     333: aload         5
     335: invokevirtual #220                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     338: aload         9
     340: aload         7
     342: iload_2
     343: iload_3
     344: invokespecial #542                // Method doSymmSignatureDerived:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;Ljava/util/List;ZZ)V
     347: goto          365
     350: aload_0
     351: aload         5
     353: invokevirtual #220                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     356: aload         9
     358: aload         7
     360: iload_2
     361: iload_3
     362: invokespecial #543                // Method doSymmSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;Ljava/util/List;ZZ)V
     365: goto          386
     368: astore        10
     370: getstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
     373: getstatic     #170                // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     376: aload         10
     378: invokevirtual #544                // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     381: aload         10
     383: invokevirtual #172                // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     386: goto          569
     389: aload         6
     391: instanceof    #206                // class org/apache/wss4j/dom/message/WSSecUsernameToken
     394: ifeq          569
     397: aload         6
     399: checkcast     #206                // class org/apache/wss4j/dom/message/WSSecUsernameToken
     402: astore        9
     404: aload         9
     406: invokevirtual #192                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getId:()Ljava/lang/String;
     409: astore        10
     411: new           #545                // class java/util/Date
     414: dup
     415: invokespecial #546                // Method java/util/Date."<init>":()V
     418: astore        11
     420: new           #545                // class java/util/Date
     423: dup
     424: invokespecial #546                // Method java/util/Date."<init>":()V
     427: astore        12
     429: aload         12
     431: aload         11
     433: invokevirtual #547                // Method java/util/Date.getTime:()J
     436: ldc2_w        #548                // long 300000l
     439: ladd
     440: invokevirtual #550                // Method java/util/Date.setTime:(J)V
     443: new           #299                // class org/apache/cxf/ws/security/tokenstore/SecurityToken
     446: dup
     447: aload         10
     449: aload         9
     451: invokevirtual #191                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getUsernameTokenElement:()Lorg/w3c/dom/Element;
     454: aload         11
     456: aload         12
     458: invokespecial #551                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;Lorg/w3c/dom/Element;Ljava/util/Date;Ljava/util/Date;)V
     461: astore        13
     463: iload_2
     464: ifeq          487
     467: aload         7
     469: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     472: dup
     473: aload         13
     475: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     478: invokespecial #205                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
     481: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     486: pop
     487: aload         9
     489: invokevirtual #552                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getDerivedKey:()[B
     492: astore        14
     494: aload         13
     496: aload         14
     498: invokevirtual #553                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
     501: aload         5
     503: invokevirtual #220                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     506: invokevirtual #540                // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
     509: getstatic     #541                // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
     512: if_acmpne     533
     515: aload_0
     516: aload         5
     518: invokevirtual #220                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     521: aload         13
     523: aload         7
     525: iload_2
     526: iload_3
     527: invokespecial #542                // Method doSymmSignatureDerived:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;Ljava/util/List;ZZ)V
     530: goto          548
     533: aload_0
     534: aload         5
     536: invokevirtual #220                // Method org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder$SupportingToken.getToken:()Lorg/apache/wss4j/policy/model/AbstractToken;
     539: aload         13
     541: aload         7
     543: iload_2
     544: iload_3
     545: invokespecial #543                // Method doSymmSignature:(Lorg/apache/wss4j/policy/model/AbstractToken;Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;Ljava/util/List;ZZ)V
     548: goto          569
     551: astore        14
     553: getstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
     556: getstatic     #170                // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     559: aload         14
     561: invokevirtual #544                // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     564: aload         14
     566: invokevirtual #172                // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     569: goto          8
     572: return
    Exception table:
       from    to  target type
         194   257   260   Class org/apache/wss4j/common/ext/WSSecurityException
         318   365   368   Class java/lang/Exception
         487   548   551   Class java/lang/Exception

  private void doSymmSignatureDerived(org.apache.wss4j.policy.model.AbstractToken, org.apache.cxf.ws.security.tokenstore.SecurityToken, java.util.List<org.apache.wss4j.common.WSEncryptionPart>, boolean, boolean) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
       4: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
       7: astore        6
       9: new           #554                // class org/apache/wss4j/dom/message/WSSecDKSign
      12: dup
      13: invokespecial #555                // Method org/apache/wss4j/dom/message/WSSecDKSign."<init>":()V
      16: astore        7
      18: aload         7
      20: aload_0
      21: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      24: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      27: invokevirtual #556                // Method org/apache/wss4j/dom/message/WSSecDKSign.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      30: aload         7
      32: aload_0
      33: getfield      #34                 // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      36: invokevirtual #557                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
      39: aload_1
      40: invokevirtual #558                // Method org/apache/wss4j/policy/model/AbstractToken.getVersion:()Lorg/apache/wss4j/policy/SPConstants$SPVersion;
      43: getstatic     #559                // Field org/apache/wss4j/policy/SPConstants$SPVersion.SP11:Lorg/apache/wss4j/policy/SPConstants$SPVersion;
      46: if_acmpne     55
      49: aload         7
      51: iconst_1
      52: invokevirtual #560                // Method org/apache/wss4j/dom/message/WSSecDKSign.setWscVersion:(I)V
      55: iconst_0
      56: istore        8
      58: aload_0
      59: aload_1
      60: invokevirtual #115                // Method org/apache/wss4j/policy/model/AbstractToken.getIncludeTokenType:()Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;
      63: invokevirtual #116                // Method isTokenRequired:(Lorg/apache/wss4j/policy/SPConstants$IncludeTokenType;)Z
      66: ifeq          72
      69: iconst_1
      70: istore        8
      72: iload         8
      74: ifeq          86
      77: aload_2
      78: invokevirtual #516                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getAttachedReference:()Lorg/w3c/dom/Element;
      81: astore        9
      83: goto          92
      86: aload_2
      87: invokevirtual #517                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getUnattachedReference:()Lorg/w3c/dom/Element;
      90: astore        9
      92: aload         9
      94: ifnull        119
      97: aload_0
      98: aload         9
     100: invokevirtual #130                // Method cloneElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     103: astore        9
     105: aload         7
     107: aload_2
     108: invokevirtual #561                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     111: aload         9
     113: invokevirtual #562                // Method org/apache/wss4j/dom/message/WSSecDKSign.setExternalKey:([BLorg/w3c/dom/Element;)V
     116: goto          201
     119: aload_0
     120: invokevirtual #472                // Method isRequestor:()Z
     123: ifne          188
     126: aload_1
     127: invokevirtual #540                // Method org/apache/wss4j/policy/model/AbstractToken.getDerivedKeys:()Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
     130: getstatic     #541                // Field org/apache/wss4j/policy/model/AbstractToken$DerivedKeys.RequireDerivedKeys:Lorg/apache/wss4j/policy/model/AbstractToken$DerivedKeys;
     133: if_acmpne     188
     136: new           #227                // class org/apache/wss4j/common/token/SecurityTokenReference
     139: dup
     140: aload         6
     142: invokespecial #228                // Method org/apache/wss4j/common/token/SecurityTokenReference."<init>":(Lorg/w3c/dom/Document;)V
     145: astore        10
     147: aload_2
     148: invokevirtual #563                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     151: ifnull        171
     154: aload         10
     156: aload_2
     157: invokevirtual #563                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     160: invokevirtual #564                // Method org/apache/wss4j/common/token/SecurityTokenReference.setKeyIdentifierEncKeySHA1:(Ljava/lang/String;)V
     163: aload         10
     165: ldc_w         #565                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     168: invokevirtual #237                // Method org/apache/wss4j/common/token/SecurityTokenReference.addTokenType:(Ljava/lang/String;)V
     171: aload         7
     173: aload_2
     174: invokevirtual #561                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     177: aload         10
     179: invokevirtual #200                // Method org/apache/wss4j/common/token/SecurityTokenReference.getElement:()Lorg/w3c/dom/Element;
     182: invokevirtual #562                // Method org/apache/wss4j/dom/message/WSSecDKSign.setExternalKey:([BLorg/w3c/dom/Element;)V
     185: goto          201
     188: aload         7
     190: aload_2
     191: invokevirtual #561                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     194: aload_2
     195: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     198: invokevirtual #566                // Method org/apache/wss4j/dom/message/WSSecDKSign.setExternalKey:([BLjava/lang/String;)V
     201: aload         7
     203: aload_0
     204: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     207: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     210: invokevirtual #567                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
     213: invokevirtual #568                // Method org/apache/wss4j/dom/message/WSSecDKSign.setSignatureAlgorithm:(Ljava/lang/String;)V
     216: aload         7
     218: aload_0
     219: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     222: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     225: invokevirtual #165                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     228: invokevirtual #166                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     231: invokevirtual #569                // Method org/apache/wss4j/dom/message/WSSecDKSign.setSigCanonicalization:(Ljava/lang/String;)V
     234: aload_0
     235: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     238: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     241: invokevirtual #421                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     244: astore        10
     246: aload         7
     248: aload         10
     250: invokevirtual #570                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getSignatureDerivedKeyLength:()I
     253: bipush        8
     255: idiv
     256: invokevirtual #571                // Method org/apache/wss4j/dom/message/WSSecDKSign.setDerivedKeyLength:(I)V
     259: aload_2
     260: invokevirtual #563                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
     263: ifnull        277
     266: aload         7
     268: ldc_w         #565                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
     271: invokevirtual #572                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCustomValueType:(Ljava/lang/String;)V
     274: goto          292
     277: aload_1
     278: instanceof    #118                // class org/apache/wss4j/policy/model/UsernameToken
     281: ifeq          292
     284: aload         7
     286: ldc_w         #573                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
     289: invokevirtual #572                // Method org/apache/wss4j/dom/message/WSSecDKSign.setCustomValueType:(Ljava/lang/String;)V
     292: aload         7
     294: aload         6
     296: aload_0
     297: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     300: invokevirtual #574                // Method org/apache/wss4j/dom/message/WSSecDKSign.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     303: iload         4
     305: ifeq          333
     308: aload_2
     309: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     312: invokestatic  #134                // Method org/apache/wss4j/common/util/XMLUtils.getIDFromReference:(Ljava/lang/String;)Ljava/lang/String;
     315: astore        11
     317: aload_3
     318: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     321: dup
     322: aload         11
     324: invokespecial #205                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
     327: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     332: pop
     333: aload         7
     335: invokevirtual #575                // Method org/apache/wss4j/dom/message/WSSecDKSign.getParts:()Ljava/util/List;
     338: aload_3
     339: invokeinterface #375,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     344: pop
     345: aload         7
     347: aload_3
     348: aload_0
     349: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     352: invokevirtual #576                // Method org/apache/wss4j/dom/message/WSSecDKSign.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     355: astore        11
     357: aload_0
     358: aload         7
     360: invokevirtual #577                // Method org/apache/wss4j/dom/message/WSSecDKSign.getdktElement:()Lorg/w3c/dom/Element;
     363: invokevirtual #132                // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
     366: aload         7
     368: aload         11
     370: iconst_0
     371: aconst_null
     372: invokevirtual #578                // Method org/apache/wss4j/dom/message/WSSecDKSign.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     375: iload         5
     377: ifeq          408
     380: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     383: dup
     384: aload         7
     386: invokevirtual #579                // Method org/apache/wss4j/dom/message/WSSecDKSign.getSignatureId:()Ljava/lang/String;
     389: ldc           #136                // String Element
     391: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     394: astore        12
     396: aload_0
     397: getfield      #6                  // Field encryptedTokensList:Ljava/util/Set;
     400: aload         12
     402: invokeinterface #139,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     407: pop
     408: aload_0
     409: aload         7
     411: invokevirtual #580                // Method org/apache/wss4j/dom/message/WSSecDKSign.getSignatureValue:()[B
     414: invokevirtual #538                // Method addSig:([B)V
     417: return

  private void doSymmSignature(org.apache.wss4j.policy.model.AbstractToken, org.apache.cxf.ws.security.tokenstore.SecurityToken, java.util.List<org.apache.wss4j.common.WSEncryptionPart>, boolean, boolean) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
       4: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
       7: astore        6
       9: new           #146                // class org/apache/wss4j/dom/message/WSSecSignature
      12: dup
      13: invokespecial #147                // Method org/apache/wss4j/dom/message/WSSecSignature."<init>":()V
      16: astore        7
      18: aload         7
      20: aload_0
      21: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
      24: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      27: invokevirtual #148                // Method org/apache/wss4j/dom/message/WSSecSignature.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      30: aload         7
      32: aload_0
      33: getfield      #34                 // Field callbackLookup:Lorg/apache/wss4j/dom/callback/CallbackLookup;
      36: invokevirtual #149                // Method org/apache/wss4j/dom/message/WSSecSignature.setCallbackLookup:(Lorg/apache/wss4j/dom/callback/CallbackLookup;)V
      39: aload_1
      40: instanceof    #178                // class org/apache/wss4j/policy/model/X509Token
      43: ifeq          90
      46: aload_0
      47: invokevirtual #472                // Method isRequestor:()Z
      50: ifeq          71
      53: aload         7
      55: ldc_w         #565                // String http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey
      58: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
      61: aload         7
      63: bipush        9
      65: invokevirtual #152                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
      68: goto          203
      71: aload         7
      73: aload_2
      74: invokevirtual #563                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSHA1:()Ljava/lang/String;
      77: invokevirtual #581                // Method org/apache/wss4j/dom/message/WSSecSignature.setEncrKeySha1value:(Ljava/lang/String;)V
      80: aload         7
      82: bipush        10
      84: invokevirtual #152                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
      87: goto          203
      90: aload_2
      91: invokevirtual #153                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getTokenType:()Ljava/lang/String;
      94: astore        8
      96: ldc           #154                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1
      98: aload         8
     100: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     103: ifne          116
     106: ldc           #156                // String urn:oasis:names:tc:SAML:1.0:assertion
     108: aload         8
     110: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     113: ifeq          126
     116: aload         7
     118: ldc           #157                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     120: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     123: goto          196
     126: ldc           #159                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0
     128: aload         8
     130: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     133: ifne          146
     136: ldc           #160                // String urn:oasis:names:tc:SAML:2.0:assertion
     138: aload         8
     140: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     143: ifeq          156
     146: aload         7
     148: ldc           #161                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLID
     150: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     153: goto          196
     156: aload         8
     158: ifnull        171
     161: aload         7
     163: aload         8
     165: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     168: goto          196
     171: aload_1
     172: instanceof    #118                // class org/apache/wss4j/policy/model/UsernameToken
     175: ifeq          189
     178: aload         7
     180: ldc_w         #573                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#UsernameToken
     183: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     186: goto          196
     189: aload         7
     191: ldc           #157                // String http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.0#SAMLAssertionID
     193: invokevirtual #158                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenValueType:(Ljava/lang/String;)V
     196: aload         7
     198: bipush        9
     200: invokevirtual #152                // Method org/apache/wss4j/dom/message/WSSecSignature.setKeyIdentifierType:(I)V
     203: aload_2
     204: invokevirtual #522                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getWsuId:()Ljava/lang/String;
     207: astore        8
     209: aload         8
     211: ifnonnull     220
     214: aload_2
     215: invokevirtual #133                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     218: astore        8
     220: aload         8
     222: invokestatic  #134                // Method org/apache/wss4j/common/util/XMLUtils.getIDFromReference:(Ljava/lang/String;)Ljava/lang/String;
     225: astore        8
     227: aload         7
     229: aload         8
     231: invokevirtual #151                // Method org/apache/wss4j/dom/message/WSSecSignature.setCustomTokenId:(Ljava/lang/String;)V
     234: aload         7
     236: aload_2
     237: invokevirtual #561                // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     240: invokevirtual #582                // Method org/apache/wss4j/dom/message/WSSecSignature.setSecretKey:([B)V
     243: aload         7
     245: aload_0
     246: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     249: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     252: invokevirtual #567                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getSymmetricSignature:()Ljava/lang/String;
     255: invokevirtual #164                // Method org/apache/wss4j/dom/message/WSSecSignature.setSignatureAlgorithm:(Ljava/lang/String;)V
     258: aload_0
     259: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     262: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     265: invokevirtual #421                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getAlgorithmSuiteType:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType;
     268: astore        9
     270: aload         7
     272: aload         9
     274: invokevirtual #531                // Method org/apache/wss4j/policy/model/AlgorithmSuite$AlgorithmSuiteType.getDigest:()Ljava/lang/String;
     277: invokevirtual #532                // Method org/apache/wss4j/dom/message/WSSecSignature.setDigestAlgo:(Ljava/lang/String;)V
     280: aload         7
     282: aload_0
     283: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
     286: invokevirtual #162                // Method org/apache/wss4j/policy/model/AbstractBinding.getAlgorithmSuite:()Lorg/apache/wss4j/policy/model/AlgorithmSuite;
     289: invokevirtual #165                // Method org/apache/wss4j/policy/model/AlgorithmSuite.getC14n:()Lorg/apache/wss4j/policy/model/AlgorithmSuite$C14NType;
     292: invokevirtual #166                // Method org/apache/wss4j/policy/model/AlgorithmSuite$C14NType.getValue:()Ljava/lang/String;
     295: invokevirtual #167                // Method org/apache/wss4j/dom/message/WSSecSignature.setSigCanonicalization:(Ljava/lang/String;)V
     298: aload         7
     300: aload         6
     302: aload_0
     303: invokevirtual #292                // Method getSignatureCrypto:()Lorg/apache/wss4j/common/crypto/Crypto;
     306: aload_0
     307: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     310: invokevirtual #177                // Method org/apache/wss4j/dom/message/WSSecSignature.prepare:(Lorg/w3c/dom/Document;Lorg/apache/wss4j/common/crypto/Crypto;Lorg/apache/wss4j/dom/message/WSSecHeader;)V
     313: aload         7
     315: invokevirtual #583                // Method org/apache/wss4j/dom/message/WSSecSignature.getParts:()Ljava/util/List;
     318: aload_3
     319: invokeinterface #375,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     324: pop
     325: aload         7
     327: aload_3
     328: aload_0
     329: getfield      #14                 // Field secHeader:Lorg/apache/wss4j/dom/message/WSSecHeader;
     332: invokevirtual #535                // Method org/apache/wss4j/dom/message/WSSecSignature.addReferencesToSign:(Ljava/util/List;Lorg/apache/wss4j/dom/message/WSSecHeader;)Ljava/util/List;
     335: astore        10
     337: aload         7
     339: aload         10
     341: iconst_0
     342: aconst_null
     343: invokevirtual #536                // Method org/apache/wss4j/dom/message/WSSecSignature.computeSignature:(Ljava/util/List;ZLorg/w3c/dom/Element;)V
     346: iload         5
     348: ifeq          379
     351: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     354: dup
     355: aload         7
     357: invokevirtual #539                // Method org/apache/wss4j/dom/message/WSSecSignature.getId:()Ljava/lang/String;
     360: ldc           #136                // String Element
     362: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     365: astore        11
     367: aload_0
     368: getfield      #6                  // Field encryptedTokensList:Ljava/util/Set;
     371: aload         11
     373: invokeinterface #139,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     378: pop
     379: aload_0
     380: aload         7
     382: invokevirtual #537                // Method org/apache/wss4j/dom/message/WSSecSignature.getSignatureValue:()[B
     385: invokevirtual #538                // Method addSig:([B)V
     388: return

  protected void addSupportingTokens(java.util.List<org.apache.wss4j.common.WSEncryptionPart>) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: getfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
       4: ldc_w         #584                // String SignedSupportingTokens
       7: invokestatic  #585                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      10: astore_2
      11: aload_0
      12: aload_2
      13: iconst_0
      14: invokespecial #586                // Method handleSupportingTokens:(Ljava/util/Collection;Z)Ljava/util/List;
      17: astore_3
      18: aload_0
      19: getfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
      22: ldc_w         #587                // String EndorsingSupportingTokens
      25: invokestatic  #585                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      28: astore        4
      30: aload_0
      31: aload_0
      32: aload         4
      34: iconst_1
      35: invokespecial #586                // Method handleSupportingTokens:(Ljava/util/Collection;Z)Ljava/util/List;
      38: putfield      #588                // Field endSuppTokList:Ljava/util/List;
      41: aload_0
      42: getfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
      45: ldc_w         #589                // String SignedEndorsingSupportingTokens
      48: invokestatic  #585                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      51: astore        5
      53: aload_0
      54: aload_0
      55: aload         5
      57: iconst_1
      58: invokespecial #586                // Method handleSupportingTokens:(Ljava/util/Collection;Z)Ljava/util/List;
      61: putfield      #590                // Field sgndEndSuppTokList:Ljava/util/List;
      64: aload_0
      65: getfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
      68: ldc_w         #591                // String SignedEncryptedSupportingTokens
      71: invokestatic  #585                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      74: astore        6
      76: aload_0
      77: aload         6
      79: iconst_0
      80: invokespecial #586                // Method handleSupportingTokens:(Ljava/util/Collection;Z)Ljava/util/List;
      83: astore        7
      85: aload_0
      86: getfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
      89: ldc_w         #592                // String EndorsingEncryptedSupportingTokens
      92: invokestatic  #585                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      95: astore        8
      97: aload_0
      98: getfield      #588                // Field endSuppTokList:Ljava/util/List;
     101: aload_0
     102: aload         8
     104: iconst_1
     105: invokespecial #586                // Method handleSupportingTokens:(Ljava/util/Collection;Z)Ljava/util/List;
     108: invokeinterface #375,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     113: pop
     114: aload_0
     115: getfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
     118: ldc_w         #593                // String SignedEndorsingEncryptedSupportingTokens
     121: invokestatic  #585                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
     124: astore        9
     126: aload_0
     127: getfield      #590                // Field sgndEndSuppTokList:Ljava/util/List;
     130: aload_0
     131: aload         9
     133: iconst_1
     134: invokespecial #586                // Method handleSupportingTokens:(Ljava/util/Collection;Z)Ljava/util/List;
     137: invokeinterface #375,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     142: pop
     143: aload_0
     144: getfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
     147: ldc_w         #594                // String SupportingTokens
     150: invokestatic  #585                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
     153: astore        10
     155: aload_0
     156: aload         10
     158: iconst_0
     159: invokespecial #586                // Method handleSupportingTokens:(Ljava/util/Collection;Z)Ljava/util/List;
     162: pop
     163: aload_0
     164: getfield      #13                 // Field aim:Lorg/apache/cxf/ws/policy/AssertionInfoMap;
     167: ldc_w         #595                // String EncryptedSupportingTokens
     170: invokestatic  #585                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
     173: astore        11
     175: aload_0
     176: aload         11
     178: iconst_0
     179: invokespecial #586                // Method handleSupportingTokens:(Ljava/util/Collection;Z)Ljava/util/List;
     182: pop
     183: aload_0
     184: aload_3
     185: aload_1
     186: invokevirtual #596                // Method addSignatureParts:(Ljava/util/List;Ljava/util/List;)V
     189: aload_0
     190: aload         7
     192: aload_1
     193: invokevirtual #596                // Method addSignatureParts:(Ljava/util/List;Ljava/util/List;)V
     196: aload_0
     197: aload_0
     198: getfield      #590                // Field sgndEndSuppTokList:Ljava/util/List;
     201: aload_1
     202: invokevirtual #596                // Method addSignatureParts:(Ljava/util/List;Ljava/util/List;)V
     205: return

  protected void doEndorse();
    Code:
       0: iconst_0
       1: istore_1
       2: iconst_0
       3: istore_2
       4: aload_0
       5: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
       8: instanceof    #597                // class org/apache/wss4j/policy/model/AsymmetricBinding
      11: ifeq          39
      14: aload_0
      15: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      18: checkcast     #597                // class org/apache/wss4j/policy/model/AsymmetricBinding
      21: invokevirtual #598                // Method org/apache/wss4j/policy/model/AsymmetricBinding.isProtectTokens:()Z
      24: istore_1
      25: aload_0
      26: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      29: checkcast     #597                // class org/apache/wss4j/policy/model/AsymmetricBinding
      32: invokevirtual #599                // Method org/apache/wss4j/policy/model/AsymmetricBinding.isEncryptSignature:()Z
      35: istore_2
      36: goto          71
      39: aload_0
      40: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      43: instanceof    #526                // class org/apache/wss4j/policy/model/SymmetricBinding
      46: ifeq          71
      49: aload_0
      50: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      53: checkcast     #526                // class org/apache/wss4j/policy/model/SymmetricBinding
      56: invokevirtual #600                // Method org/apache/wss4j/policy/model/SymmetricBinding.isProtectTokens:()Z
      59: istore_1
      60: aload_0
      61: getfield      #12                 // Field binding:Lorg/apache/wss4j/policy/model/AbstractBinding;
      64: checkcast     #526                // class org/apache/wss4j/policy/model/SymmetricBinding
      67: invokevirtual #601                // Method org/apache/wss4j/policy/model/SymmetricBinding.isEncryptSignature:()Z
      70: istore_2
      71: aload_0
      72: aload_0
      73: getfield      #588                // Field endSuppTokList:Ljava/util/List;
      76: iload_1
      77: iload_2
      78: invokevirtual #602                // Method doEndorsedSignatures:(Ljava/util/List;ZZ)V
      81: aload_0
      82: aload_0
      83: getfield      #590                // Field sgndEndSuppTokList:Ljava/util/List;
      86: iload_1
      87: iload_2
      88: invokevirtual #602                // Method doEndorsedSignatures:(Ljava/util/List;ZZ)V
      91: return

  protected void addSignatureConfirmation(java.util.List<org.apache.wss4j.common.WSEncryptionPart>);
    Code:
       0: aload_0
       1: invokevirtual #475                // Method getWss10:()Lorg/apache/wss4j/policy/model/Wss10;
       4: astore_2
       5: aload_2
       6: instanceof    #478                // class org/apache/wss4j/policy/model/Wss11
       9: ifeq          22
      12: aload_2
      13: checkcast     #478                // class org/apache/wss4j/policy/model/Wss11
      16: invokevirtual #603                // Method org/apache/wss4j/policy/model/Wss11.isRequireSignatureConfirmation:()Z
      19: ifne          23
      22: return
      23: aload_0
      24: getfield      #46                 // Field message:Lorg/apache/cxf/binding/soap/SoapMessage;
      27: invokevirtual #16                 // Method org/apache/cxf/binding/soap/SoapMessage.getExchange:()Lorg/apache/cxf/message/Exchange;
      30: invokeinterface #486,  1          // InterfaceMethod org/apache/cxf/message/Exchange.getInMessage:()Lorg/apache/cxf/message/Message;
      35: ldc_w         #487                // String RECV_RESULTS
      38: invokeinterface #488,  2          // InterfaceMethod org/apache/cxf/message/Message.get:(Ljava/lang/Object;)Ljava/lang/Object;
      43: checkcast     #489                // class java/util/List
      46: invokestatic  #490                // Method org/apache/cxf/helpers/CastUtils.cast:(Ljava/util/List;)Ljava/util/List;
      49: astore_3
      50: new           #8                  // class java/util/ArrayList
      53: dup
      54: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
      57: astore        4
      59: aload_3
      60: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      65: astore        5
      67: aload         5
      69: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      74: ifeq          178
      77: aload         5
      79: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      84: checkcast     #496                // class org/apache/wss4j/dom/handler/WSHandlerResult
      87: astore        6
      89: aload         6
      91: invokevirtual #506                // Method org/apache/wss4j/dom/handler/WSHandlerResult.getActionResults:()Ljava/util/Map;
      94: iconst_2
      95: invokestatic  #329                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      98: invokeinterface #604,  2          // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     103: ifeq          131
     106: aload         4
     108: aload         6
     110: invokevirtual #506                // Method org/apache/wss4j/dom/handler/WSHandlerResult.getActionResults:()Ljava/util/Map;
     113: iconst_2
     114: invokestatic  #329                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     117: invokeinterface #456,  2          // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     122: checkcast     #605                // class java/util/Collection
     125: invokeinterface #375,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     130: pop
     131: aload         6
     133: invokevirtual #506                // Method org/apache/wss4j/dom/handler/WSHandlerResult.getActionResults:()Ljava/util/Map;
     136: bipush        64
     138: invokestatic  #329                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     141: invokeinterface #604,  2          // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     146: ifeq          175
     149: aload         4
     151: aload         6
     153: invokevirtual #506                // Method org/apache/wss4j/dom/handler/WSHandlerResult.getActionResults:()Ljava/util/Map;
     156: bipush        64
     158: invokestatic  #329                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     161: invokeinterface #456,  2          // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     166: checkcast     #605                // class java/util/Collection
     169: invokeinterface #375,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     174: pop
     175: goto          67
     178: aload_0
     179: new           #8                  // class java/util/ArrayList
     182: dup
     183: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
     186: putfield      #606                // Field sigConfList:Ljava/util/List;
     189: new           #607                // class org/apache/wss4j/dom/message/WSSecSignatureConfirmation
     192: dup
     193: invokespecial #608                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation."<init>":()V
     196: astore        5
     198: aload         5
     200: aload_0
     201: getfield      #11                 // Field wssConfig:Lorg/apache/wss4j/dom/engine/WSSConfig;
     204: invokevirtual #66                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     207: invokevirtual #609                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
     210: aload         4
     212: invokeinterface #610,  1          // InterfaceMethod java/util/List.size:()I
     217: ifle          352
     220: aload         4
     222: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     227: astore        6
     229: aload         6
     231: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     236: ifeq          349
     239: aload         6
     241: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     246: checkcast     #498                // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     249: astore        7
     251: aload         7
     253: ldc_w         #611                // String signature-value
     256: invokevirtual #500                // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     259: checkcast     #612                // class "[B"
     262: checkcast     #612                // class "[B"
     265: astore        8
     267: aload         5
     269: aload         8
     271: invokevirtual #613                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation.setSignatureValue:([B)V
     274: aload         5
     276: aload_0
     277: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     280: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     283: invokevirtual #614                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation.prepare:(Lorg/w3c/dom/Document;)V
     286: aload_0
     287: aload         5
     289: invokevirtual #615                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation.getSignatureConfirmationElement:()Lorg/w3c/dom/Element;
     292: invokevirtual #132                // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
     295: aload_1
     296: ifnull        346
     299: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     302: dup
     303: aload         5
     305: invokevirtual #616                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation.getId:()Ljava/lang/String;
     308: ldc           #136                // String Element
     310: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     313: astore        9
     315: aload         9
     317: aload         5
     319: invokevirtual #615                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation.getSignatureConfirmationElement:()Lorg/w3c/dom/Element;
     322: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     325: aload_1
     326: aload         9
     328: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     333: pop
     334: aload_0
     335: getfield      #606                // Field sigConfList:Ljava/util/List;
     338: aload         9
     340: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     345: pop
     346: goto          229
     349: goto          424
     352: aload         5
     354: aload_0
     355: getfield      #15                 // Field saaj:Ljavax/xml/soap/SOAPMessage;
     358: invokevirtual #71                 // Method javax/xml/soap/SOAPMessage.getSOAPPart:()Ljavax/xml/soap/SOAPPart;
     361: invokevirtual #614                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation.prepare:(Lorg/w3c/dom/Document;)V
     364: aload_0
     365: aload         5
     367: invokevirtual #615                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation.getSignatureConfirmationElement:()Lorg/w3c/dom/Element;
     370: invokevirtual #132                // Method addSupportingElement:(Lorg/w3c/dom/Element;)V
     373: aload_1
     374: ifnull        424
     377: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     380: dup
     381: aload         5
     383: invokevirtual #616                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation.getId:()Ljava/lang/String;
     386: ldc           #136                // String Element
     388: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     391: astore        6
     393: aload         6
     395: aload         5
     397: invokevirtual #615                // Method org/apache/wss4j/dom/message/WSSecSignatureConfirmation.getSignatureConfirmationElement:()Lorg/w3c/dom/Element;
     400: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     403: aload_1
     404: aload         6
     406: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     411: pop
     412: aload_0
     413: getfield      #606                // Field sigConfList:Ljava/util/List;
     416: aload         6
     418: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     423: pop
     424: aload_0
     425: new           #75                 // class javax/xml/namespace/QName
     428: dup
     429: aload_2
     430: invokevirtual #617                // Method org/apache/wss4j/policy/model/Wss10.getName:()Ljavax/xml/namespace/QName;
     433: invokevirtual #74                 // Method javax/xml/namespace/QName.getNamespaceURI:()Ljava/lang/String;
     436: ldc_w         #618                // String RequireSignatureConfirmation
     439: invokespecial #77                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     442: invokevirtual #89                 // Method assertPolicy:(Ljavax/xml/namespace/QName;)V
     445: return

  public void handleEncryptedSignedHeaders(java.util.List<org.apache.wss4j.common.WSEncryptionPart>, java.util.List<org.apache.wss4j.common.WSEncryptionPart>);
    Code:
       0: new           #8                  // class java/util/ArrayList
       3: dup
       4: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
       7: astore_3
       8: aload_1
       9: invokeinterface #112,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      14: astore        4
      16: aload         4
      18: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      23: ifeq          182
      26: aload         4
      28: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      33: checkcast     #135                // class org/apache/wss4j/common/WSEncryptionPart
      36: astore        5
      38: aload_2
      39: invokeinterface #619,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      44: astore        6
      46: aload         6
      48: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      53: ifeq          179
      56: aload         6
      58: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      63: checkcast     #135                // class org/apache/wss4j/common/WSEncryptionPart
      66: astore        7
      68: aload         7
      70: invokevirtual #379                // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
      73: ifnonnull     101
      76: ldc_w         #620                // String Token
      79: aload         7
      81: invokevirtual #382                // Method org/apache/wss4j/common/WSEncryptionPart.getName:()Ljava/lang/String;
      84: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      87: ifne          101
      90: new           #621                // class java/lang/IllegalArgumentException
      93: dup
      94: ldc_w         #622                // String WSEncryptionPart must be ID based but no id was found.
      97: invokespecial #623                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     100: athrow
     101: aload         5
     103: invokevirtual #386                // Method org/apache/wss4j/common/WSEncryptionPart.getEncModifier:()Ljava/lang/String;
     106: ldc_w         #351                // String Header
     109: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     112: ifeq          176
     115: aload         7
     117: invokevirtual #379                // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
     120: aload         5
     122: invokevirtual #379                // Method org/apache/wss4j/common/WSEncryptionPart.getId:()Ljava/lang/String;
     125: invokevirtual #155                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     128: ifeq          176
     131: aload         6
     133: invokeinterface #624,  1          // InterfaceMethod java/util/Iterator.remove:()V
     138: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
     141: dup
     142: aload         5
     144: invokevirtual #625                // Method org/apache/wss4j/common/WSEncryptionPart.getEncId:()Ljava/lang/String;
     147: aload         5
     149: invokevirtual #386                // Method org/apache/wss4j/common/WSEncryptionPart.getEncModifier:()Ljava/lang/String;
     152: invokespecial #137                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     155: astore        8
     157: aload         8
     159: aload         5
     161: invokevirtual #626                // Method org/apache/wss4j/common/WSEncryptionPart.getElement:()Lorg/w3c/dom/Element;
     164: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
     167: aload_3
     168: aload         8
     170: invokeinterface #145,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     175: pop
     176: goto          46
     179: goto          16
     182: aload_2
     183: aload_3
     184: invokeinterface #375,  2          // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
     189: pop
     190: return

  public org.apache.wss4j.common.WSEncryptionPart convertToEncryptionPart(org.w3c.dom.Element);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #377                // Method addWsuIdToElement:(Lorg/w3c/dom/Element;)Ljava/lang/String;
       5: astore_2
       6: new           #135                // class org/apache/wss4j/common/WSEncryptionPart
       9: dup
      10: aload_2
      11: invokespecial #205                // Method org/apache/wss4j/common/WSEncryptionPart."<init>":(Ljava/lang/String;)V
      14: astore_3
      15: aload_3
      16: aload_1
      17: invokevirtual #138                // Method org/apache/wss4j/common/WSEncryptionPart.setElement:(Lorg/w3c/dom/Element;)V
      20: aload_3
      21: areturn

  protected void addSig(byte[]);
    Code:
       0: aload_1
       1: ifnull        26
       4: aload_1
       5: arraylength
       6: ifle          26
       9: aload_0
      10: getfield      #7                  // Field signatures:Ljava/util/Set;
      13: aload_1
      14: invokestatic  #627                // Method java/util/Arrays.hashCode:([B)I
      17: invokestatic  #329                // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      20: invokeinterface #139,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      25: pop
      26: return

  static {};
    Code:
       0: ldc_w         #628                // class org/apache/cxf/ws/security/wss4j/policyhandlers/AbstractBindingBuilder
       3: invokestatic  #629                // Method org/apache/cxf/common/logging/LogUtils.getL7dLogger:(Ljava/lang/Class;)Ljava/util/logging/Logger;
       6: putstatic     #27                 // Field LOG:Ljava/util/logging/Logger;
       9: return
}
