Compiled from "UsernameTokenInterceptor.java"
public class org.apache.cxf.ws.security.wss4j.UsernameTokenInterceptor extends org.apache.cxf.ws.security.wss4j.AbstractTokenInterceptor {
  public org.apache.cxf.ws.security.wss4j.UsernameTokenInterceptor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/cxf/ws/security/wss4j/AbstractTokenInterceptor."<init>":()V
       4: return

  protected void processToken(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_0
       1: aload_1
       2: iconst_0
       3: invokevirtual #2                  // Method findSecurityHeader:(Lorg/apache/cxf/binding/soap/SoapMessage;Z)Lorg/apache/cxf/headers/Header;
       6: astore_2
       7: aload_2
       8: ifnonnull     12
      11: return
      12: aload_1
      13: ldc           #3                  // String ws-security.validate.token
      15: iconst_1
      16: invokestatic  #4                  // Method org/apache/cxf/message/MessageUtils.getContextualBoolean:(Lorg/apache/cxf/message/Message;Ljava/lang/String;Z)Z
      19: istore_3
      20: aload_2
      21: invokevirtual #5                  // Method org/apache/cxf/headers/Header.getObject:()Ljava/lang/Object;
      24: checkcast     #6                  // class org/w3c/dom/Element
      27: astore        4
      29: aload         4
      31: invokestatic  #7                  // Method org/apache/cxf/helpers/DOMUtils.getFirstElement:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Element;
      34: astore        5
      36: aload         5
      38: ifnull        388
      41: ldc           #8                  // String UsernameToken
      43: aload         5
      45: invokeinterface #9,  1            // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      50: invokevirtual #10                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      53: ifeq          378
      56: ldc           #11                 // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd
      58: aload         5
      60: invokeinterface #12,  1           // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      65: invokevirtual #10                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      68: ifeq          378
      71: aload_0
      72: aload_1
      73: invokevirtual #13                 // Method isWsiBSPCompliant:(Lorg/apache/cxf/binding/soap/SoapMessage;)Z
      76: istore        6
      78: aconst_null
      79: astore        7
      81: aconst_null
      82: astore        8
      84: aconst_null
      85: astore        9
      87: iload_3
      88: ifeq          151
      91: aload_0
      92: aload         5
      94: aload_1
      95: invokevirtual #14                 // Method validateToken:(Lorg/w3c/dom/Element;Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/wss4j/dom/engine/WSSecurityEngineResult;
      98: astore        10
     100: aload         10
     102: ldc           #15                 // String subject
     104: invokevirtual #16                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     107: checkcast     #17                 // class javax/security/auth/Subject
     110: astore        8
     112: aload         10
     114: ldc           #18                 // String transformed-token
     116: invokevirtual #16                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     119: astore        9
     121: aload         10
     123: ldc           #19                 // String principal
     125: invokevirtual #16                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     128: checkcast     #20                 // class java/security/Principal
     131: astore        7
     133: aload         7
     135: ifnonnull     148
     138: aload_0
     139: aload         5
     141: iload         6
     143: invokevirtual #21                 // Method parseTokenAndCreatePrincipal:(Lorg/w3c/dom/Element;Z)Lorg/apache/wss4j/common/principal/UsernameTokenPrincipal;
     146: astore        7
     148: goto          167
     151: aload_0
     152: aload         5
     154: iload         6
     156: invokevirtual #21                 // Method parseTokenAndCreatePrincipal:(Lorg/w3c/dom/Element;Z)Lorg/apache/wss4j/common/principal/UsernameTokenPrincipal;
     159: astore        7
     161: aload_1
     162: aload         7
     164: invokestatic  #22                 // Method org/apache/cxf/ws/security/wss4j/WSS4JTokenConverter.convertToken:(Lorg/apache/cxf/message/Message;Ljava/security/Principal;)V
     167: aload_1
     168: ldc_w         #23                 // class org/apache/cxf/security/SecurityContext
     171: invokevirtual #24                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
     174: checkcast     #23                 // class org/apache/cxf/security/SecurityContext
     177: astore        10
     179: aload         10
     181: ifnull        194
     184: aload         10
     186: invokeinterface #25,  1           // InterfaceMethod org/apache/cxf/security/SecurityContext.getUserPrincipal:()Ljava/security/Principal;
     191: ifnonnull     333
     194: aload         9
     196: instanceof    #26                 // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     199: ifeq          222
     202: aload_1
     203: ldc_w         #23                 // class org/apache/cxf/security/SecurityContext
     206: aload_0
     207: aload_1
     208: aload         9
     210: checkcast     #26                 // class org/apache/wss4j/common/saml/SamlAssertionWrapper
     213: invokespecial #27                 // Method createSecurityContext:(Lorg/apache/cxf/message/Message;Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)Lorg/apache/cxf/security/SecurityContext;
     216: invokevirtual #28                 // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/Class;Ljava/lang/Object;)V
     219: goto          333
     222: aload         8
     224: ifnull        250
     227: aload         7
     229: ifnull        250
     232: aload_1
     233: ldc_w         #23                 // class org/apache/cxf/security/SecurityContext
     236: aload_0
     237: aload         7
     239: aload         8
     241: invokevirtual #29                 // Method createSecurityContext:(Ljava/security/Principal;Ljavax/security/auth/Subject;)Lorg/apache/cxf/security/SecurityContext;
     244: invokevirtual #28                 // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/Class;Ljava/lang/Object;)V
     247: goto          333
     250: aload         7
     252: checkcast     #30                 // class org/apache/wss4j/common/principal/UsernameTokenPrincipal
     255: astore        11
     257: aconst_null
     258: astore        12
     260: aload         11
     262: invokeinterface #31,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.getNonce:()[B
     267: ifnull        282
     270: aload         11
     272: invokeinterface #31,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.getNonce:()[B
     277: invokestatic  #32                 // Method org/apache/xml/security/utils/Base64.encode:([B)Ljava/lang/String;
     280: astore        12
     282: aload_0
     283: aload         11
     285: invokeinterface #33,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.getName:()Ljava/lang/String;
     290: aload         11
     292: invokeinterface #34,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.getPassword:()Ljava/lang/String;
     297: aload         11
     299: invokeinterface #35,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.isPasswordDigest:()Z
     304: aload         12
     306: aload         11
     308: invokeinterface #36,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.getCreatedTime:()Ljava/lang/String;
     313: invokevirtual #37                 // Method createSubject:(Ljava/lang/String;Ljava/lang/String;ZLjava/lang/String;Ljava/lang/String;)Ljavax/security/auth/Subject;
     316: astore        8
     318: aload_1
     319: ldc_w         #23                 // class org/apache/cxf/security/SecurityContext
     322: aload_0
     323: aload         11
     325: aload         8
     327: invokevirtual #29                 // Method createSecurityContext:(Ljava/security/Principal;Ljavax/security/auth/Subject;)Lorg/apache/cxf/security/SecurityContext;
     330: invokevirtual #28                 // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/Class;Ljava/lang/Object;)V
     333: aload         7
     335: instanceof    #30                 // class org/apache/wss4j/common/principal/UsernameTokenPrincipal
     338: ifeq          351
     341: aload_0
     342: aload         7
     344: checkcast     #30                 // class org/apache/wss4j/common/principal/UsernameTokenPrincipal
     347: aload_1
     348: invokespecial #38                 // Method storeResults:(Lorg/apache/wss4j/common/principal/UsernameTokenPrincipal;Lorg/apache/cxf/binding/soap/SoapMessage;)V
     351: goto          378
     354: astore        6
     356: new           #40                 // class org/apache/cxf/interceptor/Fault
     359: dup
     360: aload         6
     362: invokespecial #41                 // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     365: athrow
     366: astore        6
     368: new           #40                 // class org/apache/cxf/interceptor/Fault
     371: dup
     372: aload         6
     374: invokespecial #41                 // Method org/apache/cxf/interceptor/Fault."<init>":(Ljava/lang/Throwable;)V
     377: athrow
     378: aload         5
     380: invokestatic  #43                 // Method org/apache/cxf/helpers/DOMUtils.getNextElement:(Lorg/w3c/dom/Element;)Lorg/w3c/dom/Element;
     383: astore        5
     385: goto          36
     388: return
    Exception table:
       from    to  target type
          71   351   354   Class org/apache/wss4j/common/ext/WSSecurityException
          71   351   366   Class org/apache/xml/security/exceptions/Base64DecodingException

  private org.apache.cxf.security.SecurityContext createSecurityContext(org.apache.cxf.message.Message, org.apache.wss4j.common.saml.SamlAssertionWrapper);
    Code:
       0: ldc           #44                 // String security.saml-role-attributename
       2: aload_1
       3: invokestatic  #45                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
       6: checkcast     #46                 // class java/lang/String
       9: astore_3
      10: aload_3
      11: ifnull        21
      14: aload_3
      15: invokevirtual #47                 // Method java/lang/String.length:()I
      18: ifne          24
      21: ldc           #48                 // String http://schemas.xmlsoap.org/ws/2005/05/identity/claims/role
      23: astore_3
      24: aload_2
      25: invokestatic  #49                 // Method org/apache/cxf/rt/security/saml/utils/SAMLUtils.getClaims:(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)Lorg/apache/cxf/rt/security/claims/ClaimCollection;
      28: astore        4
      30: aload         4
      32: aload_3
      33: aconst_null
      34: invokestatic  #50                 // Method org/apache/cxf/rt/security/saml/utils/SAMLUtils.parseRolesFromClaims:(Lorg/apache/cxf/rt/security/claims/ClaimCollection;Ljava/lang/String;Ljava/lang/String;)Ljava/util/Set;
      37: astore        5
      39: new           #51                 // class org/apache/cxf/rt/security/saml/claims/SAMLSecurityContext
      42: dup
      43: new           #52                 // class org/apache/wss4j/common/principal/SAMLTokenPrincipalImpl
      46: dup
      47: aload_2
      48: invokespecial #53                 // Method org/apache/wss4j/common/principal/SAMLTokenPrincipalImpl."<init>":(Lorg/apache/wss4j/common/saml/SamlAssertionWrapper;)V
      51: aload         5
      53: aload         4
      55: invokespecial #54                 // Method org/apache/cxf/rt/security/saml/claims/SAMLSecurityContext."<init>":(Ljava/security/Principal;Ljava/util/Set;Lorg/apache/cxf/rt/security/claims/ClaimCollection;)V
      58: astore        6
      60: aload         6
      62: aload_2
      63: invokestatic  #55                 // Method org/apache/cxf/rt/security/saml/utils/SAMLUtils.getIssuer:(Ljava/lang/Object;)Ljava/lang/String;
      66: invokevirtual #56                 // Method org/apache/cxf/rt/security/saml/claims/SAMLSecurityContext.setIssuer:(Ljava/lang/String;)V
      69: aload         6
      71: aload_2
      72: invokestatic  #57                 // Method org/apache/cxf/rt/security/saml/utils/SAMLUtils.getAssertionElement:(Ljava/lang/Object;)Lorg/w3c/dom/Element;
      75: invokevirtual #58                 // Method org/apache/cxf/rt/security/saml/claims/SAMLSecurityContext.setAssertionElement:(Lorg/w3c/dom/Element;)V
      78: aload         6
      80: areturn

  private void storeResults(org.apache.wss4j.common.principal.UsernameTokenPrincipal, org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: new           #59                 // class java/util/ArrayList
       3: dup
       4: invokespecial #60                 // Method java/util/ArrayList."<init>":()V
       7: astore_3
       8: iconst_1
       9: istore        4
      11: aload_1
      12: invokeinterface #34,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.getPassword:()Ljava/lang/String;
      17: ifnonnull     25
      20: sipush        8192
      23: istore        4
      25: aload_3
      26: iconst_0
      27: new           #61                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
      30: dup
      31: iload         4
      33: aload_1
      34: aconst_null
      35: aconst_null
      36: aconst_null
      37: invokespecial #62                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult."<init>":(ILjava/security/Principal;[Ljava/security/cert/X509Certificate;Ljava/util/List;[B)V
      40: invokeinterface #63,  3           // InterfaceMethod java/util/List.add:(ILjava/lang/Object;)V
      45: aload_2
      46: ldc           #64                 // String RECV_RESULTS
      48: invokevirtual #65                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Object;)Ljava/lang/Object;
      51: checkcast     #66                 // class java/util/List
      54: invokestatic  #67                 // Method org/apache/cxf/helpers/CastUtils.cast:(Ljava/util/List;)Ljava/util/List;
      57: astore        5
      59: aload         5
      61: ifnonnull     82
      64: new           #59                 // class java/util/ArrayList
      67: dup
      68: invokespecial #60                 // Method java/util/ArrayList."<init>":()V
      71: astore        5
      73: aload_2
      74: ldc           #64                 // String RECV_RESULTS
      76: aload         5
      78: invokevirtual #68                 // Method org/apache/cxf/binding/soap/SoapMessage.put:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
      81: pop
      82: new           #69                 // class org/apache/wss4j/dom/handler/WSHandlerResult
      85: dup
      86: aconst_null
      87: aload_3
      88: iload         4
      90: invokestatic  #70                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      93: aload_3
      94: invokestatic  #71                 // Method java/util/Collections.singletonMap:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/util/Map;
      97: invokespecial #72                 // Method org/apache/wss4j/dom/handler/WSHandlerResult."<init>":(Ljava/lang/String;Ljava/util/List;Ljava/util/Map;)V
     100: astore        6
     102: aload         5
     104: iconst_0
     105: aload         6
     107: invokeinterface #63,  3           // InterfaceMethod java/util/List.add:(ILjava/lang/Object;)V
     112: aload_0
     113: aload_2
     114: aload_1
     115: iconst_0
     116: invokespecial #73                 // Method assertTokens:(Lorg/apache/cxf/binding/soap/SoapMessage;Lorg/apache/wss4j/common/principal/UsernameTokenPrincipal;Z)Lorg/apache/wss4j/policy/model/UsernameToken;
     119: pop
     120: return

  protected org.apache.wss4j.dom.engine.WSSecurityEngineResult validateToken(org.w3c.dom.Element, org.apache.cxf.binding.soap.SoapMessage) throws org.apache.wss4j.common.ext.WSSecurityException, org.apache.xml.security.exceptions.Base64DecodingException;
    Code:
       0: aload_0
       1: aload_2
       2: invokevirtual #13                 // Method isWsiBSPCompliant:(Lorg/apache/cxf/binding/soap/SoapMessage;)Z
       5: istore_3
       6: aload_0
       7: aload_2
       8: ldc_w         #74                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      11: invokevirtual #24                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      14: checkcast     #74                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      17: invokespecial #75                 // Method isAllowNoPassword:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;)Z
      20: istore        4
      22: new           #76                 // class org/apache/wss4j/dom/processor/UsernameTokenProcessor
      25: dup
      26: invokespecial #77                 // Method org/apache/wss4j/dom/processor/UsernameTokenProcessor."<init>":()V
      29: astore        5
      31: new           #78                 // class org/apache/wss4j/dom/WSDocInfo
      34: dup
      35: aload_1
      36: invokeinterface #79,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
      41: invokespecial #80                 // Method org/apache/wss4j/dom/WSDocInfo."<init>":(Lorg/w3c/dom/Document;)V
      44: astore        6
      46: new           #81                 // class org/apache/cxf/ws/security/wss4j/CXFRequestData
      49: dup
      50: invokespecial #82                 // Method org/apache/cxf/ws/security/wss4j/CXFRequestData."<init>":()V
      53: astore        7
      55: ldc           #83                 // String security.callback-handler
      57: aload_2
      58: invokestatic  #45                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
      61: astore        8
      63: aload         7
      65: aload         8
      67: invokestatic  #84                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getCallbackHandler:(Ljava/lang/Object;)Ljavax/security/auth/callback/CallbackHandler;
      70: invokevirtual #85                 // Method org/apache/wss4j/dom/handler/RequestData.setCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
      73: goto          91
      76: astore        9
      78: new           #39                 // class org/apache/wss4j/common/ext/WSSecurityException
      81: dup
      82: getstatic     #87                 // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      85: aload         9
      87: invokespecial #88                 // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/Exception;)V
      90: athrow
      91: aload         7
      93: aload_2
      94: invokevirtual #89                 // Method org/apache/wss4j/dom/handler/RequestData.setMsgContext:(Ljava/lang/Object;)V
      97: aload_2
      98: ldc           #90                 // String ws-security.enable.nonce.cache
     100: ldc           #91                 // String ws-security.nonce.cache.instance
     102: invokestatic  #92                 // Method org/apache/cxf/ws/security/wss4j/WSS4JUtils.getReplayCache:(Lorg/apache/cxf/binding/soap/SoapMessage;Ljava/lang/String;Ljava/lang/String;)Lorg/apache/wss4j/common/cache/ReplayCache;
     105: astore        9
     107: aload         7
     109: aload         9
     111: invokevirtual #93                 // Method org/apache/wss4j/dom/handler/RequestData.setNonceReplayCache:(Lorg/apache/wss4j/common/cache/ReplayCache;)V
     114: aload         7
     116: iload         4
     118: invokevirtual #94                 // Method org/apache/wss4j/dom/handler/RequestData.setAllowUsernameTokenNoPassword:(Z)V
     121: aload         7
     123: invokestatic  #95                 // Method org/apache/wss4j/dom/engine/WSSConfig.getNewInstance:()Lorg/apache/wss4j/dom/engine/WSSConfig;
     126: invokevirtual #96                 // Method org/apache/wss4j/dom/handler/RequestData.setWssConfig:(Lorg/apache/wss4j/dom/engine/WSSConfig;)V
     129: iload_3
     130: ifne          139
     133: aload         7
     135: iconst_1
     136: invokevirtual #97                 // Method org/apache/wss4j/dom/handler/RequestData.setDisableBSPEnforcement:(Z)V
     139: aload         7
     141: aload_2
     142: invokevirtual #89                 // Method org/apache/wss4j/dom/handler/RequestData.setMsgContext:(Ljava/lang/Object;)V
     145: aload         5
     147: aload_1
     148: aload         7
     150: aload         6
     152: invokevirtual #98                 // Method org/apache/wss4j/dom/processor/UsernameTokenProcessor.handleToken:(Lorg/w3c/dom/Element;Lorg/apache/wss4j/dom/handler/RequestData;Lorg/apache/wss4j/dom/WSDocInfo;)Ljava/util/List;
     155: astore        10
     157: aload         10
     159: iconst_0
     160: invokeinterface #99,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     165: checkcast     #61                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
     168: areturn
     169: astore        10
     171: aload_2
     172: aload_2
     173: invokevirtual #100                // Method org/apache/cxf/binding/soap/SoapMessage.getVersion:()Lorg/apache/cxf/binding/soap/SoapVersion;
     176: aload         10
     178: invokestatic  #101                // Method org/apache/cxf/ws/security/wss4j/WSS4JUtils.createSoapFault:(Lorg/apache/cxf/binding/soap/SoapMessage;Lorg/apache/cxf/binding/soap/SoapVersion;Lorg/apache/wss4j/common/ext/WSSecurityException;)Lorg/apache/cxf/binding/soap/SoapFault;
     181: athrow
    Exception table:
       from    to  target type
          63    73    76   Class java/lang/Exception
         145   168   169   Class org/apache/wss4j/common/ext/WSSecurityException

  protected org.apache.wss4j.common.principal.UsernameTokenPrincipal parseTokenAndCreatePrincipal(org.w3c.dom.Element, boolean) throws org.apache.wss4j.common.ext.WSSecurityException, org.apache.xml.security.exceptions.Base64DecodingException;
    Code:
       0: new           #102                // class org/apache/wss4j/common/bsp/BSPEnforcer
       3: dup
       4: iload_2
       5: ifne          12
       8: iconst_1
       9: goto          13
      12: iconst_0
      13: invokespecial #103                // Method org/apache/wss4j/common/bsp/BSPEnforcer."<init>":(Z)V
      16: astore_3
      17: new           #104                // class org/apache/wss4j/dom/message/token/UsernameToken
      20: dup
      21: aload_1
      22: iconst_0
      23: aload_3
      24: invokespecial #105                // Method org/apache/wss4j/dom/message/token/UsernameToken."<init>":(Lorg/w3c/dom/Element;ZLorg/apache/wss4j/common/bsp/BSPEnforcer;)V
      27: astore        4
      29: new           #106                // class org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl
      32: dup
      33: aload         4
      35: invokevirtual #107                // Method org/apache/wss4j/dom/message/token/UsernameToken.getName:()Ljava/lang/String;
      38: aload         4
      40: invokevirtual #108                // Method org/apache/wss4j/dom/message/token/UsernameToken.isHashed:()Z
      43: invokespecial #109                // Method org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl."<init>":(Ljava/lang/String;Z)V
      46: astore        5
      48: aload         4
      50: invokevirtual #110                // Method org/apache/wss4j/dom/message/token/UsernameToken.getNonce:()Ljava/lang/String;
      53: ifnull        69
      56: aload         5
      58: aload         4
      60: invokevirtual #110                // Method org/apache/wss4j/dom/message/token/UsernameToken.getNonce:()Ljava/lang/String;
      63: invokestatic  #111                // Method org/apache/xml/security/utils/Base64.decode:(Ljava/lang/String;)[B
      66: invokevirtual #112                // Method org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl.setNonce:([B)V
      69: aload         5
      71: aload         4
      73: invokevirtual #113                // Method org/apache/wss4j/dom/message/token/UsernameToken.getPassword:()Ljava/lang/String;
      76: invokevirtual #114                // Method org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl.setPassword:(Ljava/lang/String;)V
      79: aload         5
      81: aload         4
      83: invokevirtual #115                // Method org/apache/wss4j/dom/message/token/UsernameToken.getCreated:()Ljava/lang/String;
      86: invokevirtual #116                // Method org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl.setCreatedTime:(Ljava/lang/String;)V
      89: aload         5
      91: aload         4
      93: invokevirtual #117                // Method org/apache/wss4j/dom/message/token/UsernameToken.getPasswordType:()Ljava/lang/String;
      96: invokevirtual #118                // Method org/apache/wss4j/common/principal/WSUsernameTokenPrincipalImpl.setPasswordType:(Ljava/lang/String;)V
      99: aload         5
     101: areturn

  protected boolean isWsiBSPCompliant(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_1
       1: ldc           #119                // String ws-security.is-bsp-compliant
       3: invokevirtual #120                // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
       6: checkcast     #46                 // class java/lang/String
       9: astore_2
      10: ldc           #121                // String false
      12: aload_2
      13: invokevirtual #10                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      16: ifne          32
      19: ldc           #122                // String 0
      21: aload_2
      22: invokevirtual #10                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      25: ifne          32
      28: iconst_1
      29: goto          33
      32: iconst_0
      33: ireturn

  private boolean isAllowNoPassword(org.apache.cxf.ws.policy.AssertionInfoMap) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_1
       1: ldc           #8                  // String UsernameToken
       3: invokestatic  #123                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
       6: astore_2
       7: aload_2
       8: invokeinterface #124,  1          // InterfaceMethod java/util/Collection.isEmpty:()Z
      13: ifne          69
      16: aload_2
      17: invokeinterface #125,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      22: astore_3
      23: aload_3
      24: invokeinterface #126,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      29: ifeq          69
      32: aload_3
      33: invokeinterface #127,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      38: checkcast     #128                // class org/apache/cxf/ws/policy/AssertionInfo
      41: astore        4
      43: aload         4
      45: invokevirtual #129                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      48: checkcast     #130                // class org/apache/wss4j/policy/model/UsernameToken
      51: astore        5
      53: aload         5
      55: invokevirtual #131                // Method org/apache/wss4j/policy/model/UsernameToken.getPasswordType:()Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      58: getstatic     #132                // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.NoPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      61: if_acmpne     66
      64: iconst_1
      65: ireturn
      66: goto          23
      69: iconst_0
      70: ireturn

  protected org.apache.cxf.security.SecurityContext createSecurityContext(java.security.Principal, javax.security.auth.Subject);
    Code:
       0: new           #133                // class org/apache/cxf/interceptor/security/DefaultSecurityContext
       3: dup
       4: aload_1
       5: aload_2
       6: invokespecial #134                // Method org/apache/cxf/interceptor/security/DefaultSecurityContext."<init>":(Ljava/security/Principal;Ljavax/security/auth/Subject;)V
       9: areturn

  protected javax.security.auth.Subject createSubject(java.lang.String, java.lang.String, boolean, java.lang.String, java.lang.String) throws java.lang.SecurityException;
    Code:
       0: aconst_null
       1: areturn

  protected org.apache.wss4j.policy.model.UsernameToken assertTokens(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_1
       1: ldc_w         #74                 // class org/apache/cxf/ws/policy/AssertionInfoMap
       4: invokevirtual #24                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
       7: checkcast     #74                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      10: astore_2
      11: aload_2
      12: ldc           #135                // String WssUsernameToken10
      14: invokestatic  #136                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
      17: pop
      18: aload_2
      19: ldc           #137                // String WssUsernameToken11
      21: invokestatic  #136                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
      24: pop
      25: aload_2
      26: ldc           #138                // String HashPassword
      28: invokestatic  #136                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
      31: pop
      32: aload_2
      33: ldc           #139                // String NoPassword
      35: invokestatic  #136                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
      38: pop
      39: aload_2
      40: getstatic     #140                // Field org/apache/wss4j/policy/SP13Constants.NONCE:Ljavax/xml/namespace/QName;
      43: invokestatic  #141                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      46: pop
      47: aload_2
      48: getstatic     #142                // Field org/apache/wss4j/policy/SP13Constants.CREATED:Ljavax/xml/namespace/QName;
      51: invokestatic  #141                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
      54: pop
      55: aload_0
      56: aload_1
      57: ldc           #8                  // String UsernameToken
      59: iconst_1
      60: invokevirtual #143                // Method assertTokens:(Lorg/apache/cxf/binding/soap/SoapMessage;Ljava/lang/String;Z)Lorg/apache/wss4j/policy/model/AbstractToken;
      63: checkcast     #130                // class org/apache/wss4j/policy/model/UsernameToken
      66: areturn

  private org.apache.wss4j.policy.model.UsernameToken assertTokens(org.apache.cxf.binding.soap.SoapMessage, org.apache.wss4j.common.principal.UsernameTokenPrincipal, boolean);
    Code:
       0: aload_1
       1: ldc_w         #74                 // class org/apache/cxf/ws/policy/AssertionInfoMap
       4: invokevirtual #24                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
       7: checkcast     #74                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      10: astore        4
      12: aload         4
      14: ldc           #8                  // String UsernameToken
      16: invokestatic  #123                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      19: astore        5
      21: aconst_null
      22: astore        6
      24: aload         5
      26: invokeinterface #125,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      31: astore        7
      33: aload         7
      35: invokeinterface #126,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      40: ifeq          239
      43: aload         7
      45: invokeinterface #127,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      50: checkcast     #128                // class org/apache/cxf/ws/policy/AssertionInfo
      53: astore        8
      55: aload         8
      57: invokevirtual #129                // Method org/apache/cxf/ws/policy/AssertionInfo.getAssertion:()Lorg/apache/neethi/Assertion;
      60: checkcast     #130                // class org/apache/wss4j/policy/model/UsernameToken
      63: astore        6
      65: aload         8
      67: iconst_1
      68: invokevirtual #144                // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      71: aload         6
      73: invokevirtual #131                // Method org/apache/wss4j/policy/model/UsernameToken.getPasswordType:()Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      76: getstatic     #145                // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.HashPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      79: if_acmpne     105
      82: aload_2
      83: ifnull        95
      86: aload_2
      87: invokeinterface #35,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.isPasswordDigest:()Z
      92: ifne          105
      95: aload         8
      97: ldc           #146                // String Password hashing policy not enforced
      99: invokevirtual #147                // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     102: goto          113
     105: aload         4
     107: ldc           #138                // String HashPassword
     109: invokestatic  #136                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
     112: pop
     113: aload         6
     115: invokevirtual #131                // Method org/apache/wss4j/policy/model/UsernameToken.getPasswordType:()Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
     118: getstatic     #132                // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.NoPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
     121: if_acmpeq     156
     124: aload_0
     125: aload         6
     127: invokespecial #148                // Method isNonEndorsingSupportingToken:(Lorg/apache/wss4j/policy/model/UsernameToken;)Z
     130: ifeq          156
     133: aload_2
     134: ifnull        146
     137: aload_2
     138: invokeinterface #34,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.getPassword:()Ljava/lang/String;
     143: ifnonnull     156
     146: aload         8
     148: ldc           #149                // String Username Token No Password supplied
     150: invokevirtual #147                // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     153: goto          164
     156: aload         4
     158: ldc           #139                // String NoPassword
     160: invokestatic  #136                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
     163: pop
     164: aload         6
     166: invokevirtual #150                // Method org/apache/wss4j/policy/model/UsernameToken.isCreated:()Z
     169: ifeq          191
     172: aload_2
     173: invokeinterface #36,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.getCreatedTime:()Ljava/lang/String;
     178: ifnonnull     191
     181: aload         8
     183: ldc           #151                // String No Created Time
     185: invokevirtual #147                // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     188: goto          200
     191: aload         4
     193: getstatic     #142                // Field org/apache/wss4j/policy/SP13Constants.CREATED:Ljavax/xml/namespace/QName;
     196: invokestatic  #141                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
     199: pop
     200: aload         6
     202: invokevirtual #152                // Method org/apache/wss4j/policy/model/UsernameToken.isNonce:()Z
     205: ifeq          227
     208: aload_2
     209: invokeinterface #31,  1           // InterfaceMethod org/apache/wss4j/common/principal/UsernameTokenPrincipal.getNonce:()[B
     214: ifnonnull     227
     217: aload         8
     219: ldc           #153                // String No Nonce
     221: invokevirtual #147                // Method org/apache/cxf/ws/policy/AssertionInfo.setNotAsserted:(Ljava/lang/String;)V
     224: goto          236
     227: aload         4
     229: getstatic     #140                // Field org/apache/wss4j/policy/SP13Constants.NONCE:Ljavax/xml/namespace/QName;
     232: invokestatic  #141                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljavax/xml/namespace/QName;)Z
     235: pop
     236: goto          33
     239: aload         4
     241: ldc           #135                // String WssUsernameToken10
     243: invokestatic  #136                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
     246: pop
     247: aload         4
     249: ldc           #137                // String WssUsernameToken11
     251: invokestatic  #136                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
     254: pop
     255: aload         4
     257: ldc           #154                // String SupportingTokens
     259: invokestatic  #136                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
     262: pop
     263: iload_3
     264: ifne          275
     267: aload_0
     268: aload_1
     269: invokevirtual #155                // Method isTLSInUse:(Lorg/apache/cxf/binding/soap/SoapMessage;)Z
     272: ifeq          283
     275: aload         4
     277: ldc           #156                // String SignedSupportingTokens
     279: invokestatic  #136                // Method org/apache/cxf/ws/security/policy/PolicyUtils.assertPolicy:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Z
     282: pop
     283: aload         6
     285: areturn

  private boolean isNonEndorsingSupportingToken(org.apache.wss4j.policy.model.UsernameToken);
    Code:
       0: aload_1
       1: invokevirtual #157                // Method org/apache/wss4j/policy/model/UsernameToken.getParentAssertion:()Lorg/apache/wss4j/policy/model/AbstractSecurityAssertion;
       4: astore_2
       5: aload_2
       6: instanceof    #158                // class org/apache/wss4j/policy/model/SupportingTokens
       9: ifeq          22
      12: aload_2
      13: checkcast     #158                // class org/apache/wss4j/policy/model/SupportingTokens
      16: invokevirtual #159                // Method org/apache/wss4j/policy/model/SupportingTokens.isEndorsing:()Z
      19: ifne          26
      22: iconst_1
      23: goto          27
      26: iconst_0
      27: ireturn

  protected void addToken(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #160                // Method assertTokens:(Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/wss4j/policy/model/UsernameToken;
       5: astore_2
       6: aload_0
       7: aload_1
       8: iconst_1
       9: invokevirtual #2                  // Method findSecurityHeader:(Lorg/apache/cxf/binding/soap/SoapMessage;Z)Lorg/apache/cxf/headers/Header;
      12: astore_3
      13: aload_0
      14: aload_1
      15: aload_2
      16: invokevirtual #161                // Method addUsernameToken:(Lorg/apache/cxf/binding/soap/SoapMessage;Lorg/apache/wss4j/policy/model/UsernameToken;)Lorg/apache/wss4j/dom/message/WSSecUsernameToken;
      19: astore        4
      21: aload         4
      23: ifnonnull     96
      26: aload_1
      27: ldc_w         #74                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      30: invokevirtual #24                 // Method org/apache/cxf/binding/soap/SoapMessage.get:(Ljava/lang/Class;)Ljava/lang/Object;
      33: checkcast     #74                 // class org/apache/cxf/ws/policy/AssertionInfoMap
      36: astore        5
      38: aload         5
      40: ldc           #8                  // String UsernameToken
      42: invokestatic  #123                // Method org/apache/cxf/ws/security/policy/PolicyUtils.getAllAssertionsByLocalname:(Lorg/apache/cxf/ws/policy/AssertionInfoMap;Ljava/lang/String;)Ljava/util/Collection;
      45: astore        6
      47: aload         6
      49: invokeinterface #125,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      54: astore        7
      56: aload         7
      58: invokeinterface #126,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      63: ifeq          95
      66: aload         7
      68: invokeinterface #127,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      73: checkcast     #128                // class org/apache/cxf/ws/policy/AssertionInfo
      76: astore        8
      78: aload         8
      80: invokevirtual #162                // Method org/apache/cxf/ws/policy/AssertionInfo.isAsserted:()Z
      83: ifeq          92
      86: aload         8
      88: iconst_0
      89: invokevirtual #144                // Method org/apache/cxf/ws/policy/AssertionInfo.setAsserted:(Z)V
      92: goto          56
      95: return
      96: aload_3
      97: invokevirtual #5                  // Method org/apache/cxf/headers/Header.getObject:()Ljava/lang/Object;
     100: checkcast     #6                  // class org/w3c/dom/Element
     103: astore        5
     105: aload         4
     107: aload         5
     109: invokeinterface #79,  1           // InterfaceMethod org/w3c/dom/Element.getOwnerDocument:()Lorg/w3c/dom/Document;
     114: invokevirtual #163                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.prepare:(Lorg/w3c/dom/Document;)V
     117: aload         5
     119: aload         4
     121: invokevirtual #164                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.getUsernameTokenElement:()Lorg/w3c/dom/Element;
     124: invokeinterface #165,  2          // InterfaceMethod org/w3c/dom/Element.appendChild:(Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;
     129: pop
     130: return

  protected org.apache.wss4j.dom.message.WSSecUsernameToken addUsernameToken(org.apache.cxf.binding.soap.SoapMessage, org.apache.wss4j.policy.model.UsernameToken);
    Code:
       0: ldc           #166                // String security.username
       2: aload_1
       3: invokestatic  #45                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
       6: checkcast     #46                 // class java/lang/String
       9: astore_3
      10: aload_1
      11: ldc_w         #167                // class org/apache/wss4j/dom/engine/WSSConfig
      14: invokevirtual #168                // Method java/lang/Class.getName:()Ljava/lang/String;
      17: invokevirtual #120                // Method org/apache/cxf/binding/soap/SoapMessage.getContextualProperty:(Ljava/lang/String;)Ljava/lang/Object;
      20: checkcast     #167                // class org/apache/wss4j/dom/engine/WSSConfig
      23: astore        4
      25: aload         4
      27: ifnonnull     35
      30: invokestatic  #95                 // Method org/apache/wss4j/dom/engine/WSSConfig.getNewInstance:()Lorg/apache/wss4j/dom/engine/WSSConfig;
      33: astore        4
      35: aload_3
      36: invokestatic  #169                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
      39: ifne          236
      42: aload_2
      43: invokevirtual #131                // Method org/apache/wss4j/policy/model/UsernameToken.getPasswordType:()Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      46: getstatic     #132                // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.NoPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
      49: if_acmpne     97
      52: new           #170                // class org/apache/wss4j/dom/message/WSSecUsernameToken
      55: dup
      56: invokespecial #171                // Method org/apache/wss4j/dom/message/WSSecUsernameToken."<init>":()V
      59: astore        5
      61: aload         5
      63: aload         4
      65: invokevirtual #172                // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
      68: invokevirtual #173                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
      71: aload         5
      73: aload         4
      75: invokevirtual #174                // Method org/apache/wss4j/dom/engine/WSSConfig.getCurrentTime:()Lorg/apache/wss4j/common/util/WSTimeSource;
      78: invokevirtual #175                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setWsTimeSource:(Lorg/apache/wss4j/common/util/WSTimeSource;)V
      81: aload         5
      83: aload_3
      84: aconst_null
      85: invokevirtual #176                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
      88: aload         5
      90: aconst_null
      91: invokevirtual #177                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setPasswordType:(Ljava/lang/String;)V
      94: aload         5
      96: areturn
      97: ldc           #178                // String security.password
      99: aload_1
     100: invokestatic  #45                 // Method org/apache/cxf/rt/security/utils/SecurityUtils.getSecurityPropertyValue:(Ljava/lang/String;Lorg/apache/cxf/message/Message;)Ljava/lang/Object;
     103: checkcast     #46                 // class java/lang/String
     106: astore        5
     108: aload         5
     110: invokestatic  #169                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     113: ifeq          126
     116: aload_0
     117: aload_3
     118: aload_2
     119: iconst_2
     120: aload_1
     121: invokevirtual #179                // Method getPassword:(Ljava/lang/String;Lorg/apache/wss4j/policy/model/AbstractToken;ILorg/apache/cxf/binding/soap/SoapMessage;)Ljava/lang/String;
     124: astore        5
     126: aload         5
     128: invokestatic  #169                // Method org/apache/cxf/common/util/StringUtils.isEmpty:(Ljava/lang/String;)Z
     131: ifne          225
     134: new           #170                // class org/apache/wss4j/dom/message/WSSecUsernameToken
     137: dup
     138: invokespecial #171                // Method org/apache/wss4j/dom/message/WSSecUsernameToken."<init>":()V
     141: astore        6
     143: aload         6
     145: aload         4
     147: invokevirtual #172                // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     150: invokevirtual #173                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setIdAllocator:(Lorg/apache/wss4j/dom/WsuIdAllocator;)V
     153: aload         6
     155: aload         4
     157: invokevirtual #174                // Method org/apache/wss4j/dom/engine/WSSConfig.getCurrentTime:()Lorg/apache/wss4j/common/util/WSTimeSource;
     160: invokevirtual #175                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setWsTimeSource:(Lorg/apache/wss4j/common/util/WSTimeSource;)V
     163: aload_2
     164: invokevirtual #131                // Method org/apache/wss4j/policy/model/UsernameToken.getPasswordType:()Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
     167: getstatic     #145                // Field org/apache/wss4j/policy/model/UsernameToken$PasswordType.HashPassword:Lorg/apache/wss4j/policy/model/UsernameToken$PasswordType;
     170: if_acmpne     183
     173: aload         6
     175: ldc           #180                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest
     177: invokevirtual #177                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setPasswordType:(Ljava/lang/String;)V
     180: goto          190
     183: aload         6
     185: ldc           #181                // String http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText
     187: invokevirtual #177                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setPasswordType:(Ljava/lang/String;)V
     190: aload_2
     191: invokevirtual #150                // Method org/apache/wss4j/policy/model/UsernameToken.isCreated:()Z
     194: ifeq          202
     197: aload         6
     199: invokevirtual #182                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.addCreated:()V
     202: aload_2
     203: invokevirtual #152                // Method org/apache/wss4j/policy/model/UsernameToken.isNonce:()Z
     206: ifeq          214
     209: aload         6
     211: invokevirtual #183                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.addNonce:()V
     214: aload         6
     216: aload_3
     217: aload         5
     219: invokevirtual #176                // Method org/apache/wss4j/dom/message/WSSecUsernameToken.setUserInfo:(Ljava/lang/String;Ljava/lang/String;)V
     222: aload         6
     224: areturn
     225: aload_0
     226: aload_2
     227: ldc           #184                // String No username available
     229: aload_1
     230: invokevirtual #185                // Method policyNotAsserted:(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/String;Lorg/apache/cxf/binding/soap/SoapMessage;)V
     233: goto          244
     236: aload_0
     237: aload_2
     238: ldc           #184                // String No username available
     240: aload_1
     241: invokevirtual #185                // Method policyNotAsserted:(Lorg/apache/wss4j/policy/model/AbstractToken;Ljava/lang/String;Lorg/apache/cxf/binding/soap/SoapMessage;)V
     244: aconst_null
     245: areturn

  protected org.apache.wss4j.policy.model.AbstractToken assertTokens(org.apache.cxf.binding.soap.SoapMessage);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #160                // Method assertTokens:(Lorg/apache/cxf/binding/soap/SoapMessage;)Lorg/apache/wss4j/policy/model/UsernameToken;
       5: areturn
}
