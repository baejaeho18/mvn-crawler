Compiled from "SCTProvider.java"
public class org.apache.cxf.sts.token.provider.SCTProvider implements org.apache.cxf.sts.token.provider.TokenProvider {
  private static final java.util.logging.Logger LOG;

  private boolean returnEntropy;

  private long lifetime;

  public org.apache.cxf.sts.token.provider.SCTProvider();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iconst_1
       6: putfield      #2                  // Field returnEntropy:Z
       9: aload_0
      10: ldc2_w        #3                  // long 1800l
      13: putfield      #5                  // Field lifetime:J
      16: return

  public long getLifetime();
    Code:
       0: aload_0
       1: getfield      #5                  // Field lifetime:J
       4: lreturn

  public void setLifetime(long);
    Code:
       0: aload_0
       1: lload_1
       2: putfield      #5                  // Field lifetime:J
       5: return

  public boolean canHandleToken(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aconst_null
       3: invokevirtual #6                  // Method canHandleToken:(Ljava/lang/String;Ljava/lang/String;)Z
       6: ireturn

  public boolean canHandleToken(java.lang.String, java.lang.String);
    Code:
       0: ldc           #7                  // String http://schemas.xmlsoap.org/ws/2005/02/sc/sct
       2: aload_1
       3: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       6: ifne          18
       9: ldc           #9                  // String http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512/sct
      11: aload_1
      12: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      15: ifeq          22
      18: iconst_1
      19: goto          23
      22: iconst_0
      23: ireturn

  public void setReturnEntropy(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #2                  // Field returnEntropy:Z
       5: return

  public boolean isReturnEntropy();
    Code:
       0: aload_0
       1: getfield      #2                  // Field returnEntropy:Z
       4: ireturn

  public org.apache.cxf.sts.token.provider.TokenProviderResponse createToken(org.apache.cxf.sts.token.provider.TokenProviderParameters);
    Code:
       0: aload_1
       1: invokevirtual #10                 // Method org/apache/cxf/sts/token/provider/TokenProviderParameters.getTokenRequirements:()Lorg/apache/cxf/sts/request/TokenRequirements;
       4: astore_2
       5: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
       8: getstatic     #12                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
      11: invokevirtual #13                 // Method java/util/logging/Logger.isLoggable:(Ljava/util/logging/Level;)Z
      14: ifeq          45
      17: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
      20: new           #14                 // class java/lang/StringBuilder
      23: dup
      24: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
      27: ldc           #16                 // String Handling token of type:
      29: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      32: aload_2
      33: invokevirtual #18                 // Method org/apache/cxf/sts/request/TokenRequirements.getTokenType:()Ljava/lang/String;
      36: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      39: invokevirtual #19                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      42: invokevirtual #20                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
      45: aload_1
      46: invokevirtual #21                 // Method org/apache/cxf/sts/token/provider/TokenProviderParameters.getTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      49: ifnonnull     76
      52: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
      55: getstatic     #12                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
      58: ldc           #22                 // String A cache must be configured to use the SCTProvider
      60: invokevirtual #23                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;)V
      63: new           #24                 // class org/apache/cxf/ws/security/sts/provider/STSException
      66: dup
      67: ldc           #25                 // String Can\'t serialize SCT
      69: getstatic     #26                 // Field org/apache/cxf/ws/security/sts/provider/STSException.REQUEST_FAILED:Ljavax/xml/namespace/QName;
      72: invokespecial #27                 // Method org/apache/cxf/ws/security/sts/provider/STSException."<init>":(Ljava/lang/String;Ljavax/xml/namespace/QName;)V
      75: athrow
      76: new           #28                 // class org/apache/cxf/sts/token/provider/SymmetricKeyHandler
      79: dup
      80: aload_1
      81: invokespecial #29                 // Method org/apache/cxf/sts/token/provider/SymmetricKeyHandler."<init>":(Lorg/apache/cxf/sts/token/provider/TokenProviderParameters;)V
      84: astore_3
      85: aload_3
      86: invokevirtual #30                 // Method org/apache/cxf/sts/token/provider/SymmetricKeyHandler.createSymmetricKey:()V
      89: invokestatic  #31                 // Method org/apache/cxf/helpers/DOMUtils.createDocument:()Lorg/w3c/dom/Document;
      92: astore        4
      94: new           #32                 // class org/apache/wss4j/dom/message/token/SecurityContextToken
      97: dup
      98: aload_2
      99: invokevirtual #18                 // Method org/apache/cxf/sts/request/TokenRequirements.getTokenType:()Ljava/lang/String;
     102: invokestatic  #33                 // Method getWSCVersion:(Ljava/lang/String;)I
     105: aload         4
     107: invokespecial #34                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken."<init>":(ILorg/w3c/dom/Document;)V
     110: astore        5
     112: invokestatic  #35                 // Method org/apache/wss4j/dom/engine/WSSConfig.getNewInstance:()Lorg/apache/wss4j/dom/engine/WSSConfig;
     115: astore        6
     117: aload         5
     119: aload         6
     121: invokevirtual #36                 // Method org/apache/wss4j/dom/engine/WSSConfig.getIdAllocator:()Lorg/apache/wss4j/dom/WsuIdAllocator;
     124: ldc           #37                 // String sctId-
     126: aload         5
     128: invokeinterface #38,  3           // InterfaceMethod org/apache/wss4j/dom/WsuIdAllocator.createId:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/String;
     133: invokevirtual #39                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.setID:(Ljava/lang/String;)V
     136: new           #40                 // class org/apache/cxf/sts/token/provider/TokenProviderResponse
     139: dup
     140: invokespecial #41                 // Method org/apache/cxf/sts/token/provider/TokenProviderResponse."<init>":()V
     143: astore        7
     145: aload         7
     147: aload         5
     149: invokevirtual #42                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getElement:()Lorg/w3c/dom/Element;
     152: invokevirtual #43                 // Method org/apache/cxf/sts/token/provider/TokenProviderResponse.setToken:(Lorg/w3c/dom/Element;)V
     155: aload         7
     157: aload         5
     159: invokevirtual #44                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getIdentifier:()Ljava/lang/String;
     162: invokevirtual #45                 // Method org/apache/cxf/sts/token/provider/TokenProviderResponse.setTokenId:(Ljava/lang/String;)V
     165: aload_0
     166: getfield      #2                  // Field returnEntropy:Z
     169: ifeq          181
     172: aload         7
     174: aload_3
     175: invokevirtual #46                 // Method org/apache/cxf/sts/token/provider/SymmetricKeyHandler.getEntropyBytes:()[B
     178: invokevirtual #47                 // Method org/apache/cxf/sts/token/provider/TokenProviderResponse.setEntropy:([B)V
     181: aload_3
     182: invokevirtual #48                 // Method org/apache/cxf/sts/token/provider/SymmetricKeyHandler.getKeySize:()J
     185: lstore        8
     187: aload         7
     189: lload         8
     191: invokevirtual #49                 // Method org/apache/cxf/sts/token/provider/TokenProviderResponse.setKeySize:(J)V
     194: aload         7
     196: aload_3
     197: invokevirtual #50                 // Method org/apache/cxf/sts/token/provider/SymmetricKeyHandler.isComputedKey:()Z
     200: invokevirtual #51                 // Method org/apache/cxf/sts/token/provider/TokenProviderResponse.setComputedKey:(Z)V
     203: new           #52                 // class java/util/Date
     206: dup
     207: invokespecial #53                 // Method java/util/Date."<init>":()V
     210: astore        10
     212: aload         7
     214: aload         10
     216: invokevirtual #54                 // Method org/apache/cxf/sts/token/provider/TokenProviderResponse.setCreated:(Ljava/util/Date;)V
     219: aconst_null
     220: astore        11
     222: aload_0
     223: getfield      #5                  // Field lifetime:J
     226: lconst_0
     227: lcmp
     228: ifle          263
     231: new           #52                 // class java/util/Date
     234: dup
     235: invokespecial #53                 // Method java/util/Date."<init>":()V
     238: astore        11
     240: aload         10
     242: invokevirtual #55                 // Method java/util/Date.getTime:()J
     245: lstore        12
     247: aload         11
     249: lload         12
     251: aload_0
     252: getfield      #5                  // Field lifetime:J
     255: ldc2_w        #56                 // long 1000l
     258: lmul
     259: ladd
     260: invokevirtual #58                 // Method java/util/Date.setTime:(J)V
     263: aload         7
     265: aload         11
     267: invokevirtual #59                 // Method org/apache/cxf/sts/token/provider/TokenProviderResponse.setExpires:(Ljava/util/Date;)V
     270: new           #60                 // class org/apache/cxf/ws/security/tokenstore/SecurityToken
     273: dup
     274: aload         5
     276: invokevirtual #44                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getIdentifier:()Ljava/lang/String;
     279: aload         10
     281: aload         11
     283: invokespecial #61                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken."<init>":(Ljava/lang/String;Ljava/util/Date;Ljava/util/Date;)V
     286: astore        12
     288: aload         12
     290: aload_3
     291: invokevirtual #62                 // Method org/apache/cxf/sts/token/provider/SymmetricKeyHandler.getSecret:()[B
     294: invokevirtual #63                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setSecret:([B)V
     297: aload         12
     299: aload_1
     300: invokevirtual #64                 // Method org/apache/cxf/sts/token/provider/TokenProviderParameters.getPrincipal:()Ljava/security/Principal;
     303: invokevirtual #65                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setPrincipal:(Ljava/security/Principal;)V
     306: aload         12
     308: invokevirtual #66                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getProperties:()Ljava/util/Map;
     311: astore        13
     313: aload         13
     315: ifnonnull     327
     318: new           #67                 // class java/util/HashMap
     321: dup
     322: invokespecial #68                 // Method java/util/HashMap."<init>":()V
     325: astore        13
     327: aload         12
     329: aload         13
     331: invokevirtual #69                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.setProperties:(Ljava/util/Map;)V
     334: aload_1
     335: invokevirtual #70                 // Method org/apache/cxf/sts/token/provider/TokenProviderParameters.getRealm:()Ljava/lang/String;
     338: ifnull        355
     341: aload         13
     343: ldc           #71                 // String org.apache.cxf.sts.token.realm
     345: aload_1
     346: invokevirtual #70                 // Method org/apache/cxf/sts/token/provider/TokenProviderParameters.getRealm:()Ljava/lang/String;
     349: invokeinterface #72,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     354: pop
     355: aload_1
     356: invokevirtual #10                 // Method org/apache/cxf/sts/token/provider/TokenProviderParameters.getTokenRequirements:()Lorg/apache/cxf/sts/request/TokenRequirements;
     359: invokevirtual #73                 // Method org/apache/cxf/sts/request/TokenRequirements.getRenewing:()Lorg/apache/cxf/sts/request/Renewing;
     362: astore        14
     364: aload         14
     366: ifnull        408
     369: aload         13
     371: ldc           #74                 // String org.apache.cxf.sts.token.renewing.allow
     373: aload         14
     375: invokevirtual #75                 // Method org/apache/cxf/sts/request/Renewing.isAllowRenewing:()Z
     378: invokestatic  #76                 // Method java/lang/String.valueOf:(Z)Ljava/lang/String;
     381: invokeinterface #72,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     386: pop
     387: aload         13
     389: ldc           #77                 // String org.apache.cxf.sts.token.renewing.allow.after.expiry
     391: aload         14
     393: invokevirtual #78                 // Method org/apache/cxf/sts/request/Renewing.isAllowRenewingAfterExpiry:()Z
     396: invokestatic  #76                 // Method java/lang/String.valueOf:(Z)Ljava/lang/String;
     399: invokeinterface #72,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     404: pop
     405: goto          432
     408: aload         13
     410: ldc           #74                 // String org.apache.cxf.sts.token.renewing.allow
     412: ldc           #79                 // String true
     414: invokeinterface #72,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     419: pop
     420: aload         13
     422: ldc           #77                 // String org.apache.cxf.sts.token.renewing.allow.after.expiry
     424: ldc           #80                 // String false
     426: invokeinterface #72,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     431: pop
     432: aload_1
     433: invokevirtual #21                 // Method org/apache/cxf/sts/token/provider/TokenProviderParameters.getTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     436: aload         12
     438: invokeinterface #81,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.add:(Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;)V
     443: new           #82                 // class org/apache/cxf/sts/token/provider/TokenReference
     446: dup
     447: invokespecial #83                 // Method org/apache/cxf/sts/token/provider/TokenReference."<init>":()V
     450: astore        15
     452: aload         15
     454: aload         5
     456: invokevirtual #84                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getID:()Ljava/lang/String;
     459: invokevirtual #85                 // Method org/apache/cxf/sts/token/provider/TokenReference.setIdentifier:(Ljava/lang/String;)V
     462: aload         15
     464: iconst_1
     465: invokevirtual #86                 // Method org/apache/cxf/sts/token/provider/TokenReference.setUseDirectReference:(Z)V
     468: aload         15
     470: aload_2
     471: invokevirtual #18                 // Method org/apache/cxf/sts/request/TokenRequirements.getTokenType:()Ljava/lang/String;
     474: invokevirtual #87                 // Method org/apache/cxf/sts/token/provider/TokenReference.setWsseValueType:(Ljava/lang/String;)V
     477: aload         7
     479: aload         15
     481: invokevirtual #88                 // Method org/apache/cxf/sts/token/provider/TokenProviderResponse.setAttachedReference:(Lorg/apache/cxf/sts/token/provider/TokenReference;)V
     484: new           #82                 // class org/apache/cxf/sts/token/provider/TokenReference
     487: dup
     488: invokespecial #83                 // Method org/apache/cxf/sts/token/provider/TokenReference."<init>":()V
     491: astore        16
     493: aload         16
     495: aload         5
     497: invokevirtual #44                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getIdentifier:()Ljava/lang/String;
     500: invokevirtual #85                 // Method org/apache/cxf/sts/token/provider/TokenReference.setIdentifier:(Ljava/lang/String;)V
     503: aload         16
     505: iconst_1
     506: invokevirtual #86                 // Method org/apache/cxf/sts/token/provider/TokenReference.setUseDirectReference:(Z)V
     509: aload         16
     511: aload_2
     512: invokevirtual #18                 // Method org/apache/cxf/sts/request/TokenRequirements.getTokenType:()Ljava/lang/String;
     515: invokevirtual #87                 // Method org/apache/cxf/sts/token/provider/TokenReference.setWsseValueType:(Ljava/lang/String;)V
     518: aload         7
     520: aload         16
     522: invokevirtual #89                 // Method org/apache/cxf/sts/token/provider/TokenProviderResponse.setUnattachedReference:(Lorg/apache/cxf/sts/token/provider/TokenReference;)V
     525: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     528: ldc           #90                 // String SecurityContextToken successfully created
     530: invokevirtual #20                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
     533: aload         7
     535: areturn
     536: astore        4
     538: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     541: getstatic     #92                 // Field java/util/logging/Level.WARNING:Ljava/util/logging/Level;
     544: ldc           #93                 // String
     546: aload         4
     548: invokevirtual #94                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     551: new           #24                 // class org/apache/cxf/ws/security/sts/provider/STSException
     554: dup
     555: ldc           #25                 // String Can\'t serialize SCT
     557: aload         4
     559: getstatic     #26                 // Field org/apache/cxf/ws/security/sts/provider/STSException.REQUEST_FAILED:Ljavax/xml/namespace/QName;
     562: invokespecial #95                 // Method org/apache/cxf/ws/security/sts/provider/STSException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;Ljavax/xml/namespace/QName;)V
     565: athrow
    Exception table:
       from    to  target type
          89   535   536   Class java/lang/Exception

  private static int getWSCVersion(java.lang.String) throws org.apache.wss4j.common.ext.WSSecurityException;
    Code:
       0: aload_0
       1: ifnonnull     6
       4: iconst_2
       5: ireturn
       6: aload_0
       7: ldc           #96                 // String http://schemas.xmlsoap.org/ws/2005/02/sc
       9: invokevirtual #97                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      12: ifeq          21
      15: ldc           #96                 // String http://schemas.xmlsoap.org/ws/2005/02/sc
      17: invokestatic  #98                 // Method org/apache/wss4j/common/derivedKey/ConversationConstants.getWSTVersion:(Ljava/lang/String;)I
      20: ireturn
      21: aload_0
      22: ldc           #99                 // String http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512
      24: invokevirtual #97                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      27: ifeq          36
      30: ldc           #99                 // String http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512
      32: invokestatic  #98                 // Method org/apache/wss4j/common/derivedKey/ConversationConstants.getWSTVersion:(Ljava/lang/String;)I
      35: ireturn
      36: new           #100                // class org/apache/wss4j/common/ext/WSSecurityException
      39: dup
      40: getstatic     #101                // Field org/apache/wss4j/common/ext/WSSecurityException$ErrorCode.FAILURE:Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;
      43: ldc           #102                // String unsupportedSecConvVersion
      45: invokespecial #103                // Method org/apache/wss4j/common/ext/WSSecurityException."<init>":(Lorg/apache/wss4j/common/ext/WSSecurityException$ErrorCode;Ljava/lang/String;)V
      48: athrow

  static {};
    Code:
       0: ldc_w         #104                // class org/apache/cxf/sts/token/provider/SCTProvider
       3: invokestatic  #105                // Method org/apache/cxf/common/logging/LogUtils.getL7dLogger:(Ljava/lang/Class;)Ljava/util/logging/Logger;
       6: putstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
       9: return
}
