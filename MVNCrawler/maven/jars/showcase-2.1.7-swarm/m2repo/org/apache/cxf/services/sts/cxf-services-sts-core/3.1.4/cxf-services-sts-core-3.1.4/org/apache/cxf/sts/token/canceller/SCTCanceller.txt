Compiled from "SCTCanceller.java"
public class org.apache.cxf.sts.token.canceller.SCTCanceller implements org.apache.cxf.sts.token.canceller.TokenCanceller {
  private static final java.util.logging.Logger LOG;

  private boolean verifyProofOfPossession;

  public org.apache.cxf.sts.token.canceller.SCTCanceller();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iconst_1
       6: putfield      #2                  // Field verifyProofOfPossession:Z
       9: return

  public boolean canHandleToken(org.apache.cxf.sts.request.ReceivedToken);
    Code:
       0: aload_1
       1: invokevirtual #3                  // Method org/apache/cxf/sts/request/ReceivedToken.getToken:()Ljava/lang/Object;
       4: astore_2
       5: aload_2
       6: instanceof    #4                  // class org/w3c/dom/Element
       9: ifeq          65
      12: aload_2
      13: checkcast     #4                  // class org/w3c/dom/Element
      16: astore_3
      17: aload_3
      18: invokeinterface #5,  1            // InterfaceMethod org/w3c/dom/Element.getNamespaceURI:()Ljava/lang/String;
      23: astore        4
      25: aload_3
      26: invokeinterface #6,  1            // InterfaceMethod org/w3c/dom/Element.getLocalName:()Ljava/lang/String;
      31: astore        5
      33: ldc           #7                  // String http://schemas.xmlsoap.org/ws/2005/02/sc
      35: aload         4
      37: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      40: ifne          53
      43: ldc           #9                  // String http://docs.oasis-open.org/ws-sx/ws-secureconversation/200512
      45: aload         4
      47: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      50: ifeq          65
      53: ldc           #10                 // String SecurityContextToken
      55: aload         5
      57: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      60: ifeq          65
      63: iconst_1
      64: ireturn
      65: iconst_0
      66: ireturn

  public org.apache.cxf.sts.token.canceller.TokenCancellerResponse cancelToken(org.apache.cxf.sts.token.canceller.TokenCancellerParameters);
    Code:
       0: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
       3: ldc           #12                 // String Trying to cancel a SecurityContextToken
       5: invokevirtual #13                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
       8: new           #14                 // class org/apache/cxf/sts/token/canceller/TokenCancellerResponse
      11: dup
      12: invokespecial #15                 // Method org/apache/cxf/sts/token/canceller/TokenCancellerResponse."<init>":()V
      15: astore_2
      16: aload_1
      17: invokevirtual #16                 // Method org/apache/cxf/sts/token/canceller/TokenCancellerParameters.getToken:()Lorg/apache/cxf/sts/request/ReceivedToken;
      20: astore_3
      21: aload_1
      22: invokevirtual #17                 // Method org/apache/cxf/sts/token/canceller/TokenCancellerParameters.getTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
      25: ifnonnull     41
      28: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
      31: getstatic     #18                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
      34: ldc           #19                 // String A cache must be configured to use the SCTCanceller
      36: invokevirtual #20                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;)V
      39: aload_2
      40: areturn
      41: aload_3
      42: ifnonnull     58
      45: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
      48: getstatic     #18                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
      51: ldc           #21                 // String Cancel Target is null
      53: invokevirtual #20                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;)V
      56: aload_2
      57: areturn
      58: aload_3
      59: getstatic     #22                 // Field org/apache/cxf/sts/request/ReceivedToken$STATE.NONE:Lorg/apache/cxf/sts/request/ReceivedToken$STATE;
      62: invokevirtual #23                 // Method org/apache/cxf/sts/request/ReceivedToken.setState:(Lorg/apache/cxf/sts/request/ReceivedToken$STATE;)V
      65: aload_2
      66: aload_3
      67: invokevirtual #24                 // Method org/apache/cxf/sts/token/canceller/TokenCancellerResponse.setToken:(Lorg/apache/cxf/sts/request/ReceivedToken;)V
      70: aload_3
      71: invokevirtual #25                 // Method org/apache/cxf/sts/request/ReceivedToken.isDOMElement:()Z
      74: ifeq          235
      77: aload_3
      78: invokevirtual #3                  // Method org/apache/cxf/sts/request/ReceivedToken.getToken:()Ljava/lang/Object;
      81: checkcast     #4                  // class org/w3c/dom/Element
      84: astore        4
      86: new           #26                 // class org/apache/wss4j/dom/message/token/SecurityContextToken
      89: dup
      90: aload         4
      92: invokespecial #27                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken."<init>":(Lorg/w3c/dom/Element;)V
      95: astore        5
      97: aload         5
      99: invokevirtual #28                 // Method org/apache/wss4j/dom/message/token/SecurityContextToken.getIdentifier:()Ljava/lang/String;
     102: astore        6
     104: aload_1
     105: invokevirtual #17                 // Method org/apache/cxf/sts/token/canceller/TokenCancellerParameters.getTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     108: aload         6
     110: invokeinterface #29,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.getToken:(Ljava/lang/String;)Lorg/apache/cxf/ws/security/tokenstore/SecurityToken;
     115: astore        7
     117: aload         7
     119: ifnonnull     155
     122: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     125: new           #30                 // class java/lang/StringBuilder
     128: dup
     129: invokespecial #31                 // Method java/lang/StringBuilder."<init>":()V
     132: ldc           #32                 // String Identifier:
     134: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     137: aload         6
     139: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     142: ldc           #34                 // String  is not found in the cache
     144: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     147: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     150: invokevirtual #13                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
     153: aload_2
     154: areturn
     155: aload_0
     156: getfield      #2                  // Field verifyProofOfPossession:Z
     159: ifeq          188
     162: aload_0
     163: aload_1
     164: aload         7
     166: invokevirtual #36                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getSecret:()[B
     169: invokespecial #37                 // Method matchKey:(Lorg/apache/cxf/sts/token/canceller/TokenCancellerParameters;[B)Z
     172: ifne          188
     175: new           #38                 // class org/apache/cxf/ws/security/sts/provider/STSException
     178: dup
     179: ldc           #39                 // String Failed to verify the proof of possession of the key associated with the security context. No matching key found in the request.
     181: getstatic     #40                 // Field org/apache/cxf/ws/security/sts/provider/STSException.INVALID_REQUEST:Ljavax/xml/namespace/QName;
     184: invokespecial #41                 // Method org/apache/cxf/ws/security/sts/provider/STSException."<init>":(Ljava/lang/String;Ljavax/xml/namespace/QName;)V
     187: athrow
     188: aload_1
     189: invokevirtual #17                 // Method org/apache/cxf/sts/token/canceller/TokenCancellerParameters.getTokenStore:()Lorg/apache/cxf/ws/security/tokenstore/TokenStore;
     192: aload         7
     194: invokevirtual #42                 // Method org/apache/cxf/ws/security/tokenstore/SecurityToken.getId:()Ljava/lang/String;
     197: invokeinterface #43,  2           // InterfaceMethod org/apache/cxf/ws/security/tokenstore/TokenStore.remove:(Ljava/lang/String;)V
     202: aload_3
     203: getstatic     #44                 // Field org/apache/cxf/sts/request/ReceivedToken$STATE.CANCELLED:Lorg/apache/cxf/sts/request/ReceivedToken$STATE;
     206: invokevirtual #23                 // Method org/apache/cxf/sts/request/ReceivedToken.setState:(Lorg/apache/cxf/sts/request/ReceivedToken$STATE;)V
     209: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     212: ldc           #45                 // String SecurityContextToken successfully cancelled
     214: invokevirtual #13                 // Method java/util/logging/Logger.fine:(Ljava/lang/String;)V
     217: goto          235
     220: astore        4
     222: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     225: getstatic     #47                 // Field java/util/logging/Level.WARNING:Ljava/util/logging/Level;
     228: ldc           #48                 // String
     230: aload         4
     232: invokevirtual #49                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     235: aload_2
     236: areturn
    Exception table:
       from    to  target type
          77   154   220   Class org/apache/wss4j/common/ext/WSSecurityException
         155   217   220   Class org/apache/wss4j/common/ext/WSSecurityException

  private boolean matchKey(org.apache.cxf.sts.token.canceller.TokenCancellerParameters, byte[]);
    Code:
       0: aload_1
       1: invokevirtual #50                 // Method org/apache/cxf/sts/token/canceller/TokenCancellerParameters.getWebServiceContext:()Ljavax/xml/ws/WebServiceContext;
       4: invokeinterface #51,  1           // InterfaceMethod javax/xml/ws/WebServiceContext.getMessageContext:()Ljavax/xml/ws/handler/MessageContext;
       9: astore_3
      10: aload_0
      11: aload_3
      12: aload_2
      13: invokespecial #52                 // Method matchDOMSignatureSecret:(Ljavax/xml/ws/handler/MessageContext;[B)Z
      16: ifeq          21
      19: iconst_1
      20: ireturn
      21: aload_0
      22: aload_3
      23: aload_2
      24: invokespecial #53                 // Method matchStreamingSignatureSecret:(Ljavax/xml/ws/handler/MessageContext;[B)Z
      27: ifeq          32
      30: iconst_1
      31: ireturn
      32: goto          55
      35: astore        4
      37: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
      40: getstatic     #18                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
      43: aload         4
      45: invokevirtual #55                 // Method org/apache/xml/security/exceptions/XMLSecurityException.getMessage:()Ljava/lang/String;
      48: aload         4
      50: invokevirtual #49                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
      53: iconst_0
      54: ireturn
      55: iconst_0
      56: ireturn
    Exception table:
       from    to  target type
          21    31    35   Class org/apache/xml/security/exceptions/XMLSecurityException

  public void setVerifyProofOfPossession(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #2                  // Field verifyProofOfPossession:Z
       5: return

  private boolean matchDOMSignatureSecret(javax.xml.ws.handler.MessageContext, byte[]);
    Code:
       0: aload_1
       1: ldc           #56                 // String RECV_RESULTS
       3: invokeinterface #57,  2           // InterfaceMethod javax/xml/ws/handler/MessageContext.get:(Ljava/lang/Object;)Ljava/lang/Object;
       8: checkcast     #58                 // class java/util/List
      11: invokestatic  #59                 // Method org/apache/cxf/helpers/CastUtils.cast:(Ljava/util/List;)Ljava/util/List;
      14: astore_3
      15: aload_3
      16: ifnull        135
      19: aload_3
      20: invokeinterface #60,  1           // InterfaceMethod java/util/List.size:()I
      25: ifle          135
      28: aload_3
      29: iconst_0
      30: invokeinterface #61,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      35: checkcast     #62                 // class org/apache/wss4j/dom/handler/WSHandlerResult
      38: astore        4
      40: aload         4
      42: invokevirtual #63                 // Method org/apache/wss4j/dom/handler/WSHandlerResult.getActionResults:()Ljava/util/Map;
      45: iconst_2
      46: invokestatic  #64                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      49: invokeinterface #65,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      54: checkcast     #58                 // class java/util/List
      57: astore        5
      59: aload         5
      61: ifnull        135
      64: aload         5
      66: invokeinterface #66,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      71: astore        6
      73: aload         6
      75: invokeinterface #67,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      80: ifeq          135
      83: aload         6
      85: invokeinterface #68,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      90: checkcast     #69                 // class org/apache/wss4j/dom/engine/WSSecurityEngineResult
      93: astore        7
      95: aload         7
      97: ldc           #70                 // String secret
      99: invokevirtual #71                 // Method org/apache/wss4j/dom/engine/WSSecurityEngineResult.get:(Ljava/lang/Object;)Ljava/lang/Object;
     102: checkcast     #72                 // class "[B"
     105: checkcast     #72                 // class "[B"
     108: astore        8
     110: aload_2
     111: aload         8
     113: invokestatic  #73                 // Method java/util/Arrays.equals:([B[B)Z
     116: ifeq          132
     119: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     122: getstatic     #18                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     125: ldc           #74                 // String Verification of the proof of possession of the key associated with the security context successful.
     127: invokevirtual #20                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;)V
     130: iconst_1
     131: ireturn
     132: goto          73
     135: iconst_0
     136: ireturn

  private boolean matchStreamingSignatureSecret(javax.xml.ws.handler.MessageContext, byte[]) throws org.apache.xml.security.exceptions.XMLSecurityException;
    Code:
       0: aload_1
       1: new           #30                 // class java/lang/StringBuilder
       4: dup
       5: invokespecial #31                 // Method java/lang/StringBuilder."<init>":()V
       8: ldc_w         #75                 // class org/apache/xml/security/stax/securityEvent/SecurityEvent
      11: invokevirtual #76                 // Method java/lang/Class.getName:()Ljava/lang/String;
      14: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      17: ldc           #77                 // String .in
      19: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      22: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      25: invokeinterface #57,  2           // InterfaceMethod javax/xml/ws/handler/MessageContext.get:(Ljava/lang/Object;)Ljava/lang/Object;
      30: checkcast     #58                 // class java/util/List
      33: astore_3
      34: aload_3
      35: ifnull        219
      38: aload_3
      39: invokeinterface #66,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      44: astore        4
      46: aload         4
      48: invokeinterface #67,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      53: ifeq          219
      56: aload         4
      58: invokeinterface #68,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      63: checkcast     #75                 // class org/apache/xml/security/stax/securityEvent/SecurityEvent
      66: astore        5
      68: getstatic     #78                 // Field org/apache/wss4j/stax/securityEvent/WSSecurityEventConstants.SignedPart:Lorg/apache/xml/security/stax/securityEvent/SecurityEventConstants$Event;
      71: aload         5
      73: invokevirtual #79                 // Method org/apache/xml/security/stax/securityEvent/SecurityEvent.getSecurityEventType:()Lorg/apache/xml/security/stax/securityEvent/SecurityEventConstants$Event;
      76: if_acmpeq     90
      79: getstatic     #80                 // Field org/apache/wss4j/stax/securityEvent/WSSecurityEventConstants.SignedElement:Lorg/apache/xml/security/stax/securityEvent/SecurityEventConstants$Event;
      82: aload         5
      84: invokevirtual #79                 // Method org/apache/xml/security/stax/securityEvent/SecurityEvent.getSecurityEventType:()Lorg/apache/xml/security/stax/securityEvent/SecurityEventConstants$Event;
      87: if_acmpne     216
      90: aload         5
      92: checkcast     #81                 // class org/apache/xml/security/stax/securityEvent/AbstractSecuredElementSecurityEvent
      95: invokevirtual #82                 // Method org/apache/xml/security/stax/securityEvent/AbstractSecuredElementSecurityEvent.getSecurityToken:()Lorg/apache/xml/security/stax/securityToken/SecurityToken;
      98: astore        6
     100: aload         6
     102: ifnull        216
     105: aload         6
     107: invokeinterface #83,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityToken.getSecretKey:()Ljava/util/Map;
     112: ifnull        216
     115: aload         6
     117: invokeinterface #83,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityToken.getSecretKey:()Ljava/util/Map;
     122: invokeinterface #84,  1           // InterfaceMethod java/util/Map.keySet:()Ljava/util/Set;
     127: invokeinterface #85,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     132: astore        7
     134: aload         7
     136: invokeinterface #67,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     141: ifeq          216
     144: aload         7
     146: invokeinterface #68,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     151: checkcast     #86                 // class java/lang/String
     154: astore        8
     156: aload         6
     158: invokeinterface #83,  1           // InterfaceMethod org/apache/xml/security/stax/securityToken/SecurityToken.getSecretKey:()Ljava/util/Map;
     163: aload         8
     165: invokeinterface #65,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     170: checkcast     #87                 // class java/security/Key
     173: astore        9
     175: aload         9
     177: instanceof    #88                 // class javax/crypto/SecretKey
     180: ifeq          213
     183: aload_2
     184: aload         9
     186: checkcast     #88                 // class javax/crypto/SecretKey
     189: invokeinterface #89,  1           // InterfaceMethod javax/crypto/SecretKey.getEncoded:()[B
     194: invokestatic  #73                 // Method java/util/Arrays.equals:([B[B)Z
     197: ifeq          213
     200: getstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
     203: getstatic     #18                 // Field java/util/logging/Level.FINE:Ljava/util/logging/Level;
     206: ldc           #74                 // String Verification of the proof of possession of the key associated with the security context successful.
     208: invokevirtual #20                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;)V
     211: iconst_1
     212: ireturn
     213: goto          134
     216: goto          46
     219: iconst_0
     220: ireturn

  static {};
    Code:
       0: ldc_w         #90                 // class org/apache/cxf/sts/token/canceller/SCTCanceller
       3: invokestatic  #91                 // Method org/apache/cxf/common/logging/LogUtils.getL7dLogger:(Ljava/lang/Class;)Ljava/util/logging/Logger;
       6: putstatic     #11                 // Field LOG:Ljava/util/logging/Logger;
       9: return
}
