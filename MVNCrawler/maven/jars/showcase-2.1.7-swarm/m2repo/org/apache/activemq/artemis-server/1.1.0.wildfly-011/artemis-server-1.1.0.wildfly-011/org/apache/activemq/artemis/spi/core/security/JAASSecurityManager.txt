Compiled from "JAASSecurityManager.java"
public class org.apache.activemq.artemis.spi.core.security.JAASSecurityManager implements org.apache.activemq.artemis.spi.core.security.ActiveMQSecurityManager {
  private final boolean trace;

  private java.lang.String configurationName;

  private javax.security.auth.callback.CallbackHandler callbackHandler;

  private javax.security.auth.login.Configuration config;

  public org.apache.activemq.artemis.spi.core.security.JAASSecurityManager();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: getstatic     #2                  // Field org/apache/activemq/artemis/core/server/ActiveMQServerLogger.LOGGER:Lorg/apache/activemq/artemis/core/server/ActiveMQServerLogger;
       8: invokeinterface #3,  1            // InterfaceMethod org/apache/activemq/artemis/core/server/ActiveMQServerLogger.isTraceEnabled:()Z
      13: putfield      #4                  // Field trace:Z
      16: return

  public boolean validateUser(java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #5                  // Method getAuthenticatedSubject:(Ljava/lang/String;Ljava/lang/String;)Ljavax/security/auth/Subject;
       6: pop
       7: iconst_1
       8: ireturn
       9: astore_3
      10: iconst_0
      11: ireturn
    Exception table:
       from    to  target type
           0     8     9   Class javax/security/auth/login/LoginException

  public boolean validateUserAndRole(java.lang.String, java.lang.String, java.util.Set<org.apache.activemq.artemis.core.security.Role>, org.apache.activemq.artemis.core.security.CheckType);
    Code:
       0: aconst_null
       1: astore        5
       3: aload_0
       4: aload_1
       5: aload_2
       6: invokespecial #5                  // Method getAuthenticatedSubject:(Ljava/lang/String;Ljava/lang/String;)Ljavax/security/auth/Subject;
       9: astore        5
      11: goto          18
      14: astore        6
      16: iconst_0
      17: ireturn
      18: iconst_1
      19: istore        6
      21: aload         5
      23: ifnull        159
      26: aload_0
      27: aload         4
      29: aload_3
      30: invokespecial #7                  // Method getRolePrincipals:(Lorg/apache/activemq/artemis/core/security/CheckType;Ljava/util/Set;)Ljava/util/Set;
      33: astore        7
      35: iconst_0
      36: istore        8
      38: aload_0
      39: aload         5
      41: invokespecial #8                  // Method getSubjectRoles:(Ljavax/security/auth/Subject;)Ljava/security/acl/Group;
      44: astore        9
      46: aload         9
      48: ifnull        101
      51: aload         7
      53: invokeinterface #9,  1            // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      58: astore        10
      60: iload         8
      62: ifne          101
      65: aload         10
      67: invokeinterface #10,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      72: ifeq          101
      75: aload         10
      77: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      82: checkcast     #12                 // class java/security/Principal
      85: astore        11
      87: aload         9
      89: aload         11
      91: invokeinterface #13,  2           // InterfaceMethod java/security/acl/Group.isMember:(Ljava/security/Principal;)Z
      96: istore        8
      98: goto          60
     101: iload         8
     103: istore        6
     105: aload_0
     106: getfield      #4                  // Field trace:Z
     109: ifeq          159
     112: getstatic     #2                  // Field org/apache/activemq/artemis/core/server/ActiveMQServerLogger.LOGGER:Lorg/apache/activemq/artemis/core/server/ActiveMQServerLogger;
     115: new           #14                 // class java/lang/StringBuilder
     118: dup
     119: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
     122: ldc           #16                 // String user
     124: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     127: aload_1
     128: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     131: iload         6
     133: ifeq          141
     136: ldc           #18                 // String  is
     138: goto          143
     141: ldc           #19                 // String  is NOT
     143: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     146: ldc           #20                 // String authorized
     148: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     151: invokevirtual #21                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     154: invokeinterface #22,  2           // InterfaceMethod org/apache/activemq/artemis/core/server/ActiveMQServerLogger.trace:(Ljava/lang/Object;)V
     159: iload         6
     161: ireturn
    Exception table:
       from    to  target type
           3    11    14   Class javax/security/auth/login/LoginException

  private javax.security.auth.Subject getAuthenticatedSubject(java.lang.String, java.lang.String) throws javax.security.auth.login.LoginException;
    Code:
       0: aload_1
       1: ifnonnull     8
       4: aconst_null
       5: goto          16
       8: new           #23                 // class org/apache/activemq/artemis/spi/core/security/JAASSecurityManager$SimplePrincipal
      11: dup
      12: aload_1
      13: invokespecial #24                 // Method org/apache/activemq/artemis/spi/core/security/JAASSecurityManager$SimplePrincipal."<init>":(Ljava/lang/String;)V
      16: astore_3
      17: aconst_null
      18: astore        4
      20: aload_2
      21: ifnull        30
      24: aload_2
      25: invokevirtual #25                 // Method java/lang/String.toCharArray:()[C
      28: astore        4
      30: new           #26                 // class javax/security/auth/Subject
      33: dup
      34: invokespecial #27                 // Method javax/security/auth/Subject."<init>":()V
      37: astore        5
      39: aload_1
      40: ifnull        55
      43: aload         5
      45: invokevirtual #28                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      48: aload_3
      49: invokeinterface #29,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      54: pop
      55: aload         5
      57: invokevirtual #30                 // Method javax/security/auth/Subject.getPrivateCredentials:()Ljava/util/Set;
      60: aload         4
      62: invokeinterface #29,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      67: pop
      68: new           #31                 // class javax/security/auth/login/LoginContext
      71: dup
      72: aload_0
      73: getfield      #32                 // Field configurationName:Ljava/lang/String;
      76: aload         5
      78: aload_0
      79: getfield      #33                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      82: aload_0
      83: getfield      #34                 // Field config:Ljavax/security/auth/login/Configuration;
      86: invokespecial #35                 // Method javax/security/auth/login/LoginContext."<init>":(Ljava/lang/String;Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;Ljavax/security/auth/login/Configuration;)V
      89: astore        6
      91: aload         6
      93: invokevirtual #36                 // Method javax/security/auth/login/LoginContext.login:()V
      96: aload         6
      98: invokevirtual #37                 // Method javax/security/auth/login/LoginContext.getSubject:()Ljavax/security/auth/Subject;
     101: areturn

  private java.security.acl.Group getSubjectRoles(javax.security.auth.Subject);
    Code:
       0: aload_1
       1: ldc           #38                 // class java/security/acl/Group
       3: invokevirtual #39                 // Method javax/security/auth/Subject.getPrincipals:(Ljava/lang/Class;)Ljava/util/Set;
       6: astore_2
       7: aload_2
       8: invokeinterface #9,  1            // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      13: astore_3
      14: aconst_null
      15: astore        4
      17: aload_3
      18: invokeinterface #10,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      23: ifeq          63
      26: aload_3
      27: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      32: checkcast     #38                 // class java/security/acl/Group
      35: astore        5
      37: aload         5
      39: invokeinterface #40,  1           // InterfaceMethod java/security/acl/Group.getName:()Ljava/lang/String;
      44: astore        6
      46: aload         6
      48: ldc           #41                 // String Roles
      50: invokevirtual #42                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      53: ifeq          60
      56: aload         5
      58: astore        4
      60: goto          17
      63: aload         4
      65: areturn

  private java.util.Set<java.security.Principal> getRolePrincipals(org.apache.activemq.artemis.core.security.CheckType, java.util.Set<org.apache.activemq.artemis.core.security.Role>);
    Code:
       0: new           #43                 // class java/util/HashSet
       3: dup
       4: invokespecial #44                 // Method java/util/HashSet."<init>":()V
       7: astore_3
       8: aload_2
       9: invokeinterface #9,  1            // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      14: astore        4
      16: aload         4
      18: invokeinterface #10,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      23: ifeq          69
      26: aload         4
      28: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      33: checkcast     #45                 // class org/apache/activemq/artemis/core/security/Role
      36: astore        5
      38: aload_1
      39: aload         5
      41: invokevirtual #46                 // Method org/apache/activemq/artemis/core/security/CheckType.hasRole:(Lorg/apache/activemq/artemis/core/security/Role;)Z
      44: ifeq          66
      47: aload_3
      48: new           #23                 // class org/apache/activemq/artemis/spi/core/security/JAASSecurityManager$SimplePrincipal
      51: dup
      52: aload         5
      54: invokevirtual #47                 // Method org/apache/activemq/artemis/core/security/Role.getName:()Ljava/lang/String;
      57: invokespecial #24                 // Method org/apache/activemq/artemis/spi/core/security/JAASSecurityManager$SimplePrincipal."<init>":(Ljava/lang/String;)V
      60: invokeinterface #29,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      65: pop
      66: goto          16
      69: aload_3
      70: areturn

  public void setConfigurationName(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #32                 // Field configurationName:Ljava/lang/String;
       5: return

  public void setCallbackHandler(javax.security.auth.callback.CallbackHandler);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #33                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
       5: return

  public void setConfiguration(javax.security.auth.login.Configuration);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #34                 // Field config:Ljavax/security/auth/login/Configuration;
       5: return
}
