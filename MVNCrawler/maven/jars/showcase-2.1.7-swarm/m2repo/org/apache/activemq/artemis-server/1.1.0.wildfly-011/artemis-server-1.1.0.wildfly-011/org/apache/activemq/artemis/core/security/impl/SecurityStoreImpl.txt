Compiled from "SecurityStoreImpl.java"
public class org.apache.activemq.artemis.core.security.impl.SecurityStoreImpl implements org.apache.activemq.artemis.core.security.SecurityStore,org.apache.activemq.artemis.core.settings.HierarchicalRepositoryChangeListener {
  private final boolean trace;

  private final org.apache.activemq.artemis.core.settings.HierarchicalRepository<java.util.Set<org.apache.activemq.artemis.core.security.Role>> securityRepository;

  private final org.apache.activemq.artemis.spi.core.security.ActiveMQSecurityManager securityManager;

  private final java.util.concurrent.ConcurrentMap<java.lang.String, org.apache.activemq.artemis.utils.ConcurrentHashSet<org.apache.activemq.artemis.api.core.SimpleString>> cache;

  private final long invalidationInterval;

  private volatile long lastCheck;

  private final boolean securityEnabled;

  private final java.lang.String managementClusterUser;

  private final java.lang.String managementClusterPassword;

  private final org.apache.activemq.artemis.core.server.management.NotificationService notificationService;

  public org.apache.activemq.artemis.core.security.impl.SecurityStoreImpl(org.apache.activemq.artemis.core.settings.HierarchicalRepository<java.util.Set<org.apache.activemq.artemis.core.security.Role>>, org.apache.activemq.artemis.spi.core.security.ActiveMQSecurityManager, long, boolean, java.lang.String, java.lang.String, org.apache.activemq.artemis.core.server.management.NotificationService);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: getstatic     #2                  // Field org/apache/activemq/artemis/core/server/ActiveMQServerLogger.LOGGER:Lorg/apache/activemq/artemis/core/server/ActiveMQServerLogger;
       8: invokeinterface #3,  1            // InterfaceMethod org/apache/activemq/artemis/core/server/ActiveMQServerLogger.isTraceEnabled:()Z
      13: putfield      #4                  // Field trace:Z
      16: aload_0
      17: new           #5                  // class java/util/concurrent/ConcurrentHashMap
      20: dup
      21: invokespecial #6                  // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      24: putfield      #7                  // Field cache:Ljava/util/concurrent/ConcurrentMap;
      27: aload_0
      28: aload_1
      29: putfield      #8                  // Field securityRepository:Lorg/apache/activemq/artemis/core/settings/HierarchicalRepository;
      32: aload_0
      33: aload_2
      34: putfield      #9                  // Field securityManager:Lorg/apache/activemq/artemis/spi/core/security/ActiveMQSecurityManager;
      37: aload_0
      38: lload_3
      39: putfield      #10                 // Field invalidationInterval:J
      42: aload_0
      43: iload         5
      45: putfield      #11                 // Field securityEnabled:Z
      48: aload_0
      49: aload         6
      51: putfield      #12                 // Field managementClusterUser:Ljava/lang/String;
      54: aload_0
      55: aload         7
      57: putfield      #13                 // Field managementClusterPassword:Ljava/lang/String;
      60: aload_0
      61: aload         8
      63: putfield      #14                 // Field notificationService:Lorg/apache/activemq/artemis/core/server/management/NotificationService;
      66: aload_0
      67: getfield      #8                  // Field securityRepository:Lorg/apache/activemq/artemis/core/settings/HierarchicalRepository;
      70: aload_0
      71: invokeinterface #15,  2           // InterfaceMethod org/apache/activemq/artemis/core/settings/HierarchicalRepository.registerListener:(Lorg/apache/activemq/artemis/core/settings/HierarchicalRepositoryChangeListener;)V
      76: return

  public boolean isSecurityEnabled();
    Code:
       0: aload_0
       1: getfield      #11                 // Field securityEnabled:Z
       4: ireturn

  public void stop();
    Code:
       0: aload_0
       1: getfield      #8                  // Field securityRepository:Lorg/apache/activemq/artemis/core/settings/HierarchicalRepository;
       4: aload_0
       5: invokeinterface #16,  2           // InterfaceMethod org/apache/activemq/artemis/core/settings/HierarchicalRepository.unRegisterListener:(Lorg/apache/activemq/artemis/core/settings/HierarchicalRepositoryChangeListener;)V
      10: return

  public void authenticate(java.lang.String, java.lang.String) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #11                 // Field securityEnabled:Z
       4: ifeq          132
       7: aload_0
       8: getfield      #12                 // Field managementClusterUser:Ljava/lang/String;
      11: aload_1
      12: invokevirtual #17                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      15: ifeq          57
      18: aload_0
      19: getfield      #4                  // Field trace:Z
      22: ifeq          35
      25: getstatic     #2                  // Field org/apache/activemq/artemis/core/server/ActiveMQServerLogger.LOGGER:Lorg/apache/activemq/artemis/core/server/ActiveMQServerLogger;
      28: ldc           #18                 // String Authenticating cluster admin user
      30: invokeinterface #19,  2           // InterfaceMethod org/apache/activemq/artemis/core/server/ActiveMQServerLogger.trace:(Ljava/lang/Object;)V
      35: aload_0
      36: getfield      #13                 // Field managementClusterPassword:Ljava/lang/String;
      39: aload_2
      40: invokevirtual #17                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      43: ifne          56
      46: getstatic     #20                 // Field org/apache/activemq/artemis/core/server/ActiveMQMessageBundle.BUNDLE:Lorg/apache/activemq/artemis/core/server/ActiveMQMessageBundle;
      49: aload_1
      50: invokeinterface #21,  2           // InterfaceMethod org/apache/activemq/artemis/core/server/ActiveMQMessageBundle.unableToValidateClusterUser:(Ljava/lang/String;)Lorg/apache/activemq/artemis/api/core/ActiveMQClusterSecurityException;
      55: athrow
      56: return
      57: aload_0
      58: getfield      #9                  // Field securityManager:Lorg/apache/activemq/artemis/spi/core/security/ActiveMQSecurityManager;
      61: aload_1
      62: aload_2
      63: invokeinterface #22,  3           // InterfaceMethod org/apache/activemq/artemis/spi/core/security/ActiveMQSecurityManager.validateUser:(Ljava/lang/String;Ljava/lang/String;)Z
      68: ifne          132
      71: aload_0
      72: getfield      #14                 // Field notificationService:Lorg/apache/activemq/artemis/core/server/management/NotificationService;
      75: ifnull        122
      78: new           #23                 // class org/apache/activemq/artemis/utils/TypedProperties
      81: dup
      82: invokespecial #24                 // Method org/apache/activemq/artemis/utils/TypedProperties."<init>":()V
      85: astore_3
      86: aload_3
      87: getstatic     #25                 // Field org/apache/activemq/artemis/api/core/management/ManagementHelper.HDR_USER:Lorg/apache/activemq/artemis/api/core/SimpleString;
      90: aload_1
      91: invokestatic  #26                 // Method org/apache/activemq/artemis/api/core/SimpleString.toSimpleString:(Ljava/lang/String;)Lorg/apache/activemq/artemis/api/core/SimpleString;
      94: invokevirtual #27                 // Method org/apache/activemq/artemis/utils/TypedProperties.putSimpleStringProperty:(Lorg/apache/activemq/artemis/api/core/SimpleString;Lorg/apache/activemq/artemis/api/core/SimpleString;)V
      97: new           #28                 // class org/apache/activemq/artemis/core/server/management/Notification
     100: dup
     101: aconst_null
     102: getstatic     #29                 // Field org/apache/activemq/artemis/api/core/management/CoreNotificationType.SECURITY_AUTHENTICATION_VIOLATION:Lorg/apache/activemq/artemis/api/core/management/CoreNotificationType;
     105: aload_3
     106: invokespecial #30                 // Method org/apache/activemq/artemis/core/server/management/Notification."<init>":(Ljava/lang/String;Lorg/apache/activemq/artemis/api/core/management/NotificationType;Lorg/apache/activemq/artemis/utils/TypedProperties;)V
     109: astore        4
     111: aload_0
     112: getfield      #14                 // Field notificationService:Lorg/apache/activemq/artemis/core/server/management/NotificationService;
     115: aload         4
     117: invokeinterface #31,  2           // InterfaceMethod org/apache/activemq/artemis/core/server/management/NotificationService.sendNotification:(Lorg/apache/activemq/artemis/core/server/management/Notification;)V
     122: getstatic     #20                 // Field org/apache/activemq/artemis/core/server/ActiveMQMessageBundle.BUNDLE:Lorg/apache/activemq/artemis/core/server/ActiveMQMessageBundle;
     125: aload_1
     126: invokeinterface #32,  2           // InterfaceMethod org/apache/activemq/artemis/core/server/ActiveMQMessageBundle.unableToValidateUser:(Ljava/lang/String;)Lorg/apache/activemq/artemis/api/core/ActiveMQSecurityException;
     131: athrow
     132: return

  public void check(org.apache.activemq.artemis.api.core.SimpleString, org.apache.activemq.artemis.core.security.CheckType, org.apache.activemq.artemis.core.security.SecurityAuth) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #11                 // Field securityEnabled:Z
       4: ifeq          304
       7: aload_0
       8: getfield      #4                  // Field trace:Z
      11: ifeq          41
      14: getstatic     #2                  // Field org/apache/activemq/artemis/core/server/ActiveMQServerLogger.LOGGER:Lorg/apache/activemq/artemis/core/server/ActiveMQServerLogger;
      17: new           #33                 // class java/lang/StringBuilder
      20: dup
      21: invokespecial #34                 // Method java/lang/StringBuilder."<init>":()V
      24: ldc           #35                 // String checking access permissions to
      26: invokevirtual #36                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      29: aload_1
      30: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      33: invokevirtual #38                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      36: invokeinterface #19,  2           // InterfaceMethod org/apache/activemq/artemis/core/server/ActiveMQServerLogger.trace:(Ljava/lang/Object;)V
      41: aload_3
      42: invokeinterface #39,  1           // InterfaceMethod org/apache/activemq/artemis/core/security/SecurityAuth.getUsername:()Ljava/lang/String;
      47: astore        4
      49: aload_0
      50: aload_1
      51: aload         4
      53: aload_2
      54: invokespecial #40                 // Method checkCached:(Lorg/apache/activemq/artemis/api/core/SimpleString;Ljava/lang/String;Lorg/apache/activemq/artemis/core/security/CheckType;)Z
      57: ifeq          61
      60: return
      61: aload_1
      62: invokevirtual #41                 // Method org/apache/activemq/artemis/api/core/SimpleString.toString:()Ljava/lang/String;
      65: astore        5
      67: aload_0
      68: getfield      #8                  // Field securityRepository:Lorg/apache/activemq/artemis/core/settings/HierarchicalRepository;
      71: aload         5
      73: invokeinterface #42,  2           // InterfaceMethod org/apache/activemq/artemis/core/settings/HierarchicalRepository.getMatch:(Ljava/lang/String;)Ljava/lang/Object;
      78: checkcast     #43                 // class java/util/Set
      81: astore        6
      83: aload_0
      84: getfield      #12                 // Field managementClusterUser:Ljava/lang/String;
      87: aload         4
      89: invokevirtual #17                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      92: ifeq          112
      95: aload_3
      96: invokeinterface #44,  1           // InterfaceMethod org/apache/activemq/artemis/core/security/SecurityAuth.getPassword:()Ljava/lang/String;
     101: aload_0
     102: getfield      #13                 // Field managementClusterPassword:Ljava/lang/String;
     105: invokevirtual #17                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     108: ifeq          112
     111: return
     112: aload_0
     113: getfield      #9                  // Field securityManager:Lorg/apache/activemq/artemis/spi/core/security/ActiveMQSecurityManager;
     116: aload         4
     118: aload_3
     119: invokeinterface #44,  1           // InterfaceMethod org/apache/activemq/artemis/core/security/SecurityAuth.getPassword:()Ljava/lang/String;
     124: aload         6
     126: aload_2
     127: invokeinterface #45,  5           // InterfaceMethod org/apache/activemq/artemis/spi/core/security/ActiveMQSecurityManager.validateUserAndRole:(Ljava/lang/String;Ljava/lang/String;Ljava/util/Set;Lorg/apache/activemq/artemis/core/security/CheckType;)Z
     132: ifne          236
     135: aload_0
     136: getfield      #14                 // Field notificationService:Lorg/apache/activemq/artemis/core/server/management/NotificationService;
     139: ifnull        218
     142: new           #23                 // class org/apache/activemq/artemis/utils/TypedProperties
     145: dup
     146: invokespecial #24                 // Method org/apache/activemq/artemis/utils/TypedProperties."<init>":()V
     149: astore        7
     151: aload         7
     153: getstatic     #46                 // Field org/apache/activemq/artemis/api/core/management/ManagementHelper.HDR_ADDRESS:Lorg/apache/activemq/artemis/api/core/SimpleString;
     156: aload_1
     157: invokevirtual #27                 // Method org/apache/activemq/artemis/utils/TypedProperties.putSimpleStringProperty:(Lorg/apache/activemq/artemis/api/core/SimpleString;Lorg/apache/activemq/artemis/api/core/SimpleString;)V
     160: aload         7
     162: getstatic     #47                 // Field org/apache/activemq/artemis/api/core/management/ManagementHelper.HDR_CHECK_TYPE:Lorg/apache/activemq/artemis/api/core/SimpleString;
     165: new           #48                 // class org/apache/activemq/artemis/api/core/SimpleString
     168: dup
     169: aload_2
     170: invokevirtual #49                 // Method org/apache/activemq/artemis/core/security/CheckType.toString:()Ljava/lang/String;
     173: invokespecial #50                 // Method org/apache/activemq/artemis/api/core/SimpleString."<init>":(Ljava/lang/String;)V
     176: invokevirtual #27                 // Method org/apache/activemq/artemis/utils/TypedProperties.putSimpleStringProperty:(Lorg/apache/activemq/artemis/api/core/SimpleString;Lorg/apache/activemq/artemis/api/core/SimpleString;)V
     179: aload         7
     181: getstatic     #25                 // Field org/apache/activemq/artemis/api/core/management/ManagementHelper.HDR_USER:Lorg/apache/activemq/artemis/api/core/SimpleString;
     184: aload         4
     186: invokestatic  #26                 // Method org/apache/activemq/artemis/api/core/SimpleString.toSimpleString:(Ljava/lang/String;)Lorg/apache/activemq/artemis/api/core/SimpleString;
     189: invokevirtual #27                 // Method org/apache/activemq/artemis/utils/TypedProperties.putSimpleStringProperty:(Lorg/apache/activemq/artemis/api/core/SimpleString;Lorg/apache/activemq/artemis/api/core/SimpleString;)V
     192: new           #28                 // class org/apache/activemq/artemis/core/server/management/Notification
     195: dup
     196: aconst_null
     197: getstatic     #51                 // Field org/apache/activemq/artemis/api/core/management/CoreNotificationType.SECURITY_PERMISSION_VIOLATION:Lorg/apache/activemq/artemis/api/core/management/CoreNotificationType;
     200: aload         7
     202: invokespecial #30                 // Method org/apache/activemq/artemis/core/server/management/Notification."<init>":(Ljava/lang/String;Lorg/apache/activemq/artemis/api/core/management/NotificationType;Lorg/apache/activemq/artemis/utils/TypedProperties;)V
     205: astore        8
     207: aload_0
     208: getfield      #14                 // Field notificationService:Lorg/apache/activemq/artemis/core/server/management/NotificationService;
     211: aload         8
     213: invokeinterface #31,  2           // InterfaceMethod org/apache/activemq/artemis/core/server/management/NotificationService.sendNotification:(Lorg/apache/activemq/artemis/core/server/management/Notification;)V
     218: getstatic     #20                 // Field org/apache/activemq/artemis/core/server/ActiveMQMessageBundle.BUNDLE:Lorg/apache/activemq/artemis/core/server/ActiveMQMessageBundle;
     221: aload_3
     222: invokeinterface #39,  1           // InterfaceMethod org/apache/activemq/artemis/core/security/SecurityAuth.getUsername:()Ljava/lang/String;
     227: aload_2
     228: aload         5
     230: invokeinterface #52,  4           // InterfaceMethod org/apache/activemq/artemis/core/server/ActiveMQMessageBundle.userNoPermissions:(Ljava/lang/String;Lorg/apache/activemq/artemis/core/security/CheckType;Ljava/lang/String;)Lorg/apache/activemq/artemis/api/core/ActiveMQSecurityException;
     235: athrow
     236: new           #53                 // class org/apache/activemq/artemis/utils/ConcurrentHashSet
     239: dup
     240: invokespecial #54                 // Method org/apache/activemq/artemis/utils/ConcurrentHashSet."<init>":()V
     243: astore        7
     245: aload_0
     246: getfield      #7                  // Field cache:Ljava/util/concurrent/ConcurrentMap;
     249: new           #33                 // class java/lang/StringBuilder
     252: dup
     253: invokespecial #34                 // Method java/lang/StringBuilder."<init>":()V
     256: aload         4
     258: invokevirtual #36                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     261: ldc           #55                 // String .
     263: invokevirtual #36                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     266: aload_2
     267: invokevirtual #56                 // Method org/apache/activemq/artemis/core/security/CheckType.name:()Ljava/lang/String;
     270: invokevirtual #36                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     273: invokevirtual #38                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     276: aload         7
     278: invokeinterface #57,  3           // InterfaceMethod java/util/concurrent/ConcurrentMap.putIfAbsent:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     283: checkcast     #53                 // class org/apache/activemq/artemis/utils/ConcurrentHashSet
     286: astore        8
     288: aload         8
     290: ifnull        297
     293: aload         8
     295: astore        7
     297: aload         7
     299: aload_1
     300: invokevirtual #58                 // Method org/apache/activemq/artemis/utils/ConcurrentHashSet.add:(Ljava/lang/Object;)Z
     303: pop
     304: return

  public void onChange();
    Code:
       0: aload_0
       1: invokespecial #59                 // Method invalidateCache:()V
       4: return

  private void invalidateCache();
    Code:
       0: aload_0
       1: getfield      #7                  // Field cache:Ljava/util/concurrent/ConcurrentMap;
       4: invokeinterface #60,  1           // InterfaceMethod java/util/concurrent/ConcurrentMap.clear:()V
       9: return

  private boolean checkCached(org.apache.activemq.artemis.api.core.SimpleString, java.lang.String, org.apache.activemq.artemis.core.security.CheckType);
    Code:
       0: invokestatic  #61                 // Method java/lang/System.currentTimeMillis:()J
       3: lstore        4
       5: iconst_0
       6: istore        6
       8: lload         4
      10: aload_0
      11: getfield      #62                 // Field lastCheck:J
      14: lsub
      15: aload_0
      16: getfield      #10                 // Field invalidationInterval:J
      19: lcmp
      20: ifle          36
      23: aload_0
      24: invokespecial #59                 // Method invalidateCache:()V
      27: aload_0
      28: lload         4
      30: putfield      #62                 // Field lastCheck:J
      33: goto          89
      36: aload_0
      37: getfield      #7                  // Field cache:Ljava/util/concurrent/ConcurrentMap;
      40: new           #33                 // class java/lang/StringBuilder
      43: dup
      44: invokespecial #34                 // Method java/lang/StringBuilder."<init>":()V
      47: aload_2
      48: invokevirtual #36                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      51: ldc           #55                 // String .
      53: invokevirtual #36                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      56: aload_3
      57: invokevirtual #56                 // Method org/apache/activemq/artemis/core/security/CheckType.name:()Ljava/lang/String;
      60: invokevirtual #36                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      63: invokevirtual #38                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      66: invokeinterface #63,  2           // InterfaceMethod java/util/concurrent/ConcurrentMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
      71: checkcast     #53                 // class org/apache/activemq/artemis/utils/ConcurrentHashSet
      74: astore        7
      76: aload         7
      78: ifnull        89
      81: aload         7
      83: aload_1
      84: invokevirtual #64                 // Method org/apache/activemq/artemis/utils/ConcurrentHashSet.contains:(Ljava/lang/Object;)Z
      87: istore        6
      89: iload         6
      91: ireturn
}
