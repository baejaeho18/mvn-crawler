Compiled from "AuthorizationInterceptor.java"
public class org.jboss.as.ejb3.security.AuthorizationInterceptor implements org.jboss.invocation.Interceptor {
  private final org.jboss.as.ejb3.security.EJBMethodSecurityAttribute ejbMethodSecurityMetaData;

  private final java.lang.String viewClassName;

  private final java.lang.reflect.Method viewMethod;

  private final java.lang.String contextID;

  public org.jboss.as.ejb3.security.AuthorizationInterceptor(org.jboss.as.ejb3.security.EJBMethodSecurityAttribute, java.lang.String, java.lang.reflect.Method, java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #3                  // Method java/lang/Object."<init>":()V
       4: aload_1
       5: ifnonnull     17
       8: getstatic     #4                  // Field org/jboss/as/ejb3/logging/EjbLogger.ROOT_LOGGER:Lorg/jboss/as/ejb3/logging/EjbLogger;
      11: invokeinterface #5,  1            // InterfaceMethod org/jboss/as/ejb3/logging/EjbLogger.ejbMethodSecurityMetaDataIsNull:()Ljava/lang/IllegalArgumentException;
      16: athrow
      17: aload_2
      18: ifnull        31
      21: aload_2
      22: invokevirtual #6                  // Method java/lang/String.trim:()Ljava/lang/String;
      25: invokevirtual #7                  // Method java/lang/String.isEmpty:()Z
      28: ifeq          40
      31: getstatic     #4                  // Field org/jboss/as/ejb3/logging/EjbLogger.ROOT_LOGGER:Lorg/jboss/as/ejb3/logging/EjbLogger;
      34: invokeinterface #8,  1            // InterfaceMethod org/jboss/as/ejb3/logging/EjbLogger.viewClassNameIsNull:()Ljava/lang/IllegalArgumentException;
      39: athrow
      40: aload_3
      41: ifnonnull     53
      44: getstatic     #4                  // Field org/jboss/as/ejb3/logging/EjbLogger.ROOT_LOGGER:Lorg/jboss/as/ejb3/logging/EjbLogger;
      47: invokeinterface #9,  1            // InterfaceMethod org/jboss/as/ejb3/logging/EjbLogger.viewMethodIsNull:()Ljava/lang/IllegalArgumentException;
      52: athrow
      53: aload_0
      54: aload_1
      55: putfield      #10                 // Field ejbMethodSecurityMetaData:Lorg/jboss/as/ejb3/security/EJBMethodSecurityAttribute;
      58: aload_0
      59: aload_2
      60: putfield      #11                 // Field viewClassName:Ljava/lang/String;
      63: aload_0
      64: aload_3
      65: putfield      #2                  // Field viewMethod:Ljava/lang/reflect/Method;
      68: aload_0
      69: aload         4
      71: putfield      #1                  // Field contextID:Ljava/lang/String;
      74: return

  public java.lang.Object processInvocation(org.jboss.invocation.InterceptorContext) throws java.lang.Exception;
    Code:
       0: aload_1
       1: ldc           #12                 // class org/jboss/as/ee/component/Component
       3: invokevirtual #13                 // Method org/jboss/invocation/InterceptorContext.getPrivateData:(Ljava/lang/Class;)Ljava/lang/Object;
       6: checkcast     #12                 // class org/jboss/as/ee/component/Component
       9: astore_2
      10: aload_2
      11: instanceof    #14                 // class org/jboss/as/ejb3/component/EJBComponent
      14: ifne          29
      17: getstatic     #4                  // Field org/jboss/as/ejb3/logging/EjbLogger.ROOT_LOGGER:Lorg/jboss/as/ejb3/logging/EjbLogger;
      20: aload_2
      21: ldc           #14                 // class org/jboss/as/ejb3/component/EJBComponent
      23: invokeinterface #15,  3           // InterfaceMethod org/jboss/as/ejb3/logging/EjbLogger.unexpectedComponent:(Lorg/jboss/as/ee/component/Component;Ljava/lang/Class;)Ljava/lang/IllegalStateException;
      28: athrow
      29: aload_1
      30: invokevirtual #16                 // Method org/jboss/invocation/InterceptorContext.getMethod:()Ljava/lang/reflect/Method;
      33: astore_3
      34: aload_1
      35: ldc           #17                 // class org/jboss/as/ee/component/ComponentView
      37: invokevirtual #13                 // Method org/jboss/invocation/InterceptorContext.getPrivateData:(Ljava/lang/Class;)Ljava/lang/Object;
      40: checkcast     #17                 // class org/jboss/as/ee/component/ComponentView
      43: astore        4
      45: aload         4
      47: invokeinterface #18,  1           // InterfaceMethod org/jboss/as/ee/component/ComponentView.getViewClass:()Ljava/lang/Class;
      52: invokevirtual #19                 // Method java/lang/Class.getName:()Ljava/lang/String;
      55: astore        5
      57: aload_0
      58: getfield      #11                 // Field viewClassName:Ljava/lang/String;
      61: aload         5
      63: invokevirtual #20                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      66: ifeq          80
      69: aload_0
      70: getfield      #2                  // Field viewMethod:Ljava/lang/reflect/Method;
      73: aload_3
      74: invokevirtual #21                 // Method java/lang/reflect/Method.equals:(Ljava/lang/Object;)Z
      77: ifne          107
      80: getstatic     #4                  // Field org/jboss/as/ejb3/logging/EjbLogger.ROOT_LOGGER:Lorg/jboss/as/ejb3/logging/EjbLogger;
      83: aload_0
      84: invokevirtual #22                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      87: invokevirtual #19                 // Method java/lang/Class.getName:()Ljava/lang/String;
      90: aload_3
      91: aload         5
      93: aload_0
      94: getfield      #2                  // Field viewMethod:Ljava/lang/reflect/Method;
      97: aload_0
      98: getfield      #11                 // Field viewClassName:Ljava/lang/String;
     101: invokeinterface #23,  6           // InterfaceMethod org/jboss/as/ejb3/logging/EjbLogger.failProcessInvocation:(Ljava/lang/String;Ljava/lang/reflect/Method;Ljava/lang/String;Ljava/lang/reflect/Method;Ljava/lang/String;)Ljava/lang/IllegalStateException;
     106: athrow
     107: aload_2
     108: checkcast     #14                 // class org/jboss/as/ejb3/component/EJBComponent
     111: astore        6
     113: aload         6
     115: invokevirtual #24                 // Method org/jboss/as/ejb3/component/EJBComponent.getSecurityManager:()Lorg/jboss/as/core/security/ServerSecurityManager;
     118: astore        7
     120: aload_0
     121: aload         4
     123: ldc           #25                 // class org/jboss/as/ejb3/component/MethodIntf
     125: invokeinterface #26,  2           // InterfaceMethod org/jboss/as/ee/component/ComponentView.getPrivateData:(Ljava/lang/Class;)Ljava/lang/Object;
     130: checkcast     #25                 // class org/jboss/as/ejb3/component/MethodIntf
     133: invokevirtual #27                 // Method getMethodInterfaceType:(Lorg/jboss/as/ejb3/component/MethodIntf;)Lorg/jboss/metadata/ejb/spec/MethodInterfaceType;
     136: astore        8
     138: aload_0
     139: aload_0
     140: getfield      #1                  // Field contextID:Ljava/lang/String;
     143: invokevirtual #28                 // Method setContextID:(Ljava/lang/String;)Ljava/lang/String;
     146: astore        9
     148: invokestatic  #29                 // Method org/wildfly/security/manager/WildFlySecurityManager.isChecking:()Z
     151: ifeq          186
     154: new           #30                 // class org/jboss/as/ejb3/security/AuthorizationInterceptor$1
     157: dup
     158: aload_0
     159: aload         7
     161: aload         6
     163: aload         4
     165: aload         8
     167: aload_3
     168: invokespecial #31                 // Method org/jboss/as/ejb3/security/AuthorizationInterceptor$1."<init>":(Lorg/jboss/as/ejb3/security/AuthorizationInterceptor;Lorg/jboss/as/core/security/ServerSecurityManager;Lorg/jboss/as/ejb3/component/EJBComponent;Lorg/jboss/as/ee/component/ComponentView;Lorg/jboss/metadata/ejb/spec/MethodInterfaceType;Ljava/lang/reflect/Method;)V
     171: invokestatic  #32                 // Method java/security/AccessController.doPrivileged:(Ljava/security/PrivilegedExceptionAction;)Ljava/lang/Object;
     174: pop
     175: goto          246
     178: astore        10
     180: aload         10
     182: invokevirtual #34                 // Method java/security/PrivilegedActionException.getException:()Ljava/lang/Exception;
     185: athrow
     186: aload         7
     188: aload         6
     190: invokevirtual #35                 // Method org/jboss/as/ejb3/component/EJBComponent.getComponentName:()Ljava/lang/String;
     193: aload         4
     195: invokeinterface #36,  1           // InterfaceMethod org/jboss/as/ee/component/ComponentView.getProxyClass:()Ljava/lang/Class;
     200: invokevirtual #37                 // Method java/lang/Class.getProtectionDomain:()Ljava/security/ProtectionDomain;
     203: invokevirtual #38                 // Method java/security/ProtectionDomain.getCodeSource:()Ljava/security/CodeSource;
     206: aload         8
     208: invokevirtual #39                 // Method org/jboss/metadata/ejb/spec/MethodInterfaceType.name:()Ljava/lang/String;
     211: aload_0
     212: getfield      #2                  // Field viewMethod:Ljava/lang/reflect/Method;
     215: aload_0
     216: invokevirtual #40                 // Method getMethodRolesAsPrincipals:()Ljava/util/Set;
     219: aload_0
     220: getfield      #1                  // Field contextID:Ljava/lang/String;
     223: invokeinterface #41,  7           // InterfaceMethod org/jboss/as/core/security/ServerSecurityManager.authorize:(Ljava/lang/String;Ljava/security/CodeSource;Ljava/lang/String;Ljava/lang/reflect/Method;Ljava/util/Set;Ljava/lang/String;)Z
     228: ifne          246
     231: getstatic     #4                  // Field org/jboss/as/ejb3/logging/EjbLogger.ROOT_LOGGER:Lorg/jboss/as/ejb3/logging/EjbLogger;
     234: aload_3
     235: aload         6
     237: invokevirtual #35                 // Method org/jboss/as/ejb3/component/EJBComponent.getComponentName:()Ljava/lang/String;
     240: invokeinterface #42,  3           // InterfaceMethod org/jboss/as/ejb3/logging/EjbLogger.invocationOfMethodNotAllowed:(Ljava/lang/reflect/Method;Ljava/lang/String;)Ljavax/ejb/EJBAccessException;
     245: athrow
     246: aload_1
     247: invokevirtual #43                 // Method org/jboss/invocation/InterceptorContext.proceed:()Ljava/lang/Object;
     250: astore        10
     252: aload_0
     253: aload         9
     255: invokevirtual #28                 // Method setContextID:(Ljava/lang/String;)Ljava/lang/String;
     258: pop
     259: aload         10
     261: areturn
     262: astore        11
     264: aload_0
     265: aload         9
     267: invokevirtual #28                 // Method setContextID:(Ljava/lang/String;)Ljava/lang/String;
     270: pop
     271: aload         11
     273: athrow
    Exception table:
       from    to  target type
         154   175   178   Class java/security/PrivilegedActionException
         148   252   262   any
         262   264   262   any

  protected java.util.Set<java.security.Principal> getMethodRolesAsPrincipals();
    Code:
       0: new           #44                 // class java/util/HashSet
       3: dup
       4: invokespecial #45                 // Method java/util/HashSet."<init>":()V
       7: astore_1
       8: aload_0
       9: getfield      #10                 // Field ejbMethodSecurityMetaData:Lorg/jboss/as/ejb3/security/EJBMethodSecurityAttribute;
      12: invokevirtual #46                 // Method org/jboss/as/ejb3/security/EJBMethodSecurityAttribute.isDenyAll:()Z
      15: ifeq          31
      18: aload_1
      19: getstatic     #47                 // Field org/jboss/security/NobodyPrincipal.NOBODY_PRINCIPAL:Lorg/jboss/security/NobodyPrincipal;
      22: invokeinterface #48,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      27: pop
      28: goto          104
      31: aload_0
      32: getfield      #10                 // Field ejbMethodSecurityMetaData:Lorg/jboss/as/ejb3/security/EJBMethodSecurityAttribute;
      35: invokevirtual #49                 // Method org/jboss/as/ejb3/security/EJBMethodSecurityAttribute.isPermitAll:()Z
      38: ifeq          54
      41: aload_1
      42: getstatic     #50                 // Field org/jboss/security/AnybodyPrincipal.ANYBODY_PRINCIPAL:Lorg/jboss/security/AnybodyPrincipal;
      45: invokeinterface #48,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      50: pop
      51: goto          104
      54: aload_0
      55: getfield      #10                 // Field ejbMethodSecurityMetaData:Lorg/jboss/as/ejb3/security/EJBMethodSecurityAttribute;
      58: invokevirtual #51                 // Method org/jboss/as/ejb3/security/EJBMethodSecurityAttribute.getRolesAllowed:()Ljava/util/Set;
      61: invokeinterface #52,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      66: astore_2
      67: aload_2
      68: invokeinterface #53,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      73: ifeq          104
      76: aload_2
      77: invokeinterface #54,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      82: checkcast     #55                 // class java/lang/String
      85: astore_3
      86: aload_1
      87: new           #56                 // class org/jboss/security/SimplePrincipal
      90: dup
      91: aload_3
      92: invokespecial #57                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
      95: invokeinterface #48,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     100: pop
     101: goto          67
     104: aload_1
     105: areturn

  protected org.jboss.metadata.ejb.spec.MethodInterfaceType getMethodInterfaceType(org.jboss.as.ejb3.component.MethodIntf);
    Code:
       0: getstatic     #58                 // Field org/jboss/as/ejb3/security/AuthorizationInterceptor$2.$SwitchMap$org$jboss$as$ejb3$component$MethodIntf:[I
       3: aload_1
       4: invokevirtual #59                 // Method org/jboss/as/ejb3/component/MethodIntf.ordinal:()I
       7: iaload
       8: tableswitch   { // 1 to 7
                     1: 52
                     2: 56
                     3: 60
                     4: 64
                     5: 68
                     6: 72
                     7: 76
               default: 80
          }
      52: getstatic     #60                 // Field org/jboss/metadata/ejb/spec/MethodInterfaceType.Home:Lorg/jboss/metadata/ejb/spec/MethodInterfaceType;
      55: areturn
      56: getstatic     #61                 // Field org/jboss/metadata/ejb/spec/MethodInterfaceType.LocalHome:Lorg/jboss/metadata/ejb/spec/MethodInterfaceType;
      59: areturn
      60: getstatic     #62                 // Field org/jboss/metadata/ejb/spec/MethodInterfaceType.ServiceEndpoint:Lorg/jboss/metadata/ejb/spec/MethodInterfaceType;
      63: areturn
      64: getstatic     #63                 // Field org/jboss/metadata/ejb/spec/MethodInterfaceType.Local:Lorg/jboss/metadata/ejb/spec/MethodInterfaceType;
      67: areturn
      68: getstatic     #64                 // Field org/jboss/metadata/ejb/spec/MethodInterfaceType.Remote:Lorg/jboss/metadata/ejb/spec/MethodInterfaceType;
      71: areturn
      72: getstatic     #65                 // Field org/jboss/metadata/ejb/spec/MethodInterfaceType.Timer:Lorg/jboss/metadata/ejb/spec/MethodInterfaceType;
      75: areturn
      76: getstatic     #66                 // Field org/jboss/metadata/ejb/spec/MethodInterfaceType.MessageEndpoint:Lorg/jboss/metadata/ejb/spec/MethodInterfaceType;
      79: areturn
      80: aconst_null
      81: areturn

  protected java.lang.String setContextID(java.lang.String);
    Code:
       0: invokestatic  #29                 // Method org/wildfly/security/manager/WildFlySecurityManager.isChecking:()Z
       3: ifne          16
       6: invokestatic  #67                 // Method javax/security/jacc/PolicyContext.getContextID:()Ljava/lang/String;
       9: astore_2
      10: aload_1
      11: invokestatic  #68                 // Method javax/security/jacc/PolicyContext.setContextID:(Ljava/lang/String;)V
      14: aload_2
      15: areturn
      16: new           #69                 // class org/jboss/as/ejb3/security/AuthorizationInterceptor$SetContextIDAction
      19: dup
      20: aload_1
      21: invokespecial #70                 // Method org/jboss/as/ejb3/security/AuthorizationInterceptor$SetContextIDAction."<init>":(Ljava/lang/String;)V
      24: astore_2
      25: aload_2
      26: invokestatic  #71                 // Method java/security/AccessController.doPrivileged:(Ljava/security/PrivilegedAction;)Ljava/lang/Object;
      29: checkcast     #55                 // class java/lang/String
      32: areturn

  static java.lang.reflect.Method access$000(org.jboss.as.ejb3.security.AuthorizationInterceptor);
    Code:
       0: aload_0
       1: getfield      #2                  // Field viewMethod:Ljava/lang/reflect/Method;
       4: areturn

  static java.lang.String access$100(org.jboss.as.ejb3.security.AuthorizationInterceptor);
    Code:
       0: aload_0
       1: getfield      #1                  // Field contextID:Ljava/lang/String;
       4: areturn
}
