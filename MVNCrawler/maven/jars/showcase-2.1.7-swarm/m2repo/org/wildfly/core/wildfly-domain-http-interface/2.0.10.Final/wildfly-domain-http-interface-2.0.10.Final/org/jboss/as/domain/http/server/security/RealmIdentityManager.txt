Compiled from "RealmIdentityManager.java"
public class org.jboss.as.domain.http.server.security.RealmIdentityManager implements io.undertow.security.idm.IdentityManager {
  private static final java.lang.ThreadLocal<org.jboss.as.domain.http.server.security.RealmIdentityManager$ThreadLocalStore> requestSpecific;

  private final org.jboss.as.domain.management.SecurityRealm securityRealm;

  static void setRequestSpecific(org.jboss.as.domain.management.AuthMechanism, java.net.InetAddress);
    Code:
       0: new           #2                  // class org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore
       3: dup
       4: aconst_null
       5: invokespecial #3                  // Method org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore."<init>":(Lorg/jboss/as/domain/http/server/security/RealmIdentityManager$1;)V
       8: astore_2
       9: aload_2
      10: aload_0
      11: putfield      #4                  // Field org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore.requestMechanism:Lorg/jboss/as/domain/management/AuthMechanism;
      14: aload_2
      15: aload_1
      16: putfield      #5                  // Field org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore.inetAddress:Ljava/net/InetAddress;
      19: getstatic     #6                  // Field requestSpecific:Ljava/lang/ThreadLocal;
      22: aload_2
      23: invokevirtual #7                  // Method java/lang/ThreadLocal.set:(Ljava/lang/Object;)V
      26: return

  static void clearRequestSpecific();
    Code:
       0: getstatic     #6                  // Field requestSpecific:Ljava/lang/ThreadLocal;
       3: invokevirtual #8                  // Method java/lang/ThreadLocal.get:()Ljava/lang/Object;
       6: checkcast     #2                  // class org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore
       9: astore_0
      10: aload_0
      11: ifnull        30
      14: aload_0
      15: getfield      #9                  // Field org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore.subjectIdentity:Lorg/jboss/as/domain/management/SubjectIdentity;
      18: ifnull        30
      21: aload_0
      22: getfield      #9                  // Field org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore.subjectIdentity:Lorg/jboss/as/domain/management/SubjectIdentity;
      25: invokeinterface #10,  1           // InterfaceMethod org/jboss/as/domain/management/SubjectIdentity.logout:()V
      30: getstatic     #6                  // Field requestSpecific:Ljava/lang/ThreadLocal;
      33: aconst_null
      34: invokevirtual #7                  // Method java/lang/ThreadLocal.set:(Ljava/lang/Object;)V
      37: return

  private org.jboss.as.domain.management.AuthMechanism getRequestMeschanism();
    Code:
       0: getstatic     #6                  // Field requestSpecific:Ljava/lang/ThreadLocal;
       3: invokevirtual #8                  // Method java/lang/ThreadLocal.get:()Ljava/lang/Object;
       6: checkcast     #2                  // class org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore
       9: astore_1
      10: aload_1
      11: ifnonnull     18
      14: aconst_null
      15: goto          22
      18: aload_1
      19: getfield      #4                  // Field org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore.requestMechanism:Lorg/jboss/as/domain/management/AuthMechanism;
      22: areturn

  private java.net.InetAddress getInetAddress();
    Code:
       0: getstatic     #6                  // Field requestSpecific:Ljava/lang/ThreadLocal;
       3: invokevirtual #8                  // Method java/lang/ThreadLocal.get:()Ljava/lang/Object;
       6: checkcast     #2                  // class org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore
       9: astore_1
      10: aload_1
      11: ifnonnull     18
      14: aconst_null
      15: goto          22
      18: aload_1
      19: getfield      #5                  // Field org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore.inetAddress:Ljava/net/InetAddress;
      22: areturn

  void setCurrentSubjectIdentity(org.jboss.as.domain.management.SubjectIdentity);
    Code:
       0: getstatic     #6                  // Field requestSpecific:Ljava/lang/ThreadLocal;
       3: invokevirtual #8                  // Method java/lang/ThreadLocal.get:()Ljava/lang/Object;
       6: checkcast     #2                  // class org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore
       9: aload_1
      10: putfield      #9                  // Field org/jboss/as/domain/http/server/security/RealmIdentityManager$ThreadLocalStore.subjectIdentity:Lorg/jboss/as/domain/management/SubjectIdentity;
      13: return

  public org.jboss.as.domain.http.server.security.RealmIdentityManager(org.jboss.as.domain.management.SecurityRealm);
    Code:
       0: aload_0
       1: invokespecial #11                 // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #12                 // Field securityRealm:Lorg/jboss/as/domain/management/SecurityRealm;
       9: return

  public io.undertow.security.idm.Account verify(io.undertow.security.idm.Account);
    Code:
       0: aload_1
       1: areturn

  private boolean plainTextDigest();
    Code:
       0: aload_0
       1: getfield      #12                 // Field securityRealm:Lorg/jboss/as/domain/management/SecurityRealm;
       4: getstatic     #13                 // Field org/jboss/as/domain/management/AuthMechanism.DIGEST:Lorg/jboss/as/domain/management/AuthMechanism;
       7: invokeinterface #14,  2           // InterfaceMethod org/jboss/as/domain/management/SecurityRealm.getMechanismConfig:(Lorg/jboss/as/domain/management/AuthMechanism;)Ljava/util/Map;
      12: astore_1
      13: iconst_1
      14: istore_2
      15: aload_1
      16: ldc           #15                 // String org.jboss.as.domain.management.digest.plain_text
      18: invokeinterface #16,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
      23: ifeq          41
      26: aload_1
      27: ldc           #15                 // String org.jboss.as.domain.management.digest.plain_text
      29: invokeinterface #17,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      34: checkcast     #18                 // class java/lang/String
      37: invokestatic  #19                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
      40: istore_2
      41: iload_2
      42: ireturn

  public io.undertow.security.idm.Account verify(java.lang.String, io.undertow.security.idm.Credential);
    Code:
       0: aload_1
       1: ifnull        11
       4: aload_1
       5: invokevirtual #20                 // Method java/lang/String.length:()I
       8: ifne          23
      11: getstatic     #21                 // Field org/jboss/as/domain/http/server/logging/HttpServerLogger.ROOT_LOGGER:Lorg/jboss/as/domain/http/server/logging/HttpServerLogger;
      14: ldc           #22                 // String Missing or empty username received, aborting account verification.
      16: invokeinterface #23,  2           // InterfaceMethod org/jboss/as/domain/http/server/logging/HttpServerLogger.debug:(Ljava/lang/Object;)V
      21: aconst_null
      22: areturn
      23: aload_2
      24: instanceof    #24                 // class io/undertow/security/idm/PasswordCredential
      27: ifeq          40
      30: aload_0
      31: aload_1
      32: aload_2
      33: checkcast     #24                 // class io/undertow/security/idm/PasswordCredential
      36: invokespecial #25                 // Method verify:(Ljava/lang/String;Lio/undertow/security/idm/PasswordCredential;)Lio/undertow/security/idm/Account;
      39: areturn
      40: aload_2
      41: instanceof    #26                 // class io/undertow/security/idm/DigestCredential
      44: ifeq          57
      47: aload_0
      48: aload_1
      49: aload_2
      50: checkcast     #26                 // class io/undertow/security/idm/DigestCredential
      53: invokespecial #27                 // Method verify:(Ljava/lang/String;Lio/undertow/security/idm/DigestCredential;)Lio/undertow/security/idm/Account;
      56: areturn
      57: getstatic     #21                 // Field org/jboss/as/domain/http/server/logging/HttpServerLogger.ROOT_LOGGER:Lorg/jboss/as/domain/http/server/logging/HttpServerLogger;
      60: aload_2
      61: invokevirtual #28                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      64: invokevirtual #29                 // Method java/lang/Class.getName:()Ljava/lang/String;
      67: invokeinterface #30,  2           // InterfaceMethod org/jboss/as/domain/http/server/logging/HttpServerLogger.invalidCredentialType:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      72: athrow

  private io.undertow.security.idm.Account verify(java.lang.String, io.undertow.security.idm.PasswordCredential);
    Code:
       0: aload_0
       1: iconst_1
       2: anewarray     #31                 // class org/jboss/as/domain/management/AuthMechanism
       5: dup
       6: iconst_0
       7: getstatic     #32                 // Field org/jboss/as/domain/management/AuthMechanism.PLAIN:Lorg/jboss/as/domain/management/AuthMechanism;
      10: aastore
      11: invokespecial #33                 // Method assertMechanism:([Lorg/jboss/as/domain/management/AuthMechanism;)V
      14: aload_2
      15: instanceof    #24                 // class io/undertow/security/idm/PasswordCredential
      18: ifne          23
      21: aconst_null
      22: areturn
      23: aload_0
      24: getfield      #12                 // Field securityRealm:Lorg/jboss/as/domain/management/SecurityRealm;
      27: getstatic     #32                 // Field org/jboss/as/domain/management/AuthMechanism.PLAIN:Lorg/jboss/as/domain/management/AuthMechanism;
      30: invokeinterface #34,  2           // InterfaceMethod org/jboss/as/domain/management/SecurityRealm.getAuthorizingCallbackHandler:(Lorg/jboss/as/domain/management/AuthMechanism;)Lorg/jboss/as/domain/management/AuthorizingCallbackHandler;
      35: astore_3
      36: iconst_3
      37: anewarray     #35                 // class javax/security/auth/callback/Callback
      40: astore        4
      42: aload         4
      44: iconst_0
      45: new           #36                 // class javax/security/sasl/RealmCallback
      48: dup
      49: ldc           #37                 // String Realm
      51: aload_0
      52: getfield      #12                 // Field securityRealm:Lorg/jboss/as/domain/management/SecurityRealm;
      55: invokeinterface #38,  1           // InterfaceMethod org/jboss/as/domain/management/SecurityRealm.getName:()Ljava/lang/String;
      60: invokespecial #39                 // Method javax/security/sasl/RealmCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      63: aastore
      64: aload         4
      66: iconst_1
      67: new           #40                 // class javax/security/auth/callback/NameCallback
      70: dup
      71: ldc           #41                 // String Username
      73: aload_1
      74: invokespecial #42                 // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      77: aastore
      78: aload         4
      80: iconst_2
      81: new           #43                 // class org/jboss/sasl/callback/VerifyPasswordCallback
      84: dup
      85: new           #18                 // class java/lang/String
      88: dup
      89: aload_2
      90: invokevirtual #44                 // Method io/undertow/security/idm/PasswordCredential.getPassword:()[C
      93: invokespecial #45                 // Method java/lang/String."<init>":([C)V
      96: invokespecial #46                 // Method org/jboss/sasl/callback/VerifyPasswordCallback."<init>":(Ljava/lang/String;)V
      99: aastore
     100: aload_3
     101: aload         4
     103: invokeinterface #47,  2           // InterfaceMethod org/jboss/as/domain/management/AuthorizingCallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     108: goto          127
     111: astore        5
     113: getstatic     #21                 // Field org/jboss/as/domain/http/server/logging/HttpServerLogger.ROOT_LOGGER:Lorg/jboss/as/domain/http/server/logging/HttpServerLogger;
     116: ldc           #49                 // String Failure handling Callback(s) for BASIC authentication.
     118: aload         5
     120: invokeinterface #50,  3           // InterfaceMethod org/jboss/as/domain/http/server/logging/HttpServerLogger.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     125: aconst_null
     126: areturn
     127: aload         4
     129: iconst_2
     130: aaload
     131: checkcast     #43                 // class org/jboss/sasl/callback/VerifyPasswordCallback
     134: invokevirtual #51                 // Method org/jboss/sasl/callback/VerifyPasswordCallback.isVerified:()Z
     137: ifne          142
     140: aconst_null
     141: areturn
     142: new           #52                 // class org/jboss/as/core/security/SimplePrincipal
     145: dup
     146: aload_1
     147: invokespecial #53                 // Method org/jboss/as/core/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
     150: astore        5
     152: aload         5
     154: invokestatic  #54                 // Method java/util/Collections.singleton:(Ljava/lang/Object;)Ljava/util/Set;
     157: astore        6
     159: aload_3
     160: aload         6
     162: invokeinterface #55,  2           // InterfaceMethod org/jboss/as/domain/management/AuthorizingCallbackHandler.createSubjectUserInfo:(Ljava/util/Collection;)Lorg/jboss/as/core/security/SubjectUserInfo;
     167: astore        7
     169: goto          176
     172: astore        8
     174: aconst_null
     175: areturn
     176: aload_0
     177: aload         7
     179: invokeinterface #57,  1           // InterfaceMethod org/jboss/as/core/security/SubjectUserInfo.getSubject:()Ljavax/security/auth/Subject;
     184: invokevirtual #58                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     187: invokespecial #59                 // Method addInetPrincipal:(Ljava/util/Collection;)V
     190: new           #60                 // class org/jboss/as/domain/http/server/security/RealmIdentityAccount
     193: dup
     194: aload         7
     196: invokeinterface #57,  1           // InterfaceMethod org/jboss/as/core/security/SubjectUserInfo.getSubject:()Ljavax/security/auth/Subject;
     201: aload         5
     203: invokespecial #61                 // Method org/jboss/as/domain/http/server/security/RealmIdentityAccount."<init>":(Ljavax/security/auth/Subject;Ljava/security/Principal;)V
     206: areturn
    Exception table:
       from    to  target type
         100   108   111   Class java/lang/Exception
         159   169   172   Class java/io/IOException

  private io.undertow.security.idm.Account verify(java.lang.String, io.undertow.security.idm.DigestCredential);
    Code:
       0: aload_0
       1: iconst_1
       2: anewarray     #31                 // class org/jboss/as/domain/management/AuthMechanism
       5: dup
       6: iconst_0
       7: getstatic     #13                 // Field org/jboss/as/domain/management/AuthMechanism.DIGEST:Lorg/jboss/as/domain/management/AuthMechanism;
      10: aastore
      11: invokespecial #33                 // Method assertMechanism:([Lorg/jboss/as/domain/management/AuthMechanism;)V
      14: aload_0
      15: getfield      #12                 // Field securityRealm:Lorg/jboss/as/domain/management/SecurityRealm;
      18: getstatic     #13                 // Field org/jboss/as/domain/management/AuthMechanism.DIGEST:Lorg/jboss/as/domain/management/AuthMechanism;
      21: invokeinterface #34,  2           // InterfaceMethod org/jboss/as/domain/management/SecurityRealm.getAuthorizingCallbackHandler:(Lorg/jboss/as/domain/management/AuthMechanism;)Lorg/jboss/as/domain/management/AuthorizingCallbackHandler;
      26: astore_3
      27: iconst_3
      28: anewarray     #35                 // class javax/security/auth/callback/Callback
      31: astore        4
      33: aload         4
      35: iconst_0
      36: new           #36                 // class javax/security/sasl/RealmCallback
      39: dup
      40: ldc           #37                 // String Realm
      42: aload_2
      43: invokeinterface #62,  1           // InterfaceMethod io/undertow/security/idm/DigestCredential.getRealm:()Ljava/lang/String;
      48: invokespecial #39                 // Method javax/security/sasl/RealmCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      51: aastore
      52: aload         4
      54: iconst_1
      55: new           #40                 // class javax/security/auth/callback/NameCallback
      58: dup
      59: ldc           #41                 // String Username
      61: aload_1
      62: invokespecial #42                 // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      65: aastore
      66: aload_0
      67: invokespecial #63                 // Method plainTextDigest:()Z
      70: istore        5
      72: iload         5
      74: ifeq          94
      77: aload         4
      79: iconst_2
      80: new           #64                 // class javax/security/auth/callback/PasswordCallback
      83: dup
      84: ldc           #65                 // String Password
      86: iconst_0
      87: invokespecial #66                 // Method javax/security/auth/callback/PasswordCallback."<init>":(Ljava/lang/String;Z)V
      90: aastore
      91: goto          107
      94: aload         4
      96: iconst_2
      97: new           #67                 // class org/jboss/sasl/callback/DigestHashCallback
     100: dup
     101: ldc           #68                 // String Digest
     103: invokespecial #69                 // Method org/jboss/sasl/callback/DigestHashCallback."<init>":(Ljava/lang/String;)V
     106: aastore
     107: aload_3
     108: aload         4
     110: invokeinterface #47,  2           // InterfaceMethod org/jboss/as/domain/management/AuthorizingCallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     115: goto          134
     118: astore        6
     120: getstatic     #21                 // Field org/jboss/as/domain/http/server/logging/HttpServerLogger.ROOT_LOGGER:Lorg/jboss/as/domain/http/server/logging/HttpServerLogger;
     123: ldc           #49                 // String Failure handling Callback(s) for BASIC authentication.
     125: aload         6
     127: invokeinterface #50,  3           // InterfaceMethod org/jboss/as/domain/http/server/logging/HttpServerLogger.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     132: aconst_null
     133: areturn
     134: iload         5
     136: ifeq          280
     139: aconst_null
     140: astore        7
     142: aload_2
     143: invokeinterface #70,  1           // InterfaceMethod io/undertow/security/idm/DigestCredential.getAlgorithm:()Lio/undertow/security/idm/DigestAlgorithm;
     148: invokevirtual #71                 // Method io/undertow/security/idm/DigestAlgorithm.getMessageDigest:()Ljava/security/MessageDigest;
     151: astore        7
     153: aload         7
     155: aload_1
     156: getstatic     #72                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     159: invokevirtual #73                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     162: invokevirtual #74                 // Method java/security/MessageDigest.update:([B)V
     165: aload         7
     167: bipush        58
     169: invokevirtual #75                 // Method java/security/MessageDigest.update:(B)V
     172: aload         7
     174: aload_2
     175: invokeinterface #62,  1           // InterfaceMethod io/undertow/security/idm/DigestCredential.getRealm:()Ljava/lang/String;
     180: getstatic     #72                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     183: invokevirtual #73                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     186: invokevirtual #74                 // Method java/security/MessageDigest.update:([B)V
     189: aload         7
     191: bipush        58
     193: invokevirtual #75                 // Method java/security/MessageDigest.update:(B)V
     196: aload         7
     198: new           #18                 // class java/lang/String
     201: dup
     202: aload         4
     204: iconst_2
     205: aaload
     206: checkcast     #64                 // class javax/security/auth/callback/PasswordCallback
     209: invokevirtual #76                 // Method javax/security/auth/callback/PasswordCallback.getPassword:()[C
     212: invokespecial #45                 // Method java/lang/String."<init>":([C)V
     215: getstatic     #72                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     218: invokevirtual #73                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     221: invokevirtual #74                 // Method java/security/MessageDigest.update:([B)V
     224: aload         7
     226: invokevirtual #77                 // Method java/security/MessageDigest.digest:()[B
     229: invokestatic  #78                 // Method io/undertow/util/HexConverter.convertToHexBytes:([B)[B
     232: astore        6
     234: aload         7
     236: invokevirtual #79                 // Method java/security/MessageDigest.reset:()V
     239: goto          277
     242: astore        8
     244: getstatic     #21                 // Field org/jboss/as/domain/http/server/logging/HttpServerLogger.ROOT_LOGGER:Lorg/jboss/as/domain/http/server/logging/HttpServerLogger;
     247: ldc           #81                 // String Unexpected authentication failure
     249: aload         8
     251: invokeinterface #50,  3           // InterfaceMethod org/jboss/as/domain/http/server/logging/HttpServerLogger.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     256: aconst_null
     257: astore        9
     259: aload         7
     261: invokevirtual #79                 // Method java/security/MessageDigest.reset:()V
     264: aload         9
     266: areturn
     267: astore        10
     269: aload         7
     271: invokevirtual #79                 // Method java/security/MessageDigest.reset:()V
     274: aload         10
     276: athrow
     277: goto          298
     280: aload         4
     282: iconst_2
     283: aaload
     284: checkcast     #67                 // class org/jboss/sasl/callback/DigestHashCallback
     287: invokevirtual #82                 // Method org/jboss/sasl/callback/DigestHashCallback.getHexHash:()Ljava/lang/String;
     290: getstatic     #72                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     293: invokevirtual #73                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     296: astore        6
     298: aload_2
     299: aload         6
     301: invokeinterface #83,  2           // InterfaceMethod io/undertow/security/idm/DigestCredential.verifyHA1:([B)Z
     306: ifeq          367
     309: new           #52                 // class org/jboss/as/core/security/SimplePrincipal
     312: dup
     313: aload_1
     314: invokespecial #53                 // Method org/jboss/as/core/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
     317: astore        7
     319: aload         7
     321: invokestatic  #54                 // Method java/util/Collections.singleton:(Ljava/lang/Object;)Ljava/util/Set;
     324: astore        8
     326: aload_3
     327: aload         8
     329: invokeinterface #55,  2           // InterfaceMethod org/jboss/as/domain/management/AuthorizingCallbackHandler.createSubjectUserInfo:(Ljava/util/Collection;)Lorg/jboss/as/core/security/SubjectUserInfo;
     334: astore        9
     336: aload_0
     337: aload         9
     339: invokeinterface #57,  1           // InterfaceMethod org/jboss/as/core/security/SubjectUserInfo.getSubject:()Ljavax/security/auth/Subject;
     344: invokevirtual #58                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     347: invokespecial #59                 // Method addInetPrincipal:(Ljava/util/Collection;)V
     350: new           #60                 // class org/jboss/as/domain/http/server/security/RealmIdentityAccount
     353: dup
     354: aload         9
     356: invokeinterface #57,  1           // InterfaceMethod org/jboss/as/core/security/SubjectUserInfo.getSubject:()Ljavax/security/auth/Subject;
     361: aload         7
     363: invokespecial #61                 // Method org/jboss/as/domain/http/server/security/RealmIdentityAccount."<init>":(Ljavax/security/auth/Subject;Ljava/security/Principal;)V
     366: areturn
     367: goto          384
     370: astore        7
     372: getstatic     #21                 // Field org/jboss/as/domain/http/server/logging/HttpServerLogger.ROOT_LOGGER:Lorg/jboss/as/domain/http/server/logging/HttpServerLogger;
     375: ldc           #81                 // String Unexpected authentication failure
     377: aload         7
     379: invokeinterface #50,  3           // InterfaceMethod org/jboss/as/domain/http/server/logging/HttpServerLogger.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     384: aconst_null
     385: areturn
    Exception table:
       from    to  target type
         107   115   118   Class java/lang/Exception
         142   234   242   Class java/security/NoSuchAlgorithmException
         142   234   267   any
         242   259   267   any
         267   269   267   any
         298   366   370   Class java/io/IOException

  public io.undertow.security.idm.Account verify(io.undertow.security.idm.Credential);
    Code:
       0: aload_0
       1: iconst_2
       2: anewarray     #31                 // class org/jboss/as/domain/management/AuthMechanism
       5: dup
       6: iconst_0
       7: getstatic     #84                 // Field org/jboss/as/domain/management/AuthMechanism.CLIENT_CERT:Lorg/jboss/as/domain/management/AuthMechanism;
      10: aastore
      11: dup
      12: iconst_1
      13: getstatic     #85                 // Field org/jboss/as/domain/management/AuthMechanism.KERBEROS:Lorg/jboss/as/domain/management/AuthMechanism;
      16: aastore
      17: invokespecial #33                 // Method assertMechanism:([Lorg/jboss/as/domain/management/AuthMechanism;)V
      20: aload_1
      21: instanceof    #86                 // class io/undertow/security/idm/X509CertificateCredential
      24: ifeq          58
      27: aload_1
      28: checkcast     #86                 // class io/undertow/security/idm/X509CertificateCredential
      31: astore        4
      33: aload_0
      34: getfield      #12                 // Field securityRealm:Lorg/jboss/as/domain/management/SecurityRealm;
      37: getstatic     #84                 // Field org/jboss/as/domain/management/AuthMechanism.CLIENT_CERT:Lorg/jboss/as/domain/management/AuthMechanism;
      40: invokeinterface #34,  2           // InterfaceMethod org/jboss/as/domain/management/SecurityRealm.getAuthorizingCallbackHandler:(Lorg/jboss/as/domain/management/AuthMechanism;)Lorg/jboss/as/domain/management/AuthorizingCallbackHandler;
      45: astore_2
      46: aload         4
      48: invokevirtual #87                 // Method io/undertow/security/idm/X509CertificateCredential.getCertificate:()Ljava/security/cert/X509Certificate;
      51: invokevirtual #88                 // Method java/security/cert/X509Certificate.getSubjectDN:()Ljava/security/Principal;
      54: astore_3
      55: goto          131
      58: aload_1
      59: instanceof    #89                 // class io/undertow/security/idm/GSSContextCredential
      62: ifeq          129
      65: aload_1
      66: checkcast     #89                 // class io/undertow/security/idm/GSSContextCredential
      69: astore        4
      71: new           #90                 // class javax/security/auth/kerberos/KerberosPrincipal
      74: dup
      75: aload         4
      77: invokevirtual #91                 // Method io/undertow/security/idm/GSSContextCredential.getGssContext:()Lorg/ietf/jgss/GSSContext;
      80: invokeinterface #92,  1           // InterfaceMethod org/ietf/jgss/GSSContext.getSrcName:()Lorg/ietf/jgss/GSSName;
      85: invokeinterface #93,  1           // InterfaceMethod org/ietf/jgss/GSSName.toString:()Ljava/lang/String;
      90: invokespecial #94                 // Method javax/security/auth/kerberos/KerberosPrincipal."<init>":(Ljava/lang/String;)V
      93: astore_3
      94: goto          113
      97: astore        5
      99: getstatic     #21                 // Field org/jboss/as/domain/http/server/logging/HttpServerLogger.ROOT_LOGGER:Lorg/jboss/as/domain/http/server/logging/HttpServerLogger;
     102: ldc           #81                 // String Unexpected authentication failure
     104: aload         5
     106: invokeinterface #50,  3           // InterfaceMethod org/jboss/as/domain/http/server/logging/HttpServerLogger.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     111: aconst_null
     112: areturn
     113: aload_0
     114: getfield      #12                 // Field securityRealm:Lorg/jboss/as/domain/management/SecurityRealm;
     117: getstatic     #85                 // Field org/jboss/as/domain/management/AuthMechanism.KERBEROS:Lorg/jboss/as/domain/management/AuthMechanism;
     120: invokeinterface #34,  2           // InterfaceMethod org/jboss/as/domain/management/SecurityRealm.getAuthorizingCallbackHandler:(Lorg/jboss/as/domain/management/AuthMechanism;)Lorg/jboss/as/domain/management/AuthorizingCallbackHandler;
     125: astore_2
     126: goto          131
     129: aconst_null
     130: areturn
     131: aload_2
     132: iconst_1
     133: anewarray     #35                 // class javax/security/auth/callback/Callback
     136: dup
     137: iconst_0
     138: new           #96                 // class javax/security/sasl/AuthorizeCallback
     141: dup
     142: aload_3
     143: invokeinterface #97,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
     148: aload_3
     149: invokeinterface #97,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
     154: invokespecial #98                 // Method javax/security/sasl/AuthorizeCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     157: aastore
     158: invokeinterface #47,  2           // InterfaceMethod org/jboss/as/domain/management/AuthorizingCallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     163: goto          198
     166: astore        4
     168: getstatic     #21                 // Field org/jboss/as/domain/http/server/logging/HttpServerLogger.ROOT_LOGGER:Lorg/jboss/as/domain/http/server/logging/HttpServerLogger;
     171: ldc           #81                 // String Unexpected authentication failure
     173: aload         4
     175: invokeinterface #50,  3           // InterfaceMethod org/jboss/as/domain/http/server/logging/HttpServerLogger.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     180: aconst_null
     181: areturn
     182: astore        4
     184: getstatic     #21                 // Field org/jboss/as/domain/http/server/logging/HttpServerLogger.ROOT_LOGGER:Lorg/jboss/as/domain/http/server/logging/HttpServerLogger;
     187: ldc           #81                 // String Unexpected authentication failure
     189: aload         4
     191: invokeinterface #50,  3           // InterfaceMethod org/jboss/as/domain/http/server/logging/HttpServerLogger.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     196: aconst_null
     197: areturn
     198: aload_3
     199: invokestatic  #54                 // Method java/util/Collections.singleton:(Ljava/lang/Object;)Ljava/util/Set;
     202: astore        4
     204: aload_2
     205: aload         4
     207: invokeinterface #55,  2           // InterfaceMethod org/jboss/as/domain/management/AuthorizingCallbackHandler.createSubjectUserInfo:(Ljava/util/Collection;)Lorg/jboss/as/core/security/SubjectUserInfo;
     212: astore        5
     214: goto          221
     217: astore        6
     219: aconst_null
     220: areturn
     221: aload_0
     222: aload         5
     224: invokeinterface #57,  1           // InterfaceMethod org/jboss/as/core/security/SubjectUserInfo.getSubject:()Ljavax/security/auth/Subject;
     229: invokevirtual #58                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     232: invokespecial #59                 // Method addInetPrincipal:(Ljava/util/Collection;)V
     235: new           #60                 // class org/jboss/as/domain/http/server/security/RealmIdentityAccount
     238: dup
     239: aload         5
     241: invokeinterface #57,  1           // InterfaceMethod org/jboss/as/core/security/SubjectUserInfo.getSubject:()Ljavax/security/auth/Subject;
     246: aload_3
     247: invokespecial #61                 // Method org/jboss/as/domain/http/server/security/RealmIdentityAccount."<init>":(Ljavax/security/auth/Subject;Ljava/security/Principal;)V
     250: areturn
    Exception table:
       from    to  target type
          71    94    97   Class org/ietf/jgss/GSSException
         131   163   166   Class java/io/IOException
         131   163   182   Class javax/security/auth/callback/UnsupportedCallbackException
         204   214   217   Class java/io/IOException

  private void addInetPrincipal(java.util.Collection<java.security.Principal>);
    Code:
       0: aload_0
       1: invokespecial #100                // Method getInetAddress:()Ljava/net/InetAddress;
       4: astore_2
       5: aload_2
       6: ifnull        24
       9: aload_1
      10: new           #101                // class org/jboss/as/controller/security/InetAddressPrincipal
      13: dup
      14: aload_2
      15: invokespecial #102                // Method org/jboss/as/controller/security/InetAddressPrincipal."<init>":(Ljava/net/InetAddress;)V
      18: invokeinterface #103,  2          // InterfaceMethod java/util/Collection.add:(Ljava/lang/Object;)Z
      23: pop
      24: return

  private void assertMechanism(org.jboss.as.domain.management.AuthMechanism...);
    Code:
       0: aload_0
       1: invokespecial #104                // Method getRequestMeschanism:()Lorg/jboss/as/domain/management/AuthMechanism;
       4: astore_2
       5: aload_1
       6: astore_3
       7: aload_3
       8: arraylength
       9: istore        4
      11: iconst_0
      12: istore        5
      14: iload         5
      16: iload         4
      18: if_icmpge     40
      21: aload_3
      22: iload         5
      24: aaload
      25: astore        6
      27: aload_2
      28: aload         6
      30: if_acmpne     34
      33: return
      34: iinc          5, 1
      37: goto          14
      40: new           #105                // class java/lang/IllegalStateException
      43: dup
      44: ldc           #106                // String Unexpected authentication mechanism executing.
      46: invokespecial #107                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      49: athrow

  static {};
    Code:
       0: new           #108                // class java/lang/ThreadLocal
       3: dup
       4: invokespecial #109                // Method java/lang/ThreadLocal."<init>":()V
       7: putstatic     #6                  // Field requestSpecific:Ljava/lang/ThreadLocal;
      10: return
}
