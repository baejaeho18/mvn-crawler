Compiled from "LogoutHandler.java"
public class org.jboss.as.domain.http.server.security.LogoutHandler implements io.undertow.server.HttpHandler {
  public static final java.lang.String PATH;

  public static final java.lang.String CONTEXT;

  private static final java.lang.String EXIT;

  private static final java.lang.String HIT_ESCAPE;

  private static final java.lang.String BASIC;

  private static final java.lang.String DIGEST;

  private static final java.lang.String MECHANISM;

  private final io.undertow.security.impl.DigestAuthenticationMechanism digestMechanism;

  private final io.undertow.security.impl.DigestAuthenticationMechanism fakeRealmdigestMechanism;

  private final io.undertow.security.impl.BasicAuthenticationMechanism basicMechanism;

  private final io.undertow.security.impl.BasicAuthenticationMechanism fakeRealmBasicMechanism;

  public org.jboss.as.domain.http.server.security.LogoutHandler(java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: getstatic     #2                  // Field io/undertow/security/idm/DigestAlgorithm.MD5:Lio/undertow/security/idm/DigestAlgorithm;
       7: invokestatic  #3                  // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
      10: astore_2
      11: invokestatic  #4                  // Method java/util/Collections.emptyList:()Ljava/util/List;
      14: astore_3
      15: aload_0
      16: new           #5                  // class io/undertow/security/impl/DigestAuthenticationMechanism
      19: dup
      20: aload_2
      21: aload_3
      22: aload_1
      23: ldc           #6                  // String /management
      25: new           #7                  // class io/undertow/security/impl/SimpleNonceManager
      28: dup
      29: invokespecial #8                  // Method io/undertow/security/impl/SimpleNonceManager."<init>":()V
      32: invokespecial #9                  // Method io/undertow/security/impl/DigestAuthenticationMechanism."<init>":(Ljava/util/List;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Lio/undertow/security/api/NonceManager;)V
      35: putfield      #10                 // Field digestMechanism:Lio/undertow/security/impl/DigestAuthenticationMechanism;
      38: aload_0
      39: new           #5                  // class io/undertow/security/impl/DigestAuthenticationMechanism
      42: dup
      43: aload_2
      44: aload_3
      45: ldc           #12                 // String HIT THE ESCAPE KEY
      47: ldc           #6                  // String /management
      49: new           #7                  // class io/undertow/security/impl/SimpleNonceManager
      52: dup
      53: invokespecial #8                  // Method io/undertow/security/impl/SimpleNonceManager."<init>":()V
      56: invokespecial #9                  // Method io/undertow/security/impl/DigestAuthenticationMechanism."<init>":(Ljava/util/List;Ljava/util/List;Ljava/lang/String;Ljava/lang/String;Lio/undertow/security/api/NonceManager;)V
      59: putfield      #13                 // Field fakeRealmdigestMechanism:Lio/undertow/security/impl/DigestAuthenticationMechanism;
      62: aload_0
      63: new           #14                 // class io/undertow/security/impl/BasicAuthenticationMechanism
      66: dup
      67: aload_1
      68: invokespecial #15                 // Method io/undertow/security/impl/BasicAuthenticationMechanism."<init>":(Ljava/lang/String;)V
      71: putfield      #16                 // Field basicMechanism:Lio/undertow/security/impl/BasicAuthenticationMechanism;
      74: aload_0
      75: new           #14                 // class io/undertow/security/impl/BasicAuthenticationMechanism
      78: dup
      79: ldc           #12                 // String HIT THE ESCAPE KEY
      81: invokespecial #15                 // Method io/undertow/security/impl/BasicAuthenticationMechanism."<init>":(Ljava/lang/String;)V
      84: putfield      #17                 // Field fakeRealmBasicMechanism:Lio/undertow/security/impl/BasicAuthenticationMechanism;
      87: return

  public void handleRequest(io.undertow.server.HttpServerExchange) throws java.lang.Exception;
    Code:
       0: aload_1
       1: invokevirtual #18                 // Method io/undertow/server/HttpServerExchange.getRequestHeaders:()Lio/undertow/util/HeaderMap;
       4: astore_2
       5: aload_1
       6: invokevirtual #19                 // Method io/undertow/server/HttpServerExchange.getResponseHeaders:()Lio/undertow/util/HeaderMap;
       9: astore_3
      10: aload_3
      11: getstatic     #20                 // Field io/undertow/util/Headers.REFERER:Lio/undertow/util/HttpString;
      14: invokevirtual #21                 // Method io/undertow/util/HeaderMap.getFirst:(Lio/undertow/util/HttpString;)Ljava/lang/String;
      17: astore        4
      19: aload_1
      20: invokevirtual #22                 // Method io/undertow/server/HttpServerExchange.getRequestScheme:()Ljava/lang/String;
      23: astore        5
      25: aconst_null
      26: astore        6
      28: aload         4
      30: ifnull        90
      33: new           #23                 // class java/net/URI
      36: dup
      37: aload         4
      39: invokespecial #24                 // Method java/net/URI."<init>":(Ljava/lang/String;)V
      42: astore        7
      44: aload         7
      46: invokevirtual #25                 // Method java/net/URI.getScheme:()Ljava/lang/String;
      49: astore        5
      51: new           #26                 // class java/lang/StringBuilder
      54: dup
      55: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      58: aload         7
      60: invokevirtual #28                 // Method java/net/URI.getHost:()Ljava/lang/String;
      63: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      66: aload_0
      67: aload         5
      69: aload         7
      71: invokevirtual #30                 // Method java/net/URI.getPort:()I
      74: invokespecial #31                 // Method portPortion:(Ljava/lang/String;I)Ljava/lang/String;
      77: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      80: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      83: astore        6
      85: goto          90
      88: astore        7
      90: aload         6
      92: ifnonnull     118
      95: aload_2
      96: getstatic     #34                 // Field io/undertow/util/Headers.HOST:Lio/undertow/util/HttpString;
      99: invokevirtual #21                 // Method io/undertow/util/HeaderMap.getFirst:(Lio/undertow/util/HttpString;)Ljava/lang/String;
     102: astore        6
     104: aload         6
     106: ifnonnull     118
     109: aload_1
     110: sipush        500
     113: invokevirtual #36                 // Method io/undertow/server/HttpServerExchange.setResponseCode:(I)Lio/undertow/server/HttpServerExchange;
     116: pop
     117: return
     118: aload_2
     119: getstatic     #37                 // Field io/undertow/util/Headers.USER_AGENT:Lio/undertow/util/HttpString;
     122: invokevirtual #21                 // Method io/undertow/util/HeaderMap.getFirst:(Lio/undertow/util/HttpString;)Ljava/lang/String;
     125: astore        7
     127: aload         7
     129: ifnull        146
     132: aload         7
     134: ldc           #38                 // String Opera
     136: invokevirtual #39                 // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
     139: ifeq          146
     142: iconst_1
     143: goto          147
     146: iconst_0
     147: istore        8
     149: iload         8
     151: ifne          173
     154: aload         7
     156: ifnull        173
     159: aload         7
     161: ldc           #40                 // String MSIE
     163: invokevirtual #39                 // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
     166: ifeq          173
     169: iconst_1
     170: goto          174
     173: iconst_0
     174: istore        9
     176: aload_1
     177: invokevirtual #41                 // Method io/undertow/server/HttpServerExchange.getQueryString:()Ljava/lang/String;
     180: astore        10
     182: aload         10
     184: ifnull        201
     187: aload         10
     189: ldc           #42                 // String org.jboss.as.console.logout.exit
     191: invokevirtual #39                 // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
     194: ifeq          201
     197: iconst_1
     198: goto          202
     201: iconst_0
     202: istore        11
     204: iload         9
     206: ifeq          258
     209: aload_3
     210: getstatic     #43                 // Field io/undertow/util/Headers.LOCATION:Lio/undertow/util/HttpString;
     213: new           #26                 // class java/lang/StringBuilder
     216: dup
     217: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     220: aload         5
     222: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     225: ldc           #44                 // String ://
     227: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     230: aload         6
     232: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     235: ldc           #45                 // String /
     237: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     240: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     243: invokevirtual #46                 // Method io/undertow/util/HeaderMap.add:(Lio/undertow/util/HttpString;Ljava/lang/String;)Lio/undertow/util/HeaderMap;
     246: pop
     247: aload_1
     248: sipush        307
     251: invokevirtual #36                 // Method io/undertow/server/HttpServerExchange.setResponseCode:(I)Lio/undertow/server/HttpServerExchange;
     254: pop
     255: goto          623
     258: aload_2
     259: getstatic     #47                 // Field io/undertow/util/Headers.AUTHORIZATION:Lio/undertow/util/HttpString;
     262: invokevirtual #21                 // Method io/undertow/util/HeaderMap.getFirst:(Lio/undertow/util/HttpString;)Ljava/lang/String;
     265: astore        12
     267: iconst_1
     268: istore        13
     270: aload_1
     271: invokevirtual #48                 // Method io/undertow/server/HttpServerExchange.getQueryParameters:()Ljava/util/Map;
     274: astore        14
     276: aload         14
     278: ldc           #49                 // String mechanism
     280: invokeinterface #50,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     285: ifeq          320
     288: ldc           #51                 // String BASIC
     290: aload         14
     292: ldc           #49                 // String mechanism
     294: invokeinterface #52,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     299: checkcast     #53                 // class java/util/Deque
     302: invokeinterface #54,  1           // InterfaceMethod java/util/Deque.getFirst:()Ljava/lang/Object;
     307: invokevirtual #55                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     310: ifne          317
     313: iconst_1
     314: goto          318
     317: iconst_0
     318: istore        13
     320: aload         12
     322: ifnull        399
     325: aload         12
     327: invokevirtual #56                 // Method java/lang/String.length:()I
     330: ldc           #51                 // String BASIC
     332: invokevirtual #56                 // Method java/lang/String.length:()I
     335: if_icmple     399
     338: ldc           #51                 // String BASIC
     340: aload         12
     342: iconst_0
     343: ldc           #51                 // String BASIC
     345: invokevirtual #56                 // Method java/lang/String.length:()I
     348: invokevirtual #57                 // Method java/lang/String.substring:(II)Ljava/lang/String;
     351: invokevirtual #58                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     354: ifeq          399
     357: iconst_0
     358: istore        13
     360: aload         12
     362: bipush        6
     364: invokevirtual #59                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     367: invokestatic  #60                 // Method io/undertow/util/FlexBase64.decode:(Ljava/lang/String;)Ljava/nio/ByteBuffer;
     370: astore        15
     372: new           #61                 // class java/lang/String
     375: dup
     376: aload         15
     378: invokevirtual #62                 // Method java/nio/ByteBuffer.array:()[B
     381: aload         15
     383: invokevirtual #63                 // Method java/nio/ByteBuffer.arrayOffset:()I
     386: aload         15
     388: invokevirtual #64                 // Method java/nio/ByteBuffer.limit:()I
     391: getstatic     #65                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     394: invokespecial #66                 // Method java/lang/String."<init>":([BIILjava/nio/charset/Charset;)V
     397: astore        12
     399: aload         12
     401: ifnull        414
     404: aload         12
     406: ldc           #67                 // String enter-login-here
     408: invokevirtual #39                 // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
     411: ifne          577
     414: iload         11
     416: ifne          501
     419: aload_3
     420: getstatic     #43                 // Field io/undertow/util/Headers.LOCATION:Lio/undertow/util/HttpString;
     423: new           #26                 // class java/lang/StringBuilder
     426: dup
     427: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     430: aload         5
     432: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     435: ldc           #68                 // String ://enter-login-here:blah@
     437: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     440: aload         6
     442: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     445: ldc           #69                 // String /logout?
     447: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     450: ldc           #42                 // String org.jboss.as.console.logout.exit
     452: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     455: ldc           #70                 // String &
     457: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     460: ldc           #49                 // String mechanism
     462: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     465: ldc           #71                 // String =
     467: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     470: iload         13
     472: ifeq          480
     475: ldc           #72                 // String DIGEST
     477: goto          482
     480: ldc           #51                 // String BASIC
     482: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     485: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     488: invokevirtual #46                 // Method io/undertow/util/HeaderMap.add:(Lio/undertow/util/HttpString;Ljava/lang/String;)Lio/undertow/util/HeaderMap;
     491: pop
     492: aload_1
     493: sipush        307
     496: invokevirtual #36                 // Method io/undertow/server/HttpServerExchange.setResponseCode:(I)Lio/undertow/server/HttpServerExchange;
     499: pop
     500: return
     501: aload_0
     502: iload         8
     504: iload         13
     506: invokespecial #73                 // Method mechanism:(ZZ)Lio/undertow/security/api/AuthenticationMechanism;
     509: aload_1
     510: aconst_null
     511: invokeinterface #74,  3           // InterfaceMethod io/undertow/security/api/AuthenticationMechanism.sendChallenge:(Lio/undertow/server/HttpServerExchange;Lio/undertow/security/api/SecurityContext;)Lio/undertow/security/api/AuthenticationMechanism$ChallengeResult;
     516: pop
     517: new           #26                 // class java/lang/StringBuilder
     520: dup
     521: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     524: ldc           #75                 // String <html><script type=\'text/javascript\'>window.location=\"
     526: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     529: aload         5
     531: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     534: ldc           #44                 // String ://
     536: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     539: aload         6
     541: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     544: ldc           #76                 // String /\";</script></html>
     546: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     549: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     552: astore        15
     554: aload_1
     555: sipush        401
     558: invokevirtual #36                 // Method io/undertow/server/HttpServerExchange.setResponseCode:(I)Lio/undertow/server/HttpServerExchange;
     561: pop
     562: aload_1
     563: invokevirtual #77                 // Method io/undertow/server/HttpServerExchange.getResponseSender:()Lio/undertow/io/Sender;
     566: aload         15
     568: getstatic     #78                 // Field io/undertow/io/IoCallback.END_EXCHANGE:Lio/undertow/io/IoCallback;
     571: invokeinterface #79,  3           // InterfaceMethod io/undertow/io/Sender.send:(Ljava/lang/String;Lio/undertow/io/IoCallback;)V
     576: return
     577: aload_3
     578: getstatic     #43                 // Field io/undertow/util/Headers.LOCATION:Lio/undertow/util/HttpString;
     581: new           #26                 // class java/lang/StringBuilder
     584: dup
     585: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     588: aload         5
     590: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     593: ldc           #44                 // String ://
     595: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     598: aload         6
     600: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     603: ldc           #45                 // String /
     605: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     608: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     611: invokevirtual #46                 // Method io/undertow/util/HeaderMap.add:(Lio/undertow/util/HttpString;Ljava/lang/String;)Lio/undertow/util/HeaderMap;
     614: pop
     615: aload_1
     616: sipush        307
     619: invokevirtual #36                 // Method io/undertow/server/HttpServerExchange.setResponseCode:(I)Lio/undertow/server/HttpServerExchange;
     622: pop
     623: return
    Exception table:
       from    to  target type
          33    85    88   Class java/net/URISyntaxException

  private io.undertow.security.api.AuthenticationMechanism mechanism(boolean, boolean);
    Code:
       0: iload_2
       1: ifeq          20
       4: iload_1
       5: ifeq          15
       8: aload_0
       9: getfield      #13                 // Field fakeRealmdigestMechanism:Lio/undertow/security/impl/DigestAuthenticationMechanism;
      12: goto          19
      15: aload_0
      16: getfield      #10                 // Field digestMechanism:Lio/undertow/security/impl/DigestAuthenticationMechanism;
      19: areturn
      20: iload_1
      21: ifeq          31
      24: aload_0
      25: getfield      #17                 // Field fakeRealmBasicMechanism:Lio/undertow/security/impl/BasicAuthenticationMechanism;
      28: goto          35
      31: aload_0
      32: getfield      #16                 // Field basicMechanism:Lio/undertow/security/impl/BasicAuthenticationMechanism;
      35: areturn

  private java.lang.String portPortion(java.lang.String, int);
    Code:
       0: iload_2
       1: iconst_m1
       2: if_icmpeq     36
       5: ldc           #80                 // String http
       7: aload_1
       8: invokevirtual #55                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      11: ifeq          20
      14: iload_2
      15: bipush        80
      17: if_icmpeq     36
      20: ldc           #81                 // String https
      22: aload_1
      23: invokevirtual #55                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      26: ifeq          39
      29: iload_2
      30: sipush        443
      33: if_icmpne     39
      36: ldc           #82                 // String
      38: areturn
      39: new           #26                 // class java/lang/StringBuilder
      42: dup
      43: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      46: ldc           #83                 // String :
      48: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      51: iload_2
      52: invokestatic  #84                 // Method java/lang/String.valueOf:(I)Ljava/lang/String;
      55: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      58: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      61: areturn
}
