Compiled from "RemotingLoginModule.java"
public class org.jboss.as.security.remoting.RemotingLoginModule extends org.jboss.security.auth.spi.AbstractServerLoginModule {
  private static final java.lang.String USE_CLIENT_CERT_OPTION;

  private static final java.lang.String[] ALL_OPTIONS;

  private boolean useClientCert;

  private java.security.Principal identity;

  public org.jboss.as.security.remoting.RemotingLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jboss/security/auth/spi/AbstractServerLoginModule."<init>":()V
       4: aload_0
       5: iconst_0
       6: putfield      #2                  // Field useClientCert:Z
       9: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map<java.lang.String, ?>, java.util.Map<java.lang.String, ?>);
    Code:
       0: aload_0
       1: getstatic     #3                  // Field ALL_OPTIONS:[Ljava/lang/String;
       4: invokevirtual #4                  // Method addValidOptions:([Ljava/lang/String;)V
       7: aload_0
       8: aload_1
       9: aload_2
      10: aload_3
      11: aload         4
      13: invokespecial #5                  // Method org/jboss/security/auth/spi/AbstractServerLoginModule.initialize:(Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;Ljava/util/Map;Ljava/util/Map;)V
      16: aload         4
      18: ldc           #7                  // String useClientCert
      20: invokeinterface #8,  2            // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
      25: ifeq          47
      28: aload_0
      29: aload         4
      31: ldc           #7                  // String useClientCert
      33: invokeinterface #9,  2            // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      38: invokevirtual #10                 // Method java/lang/Object.toString:()Ljava/lang/String;
      41: invokestatic  #11                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
      44: putfield      #2                  // Field useClientCert:Z
      47: return

  public boolean login() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: invokespecial #12                 // Method org/jboss/security/auth/spi/AbstractServerLoginModule.login:()Z
       4: iconst_1
       5: if_icmpne     19
       8: aload_0
       9: getfield      #13                 // Field log:Lorg/jboss/logging/Logger;
      12: ldc           #14                 // String super.login()==true
      14: invokevirtual #15                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
      17: iconst_1
      18: ireturn
      19: aload_0
      20: invokevirtual #16                 // Method getCredential:()Ljava/lang/Object;
      23: astore_1
      24: aload_1
      25: instanceof    #17                 // class org/jboss/as/security/remoting/RemotingConnectionCredential
      28: ifeq          298
      31: aload_1
      32: checkcast     #17                 // class org/jboss/as/security/remoting/RemotingConnectionCredential
      35: invokevirtual #18                 // Method org/jboss/as/security/remoting/RemotingConnectionCredential.getConnection:()Lorg/jboss/remoting3/Connection;
      38: astore_2
      39: aconst_null
      40: astore_3
      41: aload_2
      42: invokeinterface #19,  1           // InterfaceMethod org/jboss/remoting3/Connection.getUserInfo:()Lorg/jboss/remoting3/security/UserInfo;
      47: astore        4
      49: aload         4
      51: instanceof    #20                 // class org/jboss/as/core/security/SubjectUserInfo
      54: ifeq          113
      57: aload         4
      59: checkcast     #20                 // class org/jboss/as/core/security/SubjectUserInfo
      62: invokeinterface #21,  1           // InterfaceMethod org/jboss/as/core/security/SubjectUserInfo.getPrincipals:()Ljava/util/Collection;
      67: invokeinterface #22,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      72: astore        5
      74: aload         5
      76: invokeinterface #23,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      81: ifeq          113
      84: aload         5
      86: invokeinterface #24,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      91: checkcast     #25                 // class java/security/Principal
      94: astore        6
      96: aload         6
      98: instanceof    #26                 // class org/jboss/as/core/security/RealmUser
     101: ifeq          110
     104: aload         6
     106: astore_3
     107: goto          113
     110: goto          74
     113: aload_3
     114: ifnonnull     169
     117: aload_2
     118: invokeinterface #27,  1           // InterfaceMethod org/jboss/remoting3/Connection.getPrincipals:()Ljava/util/Collection;
     123: invokeinterface #22,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     128: astore        5
     130: aload         5
     132: invokeinterface #23,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     137: ifeq          169
     140: aload         5
     142: invokeinterface #24,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     147: checkcast     #25                 // class java/security/Principal
     150: astore        6
     152: aload         6
     154: instanceof    #28                 // class org/jboss/remoting3/security/UserPrincipal
     157: ifeq          166
     160: aload         6
     162: astore_3
     163: goto          169
     166: goto          130
     169: aload_3
     170: ifnull        298
     173: aload_0
     174: aload_3
     175: putfield      #29                 // Field identity:Ljava/security/Principal;
     178: aload_0
     179: invokevirtual #30                 // Method getUseFirstPass:()Z
     182: ifeq          291
     185: aload_0
     186: getfield      #29                 // Field identity:Ljava/security/Principal;
     189: invokeinterface #31,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
     194: astore        5
     196: aload_0
     197: getfield      #13                 // Field log:Lorg/jboss/logging/Logger;
     200: ldc           #32                 // String Storing username \'%s\'
     202: aload         5
     204: invokevirtual #33                 // Method org/jboss/logging/Logger.debugf:(Ljava/lang/String;Ljava/lang/Object;)V
     207: aload_0
     208: getfield      #34                 // Field sharedState:Ljava/util/Map;
     211: ldc           #35                 // String javax.security.auth.login.name
     213: aload_0
     214: getfield      #29                 // Field identity:Ljava/security/Principal;
     217: invokeinterface #36,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     222: pop
     223: aload_0
     224: getfield      #2                  // Field useClientCert:Z
     227: ifeq          278
     230: aload_2
     231: invokeinterface #37,  1           // InterfaceMethod org/jboss/remoting3/Connection.getSslSession:()Ljavax/net/ssl/SSLSession;
     236: astore        6
     238: aload         6
     240: ifnull        278
     243: aload         6
     245: invokeinterface #38,  1           // InterfaceMethod javax/net/ssl/SSLSession.getPeerCertificateChain:()[Ljavax/security/cert/X509Certificate;
     250: iconst_0
     251: aaload
     252: astore_1
     253: aload_0
     254: getfield      #13                 // Field log:Lorg/jboss/logging/Logger;
     257: ldc           #39                 // String Using certificate as credential.
     259: invokevirtual #15                 // Method org/jboss/logging/Logger.debug:(Ljava/lang/Object;)V
     262: goto          278
     265: astore        7
     267: aload_0
     268: getfield      #13                 // Field log:Lorg/jboss/logging/Logger;
     271: ldc           #41                 // String No peer certificate available for \'%s\'
     273: aload         5
     275: invokevirtual #33                 // Method org/jboss/logging/Logger.debugf:(Ljava/lang/String;Ljava/lang/Object;)V
     278: aload_0
     279: getfield      #34                 // Field sharedState:Ljava/util/Map;
     282: ldc           #42                 // String javax.security.auth.login.password
     284: aload_1
     285: invokeinterface #36,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     290: pop
     291: aload_0
     292: iconst_1
     293: putfield      #43                 // Field loginOk:Z
     296: iconst_1
     297: ireturn
     298: iconst_0
     299: ireturn
    Exception table:
       from    to  target type
         243   262   265   Class javax/net/ssl/SSLPeerUnverifiedException

  protected java.lang.Object getCredential() throws javax.security.auth.login.LoginException;
    Code:
       0: new           #44                 // class javax/security/auth/callback/NameCallback
       3: dup
       4: ldc           #45                 // String Alias:
       6: invokespecial #46                 // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;)V
       9: astore_1
      10: new           #47                 // class org/jboss/security/auth/callback/ObjectCallback
      13: dup
      14: ldc           #48                 // String Credential:
      16: invokespecial #49                 // Method org/jboss/security/auth/callback/ObjectCallback."<init>":(Ljava/lang/String;)V
      19: astore_2
      20: iconst_2
      21: anewarray     #50                 // class javax/security/auth/callback/Callback
      24: dup
      25: iconst_0
      26: aload_1
      27: aastore
      28: dup
      29: iconst_1
      30: aload_2
      31: aastore
      32: astore_3
      33: aload_0
      34: getfield      #51                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      37: aload_3
      38: invokeinterface #52,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      43: aload_2
      44: invokevirtual #53                 // Method org/jboss/security/auth/callback/ObjectCallback.getCredential:()Ljava/lang/Object;
      47: areturn
      48: astore        4
      50: new           #55                 // class javax/security/auth/login/LoginException
      53: dup
      54: invokespecial #56                 // Method javax/security/auth/login/LoginException."<init>":()V
      57: astore        5
      59: aload         5
      61: aload         4
      63: invokevirtual #57                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
      66: pop
      67: aload         5
      69: athrow
      70: astore        4
      72: new           #55                 // class javax/security/auth/login/LoginException
      75: dup
      76: invokespecial #56                 // Method javax/security/auth/login/LoginException."<init>":()V
      79: astore        5
      81: aload         5
      83: aload         4
      85: invokevirtual #57                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
      88: pop
      89: aload         5
      91: athrow
    Exception table:
       from    to  target type
          33    47    48   Class java/io/IOException
          33    47    70   Class javax/security/auth/callback/UnsupportedCallbackException

  protected java.security.Principal getIdentity();
    Code:
       0: aload_0
       1: getfield      #29                 // Field identity:Ljava/security/Principal;
       4: areturn

  protected java.security.acl.Group[] getRoleSets() throws javax.security.auth.login.LoginException;
    Code:
       0: new           #59                 // class org/jboss/security/SimpleGroup
       3: dup
       4: ldc           #60                 // String Roles
       6: invokespecial #61                 // Method org/jboss/security/SimpleGroup."<init>":(Ljava/lang/String;)V
       9: astore_1
      10: new           #59                 // class org/jboss/security/SimpleGroup
      13: dup
      14: ldc           #62                 // String CallerPrincipal
      16: invokespecial #61                 // Method org/jboss/security/SimpleGroup."<init>":(Ljava/lang/String;)V
      19: astore_2
      20: iconst_2
      21: anewarray     #63                 // class java/security/acl/Group
      24: dup
      25: iconst_0
      26: aload_1
      27: aastore
      28: dup
      29: iconst_1
      30: aload_2
      31: aastore
      32: astore_3
      33: aload_2
      34: aload_0
      35: invokevirtual #64                 // Method getIdentity:()Ljava/security/Principal;
      38: invokeinterface #65,  2           // InterfaceMethod java/security/acl/Group.addMember:(Ljava/security/Principal;)Z
      43: pop
      44: aload_3
      45: areturn

  static {};
    Code:
       0: iconst_1
       1: anewarray     #66                 // class java/lang/String
       4: dup
       5: iconst_0
       6: ldc           #7                  // String useClientCert
       8: aastore
       9: putstatic     #3                  // Field ALL_OPTIONS:[Ljava/lang/String;
      12: return
}
