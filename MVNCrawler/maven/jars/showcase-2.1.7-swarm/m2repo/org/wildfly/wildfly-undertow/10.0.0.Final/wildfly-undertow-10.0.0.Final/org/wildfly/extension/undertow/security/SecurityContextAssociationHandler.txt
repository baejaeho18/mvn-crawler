Compiled from "SecurityContextAssociationHandler.java"
public class org.wildfly.extension.undertow.security.SecurityContextAssociationHandler implements io.undertow.server.HttpHandler {
  private final java.util.Map<java.lang.String, org.jboss.metadata.javaee.jboss.RunAsIdentityMetaData> runAsIdentityMetaDataMap;

  private final io.undertow.server.HttpHandler next;

  private static final java.security.PrivilegedAction<io.undertow.servlet.handlers.ServletRequestContext> CURRENT_CONTEXT;

  public org.wildfly.extension.undertow.security.SecurityContextAssociationHandler(java.util.Map<java.lang.String, org.jboss.metadata.javaee.jboss.RunAsIdentityMetaData>, io.undertow.server.HttpHandler);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field runAsIdentityMetaDataMap:Ljava/util/Map;
       9: aload_0
      10: aload_2
      11: putfield      #3                  // Field next:Lio/undertow/server/HttpHandler;
      14: return

  public void handleRequest(io.undertow.server.HttpServerExchange) throws java.lang.Exception;
    Code:
       0: aload_1
       1: getstatic     #4                  // Field org/wildfly/extension/undertow/security/UndertowSecurityAttachments.SECURITY_CONTEXT_ATTACHMENT:Lio/undertow/util/AttachmentKey;
       4: invokevirtual #5                  // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
       7: checkcast     #6                  // class org/jboss/security/SecurityContext
      10: astore_2
      11: aconst_null
      12: astore_3
      13: aconst_null
      14: astore        4
      16: aload_1
      17: getstatic     #7                  // Field io/undertow/servlet/handlers/ServletRequestContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      20: invokevirtual #5                  // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
      23: checkcast     #8                  // class io/undertow/servlet/handlers/ServletRequestContext
      26: invokevirtual #9                  // Method io/undertow/servlet/handlers/ServletRequestContext.getCurrentServlet:()Lio/undertow/servlet/handlers/ServletChain;
      29: astore        5
      31: aload_0
      32: getfield      #2                  // Field runAsIdentityMetaDataMap:Ljava/util/Map;
      35: aload         5
      37: invokevirtual #10                 // Method io/undertow/servlet/handlers/ServletChain.getManagedServlet:()Lio/undertow/servlet/core/ManagedServlet;
      40: invokevirtual #11                 // Method io/undertow/servlet/core/ManagedServlet.getServletInfo:()Lio/undertow/servlet/api/ServletInfo;
      43: invokevirtual #12                 // Method io/undertow/servlet/api/ServletInfo.getName:()Ljava/lang/String;
      46: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      51: checkcast     #14                 // class org/jboss/metadata/javaee/jboss/RunAsIdentityMetaData
      54: astore_3
      55: aconst_null
      56: astore        6
      58: aload_3
      59: ifnull        105
      62: getstatic     #15                 // Field org/wildfly/extension/undertow/logging/UndertowLogger.ROOT_LOGGER:Lorg/wildfly/extension/undertow/logging/UndertowLogger;
      65: ldc           #16                 // String %s, runAs: %s
      67: aload         5
      69: invokevirtual #10                 // Method io/undertow/servlet/handlers/ServletChain.getManagedServlet:()Lio/undertow/servlet/core/ManagedServlet;
      72: invokevirtual #11                 // Method io/undertow/servlet/core/ManagedServlet.getServletInfo:()Lio/undertow/servlet/api/ServletInfo;
      75: invokevirtual #12                 // Method io/undertow/servlet/api/ServletInfo.getName:()Ljava/lang/String;
      78: aload_3
      79: invokeinterface #17,  4           // InterfaceMethod org/wildfly/extension/undertow/logging/UndertowLogger.tracef:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      84: new           #18                 // class org/jboss/security/RunAsIdentity
      87: dup
      88: aload_3
      89: invokevirtual #19                 // Method org/jboss/metadata/javaee/jboss/RunAsIdentityMetaData.getRoleName:()Ljava/lang/String;
      92: aload_3
      93: invokevirtual #20                 // Method org/jboss/metadata/javaee/jboss/RunAsIdentityMetaData.getPrincipalName:()Ljava/lang/String;
      96: aload_3
      97: invokevirtual #21                 // Method org/jboss/metadata/javaee/jboss/RunAsIdentityMetaData.getRunAsRoles:()Ljava/util/Set;
     100: invokespecial #22                 // Method org/jboss/security/RunAsIdentity."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/util/Set;)V
     103: astore        6
     105: aload         6
     107: aload_2
     108: invokestatic  #23                 // Method org/wildfly/extension/undertow/security/SecurityActions.setRunAsIdentity:(Lorg/jboss/security/RunAs;Lorg/jboss/security/SecurityContext;)Lorg/jboss/security/RunAs;
     111: astore        4
     113: aload_0
     114: getfield      #3                  // Field next:Lio/undertow/server/HttpHandler;
     117: aload_1
     118: invokeinterface #24,  2           // InterfaceMethod io/undertow/server/HttpHandler.handleRequest:(Lio/undertow/server/HttpServerExchange;)V
     123: aload_3
     124: ifnull        153
     127: aload         4
     129: aload_2
     130: invokestatic  #23                 // Method org/wildfly/extension/undertow/security/SecurityActions.setRunAsIdentity:(Lorg/jboss/security/RunAs;Lorg/jboss/security/SecurityContext;)Lorg/jboss/security/RunAs;
     133: pop
     134: goto          153
     137: astore        7
     139: aload_3
     140: ifnull        150
     143: aload         4
     145: aload_2
     146: invokestatic  #23                 // Method org/wildfly/extension/undertow/security/SecurityActions.setRunAsIdentity:(Lorg/jboss/security/RunAs;Lorg/jboss/security/SecurityContext;)Lorg/jboss/security/RunAs;
     149: pop
     150: aload         7
     152: athrow
     153: return
    Exception table:
       from    to  target type
          16   123   137   any
         137   139   137   any

  public static io.undertow.server.HandlerWrapper wrapper(java.util.Map<java.lang.String, org.jboss.metadata.javaee.jboss.RunAsIdentityMetaData>);
    Code:
       0: new           #25                 // class org/wildfly/extension/undertow/security/SecurityContextAssociationHandler$2
       3: dup
       4: aload_0
       5: invokespecial #26                 // Method org/wildfly/extension/undertow/security/SecurityContextAssociationHandler$2."<init>":(Ljava/util/Map;)V
       8: areturn

  public static javax.servlet.ServletRequest getActiveRequest();
    Code:
       0: invokestatic  #27                 // Method java/lang/System.getSecurityManager:()Ljava/lang/SecurityManager;
       3: ifnonnull     13
       6: invokestatic  #28                 // Method io/undertow/servlet/handlers/ServletRequestContext.current:()Lio/undertow/servlet/handlers/ServletRequestContext;
       9: astore_0
      10: goto          23
      13: getstatic     #29                 // Field CURRENT_CONTEXT:Ljava/security/PrivilegedAction;
      16: invokestatic  #30                 // Method java/security/AccessController.doPrivileged:(Ljava/security/PrivilegedAction;)Ljava/lang/Object;
      19: checkcast     #8                  // class io/undertow/servlet/handlers/ServletRequestContext
      22: astore_0
      23: aload_0
      24: ifnonnull     29
      27: aconst_null
      28: areturn
      29: aload_0
      30: invokevirtual #31                 // Method io/undertow/servlet/handlers/ServletRequestContext.getServletRequest:()Ljavax/servlet/ServletRequest;
      33: areturn

  static {};
    Code:
       0: new           #32                 // class org/wildfly/extension/undertow/security/SecurityContextAssociationHandler$1
       3: dup
       4: invokespecial #33                 // Method org/wildfly/extension/undertow/security/SecurityContextAssociationHandler$1."<init>":()V
       7: putstatic     #29                 // Field CURRENT_CONTEXT:Ljava/security/PrivilegedAction;
      10: return
}
