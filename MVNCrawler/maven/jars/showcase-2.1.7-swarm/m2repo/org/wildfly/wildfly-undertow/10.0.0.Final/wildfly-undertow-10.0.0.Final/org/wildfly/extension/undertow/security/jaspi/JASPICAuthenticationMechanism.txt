Compiled from "JASPICAuthenticationMechanism.java"
public class org.wildfly.extension.undertow.security.jaspi.JASPICAuthenticationMechanism implements io.undertow.security.api.AuthenticationMechanism {
  static final java.lang.String JASPI_HTTP_SERVLET_LAYER;

  private static final java.lang.String MECHANISM_NAME;

  private static final java.lang.String JASPI_AUTH_TYPE;

  private static final java.lang.String JASPI_REGISTER_SESSION;

  public static final io.undertow.util.AttachmentKey<io.undertow.server.HttpServerExchange> HTTP_SERVER_EXCHANGE_ATTACHMENT_KEY;

  public static final io.undertow.util.AttachmentKey<io.undertow.security.api.SecurityContext> SECURITY_CONTEXT_ATTACHMENT_KEY;

  public static final io.undertow.util.AttachmentKey<java.lang.Boolean> AUTH_RUN;

  public static final int DEFAULT_ERROR_CODE;

  private final java.lang.String securityDomain;

  private final java.lang.String configuredAuthMethod;

  public org.wildfly.extension.undertow.security.jaspi.JASPICAuthenticationMechanism(java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field securityDomain:Ljava/lang/String;
       9: aload_0
      10: aload_2
      11: putfield      #3                  // Field configuredAuthMethod:Ljava/lang/String;
      14: return

  public io.undertow.security.api.AuthenticationMechanism$AuthenticationMechanismOutcome authenticate(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_1
       1: getstatic     #4                  // Field AUTH_RUN:Lio/undertow/util/AttachmentKey;
       4: iconst_1
       5: invokestatic  #5                  // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
       8: invokevirtual #6                  // Method io/undertow/server/HttpServerExchange.putAttachment:(Lio/undertow/util/AttachmentKey;Ljava/lang/Object;)Ljava/lang/Object;
      11: pop
      12: aload_1
      13: getstatic     #7                  // Field io/undertow/servlet/handlers/ServletRequestContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      16: invokevirtual #8                  // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
      19: checkcast     #9                  // class io/undertow/servlet/handlers/ServletRequestContext
      22: astore_3
      23: aload_0
      24: invokespecial #10                 // Method createJASPIAuthenticationManager:()Lorg/jboss/security/plugins/auth/JASPIServerAuthenticationManager;
      27: astore        4
      29: aload_0
      30: aload_1
      31: aload_2
      32: invokespecial #11                 // Method createMessageInfo:(Lio/undertow/server/HttpServerExchange;Lio/undertow/security/api/SecurityContext;)Lorg/jboss/security/auth/message/GenericMessageInfo;
      35: astore        5
      37: aload_3
      38: invokestatic  #12                 // Method buildApplicationIdentifier:(Lio/undertow/servlet/handlers/ServletRequestContext;)Ljava/lang/String;
      41: astore        6
      43: new           #13                 // class org/jboss/security/auth/callback/JASPICallbackHandler
      46: dup
      47: invokespecial #14                 // Method org/jboss/security/auth/callback/JASPICallbackHandler."<init>":()V
      50: astore        7
      52: aload_1
      53: getstatic     #15                 // Field org/wildfly/extension/undertow/security/jaspi/JASPICContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      56: new           #16                 // class org/wildfly/extension/undertow/security/jaspi/JASPICContext
      59: dup
      60: aload         5
      62: aload         4
      64: aload         7
      66: invokespecial #17                 // Method org/wildfly/extension/undertow/security/jaspi/JASPICContext."<init>":(Ljavax/security/auth/message/MessageInfo;Lorg/jboss/security/plugins/auth/JASPIServerAuthenticationManager;Lorg/jboss/security/auth/callback/JASPICallbackHandler;)V
      69: invokevirtual #6                  // Method io/undertow/server/HttpServerExchange.putAttachment:(Lio/undertow/util/AttachmentKey;Ljava/lang/Object;)Ljava/lang/Object;
      72: pop
      73: getstatic     #18                 // Field org/wildfly/extension/undertow/logging/UndertowLogger.ROOT_LOGGER:Lorg/wildfly/extension/undertow/logging/UndertowLogger;
      76: ldc           #19                 // String validateRequest for layer [%s] and applicationContextIdentifier [%s]
      78: ldc           #21                 // String HttpServlet
      80: aload         6
      82: invokeinterface #22,  4           // InterfaceMethod org/wildfly/extension/undertow/logging/UndertowLogger.debugf:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      87: aconst_null
      88: astore        8
      90: aload_1
      91: invokevirtual #23                 // Method io/undertow/server/HttpServerExchange.getSecurityContext:()Lio/undertow/security/api/SecurityContext;
      94: checkcast     #24                 // class org/wildfly/extension/undertow/security/jaspi/JASPICSecurityContext
      97: astore        9
      99: aload_1
     100: getstatic     #25                 // Field io/undertow/security/api/AuthenticatedSessionManager.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
     103: invokevirtual #8                  // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
     106: checkcast     #26                 // class io/undertow/security/api/AuthenticatedSessionManager
     109: astore        10
     111: aload         10
     113: ifnull        150
     116: aload         10
     118: aload_1
     119: invokeinterface #27,  2           // InterfaceMethod io/undertow/security/api/AuthenticatedSessionManager.lookupSession:(Lio/undertow/server/HttpServerExchange;)Lio/undertow/security/api/AuthenticatedSessionManager$AuthenticatedSession;
     124: astore        11
     126: aload         11
     128: ifnull        150
     131: aload         11
     133: invokevirtual #28                 // Method io/undertow/security/api/AuthenticatedSessionManager$AuthenticatedSession.getAccount:()Lio/undertow/security/idm/Account;
     136: astore        8
     138: aload         8
     140: ifnull        150
     143: aload         9
     145: aload         8
     147: invokevirtual #29                 // Method org/wildfly/extension/undertow/security/jaspi/JASPICSecurityContext.setCachedAuthenticatedAccount:(Lio/undertow/security/idm/Account;)V
     150: getstatic     #30                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     153: astore        11
     155: aconst_null
     156: astore        12
     158: aload         4
     160: aload         5
     162: new           #31                 // class javax/security/auth/Subject
     165: dup
     166: invokespecial #32                 // Method javax/security/auth/Subject."<init>":()V
     169: ldc           #21                 // String HttpServlet
     171: aload         6
     173: aload         7
     175: invokevirtual #33                 // Method org/jboss/security/plugins/auth/JASPIServerAuthenticationManager.isValid:(Ljavax/security/auth/message/MessageInfo;Ljavax/security/auth/Subject;Ljava/lang/String;Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)Z
     178: istore        13
     180: aload         9
     182: aconst_null
     183: invokevirtual #29                 // Method org/wildfly/extension/undertow/security/jaspi/JASPICSecurityContext.setCachedAuthenticatedAccount:(Lio/undertow/security/idm/Account;)V
     186: iload         13
     188: ifeq          206
     191: invokestatic  #34                 // Method org/wildfly/extension/undertow/security/jaspi/SecurityActions.getSecurityContext:()Lorg/jboss/security/SecurityContext;
     194: astore        14
     196: aload_0
     197: aload         8
     199: aload         14
     201: invokespecial #35                 // Method createAccount:(Lio/undertow/security/idm/Account;Lorg/jboss/security/SecurityContext;)Lio/undertow/security/idm/Account;
     204: astore        12
     206: aload         5
     208: invokevirtual #36                 // Method org/jboss/security/auth/message/GenericMessageInfo.getMap:()Ljava/util/Map;
     211: ldc           #37                 // String javax.servlet.http.authType
     213: invokeinterface #38,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     218: checkcast     #39                 // class java/lang/String
     221: astore        14
     223: aload         14
     225: ifnonnull     246
     228: aload_0
     229: getfield      #3                  // Field configuredAuthMethod:Ljava/lang/String;
     232: ifnull        242
     235: aload_0
     236: getfield      #3                  // Field configuredAuthMethod:Ljava/lang/String;
     239: goto          244
     242: ldc           #40                 // String JASPIC
     244: astore        14
     246: iload         13
     248: ifeq          319
     251: aload         12
     253: ifnull        319
     256: getstatic     #41                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     259: astore        11
     261: aload         5
     263: invokevirtual #36                 // Method org/jboss/security/auth/message/GenericMessageInfo.getMap:()Ljava/util/Map;
     266: ldc           #42                 // String javax.servlet.http.registerSession
     268: invokeinterface #38,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     273: astore        15
     275: iconst_0
     276: istore        16
     278: aload         15
     280: ifnull        304
     283: aload         15
     285: instanceof    #39                 // class java/lang/String
     288: ifeq          304
     291: aload         15
     293: checkcast     #39                 // class java/lang/String
     296: invokestatic  #43                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     299: invokevirtual #44                 // Method java/lang/Boolean.booleanValue:()Z
     302: istore        16
     304: aload_2
     305: aload         12
     307: aload         14
     309: iload         16
     311: invokeinterface #45,  4           // InterfaceMethod io/undertow/security/api/SecurityContext.authenticationComplete:(Lio/undertow/security/idm/Account;Ljava/lang/String;Z)V
     316: goto          386
     319: iload         13
     321: ifeq          348
     324: aload         12
     326: ifnonnull     348
     329: aload_0
     330: aload_3
     331: invokespecial #46                 // Method isMandatory:(Lio/undertow/servlet/handlers/ServletRequestContext;)Ljava/lang/Boolean;
     334: invokevirtual #44                 // Method java/lang/Boolean.booleanValue:()Z
     337: ifne          348
     340: getstatic     #47                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_ATTEMPTED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     343: astore        11
     345: goto          386
     348: getstatic     #30                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     351: astore        11
     353: aload_2
     354: ldc           #48                 // String JASPIC authentication failed.
     356: aload         14
     358: invokeinterface #49,  3           // InterfaceMethod io/undertow/security/api/SecurityContext.authenticationFailed:(Ljava/lang/String;Ljava/lang/String;)V
     363: aload_1
     364: invokestatic  #50                 // Method wasAuthExceptionThrown:(Lio/undertow/server/HttpServerExchange;)Z
     367: ifeq          386
     370: aload_0
     371: aload_1
     372: invokespecial #51                 // Method statusIndicatesError:(Lio/undertow/server/HttpServerExchange;)Z
     375: ifne          386
     378: aload_1
     379: sipush        401
     382: invokevirtual #52                 // Method io/undertow/server/HttpServerExchange.setResponseCode:(I)Lio/undertow/server/HttpServerExchange;
     385: pop
     386: aload_1
     387: getstatic     #7                  // Field io/undertow/servlet/handlers/ServletRequestContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
     390: invokevirtual #8                  // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
     393: checkcast     #9                  // class io/undertow/servlet/handlers/ServletRequestContext
     396: astore        15
     398: aload         15
     400: aload         5
     402: invokevirtual #53                 // Method org/jboss/security/auth/message/GenericMessageInfo.getRequestMessage:()Ljava/lang/Object;
     405: checkcast     #54                 // class javax/servlet/http/HttpServletRequest
     408: invokevirtual #55                 // Method io/undertow/servlet/handlers/ServletRequestContext.setServletRequest:(Ljavax/servlet/ServletRequest;)V
     411: aload         15
     413: aload         5
     415: invokevirtual #56                 // Method org/jboss/security/auth/message/GenericMessageInfo.getResponseMessage:()Ljava/lang/Object;
     418: checkcast     #57                 // class javax/servlet/http/HttpServletResponse
     421: invokevirtual #58                 // Method io/undertow/servlet/handlers/ServletRequestContext.setServletResponse:(Ljavax/servlet/ServletResponse;)V
     424: aload         11
     426: areturn

  public io.undertow.security.api.AuthenticationMechanism$ChallengeResult sendChallenge(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: new           #59                 // class io/undertow/security/api/AuthenticationMechanism$ChallengeResult
       3: dup
       4: iconst_1
       5: invokespecial #60                 // Method io/undertow/security/api/AuthenticationMechanism$ChallengeResult."<init>":(Z)V
       8: areturn

  private org.jboss.security.plugins.auth.JASPIServerAuthenticationManager createJASPIAuthenticationManager();
    Code:
       0: new           #61                 // class org/jboss/security/plugins/auth/JASPIServerAuthenticationManager
       3: dup
       4: aload_0
       5: getfield      #2                  // Field securityDomain:Ljava/lang/String;
       8: new           #62                 // class org/jboss/security/auth/callback/JBossCallbackHandler
      11: dup
      12: invokespecial #63                 // Method org/jboss/security/auth/callback/JBossCallbackHandler."<init>":()V
      15: invokespecial #64                 // Method org/jboss/security/plugins/auth/JASPIServerAuthenticationManager."<init>":(Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)V
      18: areturn

  static java.lang.String buildApplicationIdentifier(io.undertow.servlet.handlers.ServletRequestContext);
    Code:
       0: aload_0
       1: invokevirtual #65                 // Method io/undertow/servlet/handlers/ServletRequestContext.getServletRequest:()Ljavax/servlet/ServletRequest;
       4: astore_1
       5: new           #66                 // class java/lang/StringBuilder
       8: dup
       9: invokespecial #67                 // Method java/lang/StringBuilder."<init>":()V
      12: aload_1
      13: invokeinterface #68,  1           // InterfaceMethod javax/servlet/ServletRequest.getServletContext:()Ljavax/servlet/ServletContext;
      18: invokeinterface #69,  1           // InterfaceMethod javax/servlet/ServletContext.getVirtualServerName:()Ljava/lang/String;
      23: invokevirtual #70                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      26: ldc           #71                 // String
      28: invokevirtual #70                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      31: aload_1
      32: invokeinterface #68,  1           // InterfaceMethod javax/servlet/ServletRequest.getServletContext:()Ljavax/servlet/ServletContext;
      37: invokeinterface #72,  1           // InterfaceMethod javax/servlet/ServletContext.getContextPath:()Ljava/lang/String;
      42: invokevirtual #70                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      45: invokevirtual #73                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      48: areturn

  private org.jboss.security.auth.message.GenericMessageInfo createMessageInfo(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_1
       1: getstatic     #7                  // Field io/undertow/servlet/handlers/ServletRequestContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
       4: invokevirtual #8                  // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
       7: checkcast     #9                  // class io/undertow/servlet/handlers/ServletRequestContext
      10: astore_3
      11: new           #74                 // class org/jboss/security/auth/message/GenericMessageInfo
      14: dup
      15: invokespecial #75                 // Method org/jboss/security/auth/message/GenericMessageInfo."<init>":()V
      18: astore        4
      20: aload         4
      22: aload_3
      23: invokevirtual #65                 // Method io/undertow/servlet/handlers/ServletRequestContext.getServletRequest:()Ljavax/servlet/ServletRequest;
      26: invokevirtual #76                 // Method org/jboss/security/auth/message/GenericMessageInfo.setRequestMessage:(Ljava/lang/Object;)V
      29: aload         4
      31: aload_3
      32: invokevirtual #77                 // Method io/undertow/servlet/handlers/ServletRequestContext.getServletResponse:()Ljavax/servlet/ServletResponse;
      35: invokevirtual #78                 // Method org/jboss/security/auth/message/GenericMessageInfo.setResponseMessage:(Ljava/lang/Object;)V
      38: aload         4
      40: invokevirtual #36                 // Method org/jboss/security/auth/message/GenericMessageInfo.getMap:()Ljava/util/Map;
      43: ldc           #79                 // String javax.security.auth.message.MessagePolicy.isMandatory
      45: aload_0
      46: aload_3
      47: invokespecial #46                 // Method isMandatory:(Lio/undertow/servlet/handlers/ServletRequestContext;)Ljava/lang/Boolean;
      50: invokevirtual #80                 // Method java/lang/Boolean.toString:()Ljava/lang/String;
      53: invokeinterface #81,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      58: pop
      59: aload         4
      61: invokevirtual #36                 // Method org/jboss/security/auth/message/GenericMessageInfo.getMap:()Ljava/util/Map;
      64: getstatic     #82                 // Field SECURITY_CONTEXT_ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      67: aload_2
      68: invokeinterface #81,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      73: pop
      74: aload         4
      76: invokevirtual #36                 // Method org/jboss/security/auth/message/GenericMessageInfo.getMap:()Ljava/util/Map;
      79: getstatic     #83                 // Field HTTP_SERVER_EXCHANGE_ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      82: aload_1
      83: invokeinterface #81,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      88: pop
      89: aload         4
      91: areturn

  private io.undertow.security.idm.Account createAccount(io.undertow.security.idm.Account, org.jboss.security.SecurityContext);
    Code:
       0: aload_2
       1: ifnonnull     15
       4: getstatic     #18                 // Field org/wildfly/extension/undertow/logging/UndertowLogger.ROOT_LOGGER:Lorg/wildfly/extension/undertow/logging/UndertowLogger;
       7: ldc           #84                 // String org.jboss.security.SecurityContext
       9: invokeinterface #85,  2           // InterfaceMethod org/wildfly/extension/undertow/logging/UndertowLogger.nullParamter:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      14: athrow
      15: aload_2
      16: invokeinterface #86,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
      21: invokevirtual #87                 // Method org/jboss/security/SecurityContextUtil.getUserPrincipal:()Ljava/security/Principal;
      24: astore_3
      25: aload_3
      26: ifnonnull     31
      29: aconst_null
      30: areturn
      31: aload_1
      32: ifnull        141
      35: aload_1
      36: invokeinterface #88,  1           // InterfaceMethod io/undertow/security/idm/Account.getPrincipal:()Ljava/security/Principal;
      41: aload_3
      42: if_acmpne     141
      45: aload_2
      46: invokeinterface #86,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
      51: aload_3
      52: aload_1
      53: checkcast     #89                 // class org/wildfly/extension/undertow/security/AccountImpl
      56: invokevirtual #90                 // Method org/wildfly/extension/undertow/security/AccountImpl.getCredential:()Ljava/lang/Object;
      59: aconst_null
      60: invokevirtual #91                 // Method org/jboss/security/SecurityContextUtil.createSubjectInfo:(Ljava/security/Principal;Ljava/lang/Object;Ljavax/security/auth/Subject;)V
      63: new           #92                 // class org/jboss/security/identity/plugins/SimpleRoleGroup
      66: dup
      67: ldc           #94                 // String Roles
      69: invokespecial #95                 // Method org/jboss/security/identity/plugins/SimpleRoleGroup."<init>":(Ljava/lang/String;)V
      72: astore        4
      74: aload_1
      75: invokeinterface #96,  1           // InterfaceMethod io/undertow/security/idm/Account.getRoles:()Ljava/util/Set;
      80: invokeinterface #97,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      85: astore        5
      87: aload         5
      89: invokeinterface #98,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      94: ifeq          128
      97: aload         5
      99: invokeinterface #99,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     104: checkcast     #39                 // class java/lang/String
     107: astore        6
     109: aload         4
     111: new           #100                // class org/jboss/security/identity/plugins/SimpleRole
     114: dup
     115: aload         6
     117: invokespecial #101                // Method org/jboss/security/identity/plugins/SimpleRole."<init>":(Ljava/lang/String;)V
     120: invokeinterface #102,  2          // InterfaceMethod org/jboss/security/identity/RoleGroup.addRole:(Lorg/jboss/security/identity/Role;)V
     125: goto          87
     128: aload_2
     129: invokeinterface #86,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
     134: aload         4
     136: invokevirtual #103                // Method org/jboss/security/SecurityContextUtil.setRoles:(Lorg/jboss/security/identity/RoleGroup;)V
     139: aload_1
     140: areturn
     141: new           #104                // class java/util/HashSet
     144: dup
     145: invokespecial #105                // Method java/util/HashSet."<init>":()V
     148: astore        4
     150: aload_2
     151: invokeinterface #86,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
     156: invokevirtual #106                // Method org/jboss/security/SecurityContextUtil.getRoles:()Lorg/jboss/security/identity/RoleGroup;
     159: astore        5
     161: aload         5
     163: ifnull        220
     166: aload         5
     168: invokeinterface #107,  1          // InterfaceMethod org/jboss/security/identity/RoleGroup.getRoles:()Ljava/util/Collection;
     173: invokeinterface #108,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     178: astore        6
     180: aload         6
     182: invokeinterface #98,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     187: ifeq          220
     190: aload         6
     192: invokeinterface #99,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     197: checkcast     #109                // class org/jboss/security/identity/Role
     200: astore        7
     202: aload         4
     204: aload         7
     206: invokeinterface #110,  1          // InterfaceMethod org/jboss/security/identity/Role.getRoleName:()Ljava/lang/String;
     211: invokeinterface #111,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     216: pop
     217: goto          180
     220: aload_2
     221: invokeinterface #86,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
     226: invokevirtual #112                // Method org/jboss/security/SecurityContextUtil.getCredential:()Ljava/lang/Object;
     229: astore        6
     231: aconst_null
     232: astore        7
     234: aload_1
     235: ifnull        246
     238: aload_1
     239: invokeinterface #88,  1           // InterfaceMethod io/undertow/security/idm/Account.getPrincipal:()Ljava/security/Principal;
     244: astore        7
     246: new           #89                 // class org/wildfly/extension/undertow/security/AccountImpl
     249: dup
     250: aload_3
     251: aload         4
     253: aload         6
     255: aload         7
     257: invokespecial #113                // Method org/wildfly/extension/undertow/security/AccountImpl."<init>":(Ljava/security/Principal;Ljava/util/Set;Ljava/lang/Object;Ljava/security/Principal;)V
     260: areturn

  private java.lang.Boolean isMandatory(io.undertow.servlet.handlers.ServletRequestContext);
    Code:
       0: aload_1
       1: invokevirtual #114                // Method io/undertow/servlet/handlers/ServletRequestContext.getExchange:()Lio/undertow/server/HttpServerExchange;
       4: invokevirtual #23                 // Method io/undertow/server/HttpServerExchange.getSecurityContext:()Lio/undertow/security/api/SecurityContext;
       7: ifnull        29
      10: aload_1
      11: invokevirtual #114                // Method io/undertow/servlet/handlers/ServletRequestContext.getExchange:()Lio/undertow/server/HttpServerExchange;
      14: invokevirtual #23                 // Method io/undertow/server/HttpServerExchange.getSecurityContext:()Lio/undertow/security/api/SecurityContext;
      17: invokeinterface #115,  1          // InterfaceMethod io/undertow/security/api/SecurityContext.isAuthenticationRequired:()Z
      22: ifeq          29
      25: iconst_1
      26: goto          30
      29: iconst_0
      30: invokestatic  #5                  // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
      33: areturn

  private boolean statusIndicatesError(io.undertow.server.HttpServerExchange);
    Code:
       0: aload_1
       1: invokevirtual #116                // Method io/undertow/server/HttpServerExchange.getResponseCode:()I
       4: sipush        200
       7: if_icmpeq     14
      10: iconst_1
      11: goto          15
      14: iconst_0
      15: ireturn

  static boolean wasAuthExceptionThrown(io.undertow.server.HttpServerExchange);
    Code:
       0: aload_0
       1: getstatic     #118                // Field org/wildfly/extension/undertow/security/UndertowSecurityAttachments.SECURITY_CONTEXT_ATTACHMENT:Lio/undertow/util/AttachmentKey;
       4: invokevirtual #8                  // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
       7: checkcast     #119                // class org/jboss/security/SecurityContext
      10: invokeinterface #120,  1          // InterfaceMethod org/jboss/security/SecurityContext.getData:()Ljava/util/Map;
      15: ldc           #121                // class javax/security/auth/message/AuthException
      17: invokevirtual #122                // Method java/lang/Class.getName:()Ljava/lang/String;
      20: invokeinterface #38,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      25: ifnull        32
      28: iconst_1
      29: goto          33
      32: iconst_0
      33: ireturn

  static {};
    Code:
       0: ldc           #123                // class io/undertow/server/HttpServerExchange
       2: invokestatic  #124                // Method io/undertow/util/AttachmentKey.create:(Ljava/lang/Class;)Lio/undertow/util/AttachmentKey;
       5: putstatic     #83                 // Field HTTP_SERVER_EXCHANGE_ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
       8: ldc           #125                // class io/undertow/security/api/SecurityContext
      10: invokestatic  #124                // Method io/undertow/util/AttachmentKey.create:(Ljava/lang/Class;)Lio/undertow/util/AttachmentKey;
      13: putstatic     #82                 // Field SECURITY_CONTEXT_ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      16: ldc           #126                // class java/lang/Boolean
      18: invokestatic  #124                // Method io/undertow/util/AttachmentKey.create:(Ljava/lang/Class;)Lio/undertow/util/AttachmentKey;
      21: putstatic     #4                  // Field AUTH_RUN:Lio/undertow/util/AttachmentKey;
      24: return
}
