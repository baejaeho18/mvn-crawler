Compiled from "JAASIdentityManagerImpl.java"
public class org.wildfly.extension.undertow.security.JAASIdentityManagerImpl implements io.undertow.security.idm.IdentityManager {
  private final org.jboss.as.security.plugins.SecurityDomainContext securityDomainContext;

  public org.wildfly.extension.undertow.security.JAASIdentityManagerImpl(org.jboss.as.security.plugins.SecurityDomainContext);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field securityDomainContext:Lorg/jboss/as/security/plugins/SecurityDomainContext;
       9: return

  public io.undertow.security.idm.Account verify(io.undertow.security.idm.Account);
    Code:
       0: aload_1
       1: instanceof    #3                  // class org/wildfly/extension/undertow/security/AccountImpl
       4: ifne          20
       7: getstatic     #4                  // Field org/wildfly/extension/undertow/logging/UndertowLogger.ROOT_LOGGER:Lorg/wildfly/extension/undertow/logging/UndertowLogger;
      10: ldc           #5                  // String Account is not an AccountImpl
      12: aload_1
      13: invokeinterface #6,  3            // InterfaceMethod org/wildfly/extension/undertow/logging/UndertowLogger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
      18: aconst_null
      19: areturn
      20: aload_1
      21: checkcast     #3                  // class org/wildfly/extension/undertow/security/AccountImpl
      24: astore_2
      25: aload_0
      26: aload_2
      27: aload_2
      28: invokevirtual #7                  // Method org/wildfly/extension/undertow/security/AccountImpl.getCredential:()Ljava/lang/Object;
      31: invokespecial #8                  // Method verifyCredential:(Lorg/wildfly/extension/undertow/security/AccountImpl;Ljava/lang/Object;)Lio/undertow/security/idm/Account;
      34: areturn

  public io.undertow.security.idm.Account verify(java.lang.String, io.undertow.security.idm.Credential);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #9                  // Method getAccount:(Ljava/lang/String;)Lorg/wildfly/extension/undertow/security/AccountImpl;
       5: astore_3
       6: aload_2
       7: instanceof    #10                 // class org/wildfly/extension/undertow/security/digest/DigestCredential
      10: ifeq          89
      13: aload_2
      14: checkcast     #10                 // class org/wildfly/extension/undertow/security/digest/DigestCredential
      17: astore        4
      19: new           #11                 // class org/jboss/security/auth/callback/DigestCallbackHandler
      22: dup
      23: aload_1
      24: aload         4
      26: invokeinterface #12,  1           // InterfaceMethod org/wildfly/extension/undertow/security/digest/DigestCredential.getNonce:()Ljava/lang/String;
      31: aload         4
      33: invokeinterface #13,  1           // InterfaceMethod org/wildfly/extension/undertow/security/digest/DigestCredential.getNonceCount:()Ljava/lang/String;
      38: aload         4
      40: invokeinterface #14,  1           // InterfaceMethod org/wildfly/extension/undertow/security/digest/DigestCredential.getClientNonce:()Ljava/lang/String;
      45: aload         4
      47: invokeinterface #15,  1           // InterfaceMethod org/wildfly/extension/undertow/security/digest/DigestCredential.getQop:()Ljava/lang/String;
      52: aload         4
      54: invokeinterface #16,  1           // InterfaceMethod org/wildfly/extension/undertow/security/digest/DigestCredential.getRealm:()Ljava/lang/String;
      59: aload         4
      61: invokeinterface #17,  1           // InterfaceMethod org/wildfly/extension/undertow/security/digest/DigestCredential.getHA2:()Ljava/lang/String;
      66: invokespecial #18                 // Method org/jboss/security/auth/callback/DigestCallbackHandler."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
      69: astore        5
      71: aload         5
      73: invokestatic  #19                 // Method org/jboss/security/auth/callback/CallbackHandlerPolicyContextHandler.setCallbackHandler:(Ljavax/security/auth/callback/CallbackHandler;)V
      76: aload_0
      77: aload_3
      78: aload         4
      80: invokeinterface #20,  1           // InterfaceMethod org/wildfly/extension/undertow/security/digest/DigestCredential.getClientDigest:()Ljava/lang/String;
      85: invokespecial #8                  // Method verifyCredential:(Lorg/wildfly/extension/undertow/security/AccountImpl;Ljava/lang/Object;)Lio/undertow/security/idm/Account;
      88: areturn
      89: aload_2
      90: instanceof    #21                 // class io/undertow/security/idm/PasswordCredential
      93: ifeq          123
      96: aload_2
      97: checkcast     #21                 // class io/undertow/security/idm/PasswordCredential
     100: invokevirtual #22                 // Method io/undertow/security/idm/PasswordCredential.getPassword:()[C
     103: astore        4
     105: aload         4
     107: aload         4
     109: arraylength
     110: invokestatic  #23                 // Method java/util/Arrays.copyOf:([CI)[C
     113: astore        5
     115: aload_0
     116: aload_3
     117: aload         5
     119: invokespecial #8                  // Method verifyCredential:(Lorg/wildfly/extension/undertow/security/AccountImpl;Ljava/lang/Object;)Lio/undertow/security/idm/Account;
     122: areturn
     123: aload_0
     124: aload_3
     125: aload_2
     126: invokespecial #8                  // Method verifyCredential:(Lorg/wildfly/extension/undertow/security/AccountImpl;Ljava/lang/Object;)Lio/undertow/security/idm/Account;
     129: areturn

  public io.undertow.security.idm.Account verify(io.undertow.security.idm.Credential);
    Code:
       0: aload_1
       1: instanceof    #24                 // class io/undertow/security/idm/X509CertificateCredential
       4: ifeq          40
       7: aload_1
       8: checkcast     #24                 // class io/undertow/security/idm/X509CertificateCredential
      11: astore_2
      12: aload_2
      13: invokevirtual #25                 // Method io/undertow/security/idm/X509CertificateCredential.getCertificate:()Ljava/security/cert/X509Certificate;
      16: astore_3
      17: aload_0
      18: aload_3
      19: invokevirtual #26                 // Method java/security/cert/X509Certificate.getSubjectDN:()Ljava/security/Principal;
      22: invokeinterface #27,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      27: invokespecial #9                  // Method getAccount:(Ljava/lang/String;)Lorg/wildfly/extension/undertow/security/AccountImpl;
      30: astore        4
      32: aload_0
      33: aload         4
      35: aload_3
      36: invokespecial #8                  // Method verifyCredential:(Lorg/wildfly/extension/undertow/security/AccountImpl;Ljava/lang/Object;)Lio/undertow/security/idm/Account;
      39: areturn
      40: new           #28                 // class java/lang/IllegalArgumentException
      43: dup
      44: ldc           #29                 // String Parameter must be a X509CertificateCredential
      46: invokespecial #30                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      49: athrow

  private org.wildfly.extension.undertow.security.AccountImpl getAccount(java.lang.String);
    Code:
       0: new           #3                  // class org/wildfly/extension/undertow/security/AccountImpl
       3: dup
       4: aload_1
       5: invokespecial #31                 // Method org/wildfly/extension/undertow/security/AccountImpl."<init>":(Ljava/lang/String;)V
       8: areturn

  private io.undertow.security.idm.Account verifyCredential(org.wildfly.extension.undertow.security.AccountImpl, java.lang.Object);
    Code:
       0: aload_0
       1: getfield      #2                  // Field securityDomainContext:Lorg/jboss/as/security/plugins/SecurityDomainContext;
       4: invokevirtual #32                 // Method org/jboss/as/security/plugins/SecurityDomainContext.getAuthenticationManager:()Lorg/jboss/security/AuthenticationManager;
       7: astore_3
       8: aload_0
       9: getfield      #2                  // Field securityDomainContext:Lorg/jboss/as/security/plugins/SecurityDomainContext;
      12: invokevirtual #33                 // Method org/jboss/as/security/plugins/SecurityDomainContext.getAuthorizationManager:()Lorg/jboss/security/AuthorizationManager;
      15: astore        4
      17: invokestatic  #34                 // Method org/wildfly/extension/undertow/security/SecurityActions.getSecurityContext:()Lorg/jboss/security/SecurityContext;
      20: astore        5
      22: aload_1
      23: invokevirtual #35                 // Method org/wildfly/extension/undertow/security/AccountImpl.getOriginalPrincipal:()Ljava/security/Principal;
      26: astore        6
      28: new           #36                 // class javax/security/auth/Subject
      31: dup
      32: invokespecial #37                 // Method javax/security/auth/Subject."<init>":()V
      35: astore        7
      37: aload_3
      38: aload         6
      40: aload_2
      41: aload         7
      43: invokeinterface #38,  4           // InterfaceMethod org/jboss/security/AuthenticationManager.isValid:(Ljava/security/Principal;Ljava/lang/Object;Ljavax/security/auth/Subject;)Z
      48: istore        8
      50: iload         8
      52: ifeq          208
      55: getstatic     #4                  // Field org/wildfly/extension/undertow/logging/UndertowLogger.ROOT_LOGGER:Lorg/wildfly/extension/undertow/logging/UndertowLogger;
      58: ldc           #39                 // String User: %s is authenticated
      60: aload         6
      62: invokeinterface #6,  3            // InterfaceMethod org/wildfly/extension/undertow/logging/UndertowLogger.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
      67: aload         5
      69: ifnonnull     81
      72: getstatic     #4                  // Field org/wildfly/extension/undertow/logging/UndertowLogger.ROOT_LOGGER:Lorg/wildfly/extension/undertow/logging/UndertowLogger;
      75: invokeinterface #40,  1           // InterfaceMethod org/wildfly/extension/undertow/logging/UndertowLogger.noSecurityContext:()Ljava/lang/IllegalStateException;
      80: athrow
      81: aload_0
      82: aload         7
      84: invokespecial #41                 // Method getPrincipal:(Ljavax/security/auth/Subject;)Ljava/security/Principal;
      87: astore        9
      89: aload         5
      91: invokeinterface #42,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
      96: aload         6
      98: aload_2
      99: aload         7
     101: invokevirtual #43                 // Method org/jboss/security/SecurityContextUtil.createSubjectInfo:(Ljava/security/Principal;Ljava/lang/Object;Ljavax/security/auth/Subject;)V
     104: new           #44                 // class org/jboss/security/callbacks/SecurityContextCallbackHandler
     107: dup
     108: aload         5
     110: invokespecial #45                 // Method org/jboss/security/callbacks/SecurityContextCallbackHandler."<init>":(Lorg/jboss/security/SecurityContext;)V
     113: astore        10
     115: aload         4
     117: aload         7
     119: aload         10
     121: invokeinterface #46,  3           // InterfaceMethod org/jboss/security/AuthorizationManager.getSubjectRoles:(Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;)Lorg/jboss/security/identity/RoleGroup;
     126: astore        11
     128: new           #47                 // class java/util/HashSet
     131: dup
     132: invokespecial #48                 // Method java/util/HashSet."<init>":()V
     135: astore        12
     137: aload         11
     139: invokeinterface #49,  1           // InterfaceMethod org/jboss/security/identity/RoleGroup.getRoles:()Ljava/util/Collection;
     144: invokeinterface #50,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     149: astore        13
     151: aload         13
     153: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     158: ifeq          191
     161: aload         13
     163: invokeinterface #52,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     168: checkcast     #53                 // class org/jboss/security/identity/Role
     171: astore        14
     173: aload         12
     175: aload         14
     177: invokeinterface #54,  1           // InterfaceMethod org/jboss/security/identity/Role.getRoleName:()Ljava/lang/String;
     182: invokeinterface #55,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     187: pop
     188: goto          151
     191: new           #3                  // class org/wildfly/extension/undertow/security/AccountImpl
     194: dup
     195: aload         9
     197: aload         12
     199: aload_2
     200: aload_1
     201: invokevirtual #35                 // Method org/wildfly/extension/undertow/security/AccountImpl.getOriginalPrincipal:()Ljava/security/Principal;
     204: invokespecial #56                 // Method org/wildfly/extension/undertow/security/AccountImpl."<init>":(Ljava/security/Principal;Ljava/util/Set;Ljava/lang/Object;Ljava/security/Principal;)V
     207: areturn
     208: goto          223
     211: astore        8
     213: new           #58                 // class java/lang/RuntimeException
     216: dup
     217: aload         8
     219: invokespecial #59                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
     222: athrow
     223: aconst_null
     224: areturn
    Exception table:
       from    to  target type
          37   207   211   Class java/lang/Exception

  private java.security.Principal getPrincipal(javax.security.auth.Subject);
    Code:
       0: aconst_null
       1: astore_2
       2: aconst_null
       3: astore_3
       4: aload_1
       5: ifnull        147
       8: aload_1
       9: invokevirtual #60                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      12: astore        4
      14: aload         4
      16: ifnull        147
      19: aload         4
      21: invokeinterface #61,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
      26: ifne          147
      29: aload         4
      31: invokeinterface #62,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      36: astore        5
      38: aload         5
      40: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      45: ifeq          147
      48: aload         5
      50: invokeinterface #52,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      55: checkcast     #63                 // class java/security/Principal
      58: astore        6
      60: aload         6
      62: instanceof    #64                 // class java/security/acl/Group
      65: ifne          75
      68: aload_2
      69: ifnonnull     75
      72: aload         6
      74: astore_2
      75: aload         6
      77: instanceof    #64                 // class java/security/acl/Group
      80: ifeq          144
      83: ldc           #64                 // class java/security/acl/Group
      85: aload         6
      87: invokevirtual #65                 // Method java/lang/Class.cast:(Ljava/lang/Object;)Ljava/lang/Object;
      90: checkcast     #64                 // class java/security/acl/Group
      93: astore        7
      95: aload         7
      97: invokeinterface #66,  1           // InterfaceMethod java/security/acl/Group.getName:()Ljava/lang/String;
     102: ldc           #68                 // String CallerPrincipal
     104: invokevirtual #69                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     107: ifeq          144
     110: aload_3
     111: ifnonnull     144
     114: aload         7
     116: invokeinterface #70,  1           // InterfaceMethod java/security/acl/Group.members:()Ljava/util/Enumeration;
     121: astore        8
     123: aload         8
     125: invokeinterface #71,  1           // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
     130: ifeq          144
     133: aload         8
     135: invokeinterface #72,  1           // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
     140: checkcast     #63                 // class java/security/Principal
     143: astore_3
     144: goto          38
     147: aload_3
     148: ifnonnull     155
     151: aload_2
     152: goto          156
     155: aload_3
     156: areturn
}
