Compiled from "SecurityContextThreadSetupAction.java"
public class org.wildfly.extension.undertow.security.SecurityContextThreadSetupAction implements io.undertow.servlet.api.ThreadSetupAction {
  private final java.lang.String securityDomain;

  private final org.jboss.as.security.plugins.SecurityDomainContext securityDomainContext;

  private final java.util.Map<java.lang.String, java.util.Set<java.lang.String>> principleVsRoleMap;

  private static final io.undertow.servlet.api.ThreadSetupAction$Handle TEAR_DOWN_ACTION;

  private static final java.security.PrivilegedAction<java.lang.Object> TEAR_DOWN_PA;

  public org.wildfly.extension.undertow.security.SecurityContextThreadSetupAction(java.lang.String, org.jboss.as.security.plugins.SecurityDomainContext, java.util.Map<java.lang.String, java.util.Set<java.lang.String>>);
    Code:
       0: aload_0
       1: invokespecial #3                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #4                  // Field securityDomain:Ljava/lang/String;
       9: aload_0
      10: aload_2
      11: putfield      #5                  // Field securityDomainContext:Lorg/jboss/as/security/plugins/SecurityDomainContext;
      14: aload_0
      15: aload_3
      16: putfield      #1                  // Field principleVsRoleMap:Ljava/util/Map;
      19: return

  public io.undertow.servlet.api.ThreadSetupAction$Handle setup(io.undertow.server.HttpServerExchange);
    Code:
       0: aconst_null
       1: astore_2
       2: aload_1
       3: ifnull        17
       6: aload_1
       7: getstatic     #6                  // Field org/wildfly/extension/undertow/security/UndertowSecurityAttachments.SECURITY_CONTEXT_ATTACHMENT:Lio/undertow/util/AttachmentKey;
      10: invokevirtual #7                  // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
      13: checkcast     #8                  // class org/jboss/security/SecurityContext
      16: astore_2
      17: aload_2
      18: ifnonnull     42
      21: aload_0
      22: getfield      #4                  // Field securityDomain:Ljava/lang/String;
      25: invokestatic  #9                  // Method org/wildfly/extension/undertow/security/SecurityActions.createSecurityContext:(Ljava/lang/String;)Lorg/jboss/security/SecurityContext;
      28: astore_2
      29: aload_1
      30: ifnull        42
      33: aload_1
      34: getstatic     #6                  // Field org/wildfly/extension/undertow/security/UndertowSecurityAttachments.SECURITY_CONTEXT_ATTACHMENT:Lio/undertow/util/AttachmentKey;
      37: aload_2
      38: invokevirtual #10                 // Method io/undertow/server/HttpServerExchange.putAttachment:(Lio/undertow/util/AttachmentKey;Ljava/lang/Object;)Ljava/lang/Object;
      41: pop
      42: aload_2
      43: invokestatic  #11                 // Method org/wildfly/extension/undertow/security/SecurityActions.setSecurityContextOnAssociation:(Lorg/jboss/security/SecurityContext;)V
      46: aload_0
      47: getfield      #5                  // Field securityDomainContext:Lorg/jboss/as/security/plugins/SecurityDomainContext;
      50: invokevirtual #12                 // Method org/jboss/as/security/plugins/SecurityDomainContext.getMappingManager:()Lorg/jboss/security/mapping/MappingManager;
      53: astore_3
      54: aload_3
      55: ifnull        114
      58: invokestatic  #13                 // Method org/wildfly/security/manager/WildFlySecurityManager.isChecking:()Z
      61: ifeq          80
      64: new           #14                 // class org/wildfly/extension/undertow/security/SecurityContextThreadSetupAction$3
      67: dup
      68: aload_0
      69: aload_3
      70: invokespecial #15                 // Method org/wildfly/extension/undertow/security/SecurityContextThreadSetupAction$3."<init>":(Lorg/wildfly/extension/undertow/security/SecurityContextThreadSetupAction;Lorg/jboss/security/mapping/MappingManager;)V
      73: invokestatic  #16                 // Method org/wildfly/security/manager/WildFlySecurityManager.doUnchecked:(Ljava/security/PrivilegedAction;)Ljava/lang/Object;
      76: pop
      77: goto          114
      80: aload_3
      81: getstatic     #17                 // Field org/jboss/security/mapping/MappingType.ROLE:Lorg/jboss/security/mapping/MappingType;
      84: invokevirtual #18                 // Method org/jboss/security/mapping/MappingType.name:()Ljava/lang/String;
      87: invokeinterface #19,  2           // InterfaceMethod org/jboss/security/mapping/MappingManager.getMappingContext:(Ljava/lang/String;)Lorg/jboss/security/mapping/MappingContext;
      92: astore        4
      94: aload         4
      96: ifnull        114
      99: aload         4
     101: invokevirtual #20                 // Method org/jboss/security/mapping/MappingContext.hasModules:()Z
     104: ifeq          114
     107: aload_0
     108: getfield      #1                  // Field principleVsRoleMap:Ljava/util/Map;
     111: invokestatic  #21                 // Method org/jboss/security/SecurityRolesAssociation.setSecurityRoles:(Ljava/util/Map;)V
     114: getstatic     #22                 // Field TEAR_DOWN_ACTION:Lio/undertow/servlet/api/ThreadSetupAction$Handle;
     117: areturn

  static java.security.PrivilegedAction access$000();
    Code:
       0: getstatic     #2                  // Field TEAR_DOWN_PA:Ljava/security/PrivilegedAction;
       3: areturn

  static java.util.Map access$100(org.wildfly.extension.undertow.security.SecurityContextThreadSetupAction);
    Code:
       0: aload_0
       1: getfield      #1                  // Field principleVsRoleMap:Ljava/util/Map;
       4: areturn

  static {};
    Code:
       0: new           #23                 // class org/wildfly/extension/undertow/security/SecurityContextThreadSetupAction$1
       3: dup
       4: invokespecial #24                 // Method org/wildfly/extension/undertow/security/SecurityContextThreadSetupAction$1."<init>":()V
       7: putstatic     #22                 // Field TEAR_DOWN_ACTION:Lio/undertow/servlet/api/ThreadSetupAction$Handle;
      10: new           #25                 // class org/wildfly/extension/undertow/security/SecurityContextThreadSetupAction$2
      13: dup
      14: invokespecial #26                 // Method org/wildfly/extension/undertow/security/SecurityContextThreadSetupAction$2."<init>":()V
      17: putstatic     #2                  // Field TEAR_DOWN_PA:Ljava/security/PrivilegedAction;
      20: return
}
