public class org.bouncycastle.mail.smime.examples.SendSignedAndEncryptedMail {
  public org.bouncycastle.mail.smime.examples.SendSignedAndEncryptedMail();
    Code:
       0: aload_0
       1: invokespecial #323                // Method java/lang/Object."<init>":()V
       4: return

  public static void main(java.lang.String[]);
    Code:
       0: aload_0
       1: arraylength
       2: iconst_5
       3: if_icmpeq     18
       6: getstatic     #310                // Field java/lang/System.err:Ljava/io/PrintStream;
       9: ldc           #16                 // String usage: SendSignedAndEncryptedMail <pkcs12Keystore> <password> <keyalias> <smtp server> <email address>
      11: invokevirtual #320                // Method java/io/PrintStream.println:(Ljava/lang/String;)V
      14: iconst_0
      15: invokestatic  #330                // Method java/lang/System.exit:(I)V
      18: invokestatic  #341                // Method javax/activation/CommandMap.getDefaultCommandMap:()Ljavax/activation/CommandMap;
      21: checkcast     #158                // class javax/activation/MailcapCommandMap
      24: astore_1
      25: aload_1
      26: ldc           #7                  // String application/pkcs7-signature;; x-java-content-handler=org.bouncycastle.mail.smime.handlers.pkcs7_signature
      28: invokevirtual #343                // Method javax/activation/MailcapCommandMap.addMailcap:(Ljava/lang/String;)V
      31: aload_1
      32: ldc           #6                  // String application/pkcs7-mime;; x-java-content-handler=org.bouncycastle.mail.smime.handlers.pkcs7_mime
      34: invokevirtual #343                // Method javax/activation/MailcapCommandMap.addMailcap:(Ljava/lang/String;)V
      37: aload_1
      38: ldc           #9                  // String application/x-pkcs7-signature;; x-java-content-handler=org.bouncycastle.mail.smime.handlers.x_pkcs7_signature
      40: invokevirtual #343                // Method javax/activation/MailcapCommandMap.addMailcap:(Ljava/lang/String;)V
      43: aload_1
      44: ldc           #8                  // String application/x-pkcs7-mime;; x-java-content-handler=org.bouncycastle.mail.smime.handlers.x_pkcs7_mime
      46: invokevirtual #343                // Method javax/activation/MailcapCommandMap.addMailcap:(Ljava/lang/String;)V
      49: aload_1
      50: ldc           #14                 // String multipart/signed;; x-java-content-handler=org.bouncycastle.mail.smime.handlers.multipart_signed
      52: invokevirtual #343                // Method javax/activation/MailcapCommandMap.addMailcap:(Ljava/lang/String;)V
      55: aload_1
      56: invokestatic  #342                // Method javax/activation/CommandMap.setDefaultCommandMap:(Ljavax/activation/CommandMap;)V
      59: new           #179                // class org/bouncycastle/jce/provider/BouncyCastleProvider
      62: dup
      63: invokespecial #378                // Method org/bouncycastle/jce/provider/BouncyCastleProvider."<init>":()V
      66: invokestatic  #336                // Method java/security/Security.addProvider:(Ljava/security/Provider;)I
      69: pop
      70: ldc           #4                  // String PKCS12
      72: ldc           #1                  // String BC
      74: invokestatic  #335                // Method java/security/KeyStore.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/KeyStore;
      77: astore_2
      78: aload_2
      79: new           #141                // class java/io/FileInputStream
      82: dup
      83: aload_0
      84: iconst_0
      85: aaload
      86: invokespecial #319                // Method java/io/FileInputStream."<init>":(Ljava/lang/String;)V
      89: aload_0
      90: iconst_1
      91: aaload
      92: invokevirtual #324                // Method java/lang/String.toCharArray:()[C
      95: invokevirtual #332                // Method java/security/KeyStore.load:(Ljava/io/InputStream;[C)V
      98: aload_2
      99: aload_0
     100: iconst_2
     101: aaload
     102: invokevirtual #334                // Method java/security/KeyStore.getCertificateChain:(Ljava/lang/String;)[Ljava/security/cert/Certificate;
     105: astore_3
     106: aload_2
     107: aload_0
     108: iconst_2
     109: aaload
     110: aload_0
     111: iconst_1
     112: aaload
     113: invokevirtual #324                // Method java/lang/String.toCharArray:()[C
     116: invokevirtual #333                // Method java/security/KeyStore.getKey:(Ljava/lang/String;[C)Ljava/security/Key;
     119: checkcast     #150                // class java/security/PrivateKey
     122: astore        4
     124: aload         4
     126: ifnonnull     158
     129: new           #143                // class java/lang/Exception
     132: dup
     133: new           #146                // class java/lang/StringBuilder
     136: dup
     137: invokespecial #327                // Method java/lang/StringBuilder."<init>":()V
     140: ldc           #10                 // String cannot find private key for alias:
     142: invokevirtual #329                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     145: aload_0
     146: iconst_2
     147: aaload
     148: invokevirtual #329                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     151: invokevirtual #328                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     154: invokespecial #322                // Method java/lang/Exception."<init>":(Ljava/lang/String;)V
     157: athrow
     158: invokestatic  #331                // Method java/lang/System.getProperties:()Ljava/util/Properties;
     161: astore        5
     163: aload         5
     165: ldc           #13                 // String mail.smtp.host
     167: aload_0
     168: iconst_3
     169: aaload
     170: invokevirtual #340                // Method java/util/Properties.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     173: pop
     174: aload         5
     176: aconst_null
     177: invokestatic  #344                // Method javax/mail/Session.getDefaultInstance:(Ljava/util/Properties;Ljavax/mail/Authenticator;)Ljavax/mail/Session;
     180: astore        6
     182: new           #165                // class javax/mail/internet/MimeMessage
     185: dup
     186: aload         6
     188: invokespecial #354                // Method javax/mail/internet/MimeMessage."<init>":(Ljavax/mail/Session;)V
     191: astore        7
     193: aload         7
     195: new           #163                // class javax/mail/internet/InternetAddress
     198: dup
     199: aload_0
     200: iconst_4
     201: aaload
     202: invokespecial #346                // Method javax/mail/internet/InternetAddress."<init>":(Ljava/lang/String;)V
     205: invokevirtual #352                // Method javax/mail/internet/MimeMessage.setFrom:(Ljavax/mail/Address;)V
     208: aload         7
     210: getstatic     #311                // Field javax/mail/Message$RecipientType.TO:Ljavax/mail/Message$RecipientType;
     213: new           #163                // class javax/mail/internet/InternetAddress
     216: dup
     217: aload_0
     218: iconst_4
     219: aaload
     220: invokespecial #346                // Method javax/mail/internet/InternetAddress."<init>":(Ljava/lang/String;)V
     223: invokevirtual #357                // Method javax/mail/internet/MimeMessage.setRecipient:(Ljavax/mail/Message$RecipientType;Ljavax/mail/Address;)V
     226: aload         7
     228: ldc           #12                 // String example encrypted message
     230: invokevirtual #350                // Method javax/mail/internet/MimeMessage.setSubject:(Ljava/lang/String;)V
     233: aload         7
     235: ldc           #12                 // String example encrypted message
     237: ldc           #15                 // String text/plain
     239: invokevirtual #356                // Method javax/mail/internet/MimeMessage.setContent:(Ljava/lang/Object;Ljava/lang/String;)V
     242: aload         7
     244: invokevirtual #348                // Method javax/mail/internet/MimeMessage.saveChanges:()V
     247: new           #171                // class org/bouncycastle/asn1/smime/SMIMECapabilityVector
     250: dup
     251: invokespecial #363                // Method org/bouncycastle/asn1/smime/SMIMECapabilityVector."<init>":()V
     254: astore        8
     256: aload         8
     258: getstatic     #313                // Field org/bouncycastle/asn1/smime/SMIMECapability.dES_EDE3_CBC:Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;
     261: invokevirtual #364                // Method org/bouncycastle/asn1/smime/SMIMECapabilityVector.addCapability:(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;)V
     264: aload         8
     266: getstatic     #314                // Field org/bouncycastle/asn1/smime/SMIMECapability.rC2_CBC:Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;
     269: sipush        128
     272: invokevirtual #365                // Method org/bouncycastle/asn1/smime/SMIMECapabilityVector.addCapability:(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;I)V
     275: aload         8
     277: getstatic     #312                // Field org/bouncycastle/asn1/smime/SMIMECapability.dES_CBC:Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;
     280: invokevirtual #364                // Method org/bouncycastle/asn1/smime/SMIMECapabilityVector.addCapability:(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;)V
     283: new           #166                // class org/bouncycastle/asn1/ASN1EncodableVector
     286: dup
     287: invokespecial #358                // Method org/bouncycastle/asn1/ASN1EncodableVector."<init>":()V
     290: astore        9
     292: aload         9
     294: new           #172                // class org/bouncycastle/asn1/smime/SMIMEEncryptionKeyPreferenceAttribute
     297: dup
     298: new           #168                // class org/bouncycastle/asn1/cms/IssuerAndSerialNumber
     301: dup
     302: new           #173                // class org/bouncycastle/asn1/x500/X500Name
     305: dup
     306: aload_3
     307: iconst_0
     308: aaload
     309: checkcast     #152                // class java/security/cert/X509Certificate
     312: invokevirtual #338                // Method java/security/cert/X509Certificate.getIssuerDN:()Ljava/security/Principal;
     315: invokeinterface #389,  1          // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
     320: invokespecial #367                // Method org/bouncycastle/asn1/x500/X500Name."<init>":(Ljava/lang/String;)V
     323: aload_3
     324: iconst_0
     325: aaload
     326: checkcast     #152                // class java/security/cert/X509Certificate
     329: invokevirtual #337                // Method java/security/cert/X509Certificate.getSerialNumber:()Ljava/math/BigInteger;
     332: invokespecial #361                // Method org/bouncycastle/asn1/cms/IssuerAndSerialNumber."<init>":(Lorg/bouncycastle/asn1/x500/X500Name;Ljava/math/BigInteger;)V
     335: invokespecial #366                // Method org/bouncycastle/asn1/smime/SMIMEEncryptionKeyPreferenceAttribute."<init>":(Lorg/bouncycastle/asn1/cms/IssuerAndSerialNumber;)V
     338: invokevirtual #359                // Method org/bouncycastle/asn1/ASN1EncodableVector.add:(Lorg/bouncycastle/asn1/ASN1Encodable;)V
     341: aload         9
     343: new           #169                // class org/bouncycastle/asn1/smime/SMIMECapabilitiesAttribute
     346: dup
     347: aload         8
     349: invokespecial #362                // Method org/bouncycastle/asn1/smime/SMIMECapabilitiesAttribute."<init>":(Lorg/bouncycastle/asn1/smime/SMIMECapabilityVector;)V
     352: invokevirtual #359                // Method org/bouncycastle/asn1/ASN1EncodableVector.add:(Lorg/bouncycastle/asn1/ASN1Encodable;)V
     355: new           #182                // class org/bouncycastle/mail/smime/SMIMESignedGenerator
     358: dup
     359: invokespecial #384                // Method org/bouncycastle/mail/smime/SMIMESignedGenerator."<init>":()V
     362: astore        10
     364: aload         10
     366: new           #176                // class org/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder
     369: dup
     370: invokespecial #369                // Method org/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder."<init>":()V
     373: ldc           #1                  // String BC
     375: invokevirtual #370                // Method org/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder.setProvider:(Ljava/lang/String;)Lorg/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder;
     378: new           #167                // class org/bouncycastle/asn1/cms/AttributeTable
     381: dup
     382: aload         9
     384: invokespecial #360                // Method org/bouncycastle/asn1/cms/AttributeTable."<init>":(Lorg/bouncycastle/asn1/ASN1EncodableVector;)V
     387: invokevirtual #371                // Method org/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder.setSignedAttributeGenerator:(Lorg/bouncycastle/asn1/cms/AttributeTable;)Lorg/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder;
     390: ldc           #2                  // String DSA
     392: aload         4
     394: invokeinterface #390,  1          // InterfaceMethod java/security/PrivateKey.getAlgorithm:()Ljava/lang/String;
     399: invokevirtual #325                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     402: ifeq          410
     405: ldc           #5                  // String SHA1withDSA
     407: goto          412
     410: ldc           #3                  // String MD5withRSA
     412: aload         4
     414: aload_3
     415: iconst_0
     416: aaload
     417: checkcast     #152                // class java/security/cert/X509Certificate
     420: invokevirtual #372                // Method org/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder.build:(Ljava/lang/String;Ljava/security/PrivateKey;Ljava/security/cert/X509Certificate;)Lorg/bouncycastle/cms/SignerInfoGenerator;
     423: invokevirtual #385                // Method org/bouncycastle/mail/smime/SMIMESignedGenerator.addSignerInfoGenerator:(Lorg/bouncycastle/cms/SignerInfoGenerator;)V
     426: new           #153                // class java/util/ArrayList
     429: dup
     430: invokespecial #339                // Method java/util/ArrayList."<init>":()V
     433: astore        11
     435: aload         11
     437: aload_3
     438: iconst_0
     439: aaload
     440: invokeinterface #393,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     445: pop
     446: new           #174                // class org/bouncycastle/cert/jcajce/JcaCertStore
     449: dup
     450: aload         11
     452: invokespecial #368                // Method org/bouncycastle/cert/jcajce/JcaCertStore."<init>":(Ljava/util/Collection;)V
     455: astore        12
     457: aload         10
     459: aload         12
     461: invokevirtual #386                // Method org/bouncycastle/mail/smime/SMIMESignedGenerator.addCertificates:(Lorg/bouncycastle/util/Store;)V
     464: aload         10
     466: aload         7
     468: invokevirtual #387                // Method org/bouncycastle/mail/smime/SMIMESignedGenerator.generate:(Ljavax/mail/internet/MimeMessage;)Ljavax/mail/internet/MimeMultipart;
     471: astore        13
     473: new           #165                // class javax/mail/internet/MimeMessage
     476: dup
     477: aload         6
     479: invokespecial #354                // Method javax/mail/internet/MimeMessage."<init>":(Ljavax/mail/Session;)V
     482: astore        14
     484: aload         7
     486: invokevirtual #351                // Method javax/mail/internet/MimeMessage.getAllHeaderLines:()Ljava/util/Enumeration;
     489: astore        15
     491: aload         15
     493: invokeinterface #391,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
     498: ifeq          519
     501: aload         14
     503: aload         15
     505: invokeinterface #392,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
     510: checkcast     #145                // class java/lang/String
     513: invokevirtual #349                // Method javax/mail/internet/MimeMessage.addHeaderLine:(Ljava/lang/String;)V
     516: goto          491
     519: aload         14
     521: aload         13
     523: invokevirtual #353                // Method javax/mail/internet/MimeMessage.setContent:(Ljavax/mail/Multipart;)V
     526: aload         14
     528: invokevirtual #348                // Method javax/mail/internet/MimeMessage.saveChanges:()V
     531: new           #180                // class org/bouncycastle/mail/smime/SMIMEEnvelopedGenerator
     534: dup
     535: invokespecial #379                // Method org/bouncycastle/mail/smime/SMIMEEnvelopedGenerator."<init>":()V
     538: astore        16
     540: aload         16
     542: new           #178                // class org/bouncycastle/cms/jcajce/JceKeyTransRecipientInfoGenerator
     545: dup
     546: aload_3
     547: iconst_0
     548: aaload
     549: checkcast     #152                // class java/security/cert/X509Certificate
     552: invokespecial #376                // Method org/bouncycastle/cms/jcajce/JceKeyTransRecipientInfoGenerator."<init>":(Ljava/security/cert/X509Certificate;)V
     555: ldc           #1                  // String BC
     557: invokevirtual #377                // Method org/bouncycastle/cms/jcajce/JceKeyTransRecipientInfoGenerator.setProvider:(Ljava/lang/String;)Lorg/bouncycastle/cms/jcajce/JceKeyTransRecipientInfoGenerator;
     560: invokevirtual #380                // Method org/bouncycastle/mail/smime/SMIMEEnvelopedGenerator.addRecipientInfoGenerator:(Lorg/bouncycastle/cms/RecipientInfoGenerator;)V
     563: aload         16
     565: aload         14
     567: new           #177                // class org/bouncycastle/cms/jcajce/JceCMSContentEncryptorBuilder
     570: dup
     571: getstatic     #315                // Field org/bouncycastle/cms/CMSAlgorithm.RC2_CBC:Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;
     574: invokespecial #373                // Method org/bouncycastle/cms/jcajce/JceCMSContentEncryptorBuilder."<init>":(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;)V
     577: ldc           #1                  // String BC
     579: invokevirtual #375                // Method org/bouncycastle/cms/jcajce/JceCMSContentEncryptorBuilder.setProvider:(Ljava/lang/String;)Lorg/bouncycastle/cms/jcajce/JceCMSContentEncryptorBuilder;
     582: invokevirtual #374                // Method org/bouncycastle/cms/jcajce/JceCMSContentEncryptorBuilder.build:()Lorg/bouncycastle/operator/OutputEncryptor;
     585: invokevirtual #381                // Method org/bouncycastle/mail/smime/SMIMEEnvelopedGenerator.generate:(Ljavax/mail/internet/MimeMessage;Lorg/bouncycastle/operator/OutputEncryptor;)Ljavax/mail/internet/MimeBodyPart;
     588: astore        17
     590: new           #140                // class java/io/ByteArrayOutputStream
     593: dup
     594: invokespecial #317                // Method java/io/ByteArrayOutputStream."<init>":()V
     597: astore        18
     599: aload         17
     601: aload         18
     603: invokevirtual #347                // Method javax/mail/internet/MimeBodyPart.writeTo:(Ljava/io/OutputStream;)V
     606: new           #165                // class javax/mail/internet/MimeMessage
     609: dup
     610: aload         6
     612: new           #139                // class java/io/ByteArrayInputStream
     615: dup
     616: aload         18
     618: invokevirtual #318                // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     621: invokespecial #316                // Method java/io/ByteArrayInputStream."<init>":([B)V
     624: invokespecial #355                // Method javax/mail/internet/MimeMessage."<init>":(Ljavax/mail/Session;Ljava/io/InputStream;)V
     627: astore        19
     629: aload         7
     631: invokevirtual #351                // Method javax/mail/internet/MimeMessage.getAllHeaderLines:()Ljava/util/Enumeration;
     634: astore        15
     636: aload         15
     638: invokeinterface #391,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
     643: ifeq          681
     646: aload         15
     648: invokeinterface #392,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
     653: checkcast     #145                // class java/lang/String
     656: astore        20
     658: aload         20
     660: invokestatic  #388                // Method org/bouncycastle/util/Strings.toLowerCase:(Ljava/lang/String;)Ljava/lang/String;
     663: ldc           #11                 // String content-
     665: invokevirtual #326                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     668: ifne          678
     671: aload         19
     673: aload         20
     675: invokevirtual #349                // Method javax/mail/internet/MimeMessage.addHeaderLine:(Ljava/lang/String;)V
     678: goto          636
     681: aload         19
     683: invokestatic  #345                // Method javax/mail/Transport.send:(Ljavax/mail/Message;)V
     686: goto          718
     689: astore_1
     690: aload_1
     691: invokevirtual #383                // Method org/bouncycastle/mail/smime/SMIMEException.getUnderlyingException:()Ljava/lang/Exception;
     694: getstatic     #310                // Field java/lang/System.err:Ljava/io/PrintStream;
     697: invokevirtual #321                // Method java/lang/Exception.printStackTrace:(Ljava/io/PrintStream;)V
     700: aload_1
     701: getstatic     #310                // Field java/lang/System.err:Ljava/io/PrintStream;
     704: invokevirtual #382                // Method org/bouncycastle/mail/smime/SMIMEException.printStackTrace:(Ljava/io/PrintStream;)V
     707: goto          718
     710: astore_1
     711: aload_1
     712: getstatic     #310                // Field java/lang/System.err:Ljava/io/PrintStream;
     715: invokevirtual #321                // Method java/lang/Exception.printStackTrace:(Ljava/io/PrintStream;)V
     718: return
    Exception table:
       from    to  target type
          18   686   689   Class org/bouncycastle/mail/smime/SMIMEException
          18   686   710   Class java/lang/Exception
}
