public class org.bouncycastle.mail.smime.examples.CreateSignedMultipartMail {
  static int serialNo;

  public org.bouncycastle.mail.smime.examples.CreateSignedMultipartMail();
    Code:
       0: aload_0
       1: invokespecial #263                // Method java/lang/Object."<init>":()V
       4: return

  static java.security.cert.X509Certificate makeCertificate(java.security.KeyPair, java.lang.String, java.security.KeyPair, java.lang.String) throws java.security.GeneralSecurityException, java.io.IOException, org.bouncycastle.operator.OperatorCreationException;
    Code:
       0: aload_0
       1: invokevirtual #268                // Method java/security/KeyPair.getPublic:()Ljava/security/PublicKey;
       4: astore        4
       6: aload_2
       7: invokevirtual #267                // Method java/security/KeyPair.getPrivate:()Ljava/security/PrivateKey;
      10: astore        5
      12: aload_2
      13: invokevirtual #268                // Method java/security/KeyPair.getPublic:()Ljava/security/PublicKey;
      16: astore        6
      18: new           #146                // class org/bouncycastle/cert/jcajce/JcaX509ExtensionUtils
      21: dup
      22: invokespecial #307                // Method org/bouncycastle/cert/jcajce/JcaX509ExtensionUtils."<init>":()V
      25: astore        7
      27: new           #147                // class org/bouncycastle/cert/jcajce/JcaX509v3CertificateBuilder
      30: dup
      31: new           #141                // class org/bouncycastle/asn1/x500/X500Name
      34: dup
      35: aload_3
      36: invokespecial #300                // Method org/bouncycastle/asn1/x500/X500Name."<init>":(Ljava/lang/String;)V
      39: getstatic     #261                // Field serialNo:I
      42: dup
      43: iconst_1
      44: iadd
      45: putstatic     #261                // Field serialNo:I
      48: i2l
      49: invokestatic  #266                // Method java/math/BigInteger.valueOf:(J)Ljava/math/BigInteger;
      52: new           #125                // class java/util/Date
      55: dup
      56: invokestatic  #264                // Method java/lang/System.currentTimeMillis:()J
      59: invokespecial #275                // Method java/util/Date."<init>":(J)V
      62: new           #125                // class java/util/Date
      65: dup
      66: invokestatic  #264                // Method java/lang/System.currentTimeMillis:()J
      69: ldc2_w        #111                // long 8640000000l
      72: ladd
      73: invokespecial #275                // Method java/util/Date."<init>":(J)V
      76: new           #141                // class org/bouncycastle/asn1/x500/X500Name
      79: dup
      80: aload_1
      81: invokespecial #300                // Method org/bouncycastle/asn1/x500/X500Name."<init>":(Ljava/lang/String;)V
      84: aload         4
      86: invokespecial #310                // Method org/bouncycastle/cert/jcajce/JcaX509v3CertificateBuilder."<init>":(Lorg/bouncycastle/asn1/x500/X500Name;Ljava/math/BigInteger;Ljava/util/Date;Ljava/util/Date;Lorg/bouncycastle/asn1/x500/X500Name;Ljava/security/PublicKey;)V
      89: astore        8
      91: aload         8
      93: getstatic     #260                // Field org/bouncycastle/asn1/x509/X509Extension.subjectKeyIdentifier:Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;
      96: iconst_0
      97: aload         7
      99: aload         4
     101: invokevirtual #309                // Method org/bouncycastle/cert/jcajce/JcaX509ExtensionUtils.createSubjectKeyIdentifier:(Ljava/security/PublicKey;)Lorg/bouncycastle/asn1/x509/SubjectKeyIdentifier;
     104: invokevirtual #302                // Method org/bouncycastle/cert/X509v3CertificateBuilder.addExtension:(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;ZLorg/bouncycastle/asn1/ASN1Encodable;)Lorg/bouncycastle/cert/X509v3CertificateBuilder;
     107: pop
     108: aload         8
     110: getstatic     #259                // Field org/bouncycastle/asn1/x509/X509Extension.authorityKeyIdentifier:Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;
     113: iconst_0
     114: aload         7
     116: aload         6
     118: invokevirtual #308                // Method org/bouncycastle/cert/jcajce/JcaX509ExtensionUtils.createAuthorityKeyIdentifier:(Ljava/security/PublicKey;)Lorg/bouncycastle/asn1/x509/AuthorityKeyIdentifier;
     121: invokevirtual #302                // Method org/bouncycastle/cert/X509v3CertificateBuilder.addExtension:(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;ZLorg/bouncycastle/asn1/ASN1Encodable;)Lorg/bouncycastle/cert/X509v3CertificateBuilder;
     124: pop
     125: new           #145                // class org/bouncycastle/cert/jcajce/JcaX509CertificateConverter
     128: dup
     129: invokespecial #304                // Method org/bouncycastle/cert/jcajce/JcaX509CertificateConverter."<init>":()V
     132: ldc           #2                  // String BC
     134: invokevirtual #306                // Method org/bouncycastle/cert/jcajce/JcaX509CertificateConverter.setProvider:(Ljava/lang/String;)Lorg/bouncycastle/cert/jcajce/JcaX509CertificateConverter;
     137: aload         8
     139: new           #152                // class org/bouncycastle/operator/jcajce/JcaContentSignerBuilder
     142: dup
     143: ldc           #6                  // String MD5withRSA
     145: invokespecial #320                // Method org/bouncycastle/operator/jcajce/JcaContentSignerBuilder."<init>":(Ljava/lang/String;)V
     148: ldc           #2                  // String BC
     150: invokevirtual #322                // Method org/bouncycastle/operator/jcajce/JcaContentSignerBuilder.setProvider:(Ljava/lang/String;)Lorg/bouncycastle/operator/jcajce/JcaContentSignerBuilder;
     153: aload         5
     155: invokevirtual #321                // Method org/bouncycastle/operator/jcajce/JcaContentSignerBuilder.build:(Ljava/security/PrivateKey;)Lorg/bouncycastle/operator/ContentSigner;
     158: invokevirtual #301                // Method org/bouncycastle/cert/X509v3CertificateBuilder.build:(Lorg/bouncycastle/operator/ContentSigner;)Lorg/bouncycastle/cert/X509CertificateHolder;
     161: invokevirtual #305                // Method org/bouncycastle/cert/jcajce/JcaX509CertificateConverter.getCertificate:(Lorg/bouncycastle/cert/X509CertificateHolder;)Ljava/security/cert/X509Certificate;
     164: areturn

  public static void main(java.lang.String[]) throws java.lang.Exception;
    Code:
       0: ldc           #8                  // String RSA
       2: ldc           #2                  // String BC
       4: invokestatic  #271                // Method java/security/KeyPairGenerator.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/KeyPairGenerator;
       7: astore_1
       8: aload_1
       9: sipush        1024
      12: new           #122                // class java/security/SecureRandom
      15: dup
      16: invokespecial #272                // Method java/security/SecureRandom."<init>":()V
      19: invokevirtual #270                // Method java/security/KeyPairGenerator.initialize:(ILjava/security/SecureRandom;)V
      22: ldc           #7                  // String O=Bouncy Castle, C=AU
      24: astore_2
      25: aload_1
      26: invokevirtual #269                // Method java/security/KeyPairGenerator.generateKeyPair:()Ljava/security/KeyPair;
      29: astore_3
      30: aload_3
      31: aload_2
      32: aload_3
      33: aload_2
      34: invokestatic  #319                // Method makeCertificate:(Ljava/security/KeyPair;Ljava/lang/String;Ljava/security/KeyPair;Ljava/lang/String;)Ljava/security/cert/X509Certificate;
      37: astore        4
      39: ldc           #3                  // String CN=Eric H. Echidna, E=eric@bouncycastle.org, O=Bouncy Castle, C=AU
      41: astore        5
      43: aload_1
      44: invokevirtual #269                // Method java/security/KeyPairGenerator.generateKeyPair:()Ljava/security/KeyPair;
      47: astore        6
      49: aload         6
      51: aload         5
      53: aload_3
      54: aload_2
      55: invokestatic  #319                // Method makeCertificate:(Ljava/security/KeyPair;Ljava/lang/String;Ljava/security/KeyPair;Ljava/lang/String;)Ljava/security/cert/X509Certificate;
      58: astore        7
      60: new           #124                // class java/util/ArrayList
      63: dup
      64: invokespecial #274                // Method java/util/ArrayList."<init>":()V
      67: astore        8
      69: aload         8
      71: aload         7
      73: invokeinterface #323,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      78: pop
      79: aload         8
      81: aload         4
      83: invokeinterface #323,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      88: pop
      89: new           #144                // class org/bouncycastle/cert/jcajce/JcaCertStore
      92: dup
      93: aload         8
      95: invokespecial #303                // Method org/bouncycastle/cert/jcajce/JcaCertStore."<init>":(Ljava/util/Collection;)V
      98: astore        9
     100: new           #134                // class org/bouncycastle/asn1/ASN1EncodableVector
     103: dup
     104: invokespecial #291                // Method org/bouncycastle/asn1/ASN1EncodableVector."<init>":()V
     107: astore        10
     109: new           #139                // class org/bouncycastle/asn1/smime/SMIMECapabilityVector
     112: dup
     113: invokespecial #296                // Method org/bouncycastle/asn1/smime/SMIMECapabilityVector."<init>":()V
     116: astore        11
     118: aload         11
     120: getstatic     #257                // Field org/bouncycastle/asn1/smime/SMIMECapability.dES_EDE3_CBC:Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;
     123: invokevirtual #297                // Method org/bouncycastle/asn1/smime/SMIMECapabilityVector.addCapability:(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;)V
     126: aload         11
     128: getstatic     #258                // Field org/bouncycastle/asn1/smime/SMIMECapability.rC2_CBC:Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;
     131: sipush        128
     134: invokevirtual #298                // Method org/bouncycastle/asn1/smime/SMIMECapabilityVector.addCapability:(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;I)V
     137: aload         11
     139: getstatic     #256                // Field org/bouncycastle/asn1/smime/SMIMECapability.dES_CBC:Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;
     142: invokevirtual #297                // Method org/bouncycastle/asn1/smime/SMIMECapabilityVector.addCapability:(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;)V
     145: aload         10
     147: new           #137                // class org/bouncycastle/asn1/smime/SMIMECapabilitiesAttribute
     150: dup
     151: aload         11
     153: invokespecial #295                // Method org/bouncycastle/asn1/smime/SMIMECapabilitiesAttribute."<init>":(Lorg/bouncycastle/asn1/smime/SMIMECapabilityVector;)V
     156: invokevirtual #292                // Method org/bouncycastle/asn1/ASN1EncodableVector.add:(Lorg/bouncycastle/asn1/ASN1Encodable;)V
     159: new           #136                // class org/bouncycastle/asn1/cms/IssuerAndSerialNumber
     162: dup
     163: new           #141                // class org/bouncycastle/asn1/x500/X500Name
     166: dup
     167: aload_2
     168: invokespecial #300                // Method org/bouncycastle/asn1/x500/X500Name."<init>":(Ljava/lang/String;)V
     171: aload         7
     173: invokevirtual #273                // Method java/security/cert/X509Certificate.getSerialNumber:()Ljava/math/BigInteger;
     176: invokespecial #294                // Method org/bouncycastle/asn1/cms/IssuerAndSerialNumber."<init>":(Lorg/bouncycastle/asn1/x500/X500Name;Ljava/math/BigInteger;)V
     179: astore        12
     181: aload         10
     183: new           #140                // class org/bouncycastle/asn1/smime/SMIMEEncryptionKeyPreferenceAttribute
     186: dup
     187: aload         12
     189: invokespecial #299                // Method org/bouncycastle/asn1/smime/SMIMEEncryptionKeyPreferenceAttribute."<init>":(Lorg/bouncycastle/asn1/cms/IssuerAndSerialNumber;)V
     192: invokevirtual #292                // Method org/bouncycastle/asn1/ASN1EncodableVector.add:(Lorg/bouncycastle/asn1/ASN1Encodable;)V
     195: new           #149                // class org/bouncycastle/mail/smime/SMIMESignedGenerator
     198: dup
     199: invokespecial #315                // Method org/bouncycastle/mail/smime/SMIMESignedGenerator."<init>":()V
     202: astore        13
     204: aload         13
     206: new           #148                // class org/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder
     209: dup
     210: invokespecial #311                // Method org/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder."<init>":()V
     213: ldc           #2                  // String BC
     215: invokevirtual #312                // Method org/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder.setProvider:(Ljava/lang/String;)Lorg/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder;
     218: new           #135                // class org/bouncycastle/asn1/cms/AttributeTable
     221: dup
     222: aload         10
     224: invokespecial #293                // Method org/bouncycastle/asn1/cms/AttributeTable."<init>":(Lorg/bouncycastle/asn1/ASN1EncodableVector;)V
     227: invokevirtual #313                // Method org/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder.setSignedAttributeGenerator:(Lorg/bouncycastle/asn1/cms/AttributeTable;)Lorg/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder;
     230: ldc           #9                  // String SHA1withRSA
     232: aload         6
     234: invokevirtual #267                // Method java/security/KeyPair.getPrivate:()Ljava/security/PrivateKey;
     237: aload         7
     239: invokevirtual #314                // Method org/bouncycastle/cms/jcajce/JcaSimpleSignerInfoGeneratorBuilder.build:(Ljava/lang/String;Ljava/security/PrivateKey;Ljava/security/cert/X509Certificate;)Lorg/bouncycastle/cms/SignerInfoGenerator;
     242: invokevirtual #316                // Method org/bouncycastle/mail/smime/SMIMESignedGenerator.addSignerInfoGenerator:(Lorg/bouncycastle/cms/SignerInfoGenerator;)V
     245: aload         13
     247: aload         9
     249: invokevirtual #317                // Method org/bouncycastle/mail/smime/SMIMESignedGenerator.addCertificates:(Lorg/bouncycastle/util/Store;)V
     252: new           #131                // class javax/mail/internet/MimeBodyPart
     255: dup
     256: invokespecial #278                // Method javax/mail/internet/MimeBodyPart."<init>":()V
     259: astore        14
     261: aload         14
     263: ldc           #4                  // String Hello part 1!
     265: invokevirtual #279                // Method javax/mail/internet/MimeBodyPart.setText:(Ljava/lang/String;)V
     268: new           #131                // class javax/mail/internet/MimeBodyPart
     271: dup
     272: invokespecial #278                // Method javax/mail/internet/MimeBodyPart."<init>":()V
     275: astore        15
     277: aload         15
     279: ldc           #5                  // String Hello part 2!
     281: invokevirtual #279                // Method javax/mail/internet/MimeBodyPart.setText:(Ljava/lang/String;)V
     284: new           #133                // class javax/mail/internet/MimeMultipart
     287: dup
     288: invokespecial #288                // Method javax/mail/internet/MimeMultipart."<init>":()V
     291: astore        16
     293: aload         16
     295: aload         14
     297: invokevirtual #290                // Method javax/mail/internet/MimeMultipart.addBodyPart:(Ljavax/mail/BodyPart;)V
     300: aload         16
     302: aload         15
     304: invokevirtual #290                // Method javax/mail/internet/MimeMultipart.addBodyPart:(Ljavax/mail/BodyPart;)V
     307: new           #131                // class javax/mail/internet/MimeBodyPart
     310: dup
     311: invokespecial #278                // Method javax/mail/internet/MimeBodyPart."<init>":()V
     314: astore        17
     316: aload         17
     318: aload         16
     320: invokevirtual #280                // Method javax/mail/internet/MimeBodyPart.setContent:(Ljavax/mail/Multipart;)V
     323: aload         13
     325: aload         17
     327: invokevirtual #318                // Method org/bouncycastle/mail/smime/SMIMESignedGenerator.generate:(Ljavax/mail/internet/MimeBodyPart;)Ljavax/mail/internet/MimeMultipart;
     330: astore        18
     332: invokestatic  #265                // Method java/lang/System.getProperties:()Ljava/util/Properties;
     335: astore        19
     337: aload         19
     339: aconst_null
     340: invokestatic  #276                // Method javax/mail/Session.getDefaultInstance:(Ljava/util/Properties;Ljavax/mail/Authenticator;)Ljavax/mail/Session;
     343: astore        20
     345: new           #130                // class javax/mail/internet/InternetAddress
     348: dup
     349: ldc           #1                  // String \"Eric H. Echidna\"<eric@bouncycastle.org>
     351: invokespecial #277                // Method javax/mail/internet/InternetAddress."<init>":(Ljava/lang/String;)V
     354: astore        21
     356: new           #130                // class javax/mail/internet/InternetAddress
     359: dup
     360: ldc           #11                 // String example@bouncycastle.org
     362: invokespecial #277                // Method javax/mail/internet/InternetAddress."<init>":(Ljava/lang/String;)V
     365: astore        22
     367: new           #132                // class javax/mail/internet/MimeMessage
     370: dup
     371: aload         20
     373: invokespecial #285                // Method javax/mail/internet/MimeMessage."<init>":(Ljavax/mail/Session;)V
     376: astore        23
     378: aload         23
     380: aload         21
     382: invokevirtual #284                // Method javax/mail/internet/MimeMessage.setFrom:(Ljavax/mail/Address;)V
     385: aload         23
     387: getstatic     #255                // Field javax/mail/Message$RecipientType.TO:Ljavax/mail/Message$RecipientType;
     390: aload         22
     392: invokevirtual #287                // Method javax/mail/internet/MimeMessage.setRecipient:(Ljavax/mail/Message$RecipientType;Ljavax/mail/Address;)V
     395: aload         23
     397: ldc           #10                 // String example signed message
     399: invokevirtual #283                // Method javax/mail/internet/MimeMessage.setSubject:(Ljava/lang/String;)V
     402: aload         23
     404: aload         18
     406: aload         18
     408: invokevirtual #289                // Method javax/mail/internet/MimeMultipart.getContentType:()Ljava/lang/String;
     411: invokevirtual #286                // Method javax/mail/internet/MimeMessage.setContent:(Ljava/lang/Object;Ljava/lang/String;)V
     414: aload         23
     416: invokevirtual #281                // Method javax/mail/internet/MimeMessage.saveChanges:()V
     419: aload         23
     421: new           #113                // class java/io/FileOutputStream
     424: dup
     425: ldc           #12                 // String signed.message
     427: invokespecial #262                // Method java/io/FileOutputStream."<init>":(Ljava/lang/String;)V
     430: invokevirtual #282                // Method javax/mail/internet/MimeMessage.writeTo:(Ljava/io/OutputStream;)V
     433: return

  static {};
    Code:
       0: iconst_1
       1: putstatic     #261                // Field serialNo:I
       4: return
}
