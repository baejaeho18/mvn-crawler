public class org.bouncycastle.crypto.tls.TlsServerProtocol extends org.bouncycastle.crypto.tls.TlsProtocol {
  protected org.bouncycastle.crypto.tls.TlsServer tlsServer;

  org.bouncycastle.crypto.tls.TlsServerContextImpl tlsServerContext;

  protected org.bouncycastle.crypto.tls.TlsKeyExchange keyExchange;

  protected org.bouncycastle.crypto.tls.TlsCredentials serverCredentials;

  protected org.bouncycastle.crypto.tls.CertificateRequest certificateRequest;

  protected short clientCertificateType;

  protected org.bouncycastle.crypto.tls.TlsHandshakeHash prepareFinishHash;

  public org.bouncycastle.crypto.tls.TlsServerProtocol(java.io.InputStream, java.io.OutputStream, java.security.SecureRandom);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: invokespecial #605                // Method org/bouncycastle/crypto/tls/TlsProtocol."<init>":(Ljava/io/InputStream;Ljava/io/OutputStream;Ljava/security/SecureRandom;)V
       7: aload_0
       8: aconst_null
       9: putfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      12: aload_0
      13: aconst_null
      14: putfield      #560                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
      17: aload_0
      18: aconst_null
      19: putfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      22: aload_0
      23: aconst_null
      24: putfield      #556                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
      27: aload_0
      28: aconst_null
      29: putfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      32: aload_0
      33: iconst_m1
      34: putfield      #540                // Field clientCertificateType:S
      37: aload_0
      38: aconst_null
      39: putfield      #557                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      42: return

  public void accept(org.bouncycastle.crypto.tls.TlsServer) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #234                // class java/lang/IllegalArgumentException
       7: dup
       8: ldc           #2                  // String \'tlsServer\' cannot be null
      10: invokespecial #563                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      13: athrow
      14: aload_0
      15: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      18: ifnull        31
      21: new           #235                // class java/lang/IllegalStateException
      24: dup
      25: ldc           #1                  // String \'accept\' can only be called once
      27: invokespecial #565                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      30: athrow
      31: aload_0
      32: aload_1
      33: putfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      36: aload_0
      37: new           #247                // class org/bouncycastle/crypto/tls/SecurityParameters
      40: dup
      41: invokespecial #593                // Method org/bouncycastle/crypto/tls/SecurityParameters."<init>":()V
      44: putfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      47: aload_0
      48: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      51: iconst_0
      52: putfield      #527                // Field org/bouncycastle/crypto/tls/SecurityParameters.entity:I
      55: aload_0
      56: new           #259                // class org/bouncycastle/crypto/tls/TlsServerContextImpl
      59: dup
      60: aload_0
      61: getfield      #549                // Field secureRandom:Ljava/security/SecureRandom;
      64: aload_0
      65: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      68: invokespecial #611                // Method org/bouncycastle/crypto/tls/TlsServerContextImpl."<init>":(Ljava/security/SecureRandom;Lorg/bouncycastle/crypto/tls/SecurityParameters;)V
      71: putfield      #560                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
      74: aload_0
      75: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      78: aload_1
      79: invokeinterface #686,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.shouldUseGMTUnixTime:()Z
      84: aload_0
      85: getfield      #560                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
      88: invokevirtual #610                // Method org/bouncycastle/crypto/tls/TlsServerContextImpl.getNonceRandomGenerator:()Lorg/bouncycastle/crypto/prng/RandomGenerator;
      91: invokestatic  #628                // Method createRandomBlock:(ZLorg/bouncycastle/crypto/prng/RandomGenerator;)[B
      94: putfield      #536                // Field org/bouncycastle/crypto/tls/SecurityParameters.serverRandom:[B
      97: aload_0
      98: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     101: aload_0
     102: getfield      #560                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
     105: invokeinterface #703,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.init:(Lorg/bouncycastle/crypto/tls/TlsServerContext;)V
     110: aload_0
     111: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     114: aload_0
     115: getfield      #560                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
     118: invokevirtual #588                // Method org/bouncycastle/crypto/tls/RecordStream.init:(Lorg/bouncycastle/crypto/tls/TlsContext;)V
     121: aload_0
     122: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     125: iconst_0
     126: invokevirtual #585                // Method org/bouncycastle/crypto/tls/RecordStream.setRestrictReadVersion:(Z)V
     129: aload_0
     130: invokevirtual #612                // Method completeHandshake:()V
     133: return

  protected void cleanupHandshake();
    Code:
       0: aload_0
       1: invokespecial #603                // Method org/bouncycastle/crypto/tls/TlsProtocol.cleanupHandshake:()V
       4: aload_0
       5: aconst_null
       6: putfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
       9: aload_0
      10: aconst_null
      11: putfield      #556                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
      14: aload_0
      15: aconst_null
      16: putfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      19: aload_0
      20: aconst_null
      21: putfield      #557                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      24: return

  protected org.bouncycastle.crypto.tls.TlsContext getContext();
    Code:
       0: aload_0
       1: getfield      #560                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
       4: areturn

  org.bouncycastle.crypto.tls.AbstractTlsContext getContextAdmin();
    Code:
       0: aload_0
       1: getfield      #560                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
       4: areturn

  protected org.bouncycastle.crypto.tls.TlsPeer getPeer();
    Code:
       0: aload_0
       1: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
       4: areturn

  protected void handleHandshakeMessage(short, byte[]) throws java.io.IOException;
    Code:
       0: new           #231                // class java/io/ByteArrayInputStream
       3: dup
       4: aload_2
       5: invokespecial #562                // Method java/io/ByteArrayInputStream."<init>":([B)V
       8: astore_3
       9: iload_1
      10: tableswitch   { // 0 to 23
                     0: 927
                     1: 120
                     2: 927
                     3: 927
                     4: 927
                     5: 927
                     6: 927
                     7: 927
                     8: 927
                     9: 927
                    10: 927
                    11: 528
                    12: 927
                    13: 927
                    14: 927
                    15: 747
                    16: 611
                    17: 927
                    18: 927
                    19: 927
                    20: 809
                    21: 927
                    22: 927
                    23: 472
               default: 927
          }
     120: aload_0
     121: getfield      #541                // Field connection_state:S
     124: lookupswitch  { // 1
                     0: 144
               default: 462
          }
     144: aload_0
     145: aload_3
     146: invokevirtual #625                // Method receiveClientHelloMessage:(Ljava/io/ByteArrayInputStream;)V
     149: aload_0
     150: iconst_1
     151: putfield      #541                // Field connection_state:S
     154: aload_0
     155: invokevirtual #616                // Method sendServerHelloMessage:()V
     158: aload_0
     159: iconst_2
     160: putfield      #541                // Field connection_state:S
     163: aload_0
     164: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     167: invokeinterface #693,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getServerSupplementalData:()Ljava/util/Vector;
     172: astore        4
     174: aload         4
     176: ifnull        185
     179: aload_0
     180: aload         4
     182: invokevirtual #627                // Method sendSupplementalDataMessage:(Ljava/util/Vector;)V
     185: aload_0
     186: iconst_3
     187: putfield      #541                // Field connection_state:S
     190: aload_0
     191: aload_0
     192: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     195: invokeinterface #702,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getKeyExchange:()Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     200: putfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     203: aload_0
     204: getfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     207: aload_0
     208: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     211: invokeinterface #680,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.init:(Lorg/bouncycastle/crypto/tls/TlsContext;)V
     216: aload_0
     217: aload_0
     218: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     221: invokeinterface #701,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getCredentials:()Lorg/bouncycastle/crypto/tls/TlsCredentials;
     226: putfield      #556                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     229: aconst_null
     230: astore        5
     232: aload_0
     233: getfield      #556                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     236: ifnonnull     251
     239: aload_0
     240: getfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     243: invokeinterface #675,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.skipServerCredentials:()V
     248: goto          281
     251: aload_0
     252: getfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     255: aload_0
     256: getfield      #556                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     259: invokeinterface #681,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.processServerCredentials:(Lorg/bouncycastle/crypto/tls/TlsCredentials;)V
     264: aload_0
     265: getfield      #556                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     268: invokeinterface #671,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsCredentials.getCertificate:()Lorg/bouncycastle/crypto/tls/Certificate;
     273: astore        5
     275: aload_0
     276: aload         5
     278: invokevirtual #631                // Method sendCertificateMessage:(Lorg/bouncycastle/crypto/tls/Certificate;)V
     281: aload_0
     282: iconst_4
     283: putfield      #541                // Field connection_state:S
     286: aload         5
     288: ifnull        299
     291: aload         5
     293: invokevirtual #570                // Method org/bouncycastle/crypto/tls/Certificate.isEmpty:()Z
     296: ifeq          304
     299: aload_0
     300: iconst_0
     301: putfield      #542                // Field allowCertificateStatus:Z
     304: aload_0
     305: getfield      #542                // Field allowCertificateStatus:Z
     308: ifeq          333
     311: aload_0
     312: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     315: invokeinterface #697,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getCertificateStatus:()Lorg/bouncycastle/crypto/tls/CertificateStatus;
     320: astore        6
     322: aload         6
     324: ifnull        333
     327: aload_0
     328: aload         6
     330: invokevirtual #633                // Method sendCertificateStatusMessage:(Lorg/bouncycastle/crypto/tls/CertificateStatus;)V
     333: aload_0
     334: iconst_5
     335: putfield      #541                // Field connection_state:S
     338: aload_0
     339: getfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     342: invokeinterface #676,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.generateServerKeyExchange:()[B
     347: astore        6
     349: aload         6
     351: ifnull        360
     354: aload_0
     355: aload         6
     357: invokevirtual #618                // Method sendServerKeyExchangeMessage:([B)V
     360: aload_0
     361: bipush        6
     363: putfield      #541                // Field connection_state:S
     366: aload_0
     367: getfield      #556                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     370: ifnull        431
     373: aload_0
     374: aload_0
     375: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     378: invokeinterface #696,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getCertificateRequest:()Lorg/bouncycastle/crypto/tls/CertificateRequest;
     383: putfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     386: aload_0
     387: getfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     390: ifnull        431
     393: aload_0
     394: getfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     397: aload_0
     398: getfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     401: invokeinterface #679,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.validateCertificateRequest:(Lorg/bouncycastle/crypto/tls/CertificateRequest;)V
     406: aload_0
     407: aload_0
     408: getfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     411: invokevirtual #632                // Method sendCertificateRequestMessage:(Lorg/bouncycastle/crypto/tls/CertificateRequest;)V
     414: aload_0
     415: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     418: invokevirtual #589                // Method org/bouncycastle/crypto/tls/RecordStream.getHandshakeHash:()Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
     421: aload_0
     422: getfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     425: invokevirtual #574                // Method org/bouncycastle/crypto/tls/CertificateRequest.getSupportedSignatureAlgorithms:()Ljava/util/Vector;
     428: invokestatic  #663                // Method org/bouncycastle/crypto/tls/TlsUtils.trackHashAlgorithms:(Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;Ljava/util/Vector;)V
     431: aload_0
     432: bipush        7
     434: putfield      #541                // Field connection_state:S
     437: aload_0
     438: invokevirtual #615                // Method sendServerHelloDoneMessage:()V
     441: aload_0
     442: bipush        8
     444: putfield      #541                // Field connection_state:S
     447: aload_0
     448: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     451: invokevirtual #589                // Method org/bouncycastle/crypto/tls/RecordStream.getHandshakeHash:()Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
     454: invokeinterface #672,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsHandshakeHash.sealHashAlgorithms:()V
     459: goto          937
     462: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     465: dup
     466: bipush        10
     468: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     471: athrow
     472: aload_0
     473: getfield      #541                // Field connection_state:S
     476: lookupswitch  { // 1
                     8: 496
               default: 518
          }
     496: aload_0
     497: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     500: aload_3
     501: invokestatic  #641                // Method readSupplementalDataMessage:(Ljava/io/ByteArrayInputStream;)Ljava/util/Vector;
     504: invokeinterface #694,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientSupplementalData:(Ljava/util/Vector;)V
     509: aload_0
     510: bipush        9
     512: putfield      #541                // Field connection_state:S
     515: goto          937
     518: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     521: dup
     522: bipush        10
     524: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     527: athrow
     528: aload_0
     529: getfield      #541                // Field connection_state:S
     532: lookupswitch  { // 2
                     8: 560
                     9: 570
               default: 601
          }
     560: aload_0
     561: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     564: aconst_null
     565: invokeinterface #694,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientSupplementalData:(Ljava/util/Vector;)V
     570: aload_0
     571: getfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     574: ifnonnull     587
     577: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     580: dup
     581: bipush        10
     583: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     586: athrow
     587: aload_0
     588: aload_3
     589: invokevirtual #623                // Method receiveCertificateMessage:(Ljava/io/ByteArrayInputStream;)V
     592: aload_0
     593: bipush        10
     595: putfield      #541                // Field connection_state:S
     598: goto          937
     601: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     604: dup
     605: bipush        10
     607: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     610: athrow
     611: aload_0
     612: getfield      #541                // Field connection_state:S
     615: tableswitch   { // 8 to 10
                     8: 640
                     9: 650
                    10: 723
               default: 737
          }
     640: aload_0
     641: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     644: aconst_null
     645: invokeinterface #694,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientSupplementalData:(Ljava/util/Vector;)V
     650: aload_0
     651: getfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     654: ifnonnull     669
     657: aload_0
     658: getfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     661: invokeinterface #674,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.skipClientCredentials:()V
     666: goto          723
     669: aload_0
     670: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     673: invokestatic  #658                // Method org/bouncycastle/crypto/tls/TlsUtils.isTLSv12:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
     676: ifeq          689
     679: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     682: dup
     683: bipush        10
     685: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     688: athrow
     689: aload_0
     690: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     693: invokestatic  #657                // Method org/bouncycastle/crypto/tls/TlsUtils.isSSL:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
     696: ifeq          716
     699: aload_0
     700: getfield      #552                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
     703: ifnonnull     723
     706: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     709: dup
     710: bipush        10
     712: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     715: athrow
     716: aload_0
     717: getstatic     #525                // Field org/bouncycastle/crypto/tls/Certificate.EMPTY_CHAIN:Lorg/bouncycastle/crypto/tls/Certificate;
     720: invokevirtual #630                // Method notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
     723: aload_0
     724: aload_3
     725: invokevirtual #626                // Method receiveClientKeyExchangeMessage:(Ljava/io/ByteArrayInputStream;)V
     728: aload_0
     729: bipush        11
     731: putfield      #541                // Field connection_state:S
     734: goto          937
     737: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     740: dup
     741: bipush        10
     743: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     746: athrow
     747: aload_0
     748: getfield      #541                // Field connection_state:S
     751: lookupswitch  { // 1
                    11: 768
               default: 799
          }
     768: aload_0
     769: invokevirtual #617                // Method expectCertificateVerifyMessage:()Z
     772: ifne          785
     775: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     778: dup
     779: bipush        10
     781: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     784: athrow
     785: aload_0
     786: aload_3
     787: invokevirtual #624                // Method receiveCertificateVerifyMessage:(Ljava/io/ByteArrayInputStream;)V
     790: aload_0
     791: bipush        12
     793: putfield      #541                // Field connection_state:S
     796: goto          937
     799: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     802: dup
     803: bipush        10
     805: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     808: athrow
     809: aload_0
     810: getfield      #541                // Field connection_state:S
     813: lookupswitch  { // 2
                    11: 840
                    12: 857
               default: 917
          }
     840: aload_0
     841: invokevirtual #617                // Method expectCertificateVerifyMessage:()Z
     844: ifeq          857
     847: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     850: dup
     851: bipush        10
     853: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     856: athrow
     857: aload_0
     858: aload_3
     859: invokevirtual #622                // Method processFinishedMessage:(Ljava/io/ByteArrayInputStream;)V
     862: aload_0
     863: bipush        13
     865: putfield      #541                // Field connection_state:S
     868: aload_0
     869: getfield      #543                // Field expectSessionTicket:Z
     872: ifeq          892
     875: aload_0
     876: aload_0
     877: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     880: invokeinterface #698,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getNewSessionTicket:()Lorg/bouncycastle/crypto/tls/NewSessionTicket;
     885: invokevirtual #634                // Method sendNewSessionTicketMessage:(Lorg/bouncycastle/crypto/tls/NewSessionTicket;)V
     888: aload_0
     889: invokevirtual #613                // Method sendChangeCipherSpecMessage:()V
     892: aload_0
     893: bipush        14
     895: putfield      #541                // Field connection_state:S
     898: aload_0
     899: invokevirtual #614                // Method sendFinishedMessage:()V
     902: aload_0
     903: bipush        15
     905: putfield      #541                // Field connection_state:S
     908: aload_0
     909: bipush        16
     911: putfield      #541                // Field connection_state:S
     914: goto          937
     917: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     920: dup
     921: bipush        10
     923: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     926: athrow
     927: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     930: dup
     931: bipush        10
     933: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     936: athrow
     937: return

  protected void handleWarningMessage(short) throws java.io.IOException;
    Code:
       0: iload_1
       1: lookupswitch  { // 1
                    41: 20
               default: 47
          }
      20: aload_0
      21: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      24: invokestatic  #657                // Method org/bouncycastle/crypto/tls/TlsUtils.isSSL:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
      27: ifeq          52
      30: aload_0
      31: getfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      34: ifnull        52
      37: aload_0
      38: getstatic     #525                // Field org/bouncycastle/crypto/tls/Certificate.EMPTY_CHAIN:Lorg/bouncycastle/crypto/tls/Certificate;
      41: invokevirtual #630                // Method notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      44: goto          52
      47: aload_0
      48: iload_1
      49: invokespecial #604                // Method org/bouncycastle/crypto/tls/TlsProtocol.handleWarningMessage:(S)V
      52: return

  protected void notifyClientCertificate(org.bouncycastle.crypto.tls.Certificate) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #553                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
       4: ifnonnull     15
       7: new           #235                // class java/lang/IllegalStateException
      10: dup
      11: invokespecial #564                // Method java/lang/IllegalStateException."<init>":()V
      14: athrow
      15: aload_0
      16: getfield      #552                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
      19: ifnull        32
      22: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      25: dup
      26: bipush        10
      28: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      31: athrow
      32: aload_0
      33: aload_1
      34: putfield      #552                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
      37: aload_1
      38: invokevirtual #570                // Method org/bouncycastle/crypto/tls/Certificate.isEmpty:()Z
      41: ifeq          56
      44: aload_0
      45: getfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      48: invokeinterface #674,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.skipClientCredentials:()V
      53: goto          83
      56: aload_0
      57: aload_1
      58: aload_0
      59: getfield      #556                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
      62: invokeinterface #671,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsCredentials.getCertificate:()Lorg/bouncycastle/crypto/tls/Certificate;
      67: invokestatic  #664                // Method org/bouncycastle/crypto/tls/TlsUtils.getClientCertificateType:(Lorg/bouncycastle/crypto/tls/Certificate;Lorg/bouncycastle/crypto/tls/Certificate;)S
      70: putfield      #540                // Field clientCertificateType:S
      73: aload_0
      74: getfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      77: aload_1
      78: invokeinterface #678,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.processClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      83: aload_0
      84: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      87: aload_1
      88: invokeinterface #695,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      93: return

  protected void receiveCertificateMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokestatic  #572                // Method org/bouncycastle/crypto/tls/Certificate.parse:(Ljava/io/InputStream;)Lorg/bouncycastle/crypto/tls/Certificate;
       4: astore_2
       5: aload_1
       6: invokestatic  #621                // Method assertEmpty:(Ljava/io/ByteArrayInputStream;)V
       9: aload_0
      10: aload_2
      11: invokevirtual #630                // Method notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      14: return

  protected void receiveCertificateVerifyMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
       4: aload_1
       5: invokestatic  #579                // Method org/bouncycastle/crypto/tls/DigitallySigned.parse:(Lorg/bouncycastle/crypto/tls/TlsContext;Ljava/io/InputStream;)Lorg/bouncycastle/crypto/tls/DigitallySigned;
       8: astore_2
       9: aload_1
      10: invokestatic  #621                // Method assertEmpty:(Ljava/io/ByteArrayInputStream;)V
      13: aload_0
      14: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      17: invokestatic  #658                // Method org/bouncycastle/crypto/tls/TlsUtils.isTLSv12:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
      20: ifeq          43
      23: aload_0
      24: getfield      #557                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      27: aload_2
      28: invokevirtual #578                // Method org/bouncycastle/crypto/tls/DigitallySigned.getAlgorithm:()Lorg/bouncycastle/crypto/tls/SignatureAndHashAlgorithm;
      31: invokevirtual #595                // Method org/bouncycastle/crypto/tls/SignatureAndHashAlgorithm.getHash:()S
      34: invokeinterface #673,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsHandshakeHash.getFinalHash:(S)[B
      39: astore_3
      40: goto          51
      43: aload_0
      44: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      47: invokevirtual #594                // Method org/bouncycastle/crypto/tls/SecurityParameters.getSessionHash:()[B
      50: astore_3
      51: aload_0
      52: getfield      #552                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
      55: iconst_0
      56: invokevirtual #571                // Method org/bouncycastle/crypto/tls/Certificate.getCertificateAt:(I)Lorg/bouncycastle/asn1/x509/Certificate;
      59: astore        4
      61: aload         4
      63: invokevirtual #567                // Method org/bouncycastle/asn1/x509/Certificate.getSubjectPublicKeyInfo:()Lorg/bouncycastle/asn1/x509/SubjectPublicKeyInfo;
      66: astore        5
      68: aload         5
      70: invokestatic  #666                // Method org/bouncycastle/crypto/util/PublicKeyFactory.createKey:(Lorg/bouncycastle/asn1/x509/SubjectPublicKeyInfo;)Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      73: astore        6
      75: aload_0
      76: getfield      #540                // Field clientCertificateType:S
      79: invokestatic  #659                // Method org/bouncycastle/crypto/tls/TlsUtils.createTlsSigner:(S)Lorg/bouncycastle/crypto/tls/TlsSigner;
      82: astore        7
      84: aload         7
      86: aload_0
      87: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      90: invokeinterface #704,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsSigner.init:(Lorg/bouncycastle/crypto/tls/TlsContext;)V
      95: aload         7
      97: aload_2
      98: invokevirtual #578                // Method org/bouncycastle/crypto/tls/DigitallySigned.getAlgorithm:()Lorg/bouncycastle/crypto/tls/SignatureAndHashAlgorithm;
     101: aload_2
     102: invokevirtual #577                // Method org/bouncycastle/crypto/tls/DigitallySigned.getSignature:()[B
     105: aload         6
     107: aload_3
     108: invokeinterface #705,  5          // InterfaceMethod org/bouncycastle/crypto/tls/TlsSigner.verifyRawSignature:(Lorg/bouncycastle/crypto/tls/SignatureAndHashAlgorithm;[BLorg/bouncycastle/crypto/params/AsymmetricKeyParameter;[B)Z
     113: ifne          126
     116: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     119: dup
     120: bipush        51
     122: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     125: athrow
     126: goto          141
     129: astore_3
     130: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     133: dup
     134: bipush        51
     136: aload_3
     137: invokespecial #602                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(SLjava/lang/Throwable;)V
     140: athrow
     141: return
    Exception table:
       from    to  target type
          13   126   129   Class java/lang/Exception

  protected void receiveClientHelloMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokestatic  #665                // Method org/bouncycastle/crypto/tls/TlsUtils.readVersion:(Ljava/io/InputStream;)Lorg/bouncycastle/crypto/tls/ProtocolVersion;
       4: astore_2
       5: aload_0
       6: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
       9: aload_2
      10: invokevirtual #587                // Method org/bouncycastle/crypto/tls/RecordStream.setWriteVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      13: aload_2
      14: invokevirtual #581                // Method org/bouncycastle/crypto/tls/ProtocolVersion.isDTLS:()Z
      17: ifeq          30
      20: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      23: dup
      24: bipush        47
      26: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      29: athrow
      30: bipush        32
      32: aload_1
      33: invokestatic  #647                // Method org/bouncycastle/crypto/tls/TlsUtils.readFully:(ILjava/io/InputStream;)[B
      36: astore_3
      37: aload_1
      38: invokestatic  #652                // Method org/bouncycastle/crypto/tls/TlsUtils.readOpaque8:(Ljava/io/InputStream;)[B
      41: astore        4
      43: aload         4
      45: arraylength
      46: bipush        32
      48: if_icmple     61
      51: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      54: dup
      55: bipush        47
      57: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      60: athrow
      61: aload_1
      62: invokestatic  #650                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint16:(Ljava/io/InputStream;)I
      65: istore        5
      67: iload         5
      69: iconst_2
      70: if_icmplt     80
      73: iload         5
      75: iconst_1
      76: iand
      77: ifeq          90
      80: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      83: dup
      84: bipush        50
      86: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      89: athrow
      90: aload_0
      91: iload         5
      93: iconst_2
      94: idiv
      95: aload_1
      96: invokestatic  #648                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint16Array:(ILjava/io/InputStream;)[I
      99: putfield      #546                // Field offeredCipherSuites:[I
     102: aload_1
     103: invokestatic  #651                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint8:(Ljava/io/InputStream;)S
     106: istore        6
     108: iload         6
     110: iconst_1
     111: if_icmpge     124
     114: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     117: dup
     118: bipush        47
     120: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     123: athrow
     124: aload_0
     125: iload         6
     127: aload_1
     128: invokestatic  #649                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint8Array:(ILjava/io/InputStream;)[S
     131: putfield      #547                // Field offeredCompressionMethods:[S
     134: aload_0
     135: aload_1
     136: invokestatic  #638                // Method readExtensions:(Ljava/io/ByteArrayInputStream;)Ljava/util/Hashtable;
     139: putfield      #550                // Field clientExtensions:Ljava/util/Hashtable;
     142: aload_0
     143: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     146: aload_0
     147: getfield      #550                // Field clientExtensions:Ljava/util/Hashtable;
     150: invokestatic  #598                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.hasExtendedMasterSecretExtension:(Ljava/util/Hashtable;)Z
     153: putfield      #533                // Field org/bouncycastle/crypto/tls/SecurityParameters.extendedMasterSecret:Z
     156: aload_0
     157: invokevirtual #629                // Method getContextAdmin:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
     160: aload_2
     161: invokevirtual #568                // Method org/bouncycastle/crypto/tls/AbstractTlsContext.setClientVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
     164: aload_0
     165: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     168: aload_2
     169: invokeinterface #700,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyClientVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
     174: aload_0
     175: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     178: aload_0
     179: getfield      #546                // Field offeredCipherSuites:[I
     182: sipush        22016
     185: invokestatic  #668                // Method org/bouncycastle/util/Arrays.contains:([II)Z
     188: invokeinterface #687,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyFallback:(Z)V
     193: aload_0
     194: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     197: aload_3
     198: putfield      #535                // Field org/bouncycastle/crypto/tls/SecurityParameters.clientRandom:[B
     201: aload_0
     202: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     205: aload_0
     206: getfield      #546                // Field offeredCipherSuites:[I
     209: invokeinterface #689,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyOfferedCipherSuites:([I)V
     214: aload_0
     215: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     218: aload_0
     219: getfield      #547                // Field offeredCompressionMethods:[S
     222: invokeinterface #690,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyOfferedCompressionMethods:([S)V
     227: aload_0
     228: getfield      #546                // Field offeredCipherSuites:[I
     231: sipush        255
     234: invokestatic  #668                // Method org/bouncycastle/util/Arrays.contains:([II)Z
     237: ifeq          245
     240: aload_0
     241: iconst_1
     242: putfield      #545                // Field secure_renegotiation:Z
     245: aload_0
     246: getfield      #550                // Field clientExtensions:Ljava/util/Hashtable;
     249: getstatic     #548                // Field EXT_RenegotiationInfo:Ljava/lang/Integer;
     252: invokestatic  #661                // Method org/bouncycastle/crypto/tls/TlsUtils.getExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;)[B
     255: astore        7
     257: aload         7
     259: ifnull        291
     262: aload_0
     263: iconst_1
     264: putfield      #545                // Field secure_renegotiation:Z
     267: aload         7
     269: getstatic     #561                // Field org/bouncycastle/crypto/tls/TlsUtils.EMPTY_BYTES:[B
     272: invokestatic  #619                // Method createRenegotiationInfo:([B)[B
     275: invokestatic  #667                // Method org/bouncycastle/util/Arrays.constantTimeAreEqual:([B[B)Z
     278: ifne          291
     281: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     284: dup
     285: bipush        40
     287: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     290: athrow
     291: aload_0
     292: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     295: aload_0
     296: getfield      #545                // Field secure_renegotiation:Z
     299: invokeinterface #688,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifySecureRenegotiation:(Z)V
     304: aload_0
     305: getfield      #550                // Field clientExtensions:Ljava/util/Hashtable;
     308: ifnull        324
     311: aload_0
     312: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     315: aload_0
     316: getfield      #550                // Field clientExtensions:Ljava/util/Hashtable;
     319: invokeinterface #692,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientExtensions:(Ljava/util/Hashtable;)V
     324: return

  protected void receiveClientKeyExchangeMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
       4: aload_1
       5: invokeinterface #677,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.processClientKeyExchange:(Ljava/io/InputStream;)V
      10: aload_1
      11: invokestatic  #621                // Method assertEmpty:(Ljava/io/ByteArrayInputStream;)V
      14: aload_0
      15: aload_0
      16: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      19: invokevirtual #590                // Method org/bouncycastle/crypto/tls/RecordStream.prepareToFinish:()Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      22: putfield      #557                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      25: aload_0
      26: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      29: aload_0
      30: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      33: aload_0
      34: getfield      #557                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      37: aconst_null
      38: invokestatic  #642                // Method getCurrentPRFHash:(Lorg/bouncycastle/crypto/tls/TlsContext;Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;[B)[B
      41: putfield      #537                // Field org/bouncycastle/crypto/tls/SecurityParameters.sessionHash:[B
      44: aload_0
      45: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      48: aload_0
      49: getfield      #558                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      52: invokestatic  #643                // Method establishMasterSecret:(Lorg/bouncycastle/crypto/tls/TlsContext;Lorg/bouncycastle/crypto/tls/TlsKeyExchange;)V
      55: aload_0
      56: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      59: aload_0
      60: invokevirtual #637                // Method getPeer:()Lorg/bouncycastle/crypto/tls/TlsPeer;
      63: invokeinterface #683,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsPeer.getCompression:()Lorg/bouncycastle/crypto/tls/TlsCompression;
      68: aload_0
      69: invokevirtual #637                // Method getPeer:()Lorg/bouncycastle/crypto/tls/TlsPeer;
      72: invokeinterface #682,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsPeer.getCipher:()Lorg/bouncycastle/crypto/tls/TlsCipher;
      77: invokevirtual #591                // Method org/bouncycastle/crypto/tls/RecordStream.setPendingConnectionState:(Lorg/bouncycastle/crypto/tls/TlsCompression;Lorg/bouncycastle/crypto/tls/TlsCipher;)V
      80: aload_0
      81: getfield      #543                // Field expectSessionTicket:Z
      84: ifne          91
      87: aload_0
      88: invokevirtual #613                // Method sendChangeCipherSpecMessage:()V
      91: return

  protected void sendCertificateRequestMessage(org.bouncycastle.crypto.tls.CertificateRequest) throws java.io.IOException;
    Code:
       0: new           #257                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: bipush        13
       7: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
      10: astore_2
      11: aload_1
      12: aload_2
      13: invokevirtual #573                // Method org/bouncycastle/crypto/tls/CertificateRequest.encode:(Ljava/io/OutputStream;)V
      16: aload_2
      17: invokevirtual #606                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      20: return

  protected void sendCertificateStatusMessage(org.bouncycastle.crypto.tls.CertificateStatus) throws java.io.IOException;
    Code:
       0: new           #257                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: bipush        22
       7: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
      10: astore_2
      11: aload_1
      12: aload_2
      13: invokevirtual #575                // Method org/bouncycastle/crypto/tls/CertificateStatus.encode:(Ljava/io/OutputStream;)V
      16: aload_2
      17: invokevirtual #606                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      20: return

  protected void sendNewSessionTicketMessage(org.bouncycastle.crypto.tls.NewSessionTicket) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
       7: dup
       8: bipush        80
      10: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      13: athrow
      14: new           #257                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
      17: dup
      18: aload_0
      19: iconst_4
      20: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
      23: astore_2
      24: aload_1
      25: aload_2
      26: invokevirtual #580                // Method org/bouncycastle/crypto/tls/NewSessionTicket.encode:(Ljava/io/OutputStream;)V
      29: aload_2
      30: invokevirtual #606                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      33: return

  protected void sendServerHelloMessage() throws java.io.IOException;
    Code:
       0: new           #257                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: iconst_2
       6: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
       9: astore_1
      10: aload_0
      11: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      14: invokeinterface #699,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getServerVersion:()Lorg/bouncycastle/crypto/tls/ProtocolVersion;
      19: astore_2
      20: aload_2
      21: aload_0
      22: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      25: invokeinterface #670,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.getClientVersion:()Lorg/bouncycastle/crypto/tls/ProtocolVersion;
      30: invokevirtual #582                // Method org/bouncycastle/crypto/tls/ProtocolVersion.isEqualOrEarlierVersionOf:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)Z
      33: ifne          46
      36: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      39: dup
      40: bipush        80
      42: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      45: athrow
      46: aload_0
      47: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      50: aload_2
      51: invokevirtual #586                // Method org/bouncycastle/crypto/tls/RecordStream.setReadVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      54: aload_0
      55: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      58: aload_2
      59: invokevirtual #587                // Method org/bouncycastle/crypto/tls/RecordStream.setWriteVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      62: aload_0
      63: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      66: iconst_1
      67: invokevirtual #585                // Method org/bouncycastle/crypto/tls/RecordStream.setRestrictReadVersion:(Z)V
      70: aload_0
      71: invokevirtual #629                // Method getContextAdmin:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
      74: aload_2
      75: invokevirtual #569                // Method org/bouncycastle/crypto/tls/AbstractTlsContext.setServerVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      78: aload_2
      79: aload_1
      80: invokestatic  #660                // Method org/bouncycastle/crypto/tls/TlsUtils.writeVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;Ljava/io/OutputStream;)V
      83: aload_1
      84: aload_0
      85: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      88: getfield      #536                // Field org/bouncycastle/crypto/tls/SecurityParameters.serverRandom:[B
      91: invokevirtual #607                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.write:([B)V
      94: getstatic     #561                // Field org/bouncycastle/crypto/tls/TlsUtils.EMPTY_BYTES:[B
      97: aload_1
      98: invokestatic  #655                // Method org/bouncycastle/crypto/tls/TlsUtils.writeOpaque8:([BLjava/io/OutputStream;)V
     101: aload_0
     102: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     105: invokeinterface #684,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getSelectedCipherSuite:()I
     110: istore_3
     111: aload_0
     112: getfield      #546                // Field offeredCipherSuites:[I
     115: iload_3
     116: invokestatic  #668                // Method org/bouncycastle/util/Arrays.contains:([II)Z
     119: ifeq          141
     122: iload_3
     123: ifeq          141
     126: iload_3
     127: invokestatic  #576                // Method org/bouncycastle/crypto/tls/CipherSuite.isSCSV:(I)Z
     130: ifne          141
     133: iload_3
     134: aload_2
     135: invokestatic  #656                // Method org/bouncycastle/crypto/tls/TlsUtils.isValidCipherSuiteForVersion:(ILorg/bouncycastle/crypto/tls/ProtocolVersion;)Z
     138: ifne          151
     141: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     144: dup
     145: bipush        80
     147: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     150: athrow
     151: aload_0
     152: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     155: iload_3
     156: putfield      #526                // Field org/bouncycastle/crypto/tls/SecurityParameters.cipherSuite:I
     159: aload_0
     160: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     163: invokeinterface #685,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getSelectedCompressionMethod:()S
     168: istore        4
     170: aload_0
     171: getfield      #547                // Field offeredCompressionMethods:[S
     174: iload         4
     176: invokestatic  #669                // Method org/bouncycastle/util/Arrays.contains:([SS)Z
     179: ifne          192
     182: new           #252                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     185: dup
     186: bipush        80
     188: invokespecial #601                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     191: athrow
     192: aload_0
     193: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     196: iload         4
     198: putfield      #530                // Field org/bouncycastle/crypto/tls/SecurityParameters.compressionAlgorithm:S
     201: iload_3
     202: aload_1
     203: invokestatic  #653                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint16:(ILjava/io/OutputStream;)V
     206: iload         4
     208: aload_1
     209: invokestatic  #654                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint8:(SLjava/io/OutputStream;)V
     212: aload_0
     213: aload_0
     214: getfield      #559                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     217: invokeinterface #691,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getServerExtensions:()Ljava/util/Hashtable;
     222: putfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     225: aload_0
     226: getfield      #545                // Field secure_renegotiation:Z
     229: ifeq          290
     232: aload_0
     233: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     236: getstatic     #548                // Field EXT_RenegotiationInfo:Ljava/lang/Integer;
     239: invokestatic  #661                // Method org/bouncycastle/crypto/tls/TlsUtils.getExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;)[B
     242: astore        5
     244: aconst_null
     245: aload         5
     247: if_acmpne     254
     250: iconst_1
     251: goto          255
     254: iconst_0
     255: istore        6
     257: iload         6
     259: ifeq          290
     262: aload_0
     263: aload_0
     264: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     267: invokestatic  #600                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.ensureExtensionsInitialised:(Ljava/util/Hashtable;)Ljava/util/Hashtable;
     270: putfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     273: aload_0
     274: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     277: getstatic     #548                // Field EXT_RenegotiationInfo:Ljava/lang/Integer;
     280: getstatic     #561                // Field org/bouncycastle/crypto/tls/TlsUtils.EMPTY_BYTES:[B
     283: invokestatic  #619                // Method createRenegotiationInfo:([B)[B
     286: invokevirtual #566                // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     289: pop
     290: aload_0
     291: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     294: getfield      #533                // Field org/bouncycastle/crypto/tls/SecurityParameters.extendedMasterSecret:Z
     297: ifeq          318
     300: aload_0
     301: aload_0
     302: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     305: invokestatic  #600                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.ensureExtensionsInitialised:(Ljava/util/Hashtable;)Ljava/util/Hashtable;
     308: putfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     311: aload_0
     312: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     315: invokestatic  #596                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.addExtendedMasterSecretExtension:(Ljava/util/Hashtable;)V
     318: aload_0
     319: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     322: ifnull        444
     325: aload_0
     326: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     329: aload_0
     330: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     333: invokestatic  #597                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.hasEncryptThenMACExtension:(Ljava/util/Hashtable;)Z
     336: putfield      #532                // Field org/bouncycastle/crypto/tls/SecurityParameters.encryptThenMAC:Z
     339: aload_0
     340: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     343: aload_0
     344: aload_0
     345: getfield      #550                // Field clientExtensions:Ljava/util/Hashtable;
     348: aload_0
     349: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     352: bipush        80
     354: invokevirtual #640                // Method processMaxFragmentLengthExtension:(Ljava/util/Hashtable;Ljava/util/Hashtable;S)S
     357: putfield      #531                // Field org/bouncycastle/crypto/tls/SecurityParameters.maxFragmentLength:S
     360: aload_0
     361: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     364: aload_0
     365: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     368: invokestatic  #599                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.hasTruncatedHMacExtension:(Ljava/util/Hashtable;)Z
     371: putfield      #534                // Field org/bouncycastle/crypto/tls/SecurityParameters.truncatedHMac:Z
     374: aload_0
     375: aload_0
     376: getfield      #544                // Field resumedSession:Z
     379: ifne          401
     382: aload_0
     383: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     386: getstatic     #538                // Field org/bouncycastle/crypto/tls/TlsExtensionsUtils.EXT_status_request:Ljava/lang/Integer;
     389: bipush        80
     391: invokestatic  #662                // Method org/bouncycastle/crypto/tls/TlsUtils.hasExpectedEmptyExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;S)Z
     394: ifeq          401
     397: iconst_1
     398: goto          402
     401: iconst_0
     402: putfield      #542                // Field allowCertificateStatus:Z
     405: aload_0
     406: aload_0
     407: getfield      #544                // Field resumedSession:Z
     410: ifne          432
     413: aload_0
     414: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     417: getstatic     #539                // Field org/bouncycastle/crypto/tls/TlsProtocol.EXT_SessionTicket:Ljava/lang/Integer;
     420: bipush        80
     422: invokestatic  #662                // Method org/bouncycastle/crypto/tls/TlsUtils.hasExpectedEmptyExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;S)Z
     425: ifeq          432
     428: iconst_1
     429: goto          433
     432: iconst_0
     433: putfield      #543                // Field expectSessionTicket:Z
     436: aload_1
     437: aload_0
     438: getfield      #551                // Field serverExtensions:Ljava/util/Hashtable;
     441: invokestatic  #639                // Method writeExtensions:(Ljava/io/OutputStream;Ljava/util/Hashtable;)V
     444: aload_0
     445: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     448: getfield      #531                // Field org/bouncycastle/crypto/tls/SecurityParameters.maxFragmentLength:S
     451: iflt          477
     454: iconst_1
     455: bipush        8
     457: aload_0
     458: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     461: getfield      #531                // Field org/bouncycastle/crypto/tls/SecurityParameters.maxFragmentLength:S
     464: iadd
     465: ishl
     466: istore        5
     468: aload_0
     469: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     472: iload         5
     474: invokevirtual #584                // Method org/bouncycastle/crypto/tls/RecordStream.setPlaintextLimit:(I)V
     477: aload_0
     478: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     481: aload_0
     482: invokevirtual #635                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     485: aload_0
     486: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     489: invokevirtual #592                // Method org/bouncycastle/crypto/tls/SecurityParameters.getCipherSuite:()I
     492: invokestatic  #636                // Method getPRFAlgorithm:(Lorg/bouncycastle/crypto/tls/TlsContext;I)I
     495: putfield      #528                // Field org/bouncycastle/crypto/tls/SecurityParameters.prfAlgorithm:I
     498: aload_0
     499: getfield      #555                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     502: bipush        12
     504: putfield      #529                // Field org/bouncycastle/crypto/tls/SecurityParameters.verifyDataLength:I
     507: aload_1
     508: invokevirtual #606                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
     511: aload_0
     512: getfield      #554                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     515: invokevirtual #583                // Method org/bouncycastle/crypto/tls/RecordStream.notifyHelloComplete:()V
     518: return

  protected void sendServerHelloDoneMessage() throws java.io.IOException;
    Code:
       0: iconst_4
       1: newarray       byte
       3: astore_1
       4: bipush        14
       6: aload_1
       7: iconst_0
       8: invokestatic  #646                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint8:(S[BI)V
      11: iconst_0
      12: aload_1
      13: iconst_1
      14: invokestatic  #644                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint24:(I[BI)V
      17: aload_0
      18: aload_1
      19: iconst_0
      20: aload_1
      21: arraylength
      22: invokevirtual #620                // Method writeHandshakeMessage:([BII)V
      25: return

  protected void sendServerKeyExchangeMessage(byte[]) throws java.io.IOException;
    Code:
       0: new           #257                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: bipush        12
       7: aload_1
       8: arraylength
       9: invokespecial #609                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;SI)V
      12: astore_2
      13: aload_2
      14: aload_1
      15: invokevirtual #607                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.write:([B)V
      18: aload_2
      19: invokevirtual #606                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      22: return

  protected boolean expectCertificateVerifyMessage();
    Code:
       0: aload_0
       1: getfield      #540                // Field clientCertificateType:S
       4: iflt          21
       7: aload_0
       8: getfield      #540                // Field clientCertificateType:S
      11: invokestatic  #645                // Method org/bouncycastle/crypto/tls/TlsUtils.hasSigningCapability:(S)Z
      14: ifeq          21
      17: iconst_1
      18: goto          22
      21: iconst_0
      22: ireturn
}
