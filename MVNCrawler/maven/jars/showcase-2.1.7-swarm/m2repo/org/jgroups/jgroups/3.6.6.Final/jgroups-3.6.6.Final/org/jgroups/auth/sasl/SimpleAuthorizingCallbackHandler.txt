Compiled from "SimpleAuthorizingCallbackHandler.java"
public class org.jgroups.auth.sasl.SimpleAuthorizingCallbackHandler implements javax.security.auth.callback.CallbackHandler {
  private static final org.jgroups.logging.Log log;

  private final java.util.Properties credentials;

  private final java.util.Properties roles;

  private final java.util.Timer timer;

  private final java.lang.String localPrincipal;

  private final java.lang.String role;

  private final java.lang.String realm;

  public org.jgroups.auth.sasl.SimpleAuthorizingCallbackHandler();
    Code:
       0: aload_0
       1: invokestatic  #2                  // Method org/jgroups/auth/sasl/SecurityActions.getSystemProperties:()Ljava/util/Properties;
       4: invokespecial #3                  // Method "<init>":(Ljava/util/Properties;)V
       7: return

  public org.jgroups.auth.sasl.SimpleAuthorizingCallbackHandler(java.util.Properties);
    Code:
       0: aload_0
       1: invokespecial #4                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #5                  // class java/util/Properties
       8: dup
       9: invokespecial #6                  // Method java/util/Properties."<init>":()V
      12: putfield      #7                  // Field credentials:Ljava/util/Properties;
      15: aload_0
      16: new           #5                  // class java/util/Properties
      19: dup
      20: invokespecial #6                  // Method java/util/Properties."<init>":()V
      23: putfield      #8                  // Field roles:Ljava/util/Properties;
      26: aload_0
      27: aload_0
      28: aload_1
      29: ldc           #9                  // String sasl.local.principal
      31: invokespecial #10                 // Method requireProperty:(Ljava/util/Properties;Ljava/lang/String;)Ljava/lang/String;
      34: putfield      #11                 // Field localPrincipal:Ljava/lang/String;
      37: aload_0
      38: aload_1
      39: ldc           #12                 // String sasl.credentials.properties
      41: invokespecial #10                 // Method requireProperty:(Ljava/util/Properties;Ljava/lang/String;)Ljava/lang/String;
      44: astore_2
      45: aload_0
      46: new           #13                 // class java/util/Timer
      49: dup
      50: invokespecial #14                 // Method java/util/Timer."<init>":()V
      53: putfield      #15                 // Field timer:Ljava/util/Timer;
      56: new           #16                 // class java/io/File
      59: dup
      60: aload_2
      61: invokespecial #17                 // Method java/io/File."<init>":(Ljava/lang/String;)V
      64: astore_3
      65: aload_0
      66: getfield      #15                 // Field timer:Ljava/util/Timer;
      69: new           #18                 // class org/jgroups/auth/sasl/FileWatchTask
      72: dup
      73: aload_3
      74: new           #19                 // class org/jgroups/auth/sasl/SimpleAuthorizingCallbackHandler$PropertiesReloadFileObserver
      77: dup
      78: aload_3
      79: aload_0
      80: getfield      #7                  // Field credentials:Ljava/util/Properties;
      83: invokespecial #20                 // Method org/jgroups/auth/sasl/SimpleAuthorizingCallbackHandler$PropertiesReloadFileObserver."<init>":(Ljava/io/File;Ljava/util/Properties;)V
      86: invokespecial #21                 // Method org/jgroups/auth/sasl/FileWatchTask."<init>":(Ljava/io/File;Lorg/jgroups/auth/sasl/FileObserver;)V
      89: lconst_0
      90: getstatic     #22                 // Field java/util/concurrent/TimeUnit.SECONDS:Ljava/util/concurrent/TimeUnit;
      93: ldc2_w        #23                 // long 10l
      96: invokevirtual #25                 // Method java/util/concurrent/TimeUnit.toMillis:(J)J
      99: invokevirtual #26                 // Method java/util/Timer.scheduleAtFixedRate:(Ljava/util/TimerTask;JJ)V
     102: aload_0
     103: aload_1
     104: ldc           #27                 // String sasl.role
     106: invokevirtual #28                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     109: putfield      #29                 // Field role:Ljava/lang/String;
     112: aload_1
     113: ldc           #30                 // String sasl.roles.properties
     115: invokevirtual #28                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     118: astore        4
     120: aload_0
     121: getfield      #29                 // Field role:Ljava/lang/String;
     124: ifnull        192
     127: aload         4
     129: ifnonnull     142
     132: new           #31                 // class java/lang/IllegalStateException
     135: dup
     136: ldc           #32                 // String To enable role authorization, both sasl.role and sasl.roles.properties system properties must be set
     138: invokespecial #33                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     141: athrow
     142: new           #16                 // class java/io/File
     145: dup
     146: aload         4
     148: invokespecial #17                 // Method java/io/File."<init>":(Ljava/lang/String;)V
     151: astore        5
     153: aload_0
     154: getfield      #15                 // Field timer:Ljava/util/Timer;
     157: new           #18                 // class org/jgroups/auth/sasl/FileWatchTask
     160: dup
     161: aload         5
     163: new           #19                 // class org/jgroups/auth/sasl/SimpleAuthorizingCallbackHandler$PropertiesReloadFileObserver
     166: dup
     167: aload         5
     169: aload_0
     170: getfield      #8                  // Field roles:Ljava/util/Properties;
     173: invokespecial #20                 // Method org/jgroups/auth/sasl/SimpleAuthorizingCallbackHandler$PropertiesReloadFileObserver."<init>":(Ljava/io/File;Ljava/util/Properties;)V
     176: invokespecial #21                 // Method org/jgroups/auth/sasl/FileWatchTask."<init>":(Ljava/io/File;Lorg/jgroups/auth/sasl/FileObserver;)V
     179: lconst_0
     180: getstatic     #22                 // Field java/util/concurrent/TimeUnit.SECONDS:Ljava/util/concurrent/TimeUnit;
     183: ldc2_w        #23                 // long 10l
     186: invokevirtual #25                 // Method java/util/concurrent/TimeUnit.toMillis:(J)J
     189: invokevirtual #26                 // Method java/util/Timer.scheduleAtFixedRate:(Ljava/util/TimerTask;JJ)V
     192: aload_0
     193: aload_1
     194: ldc           #34                 // String sasl.realm
     196: invokevirtual #28                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     199: putfield      #35                 // Field realm:Ljava/lang/String;
     202: return

  private java.lang.String requireProperty(java.util.Properties, java.lang.String);
    Code:
       0: aload_1
       1: aload_2
       2: invokevirtual #28                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       5: astore_3
       6: aload_3
       7: ifnonnull     42
      10: new           #31                 // class java/lang/IllegalStateException
      13: dup
      14: new           #36                 // class java/lang/StringBuilder
      17: dup
      18: invokespecial #37                 // Method java/lang/StringBuilder."<init>":()V
      21: ldc           #38                 // String The required system property
      23: invokevirtual #39                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      26: aload_2
      27: invokevirtual #39                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      30: ldc           #40                 // String  has not been set
      32: invokevirtual #39                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      35: invokevirtual #41                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      38: invokespecial #33                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      41: athrow
      42: aload_3
      43: areturn

  public void handle(javax.security.auth.callback.Callback[]) throws java.io.IOException, javax.security.auth.callback.UnsupportedCallbackException;
    Code:
       0: new           #42                 // class java/util/LinkedList
       3: dup
       4: invokespecial #43                 // Method java/util/LinkedList."<init>":()V
       7: astore_2
       8: aconst_null
       9: astore_3
      10: iconst_0
      11: istore        4
      13: aload_1
      14: astore        5
      16: aload         5
      18: arraylength
      19: istore        6
      21: iconst_0
      22: istore        7
      24: iload         7
      26: iload         6
      28: if_icmpge     219
      31: aload         5
      33: iload         7
      35: aaload
      36: astore        8
      38: aload         8
      40: instanceof    #44                 // class javax/security/sasl/AuthorizeCallback
      43: ifeq          58
      46: aload_2
      47: aload         8
      49: invokeinterface #45,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      54: pop
      55: goto          213
      58: aload         8
      60: instanceof    #46                 // class javax/security/auth/callback/NameCallback
      63: ifeq          108
      66: aload         8
      68: checkcast     #46                 // class javax/security/auth/callback/NameCallback
      71: astore        9
      73: aload         9
      75: invokevirtual #47                 // Method javax/security/auth/callback/NameCallback.getDefaultName:()Ljava/lang/String;
      78: astore_3
      79: aload_3
      80: ifnull        96
      83: aload_0
      84: getfield      #7                  // Field credentials:Ljava/util/Properties;
      87: aload_3
      88: invokevirtual #48                 // Method java/util/Properties.containsKey:(Ljava/lang/Object;)Z
      91: istore        4
      93: goto          105
      96: aload_2
      97: aload         8
      99: invokeinterface #45,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     104: pop
     105: goto          213
     108: aload         8
     110: instanceof    #49                 // class javax/security/auth/callback/PasswordCallback
     113: ifeq          128
     116: aload_2
     117: aload         8
     119: invokeinterface #45,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     124: pop
     125: goto          213
     128: aload         8
     130: instanceof    #50                 // class javax/security/sasl/RealmCallback
     133: ifeq          203
     136: aload         8
     138: checkcast     #50                 // class javax/security/sasl/RealmCallback
     141: invokevirtual #51                 // Method javax/security/sasl/RealmCallback.getDefaultText:()Ljava/lang/String;
     144: astore        9
     146: aload         9
     148: ifnull        191
     151: aload_0
     152: getfield      #35                 // Field realm:Ljava/lang/String;
     155: aload         9
     157: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     160: ifne          191
     163: new           #53                 // class java/io/IOException
     166: dup
     167: new           #36                 // class java/lang/StringBuilder
     170: dup
     171: invokespecial #37                 // Method java/lang/StringBuilder."<init>":()V
     174: ldc           #54                 // String Invalid realm
     176: invokevirtual #39                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     179: aload         9
     181: invokevirtual #39                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     184: invokevirtual #41                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     187: invokespecial #55                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     190: athrow
     191: aload_2
     192: aload         8
     194: invokeinterface #45,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     199: pop
     200: goto          213
     203: new           #56                 // class javax/security/auth/callback/UnsupportedCallbackException
     206: dup
     207: aload         8
     209: invokespecial #57                 // Method javax/security/auth/callback/UnsupportedCallbackException."<init>":(Ljavax/security/auth/callback/Callback;)V
     212: athrow
     213: iinc          7, 1
     216: goto          24
     219: aload_2
     220: invokeinterface #58,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     225: astore        5
     227: aload         5
     229: invokeinterface #59,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     234: ifeq          514
     237: aload         5
     239: invokeinterface #60,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     244: checkcast     #61                 // class javax/security/auth/callback/Callback
     247: astore        6
     249: aload         6
     251: instanceof    #46                 // class javax/security/auth/callback/NameCallback
     254: ifeq          272
     257: aload         6
     259: checkcast     #46                 // class javax/security/auth/callback/NameCallback
     262: aload_0
     263: getfield      #11                 // Field localPrincipal:Ljava/lang/String;
     266: invokevirtual #62                 // Method javax/security/auth/callback/NameCallback.setName:(Ljava/lang/String;)V
     269: goto          511
     272: aload         6
     274: instanceof    #44                 // class javax/security/sasl/AuthorizeCallback
     277: ifeq          402
     280: aload         6
     282: checkcast     #44                 // class javax/security/sasl/AuthorizeCallback
     285: astore        7
     287: aload         7
     289: invokevirtual #63                 // Method javax/security/sasl/AuthorizeCallback.getAuthenticationID:()Ljava/lang/String;
     292: astore        8
     294: aload         7
     296: invokevirtual #64                 // Method javax/security/sasl/AuthorizeCallback.getAuthorizationID:()Ljava/lang/String;
     299: astore        9
     301: aload         7
     303: aload         8
     305: aload         9
     307: invokevirtual #52                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     310: invokevirtual #65                 // Method javax/security/sasl/AuthorizeCallback.setAuthorized:(Z)V
     313: aload_0
     314: getfield      #29                 // Field role:Ljava/lang/String;
     317: ifnull        399
     320: aload_0
     321: getfield      #8                  // Field roles:Ljava/util/Properties;
     324: aload         7
     326: invokevirtual #64                 // Method javax/security/sasl/AuthorizeCallback.getAuthorizationID:()Ljava/lang/String;
     329: invokevirtual #28                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     332: astore        10
     334: aload         10
     336: ifnull        352
     339: aload         10
     341: ldc           #66                 // String \\s*,\\s*
     343: invokevirtual #67                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     346: invokestatic  #68                 // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
     349: goto          355
     352: invokestatic  #69                 // Method java/util/Collections.emptyList:()Ljava/util/List;
     355: astore        11
     357: aload         11
     359: aload_0
     360: getfield      #29                 // Field role:Ljava/lang/String;
     363: invokeinterface #70,  2           // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
     368: ifne          399
     371: new           #53                 // class java/io/IOException
     374: dup
     375: new           #36                 // class java/lang/StringBuilder
     378: dup
     379: invokespecial #37                 // Method java/lang/StringBuilder."<init>":()V
     382: ldc           #71                 // String Unauthorized user
     384: invokevirtual #39                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     387: aload         9
     389: invokevirtual #39                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     392: invokevirtual #41                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     395: invokespecial #55                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     398: athrow
     399: goto          511
     402: aload         6
     404: instanceof    #49                 // class javax/security/auth/callback/PasswordCallback
     407: ifeq          491
     410: aload_3
     411: ifnonnull     430
     414: aload_0
     415: getfield      #7                  // Field credentials:Ljava/util/Properties;
     418: aload_0
     419: getfield      #11                 // Field localPrincipal:Ljava/lang/String;
     422: invokevirtual #28                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     425: astore        7
     427: goto          475
     430: iload         4
     432: ifeq          448
     435: aload_0
     436: getfield      #7                  // Field credentials:Ljava/util/Properties;
     439: aload_3
     440: invokevirtual #28                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     443: astore        7
     445: goto          475
     448: new           #53                 // class java/io/IOException
     451: dup
     452: new           #36                 // class java/lang/StringBuilder
     455: dup
     456: invokespecial #37                 // Method java/lang/StringBuilder."<init>":()V
     459: ldc           #71                 // String Unauthorized user
     461: invokevirtual #39                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     464: aload_3
     465: invokevirtual #39                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     468: invokevirtual #41                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     471: invokespecial #55                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     474: athrow
     475: aload         6
     477: checkcast     #49                 // class javax/security/auth/callback/PasswordCallback
     480: aload         7
     482: invokevirtual #72                 // Method java/lang/String.toCharArray:()[C
     485: invokevirtual #73                 // Method javax/security/auth/callback/PasswordCallback.setPassword:([C)V
     488: goto          511
     491: aload         6
     493: instanceof    #50                 // class javax/security/sasl/RealmCallback
     496: ifeq          511
     499: aload         6
     501: checkcast     #50                 // class javax/security/sasl/RealmCallback
     504: aload_0
     505: getfield      #35                 // Field realm:Ljava/lang/String;
     508: invokevirtual #74                 // Method javax/security/sasl/RealmCallback.setText:(Ljava/lang/String;)V
     511: goto          227
     514: return

  static org.jgroups.logging.Log access$000();
    Code:
       0: getstatic     #1                  // Field log:Lorg/jgroups/logging/Log;
       3: areturn

  static {};
    Code:
       0: ldc_w         #75                 // class org/jgroups/auth/sasl/SimpleAuthorizingCallbackHandler
       3: invokestatic  #76                 // Method org/jgroups/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/jgroups/logging/Log;
       6: putstatic     #1                  // Field log:Lorg/jgroups/logging/Log;
       9: return
}
