Compiled from "X509Token.java"
public class org.jgroups.auth.X509Token extends org.jgroups.auth.AuthToken {
  public static final java.lang.String KEYSTORE_TYPE;

  public static final java.lang.String KEYSTORE_PATH;

  public static final java.lang.String KEYSTORE_PASSWORD;

  public static final java.lang.String CERT_ALIAS;

  public static final java.lang.String CERT_PASSWORD;

  public static final java.lang.String TOKEN_ATTR;

  public static final java.lang.String CIPHER_TYPE;

  private boolean valueSet;

  protected java.lang.String keystore_type;

  protected java.lang.String cert_alias;

  protected java.lang.String keystore_path;

  protected java.lang.String auth_value;

  protected java.lang.String cipher_type;

  private byte[] encryptedToken;

  private char[] cert_password;

  private char[] keystore_password;

  private javax.crypto.Cipher cipher;

  private java.security.PrivateKey certPrivateKey;

  private java.security.cert.X509Certificate certificate;

  public org.jgroups.auth.X509Token();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jgroups/auth/AuthToken."<init>":()V
       4: aload_0
       5: iconst_0
       6: putfield      #2                  // Field valueSet:Z
       9: aload_0
      10: ldc           #3                  // String JKS
      12: putfield      #4                  // Field keystore_type:Ljava/lang/String;
      15: aload_0
      16: aconst_null
      17: putfield      #5                  // Field cert_alias:Ljava/lang/String;
      20: aload_0
      21: aconst_null
      22: putfield      #6                  // Field keystore_path:Ljava/lang/String;
      25: aload_0
      26: aconst_null
      27: putfield      #7                  // Field auth_value:Ljava/lang/String;
      30: aload_0
      31: ldc           #8                  // String RSA
      33: putfield      #9                  // Field cipher_type:Ljava/lang/String;
      36: aload_0
      37: aconst_null
      38: putfield      #10                 // Field encryptedToken:[B
      41: aload_0
      42: aconst_null
      43: putfield      #11                 // Field cert_password:[C
      46: aload_0
      47: aconst_null
      48: putfield      #12                 // Field keystore_password:[C
      51: aload_0
      52: aconst_null
      53: putfield      #13                 // Field cipher:Ljavax/crypto/Cipher;
      56: aload_0
      57: aconst_null
      58: putfield      #14                 // Field certPrivateKey:Ljava/security/PrivateKey;
      61: aload_0
      62: aconst_null
      63: putfield      #15                 // Field certificate:Ljava/security/cert/X509Certificate;
      66: return

  public void setCertPassword(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #16                 // Method java/lang/String.toCharArray:()[C
       5: putfield      #11                 // Field cert_password:[C
       8: return

  public void setKeyStorePassword(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #16                 // Method java/lang/String.toCharArray:()[C
       5: putfield      #12                 // Field keystore_password:[C
       8: aload_0
       9: getfield      #11                 // Field cert_password:[C
      12: ifnonnull     23
      15: aload_0
      16: aload_0
      17: getfield      #12                 // Field keystore_password:[C
      20: putfield      #11                 // Field cert_password:[C
      23: return

  public org.jgroups.auth.X509Token encryptedToken(byte[]);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #10                 // Field encryptedToken:[B
       5: aload_0
       6: areturn

  public java.lang.String getName();
    Code:
       0: ldc           #17                 // String org.jgroups.auth.X509Token
       2: areturn

  public boolean authenticate(org.jgroups.auth.AuthToken, org.jgroups.Message);
    Code:
       0: aload_0
       1: getfield      #2                  // Field valueSet:Z
       4: ifne          32
       7: aload_0
       8: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
      11: invokeinterface #19,  1           // InterfaceMethod org/jgroups/logging/Log.isErrorEnabled:()Z
      16: ifeq          30
      19: aload_0
      20: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
      23: ldc           #20                 // String X509Token not setup correctly - check token attrs
      25: invokeinterface #21,  2           // InterfaceMethod org/jgroups/logging/Log.error:(Ljava/lang/String;)V
      30: iconst_0
      31: ireturn
      32: aload_1
      33: ifnull        203
      36: aload_1
      37: instanceof    #22                 // class org/jgroups/auth/X509Token
      40: ifeq          203
      43: aload_1
      44: checkcast     #22                 // class org/jgroups/auth/X509Token
      47: astore_3
      48: aload_3
      49: getfield      #2                  // Field valueSet:Z
      52: ifne          80
      55: aload_0
      56: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
      59: invokeinterface #19,  1           // InterfaceMethod org/jgroups/logging/Log.isErrorEnabled:()Z
      64: ifeq          78
      67: aload_0
      68: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
      71: ldc           #23                 // String X509Token - received token not valid
      73: invokeinterface #21,  2           // InterfaceMethod org/jgroups/logging/Log.error:(Ljava/lang/String;)V
      78: iconst_0
      79: ireturn
      80: aload_0
      81: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
      84: invokeinterface #24,  1           // InterfaceMethod org/jgroups/logging/Log.isDebugEnabled:()Z
      89: ifeq          103
      92: aload_0
      93: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
      96: ldc           #25                 // String setting cipher to decrypt mode
      98: invokeinterface #26,  2           // InterfaceMethod org/jgroups/logging/Log.debug:(Ljava/lang/String;)V
     103: aload_0
     104: getfield      #13                 // Field cipher:Ljavax/crypto/Cipher;
     107: iconst_2
     108: aload_0
     109: getfield      #14                 // Field certPrivateKey:Ljava/security/PrivateKey;
     112: invokevirtual #27                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;)V
     115: new           #28                 // class java/lang/String
     118: dup
     119: aload_0
     120: getfield      #13                 // Field cipher:Ljavax/crypto/Cipher;
     123: aload_3
     124: getfield      #10                 // Field encryptedToken:[B
     127: invokevirtual #29                 // Method javax/crypto/Cipher.doFinal:([B)[B
     130: invokespecial #30                 // Method java/lang/String."<init>":([B)V
     133: astore        4
     135: aload         4
     137: aload_0
     138: getfield      #7                  // Field auth_value:Ljava/lang/String;
     141: invokevirtual #31                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     144: ifeq          172
     147: aload_0
     148: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
     151: invokeinterface #24,  1           // InterfaceMethod org/jgroups/logging/Log.isDebugEnabled:()Z
     156: ifeq          170
     159: aload_0
     160: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
     163: ldc           #32                 // String X509 authentication passed
     165: invokeinterface #26,  2           // InterfaceMethod org/jgroups/logging/Log.debug:(Ljava/lang/String;)V
     170: iconst_1
     171: ireturn
     172: goto          203
     175: astore        4
     177: aload_0
     178: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
     181: invokeinterface #19,  1           // InterfaceMethod org/jgroups/logging/Log.isErrorEnabled:()Z
     186: ifeq          203
     189: aload_0
     190: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
     193: aload         4
     195: invokevirtual #34                 // Method java/lang/Exception.toString:()Ljava/lang/String;
     198: invokeinterface #21,  2           // InterfaceMethod org/jgroups/logging/Log.error:(Ljava/lang/String;)V
     203: iconst_0
     204: ireturn
    Exception table:
       from    to  target type
          80   171   175   Class java/lang/Exception

  public void writeTo(java.io.DataOutput) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
       4: invokeinterface #24,  1           // InterfaceMethod org/jgroups/logging/Log.isDebugEnabled:()Z
       9: ifeq          23
      12: aload_0
      13: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
      16: ldc           #35                 // String X509Token writeTo()
      18: invokeinterface #26,  2           // InterfaceMethod org/jgroups/logging/Log.debug:(Ljava/lang/String;)V
      23: aload_0
      24: getfield      #10                 // Field encryptedToken:[B
      27: aload_1
      28: invokestatic  #36                 // Method org/jgroups/util/Util.writeByteBuffer:([BLjava/io/DataOutput;)V
      31: return

  public void readFrom(java.io.DataInput) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
       4: invokeinterface #24,  1           // InterfaceMethod org/jgroups/logging/Log.isDebugEnabled:()Z
       9: ifeq          23
      12: aload_0
      13: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
      16: ldc           #37                 // String X509Token readFrom()
      18: invokeinterface #26,  2           // InterfaceMethod org/jgroups/logging/Log.debug:(Ljava/lang/String;)V
      23: aload_0
      24: aload_1
      25: invokestatic  #38                 // Method org/jgroups/util/Util.readByteBuffer:(Ljava/io/DataInput;)[B
      28: putfield      #10                 // Field encryptedToken:[B
      31: aload_0
      32: iconst_1
      33: putfield      #2                  // Field valueSet:Z
      36: return

  public int size();
    Code:
       0: aload_0
       1: getfield      #10                 // Field encryptedToken:[B
       4: invokestatic  #39                 // Method org/jgroups/util/Util.size:([B)I
       7: ireturn

  public void setCertificate() throws java.security.KeyStoreException, java.io.IOException, java.security.NoSuchAlgorithmException, java.security.cert.CertificateException, javax.crypto.NoSuchPaddingException, java.security.InvalidKeyException, javax.crypto.IllegalBlockSizeException, javax.crypto.BadPaddingException, java.security.UnrecoverableEntryException;
    Code:
       0: aload_0
       1: getfield      #4                  // Field keystore_type:Ljava/lang/String;
       4: invokestatic  #40                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;)Ljava/security/KeyStore;
       7: astore_1
       8: aconst_null
       9: astore_2
      10: invokestatic  #41                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
      13: invokevirtual #42                 // Method java/lang/Thread.getContextClassLoader:()Ljava/lang/ClassLoader;
      16: aload_0
      17: getfield      #6                  // Field keystore_path:Ljava/lang/String;
      20: invokevirtual #43                 // Method java/lang/ClassLoader.getResourceAsStream:(Ljava/lang/String;)Ljava/io/InputStream;
      23: astore_2
      24: aload_2
      25: ifnonnull     40
      28: new           #44                 // class java/io/FileInputStream
      31: dup
      32: aload_0
      33: getfield      #6                  // Field keystore_path:Ljava/lang/String;
      36: invokespecial #45                 // Method java/io/FileInputStream."<init>":(Ljava/lang/String;)V
      39: astore_2
      40: aload_1
      41: aload_2
      42: aload_0
      43: getfield      #12                 // Field keystore_password:[C
      46: invokevirtual #46                 // Method java/security/KeyStore.load:(Ljava/io/InputStream;[C)V
      49: aload_0
      50: aload_0
      51: getfield      #9                  // Field cipher_type:Ljava/lang/String;
      54: invokestatic  #47                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
      57: putfield      #13                 // Field cipher:Ljavax/crypto/Cipher;
      60: aload_0
      61: aload_1
      62: aload_0
      63: getfield      #5                  // Field cert_alias:Ljava/lang/String;
      66: invokevirtual #48                 // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
      69: checkcast     #49                 // class java/security/cert/X509Certificate
      72: putfield      #15                 // Field certificate:Ljava/security/cert/X509Certificate;
      75: aload_0
      76: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
      79: invokeinterface #24,  1           // InterfaceMethod org/jgroups/logging/Log.isDebugEnabled:()Z
      84: ifeq          121
      87: aload_0
      88: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
      91: new           #50                 // class java/lang/StringBuilder
      94: dup
      95: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
      98: ldc           #52                 // String certificate =
     100: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     103: aload_0
     104: getfield      #15                 // Field certificate:Ljava/security/cert/X509Certificate;
     107: invokevirtual #54                 // Method java/security/cert/X509Certificate.toString:()Ljava/lang/String;
     110: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     113: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     116: invokeinterface #26,  2           // InterfaceMethod org/jgroups/logging/Log.debug:(Ljava/lang/String;)V
     121: aload_0
     122: getfield      #13                 // Field cipher:Ljavax/crypto/Cipher;
     125: iconst_1
     126: aload_0
     127: getfield      #15                 // Field certificate:Ljava/security/cert/X509Certificate;
     130: invokevirtual #56                 // Method javax/crypto/Cipher.init:(ILjava/security/cert/Certificate;)V
     133: aload_0
     134: aload_0
     135: getfield      #13                 // Field cipher:Ljavax/crypto/Cipher;
     138: aload_0
     139: getfield      #7                  // Field auth_value:Ljava/lang/String;
     142: invokevirtual #57                 // Method java/lang/String.getBytes:()[B
     145: invokevirtual #29                 // Method javax/crypto/Cipher.doFinal:([B)[B
     148: putfield      #10                 // Field encryptedToken:[B
     151: aload_0
     152: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
     155: invokeinterface #24,  1           // InterfaceMethod org/jgroups/logging/Log.isDebugEnabled:()Z
     160: ifeq          194
     163: aload_0
     164: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
     167: new           #50                 // class java/lang/StringBuilder
     170: dup
     171: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
     174: ldc           #58                 // String encryptedToken =
     176: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     179: aload_0
     180: getfield      #10                 // Field encryptedToken:[B
     183: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     186: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     189: invokeinterface #26,  2           // InterfaceMethod org/jgroups/logging/Log.debug:(Ljava/lang/String;)V
     194: aload_1
     195: aload_0
     196: getfield      #5                  // Field cert_alias:Ljava/lang/String;
     199: new           #60                 // class java/security/KeyStore$PasswordProtection
     202: dup
     203: aload_0
     204: getfield      #11                 // Field cert_password:[C
     207: invokespecial #61                 // Method java/security/KeyStore$PasswordProtection."<init>":([C)V
     210: invokevirtual #62                 // Method java/security/KeyStore.getEntry:(Ljava/lang/String;Ljava/security/KeyStore$ProtectionParameter;)Ljava/security/KeyStore$Entry;
     213: checkcast     #63                 // class java/security/KeyStore$PrivateKeyEntry
     216: astore_3
     217: aload_0
     218: aload_3
     219: invokevirtual #64                 // Method java/security/KeyStore$PrivateKeyEntry.getPrivateKey:()Ljava/security/PrivateKey;
     222: putfield      #14                 // Field certPrivateKey:Ljava/security/PrivateKey;
     225: aload_0
     226: iconst_1
     227: putfield      #2                  // Field valueSet:Z
     230: aload_0
     231: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
     234: invokeinterface #24,  1           // InterfaceMethod org/jgroups/logging/Log.isDebugEnabled:()Z
     239: ifeq          276
     242: aload_0
     243: getfield      #18                 // Field log:Lorg/jgroups/logging/Log;
     246: new           #50                 // class java/lang/StringBuilder
     249: dup
     250: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
     253: ldc           #65                 // String certPrivateKey =
     255: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     258: aload_0
     259: getfield      #14                 // Field certPrivateKey:Ljava/security/PrivateKey;
     262: invokevirtual #66                 // Method java/lang/Object.toString:()Ljava/lang/String;
     265: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     268: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     271: invokeinterface #26,  2           // InterfaceMethod org/jgroups/logging/Log.debug:(Ljava/lang/String;)V
     276: return
}
