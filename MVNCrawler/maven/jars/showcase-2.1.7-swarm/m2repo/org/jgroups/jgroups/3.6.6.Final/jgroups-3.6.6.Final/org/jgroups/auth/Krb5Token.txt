Compiled from "Krb5Token.java"
public class org.jgroups.auth.Krb5Token extends org.jgroups.auth.AuthToken {
  private static final java.lang.String JASS_SECURITY_CONFIG;

  public static final java.lang.String CLIENT_PRINCIPAL_NAME;

  public static final java.lang.String CLIENT_PASSWORD;

  public static final java.lang.String SERVICE_PRINCIPAL_NAME;

  private static final org.jgroups.auth.Krb5TokenUtils kerb5Utils;

  protected java.lang.String client_principal_name;

  protected java.lang.String client_password;

  protected java.lang.String service_principal_name;

  private javax.security.auth.Subject subject;

  private byte[] krbServiceTicket;

  private byte[] remoteKrbServiceTicket;

  public org.jgroups.auth.Krb5Token();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jgroups/auth/AuthToken."<init>":()V
       4: return

  public void setValue(java.util.Properties);
    Code:
       0: aload_1
       1: ldc           #2                  // String client_principal_name
       3: invokevirtual #3                  // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       6: dup
       7: astore_2
       8: ifnull        23
      11: aload_0
      12: aload_2
      13: putfield      #4                  // Field client_principal_name:Ljava/lang/String;
      16: aload_1
      17: ldc           #2                  // String client_principal_name
      19: invokevirtual #5                  // Method java/util/Properties.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      22: pop
      23: aload_1
      24: ldc           #6                  // String client_password
      26: invokevirtual #3                  // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      29: dup
      30: astore_2
      31: ifnull        46
      34: aload_0
      35: aload_2
      36: putfield      #7                  // Field client_password:Ljava/lang/String;
      39: aload_1
      40: ldc           #6                  // String client_password
      42: invokevirtual #5                  // Method java/util/Properties.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      45: pop
      46: aload_1
      47: ldc           #8                  // String service_principal_name
      49: invokevirtual #3                  // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      52: dup
      53: astore_2
      54: ifnull        69
      57: aload_0
      58: aload_2
      59: putfield      #9                  // Field service_principal_name:Ljava/lang/String;
      62: aload_1
      63: ldc           #8                  // String service_principal_name
      65: invokevirtual #5                  // Method java/util/Properties.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      68: pop
      69: aload_0
      70: invokespecial #10                 // Method authenticateClientPrincipal:()V
      73: goto          94
      76: astore_3
      77: aload_0
      78: getfield      #12                 // Field log:Lorg/jgroups/logging/Log;
      81: ldc           #13                 // String Krb5Token failed to authenticate
      83: aload_3
      84: invokeinterface #14,  3           // InterfaceMethod org/jgroups/logging/Log.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
      89: aload_0
      90: aconst_null
      91: putfield      #15                 // Field subject:Ljavax/security/auth/Subject;
      94: return
    Exception table:
       from    to  target type
          69    73    76   Class java/lang/Exception

  public java.lang.String getName();
    Code:
       0: ldc_w         #16                 // class org/jgroups/auth/Krb5Token
       3: invokevirtual #17                 // Method java/lang/Class.getName:()Ljava/lang/String;
       6: areturn

  public boolean authenticate(org.jgroups.auth.AuthToken, org.jgroups.Message);
    Code:
       0: aload_0
       1: invokespecial #18                 // Method isAuthenticated:()Z
       4: ifne          20
       7: aload_0
       8: getfield      #12                 // Field log:Lorg/jgroups/logging/Log;
      11: ldc           #19                 // String Krb5Token failed to setup correctly - cannot authenticate any peers
      13: invokeinterface #20,  2           // InterfaceMethod org/jgroups/logging/Log.error:(Ljava/lang/String;)V
      18: iconst_0
      19: ireturn
      20: aload_1
      21: ifnull        60
      24: aload_1
      25: instanceof    #16                 // class org/jgroups/auth/Krb5Token
      28: ifeq          60
      31: aload_1
      32: checkcast     #16                 // class org/jgroups/auth/Krb5Token
      35: astore_3
      36: aload_0
      37: aload_3
      38: invokespecial #21                 // Method validateRemoteServiceTicket:(Lorg/jgroups/auth/Krb5Token;)V
      41: iconst_1
      42: ireturn
      43: astore        4
      45: aload_0
      46: getfield      #12                 // Field log:Lorg/jgroups/logging/Log;
      49: ldc           #22                 // String Krb5Token service ticket validation failed
      51: aload         4
      53: invokeinterface #23,  3           // InterfaceMethod org/jgroups/logging/Log.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
      58: iconst_0
      59: ireturn
      60: iconst_0
      61: ireturn
    Exception table:
       from    to  target type
          36    42    43   Class java/lang/Exception

  public void writeTo(java.io.DataOutput) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokespecial #18                 // Method isAuthenticated:()Z
       4: ifeq          16
       7: aload_0
       8: invokespecial #24                 // Method generateServiceTicket:()V
      11: aload_0
      12: aload_1
      13: invokespecial #25                 // Method writeServiceTicketToSream:(Ljava/io/DataOutput;)V
      16: return

  public void readFrom(java.io.DataInput) throws java.io.IOException, java.lang.IllegalAccessException, java.lang.InstantiationException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #26                 // Method readRemoteServiceTicketFromStream:(Ljava/io/DataInput;)V
       5: return

  public int size();
    Code:
       0: aload_0
       1: getfield      #27                 // Field krbServiceTicket:[B
       4: invokestatic  #28                 // Method org/jgroups/util/Util.size:([B)I
       7: ireturn

  private boolean isAuthenticated();
    Code:
       0: aload_0
       1: getfield      #15                 // Field subject:Ljavax/security/auth/Subject;
       4: ifnull        11
       7: iconst_1
       8: goto          12
      11: iconst_0
      12: ireturn

  private void authenticateClientPrincipal() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getstatic     #29                 // Field kerb5Utils:Lorg/jgroups/auth/Krb5TokenUtils;
       4: ldc           #30                 // String JGoupsKrb5TokenSecurityConf
       6: aload_0
       7: getfield      #4                  // Field client_principal_name:Ljava/lang/String;
      10: aload_0
      11: getfield      #7                  // Field client_password:Ljava/lang/String;
      14: invokevirtual #31                 // Method org/jgroups/auth/Krb5TokenUtils.generateSecuritySubject:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljavax/security/auth/Subject;
      17: putfield      #15                 // Field subject:Ljavax/security/auth/Subject;
      20: return

  private void generateServiceTicket() throws java.io.IOException;
    Code:
       0: aload_0
       1: getstatic     #29                 // Field kerb5Utils:Lorg/jgroups/auth/Krb5TokenUtils;
       4: pop
       5: aload_0
       6: getfield      #15                 // Field subject:Ljavax/security/auth/Subject;
       9: aload_0
      10: getfield      #9                  // Field service_principal_name:Ljava/lang/String;
      13: invokestatic  #32                 // Method org/jgroups/auth/Krb5TokenUtils.initiateSecurityContext:(Ljavax/security/auth/Subject;Ljava/lang/String;)[B
      16: putfield      #27                 // Field krbServiceTicket:[B
      19: goto          34
      22: astore_1
      23: new           #34                 // class java/io/IOException
      26: dup
      27: ldc           #35                 // String Failed to generate serviceticket
      29: aload_1
      30: invokespecial #36                 // Method java/io/IOException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      33: athrow
      34: return
    Exception table:
       from    to  target type
           0    19    22   Class org/ietf/jgss/GSSException

  private void validateRemoteServiceTicket(org.jgroups.auth.Krb5Token) throws java.lang.Exception;
    Code:
       0: aload_1
       1: getfield      #37                 // Field remoteKrbServiceTicket:[B
       4: astore_2
       5: getstatic     #29                 // Field kerb5Utils:Lorg/jgroups/auth/Krb5TokenUtils;
       8: pop
       9: aload_0
      10: getfield      #15                 // Field subject:Ljavax/security/auth/Subject;
      13: aload_2
      14: invokestatic  #38                 // Method org/jgroups/auth/Krb5TokenUtils.validateSecurityContext:(Ljavax/security/auth/Subject;[B)Ljava/lang/String;
      17: astore_3
      18: aload_3
      19: aload_0
      20: getfield      #4                  // Field client_principal_name:Ljava/lang/String;
      23: invokevirtual #39                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      26: ifne          39
      29: new           #11                 // class java/lang/Exception
      32: dup
      33: ldc           #40                 // String Client Principal Names did not match
      35: invokespecial #41                 // Method java/lang/Exception."<init>":(Ljava/lang/String;)V
      38: athrow
      39: return

  private void writeServiceTicketToSream(java.io.DataOutput) throws java.io.IOException;
    Code:
       0: getstatic     #29                 // Field kerb5Utils:Lorg/jgroups/auth/Krb5TokenUtils;
       3: pop
       4: aload_0
       5: getfield      #27                 // Field krbServiceTicket:[B
       8: aload_1
       9: invokestatic  #42                 // Method org/jgroups/auth/Krb5TokenUtils.encodeDataToStream:([BLjava/io/DataOutput;)V
      12: goto          28
      15: astore_2
      16: aload_2
      17: athrow
      18: astore_2
      19: new           #34                 // class java/io/IOException
      22: dup
      23: aload_2
      24: invokespecial #43                 // Method java/io/IOException."<init>":(Ljava/lang/Throwable;)V
      27: athrow
      28: return
    Exception table:
       from    to  target type
           0    12    15   Class java/io/IOException
           0    12    18   Class java/lang/Exception

  private void readRemoteServiceTicketFromStream(java.io.DataInput) throws java.io.IOException;
    Code:
       0: aload_0
       1: getstatic     #29                 // Field kerb5Utils:Lorg/jgroups/auth/Krb5TokenUtils;
       4: pop
       5: aload_1
       6: invokestatic  #44                 // Method org/jgroups/auth/Krb5TokenUtils.decodeDataFromStream:(Ljava/io/DataInput;)[B
       9: putfield      #37                 // Field remoteKrbServiceTicket:[B
      12: goto          28
      15: astore_2
      16: aload_2
      17: athrow
      18: astore_2
      19: new           #34                 // class java/io/IOException
      22: dup
      23: aload_2
      24: invokespecial #43                 // Method java/io/IOException."<init>":(Ljava/lang/Throwable;)V
      27: athrow
      28: return
    Exception table:
       from    to  target type
           0    12    15   Class java/io/IOException
           0    12    18   Class java/lang/Exception

  static {};
    Code:
       0: new           #45                 // class org/jgroups/auth/Krb5TokenUtils
       3: dup
       4: invokespecial #46                 // Method org/jgroups/auth/Krb5TokenUtils."<init>":()V
       7: putstatic     #29                 // Field kerb5Utils:Lorg/jgroups/auth/Krb5TokenUtils;
      10: return
}
