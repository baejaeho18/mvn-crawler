Compiled from "RATE_LIMITER.java"
public class org.jgroups.protocols.RATE_LIMITER extends org.jgroups.stack.Protocol {
  protected long max_bytes;

  protected long time_period;

  protected long time_period_ns;

  protected long num_bytes_sent_in_period;

  protected long current_period_start;

  protected final java.util.concurrent.locks.Lock lock;

  protected int num_blockings;

  protected long total_block_time;

  protected int frag_size;

  protected volatile boolean running;

  public org.jgroups.protocols.RATE_LIMITER();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jgroups/stack/Protocol."<init>":()V
       4: aload_0
       5: ldc2_w        #2                  // long 300000l
       8: putfield      #4                  // Field max_bytes:J
      11: aload_0
      12: ldc2_w        #5                  // long 10l
      15: putfield      #7                  // Field time_period:J
      18: aload_0
      19: lconst_0
      20: putfield      #8                  // Field num_bytes_sent_in_period:J
      23: aload_0
      24: new           #9                  // class java/util/concurrent/locks/ReentrantLock
      27: dup
      28: invokespecial #10                 // Method java/util/concurrent/locks/ReentrantLock."<init>":()V
      31: putfield      #11                 // Field lock:Ljava/util/concurrent/locks/Lock;
      34: aload_0
      35: iconst_0
      36: putfield      #12                 // Field num_blockings:I
      39: aload_0
      40: lconst_0
      41: putfield      #13                 // Field total_block_time:J
      44: aload_0
      45: iconst_0
      46: putfield      #14                 // Field frag_size:I
      49: aload_0
      50: iconst_1
      51: putfield      #15                 // Field running:Z
      54: return

  public long getMaxBytes();
    Code:
       0: aload_0
       1: getfield      #4                  // Field max_bytes:J
       4: lreturn

  public void setMaxBytes(long);
    Code:
       0: aload_0
       1: lload_1
       2: putfield      #4                  // Field max_bytes:J
       5: return

  public long getTimePeriod();
    Code:
       0: aload_0
       1: getfield      #7                  // Field time_period:J
       4: lreturn

  public void setTimePeriod(long);
    Code:
       0: aload_0
       1: lload_1
       2: putfield      #7                  // Field time_period:J
       5: aload_0
       6: getstatic     #16                 // Field java/util/concurrent/TimeUnit.NANOSECONDS:Ljava/util/concurrent/TimeUnit;
       9: lload_1
      10: getstatic     #17                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
      13: invokevirtual #18                 // Method java/util/concurrent/TimeUnit.convert:(JLjava/util/concurrent/TimeUnit;)J
      16: putfield      #19                 // Field time_period_ns:J
      19: return

  public long getTotalBlockTime();
    Code:
       0: getstatic     #17                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
       3: aload_0
       4: getfield      #13                 // Field total_block_time:J
       7: getstatic     #16                 // Field java/util/concurrent/TimeUnit.NANOSECONDS:Ljava/util/concurrent/TimeUnit;
      10: invokevirtual #18                 // Method java/util/concurrent/TimeUnit.convert:(JLjava/util/concurrent/TimeUnit;)J
      13: lreturn

  public double getAverageBlockTime();
    Code:
       0: aload_0
       1: invokevirtual #20                 // Method getTotalBlockTime:()J
       4: lstore_1
       5: aload_0
       6: getfield      #12                 // Field num_blockings:I
       9: ifne          16
      12: dconst_0
      13: goto          24
      16: lload_1
      17: l2d
      18: aload_0
      19: getfield      #12                 // Field num_blockings:I
      22: i2d
      23: ddiv
      24: dreturn

  public void resetStats();
    Code:
       0: aload_0
       1: invokespecial #21                 // Method org/jgroups/stack/Protocol.resetStats:()V
       4: aload_0
       5: iconst_0
       6: putfield      #12                 // Field num_blockings:I
       9: aload_0
      10: lconst_0
      11: putfield      #13                 // Field total_block_time:J
      14: return

  public void init() throws java.lang.Exception;
    Code:
       0: aload_0
       1: invokespecial #22                 // Method org/jgroups/stack/Protocol.init:()V
       4: aload_0
       5: getfield      #7                  // Field time_period:J
       8: lconst_0
       9: lcmp
      10: ifgt          23
      13: new           #23                 // class java/lang/IllegalArgumentException
      16: dup
      17: ldc           #24                 // String time_period needs to be positive
      19: invokespecial #25                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      22: athrow
      23: aload_0
      24: getstatic     #16                 // Field java/util/concurrent/TimeUnit.NANOSECONDS:Ljava/util/concurrent/TimeUnit;
      27: aload_0
      28: getfield      #7                  // Field time_period:J
      31: getstatic     #17                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
      34: invokevirtual #18                 // Method java/util/concurrent/TimeUnit.convert:(JLjava/util/concurrent/TimeUnit;)J
      37: putfield      #19                 // Field time_period_ns:J
      40: return

  public void start() throws java.lang.Exception;
    Code:
       0: aload_0
       1: invokespecial #26                 // Method org/jgroups/stack/Protocol.start:()V
       4: aload_0
       5: getfield      #4                  // Field max_bytes:J
       8: aload_0
       9: getfield      #14                 // Field frag_size:I
      12: i2l
      13: lcmp
      14: ifge          64
      17: new           #27                 // class java/lang/IllegalStateException
      20: dup
      21: new           #28                 // class java/lang/StringBuilder
      24: dup
      25: invokespecial #29                 // Method java/lang/StringBuilder."<init>":()V
      28: ldc           #30                 // String max_bytes (
      30: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      33: aload_0
      34: getfield      #4                  // Field max_bytes:J
      37: invokevirtual #32                 // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
      40: ldc           #33                 // String ) need to be bigger than frag_size (
      42: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      45: aload_0
      46: getfield      #14                 // Field frag_size:I
      49: invokevirtual #34                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      52: ldc           #35                 // String )
      54: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      57: invokevirtual #36                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      60: invokespecial #37                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      63: athrow
      64: aload_0
      65: iconst_1
      66: putfield      #15                 // Field running:Z
      69: return

  public void stop();
    Code:
       0: aload_0
       1: iconst_0
       2: putfield      #15                 // Field running:Z
       5: aload_0
       6: invokespecial #38                 // Method org/jgroups/stack/Protocol.stop:()V
       9: return

  public java.lang.Object down(org.jgroups.Event);
    Code:
       0: aload_1
       1: invokevirtual #39                 // Method org/jgroups/Event.getType:()I
       4: iconst_1
       5: if_icmpne     274
       8: aload_1
       9: invokevirtual #40                 // Method org/jgroups/Event.getArg:()Ljava/lang/Object;
      12: checkcast     #41                 // class org/jgroups/Message
      15: astore_2
      16: aload_2
      17: invokevirtual #42                 // Method org/jgroups/Message.getLength:()I
      20: istore_3
      21: iload_3
      22: ifeq          35
      25: aload_2
      26: getstatic     #43                 // Field org/jgroups/Message$Flag.NO_FC:Lorg/jgroups/Message$Flag;
      29: invokevirtual #44                 // Method org/jgroups/Message.isFlagSet:(Lorg/jgroups/Message$Flag;)Z
      32: ifeq          44
      35: aload_0
      36: getfield      #45                 // Field down_prot:Lorg/jgroups/stack/Protocol;
      39: aload_1
      40: invokevirtual #46                 // Method org/jgroups/stack/Protocol.down:(Lorg/jgroups/Event;)Ljava/lang/Object;
      43: areturn
      44: aload_0
      45: getfield      #11                 // Field lock:Ljava/util/concurrent/locks/Lock;
      48: invokeinterface #47,  1           // InterfaceMethod java/util/concurrent/locks/Lock.lock:()V
      53: iload_3
      54: i2l
      55: aload_0
      56: getfield      #4                  // Field max_bytes:J
      59: lcmp
      60: ifle          123
      63: aload_0
      64: getfield      #48                 // Field log:Lorg/jgroups/logging/Log;
      67: new           #28                 // class java/lang/StringBuilder
      70: dup
      71: invokespecial #29                 // Method java/lang/StringBuilder."<init>":()V
      74: ldc           #49                 // String message length (
      76: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      79: iload_3
      80: invokevirtual #34                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      83: ldc           #50                 // String  bytes) exceeded max_bytes (
      85: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      88: aload_0
      89: getfield      #4                  // Field max_bytes:J
      92: invokevirtual #32                 // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
      95: ldc           #51                 // String );
      97: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     100: ldc           #52                 // String adjusting max_bytes to
     102: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     105: iload_3
     106: invokevirtual #34                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     109: invokevirtual #36                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     112: invokeinterface #53,  2           // InterfaceMethod org/jgroups/logging/Log.error:(Ljava/lang/String;)V
     117: aload_0
     118: iload_3
     119: i2l
     120: putfield      #4                  // Field max_bytes:J
     123: aload_0
     124: getfield      #8                  // Field num_bytes_sent_in_period:J
     127: iload_3
     128: i2l
     129: ladd
     130: aload_0
     131: getfield      #4                  // Field max_bytes:J
     134: lcmp
     135: ifle          217
     138: invokestatic  #54                 // Method java/lang/System.nanoTime:()J
     141: lstore        4
     143: aload_0
     144: getfield      #19                 // Field time_period_ns:J
     147: lload         4
     149: aload_0
     150: getfield      #55                 // Field current_period_start:J
     153: lsub
     154: lsub
     155: lstore        6
     157: lload         6
     159: lconst_0
     160: lcmp
     161: ifle          190
     164: lload         6
     166: invokestatic  #56                 // Method java/util/concurrent/locks/LockSupport.parkNanos:(J)V
     169: aload_0
     170: dup
     171: getfield      #12                 // Field num_blockings:I
     174: iconst_1
     175: iadd
     176: putfield      #12                 // Field num_blockings:I
     179: aload_0
     180: dup
     181: getfield      #13                 // Field total_block_time:J
     184: lload         6
     186: ladd
     187: putfield      #13                 // Field total_block_time:J
     190: aload_0
     191: lload         6
     193: lconst_0
     194: lcmp
     195: ifle          206
     198: lload         4
     200: lload         6
     202: ladd
     203: goto          209
     206: invokestatic  #54                 // Method java/lang/System.nanoTime:()J
     209: putfield      #55                 // Field current_period_start:J
     212: aload_0
     213: lconst_0
     214: putfield      #8                  // Field num_bytes_sent_in_period:J
     217: aload_0
     218: dup
     219: getfield      #8                  // Field num_bytes_sent_in_period:J
     222: iload_3
     223: i2l
     224: ladd
     225: putfield      #8                  // Field num_bytes_sent_in_period:J
     228: aload_0
     229: getfield      #11                 // Field lock:Ljava/util/concurrent/locks/Lock;
     232: invokeinterface #57,  1           // InterfaceMethod java/util/concurrent/locks/Lock.unlock:()V
     237: goto          265
     240: astore        8
     242: aload_0
     243: dup
     244: getfield      #8                  // Field num_bytes_sent_in_period:J
     247: iload_3
     248: i2l
     249: ladd
     250: putfield      #8                  // Field num_bytes_sent_in_period:J
     253: aload_0
     254: getfield      #11                 // Field lock:Ljava/util/concurrent/locks/Lock;
     257: invokeinterface #57,  1           // InterfaceMethod java/util/concurrent/locks/Lock.unlock:()V
     262: aload         8
     264: athrow
     265: aload_0
     266: getfield      #45                 // Field down_prot:Lorg/jgroups/stack/Protocol;
     269: aload_1
     270: invokevirtual #46                 // Method org/jgroups/stack/Protocol.down:(Lorg/jgroups/Event;)Ljava/lang/Object;
     273: areturn
     274: aload_1
     275: invokevirtual #39                 // Method org/jgroups/Event.getType:()I
     278: bipush        56
     280: if_icmpne     405
     283: aload_1
     284: invokevirtual #40                 // Method org/jgroups/Event.getArg:()Ljava/lang/Object;
     287: checkcast     #58                 // class java/util/Map
     290: astore_2
     291: aload_2
     292: ifnull        309
     295: aload_2
     296: ldc           #59                 // String frag_size
     298: invokeinterface #60,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     303: checkcast     #61                 // class java/lang/Integer
     306: goto          310
     309: aconst_null
     310: astore_3
     311: aload_3
     312: ifnull        323
     315: aload_0
     316: aload_3
     317: invokevirtual #62                 // Method java/lang/Integer.intValue:()I
     320: putfield      #14                 // Field frag_size:I
     323: aload_0
     324: getfield      #14                 // Field frag_size:I
     327: ifle          405
     330: aload_0
     331: getfield      #4                  // Field max_bytes:J
     334: aload_0
     335: getfield      #14                 // Field frag_size:I
     338: i2l
     339: lrem
     340: lconst_0
     341: lcmp
     342: ifeq          405
     345: aload_0
     346: getfield      #48                 // Field log:Lorg/jgroups/logging/Log;
     349: invokeinterface #63,  1           // InterfaceMethod org/jgroups/logging/Log.isWarnEnabled:()Z
     354: ifeq          405
     357: aload_0
     358: getfield      #48                 // Field log:Lorg/jgroups/logging/Log;
     361: new           #28                 // class java/lang/StringBuilder
     364: dup
     365: invokespecial #29                 // Method java/lang/StringBuilder."<init>":()V
     368: ldc           #64                 // String For optimal performance, max_bytes (
     370: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     373: aload_0
     374: getfield      #4                  // Field max_bytes:J
     377: invokevirtual #32                 // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
     380: ldc           #65                 // String ) should be a multiple of frag_size (
     382: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     385: aload_0
     386: getfield      #14                 // Field frag_size:I
     389: invokevirtual #34                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     392: ldc           #35                 // String )
     394: invokevirtual #31                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     397: invokevirtual #36                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     400: invokeinterface #66,  2           // InterfaceMethod org/jgroups/logging/Log.warn:(Ljava/lang/String;)V
     405: aload_0
     406: getfield      #45                 // Field down_prot:Lorg/jgroups/stack/Protocol;
     409: aload_1
     410: invokevirtual #46                 // Method org/jgroups/stack/Protocol.down:(Lorg/jgroups/Event;)Ljava/lang/Object;
     413: areturn
    Exception table:
       from    to  target type
          53   217   240   any
         240   242   240   any
}
