Compiled from "InvocationContextInterceptor.java"
public class org.infinispan.interceptors.InvocationContextInterceptor extends org.infinispan.interceptors.base.CommandInterceptor {
  private javax.transaction.TransactionManager tm;

  private org.infinispan.factories.ComponentRegistry componentRegistry;

  private org.infinispan.transaction.impl.TransactionTable txTable;

  private org.infinispan.context.InvocationContextContainer invocationContextContainer;

  private static final org.infinispan.util.logging.Log log;

  private static final boolean trace;

  private volatile boolean shuttingDown;

  public org.infinispan.interceptors.InvocationContextInterceptor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/infinispan/interceptors/base/CommandInterceptor."<init>":()V
       4: aload_0
       5: iconst_0
       6: putfield      #2                  // Field shuttingDown:Z
       9: return

  protected org.infinispan.util.logging.Log getLog();
    Code:
       0: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
       3: areturn

  private void setStartStatus();
    Code:
       0: aload_0
       1: iconst_0
       2: putfield      #2                  // Field shuttingDown:Z
       5: return

  private void setStopStatus();
    Code:
       0: aload_0
       1: iconst_1
       2: putfield      #2                  // Field shuttingDown:Z
       5: return

  public void init(javax.transaction.TransactionManager, org.infinispan.factories.ComponentRegistry, org.infinispan.transaction.impl.TransactionTable, org.infinispan.context.InvocationContextContainer);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #4                  // Field tm:Ljavax/transaction/TransactionManager;
       5: aload_0
       6: aload_2
       7: putfield      #5                  // Field componentRegistry:Lorg/infinispan/factories/ComponentRegistry;
      10: aload_0
      11: aload_3
      12: putfield      #6                  // Field txTable:Lorg/infinispan/transaction/impl/TransactionTable;
      15: aload_0
      16: aload         4
      18: putfield      #7                  // Field invocationContextContainer:Lorg/infinispan/context/InvocationContextContainer;
      21: return

  public java.lang.Object handleDefault(org.infinispan.context.InvocationContext, org.infinispan.commands.VisitableCommand) throws java.lang.Throwable;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #8                  // Method handleAll:(Lorg/infinispan/context/InvocationContext;Lorg/infinispan/commands/VisitableCommand;)Ljava/lang/Object;
       6: areturn

  public java.lang.Object visitLockControlCommand(org.infinispan.context.impl.TxInvocationContext, org.infinispan.commands.control.LockControlCommand) throws java.lang.Throwable;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #8                  // Method handleAll:(Lorg/infinispan/context/InvocationContext;Lorg/infinispan/commands/VisitableCommand;)Ljava/lang/Object;
       6: astore_3
       7: aload_3
       8: ifnonnull     18
      11: iconst_0
      12: invokestatic  #9                  // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
      15: goto          19
      18: aload_3
      19: areturn

  private java.lang.Object handleAll(org.infinispan.context.InvocationContext, org.infinispan.commands.VisitableCommand) throws java.lang.Throwable;
    Code:
       0: aload_0
       1: getfield      #5                  // Field componentRegistry:Lorg/infinispan/factories/ComponentRegistry;
       4: invokevirtual #10                 // Method org/infinispan/factories/ComponentRegistry.getStatus:()Lorg/infinispan/lifecycle/ComponentStatus;
       7: astore_3
       8: aload_2
       9: aload_3
      10: invokeinterface #11,  2           // InterfaceMethod org/infinispan/commands/VisitableCommand.ignoreCommandOnStatus:(Lorg/infinispan/lifecycle/ComponentStatus;)Z
      15: ifeq          45
      18: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
      21: ldc           #12                 // String Status: %s : Ignoring %s command
      23: aload_3
      24: aload_2
      25: invokeinterface #13,  4           // InterfaceMethod org/infinispan/util/logging/Log.debugf:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      30: aconst_null
      31: astore        4
      33: aload_0
      34: getfield      #7                  // Field invocationContextContainer:Lorg/infinispan/context/InvocationContextContainer;
      37: invokeinterface #14,  1           // InterfaceMethod org/infinispan/context/InvocationContextContainer.clearThreadLocal:()V
      42: aload         4
      44: areturn
      45: aload_3
      46: invokevirtual #15                 // Method org/infinispan/lifecycle/ComponentStatus.isTerminated:()Z
      49: ifeq          65
      52: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
      55: aload_0
      56: invokespecial #16                 // Method getCacheNamePrefix:()Ljava/lang/String;
      59: invokeinterface #17,  2           // InterfaceMethod org/infinispan/util/logging/Log.cacheIsTerminated:(Ljava/lang/String;)Lorg/infinispan/IllegalLifecycleStateException;
      64: athrow
      65: aload_0
      66: aload_3
      67: aload_1
      68: invokespecial #18                 // Method stoppingAndNotAllowed:(Lorg/infinispan/lifecycle/ComponentStatus;Lorg/infinispan/context/InvocationContext;)Z
      71: ifeq          87
      74: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
      77: aload_0
      78: invokespecial #16                 // Method getCacheNamePrefix:()Ljava/lang/String;
      81: invokeinterface #19,  2           // InterfaceMethod org/infinispan/util/logging/Log.cacheIsStopping:(Ljava/lang/String;)Lorg/infinispan/IllegalLifecycleStateException;
      86: athrow
      87: aload_0
      88: getfield      #5                  // Field componentRegistry:Lorg/infinispan/factories/ComponentRegistry;
      91: invokevirtual #20                 // Method org/infinispan/factories/ComponentRegistry.getCacheName:()Ljava/lang/String;
      94: getstatic     #21                 // Field trace:Z
      97: invokestatic  #22                 // Method org/infinispan/util/logging/LogFactory.pushNDC:(Ljava/lang/String;Z)V
     100: aload_0
     101: getfield      #7                  // Field invocationContextContainer:Lorg/infinispan/context/InvocationContextContainer;
     104: aload_1
     105: invokeinterface #23,  2           // InterfaceMethod org/infinispan/context/InvocationContextContainer.setThreadLocal:(Lorg/infinispan/context/InvocationContext;)V
     110: getstatic     #21                 // Field trace:Z
     113: ifeq          128
     116: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
     119: ldc           #24                 // String Invoked with command %s and InvocationContext [%s]
     121: aload_2
     122: aload_1
     123: invokeinterface #25,  4           // InterfaceMethod org/infinispan/util/logging/Log.tracef:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     128: aload_1
     129: ifnonnull     142
     132: new           #26                 // class java/lang/IllegalStateException
     135: dup
     136: ldc           #27                 // String Null context not allowed!!
     138: invokespecial #28                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     141: athrow
     142: aload_0
     143: aload_1
     144: aload_2
     145: invokevirtual #29                 // Method invokeNextInterceptor:(Lorg/infinispan/context/InvocationContext;Lorg/infinispan/commands/VisitableCommand;)Ljava/lang/Object;
     148: astore        4
     150: getstatic     #21                 // Field trace:Z
     153: invokestatic  #30                 // Method org/infinispan/util/logging/LogFactory.popNDC:(Z)V
     156: aload_0
     157: getfield      #7                  // Field invocationContextContainer:Lorg/infinispan/context/InvocationContextContainer;
     160: invokeinterface #14,  1           // InterfaceMethod org/infinispan/context/InvocationContextContainer.clearThreadLocal:()V
     165: aload         4
     167: areturn
     168: astore        4
     170: aload         4
     172: athrow
     173: astore        4
     175: aload_2
     176: instanceof    #33                 // class org/infinispan/commands/FlagAffectedCommand
     179: ifeq          201
     182: aload_2
     183: checkcast     #33                 // class org/infinispan/commands/FlagAffectedCommand
     186: getstatic     #34                 // Field org/infinispan/context/Flag.FAIL_SILENTLY:Lorg/infinispan/context/Flag;
     189: invokeinterface #35,  2           // InterfaceMethod org/infinispan/commands/FlagAffectedCommand.hasFlag:(Lorg/infinispan/context/Flag;)Z
     194: ifeq          201
     197: iconst_1
     198: goto          202
     201: iconst_0
     202: istore        5
     204: iload         5
     206: ifne          216
     209: aload_0
     210: getfield      #2                  // Field shuttingDown:Z
     213: ifeq          220
     216: iconst_1
     217: goto          221
     220: iconst_0
     221: istore        5
     223: iload         5
     225: ifeq          283
     228: aload_0
     229: getfield      #2                  // Field shuttingDown:Z
     232: ifeq          250
     235: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
     238: ldc           #36                 // String Exception while executing code, but we\'re shutting down so failing silently.
     240: aload         4
     242: invokeinterface #37,  3           // InterfaceMethod org/infinispan/util/logging/Log.trace:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     247: goto          262
     250: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
     253: ldc           #38                 // String Exception while executing code, failing silently...
     255: aload         4
     257: invokeinterface #37,  3           // InterfaceMethod org/infinispan/util/logging/Log.trace:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     262: aconst_null
     263: astore        6
     265: getstatic     #21                 // Field trace:Z
     268: invokestatic  #30                 // Method org/infinispan/util/logging/LogFactory.popNDC:(Z)V
     271: aload_0
     272: getfield      #7                  // Field invocationContextContainer:Lorg/infinispan/context/InvocationContextContainer;
     275: invokeinterface #14,  1           // InterfaceMethod org/infinispan/context/InvocationContextContainer.clearThreadLocal:()V
     280: aload         6
     282: areturn
     283: aload         4
     285: instanceof    #39                 // class org/infinispan/transaction/WriteSkewException
     288: ifeq          306
     291: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
     294: ldc           #40                 // String Exception executing call
     296: aload         4
     298: invokeinterface #41,  3           // InterfaceMethod org/infinispan/util/logging/Log.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     303: goto          354
     306: aload         4
     308: instanceof    #42                 // class org/infinispan/statetransfer/OutdatedTopologyException
     311: ifeq          327
     314: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
     317: aload         4
     319: invokeinterface #43,  2           // InterfaceMethod org/infinispan/util/logging/Log.outdatedTopology:(Ljava/lang/Throwable;)V
     324: goto          354
     327: aload_0
     328: aload_1
     329: aload_2
     330: invokespecial #44                 // Method extractWrittenKeys:(Lorg/infinispan/context/InvocationContext;Lorg/infinispan/commands/VisitableCommand;)Ljava/util/Collection;
     333: astore        6
     335: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
     338: aload_2
     339: invokevirtual #45                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
     342: invokevirtual #46                 // Method java/lang/Class.getSimpleName:()Ljava/lang/String;
     345: aload         6
     347: aload         4
     349: invokeinterface #47,  4           // InterfaceMethod org/infinispan/util/logging/Log.executionError:(Ljava/lang/String;Ljava/util/Collection;Ljava/lang/Throwable;)V
     354: aload_1
     355: invokeinterface #48,  1           // InterfaceMethod org/infinispan/context/InvocationContext.isInTxScope:()Z
     360: ifeq          406
     363: aload_1
     364: invokeinterface #49,  1           // InterfaceMethod org/infinispan/context/InvocationContext.isOriginLocal:()Z
     369: ifeq          406
     372: getstatic     #21                 // Field trace:Z
     375: ifeq          388
     378: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
     381: ldc           #50                 // String Transaction marked for rollback as exception was received.
     383: invokeinterface #51,  2           // InterfaceMethod org/infinispan/util/logging/Log.trace:(Ljava/lang/Object;)V
     388: aload_0
     389: aload_1
     390: aload         4
     392: invokespecial #52                 // Method markTxForRollbackAndRethrow:(Lorg/infinispan/context/InvocationContext;Ljava/lang/Throwable;)Ljava/lang/Object;
     395: pop
     396: new           #26                 // class java/lang/IllegalStateException
     399: dup
     400: ldc           #53                 // String This should not be reached
     402: invokespecial #28                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     405: athrow
     406: aload         4
     408: athrow
     409: astore        7
     411: getstatic     #21                 // Field trace:Z
     414: invokestatic  #30                 // Method org/infinispan/util/logging/LogFactory.popNDC:(Z)V
     417: aload         7
     419: athrow
     420: astore        8
     422: aload_0
     423: getfield      #7                  // Field invocationContextContainer:Lorg/infinispan/context/InvocationContextContainer;
     426: invokeinterface #14,  1           // InterfaceMethod org/infinispan/context/InvocationContextContainer.clearThreadLocal:()V
     431: aload         8
     433: athrow
    Exception table:
       from    to  target type
         142   150   168   Class org/infinispan/InvalidCacheUsageException
         142   150   173   Class java/lang/Throwable
         110   150   409   any
         168   265   409   any
         283   411   409   any
           0    33   420   any
          45   156   420   any
         168   271   420   any
         283   422   420   any

  private java.util.Collection<java.lang.Object> extractWrittenKeys(org.infinispan.context.InvocationContext, org.infinispan.commands.VisitableCommand);
    Code:
       0: aload_2
       1: instanceof    #54                 // class org/infinispan/commands/write/WriteCommand
       4: ifeq          17
       7: aload_2
       8: checkcast     #54                 // class org/infinispan/commands/write/WriteCommand
      11: invokeinterface #55,  1           // InterfaceMethod org/infinispan/commands/write/WriteCommand.getAffectedKeys:()Ljava/util/Set;
      16: areturn
      17: aload_2
      18: instanceof    #56                 // class org/infinispan/commands/control/LockControlCommand
      21: ifeq          28
      24: invokestatic  #57                 // Method java/util/Collections.emptyList:()Ljava/util/List;
      27: areturn
      28: aload_2
      29: instanceof    #58                 // class org/infinispan/commands/tx/TransactionBoundaryCommand
      32: ifeq          45
      35: aload_1
      36: checkcast     #59                 // class org/infinispan/context/impl/TxInvocationContext
      39: invokeinterface #60,  1           // InterfaceMethod org/infinispan/context/impl/TxInvocationContext.getAffectedKeys:()Ljava/util/Set;
      44: areturn
      45: invokestatic  #57                 // Method java/util/Collections.emptyList:()Ljava/util/List;
      48: areturn

  private java.lang.String getCacheNamePrefix();
    Code:
       0: aload_0
       1: getfield      #5                  // Field componentRegistry:Lorg/infinispan/factories/ComponentRegistry;
       4: invokevirtual #20                 // Method org/infinispan/factories/ComponentRegistry.getCacheName:()Ljava/lang/String;
       7: astore_1
       8: new           #61                 // class java/lang/StringBuilder
      11: dup
      12: invokespecial #62                 // Method java/lang/StringBuilder."<init>":()V
      15: ldc           #63                 // String Cache \'
      17: invokevirtual #64                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      20: aload_1
      21: invokevirtual #64                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      24: ldc           #65                 // String \'
      26: invokevirtual #64                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      29: invokevirtual #66                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      32: astore_2
      33: aload_1
      34: ldc           #68                 // String ___defaultcache
      36: invokevirtual #69                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      39: ifeq          45
      42: ldc           #70                 // String Default cache
      44: astore_2
      45: aload_2
      46: areturn

  private boolean stoppingAndNotAllowed(org.infinispan.lifecycle.ComponentStatus, org.infinispan.context.InvocationContext) throws java.lang.Exception;
    Code:
       0: aload_1
       1: invokevirtual #71                 // Method org/infinispan/lifecycle/ComponentStatus.isStopping:()Z
       4: ifeq          28
       7: aload_2
       8: invokeinterface #48,  1           // InterfaceMethod org/infinispan/context/InvocationContext.isInTxScope:()Z
      13: ifeq          24
      16: aload_0
      17: aload_2
      18: invokespecial #72                 // Method isOngoingTransaction:(Lorg/infinispan/context/InvocationContext;)Z
      21: ifne          28
      24: iconst_1
      25: goto          29
      28: iconst_0
      29: ireturn

  private java.lang.Object markTxForRollbackAndRethrow(org.infinispan.context.InvocationContext, java.lang.Throwable) throws java.lang.Throwable;
    Code:
       0: aload_1
       1: invokeinterface #49,  1           // InterfaceMethod org/infinispan/context/InvocationContext.isOriginLocal:()Z
       6: ifeq          46
       9: aload_1
      10: invokeinterface #48,  1           // InterfaceMethod org/infinispan/context/InvocationContext.isInTxScope:()Z
      15: ifeq          46
      18: aload_0
      19: getfield      #4                  // Field tm:Ljavax/transaction/TransactionManager;
      22: invokeinterface #73,  1           // InterfaceMethod javax/transaction/TransactionManager.getTransaction:()Ljavax/transaction/Transaction;
      27: astore_3
      28: aload_3
      29: ifnull        46
      32: aload_0
      33: aload_3
      34: invokespecial #74                 // Method isValidRunningTx:(Ljavax/transaction/Transaction;)Z
      37: ifeq          46
      40: aload_3
      41: invokeinterface #75,  1           // InterfaceMethod javax/transaction/Transaction.setRollbackOnly:()V
      46: aload_2
      47: athrow

  private boolean isValidRunningTx(javax.transaction.Transaction) throws java.lang.Exception;
    Code:
       0: aload_1
       1: invokeinterface #76,  1           // InterfaceMethod javax/transaction/Transaction.getStatus:()I
       6: istore_2
       7: goto          22
      10: astore_3
      11: new           #78                 // class org/infinispan/commons/CacheException
      14: dup
      15: ldc           #79                 // String Unexpected!
      17: aload_3
      18: invokespecial #80                 // Method org/infinispan/commons/CacheException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      21: athrow
      22: iload_2
      23: ifne          30
      26: iconst_1
      27: goto          31
      30: iconst_0
      31: ireturn
    Exception table:
       from    to  target type
           0     7    10   Class javax/transaction/SystemException

  private boolean isOngoingTransaction(org.infinispan.context.InvocationContext) throws javax.transaction.SystemException;
    Code:
       0: aload_1
       1: invokeinterface #48,  1           // InterfaceMethod org/infinispan/context/InvocationContext.isInTxScope:()Z
       6: ifne          11
       9: iconst_0
      10: ireturn
      11: aload_1
      12: invokeinterface #49,  1           // InterfaceMethod org/infinispan/context/InvocationContext.isOriginLocal:()Z
      17: ifeq          37
      20: aload_0
      21: getfield      #6                  // Field txTable:Lorg/infinispan/transaction/impl/TransactionTable;
      24: aload_0
      25: getfield      #4                  // Field tm:Ljavax/transaction/TransactionManager;
      28: invokeinterface #73,  1           // InterfaceMethod javax/transaction/TransactionManager.getTransaction:()Ljavax/transaction/Transaction;
      33: invokevirtual #81                 // Method org/infinispan/transaction/impl/TransactionTable.containsLocalTx:(Ljavax/transaction/Transaction;)Z
      36: ireturn
      37: aload_0
      38: getfield      #6                  // Field txTable:Lorg/infinispan/transaction/impl/TransactionTable;
      41: aload_1
      42: checkcast     #59                 // class org/infinispan/context/impl/TxInvocationContext
      45: invokeinterface #82,  1           // InterfaceMethod org/infinispan/context/impl/TxInvocationContext.getGlobalTransaction:()Lorg/infinispan/transaction/xa/GlobalTransaction;
      50: invokevirtual #83                 // Method org/infinispan/transaction/impl/TransactionTable.containRemoteTx:(Lorg/infinispan/transaction/xa/GlobalTransaction;)Z
      53: ireturn

  static {};
    Code:
       0: ldc           #84                 // class org/infinispan/interceptors/InvocationContextInterceptor
       2: invokestatic  #85                 // Method org/infinispan/util/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/infinispan/util/logging/Log;
       5: putstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
       8: getstatic     #3                  // Field log:Lorg/infinispan/util/logging/Log;
      11: invokeinterface #86,  1           // InterfaceMethod org/infinispan/util/logging/Log.isTraceEnabled:()Z
      16: putstatic     #21                 // Field trace:Z
      19: return
}
