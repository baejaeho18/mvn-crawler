Compiled from "AbstractCacheStream.java"
class org.infinispan.stream.impl.AbstractCacheStream$KeyTrackingConsumer<K, V> implements org.infinispan.stream.impl.ClusterStreamManager$ResultsCallback<java.util.Collection<org.infinispan.container.entries.CacheEntry<K, java.lang.Object>>>, org.infinispan.stream.impl.KeyTrackingTerminalOperation$IntermediateCollector<java.util.Collection<org.infinispan.container.entries.CacheEntry<K, java.lang.Object>>> {
  final org.infinispan.distribution.ch.ConsistentHash ch;

  final java.util.function.Consumer<V> consumer;

  final java.util.Set<java.lang.Integer> lostSegments;

  final java.util.function.Function<org.infinispan.container.entries.CacheEntry<K, java.lang.Object>, V> valueFunction;

  final java.util.concurrent.atomic.AtomicReferenceArray<java.util.Set<K>> referenceArray;

  final org.infinispan.stream.impl.DistributedCacheStream$SegmentListenerNotifier listenerNotifier;

  final org.infinispan.stream.impl.AbstractCacheStream this$0;

  org.infinispan.stream.impl.AbstractCacheStream$KeyTrackingConsumer(org.infinispan.distribution.ch.ConsistentHash, java.util.function.Consumer<V>, java.util.function.Function<org.infinispan.container.entries.CacheEntry<K, java.lang.Object>, V>, org.infinispan.stream.impl.DistributedCacheStream$SegmentListenerNotifier, org.infinispan.commons.equivalence.Equivalence<? super K>);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #1                  // Field this$0:Lorg/infinispan/stream/impl/AbstractCacheStream;
       5: aload_0
       6: invokespecial #2                  // Method java/lang/Object."<init>":()V
       9: aload_0
      10: new           #3                  // class org/infinispan/util/concurrent/ConcurrentHashSet
      13: dup
      14: invokespecial #4                  // Method org/infinispan/util/concurrent/ConcurrentHashSet."<init>":()V
      17: putfield      #5                  // Field lostSegments:Ljava/util/Set;
      20: aload_0
      21: aload_2
      22: putfield      #6                  // Field ch:Lorg/infinispan/distribution/ch/ConsistentHash;
      25: aload_0
      26: aload_3
      27: putfield      #7                  // Field consumer:Ljava/util/function/Consumer;
      30: aload_0
      31: aload         4
      33: putfield      #8                  // Field valueFunction:Ljava/util/function/Function;
      36: aload_0
      37: aload         5
      39: putfield      #9                  // Field listenerNotifier:Lorg/infinispan/stream/impl/DistributedCacheStream$SegmentListenerNotifier;
      42: aload_0
      43: new           #10                 // class java/util/concurrent/atomic/AtomicReferenceArray
      46: dup
      47: aload_2
      48: invokeinterface #11,  1           // InterfaceMethod org/infinispan/distribution/ch/ConsistentHash.getNumSegments:()I
      53: invokespecial #12                 // Method java/util/concurrent/atomic/AtomicReferenceArray."<init>":(I)V
      56: putfield      #13                 // Field referenceArray:Ljava/util/concurrent/atomic/AtomicReferenceArray;
      59: iconst_0
      60: istore        7
      62: iload         7
      64: aload_0
      65: getfield      #13                 // Field referenceArray:Ljava/util/concurrent/atomic/AtomicReferenceArray;
      68: invokevirtual #14                 // Method java/util/concurrent/atomic/AtomicReferenceArray.length:()I
      71: if_icmpge     98
      74: aload_0
      75: getfield      #13                 // Field referenceArray:Ljava/util/concurrent/atomic/AtomicReferenceArray;
      78: iload         7
      80: new           #15                 // class org/infinispan/commons/equivalence/EquivalentHashSet
      83: dup
      84: aload         6
      86: invokespecial #16                 // Method org/infinispan/commons/equivalence/EquivalentHashSet."<init>":(Lorg/infinispan/commons/equivalence/Equivalence;)V
      89: invokevirtual #17                 // Method java/util/concurrent/atomic/AtomicReferenceArray.set:(ILjava/lang/Object;)V
      92: iinc          7, 1
      95: goto          62
      98: return

  public java.util.Set<java.lang.Integer> onIntermediateResult(org.infinispan.remoting.transport.Address, java.util.Collection<org.infinispan.container.entries.CacheEntry<K, java.lang.Object>>);
    Code:
       0: aload_2
       1: ifnull        90
       4: aload_0
       5: getfield      #1                  // Field this$0:Lorg/infinispan/stream/impl/AbstractCacheStream;
       8: getfield      #18                 // Field org/infinispan/stream/impl/AbstractCacheStream.log:Lorg/infinispan/util/logging/Log;
      11: ldc           #19                 // String Response from %s with results %s
      13: aload_1
      14: aload_2
      15: invokeinterface #20,  1           // InterfaceMethod java/util/Collection.size:()I
      20: invokestatic  #21                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      23: invokeinterface #22,  4           // InterfaceMethod org/infinispan/util/logging/Log.tracef:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      28: iconst_1
      29: anewarray     #23                 // class org/infinispan/container/entries/CacheEntry
      32: astore        4
      34: aload_0
      35: getfield      #9                  // Field listenerNotifier:Lorg/infinispan/stream/impl/DistributedCacheStream$SegmentListenerNotifier;
      38: ifnull        52
      41: new           #24                 // class java/util/HashSet
      44: dup
      45: invokespecial #25                 // Method java/util/HashSet."<init>":()V
      48: astore_3
      49: goto          54
      52: aconst_null
      53: astore_3
      54: aload_2
      55: aload_0
      56: aload_3
      57: aload         4
      59: invokedynamic #26,  0             // InvokeDynamic #0:accept:(Lorg/infinispan/stream/impl/AbstractCacheStream$KeyTrackingConsumer;Ljava/util/Set;[Lorg/infinispan/container/entries/CacheEntry;)Ljava/util/function/Consumer;
      64: invokeinterface #27,  2           // InterfaceMethod java/util/Collection.forEach:(Ljava/util/function/Consumer;)V
      69: aload         4
      71: iconst_0
      72: aaload
      73: ifnull        90
      76: aload_0
      77: getfield      #9                  // Field listenerNotifier:Lorg/infinispan/stream/impl/DistributedCacheStream$SegmentListenerNotifier;
      80: aload         4
      82: iconst_0
      83: aaload
      84: aload_3
      85: invokevirtual #28                 // Method org/infinispan/stream/impl/DistributedCacheStream$SegmentListenerNotifier.addSegmentsForObject:(Ljava/lang/Object;Ljava/util/Set;)V
      88: aload_3
      89: areturn
      90: aconst_null
      91: areturn

  public void onCompletion(org.infinispan.remoting.transport.Address, java.util.Set<java.lang.Integer>, java.util.Collection<org.infinispan.container.entries.CacheEntry<K, java.lang.Object>>);
    Code:
       0: aload_2
       1: invokeinterface #29,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
       6: ifne          39
       9: aload_0
      10: getfield      #1                  // Field this$0:Lorg/infinispan/stream/impl/AbstractCacheStream;
      13: getfield      #18                 // Field org/infinispan/stream/impl/AbstractCacheStream.log:Lorg/infinispan/util/logging/Log;
      16: ldc           #30                 // String Completing segments %s
      18: aload_2
      19: invokeinterface #31,  3           // InterfaceMethod org/infinispan/util/logging/Log.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
      24: aload_2
      25: aload_0
      26: invokedynamic #32,  0             // InvokeDynamic #1:accept:(Lorg/infinispan/stream/impl/AbstractCacheStream$KeyTrackingConsumer;)Ljava/util/function/Consumer;
      31: invokeinterface #33,  2           // InterfaceMethod java/util/Set.forEach:(Ljava/util/function/Consumer;)V
      36: goto          54
      39: aload_0
      40: getfield      #1                  // Field this$0:Lorg/infinispan/stream/impl/AbstractCacheStream;
      43: getfield      #18                 // Field org/infinispan/stream/impl/AbstractCacheStream.log:Lorg/infinispan/util/logging/Log;
      46: ldc           #34                 // String No segments to complete from %s
      48: aload_1
      49: invokeinterface #31,  3           // InterfaceMethod org/infinispan/util/logging/Log.tracef:(Ljava/lang/String;Ljava/lang/Object;)V
      54: aload_0
      55: aload_1
      56: aload_3
      57: invokevirtual #35                 // Method onIntermediateResult:(Lorg/infinispan/remoting/transport/Address;Ljava/util/Collection;)Ljava/util/Set;
      60: astore        4
      62: aload         4
      64: ifnull        84
      67: aload_2
      68: aload         4
      70: invokeinterface #36,  2           // InterfaceMethod java/util/Set.removeAll:(Ljava/util/Collection;)Z
      75: pop
      76: aload_0
      77: getfield      #9                  // Field listenerNotifier:Lorg/infinispan/stream/impl/DistributedCacheStream$SegmentListenerNotifier;
      80: aload_2
      81: invokevirtual #37                 // Method org/infinispan/stream/impl/DistributedCacheStream$SegmentListenerNotifier.completeSegmentsNoResults:(Ljava/util/Set;)V
      84: return

  public void onSegmentsLost(java.util.Set<java.lang.Integer>);
    Code:
       0: aload_1
       1: invokeinterface #38,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
       6: astore_2
       7: aload_2
       8: invokeinterface #39,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      13: ifeq          40
      16: aload_2
      17: invokeinterface #40,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      22: checkcast     #41                 // class java/lang/Integer
      25: astore_3
      26: aload_0
      27: getfield      #5                  // Field lostSegments:Ljava/util/Set;
      30: aload_3
      31: invokeinterface #42,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      36: pop
      37: goto          7
      40: return

  public void sendDataResonse(java.util.Collection<org.infinispan.container.entries.CacheEntry<K, java.lang.Object>>);
    Code:
       0: aload_0
       1: aconst_null
       2: aload_1
       3: invokevirtual #35                 // Method onIntermediateResult:(Lorg/infinispan/remoting/transport/Address;Ljava/util/Collection;)Ljava/util/Set;
       6: pop
       7: return

  public void onCompletion(org.infinispan.remoting.transport.Address, java.util.Set, java.lang.Object);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: checkcast     #43                 // class java/util/Collection
       7: invokevirtual #44                 // Method onCompletion:(Lorg/infinispan/remoting/transport/Address;Ljava/util/Set;Ljava/util/Collection;)V
      10: return

  public java.util.Set onIntermediateResult(org.infinispan.remoting.transport.Address, java.lang.Object);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: checkcast     #43                 // class java/util/Collection
       6: invokevirtual #35                 // Method onIntermediateResult:(Lorg/infinispan/remoting/transport/Address;Ljava/util/Collection;)Ljava/util/Set;
       9: areturn

  public void sendDataResonse(java.lang.Object);
    Code:
       0: aload_0
       1: aload_1
       2: checkcast     #43                 // class java/util/Collection
       5: invokevirtual #45                 // Method sendDataResonse:(Ljava/util/Collection;)V
       8: return

  private void lambda$onCompletion$83(java.lang.Integer);
    Code:
       0: aload_0
       1: getfield      #13                 // Field referenceArray:Ljava/util/concurrent/atomic/AtomicReferenceArray;
       4: aload_1
       5: invokevirtual #46                 // Method java/lang/Integer.intValue:()I
       8: aconst_null
       9: invokevirtual #17                 // Method java/util/concurrent/atomic/AtomicReferenceArray.set:(ILjava/lang/Object;)V
      12: return

  private void lambda$onIntermediateResult$82(java.util.Set, org.infinispan.container.entries.CacheEntry[], org.infinispan.container.entries.CacheEntry);
    Code:
       0: aload_3
       1: invokeinterface #47,  1           // InterfaceMethod org/infinispan/container/entries/CacheEntry.getKey:()Ljava/lang/Object;
       6: astore        4
       8: aload_0
       9: getfield      #6                  // Field ch:Lorg/infinispan/distribution/ch/ConsistentHash;
      12: aload         4
      14: invokeinterface #48,  2           // InterfaceMethod org/infinispan/distribution/ch/ConsistentHash.getSegment:(Ljava/lang/Object;)I
      19: istore        5
      21: aload_0
      22: getfield      #13                 // Field referenceArray:Ljava/util/concurrent/atomic/AtomicReferenceArray;
      25: iload         5
      27: invokevirtual #49                 // Method java/util/concurrent/atomic/AtomicReferenceArray.get:(I)Ljava/lang/Object;
      30: checkcast     #50                 // class java/util/Set
      33: astore        6
      35: aload         6
      37: ifnull        53
      40: aload         6
      42: aload         4
      44: invokeinterface #42,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      49: pop
      50: goto          73
      53: aload_1
      54: ifnull        73
      57: aload_1
      58: iload         5
      60: invokestatic  #21                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      63: invokeinterface #42,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      68: pop
      69: aload_2
      70: iconst_0
      71: aload_3
      72: aastore
      73: aload_0
      74: getfield      #7                  // Field consumer:Ljava/util/function/Consumer;
      77: aload_0
      78: getfield      #8                  // Field valueFunction:Ljava/util/function/Function;
      81: aload_3
      82: invokeinterface #51,  2           // InterfaceMethod java/util/function/Function.apply:(Ljava/lang/Object;)Ljava/lang/Object;
      87: invokeinterface #52,  2           // InterfaceMethod java/util/function/Consumer.accept:(Ljava/lang/Object;)V
      92: return
}
