Compiled from "ClientLoginModule.java"
public class org.jboss.security.ClientLoginModule implements javax.security.auth.spi.LoginModule {
  private static final java.lang.String MULTI_TREADED;

  private static final java.lang.String RESTORE_LOGIN_IDENTITY;

  private static final java.lang.String PASSWORD_STACKING;

  private static final java.lang.String USE_FIRST_PASSWORD;

  private static final java.lang.String PRINCIPAL_CLASS;

  private static final java.lang.String[] ALL_VALID_OPTIONS;

  private javax.security.auth.Subject subject;

  private javax.security.auth.callback.CallbackHandler callbackHandler;

  private java.security.Principal loginPrincipal;

  private java.lang.Object loginCredential;

  private java.util.Map<java.lang.String, ?> sharedState;

  private boolean useFirstPass;

  private boolean restoreLoginIdentity;

  private org.jboss.security.SecurityContext cachedSecurityContext;

  public org.jboss.security.ClientLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map<java.lang.String, ?>, java.util.Map<java.lang.String, ?>);
    Code:
       0: new           #2                  // class java/util/HashSet
       3: dup
       4: getstatic     #3                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
       7: invokestatic  #4                  // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
      10: invokespecial #5                  // Method java/util/HashSet."<init>":(Ljava/util/Collection;)V
      13: astore        5
      15: aload         4
      17: invokeinterface #6,  1            // InterfaceMethod java/util/Map.keySet:()Ljava/util/Set;
      22: invokeinterface #7,  1            // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      27: astore        6
      29: aload         6
      31: invokeinterface #8,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
      36: ifeq          77
      39: aload         6
      41: invokeinterface #9,  1            // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      46: astore        7
      48: aload         5
      50: aload         7
      52: checkcast     #10                 // class java/lang/String
      55: invokevirtual #11                 // Method java/util/HashSet.contains:(Ljava/lang/Object;)Z
      58: ifne          74
      61: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      64: aload         7
      66: checkcast     #10                 // class java/lang/String
      69: invokeinterface #13,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.warnInvalidModuleOption:(Ljava/lang/String;)V
      74: goto          29
      77: aload_0
      78: aload_1
      79: putfield      #14                 // Field subject:Ljavax/security/auth/Subject;
      82: aload_0
      83: aload_2
      84: putfield      #15                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      87: aload_0
      88: aload_3
      89: putfield      #16                 // Field sharedState:Ljava/util/Map;
      92: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      95: ldc           #18                 // String jboss.security.security_domain
      97: aload         4
      99: ldc           #18                 // String jboss.security.security_domain
     101: invokeinterface #19,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     106: invokeinterface #20,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugModuleOption:(Ljava/lang/String;Ljava/lang/Object;)V
     111: aload         4
     113: ldc           #22                 // String multi-threaded
     115: invokeinterface #19,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     120: checkcast     #10                 // class java/lang/String
     123: astore        6
     125: aload         6
     127: invokestatic  #23                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     130: invokevirtual #24                 // Method java/lang/Boolean.booleanValue:()Z
     133: iconst_1
     134: if_icmpne     149
     137: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     140: ldc           #22                 // String multi-threaded
     142: aload         6
     144: invokeinterface #20,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugModuleOption:(Ljava/lang/String;Ljava/lang/Object;)V
     149: aload         6
     151: ifnull        175
     154: aload         6
     156: invokevirtual #25                 // Method java/lang/String.length:()I
     159: ifle          175
     162: ldc           #26                 // String false
     164: aload         6
     166: invokevirtual #27                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     169: ifeq          175
     172: invokestatic  #28                 // Method org/jboss/security/SecurityAssociationActions.setClient:()V
     175: aload         4
     177: ldc           #29                 // String restore-login-identity
     179: invokeinterface #19,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     184: checkcast     #10                 // class java/lang/String
     187: astore        6
     189: aload_0
     190: aload         6
     192: invokestatic  #23                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     195: invokevirtual #24                 // Method java/lang/Boolean.booleanValue:()Z
     198: putfield      #30                 // Field restoreLoginIdentity:Z
     201: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     204: ldc           #29                 // String restore-login-identity
     206: aload         6
     208: invokeinterface #20,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugModuleOption:(Ljava/lang/String;Ljava/lang/Object;)V
     213: aload         4
     215: ldc           #31                 // String password-stacking
     217: invokeinterface #19,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     222: checkcast     #10                 // class java/lang/String
     225: astore        7
     227: aload         7
     229: ifnull        247
     232: aload         7
     234: ldc           #32                 // String useFirstPass
     236: invokevirtual #27                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     239: ifeq          247
     242: aload_0
     243: iconst_1
     244: putfield      #33                 // Field useFirstPass:Z
     247: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     250: ldc           #31                 // String password-stacking
     252: aload         7
     254: invokeinterface #20,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugModuleOption:(Ljava/lang/String;Ljava/lang/Object;)V
     259: aload_0
     260: invokestatic  #34                 // Method org/jboss/security/SecurityAssociationActions.getSecurityContext:()Lorg/jboss/security/SecurityContext;
     263: putfield      #35                 // Field cachedSecurityContext:Lorg/jboss/security/SecurityContext;
     266: return

  public boolean login() throws javax.security.auth.login.LoginException;
    Code:
       0: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: invokeinterface #36,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginLogin:()V
       8: aload_0
       9: getfield      #33                 // Field useFirstPass:Z
      12: iconst_1
      13: if_icmpne     99
      16: aload_0
      17: getfield      #16                 // Field sharedState:Ljava/util/Map;
      20: ldc           #37                 // String javax.security.auth.login.name
      22: invokeinterface #19,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      27: astore_1
      28: aload_1
      29: instanceof    #38                 // class java/security/Principal
      32: ifne          64
      35: aload_1
      36: ifnull        46
      39: aload_1
      40: invokevirtual #39                 // Method java/lang/Object.toString:()Ljava/lang/String;
      43: goto          48
      46: ldc           #40                 // String
      48: astore_2
      49: aload_0
      50: new           #41                 // class org/jboss/security/SimplePrincipal
      53: dup
      54: aload_2
      55: invokespecial #42                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
      58: putfield      #43                 // Field loginPrincipal:Ljava/security/Principal;
      61: goto          72
      64: aload_0
      65: aload_1
      66: checkcast     #38                 // class java/security/Principal
      69: putfield      #43                 // Field loginPrincipal:Ljava/security/Principal;
      72: aload_0
      73: aload_0
      74: getfield      #16                 // Field sharedState:Ljava/util/Map;
      77: ldc           #44                 // String javax.security.auth.login.password
      79: invokeinterface #19,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      84: putfield      #45                 // Field loginCredential:Ljava/lang/Object;
      87: iconst_1
      88: ireturn
      89: astore_1
      90: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      93: aload_1
      94: invokeinterface #47,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugIgnoredException:(Ljava/lang/Throwable;)V
      99: aload_0
     100: getfield      #15                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
     103: ifnonnull     115
     106: getstatic     #48                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     109: invokeinterface #49,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.noCallbackHandlerAvailable:()Ljavax/security/auth/login/LoginException;
     114: athrow
     115: new           #50                 // class javax/security/auth/callback/PasswordCallback
     118: dup
     119: getstatic     #48                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     122: invokeinterface #51,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.enterPasswordMessage:()Ljava/lang/String;
     127: iconst_0
     128: invokespecial #52                 // Method javax/security/auth/callback/PasswordCallback."<init>":(Ljava/lang/String;Z)V
     131: astore_1
     132: new           #53                 // class javax/security/auth/callback/NameCallback
     135: dup
     136: getstatic     #48                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     139: invokeinterface #54,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.enterUsernameMessage:()Ljava/lang/String;
     144: ldc           #55                 // String guest
     146: invokespecial #56                 // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     149: astore_2
     150: iconst_2
     151: anewarray     #57                 // class javax/security/auth/callback/Callback
     154: dup
     155: iconst_0
     156: aload_2
     157: aastore
     158: dup
     159: iconst_1
     160: aload_1
     161: aastore
     162: astore_3
     163: aconst_null
     164: astore        5
     166: aload_0
     167: getfield      #15                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
     170: aload_3
     171: invokeinterface #58,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     176: aload_2
     177: invokevirtual #59                 // Method javax/security/auth/callback/NameCallback.getName:()Ljava/lang/String;
     180: astore        4
     182: aload_0
     183: new           #41                 // class org/jboss/security/SimplePrincipal
     186: dup
     187: aload         4
     189: invokespecial #42                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
     192: putfield      #43                 // Field loginPrincipal:Ljava/security/Principal;
     195: aload_1
     196: invokevirtual #60                 // Method javax/security/auth/callback/PasswordCallback.getPassword:()[C
     199: astore        6
     201: aload         6
     203: ifnull        229
     206: aload         6
     208: arraylength
     209: newarray       char
     211: astore        5
     213: aload         6
     215: iconst_0
     216: aload         5
     218: iconst_0
     219: aload         6
     221: arraylength
     222: invokestatic  #61                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     225: aload_1
     226: invokevirtual #62                 // Method javax/security/auth/callback/PasswordCallback.clearPassword:()V
     229: aload_0
     230: aload         5
     232: putfield      #45                 // Field loginCredential:Ljava/lang/Object;
     235: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     238: aload_0
     239: getfield      #43                 // Field loginPrincipal:Ljava/security/Principal;
     242: aload_0
     243: getfield      #45                 // Field loginCredential:Ljava/lang/Object;
     246: ifnull        259
     249: aload_0
     250: getfield      #45                 // Field loginCredential:Ljava/lang/Object;
     253: invokevirtual #63                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
     256: goto          260
     259: aconst_null
     260: invokeinterface #64,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceObtainedAuthInfoFromHandler:(Ljava/security/Principal;Ljava/lang/Class;)V
     265: goto          322
     268: astore        4
     270: new           #66                 // class javax/security/auth/login/LoginException
     273: dup
     274: aload         4
     276: invokevirtual #67                 // Method java/io/IOException.getLocalizedMessage:()Ljava/lang/String;
     279: invokespecial #68                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
     282: astore        5
     284: aload         5
     286: aload         4
     288: invokevirtual #69                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     291: pop
     292: aload         5
     294: athrow
     295: astore        4
     297: new           #66                 // class javax/security/auth/login/LoginException
     300: dup
     301: aload         4
     303: invokevirtual #71                 // Method javax/security/auth/callback/UnsupportedCallbackException.getLocalizedMessage:()Ljava/lang/String;
     306: invokespecial #68                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
     309: astore        5
     311: aload         5
     313: aload         4
     315: invokevirtual #69                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     318: pop
     319: aload         5
     321: athrow
     322: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     325: iconst_1
     326: invokeinterface #72,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceEndLogin:(Z)V
     331: iconst_1
     332: ireturn
    Exception table:
       from    to  target type
          16    88    89   Class java/lang/Exception
         163   265   268   Class java/io/IOException
         163   265   295   Class javax/security/auth/callback/UnsupportedCallbackException

  public boolean commit() throws javax.security.auth.login.LoginException;
    Code:
       0: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: iconst_1
       4: invokeinterface #73,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginCommit:(Z)V
       9: aload_0
      10: getfield      #43                 // Field loginPrincipal:Ljava/security/Principal;
      13: aload_0
      14: getfield      #45                 // Field loginCredential:Ljava/lang/Object;
      17: aload_0
      18: getfield      #14                 // Field subject:Ljavax/security/auth/Subject;
      21: invokestatic  #74                 // Method org/jboss/security/SecurityAssociationActions.setPrincipalInfo:(Ljava/security/Principal;Ljava/lang/Object;Ljavax/security/auth/Subject;)V
      24: aload_0
      25: getfield      #14                 // Field subject:Ljavax/security/auth/Subject;
      28: invokevirtual #75                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      31: astore_1
      32: aload_1
      33: aload_0
      34: getfield      #43                 // Field loginPrincipal:Ljava/security/Principal;
      37: invokeinterface #76,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      42: ifne          56
      45: aload_1
      46: aload_0
      47: getfield      #43                 // Field loginPrincipal:Ljava/security/Principal;
      50: invokeinterface #77,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      55: pop
      56: iconst_1
      57: ireturn

  public boolean abort() throws javax.security.auth.login.LoginException;
    Code:
       0: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: iconst_1
       4: invokeinterface #78,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginAbort:(Z)V
       9: aload_0
      10: getfield      #30                 // Field restoreLoginIdentity:Z
      13: iconst_1
      14: if_icmpne     27
      17: aload_0
      18: getfield      #35                 // Field cachedSecurityContext:Lorg/jboss/security/SecurityContext;
      21: invokestatic  #79                 // Method org/jboss/security/SecurityAssociationActions.setSecurityContext:(Lorg/jboss/security/SecurityContext;)V
      24: goto          30
      27: invokestatic  #80                 // Method org/jboss/security/SecurityAssociationActions.clear:()V
      30: iconst_1
      31: ireturn

  public boolean logout() throws javax.security.auth.login.LoginException;
    Code:
       0: getstatic     #12                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: invokeinterface #81,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginLogout:()V
       8: aload_0
       9: getfield      #30                 // Field restoreLoginIdentity:Z
      12: iconst_1
      13: if_icmpne     26
      16: aload_0
      17: getfield      #35                 // Field cachedSecurityContext:Lorg/jboss/security/SecurityContext;
      20: invokestatic  #79                 // Method org/jboss/security/SecurityAssociationActions.setSecurityContext:(Lorg/jboss/security/SecurityContext;)V
      23: goto          29
      26: invokestatic  #80                 // Method org/jboss/security/SecurityAssociationActions.clear:()V
      29: aload_0
      30: getfield      #14                 // Field subject:Ljavax/security/auth/Subject;
      33: invokevirtual #75                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      36: astore_1
      37: aload_1
      38: aload_0
      39: getfield      #43                 // Field loginPrincipal:Ljava/security/Principal;
      42: invokeinterface #82,  2           // InterfaceMethod java/util/Set.remove:(Ljava/lang/Object;)Z
      47: pop
      48: iconst_1
      49: ireturn

  static {};
    Code:
       0: iconst_5
       1: anewarray     #10                 // class java/lang/String
       4: dup
       5: iconst_0
       6: ldc           #22                 // String multi-threaded
       8: aastore
       9: dup
      10: iconst_1
      11: ldc           #29                 // String restore-login-identity
      13: aastore
      14: dup
      15: iconst_2
      16: ldc           #31                 // String password-stacking
      18: aastore
      19: dup
      20: iconst_3
      21: ldc           #83                 // String principalClass
      23: aastore
      24: dup
      25: iconst_4
      26: ldc           #18                 // String jboss.security.security_domain
      28: aastore
      29: putstatic     #3                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
      32: return
}
