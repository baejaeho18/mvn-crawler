Compiled from "HOTP.java"
public class org.jboss.security.otp.HOTP {
  private static final int[] doubleDigits;

  private static final int[] DIGITS_POWER;

  public org.jboss.security.otp.HOTP();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public static java.lang.String generateOTP(byte[], long, int, boolean, int) throws java.security.NoSuchAlgorithmException, java.security.InvalidKeyException;
    Code:
       0: aconst_null
       1: astore        6
       3: iload         4
       5: ifeq          14
       8: iload_3
       9: iconst_1
      10: iadd
      11: goto          15
      14: iload_3
      15: istore        7
      17: bipush        8
      19: newarray       byte
      21: astore        8
      23: aload         8
      25: arraylength
      26: iconst_1
      27: isub
      28: istore        9
      30: iload         9
      32: iflt          58
      35: aload         8
      37: iload         9
      39: lload_1
      40: ldc2_w        #2                  // long 255l
      43: land
      44: l2i
      45: i2b
      46: bastore
      47: lload_1
      48: bipush        8
      50: lshr
      51: lstore_1
      52: iinc          9, -1
      55: goto          30
      58: aload_0
      59: aload         8
      61: invokestatic  #4                  // Method hmac_sha1:([B[B)[B
      64: astore        9
      66: aload         9
      68: aload         9
      70: arraylength
      71: iconst_1
      72: isub
      73: baload
      74: bipush        15
      76: iand
      77: istore        10
      79: iconst_0
      80: iload         5
      82: if_icmpgt     99
      85: iload         5
      87: aload         9
      89: arraylength
      90: iconst_4
      91: isub
      92: if_icmpge     99
      95: iload         5
      97: istore        10
      99: aload         9
     101: iload         10
     103: baload
     104: bipush        127
     106: iand
     107: bipush        24
     109: ishl
     110: aload         9
     112: iload         10
     114: iconst_1
     115: iadd
     116: baload
     117: sipush        255
     120: iand
     121: bipush        16
     123: ishl
     124: ior
     125: aload         9
     127: iload         10
     129: iconst_2
     130: iadd
     131: baload
     132: sipush        255
     135: iand
     136: bipush        8
     138: ishl
     139: ior
     140: aload         9
     142: iload         10
     144: iconst_3
     145: iadd
     146: baload
     147: sipush        255
     150: iand
     151: ior
     152: istore        11
     154: iload         11
     156: getstatic     #5                  // Field DIGITS_POWER:[I
     159: iload_3
     160: iaload
     161: irem
     162: istore        12
     164: iload         4
     166: ifeq          184
     169: iload         12
     171: bipush        10
     173: imul
     174: iload         12
     176: i2l
     177: iload_3
     178: invokestatic  #6                  // Method calcChecksum:(JI)I
     181: iadd
     182: istore        12
     184: iload         12
     186: invokestatic  #7                  // Method java/lang/Integer.toString:(I)Ljava/lang/String;
     189: astore        6
     191: aload         6
     193: invokevirtual #8                  // Method java/lang/String.length:()I
     196: iload         7
     198: if_icmpge     226
     201: new           #9                  // class java/lang/StringBuilder
     204: dup
     205: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     208: ldc           #11                 // String 0
     210: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     213: aload         6
     215: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     218: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     221: astore        6
     223: goto          191
     226: aload         6
     228: areturn

  private static int calcChecksum(long, int);
    Code:
       0: iconst_1
       1: istore_3
       2: iconst_0
       3: istore        4
       5: iconst_0
       6: iload_2
       7: iinc          2, -1
      10: if_icmpge     59
      13: lload_0
      14: ldc2_w        #14                 // long 10l
      17: lrem
      18: l2i
      19: istore        5
      21: lload_0
      22: ldc2_w        #14                 // long 10l
      25: ldiv
      26: lstore_0
      27: iload_3
      28: ifeq          39
      31: getstatic     #16                 // Field doubleDigits:[I
      34: iload         5
      36: iaload
      37: istore        5
      39: iload         4
      41: iload         5
      43: iadd
      44: istore        4
      46: iload_3
      47: ifne          54
      50: iconst_1
      51: goto          55
      54: iconst_0
      55: istore_3
      56: goto          5
      59: iload         4
      61: bipush        10
      63: irem
      64: istore        5
      66: iload         5
      68: ifle          78
      71: bipush        10
      73: iload         5
      75: isub
      76: istore        5
      78: iload         5
      80: ireturn

  private static byte[] hmac_sha1(byte[], byte[]) throws java.security.NoSuchAlgorithmException, java.security.InvalidKeyException;
    Code:
       0: ldc           #17                 // String HmacSHA1
       2: invokestatic  #18                 // Method javax/crypto/Mac.getInstance:(Ljava/lang/String;)Ljavax/crypto/Mac;
       5: astore_2
       6: goto          16
       9: astore_3
      10: ldc           #20                 // String HMAC-SHA-1
      12: invokestatic  #18                 // Method javax/crypto/Mac.getInstance:(Ljava/lang/String;)Ljavax/crypto/Mac;
      15: astore_2
      16: new           #21                 // class javax/crypto/spec/SecretKeySpec
      19: dup
      20: aload_0
      21: ldc           #22                 // String RAW
      23: invokespecial #23                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      26: astore_3
      27: aload_2
      28: aload_3
      29: invokevirtual #24                 // Method javax/crypto/Mac.init:(Ljava/security/Key;)V
      32: aload_2
      33: aload_1
      34: invokevirtual #25                 // Method javax/crypto/Mac.doFinal:([B)[B
      37: areturn
    Exception table:
       from    to  target type
           0     6     9   Class java/security/NoSuchAlgorithmException

  static {};
    Code:
       0: bipush        10
       2: newarray       int
       4: dup
       5: iconst_0
       6: iconst_0
       7: iastore
       8: dup
       9: iconst_1
      10: iconst_2
      11: iastore
      12: dup
      13: iconst_2
      14: iconst_4
      15: iastore
      16: dup
      17: iconst_3
      18: bipush        6
      20: iastore
      21: dup
      22: iconst_4
      23: bipush        8
      25: iastore
      26: dup
      27: iconst_5
      28: iconst_1
      29: iastore
      30: dup
      31: bipush        6
      33: iconst_3
      34: iastore
      35: dup
      36: bipush        7
      38: iconst_5
      39: iastore
      40: dup
      41: bipush        8
      43: bipush        7
      45: iastore
      46: dup
      47: bipush        9
      49: bipush        9
      51: iastore
      52: putstatic     #16                 // Field doubleDigits:[I
      55: bipush        9
      57: newarray       int
      59: dup
      60: iconst_0
      61: iconst_1
      62: iastore
      63: dup
      64: iconst_1
      65: bipush        10
      67: iastore
      68: dup
      69: iconst_2
      70: bipush        100
      72: iastore
      73: dup
      74: iconst_3
      75: sipush        1000
      78: iastore
      79: dup
      80: iconst_4
      81: sipush        10000
      84: iastore
      85: dup
      86: iconst_5
      87: ldc           #26                 // int 100000
      89: iastore
      90: dup
      91: bipush        6
      93: ldc           #27                 // int 1000000
      95: iastore
      96: dup
      97: bipush        7
      99: ldc           #28                 // int 10000000
     101: iastore
     102: dup
     103: bipush        8
     105: ldc           #29                 // int 100000000
     107: iastore
     108: putstatic     #5                  // Field DIGITS_POWER:[I
     111: return
}
