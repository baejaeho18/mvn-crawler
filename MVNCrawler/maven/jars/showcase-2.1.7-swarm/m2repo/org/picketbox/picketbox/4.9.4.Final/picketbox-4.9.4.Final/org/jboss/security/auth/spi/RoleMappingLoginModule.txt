Compiled from "RoleMappingLoginModule.java"
public class org.jboss.security.auth.spi.RoleMappingLoginModule extends org.jboss.security.auth.spi.AbstractServerLoginModule {
  private static final java.lang.String REPLACE_ROLE_OPT;

  private static final java.lang.String ROLES_PROPERTIES;

  private static final java.lang.String[] ALL_VALID_OPTIONS;

  protected boolean REPLACE_ROLE;

  public org.jboss.security.auth.spi.RoleMappingLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jboss/security/auth/spi/AbstractServerLoginModule."<init>":()V
       4: aload_0
       5: iconst_0
       6: putfield      #2                  // Field REPLACE_ROLE:Z
       9: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map<java.lang.String, ?>, java.util.Map<java.lang.String, ?>);
    Code:
       0: aload_0
       1: getstatic     #3                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
       4: invokevirtual #4                  // Method addValidOptions:([Ljava/lang/String;)V
       7: aload_0
       8: aload_1
       9: aload_2
      10: aload_3
      11: aload         4
      13: invokespecial #5                  // Method org/jboss/security/auth/spi/AbstractServerLoginModule.initialize:(Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;Ljava/util/Map;Ljava/util/Map;)V
      16: return

  public boolean login() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: invokespecial #6                  // Method org/jboss/security/auth/spi/AbstractServerLoginModule.login:()Z
       4: iconst_1
       5: if_icmpne     10
       8: iconst_1
       9: ireturn
      10: aload_0
      11: iconst_1
      12: putfield      #7                  // Field org/jboss/security/auth/spi/AbstractServerLoginModule.loginOk:Z
      15: iconst_1
      16: ireturn

  protected java.security.Principal getIdentity();
    Code:
       0: aload_0
       1: getfield      #8                  // Field subject:Ljavax/security/auth/Subject;
       4: invokevirtual #9                  // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
       7: invokeinterface #10,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      12: astore_1
      13: aload_1
      14: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      19: ifeq          44
      22: aload_1
      23: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      28: checkcast     #13                 // class java/security/Principal
      31: astore_2
      32: aload_2
      33: instanceof    #14                 // class java/security/acl/Group
      36: ifne          41
      39: aload_2
      40: areturn
      41: goto          13
      44: aconst_null
      45: areturn

  protected java.security.acl.Group[] getRoleSets() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #15                 // Field options:Ljava/util/Map;
       4: ldc           #17                 // String replaceRole
       6: invokeinterface #18,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      11: checkcast     #19                 // class java/lang/String
      14: astore_1
      15: ldc           #20                 // String true
      17: aload_1
      18: invokevirtual #21                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
      21: ifeq          29
      24: aload_0
      25: iconst_1
      26: putfield      #2                  // Field REPLACE_ROLE:Z
      29: aload_0
      30: getfield      #15                 // Field options:Ljava/util/Map;
      33: ldc           #22                 // String rolesProperties
      35: invokeinterface #18,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      40: checkcast     #19                 // class java/lang/String
      43: astore_2
      44: aload_2
      45: ifnonnull     66
      48: new           #23                 // class javax/security/auth/login/LoginException
      51: dup
      52: getstatic     #24                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      55: ldc           #22                 // String rolesProperties
      57: invokeinterface #25,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.missingRequiredModuleOptionMessage:(Ljava/lang/String;)Ljava/lang/String;
      62: invokespecial #26                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      65: athrow
      66: aload_2
      67: invokestatic  #27                 // Method org/jboss/security/util/StringPropertyReplacer.replaceProperties:(Ljava/lang/String;)Ljava/lang/String;
      70: astore_2
      71: aload_0
      72: invokespecial #28                 // Method getExistingRolesFromSubject:()Ljava/security/acl/Group;
      75: astore_3
      76: aload_2
      77: ifnull        123
      80: new           #29                 // class java/util/Properties
      83: dup
      84: invokespecial #30                 // Method java/util/Properties."<init>":()V
      87: astore        4
      89: aload_2
      90: invokestatic  #31                 // Method org/jboss/security/auth/spi/Util.loadProperties:(Ljava/lang/String;)Ljava/util/Properties;
      93: astore        4
      95: goto          111
      98: astore        5
     100: getstatic     #33                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     103: aload_2
     104: aload         5
     106: invokeinterface #34,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailureToLoadPropertiesFile:(Ljava/lang/String;Ljava/lang/Throwable;)V
     111: aload         4
     113: ifnull        123
     116: aload_0
     117: aload_3
     118: aload         4
     120: invokespecial #35                 // Method processRoles:(Ljava/security/acl/Group;Ljava/util/Properties;)V
     123: iconst_1
     124: anewarray     #14                 // class java/security/acl/Group
     127: dup
     128: iconst_0
     129: aload_3
     130: aastore
     131: areturn
    Exception table:
       from    to  target type
          89    95    98   Class java/lang/Exception

  private java.security.acl.Group getExistingRolesFromSubject();
    Code:
       0: aload_0
       1: getfield      #8                  // Field subject:Ljavax/security/auth/Subject;
       4: invokevirtual #9                  // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
       7: invokeinterface #10,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      12: astore_1
      13: aload_1
      14: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      19: ifeq          63
      22: aload_1
      23: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      28: checkcast     #13                 // class java/security/Principal
      31: astore_2
      32: aload_2
      33: instanceof    #14                 // class java/security/acl/Group
      36: ifeq          60
      39: aload_2
      40: checkcast     #14                 // class java/security/acl/Group
      43: astore_3
      44: ldc           #36                 // String Roles
      46: aload_3
      47: invokeinterface #37,  1           // InterfaceMethod java/security/acl/Group.getName:()Ljava/lang/String;
      52: invokevirtual #38                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      55: ifeq          60
      58: aload_3
      59: areturn
      60: goto          13
      63: aconst_null
      64: areturn

  private void processRoles(java.security.acl.Group, java.util.Properties);
    Code:
       0: aload_2
       1: invokevirtual #39                 // Method java/util/Properties.propertyNames:()Ljava/util/Enumeration;
       4: astore_3
       5: aload_3
       6: invokeinterface #40,  1           // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      11: ifeq          99
      14: aload_3
      15: invokeinterface #41,  1           // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      20: checkcast     #19                 // class java/lang/String
      23: astore        4
      25: aload_2
      26: aload         4
      28: invokevirtual #42                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      31: astore        5
      33: aload_0
      34: aload         4
      36: invokevirtual #43                 // Method createIdentity:(Ljava/lang/String;)Ljava/security/Principal;
      39: astore        6
      41: aload_1
      42: ifnull        79
      45: aload_1
      46: aload         6
      48: invokeinterface #44,  2           // InterfaceMethod java/security/acl/Group.isMember:(Ljava/security/Principal;)Z
      53: ifeq          63
      56: aload_1
      57: aload         5
      59: aload_0
      60: invokestatic  #45                 // Method org/jboss/security/auth/spi/Util.parseGroupMembers:(Ljava/security/acl/Group;Ljava/lang/String;Lorg/jboss/security/auth/spi/AbstractServerLoginModule;)V
      63: aload_0
      64: getfield      #2                  // Field REPLACE_ROLE:Z
      67: ifeq          79
      70: aload_1
      71: aload         6
      73: invokeinterface #46,  2           // InterfaceMethod java/security/acl/Group.removeMember:(Ljava/security/Principal;)Z
      78: pop
      79: goto          96
      82: astore        6
      84: getstatic     #33                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      87: aload         4
      89: aload         6
      91: invokeinterface #47,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailureToCreatePrincipal:(Ljava/lang/String;Ljava/lang/Throwable;)V
      96: goto          5
      99: return
    Exception table:
       from    to  target type
          33    79    82   Class java/lang/Exception

  static {};
    Code:
       0: iconst_2
       1: anewarray     #19                 // class java/lang/String
       4: dup
       5: iconst_0
       6: ldc           #17                 // String replaceRole
       8: aastore
       9: dup
      10: iconst_1
      11: ldc           #22                 // String rolesProperties
      13: aastore
      14: putstatic     #3                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
      17: return
}
