Compiled from "JASPICallbackHandler.java"
public class org.jboss.security.auth.callback.JASPICallbackHandler extends org.jboss.security.auth.callback.JBossCallbackHandler {
  private static final long serialVersionUID;

  public org.jboss.security.auth.callback.JASPICallbackHandler();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jboss/security/auth/callback/JBossCallbackHandler."<init>":()V
       4: return

  public org.jboss.security.auth.callback.JASPICallbackHandler(java.security.Principal, java.lang.Object);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #2                  // Method org/jboss/security/auth/callback/JBossCallbackHandler."<init>":(Ljava/security/Principal;Ljava/lang/Object;)V
       6: return

  protected void handleCallBack(javax.security.auth.callback.Callback) throws javax.security.auth.callback.UnsupportedCallbackException;
    Code:
       0: aload_1
       1: instanceof    #3                  // class javax/security/auth/message/callback/GroupPrincipalCallback
       4: ifeq          249
       7: aload_1
       8: checkcast     #3                  // class javax/security/auth/message/callback/GroupPrincipalCallback
      11: astore_2
      12: invokestatic  #4                  // Method org/jboss/security/auth/callback/SecurityActions.getCurrentSecurityContext:()Lorg/jboss/security/SecurityContext;
      15: astore_3
      16: aload_3
      17: ifnonnull     29
      20: getstatic     #5                  // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      23: invokeinterface #6,  1            // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullSecurityContext:()Ljava/lang/RuntimeException;
      28: athrow
      29: aload_2
      30: invokevirtual #7                  // Method javax/security/auth/message/callback/GroupPrincipalCallback.getGroups:()[Ljava/lang/String;
      33: astore        4
      35: aload         4
      37: ifnull        46
      40: aload         4
      42: arraylength
      43: goto          47
      46: iconst_0
      47: istore        5
      49: iload         5
      51: ifle          160
      54: new           #8                  // class java/util/ArrayList
      57: dup
      58: invokespecial #9                  // Method java/util/ArrayList."<init>":()V
      61: astore        6
      63: iconst_0
      64: istore        7
      66: iload         7
      68: iload         5
      70: if_icmpge     103
      73: new           #10                 // class org/jboss/security/identity/plugins/SimpleRole
      76: dup
      77: aload         4
      79: iload         7
      81: aaload
      82: invokespecial #11                 // Method org/jboss/security/identity/plugins/SimpleRole."<init>":(Ljava/lang/String;)V
      85: astore        8
      87: aload         6
      89: aload         8
      91: invokeinterface #12,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      96: pop
      97: iinc          7, 1
     100: goto          66
     103: new           #13                 // class org/jboss/security/identity/plugins/SimpleRoleGroup
     106: dup
     107: ldc           #15                 // String Roles
     109: aload         6
     111: invokespecial #16                 // Method org/jboss/security/identity/plugins/SimpleRoleGroup."<init>":(Ljava/lang/String;Ljava/util/Collection;)V
     114: astore        7
     116: aload_3
     117: invokeinterface #17,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
     122: invokevirtual #18                 // Method org/jboss/security/SecurityContextUtil.getRoles:()Lorg/jboss/security/identity/RoleGroup;
     125: astore        8
     127: aload         8
     129: ifnull        149
     132: aload         8
     134: aload         7
     136: invokeinterface #19,  1           // InterfaceMethod org/jboss/security/identity/RoleGroup.getRoles:()Ljava/util/Collection;
     141: invokeinterface #20,  2           // InterfaceMethod org/jboss/security/identity/RoleGroup.addAll:(Ljava/util/Collection;)V
     146: goto          160
     149: aload_3
     150: invokeinterface #17,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
     155: aload         7
     157: invokevirtual #21                 // Method org/jboss/security/SecurityContextUtil.setRoles:(Lorg/jboss/security/identity/RoleGroup;)V
     160: aload_2
     161: invokevirtual #22                 // Method javax/security/auth/message/callback/GroupPrincipalCallback.getSubject:()Ljavax/security/auth/Subject;
     164: astore        6
     166: aload         6
     168: ifnull        246
     171: aload_3
     172: invokeinterface #23,  1           // InterfaceMethod org/jboss/security/SecurityContext.getSubjectInfo:()Lorg/jboss/security/SubjectInfo;
     177: invokevirtual #24                 // Method org/jboss/security/SubjectInfo.getAuthenticatedSubject:()Ljavax/security/auth/Subject;
     180: astore        7
     182: aload         7
     184: ifnull        235
     187: aload         6
     189: invokevirtual #25                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     192: aload         7
     194: invokevirtual #25                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     197: invokeinterface #26,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     202: pop
     203: aload         6
     205: invokevirtual #27                 // Method javax/security/auth/Subject.getPublicCredentials:()Ljava/util/Set;
     208: aload         7
     210: invokevirtual #27                 // Method javax/security/auth/Subject.getPublicCredentials:()Ljava/util/Set;
     213: invokeinterface #26,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     218: pop
     219: aload         6
     221: invokevirtual #28                 // Method javax/security/auth/Subject.getPrivateCredentials:()Ljava/util/Set;
     224: aload         7
     226: invokevirtual #28                 // Method javax/security/auth/Subject.getPrivateCredentials:()Ljava/util/Set;
     229: invokeinterface #26,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     234: pop
     235: aload_3
     236: invokeinterface #23,  1           // InterfaceMethod org/jboss/security/SecurityContext.getSubjectInfo:()Lorg/jboss/security/SubjectInfo;
     241: aload         6
     243: invokevirtual #29                 // Method org/jboss/security/SubjectInfo.setAuthenticatedSubject:(Ljavax/security/auth/Subject;)V
     246: goto          613
     249: aload_1
     250: instanceof    #30                 // class javax/security/auth/message/callback/CallerPrincipalCallback
     253: ifeq          451
     256: aload_1
     257: checkcast     #30                 // class javax/security/auth/message/callback/CallerPrincipalCallback
     260: astore_2
     261: invokestatic  #4                  // Method org/jboss/security/auth/callback/SecurityActions.getCurrentSecurityContext:()Lorg/jboss/security/SecurityContext;
     264: astore_3
     265: aload_2
     266: invokevirtual #31                 // Method javax/security/auth/message/callback/CallerPrincipalCallback.getSubject:()Ljavax/security/auth/Subject;
     269: astore        4
     271: aload_3
     272: ifnonnull     284
     275: getstatic     #5                  // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     278: invokeinterface #6,  1            // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullSecurityContext:()Ljava/lang/RuntimeException;
     283: athrow
     284: aload         4
     286: ifnull        364
     289: aload_3
     290: invokeinterface #23,  1           // InterfaceMethod org/jboss/security/SecurityContext.getSubjectInfo:()Lorg/jboss/security/SubjectInfo;
     295: invokevirtual #24                 // Method org/jboss/security/SubjectInfo.getAuthenticatedSubject:()Ljavax/security/auth/Subject;
     298: astore        5
     300: aload         5
     302: ifnull        353
     305: aload         4
     307: invokevirtual #25                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     310: aload         5
     312: invokevirtual #25                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     315: invokeinterface #26,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     320: pop
     321: aload         4
     323: invokevirtual #27                 // Method javax/security/auth/Subject.getPublicCredentials:()Ljava/util/Set;
     326: aload         5
     328: invokevirtual #27                 // Method javax/security/auth/Subject.getPublicCredentials:()Ljava/util/Set;
     331: invokeinterface #26,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     336: pop
     337: aload         4
     339: invokevirtual #28                 // Method javax/security/auth/Subject.getPrivateCredentials:()Ljava/util/Set;
     342: aload         5
     344: invokevirtual #28                 // Method javax/security/auth/Subject.getPrivateCredentials:()Ljava/util/Set;
     347: invokeinterface #26,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     352: pop
     353: aload_3
     354: invokeinterface #23,  1           // InterfaceMethod org/jboss/security/SecurityContext.getSubjectInfo:()Lorg/jboss/security/SubjectInfo;
     359: aload         4
     361: invokevirtual #29                 // Method org/jboss/security/SubjectInfo.setAuthenticatedSubject:(Ljavax/security/auth/Subject;)V
     364: aload_2
     365: invokevirtual #32                 // Method javax/security/auth/message/callback/CallerPrincipalCallback.getPrincipal:()Ljava/security/Principal;
     368: astore        5
     370: aload         5
     372: ifnonnull     395
     375: aload_2
     376: invokevirtual #33                 // Method javax/security/auth/message/callback/CallerPrincipalCallback.getName:()Ljava/lang/String;
     379: ifnull        395
     382: new           #34                 // class org/jboss/security/SimplePrincipal
     385: dup
     386: aload_2
     387: invokevirtual #33                 // Method javax/security/auth/message/callback/CallerPrincipalCallback.getName:()Ljava/lang/String;
     390: invokespecial #35                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
     393: astore        5
     395: aload         5
     397: ifnull        448
     400: aload_3
     401: invokeinterface #23,  1           // InterfaceMethod org/jboss/security/SecurityContext.getSubjectInfo:()Lorg/jboss/security/SubjectInfo;
     406: invokevirtual #24                 // Method org/jboss/security/SubjectInfo.getAuthenticatedSubject:()Ljavax/security/auth/Subject;
     409: astore        6
     411: aload         6
     413: ifnull        429
     416: aload         6
     418: invokevirtual #25                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     421: aload         5
     423: invokeinterface #36,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     428: pop
     429: aload         5
     431: aconst_null
     432: invokestatic  #37                 // Method org/jboss/security/identity/IdentityFactory.getIdentity:(Ljava/security/Principal;Ljava/lang/Object;)Lorg/jboss/security/identity/Identity;
     435: astore        7
     437: aload_3
     438: invokeinterface #23,  1           // InterfaceMethod org/jboss/security/SecurityContext.getSubjectInfo:()Lorg/jboss/security/SubjectInfo;
     443: aload         7
     445: invokevirtual #38                 // Method org/jboss/security/SubjectInfo.addIdentity:(Lorg/jboss/security/identity/Identity;)V
     448: goto          613
     451: aload_1
     452: instanceof    #39                 // class javax/security/auth/message/callback/PasswordValidationCallback
     455: ifeq          608
     458: aload_1
     459: checkcast     #39                 // class javax/security/auth/message/callback/PasswordValidationCallback
     462: astore_2
     463: invokestatic  #4                  // Method org/jboss/security/auth/callback/SecurityActions.getCurrentSecurityContext:()Lorg/jboss/security/SecurityContext;
     466: astore_3
     467: aload_3
     468: ifnonnull     480
     471: getstatic     #5                  // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     474: invokeinterface #6,  1            // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullSecurityContext:()Ljava/lang/RuntimeException;
     479: athrow
     480: aload_2
     481: invokevirtual #40                 // Method javax/security/auth/message/callback/PasswordValidationCallback.getUsername:()Ljava/lang/String;
     484: astore        4
     486: aload_2
     487: invokevirtual #41                 // Method javax/security/auth/message/callback/PasswordValidationCallback.getPassword:()[C
     490: astore        5
     492: aload_2
     493: invokevirtual #42                 // Method javax/security/auth/message/callback/PasswordValidationCallback.getSubject:()Ljavax/security/auth/Subject;
     496: astore        6
     498: aload         6
     500: ifnull        605
     503: aload_3
     504: invokeinterface #23,  1           // InterfaceMethod org/jboss/security/SecurityContext.getSubjectInfo:()Lorg/jboss/security/SubjectInfo;
     509: invokevirtual #24                 // Method org/jboss/security/SubjectInfo.getAuthenticatedSubject:()Ljavax/security/auth/Subject;
     512: astore        7
     514: aload         7
     516: ifnull        567
     519: aload         6
     521: invokevirtual #25                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     524: aload         7
     526: invokevirtual #25                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     529: invokeinterface #26,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     534: pop
     535: aload         6
     537: invokevirtual #27                 // Method javax/security/auth/Subject.getPublicCredentials:()Ljava/util/Set;
     540: aload         7
     542: invokevirtual #27                 // Method javax/security/auth/Subject.getPublicCredentials:()Ljava/util/Set;
     545: invokeinterface #26,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     550: pop
     551: aload         6
     553: invokevirtual #28                 // Method javax/security/auth/Subject.getPrivateCredentials:()Ljava/util/Set;
     556: aload         7
     558: invokevirtual #28                 // Method javax/security/auth/Subject.getPrivateCredentials:()Ljava/util/Set;
     561: invokeinterface #26,  2           // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     566: pop
     567: aload_3
     568: invokeinterface #23,  1           // InterfaceMethod org/jboss/security/SecurityContext.getSubjectInfo:()Lorg/jboss/security/SubjectInfo;
     573: aload         6
     575: invokevirtual #29                 // Method org/jboss/security/SubjectInfo.setAuthenticatedSubject:(Ljavax/security/auth/Subject;)V
     578: new           #34                 // class org/jboss/security/SimplePrincipal
     581: dup
     582: aload         4
     584: invokespecial #35                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
     587: aload         5
     589: invokestatic  #37                 // Method org/jboss/security/identity/IdentityFactory.getIdentity:(Ljava/security/Principal;Ljava/lang/Object;)Lorg/jboss/security/identity/Identity;
     592: astore        8
     594: aload_3
     595: invokeinterface #23,  1           // InterfaceMethod org/jboss/security/SecurityContext.getSubjectInfo:()Lorg/jboss/security/SubjectInfo;
     600: aload         8
     602: invokevirtual #38                 // Method org/jboss/security/SubjectInfo.addIdentity:(Lorg/jboss/security/identity/Identity;)V
     605: goto          613
     608: aload_0
     609: aload_1
     610: invokespecial #43                 // Method org/jboss/security/auth/callback/JBossCallbackHandler.handleCallBack:(Ljavax/security/auth/callback/Callback;)V
     613: return
}
