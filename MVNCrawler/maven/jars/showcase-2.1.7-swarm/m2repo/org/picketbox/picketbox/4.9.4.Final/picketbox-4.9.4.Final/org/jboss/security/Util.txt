Compiled from "Util.java"
public class org.jboss.security.Util {
  private static org.jboss.security.PasswordCache externalPasswordCache;

  public org.jboss.security.Util();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public static char[] loadPassword(java.lang.String) throws java.lang.Exception;
    Code:
       0: invokestatic  #2                  // Method java/lang/System.getSecurityManager:()Ljava/lang/SecurityManager;
       3: astore_1
       4: aload_1
       5: ifnull        42
       8: aload_1
       9: new           #3                  // class java/lang/RuntimePermission
      12: dup
      13: new           #4                  // class java/lang/StringBuilder
      16: dup
      17: invokespecial #5                  // Method java/lang/StringBuilder."<init>":()V
      20: ldc           #6                  // class org/jboss/security/Util
      22: invokevirtual #7                  // Method java/lang/Class.getName:()Ljava/lang/String;
      25: invokevirtual #8                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      28: ldc           #9                  // String .loadPassword
      30: invokevirtual #8                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      33: invokevirtual #10                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      36: invokespecial #11                 // Method java/lang/RuntimePermission."<init>":(Ljava/lang/String;)V
      39: invokevirtual #12                 // Method java/lang/SecurityManager.checkPermission:(Ljava/security/Permission;)V
      42: aconst_null
      43: astore_2
      44: aconst_null
      45: astore_3
      46: aload_0
      47: iconst_0
      48: invokevirtual #13                 // Method java/lang/String.charAt:(I)C
      51: bipush        123
      53: if_icmpne     83
      56: new           #14                 // class java/util/StringTokenizer
      59: dup
      60: aload_0
      61: ldc           #15                 // String {}
      63: invokespecial #16                 // Method java/util/StringTokenizer."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      66: astore        4
      68: aload         4
      70: invokevirtual #17                 // Method java/util/StringTokenizer.nextToken:()Ljava/lang/String;
      73: astore_3
      74: aload         4
      76: invokevirtual #17                 // Method java/util/StringTokenizer.nextToken:()Ljava/lang/String;
      79: astore_0
      80: goto          88
      83: aload_0
      84: invokevirtual #18                 // Method java/lang/String.toCharArray:()[C
      87: astore_2
      88: aload_2
      89: ifnonnull     294
      92: aload_3
      93: ldc           #19                 // String EXTC
      95: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      98: ifne          110
     101: aload_3
     102: ldc           #21                 // String CMDC
     104: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     107: ifeq          215
     110: lconst_0
     111: lstore        4
     113: aload_3
     114: bipush        58
     116: invokevirtual #22                 // Method java/lang/String.indexOf:(I)I
     119: iconst_m1
     120: if_icmple     153
     123: aload_3
     124: ldc           #23                 // String :
     126: invokevirtual #24                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     129: astore        6
     131: aload         6
     133: iconst_1
     134: aaload
     135: invokestatic  #25                 // Method java/lang/Long.parseLong:(Ljava/lang/String;)J
     138: lstore        4
     140: goto          153
     143: astore        6
     145: getstatic     #27                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     148: invokeinterface #28,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.errorParsingTimeoutNumber:()V
     153: getstatic     #29                 // Field externalPasswordCache:Lorg/jboss/security/PasswordCache;
     156: ifnonnull     165
     159: invokestatic  #30                 // Method org/jboss/security/ExternalPasswordCache.getExternalPasswordCacheInstance:()Lorg/jboss/security/ExternalPasswordCache;
     162: putstatic     #29                 // Field externalPasswordCache:Lorg/jboss/security/PasswordCache;
     165: getstatic     #29                 // Field externalPasswordCache:Lorg/jboss/security/PasswordCache;
     168: aload_0
     169: lload         4
     171: invokeinterface #31,  4           // InterfaceMethod org/jboss/security/PasswordCache.contains:(Ljava/lang/String;J)Z
     176: ifeq          192
     179: getstatic     #29                 // Field externalPasswordCache:Lorg/jboss/security/PasswordCache;
     182: aload_0
     183: invokeinterface #32,  2           // InterfaceMethod org/jboss/security/PasswordCache.getPassword:(Ljava/lang/String;)[C
     188: astore_2
     189: goto          212
     192: aload_3
     193: aload_0
     194: invokestatic  #33                 // Method switchCommandExecution:(Ljava/lang/String;Ljava/lang/String;)[C
     197: astore_2
     198: aload_2
     199: ifnull        212
     202: getstatic     #29                 // Field externalPasswordCache:Lorg/jboss/security/PasswordCache;
     205: aload_0
     206: aload_2
     207: invokeinterface #34,  3           // InterfaceMethod org/jboss/security/PasswordCache.storePassword:(Ljava/lang/String;[C)V
     212: goto          294
     215: aload_3
     216: ldc           #35                 // String EXT
     218: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     221: ifne          233
     224: aload_3
     225: ldc           #36                 // String CMD
     227: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     230: ifeq          242
     233: aload_3
     234: aload_0
     235: invokestatic  #33                 // Method switchCommandExecution:(Ljava/lang/String;Ljava/lang/String;)[C
     238: astore_2
     239: goto          294
     242: aload_3
     243: ldc           #37                 // String CLASS
     245: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     248: ifeq          284
     251: aconst_null
     252: astore        4
     254: aload_3
     255: bipush        64
     257: invokevirtual #22                 // Method java/lang/String.indexOf:(I)I
     260: iconst_m1
     261: if_icmple     274
     264: aload_3
     265: ldc           #38                 // String @
     267: invokevirtual #24                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     270: iconst_1
     271: aaload
     272: astore        4
     274: aload_0
     275: aload         4
     277: invokestatic  #39                 // Method invokePasswordClass:(Ljava/lang/String;Ljava/lang/String;)[C
     280: astore_2
     281: goto          294
     284: getstatic     #40                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     287: aload_3
     288: invokeinterface #41,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidPasswordCommandType:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
     293: athrow
     294: aload_2
     295: areturn
    Exception table:
       from    to  target type
         123   140   143   Class java/lang/Throwable

  private static char[] switchCommandExecution(java.lang.String, java.lang.String) throws java.lang.Exception;
    Code:
       0: aload_0
       1: ldc           #35                 // String EXT
       3: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
       6: ifeq          14
       9: aload_1
      10: invokestatic  #42                 // Method execPasswordCmd:(Ljava/lang/String;)[C
      13: areturn
      14: aload_0
      15: ldc           #36                 // String CMD
      17: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      20: ifeq          28
      23: aload_1
      24: invokestatic  #43                 // Method execPBBasedPasswordCommand:(Ljava/lang/String;)[C
      27: areturn
      28: getstatic     #40                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      31: aload_0
      32: invokeinterface #41,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidPasswordCommandType:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      37: athrow

  private static char[] execPasswordCmd(java.lang.String) throws java.lang.Exception;
    Code:
       0: getstatic     #27                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: aload_0
       4: invokeinterface #44,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginExecPasswordCmd:(Ljava/lang/String;)V
       9: aload_0
      10: invokestatic  #45                 // Method execCmd:(Ljava/lang/String;)Ljava/lang/String;
      13: astore_1
      14: aload_1
      15: invokevirtual #18                 // Method java/lang/String.toCharArray:()[C
      18: areturn

  private static char[] invokePasswordClass(java.lang.String, java.lang.String) throws java.lang.Exception;
    Code:
       0: aconst_null
       1: astore_2
       2: aload_0
       3: astore_3
       4: aconst_null
       5: astore        4
       7: aload_0
       8: bipush        58
      10: invokevirtual #22                 // Method java/lang/String.indexOf:(I)I
      13: istore        5
      15: iload         5
      17: ifle          38
      20: aload_0
      21: iconst_0
      22: iload         5
      24: invokevirtual #46                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      27: astore_3
      28: aload_0
      29: iload         5
      31: iconst_1
      32: iadd
      33: invokevirtual #47                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      36: astore        4
      38: aload_3
      39: aload_1
      40: invokestatic  #48                 // Method loadClass:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Class;
      43: astore        6
      45: aconst_null
      46: astore        7
      48: aload         4
      50: ifnull        133
      53: aload         4
      55: ldc           #49                 // String ,
      57: invokevirtual #24                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
      60: astore        8
      62: aload         8
      64: arraylength
      65: anewarray     #50                 // class java/lang/Class
      68: astore        9
      70: new           #51                 // class java/util/ArrayList
      73: dup
      74: invokespecial #52                 // Method java/util/ArrayList."<init>":()V
      77: astore        10
      79: iconst_0
      80: istore        11
      82: iload         11
      84: aload         8
      86: arraylength
      87: if_icmpge     104
      90: aload         10
      92: ldc           #53                 // class java/lang/String
      94: invokevirtual #54                 // Method java/util/ArrayList.add:(Ljava/lang/Object;)Z
      97: pop
      98: iinc          11, 1
     101: goto          82
     104: aload         10
     106: aload         9
     108: invokevirtual #55                 // Method java/util/ArrayList.toArray:([Ljava/lang/Object;)[Ljava/lang/Object;
     111: pop
     112: aload         6
     114: aload         9
     116: invokevirtual #56                 // Method java/lang/Class.getConstructor:([Ljava/lang/Class;)Ljava/lang/reflect/Constructor;
     119: astore        11
     121: aload         11
     123: aload         8
     125: invokevirtual #57                 // Method java/lang/reflect/Constructor.newInstance:([Ljava/lang/Object;)Ljava/lang/Object;
     128: astore        7
     130: goto          140
     133: aload         6
     135: invokevirtual #58                 // Method java/lang/Class.newInstance:()Ljava/lang/Object;
     138: astore        7
     140: iconst_0
     141: anewarray     #50                 // class java/lang/Class
     144: astore        8
     146: aload         6
     148: ldc           #59                 // String toCharArray
     150: aload         8
     152: invokevirtual #60                 // Method java/lang/Class.getMethod:(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;
     155: astore        9
     157: iconst_0
     158: anewarray     #61                 // class java/lang/Object
     161: astore        10
     163: aload         9
     165: aload         7
     167: aload         10
     169: invokevirtual #62                 // Method java/lang/reflect/Method.invoke:(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
     172: checkcast     #63                 // class "[C"
     175: checkcast     #63                 // class "[C"
     178: astore_2
     179: goto          202
     182: astore        8
     184: aload         7
     186: invokevirtual #65                 // Method java/lang/Object.toString:()Ljava/lang/String;
     189: astore        9
     191: aload         9
     193: ifnull        202
     196: aload         9
     198: invokevirtual #18                 // Method java/lang/String.toCharArray:()[C
     201: astore_2
     202: aload_2
     203: areturn
    Exception table:
       from    to  target type
         140   179   182   Class java/lang/NoSuchMethodException

  private static java.lang.Class<?> loadClass(java.lang.String, java.lang.String);
    Code:
       0: new           #66                 // class org/jboss/security/Util$1
       3: dup
       4: aload_0
       5: aload_1
       6: invokespecial #67                 // Method org/jboss/security/Util$1."<init>":(Ljava/lang/String;Ljava/lang/String;)V
       9: invokestatic  #68                 // Method java/security/AccessController.doPrivileged:(Ljava/security/PrivilegedExceptionAction;)Ljava/lang/Object;
      12: checkcast     #50                 // class java/lang/Class
      15: astore_2
      16: aload_2
      17: areturn
      18: astore_2
      19: getstatic     #40                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      22: aload_2
      23: invokevirtual #70                 // Method java/security/PrivilegedActionException.getCause:()Ljava/lang/Throwable;
      26: aload_0
      27: invokeinterface #71,  3           // InterfaceMethod org/jboss/security/PicketBoxMessages.unableToLoadPasswordClass:(Ljava/lang/Throwable;Ljava/lang/String;)Ljava/lang/RuntimeException;
      32: athrow
    Exception table:
       from    to  target type
           0    17    18   Class java/security/PrivilegedActionException

  private static java.lang.String execCmd(java.lang.String) throws java.lang.Exception;
    Code:
       0: invokestatic  #2                  // Method java/lang/System.getSecurityManager:()Ljava/lang/SecurityManager;
       3: astore_1
       4: aload_1
       5: ifnull        21
       8: getstatic     #72                 // Field org/jboss/security/Util$RuntimeActions.PRIVILEGED:Lorg/jboss/security/Util$RuntimeActions;
      11: aload_0
      12: invokeinterface #73,  2           // InterfaceMethod org/jboss/security/Util$RuntimeActions.execCmd:(Ljava/lang/String;)Ljava/lang/String;
      17: astore_2
      18: goto          31
      21: getstatic     #74                 // Field org/jboss/security/Util$RuntimeActions.NON_PRIVILEGED:Lorg/jboss/security/Util$RuntimeActions;
      24: aload_0
      25: invokeinterface #73,  2           // InterfaceMethod org/jboss/security/Util$RuntimeActions.execCmd:(Ljava/lang/String;)Ljava/lang/String;
      30: astore_2
      31: aload_2
      32: areturn

  private static char[] execPBBasedPasswordCommand(java.lang.String) throws java.lang.Exception;
    Code:
       0: getstatic     #27                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: aload_0
       4: invokeinterface #44,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginExecPasswordCmd:(Ljava/lang/String;)V
       9: invokestatic  #2                  // Method java/lang/System.getSecurityManager:()Ljava/lang/SecurityManager;
      12: astore_1
      13: aload_1
      14: ifnull        30
      17: getstatic     #75                 // Field org/jboss/security/Util$RuntimeActions.PB_BASED_PRIVILEGED:Lorg/jboss/security/Util$RuntimeActions;
      20: aload_0
      21: invokeinterface #73,  2           // InterfaceMethod org/jboss/security/Util$RuntimeActions.execCmd:(Ljava/lang/String;)Ljava/lang/String;
      26: astore_2
      27: goto          40
      30: getstatic     #76                 // Field org/jboss/security/Util$RuntimeActions.PB_BASED_NON_PRIVILEGED:Lorg/jboss/security/Util$RuntimeActions;
      33: aload_0
      34: invokeinterface #73,  2           // InterfaceMethod org/jboss/security/Util$RuntimeActions.execCmd:(Ljava/lang/String;)Ljava/lang/String;
      39: astore_2
      40: aload_2
      41: invokevirtual #18                 // Method java/lang/String.toCharArray:()[C
      44: areturn

  public static boolean isPasswordCommand(java.lang.String);
    Code:
       0: aload_0
       1: ifnull        53
       4: aload_0
       5: ldc           #77                 // String {EXT}
       7: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      10: ifne          49
      13: aload_0
      14: ldc           #78                 // String {EXTC
      16: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      19: ifne          49
      22: aload_0
      23: ldc           #79                 // String {CMD}
      25: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      28: ifne          49
      31: aload_0
      32: ldc           #80                 // String {CMDC
      34: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      37: ifne          49
      40: aload_0
      41: ldc           #81                 // String {CLASS
      43: invokevirtual #20                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      46: ifeq          53
      49: iconst_1
      50: goto          54
      53: iconst_0
      54: ireturn

  public static boolean isPasswordCommand(char[]);
    Code:
       0: aload_0
       1: ifnull        22
       4: new           #53                 // class java/lang/String
       7: dup
       8: aload_0
       9: invokespecial #82                 // Method java/lang/String."<init>":([C)V
      12: invokestatic  #83                 // Method isPasswordCommand:(Ljava/lang/String;)Z
      15: ifeq          22
      18: iconst_1
      19: goto          23
      22: iconst_0
      23: ireturn
}
