Compiled from "JaasSecurityManagerBase.java"
public class org.jboss.security.plugins.auth.JaasSecurityManagerBase implements org.jboss.security.SubjectSecurityManager,org.jboss.security.RealmMapping {
  private java.lang.String securityDomain;

  private javax.security.auth.callback.CallbackHandler handler;

  private transient java.lang.reflect.Method setSecurityInfo;

  private boolean deepCopySubjectOption;

  private org.jboss.security.AuthorizationManager authorizationManager;

  public org.jboss.security.plugins.auth.JaasSecurityManagerBase();
    Code:
       0: aload_0
       1: ldc           #2                  // String other
       3: new           #3                  // class org/jboss/security/auth/callback/JBossCallbackHandler
       6: dup
       7: invokespecial #4                  // Method org/jboss/security/auth/callback/JBossCallbackHandler."<init>":()V
      10: invokespecial #5                  // Method "<init>":(Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;)V
      13: return

  public org.jboss.security.plugins.auth.JaasSecurityManagerBase(java.lang.String, javax.security.auth.callback.CallbackHandler);
    Code:
       0: aload_0
       1: invokespecial #6                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iconst_0
       6: putfield      #7                  // Field deepCopySubjectOption:Z
       9: aload_0
      10: aload_1
      11: invokestatic  #8                  // Method org/jboss/security/SecurityUtil.unprefixSecurityDomain:(Ljava/lang/String;)Ljava/lang/String;
      14: putfield      #9                  // Field securityDomain:Ljava/lang/String;
      17: aload_0
      18: aload_2
      19: putfield      #10                 // Field handler:Ljavax/security/auth/callback/CallbackHandler;
      22: new           #11                 // class java/lang/StringBuilder
      25: dup
      26: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      29: aload_0
      30: invokevirtual #13                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      33: invokevirtual #14                 // Method java/lang/Class.getName:()Ljava/lang/String;
      36: invokevirtual #15                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      39: bipush        46
      41: invokevirtual #16                 // Method java/lang/StringBuilder.append:(C)Ljava/lang/StringBuilder;
      44: aload_1
      45: invokevirtual #15                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      48: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      51: astore_3
      52: iconst_2
      53: anewarray     #18                 // class java/lang/Class
      56: dup
      57: iconst_0
      58: ldc           #19                 // class java/security/Principal
      60: aastore
      61: dup
      62: iconst_1
      63: ldc           #20                 // class java/lang/Object
      65: aastore
      66: astore        4
      68: aload_0
      69: aload_2
      70: invokevirtual #13                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      73: ldc           #21                 // String setSecurityInfo
      75: aload         4
      77: invokevirtual #22                 // Method java/lang/Class.getMethod:(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;
      80: putfield      #23                 // Field setSecurityInfo:Ljava/lang/reflect/Method;
      83: goto          106
      86: astore        5
      88: new           #25                 // class java/lang/reflect/UndeclaredThrowableException
      91: dup
      92: aload         5
      94: getstatic     #26                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      97: invokeinterface #27,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.unableToFindSetSecurityInfoMessage:()Ljava/lang/String;
     102: invokespecial #28                 // Method java/lang/reflect/UndeclaredThrowableException."<init>":(Ljava/lang/Throwable;Ljava/lang/String;)V
     105: athrow
     106: return
    Exception table:
       from    to  target type
          68    83    86   Class java/lang/Exception

  public void setDeepCopySubjectOption(java.lang.Boolean);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #29                 // Method java/lang/Boolean.booleanValue:()Z
       5: putfield      #7                  // Field deepCopySubjectOption:Z
       8: return

  public void setAuthorizationManager(org.jboss.security.AuthorizationManager);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #30                 // Field authorizationManager:Lorg/jboss/security/AuthorizationManager;
       5: return

  public java.lang.String getSecurityDomain();
    Code:
       0: aload_0
       1: getfield      #9                  // Field securityDomain:Ljava/lang/String;
       4: areturn

  public javax.security.auth.Subject getActiveSubject();
    Code:
       0: aconst_null
       1: astore_1
       2: invokestatic  #31                 // Method org/jboss/security/SecurityContextAssociation.getSecurityContext:()Lorg/jboss/security/SecurityContext;
       5: astore_2
       6: aload_2
       7: ifnull        20
      10: aload_2
      11: invokeinterface #32,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
      16: invokevirtual #33                 // Method org/jboss/security/SecurityContextUtil.getSubject:()Ljavax/security/auth/Subject;
      19: astore_1
      20: aload_1
      21: areturn

  public boolean isValid(java.security.Principal, java.lang.Object);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aconst_null
       4: invokevirtual #34                 // Method isValid:(Ljava/security/Principal;Ljava/lang/Object;Ljavax/security/auth/Subject;)Z
       7: ireturn

  public boolean isValid(java.security.Principal, java.lang.Object, javax.security.auth.Subject);
    Code:
       0: getstatic     #35                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: aload_1
       4: aconst_null
       5: invokeinterface #36,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginIsValid:(Ljava/security/Principal;Ljava/lang/String;)V
      10: iconst_0
      11: istore        4
      13: iload         4
      15: ifne          27
      18: aload_0
      19: aload_1
      20: aload_2
      21: aload_3
      22: invokespecial #37                 // Method authenticate:(Ljava/security/Principal;Ljava/lang/Object;Ljavax/security/auth/Subject;)Z
      25: istore        4
      27: getstatic     #35                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      30: iload         4
      32: invokeinterface #38,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceEndIsValid:(Z)V
      37: iload         4
      39: ireturn

  public java.security.Principal getPrincipal(java.security.Principal);
    Code:
       0: aload_1
       1: areturn

  public boolean doesUserHaveRole(java.security.Principal, java.util.Set<java.security.Principal>);
    Code:
       0: aload_0
       1: getfield      #30                 // Field authorizationManager:Lorg/jboss/security/AuthorizationManager;
       4: ifnonnull     20
       7: aload_0
       8: aload_0
       9: getfield      #9                  // Field securityDomain:Ljava/lang/String;
      12: ldc           #39                 // String java:jboss/jaas/
      14: invokestatic  #40                 // Method org/jboss/security/SecurityUtil.getAuthorizationManager:(Ljava/lang/String;Ljava/lang/String;)Lorg/jboss/security/AuthorizationManager;
      17: putfield      #30                 // Field authorizationManager:Lorg/jboss/security/AuthorizationManager;
      20: aload_0
      21: getfield      #30                 // Field authorizationManager:Lorg/jboss/security/AuthorizationManager;
      24: ifnonnull     41
      27: getstatic     #35                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      30: aload_0
      31: getfield      #9                  // Field securityDomain:Ljava/lang/String;
      34: invokeinterface #41,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugNullAuthorizationManager:(Ljava/lang/String;)V
      39: iconst_0
      40: ireturn
      41: aload_0
      42: getfield      #30                 // Field authorizationManager:Lorg/jboss/security/AuthorizationManager;
      45: aload_1
      46: aload_2
      47: invokeinterface #42,  3           // InterfaceMethod org/jboss/security/AuthorizationManager.doesUserHaveRole:(Ljava/security/Principal;Ljava/util/Set;)Z
      52: ireturn

  public java.util.Set<java.security.Principal> getUserRoles(java.security.Principal);
    Code:
       0: aload_0
       1: getfield      #30                 // Field authorizationManager:Lorg/jboss/security/AuthorizationManager;
       4: ifnonnull     20
       7: aload_0
       8: aload_0
       9: getfield      #9                  // Field securityDomain:Ljava/lang/String;
      12: ldc           #39                 // String java:jboss/jaas/
      14: invokestatic  #40                 // Method org/jboss/security/SecurityUtil.getAuthorizationManager:(Ljava/lang/String;Ljava/lang/String;)Lorg/jboss/security/AuthorizationManager;
      17: putfield      #30                 // Field authorizationManager:Lorg/jboss/security/AuthorizationManager;
      20: aload_0
      21: getfield      #30                 // Field authorizationManager:Lorg/jboss/security/AuthorizationManager;
      24: ifnonnull     41
      27: getstatic     #35                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      30: aload_0
      31: getfield      #9                  // Field securityDomain:Ljava/lang/String;
      34: invokeinterface #41,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugNullAuthorizationManager:(Ljava/lang/String;)V
      39: aconst_null
      40: areturn
      41: aload_0
      42: getfield      #30                 // Field authorizationManager:Lorg/jboss/security/AuthorizationManager;
      45: aload_1
      46: invokeinterface #43,  2           // InterfaceMethod org/jboss/security/AuthorizationManager.getUserRoles:(Ljava/security/Principal;)Ljava/util/Set;
      51: areturn

  public java.security.Principal getTargetPrincipal(java.security.Principal, java.util.Map<java.lang.String, java.lang.Object>);
    Code:
       0: new           #44                 // class java/lang/UnsupportedOperationException
       3: dup
       4: invokespecial #45                 // Method java/lang/UnsupportedOperationException."<init>":()V
       7: athrow

  private boolean authenticate(java.security.Principal, java.lang.Object, javax.security.auth.Subject);
    Code:
       0: aload_0
       1: getfield      #9                  // Field securityDomain:Ljava/lang/String;
       4: invokestatic  #46                 // Method org/jboss/security/config/SecurityConfiguration.getApplicationPolicy:(Ljava/lang/String;)Lorg/jboss/security/config/ApplicationPolicy;
       7: astore        4
       9: aload         4
      11: ifnull        96
      14: aload         4
      16: invokevirtual #47                 // Method org/jboss/security/config/ApplicationPolicy.getAuthenticationInfo:()Lorg/jboss/security/auth/login/BaseAuthenticationInfo;
      19: astore        5
      21: aload         5
      23: invokevirtual #48                 // Method org/jboss/security/auth/login/BaseAuthenticationInfo.getJBossModuleName:()Ljava/lang/String;
      26: astore        6
      28: aload         6
      30: ifnull        96
      33: invokestatic  #49                 // Method org/jboss/security/plugins/auth/SubjectActions.getContextClassLoader:()Ljava/lang/ClassLoader;
      36: astore        7
      38: invokestatic  #50                 // Method org/jboss/security/plugins/ClassLoaderLocatorFactory.get:()Lorg/jboss/security/plugins/ClassLoaderLocator;
      41: astore        8
      43: aload         8
      45: ifnull        96
      48: aload         8
      50: aload         6
      52: invokeinterface #51,  2           // InterfaceMethod org/jboss/security/plugins/ClassLoaderLocator.get:(Ljava/lang/String;)Ljava/lang/ClassLoader;
      57: astore        9
      59: aload         9
      61: ifnull        96
      64: aload         9
      66: invokestatic  #52                 // Method org/jboss/security/plugins/auth/SubjectActions.setContextClassLoader:(Ljava/lang/ClassLoader;)V
      69: aload_0
      70: aload_1
      71: aload_2
      72: aload_3
      73: invokespecial #53                 // Method proceedWithJaasLogin:(Ljava/security/Principal;Ljava/lang/Object;Ljavax/security/auth/Subject;)Z
      76: istore        10
      78: aload         7
      80: invokestatic  #52                 // Method org/jboss/security/plugins/auth/SubjectActions.setContextClassLoader:(Ljava/lang/ClassLoader;)V
      83: iload         10
      85: ireturn
      86: astore        11
      88: aload         7
      90: invokestatic  #52                 // Method org/jboss/security/plugins/auth/SubjectActions.setContextClassLoader:(Ljava/lang/ClassLoader;)V
      93: aload         11
      95: athrow
      96: aload_0
      97: aload_1
      98: aload_2
      99: aload_3
     100: invokespecial #53                 // Method proceedWithJaasLogin:(Ljava/security/Principal;Ljava/lang/Object;Ljavax/security/auth/Subject;)Z
     103: ireturn
    Exception table:
       from    to  target type
          64    78    86   any
          86    88    86   any

  private boolean proceedWithJaasLogin(java.security.Principal, java.lang.Object, javax.security.auth.Subject);
    Code:
       0: aconst_null
       1: astore        4
       3: iconst_0
       4: istore        5
       6: aconst_null
       7: astore        6
       9: aload_0
      10: aload_1
      11: aload_2
      12: invokespecial #54                 // Method defaultLogin:(Ljava/security/Principal;Ljava/lang/Object;)Ljavax/security/auth/login/LoginContext;
      15: astore        7
      17: aload         7
      19: invokevirtual #55                 // Method javax/security/auth/login/LoginContext.getSubject:()Ljavax/security/auth/Subject;
      22: astore        4
      24: aload         4
      26: ifnull        53
      29: aload_3
      30: ifnull        47
      33: aload         4
      35: aload_3
      36: iconst_0
      37: aload_0
      38: getfield      #7                  // Field deepCopySubjectOption:Z
      41: invokestatic  #56                 // Method org/jboss/security/plugins/auth/SubjectActions.copySubject:(Ljavax/security/auth/Subject;Ljavax/security/auth/Subject;ZZ)V
      44: goto          50
      47: aload         4
      49: astore_3
      50: iconst_1
      51: istore        5
      53: goto          85
      56: astore        7
      58: aload_1
      59: ifnull        81
      62: aload_1
      63: invokeinterface #58,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      68: ifnull        81
      71: getstatic     #35                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      74: aload         7
      76: invokeinterface #59,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailedLogin:(Ljava/lang/Throwable;)V
      81: aload         7
      83: astore        6
      85: ldc           #60                 // String org.jboss.security.exception
      87: aload         6
      89: invokestatic  #61                 // Method org/jboss/security/plugins/auth/SubjectActions.setContextInfo:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
      92: pop
      93: iload         5
      95: ireturn
    Exception table:
       from    to  target type
           9    53    56   Class javax/security/auth/login/LoginException

  private javax.security.auth.login.LoginContext defaultLogin(java.security.Principal, java.lang.Object) throws javax.security.auth.login.LoginException;
    Code:
       0: iconst_2
       1: anewarray     #20                 // class java/lang/Object
       4: dup
       5: iconst_0
       6: aload_1
       7: aastore
       8: dup
       9: iconst_1
      10: aload_2
      11: aastore
      12: astore_3
      13: aconst_null
      14: astore        4
      16: aload_0
      17: getfield      #10                 // Field handler:Ljavax/security/auth/callback/CallbackHandler;
      20: invokevirtual #13                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      23: invokevirtual #62                 // Method java/lang/Class.newInstance:()Ljava/lang/Object;
      26: checkcast     #63                 // class javax/security/auth/callback/CallbackHandler
      29: astore        4
      31: aload_0
      32: getfield      #23                 // Field setSecurityInfo:Ljava/lang/reflect/Method;
      35: aload         4
      37: aload_3
      38: invokevirtual #64                 // Method java/lang/reflect/Method.invoke:(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
      41: pop
      42: goto          75
      45: astore        5
      47: new           #57                 // class javax/security/auth/login/LoginException
      50: dup
      51: getstatic     #26                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      54: invokeinterface #27,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.unableToFindSetSecurityInfoMessage:()Ljava/lang/String;
      59: invokespecial #66                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      62: astore        6
      64: aload         6
      66: aload         5
      68: invokevirtual #67                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
      71: pop
      72: aload         6
      74: athrow
      75: new           #68                 // class javax/security/auth/Subject
      78: dup
      79: invokespecial #69                 // Method javax/security/auth/Subject."<init>":()V
      82: astore        5
      84: aconst_null
      85: astore        6
      87: getstatic     #35                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      90: aload_1
      91: invokeinterface #70,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceDefaultLoginPrincipal:(Ljava/security/Principal;)V
      96: aload_0
      97: getfield      #9                  // Field securityDomain:Ljava/lang/String;
     100: aload         5
     102: aload         4
     104: invokestatic  #71                 // Method org/jboss/security/plugins/auth/SubjectActions.createLoginContext:(Ljava/lang/String;Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;)Ljavax/security/auth/login/LoginContext;
     107: astore        6
     109: aload         6
     111: invokevirtual #72                 // Method javax/security/auth/login/LoginContext.login:()V
     114: getstatic     #35                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     117: invokeinterface #73,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.isDebugEnabled:()Z
     122: ifeq          143
     125: getstatic     #35                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     128: aload         6
     130: invokevirtual #74                 // Method java/lang/Object.toString:()Ljava/lang/String;
     133: aload         5
     135: invokestatic  #75                 // Method org/jboss/security/plugins/auth/SubjectActions.toString:(Ljavax/security/auth/Subject;)Ljava/lang/String;
     138: invokeinterface #76,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceDefaultLoginSubject:(Ljava/lang/String;Ljava/lang/String;)V
     143: aload         6
     145: areturn
    Exception table:
       from    to  target type
          16    42    45   Class java/lang/Throwable

  public void logout(java.security.Principal, javax.security.auth.Subject);
    Code:
       0: aload_2
       1: ifnonnull     12
       4: new           #68                 // class javax/security/auth/Subject
       7: dup
       8: invokespecial #69                 // Method javax/security/auth/Subject."<init>":()V
      11: astore_2
      12: aconst_null
      13: astore_3
      14: iconst_2
      15: anewarray     #20                 // class java/lang/Object
      18: dup
      19: iconst_0
      20: aload_1
      21: aastore
      22: dup
      23: iconst_1
      24: aconst_null
      25: aastore
      26: astore        4
      28: aconst_null
      29: astore        5
      31: aload_0
      32: getfield      #10                 // Field handler:Ljavax/security/auth/callback/CallbackHandler;
      35: invokevirtual #13                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      38: invokevirtual #62                 // Method java/lang/Class.newInstance:()Ljava/lang/Object;
      41: checkcast     #63                 // class javax/security/auth/callback/CallbackHandler
      44: astore        5
      46: aload_0
      47: getfield      #23                 // Field setSecurityInfo:Ljava/lang/reflect/Method;
      50: aload         5
      52: aload         4
      54: invokevirtual #64                 // Method java/lang/reflect/Method.invoke:(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;
      57: pop
      58: aload_0
      59: getfield      #9                  // Field securityDomain:Ljava/lang/String;
      62: aload_2
      63: aload         5
      65: invokestatic  #71                 // Method org/jboss/security/plugins/auth/SubjectActions.createLoginContext:(Ljava/lang/String;Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;)Ljavax/security/auth/login/LoginContext;
      68: astore_3
      69: goto          110
      72: astore        6
      74: new           #57                 // class javax/security/auth/login/LoginException
      77: dup
      78: getstatic     #26                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      81: aload         6
      83: invokeinterface #77,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.unableToInitializeLoginContext:(Ljava/lang/Throwable;)Ljava/lang/String;
      88: invokespecial #66                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      91: astore        7
      93: aload         7
      95: aload         6
      97: invokevirtual #67                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     100: pop
     101: ldc           #60                 // String org.jboss.security.exception
     103: aload         7
     105: invokestatic  #61                 // Method org/jboss/security/plugins/auth/SubjectActions.setContextInfo:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     108: pop
     109: return
     110: aload_3
     111: invokevirtual #78                 // Method javax/security/auth/login/LoginContext.logout:()V
     114: getstatic     #35                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     117: invokeinterface #79,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.isTraceEnabled:()Z
     122: ifeq          141
     125: getstatic     #35                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     128: aload_3
     129: invokevirtual #74                 // Method java/lang/Object.toString:()Ljava/lang/String;
     132: aload_2
     133: invokestatic  #75                 // Method org/jboss/security/plugins/auth/SubjectActions.toString:(Ljavax/security/auth/Subject;)Ljava/lang/String;
     136: invokeinterface #80,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceLogoutSubject:(Ljava/lang/String;Ljava/lang/String;)V
     141: goto          154
     144: astore        6
     146: ldc           #60                 // String org.jboss.security.exception
     148: aload         6
     150: invokestatic  #61                 // Method org/jboss/security/plugins/auth/SubjectActions.setContextInfo:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     153: pop
     154: return
    Exception table:
       from    to  target type
          31    69    72   Class java/lang/Throwable
         110   141   144   Class javax/security/auth/login/LoginException
}
