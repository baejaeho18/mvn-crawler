Compiled from "SubjectPolicyContextHandler.java"
class org.jboss.security.jacc.SubjectPolicyContextHandler$GetSubjectAction implements java.security.PrivilegedAction<javax.security.auth.Subject> {
  static java.security.PrivilegedAction<javax.security.auth.Subject> ACTION;

  private org.jboss.security.jacc.SubjectPolicyContextHandler$GetSubjectAction();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public javax.security.auth.Subject run();
    Code:
       0: aconst_null
       1: astore_1
       2: invokestatic  #2                  // Method org/jboss/security/SecurityContextAssociation.getSecurityContext:()Lorg/jboss/security/SecurityContext;
       5: astore_2
       6: aload_2
       7: ifnull        118
      10: aload_2
      11: invokeinterface #3,  1            // InterfaceMethod org/jboss/security/SecurityContext.getSubjectInfo:()Lorg/jboss/security/SubjectInfo;
      16: astore_3
      17: aload_3
      18: ifnull        118
      21: aload_3
      22: invokevirtual #4                  // Method org/jboss/security/SubjectInfo.getAuthenticatedSubject:()Ljavax/security/auth/Subject;
      25: astore        4
      27: aload_2
      28: invokeinterface #5,  1            // InterfaceMethod org/jboss/security/SecurityContext.getIncomingRunAs:()Lorg/jboss/security/RunAs;
      33: checkcast     #6                  // class org/jboss/security/RunAsIdentity
      36: astore        5
      38: aload         4
      40: ifnull        89
      43: aload         5
      45: ifnonnull     58
      48: aload         4
      50: invokevirtual #7                  // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      53: astore        6
      55: goto          65
      58: aload         5
      60: invokevirtual #8                  // Method org/jboss/security/RunAsIdentity.getPrincipalsSet:()Ljava/util/Set;
      63: astore        6
      65: new           #9                  // class javax/security/auth/Subject
      68: dup
      69: iconst_1
      70: aload         6
      72: aload         4
      74: invokevirtual #10                 // Method javax/security/auth/Subject.getPublicCredentials:()Ljava/util/Set;
      77: aload         4
      79: invokevirtual #11                 // Method javax/security/auth/Subject.getPrivateCredentials:()Ljava/util/Set;
      82: invokespecial #12                 // Method javax/security/auth/Subject."<init>":(ZLjava/util/Set;Ljava/util/Set;Ljava/util/Set;)V
      85: astore_1
      86: goto          118
      89: aload         5
      91: ifnull        118
      94: aload         5
      96: invokevirtual #8                  // Method org/jboss/security/RunAsIdentity.getPrincipalsSet:()Ljava/util/Set;
      99: astore        6
     101: new           #9                  // class javax/security/auth/Subject
     104: dup
     105: iconst_1
     106: aload         6
     108: getstatic     #13                 // Field org/jboss/security/jacc/SubjectPolicyContextHandler.EMPTY_SET:Ljava/util/HashSet;
     111: getstatic     #13                 // Field org/jboss/security/jacc/SubjectPolicyContextHandler.EMPTY_SET:Ljava/util/HashSet;
     114: invokespecial #12                 // Method javax/security/auth/Subject."<init>":(ZLjava/util/Set;Ljava/util/Set;Ljava/util/Set;)V
     117: astore_1
     118: aload_1
     119: areturn

  public java.lang.Object run();
    Code:
       0: aload_0
       1: invokevirtual #14                 // Method run:()Ljavax/security/auth/Subject;
       4: areturn

  static {};
    Code:
       0: new           #15                 // class org/jboss/security/jacc/SubjectPolicyContextHandler$GetSubjectAction
       3: dup
       4: invokespecial #16                 // Method "<init>":()V
       7: putstatic     #17                 // Field ACTION:Ljava/security/PrivilegedAction;
      10: return
}
