Compiled from "AltClientLoginModule.java"
public class org.jboss.security.AltClientLoginModule implements javax.security.auth.spi.LoginModule {
  private static final java.lang.String MULTI_TREADED;

  private static final java.lang.String PASSWORD_STACKING;

  private static final java.lang.String USE_FIRST_PASSWORD;

  private static final java.lang.String PRINCIPAL_CLASS;

  private static final java.lang.String[] ALL_VALID_OPTIONS;

  private javax.security.auth.Subject subject;

  private javax.security.auth.callback.CallbackHandler callbackHandler;

  private java.util.Map<java.lang.String, ?> sharedState;

  private boolean useFirstPass;

  private java.lang.String username;

  private char[] password;

  public org.jboss.security.AltClientLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #2                  // Field password:[C
       9: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map<java.lang.String, ?>, java.util.Map<java.lang.String, ?>);
    Code:
       0: new           #3                  // class java/util/HashSet
       3: dup
       4: getstatic     #4                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
       7: invokestatic  #5                  // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
      10: invokespecial #6                  // Method java/util/HashSet."<init>":(Ljava/util/Collection;)V
      13: astore        5
      15: aload         4
      17: invokeinterface #7,  1            // InterfaceMethod java/util/Map.keySet:()Ljava/util/Set;
      22: invokeinterface #8,  1            // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      27: astore        6
      29: aload         6
      31: invokeinterface #9,  1            // InterfaceMethod java/util/Iterator.hasNext:()Z
      36: ifeq          77
      39: aload         6
      41: invokeinterface #10,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      46: astore        7
      48: aload         5
      50: aload         7
      52: checkcast     #11                 // class java/lang/String
      55: invokevirtual #12                 // Method java/util/HashSet.contains:(Ljava/lang/Object;)Z
      58: ifne          74
      61: getstatic     #13                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      64: aload         7
      66: checkcast     #11                 // class java/lang/String
      69: invokeinterface #14,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.warnInvalidModuleOption:(Ljava/lang/String;)V
      74: goto          29
      77: aload_0
      78: aload_1
      79: putfield      #15                 // Field subject:Ljavax/security/auth/Subject;
      82: aload_0
      83: aload_2
      84: putfield      #16                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      87: aload_0
      88: aload_3
      89: putfield      #17                 // Field sharedState:Ljava/util/Map;
      92: getstatic     #13                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      95: ldc           #19                 // String jboss.security.security_domain
      97: aload         4
      99: ldc           #19                 // String jboss.security.security_domain
     101: invokeinterface #20,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     106: invokeinterface #21,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugModuleOption:(Ljava/lang/String;Ljava/lang/Object;)V
     111: aload         4
     113: ldc           #23                 // String multi-threaded
     115: invokeinterface #20,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     120: checkcast     #11                 // class java/lang/String
     123: astore        6
     125: aload         6
     127: invokestatic  #24                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     130: invokevirtual #25                 // Method java/lang/Boolean.booleanValue:()Z
     133: iconst_1
     134: if_icmpne     149
     137: getstatic     #13                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     140: ldc           #23                 // String multi-threaded
     142: aload         6
     144: invokeinterface #21,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugModuleOption:(Ljava/lang/String;Ljava/lang/Object;)V
     149: aload         4
     151: ldc           #26                 // String password-stacking
     153: invokeinterface #20,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     158: checkcast     #11                 // class java/lang/String
     161: astore        7
     163: aload         7
     165: ifnull        183
     168: aload         7
     170: ldc           #27                 // String useFirstPass
     172: invokevirtual #28                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     175: ifeq          183
     178: aload_0
     179: iconst_1
     180: putfield      #29                 // Field useFirstPass:Z
     183: getstatic     #13                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     186: ldc           #26                 // String password-stacking
     188: aload         7
     190: invokeinterface #21,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugModuleOption:(Ljava/lang/String;Ljava/lang/Object;)V
     195: return

  public boolean login() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #29                 // Field useFirstPass:Z
       4: iconst_1
       5: if_icmpne     10
       8: iconst_1
       9: ireturn
      10: aload_0
      11: getfield      #16                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      14: ifnonnull     26
      17: getstatic     #30                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      20: invokeinterface #31,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.noCallbackHandlerAvailable:()Ljavax/security/auth/login/LoginException;
      25: athrow
      26: new           #32                 // class javax/security/auth/callback/PasswordCallback
      29: dup
      30: getstatic     #30                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      33: invokeinterface #33,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.enterPasswordMessage:()Ljava/lang/String;
      38: iconst_0
      39: invokespecial #34                 // Method javax/security/auth/callback/PasswordCallback."<init>":(Ljava/lang/String;Z)V
      42: astore_1
      43: new           #35                 // class javax/security/auth/callback/NameCallback
      46: dup
      47: getstatic     #30                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      50: invokeinterface #36,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.enterUsernameMessage:()Ljava/lang/String;
      55: ldc           #37                 // String guest
      57: invokespecial #38                 // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      60: astore_2
      61: iconst_2
      62: anewarray     #39                 // class javax/security/auth/callback/Callback
      65: dup
      66: iconst_0
      67: aload_2
      68: aastore
      69: dup
      70: iconst_1
      71: aload_1
      72: aastore
      73: astore_3
      74: aload_0
      75: getfield      #16                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      78: aload_3
      79: invokeinterface #40,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      84: aload_0
      85: aload_2
      86: invokevirtual #41                 // Method javax/security/auth/callback/NameCallback.getName:()Ljava/lang/String;
      89: putfield      #42                 // Field username:Ljava/lang/String;
      92: aload_1
      93: invokevirtual #43                 // Method javax/security/auth/callback/PasswordCallback.getPassword:()[C
      96: astore        4
      98: aload         4
     100: ifnull        130
     103: aload_0
     104: aload         4
     106: arraylength
     107: newarray       char
     109: putfield      #2                  // Field password:[C
     112: aload         4
     114: iconst_0
     115: aload_0
     116: getfield      #2                  // Field password:[C
     119: iconst_0
     120: aload         4
     122: arraylength
     123: invokestatic  #44                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     126: aload_1
     127: invokevirtual #45                 // Method javax/security/auth/callback/PasswordCallback.clearPassword:()V
     130: goto          175
     133: astore        4
     135: new           #47                 // class javax/security/auth/login/LoginException
     138: dup
     139: aload         4
     141: invokevirtual #48                 // Method java/io/IOException.toString:()Ljava/lang/String;
     144: invokespecial #49                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
     147: athrow
     148: astore        4
     150: new           #47                 // class javax/security/auth/login/LoginException
     153: dup
     154: aload         4
     156: invokevirtual #51                 // Method javax/security/auth/callback/UnsupportedCallbackException.getLocalizedMessage:()Ljava/lang/String;
     159: invokespecial #49                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
     162: astore        5
     164: aload         5
     166: aload         4
     168: invokevirtual #52                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     171: pop
     172: aload         5
     174: athrow
     175: iconst_1
     176: ireturn
    Exception table:
       from    to  target type
          74   130   133   Class java/io/IOException
          74   130   148   Class javax/security/auth/callback/UnsupportedCallbackException

  public boolean commit() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #15                 // Field subject:Ljavax/security/auth/Subject;
       4: invokevirtual #53                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
       7: astore_1
       8: aconst_null
       9: astore_2
      10: aload_0
      11: getfield      #2                  // Field password:[C
      14: astore_3
      15: aload_0
      16: getfield      #29                 // Field useFirstPass:Z
      19: iconst_1
      20: if_icmpne     99
      23: aload_0
      24: getfield      #17                 // Field sharedState:Ljava/util/Map;
      27: ldc           #54                 // String javax.security.auth.login.name
      29: invokeinterface #20,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      34: astore        4
      36: aload         4
      38: instanceof    #55                 // class java/security/Principal
      41: ifne          78
      44: aload_0
      45: aload         4
      47: ifnull        58
      50: aload         4
      52: invokevirtual #56                 // Method java/lang/Object.toString:()Ljava/lang/String;
      55: goto          60
      58: ldc           #57                 // String
      60: putfield      #42                 // Field username:Ljava/lang/String;
      63: new           #58                 // class org/jboss/security/SimplePrincipal
      66: dup
      67: aload_0
      68: getfield      #42                 // Field username:Ljava/lang/String;
      71: invokespecial #59                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
      74: astore_2
      75: goto          84
      78: aload         4
      80: checkcast     #55                 // class java/security/Principal
      83: astore_2
      84: aload_0
      85: getfield      #17                 // Field sharedState:Ljava/util/Map;
      88: ldc           #60                 // String javax.security.auth.login.password
      90: invokeinterface #20,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      95: astore_3
      96: goto          111
      99: new           #58                 // class org/jboss/security/SimplePrincipal
     102: dup
     103: aload_0
     104: getfield      #42                 // Field username:Ljava/lang/String;
     107: invokespecial #59                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
     110: astore_2
     111: aload_1
     112: invokeinterface #61,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
     117: ifne          135
     120: aload_1
     121: invokeinterface #8,  1            // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     126: invokeinterface #10,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     131: checkcast     #55                 // class java/security/Principal
     134: astore_2
     135: aload_2
     136: aload_3
     137: aload_0
     138: getfield      #15                 // Field subject:Ljavax/security/auth/Subject;
     141: invokestatic  #62                 // Method org/jboss/security/SecurityAssociationActions.setPrincipalInfo:(Ljava/security/Principal;Ljava/lang/Object;Ljavax/security/auth/Subject;)V
     144: iconst_1
     145: ireturn

  public boolean abort() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field password:[C
       4: ifnull        15
       7: aload_0
       8: getfield      #2                  // Field password:[C
      11: arraylength
      12: goto          16
      15: iconst_0
      16: istore_1
      17: iconst_0
      18: istore_2
      19: iload_2
      20: iload_1
      21: if_icmpge     37
      24: aload_0
      25: getfield      #2                  // Field password:[C
      28: iload_2
      29: iconst_0
      30: castore
      31: iinc          2, 1
      34: goto          19
      37: invokestatic  #63                 // Method org/jboss/security/SecurityAssociationActions.clear:()V
      40: iconst_1
      41: ireturn

  public boolean logout() throws javax.security.auth.login.LoginException;
    Code:
       0: invokestatic  #63                 // Method org/jboss/security/SecurityAssociationActions.clear:()V
       3: iconst_1
       4: ireturn

  static {};
    Code:
       0: iconst_4
       1: anewarray     #11                 // class java/lang/String
       4: dup
       5: iconst_0
       6: ldc           #23                 // String multi-threaded
       8: aastore
       9: dup
      10: iconst_1
      11: ldc           #26                 // String password-stacking
      13: aastore
      14: dup
      15: iconst_2
      16: ldc           #64                 // String principalClass
      18: aastore
      19: dup
      20: iconst_3
      21: ldc           #19                 // String jboss.security.security_domain
      23: aastore
      24: putstatic     #4                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
      27: return
}
