Compiled from "AbstractServerLoginModule.java"
public abstract class org.jboss.security.auth.spi.AbstractServerLoginModule implements javax.security.auth.spi.LoginModule {
  private static final java.lang.String PASSWORD_STACKING;

  private static final java.lang.String USE_FIRST_PASSWORD;

  private static final java.lang.String PRINCIPAL_CLASS;

  private static final java.lang.String PRINCIPAL_CLASS_MODULE;

  private static final java.lang.String UNAUTHENTICATED_IDENTITY;

  private static final java.lang.String MODULE;

  private static final java.lang.String[] ALL_VALID_OPTIONS;

  private java.util.HashSet<java.lang.String> validOptions;

  protected javax.security.auth.Subject subject;

  protected javax.security.auth.callback.CallbackHandler callbackHandler;

  protected java.util.Map sharedState;

  protected java.util.Map options;

  protected boolean useFirstPass;

  protected boolean loginOk;

  protected java.lang.String principalClassName;

  protected java.lang.String principalClassModuleName;

  protected java.security.Principal unauthenticatedIdentity;

  protected java.lang.String jbossModuleName;

  protected org.jboss.logging.Logger log;

  public org.jboss.security.auth.spi.AbstractServerLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc           #2                  // class org/jboss/security/auth/spi/AbstractServerLoginModule
       7: invokestatic  #3                  // Method org/jboss/logging/Logger.getLogger:(Ljava/lang/Class;)Lorg/jboss/logging/Logger;
      10: putfield      #4                  // Field log:Lorg/jboss/logging/Logger;
      13: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map<java.lang.String, ?>, java.util.Map<java.lang.String, ?>);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #5                  // Field subject:Ljavax/security/auth/Subject;
       5: aload_0
       6: aload_2
       7: putfield      #6                  // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      10: aload_0
      11: aload_3
      12: putfield      #7                  // Field sharedState:Ljava/util/Map;
      15: aload_0
      16: aload         4
      18: putfield      #8                  // Field options:Ljava/util/Map;
      21: getstatic     #9                  // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      24: invokeinterface #10,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginInitialize:()V
      29: aload_0
      30: getfield      #11                 // Field validOptions:Ljava/util/HashSet;
      33: ifnull        47
      36: aload_0
      37: getstatic     #12                 // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
      40: invokevirtual #13                 // Method addValidOptions:([Ljava/lang/String;)V
      43: aload_0
      44: invokevirtual #14                 // Method checkOptions:()V
      47: aload         4
      49: ldc           #15                 // String password-stacking
      51: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      56: checkcast     #17                 // class java/lang/String
      59: astore        5
      61: aload         5
      63: ifnull        81
      66: aload         5
      68: ldc           #18                 // String useFirstPass
      70: invokevirtual #19                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
      73: ifeq          81
      76: aload_0
      77: iconst_1
      78: putfield      #20                 // Field useFirstPass:Z
      81: aload_0
      82: aload         4
      84: ldc           #21                 // String principalClass
      86: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      91: checkcast     #17                 // class java/lang/String
      94: putfield      #22                 // Field principalClassName:Ljava/lang/String;
      97: aload_0
      98: aload         4
     100: ldc           #23                 // String principalClassModule
     102: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     107: checkcast     #17                 // class java/lang/String
     110: putfield      #24                 // Field principalClassModuleName:Ljava/lang/String;
     113: aload         4
     115: ldc           #25                 // String unauthenticatedIdentity
     117: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     122: checkcast     #17                 // class java/lang/String
     125: astore        6
     127: aload         6
     129: ifnull        167
     132: aload_0
     133: aload_0
     134: aload         6
     136: invokevirtual #26                 // Method createIdentity:(Ljava/lang/String;)Ljava/security/Principal;
     139: putfield      #27                 // Field unauthenticatedIdentity:Ljava/security/Principal;
     142: getstatic     #9                  // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     145: aload         6
     147: invokeinterface #28,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceUnauthenticatedIdentity:(Ljava/lang/String;)V
     152: goto          167
     155: astore        7
     157: getstatic     #9                  // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     160: aload         7
     162: invokeinterface #30,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.warnFailureToCreateUnauthIdentity:(Ljava/lang/Throwable;)V
     167: aload_0
     168: aload         4
     170: ldc           #31                 // String module
     172: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     177: checkcast     #17                 // class java/lang/String
     180: putfield      #32                 // Field jbossModuleName:Ljava/lang/String;
     183: return
    Exception table:
       from    to  target type
         132   152   155   Class java/lang/Exception

  public boolean login() throws javax.security.auth.login.LoginException;
    Code:
       0: getstatic     #9                  // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: invokeinterface #33,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginLogin:()V
       8: aload_0
       9: iconst_0
      10: putfield      #34                 // Field loginOk:Z
      13: aload_0
      14: getfield      #20                 // Field useFirstPass:Z
      17: iconst_1
      18: if_icmpne     73
      21: aload_0
      22: getfield      #7                  // Field sharedState:Ljava/util/Map;
      25: ldc           #35                 // String javax.security.auth.login.name
      27: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      32: astore_1
      33: aload_0
      34: getfield      #7                  // Field sharedState:Ljava/util/Map;
      37: ldc           #36                 // String javax.security.auth.login.password
      39: invokeinterface #16,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      44: astore_2
      45: aload_1
      46: ifnull        60
      49: aload_2
      50: ifnull        60
      53: aload_0
      54: iconst_1
      55: putfield      #34                 // Field loginOk:Z
      58: iconst_1
      59: ireturn
      60: goto          73
      63: astore_1
      64: getstatic     #9                  // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      67: aload_1
      68: invokeinterface #37,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailedLogin:(Ljava/lang/Throwable;)V
      73: iconst_0
      74: ireturn
    Exception table:
       from    to  target type
          21    59    63   Class java/lang/Exception

  public boolean commit() throws javax.security.auth.login.LoginException;
    Code:
       0: getstatic     #9                  // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: aload_0
       4: getfield      #34                 // Field loginOk:Z
       7: invokeinterface #38,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginCommit:(Z)V
      12: aload_0
      13: getfield      #34                 // Field loginOk:Z
      16: ifne          21
      19: iconst_0
      20: ireturn
      21: aload_0
      22: getfield      #5                  // Field subject:Ljavax/security/auth/Subject;
      25: invokevirtual #39                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      28: astore_1
      29: aload_0
      30: invokevirtual #40                 // Method getIdentity:()Ljava/security/Principal;
      33: astore_2
      34: aload_1
      35: aload_2
      36: invokeinterface #41,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      41: pop
      42: aload_0
      43: invokevirtual #42                 // Method getRoleSets:()[Ljava/security/acl/Group;
      46: astore_3
      47: iconst_0
      48: istore        4
      50: iload         4
      52: aload_3
      53: arraylength
      54: if_icmpge     164
      57: aload_3
      58: iload         4
      60: aaload
      61: astore        5
      63: aload         5
      65: invokeinterface #43,  1           // InterfaceMethod java/security/acl/Group.getName:()Ljava/lang/String;
      70: astore        6
      72: aload_0
      73: aload         6
      75: aload_1
      76: invokevirtual #44                 // Method createGroup:(Ljava/lang/String;Ljava/util/Set;)Ljava/security/acl/Group;
      79: astore        7
      81: aload         7
      83: instanceof    #45                 // class org/jboss/security/NestableGroup
      86: ifeq          114
      89: new           #46                 // class org/jboss/security/SimpleGroup
      92: dup
      93: ldc           #47                 // String Roles
      95: invokespecial #48                 // Method org/jboss/security/SimpleGroup."<init>":(Ljava/lang/String;)V
      98: astore        8
     100: aload         7
     102: aload         8
     104: invokeinterface #49,  2           // InterfaceMethod java/security/acl/Group.addMember:(Ljava/security/Principal;)Z
     109: pop
     110: aload         8
     112: astore        7
     114: aload         5
     116: invokeinterface #50,  1           // InterfaceMethod java/security/acl/Group.members:()Ljava/util/Enumeration;
     121: astore        8
     123: aload         8
     125: invokeinterface #51,  1           // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
     130: ifeq          158
     133: aload         8
     135: invokeinterface #52,  1           // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
     140: checkcast     #53                 // class java/security/Principal
     143: astore        9
     145: aload         7
     147: aload         9
     149: invokeinterface #49,  2           // InterfaceMethod java/security/acl/Group.addMember:(Ljava/security/Principal;)Z
     154: pop
     155: goto          123
     158: iinc          4, 1
     161: goto          50
     164: aload_0
     165: aload_1
     166: invokevirtual #54                 // Method getCallerPrincipalGroup:(Ljava/util/Set;)Ljava/security/acl/Group;
     169: astore        4
     171: aload         4
     173: ifnonnull     205
     176: new           #46                 // class org/jboss/security/SimpleGroup
     179: dup
     180: ldc           #56                 // String CallerPrincipal
     182: invokespecial #48                 // Method org/jboss/security/SimpleGroup."<init>":(Ljava/lang/String;)V
     185: astore        4
     187: aload         4
     189: aload_2
     190: invokeinterface #49,  2           // InterfaceMethod java/security/acl/Group.addMember:(Ljava/security/Principal;)Z
     195: pop
     196: aload_1
     197: aload         4
     199: invokeinterface #41,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     204: pop
     205: iconst_1
     206: ireturn

  public boolean abort() throws javax.security.auth.login.LoginException;
    Code:
       0: getstatic     #9                  // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: aload_0
       4: getfield      #34                 // Field loginOk:Z
       7: invokeinterface #57,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginAbort:(Z)V
      12: aload_0
      13: getfield      #34                 // Field loginOk:Z
      16: ireturn

  public boolean logout() throws javax.security.auth.login.LoginException;
    Code:
       0: getstatic     #9                  // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: invokeinterface #58,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginLogout:()V
       8: aload_0
       9: invokevirtual #40                 // Method getIdentity:()Ljava/security/Principal;
      12: astore_1
      13: aload_0
      14: getfield      #5                  // Field subject:Ljavax/security/auth/Subject;
      17: invokevirtual #39                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      20: astore_2
      21: aload_2
      22: aload_1
      23: invokeinterface #59,  2           // InterfaceMethod java/util/Set.remove:(Ljava/lang/Object;)Z
      28: pop
      29: aload_0
      30: aload_2
      31: invokevirtual #54                 // Method getCallerPrincipalGroup:(Ljava/util/Set;)Ljava/security/acl/Group;
      34: astore_3
      35: aload_3
      36: ifnull        47
      39: aload_2
      40: aload_3
      41: invokeinterface #59,  2           // InterfaceMethod java/util/Set.remove:(Ljava/lang/Object;)Z
      46: pop
      47: iconst_1
      48: ireturn

  protected abstract java.security.Principal getIdentity();

  protected abstract java.security.acl.Group[] getRoleSets() throws javax.security.auth.login.LoginException;

  protected boolean getUseFirstPass();
    Code:
       0: aload_0
       1: getfield      #20                 // Field useFirstPass:Z
       4: ireturn

  protected java.security.Principal getUnauthenticatedIdentity();
    Code:
       0: aload_0
       1: getfield      #27                 // Field unauthenticatedIdentity:Ljava/security/Principal;
       4: areturn

  protected java.security.acl.Group createGroup(java.lang.String, java.util.Set<java.security.Principal>);
    Code:
       0: aconst_null
       1: astore_3
       2: aload_2
       3: invokeinterface #60,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
       8: astore        4
      10: aload         4
      12: invokeinterface #61,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      17: ifeq          70
      20: aload         4
      22: invokeinterface #62,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      27: astore        5
      29: aload         5
      31: instanceof    #63                 // class java/security/acl/Group
      34: ifne          40
      37: goto          10
      40: aload         5
      42: checkcast     #63                 // class java/security/acl/Group
      45: astore        6
      47: aload         6
      49: invokeinterface #43,  1           // InterfaceMethod java/security/acl/Group.getName:()Ljava/lang/String;
      54: aload_1
      55: invokevirtual #64                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      58: ifeq          67
      61: aload         6
      63: astore_3
      64: goto          70
      67: goto          10
      70: aload_3
      71: ifnonnull     91
      74: new           #46                 // class org/jboss/security/SimpleGroup
      77: dup
      78: aload_1
      79: invokespecial #48                 // Method org/jboss/security/SimpleGroup."<init>":(Ljava/lang/String;)V
      82: astore_3
      83: aload_2
      84: aload_3
      85: invokeinterface #41,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      90: pop
      91: aload_3
      92: areturn

  protected java.security.Principal createIdentity(java.lang.String) throws java.lang.Exception;
    Code:
       0: aconst_null
       1: astore_2
       2: aload_0
       3: getfield      #22                 // Field principalClassName:Ljava/lang/String;
       6: ifnonnull     21
       9: new           #65                 // class org/jboss/security/SimplePrincipal
      12: dup
      13: aload_1
      14: invokespecial #66                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
      17: astore_2
      18: goto          73
      21: aload_0
      22: getfield      #22                 // Field principalClassName:Ljava/lang/String;
      25: aload_0
      26: getfield      #24                 // Field principalClassModuleName:Ljava/lang/String;
      29: invokestatic  #67                 // Method org/jboss/security/auth/spi/SecurityActions.loadClass:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Class;
      32: astore_3
      33: iconst_1
      34: anewarray     #68                 // class java/lang/Class
      37: dup
      38: iconst_0
      39: ldc           #17                 // class java/lang/String
      41: aastore
      42: astore        4
      44: aload_3
      45: aload         4
      47: invokevirtual #69                 // Method java/lang/Class.getConstructor:([Ljava/lang/Class;)Ljava/lang/reflect/Constructor;
      50: astore        5
      52: iconst_1
      53: anewarray     #70                 // class java/lang/Object
      56: dup
      57: iconst_0
      58: aload_1
      59: aastore
      60: astore        6
      62: aload         5
      64: aload         6
      66: invokevirtual #71                 // Method java/lang/reflect/Constructor.newInstance:([Ljava/lang/Object;)Ljava/lang/Object;
      69: checkcast     #53                 // class java/security/Principal
      72: astore_2
      73: aload_2
      74: areturn

  protected java.security.acl.Group getCallerPrincipalGroup(java.util.Set<java.security.Principal>);
    Code:
       0: aconst_null
       1: astore_2
       2: aload_1
       3: invokeinterface #60,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
       8: astore_3
       9: aload_3
      10: invokeinterface #61,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      15: ifeq          73
      18: aload_3
      19: invokeinterface #62,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      24: checkcast     #53                 // class java/security/Principal
      27: astore        4
      29: aload         4
      31: instanceof    #63                 // class java/security/acl/Group
      34: ifeq          70
      37: ldc           #63                 // class java/security/acl/Group
      39: aload         4
      41: invokevirtual #72                 // Method java/lang/Class.cast:(Ljava/lang/Object;)Ljava/lang/Object;
      44: checkcast     #63                 // class java/security/acl/Group
      47: astore        5
      49: aload         5
      51: invokeinterface #43,  1           // InterfaceMethod java/security/acl/Group.getName:()Ljava/lang/String;
      56: ldc           #56                 // String CallerPrincipal
      58: invokevirtual #64                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      61: ifeq          70
      64: aload         5
      66: astore_2
      67: goto          73
      70: goto          9
      73: aload_2
      74: areturn

  protected void addValidOptions(java.lang.String[]);
    Code:
       0: aload_0
       1: getfield      #11                 // Field validOptions:Ljava/util/HashSet;
       4: ifnonnull     20
       7: aload_0
       8: new           #73                 // class java/util/HashSet
      11: dup
      12: aload_1
      13: arraylength
      14: invokespecial #74                 // Method java/util/HashSet."<init>":(I)V
      17: putfield      #11                 // Field validOptions:Ljava/util/HashSet;
      20: aload_0
      21: getfield      #11                 // Field validOptions:Ljava/util/HashSet;
      24: aload_1
      25: invokestatic  #75                 // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
      28: invokevirtual #76                 // Method java/util/HashSet.addAll:(Ljava/util/Collection;)Z
      31: pop
      32: return

  protected void checkOptions();
    Code:
       0: aload_0
       1: getfield      #8                  // Field options:Ljava/util/Map;
       4: invokeinterface #77,  1           // InterfaceMethod java/util/Map.keySet:()Ljava/util/Set;
       9: invokeinterface #60,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      14: astore_1
      15: aload_1
      16: invokeinterface #61,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      21: ifeq          57
      24: aload_1
      25: invokeinterface #62,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      30: astore_2
      31: aload_0
      32: getfield      #11                 // Field validOptions:Ljava/util/HashSet;
      35: aload_2
      36: invokevirtual #78                 // Method java/util/HashSet.contains:(Ljava/lang/Object;)Z
      39: ifne          54
      42: getstatic     #9                  // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      45: aload_2
      46: checkcast     #17                 // class java/lang/String
      49: invokeinterface #79,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.warnInvalidModuleOption:(Ljava/lang/String;)V
      54: goto          15
      57: return

  static {};
    Code:
       0: bipush        6
       2: anewarray     #17                 // class java/lang/String
       5: dup
       6: iconst_0
       7: ldc           #15                 // String password-stacking
       9: aastore
      10: dup
      11: iconst_1
      12: ldc           #21                 // String principalClass
      14: aastore
      15: dup
      16: iconst_2
      17: ldc           #23                 // String principalClassModule
      19: aastore
      20: dup
      21: iconst_3
      22: ldc           #25                 // String unauthenticatedIdentity
      24: aastore
      25: dup
      26: iconst_4
      27: ldc           #31                 // String module
      29: aastore
      30: dup
      31: iconst_5
      32: ldc           #80                 // String jboss.security.security_domain
      34: aastore
      35: putstatic     #12                 // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
      38: return
}
