Compiled from "EJBJACCPolicyModuleDelegate.java"
public class org.jboss.security.authorization.modules.ejb.EJBJACCPolicyModuleDelegate extends org.jboss.security.authorization.modules.AbstractJACCModuleDelegate {
  private java.lang.String ejbName;

  private java.lang.reflect.Method ejbMethod;

  private java.lang.String methodInterface;

  private java.security.CodeSource ejbCS;

  private java.lang.String roleName;

  private java.lang.Boolean roleRefCheck;

  private org.jboss.security.RunAsIdentity callerRunAs;

  public org.jboss.security.authorization.modules.ejb.EJBJACCPolicyModuleDelegate();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jboss/security/authorization/modules/AbstractJACCModuleDelegate."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #2                  // Field ejbName:Ljava/lang/String;
       9: aload_0
      10: aconst_null
      11: putfield      #3                  // Field ejbMethod:Ljava/lang/reflect/Method;
      14: aload_0
      15: aconst_null
      16: putfield      #4                  // Field methodInterface:Ljava/lang/String;
      19: aload_0
      20: aconst_null
      21: putfield      #5                  // Field ejbCS:Ljava/security/CodeSource;
      24: aload_0
      25: aconst_null
      26: putfield      #6                  // Field roleName:Ljava/lang/String;
      29: aload_0
      30: getstatic     #7                  // Field java/lang/Boolean.FALSE:Ljava/lang/Boolean;
      33: putfield      #8                  // Field roleRefCheck:Ljava/lang/Boolean;
      36: return

  public int authorize(org.jboss.security.authorization.Resource, javax.security.auth.Subject, org.jboss.security.identity.RoleGroup);
    Code:
       0: aload_1
       1: instanceof    #9                  // class org/jboss/security/authorization/resources/EJBResource
       4: ifne          21
       7: getstatic     #10                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      10: ldc           #9                  // class org/jboss/security/authorization/resources/EJBResource
      12: invokevirtual #11                 // Method java/lang/Class.getName:()Ljava/lang/String;
      15: invokeinterface #12,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidType:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      20: athrow
      21: aload_1
      22: checkcast     #9                  // class org/jboss/security/authorization/resources/EJBResource
      25: astore        4
      27: aload_1
      28: invokeinterface #13,  1           // InterfaceMethod org/jboss/security/authorization/Resource.getMap:()Ljava/util/Map;
      33: astore        5
      35: aload         5
      37: ifnonnull     51
      40: getstatic     #10                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      43: ldc           #14                 // String resourceMap
      45: invokeinterface #15,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullProperty:(Ljava/lang/String;)Ljava/lang/IllegalStateException;
      50: athrow
      51: aload_0
      52: aload         5
      54: ldc           #17                 // String policyRegistration
      56: invokeinterface #18,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      61: checkcast     #19                 // class org/jboss/security/authorization/PolicyRegistration
      64: putfield      #20                 // Field policyRegistration:Lorg/jboss/security/authorization/PolicyRegistration;
      67: aload_0
      68: aload         4
      70: invokevirtual #21                 // Method org/jboss/security/authorization/resources/EJBResource.getCodeSource:()Ljava/security/CodeSource;
      73: putfield      #5                  // Field ejbCS:Ljava/security/CodeSource;
      76: aload_0
      77: aload         4
      79: invokevirtual #22                 // Method org/jboss/security/authorization/resources/EJBResource.getEjbMethod:()Ljava/lang/reflect/Method;
      82: putfield      #3                  // Field ejbMethod:Ljava/lang/reflect/Method;
      85: aload_0
      86: aload         4
      88: invokevirtual #23                 // Method org/jboss/security/authorization/resources/EJBResource.getEjbName:()Ljava/lang/String;
      91: putfield      #2                  // Field ejbName:Ljava/lang/String;
      94: aload_0
      95: aload         4
      97: invokevirtual #24                 // Method org/jboss/security/authorization/resources/EJBResource.getEjbMethodInterface:()Ljava/lang/String;
     100: putfield      #4                  // Field methodInterface:Ljava/lang/String;
     103: aload         4
     105: invokevirtual #25                 // Method org/jboss/security/authorization/resources/EJBResource.getCallerRunAsIdentity:()Lorg/jboss/security/RunAs;
     108: astore        6
     110: aload         6
     112: instanceof    #26                 // class org/jboss/security/RunAsIdentity
     115: ifeq          132
     118: aload_0
     119: ldc           #26                 // class org/jboss/security/RunAsIdentity
     121: aload         6
     123: invokevirtual #27                 // Method java/lang/Class.cast:(Ljava/lang/Object;)Ljava/lang/Object;
     126: checkcast     #26                 // class org/jboss/security/RunAsIdentity
     129: putfield      #28                 // Field callerRunAs:Lorg/jboss/security/RunAsIdentity;
     132: aload_0
     133: aload         5
     135: ldc           #29                 // String roleName
     137: invokeinterface #18,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     142: checkcast     #30                 // class java/lang/String
     145: putfield      #6                  // Field roleName:Ljava/lang/String;
     148: aload_0
     149: aload         5
     151: ldc           #31                 // String roleRefPermissionCheck
     153: invokeinterface #18,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     158: checkcast     #32                 // class java/lang/Boolean
     161: putfield      #8                  // Field roleRefCheck:Ljava/lang/Boolean;
     164: aload_0
     165: getfield      #8                  // Field roleRefCheck:Ljava/lang/Boolean;
     168: getstatic     #33                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
     171: if_acmpne     181
     174: aload_0
     175: aload_2
     176: aload_3
     177: invokespecial #34                 // Method checkRoleRef:(Ljavax/security/auth/Subject;Lorg/jboss/security/identity/RoleGroup;)I
     180: ireturn
     181: aload_0
     182: aload_2
     183: aload_3
     184: invokespecial #35                 // Method process:(Ljavax/security/auth/Subject;Lorg/jboss/security/identity/Role;)I
     187: ireturn

  private int process(javax.security.auth.Subject, org.jboss.security.identity.Role);
    Code:
       0: new           #36                 // class javax/security/jacc/EJBMethodPermission
       3: dup
       4: aload_0
       5: getfield      #2                  // Field ejbName:Ljava/lang/String;
       8: aload_0
       9: getfield      #4                  // Field methodInterface:Ljava/lang/String;
      12: aload_0
      13: getfield      #3                  // Field ejbMethod:Ljava/lang/reflect/Method;
      16: invokespecial #37                 // Method javax/security/jacc/EJBMethodPermission."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/reflect/Method;)V
      19: astore_3
      20: aload_0
      21: aload_3
      22: aload_1
      23: aload_2
      24: invokespecial #38                 // Method checkWithPolicy:(Ljava/security/Permission;Ljavax/security/auth/Subject;Lorg/jboss/security/identity/Role;)Z
      27: istore        4
      29: iload         4
      31: ifne          70
      34: getstatic     #39                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      37: invokeinterface #40,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.isDebugEnabled:()Z
      42: ifeq          70
      45: getstatic     #39                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      48: aload_3
      49: invokevirtual #41                 // Method javax/security/jacc/EJBMethodPermission.toString:()Ljava/lang/String;
      52: aload_1
      53: aload_2
      54: ifnull        64
      57: aload_2
      58: invokevirtual #42                 // Method java/lang/Object.toString:()Ljava/lang/String;
      61: goto          65
      64: aconst_null
      65: invokeinterface #43,  4           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugJACCDeniedAccess:(Ljava/lang/String;Ljavax/security/auth/Subject;Ljava/lang/String;)V
      70: iload         4
      72: ifeq          79
      75: iconst_1
      76: goto          80
      79: iconst_m1
      80: ireturn

  private int checkRoleRef(javax.security.auth.Subject, org.jboss.security.identity.RoleGroup);
    Code:
       0: new           #45                 // class javax/security/jacc/EJBRoleRefPermission
       3: dup
       4: aload_0
       5: getfield      #2                  // Field ejbName:Ljava/lang/String;
       8: aload_0
       9: getfield      #6                  // Field roleName:Ljava/lang/String;
      12: invokespecial #46                 // Method javax/security/jacc/EJBRoleRefPermission."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      15: astore_3
      16: aload_0
      17: aload_3
      18: aload_1
      19: aload_2
      20: invokespecial #38                 // Method checkWithPolicy:(Ljava/security/Permission;Ljavax/security/auth/Subject;Lorg/jboss/security/identity/Role;)Z
      23: istore        4
      25: iload         4
      27: ifne          66
      30: getstatic     #39                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      33: invokeinterface #40,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.isDebugEnabled:()Z
      38: ifeq          66
      41: getstatic     #39                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      44: aload_3
      45: invokevirtual #47                 // Method javax/security/jacc/EJBRoleRefPermission.toString:()Ljava/lang/String;
      48: aload_1
      49: aload_2
      50: ifnull        60
      53: aload_2
      54: invokevirtual #42                 // Method java/lang/Object.toString:()Ljava/lang/String;
      57: goto          61
      60: aconst_null
      61: invokeinterface #43,  4           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugJACCDeniedAccess:(Ljava/lang/String;Ljavax/security/auth/Subject;Ljava/lang/String;)V
      66: iload         4
      68: ifeq          75
      71: iconst_1
      72: goto          76
      75: iconst_m1
      76: ireturn

  private boolean checkWithPolicy(java.security.Permission, javax.security.auth.Subject, org.jboss.security.identity.Role);
    Code:
       0: aload_0
       1: getfield      #28                 // Field callerRunAs:Lorg/jboss/security/RunAsIdentity;
       4: ifnonnull     42
       7: aload_0
       8: aload_2
       9: aload_3
      10: invokevirtual #48                 // Method getPrincipals:(Ljavax/security/auth/Subject;Lorg/jboss/security/identity/Role;)[Ljava/security/Principal;
      13: astore        4
      15: new           #49                 // class java/security/ProtectionDomain
      18: dup
      19: aload_0
      20: getfield      #5                  // Field ejbCS:Ljava/security/CodeSource;
      23: aconst_null
      24: aconst_null
      25: aload         4
      27: invokespecial #50                 // Method java/security/ProtectionDomain."<init>":(Ljava/security/CodeSource;Ljava/security/PermissionCollection;Ljava/lang/ClassLoader;[Ljava/security/Principal;)V
      30: astore        5
      32: invokestatic  #51                 // Method java/security/Policy.getPolicy:()Ljava/security/Policy;
      35: aload         5
      37: aload_1
      38: invokevirtual #52                 // Method java/security/Policy.implies:(Ljava/security/ProtectionDomain;Ljava/security/Permission;)Z
      41: ireturn
      42: aload_0
      43: getfield      #28                 // Field callerRunAs:Lorg/jboss/security/RunAsIdentity;
      46: invokevirtual #53                 // Method org/jboss/security/RunAsIdentity.getRunAsRoles:()Ljava/util/Set;
      49: astore        4
      51: new           #49                 // class java/security/ProtectionDomain
      54: dup
      55: aload_0
      56: getfield      #5                  // Field ejbCS:Ljava/security/CodeSource;
      59: aconst_null
      60: aconst_null
      61: aload         4
      63: aload         4
      65: invokeinterface #54,  1           // InterfaceMethod java/util/Set.size:()I
      70: anewarray     #55                 // class java/security/Principal
      73: invokeinterface #56,  2           // InterfaceMethod java/util/Set.toArray:([Ljava/lang/Object;)[Ljava/lang/Object;
      78: checkcast     #57                 // class "[Ljava/security/Principal;"
      81: invokespecial #50                 // Method java/security/ProtectionDomain."<init>":(Ljava/security/CodeSource;Ljava/security/PermissionCollection;Ljava/lang/ClassLoader;[Ljava/security/Principal;)V
      84: astore        5
      86: invokestatic  #51                 // Method java/security/Policy.getPolicy:()Ljava/security/Policy;
      89: aload         5
      91: aload_1
      92: invokevirtual #52                 // Method java/security/Policy.implies:(Ljava/security/ProtectionDomain;Ljava/security/Permission;)Z
      95: ireturn
}
