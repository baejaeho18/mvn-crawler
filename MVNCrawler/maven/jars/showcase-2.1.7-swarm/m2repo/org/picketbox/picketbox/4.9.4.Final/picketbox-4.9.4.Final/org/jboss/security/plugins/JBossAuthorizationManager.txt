Compiled from "JBossAuthorizationManager.java"
public class org.jboss.security.plugins.JBossAuthorizationManager implements org.jboss.security.AuthorizationManager {
  private final java.lang.String securityDomain;

  private org.jboss.security.authorization.AuthorizationContext authorizationContext;

  private final java.util.concurrent.locks.Lock lock;

  public org.jboss.security.plugins.JBossAuthorizationManager(java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #2                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #3                  // Field authorizationContext:Lorg/jboss/security/authorization/AuthorizationContext;
       9: aload_0
      10: new           #4                  // class java/util/concurrent/locks/ReentrantLock
      13: dup
      14: invokespecial #5                  // Method java/util/concurrent/locks/ReentrantLock."<init>":()V
      17: putfield      #6                  // Field lock:Ljava/util/concurrent/locks/Lock;
      20: aload_0
      21: aload_1
      22: invokestatic  #7                  // Method org/jboss/security/SecurityUtil.unprefixSecurityDomain:(Ljava/lang/String;)Ljava/lang/String;
      25: putfield      #8                  // Field securityDomain:Ljava/lang/String;
      28: return

  public int authorize(org.jboss.security.authorization.Resource) throws org.jboss.security.authorization.AuthorizationException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #9                  // Method validateResource:(Lorg/jboss/security/authorization/Resource;)V
       5: invokestatic  #10                 // Method org/jboss/security/plugins/SubjectActions.getActiveSubject:()Ljavax/security/auth/Subject;
       8: astore_2
       9: aload_0
      10: aload_1
      11: aload_2
      12: aconst_null
      13: invokespecial #11                 // Method internalAuthorization:(Lorg/jboss/security/authorization/Resource;Ljavax/security/auth/Subject;Lorg/jboss/security/identity/RoleGroup;)I
      16: ireturn

  public int authorize(org.jboss.security.authorization.Resource, javax.security.auth.Subject) throws org.jboss.security.authorization.AuthorizationException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aconst_null
       4: invokespecial #11                 // Method internalAuthorization:(Lorg/jboss/security/authorization/Resource;Ljavax/security/auth/Subject;Lorg/jboss/security/identity/RoleGroup;)I
       7: ireturn

  public int authorize(org.jboss.security.authorization.Resource, javax.security.auth.Subject, org.jboss.security.identity.RoleGroup) throws org.jboss.security.authorization.AuthorizationException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #9                  // Method validateResource:(Lorg/jboss/security/authorization/Resource;)V
       5: aload_0
       6: aload_1
       7: aload_2
       8: aload_3
       9: invokespecial #11                 // Method internalAuthorization:(Lorg/jboss/security/authorization/Resource;Ljavax/security/auth/Subject;Lorg/jboss/security/identity/RoleGroup;)I
      12: ireturn

  public int authorize(org.jboss.security.authorization.Resource, javax.security.auth.Subject, java.security.acl.Group) throws org.jboss.security.authorization.AuthorizationException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #9                  // Method validateResource:(Lorg/jboss/security/authorization/Resource;)V
       5: aload_0
       6: aload_1
       7: aload_2
       8: aload_0
       9: aload_3
      10: invokespecial #12                 // Method getRoleGroup:(Ljava/security/acl/Group;)Lorg/jboss/security/identity/RoleGroup;
      13: invokespecial #11                 // Method internalAuthorization:(Lorg/jboss/security/authorization/Resource;Ljavax/security/auth/Subject;Lorg/jboss/security/identity/RoleGroup;)I
      16: ireturn

  public boolean doesUserHaveRole(java.security.Principal, java.util.Set<java.security.Principal>);
    Code:
       0: iconst_0
       1: istore_3
       2: aload_0
       3: aload_1
       4: invokespecial #13                 // Method getCurrentRoles:(Ljava/security/Principal;)Lorg/jboss/security/identity/RoleGroup;
       7: astore        4
       9: getstatic     #14                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      12: invokeinterface #15,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.isTraceEnabled:()Z
      17: ifeq          44
      20: getstatic     #14                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      23: aload_1
      24: aload         4
      26: ifnull        37
      29: aload         4
      31: invokevirtual #16                 // Method java/lang/Object.toString:()Ljava/lang/String;
      34: goto          39
      37: ldc           #17                 // String
      39: invokeinterface #18,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginDoesUserHaveRole:(Ljava/security/Principal;Ljava/lang/String;)V
      44: aload         4
      46: ifnull        104
      49: aload_2
      50: invokeinterface #19,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      55: astore        5
      57: iload_3
      58: ifne          95
      61: aload         5
      63: invokeinterface #20,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      68: ifeq          95
      71: aload         5
      73: invokeinterface #21,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      78: checkcast     #22                 // class java/security/Principal
      81: astore        6
      83: aload_0
      84: aload         6
      86: aload         4
      88: invokevirtual #23                 // Method doesRoleGroupHaveRole:(Ljava/security/Principal;Lorg/jboss/security/identity/RoleGroup;)Z
      91: istore_3
      92: goto          57
      95: getstatic     #14                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      98: iload_3
      99: invokeinterface #24,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceEndDoesUserHaveRole:(Z)V
     104: iload_3
     105: ireturn

  public boolean doesUserHaveRole(java.security.Principal, java.security.Principal);
    Code:
       0: iconst_0
       1: istore_3
       2: aload_0
       3: aload_1
       4: invokespecial #13                 // Method getCurrentRoles:(Ljava/security/Principal;)Lorg/jboss/security/identity/RoleGroup;
       7: astore        4
       9: aload_0
      10: aload_2
      11: aload         4
      13: invokevirtual #23                 // Method doesRoleGroupHaveRole:(Ljava/security/Principal;Lorg/jboss/security/identity/RoleGroup;)Z
      16: istore_3
      17: iload_3
      18: ireturn

  public java.util.Set<java.security.Principal> getUserRoles(java.security.Principal);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #13                 // Method getCurrentRoles:(Ljava/security/Principal;)Lorg/jboss/security/identity/RoleGroup;
       5: astore_2
       6: aload_0
       7: aload_2
       8: invokespecial #25                 // Method getRolesAsSet:(Lorg/jboss/security/identity/RoleGroup;)Ljava/util/HashSet;
      11: areturn

  protected boolean doesRoleGroupHaveRole(java.security.Principal, org.jboss.security.identity.RoleGroup);
    Code:
       0: aload_1
       1: instanceof    #26                 // class org/jboss/security/NobodyPrincipal
       4: ifeq          9
       7: iconst_0
       8: ireturn
       9: aload_2
      10: new           #27                 // class org/jboss/security/identity/plugins/SimpleRole
      13: dup
      14: aload_1
      15: invokeinterface #28,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      20: invokespecial #29                 // Method org/jboss/security/identity/plugins/SimpleRole."<init>":(Ljava/lang/String;)V
      23: invokeinterface #30,  2           // InterfaceMethod org/jboss/security/identity/RoleGroup.containsRole:(Lorg/jboss/security/identity/Role;)Z
      28: istore_3
      29: iload_3
      30: ifne          38
      33: aload_1
      34: instanceof    #31                 // class org/jboss/security/AnybodyPrincipal
      37: istore_3
      38: iload_3
      39: ireturn

  public java.lang.String toString();
    Code:
       0: new           #32                 // class java/lang/StringBuffer
       3: dup
       4: invokespecial #33                 // Method java/lang/StringBuffer."<init>":()V
       7: astore_1
       8: aload_1
       9: ldc           #34                 // String [AuthorizationManager:class=
      11: invokevirtual #35                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      14: aload_0
      15: invokevirtual #36                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      18: invokevirtual #37                 // Method java/lang/Class.getName:()Ljava/lang/String;
      21: invokevirtual #35                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      24: pop
      25: aload_1
      26: ldc           #38                 // String :
      28: invokevirtual #35                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      31: aload_0
      32: getfield      #8                  // Field securityDomain:Ljava/lang/String;
      35: invokevirtual #35                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      38: ldc           #38                 // String :
      40: invokevirtual #35                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      43: pop
      44: aload_1
      45: ldc           #39                 // String ]
      47: invokevirtual #35                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      50: pop
      51: aload_1
      52: invokevirtual #40                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
      55: areturn

  public void setAuthorizationContext(org.jboss.security.authorization.AuthorizationContext);
    Code:
       0: aload_1
       1: ifnonnull     15
       4: getstatic     #41                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
       7: ldc           #42                 // String authorizationContext
       9: invokeinterface #43,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullArgument:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      14: athrow
      15: aload_1
      16: invokevirtual #44                 // Method org/jboss/security/authorization/AuthorizationContext.getSecurityDomain:()Ljava/lang/String;
      19: astore_2
      20: aload_0
      21: getfield      #8                  // Field securityDomain:Ljava/lang/String;
      24: aload_2
      25: invokevirtual #45                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      28: ifne          44
      31: getstatic     #41                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      34: aload_0
      35: getfield      #8                  // Field securityDomain:Ljava/lang/String;
      38: invokeinterface #46,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.unexpectedSecurityDomainInContext:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      43: athrow
      44: aload_0
      45: getfield      #6                  // Field lock:Ljava/util/concurrent/locks/Lock;
      48: invokeinterface #47,  1           // InterfaceMethod java/util/concurrent/locks/Lock.lock:()V
      53: aload_0
      54: aload_1
      55: putfield      #3                  // Field authorizationContext:Lorg/jboss/security/authorization/AuthorizationContext;
      58: aload_0
      59: getfield      #6                  // Field lock:Ljava/util/concurrent/locks/Lock;
      62: invokeinterface #48,  1           // InterfaceMethod java/util/concurrent/locks/Lock.unlock:()V
      67: goto          82
      70: astore_3
      71: aload_0
      72: getfield      #6                  // Field lock:Ljava/util/concurrent/locks/Lock;
      75: invokeinterface #48,  1           // InterfaceMethod java/util/concurrent/locks/Lock.unlock:()V
      80: aload_3
      81: athrow
      82: return
    Exception table:
       from    to  target type
          53    58    70   any

  public java.lang.String getSecurityDomain();
    Code:
       0: aload_0
       1: getfield      #8                  // Field securityDomain:Ljava/lang/String;
       4: areturn

  public java.security.acl.Group getTargetRoles(java.security.Principal, java.util.Map<java.lang.String, java.lang.Object>);
    Code:
       0: new           #49                 // class java/lang/UnsupportedOperationException
       3: dup
       4: invokespecial #50                 // Method java/lang/UnsupportedOperationException."<init>":()V
       7: athrow

  private java.util.HashSet<java.security.Principal> getRolesAsSet(org.jboss.security.identity.RoleGroup);
    Code:
       0: aconst_null
       1: astore_2
       2: aload_1
       3: ifnull        73
       6: new           #51                 // class java/util/HashSet
       9: dup
      10: invokespecial #52                 // Method java/util/HashSet."<init>":()V
      13: astore_2
      14: aload_1
      15: invokeinterface #53,  1           // InterfaceMethod org/jboss/security/identity/RoleGroup.getRoles:()Ljava/util/Collection;
      20: astore_3
      21: aload_3
      22: invokeinterface #54,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      27: astore        4
      29: aload         4
      31: invokeinterface #20,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      36: ifeq          73
      39: aload         4
      41: invokeinterface #21,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      46: checkcast     #55                 // class org/jboss/security/identity/Role
      49: astore        5
      51: aload_2
      52: new           #56                 // class org/jboss/security/SimplePrincipal
      55: dup
      56: aload         5
      58: invokeinterface #57,  1           // InterfaceMethod org/jboss/security/identity/Role.getRoleName:()Ljava/lang/String;
      63: invokespecial #58                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
      66: invokevirtual #59                 // Method java/util/HashSet.add:(Ljava/lang/Object;)Z
      69: pop
      70: goto          29
      73: aload_2
      74: areturn

  public org.jboss.security.identity.RoleGroup getSubjectRoles(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler);
    Code:
       0: aload_1
       1: ifnonnull     6
       4: aconst_null
       5: areturn
       6: new           #60                 // class org/jboss/security/callbacks/SecurityContextCallback
       9: dup
      10: invokespecial #61                 // Method org/jboss/security/callbacks/SecurityContextCallback."<init>":()V
      13: astore_3
      14: aload_2
      15: iconst_1
      16: anewarray     #62                 // class javax/security/auth/callback/Callback
      19: dup
      20: iconst_0
      21: aload_3
      22: aastore
      23: invokeinterface #63,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      28: goto          43
      31: astore        4
      33: new           #65                 // class java/lang/RuntimeException
      36: dup
      37: aload         4
      39: invokespecial #66                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
      42: athrow
      43: aload_3
      44: invokevirtual #67                 // Method org/jboss/security/callbacks/SecurityContextCallback.getSecurityContext:()Lorg/jboss/security/SecurityContext;
      47: astore        4
      49: aconst_null
      50: astore        5
      52: aload         4
      54: invokeinterface #68,  1           // InterfaceMethod org/jboss/security/SecurityContext.getIncomingRunAs:()Lorg/jboss/security/RunAs;
      59: astore        6
      61: aload         6
      63: ifnull        82
      66: new           #56                 // class org/jboss/security/SimplePrincipal
      69: dup
      70: aload         6
      72: invokeinterface #69,  1           // InterfaceMethod org/jboss/security/RunAs.getName:()Ljava/lang/String;
      77: invokespecial #58                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
      80: astore        5
      82: aload_0
      83: aload         5
      85: aload_1
      86: aload         4
      88: invokespecial #70                 // Method getCurrentRoles:(Ljava/security/Principal;Ljavax/security/auth/Subject;Lorg/jboss/security/SecurityContext;)Lorg/jboss/security/identity/RoleGroup;
      91: astore        7
      93: aload         7
      95: ifnonnull     109
      98: new           #71                 // class org/jboss/security/identity/plugins/SimpleRoleGroup
     101: dup
     102: ldc           #72                 // String Roles
     104: invokespecial #73                 // Method org/jboss/security/identity/plugins/SimpleRoleGroup."<init>":(Ljava/lang/String;)V
     107: astore        7
     109: aload         7
     111: areturn
    Exception table:
       from    to  target type
          14    28    31   Class java/lang/Exception

  private org.jboss.security.identity.RoleGroup getCurrentRoles(java.security.Principal);
    Code:
       0: invokestatic  #10                 // Method org/jboss/security/plugins/SubjectActions.getActiveSubject:()Ljavax/security/auth/Subject;
       3: astore_2
       4: invokestatic  #74                 // Method org/jboss/security/plugins/SubjectActions.getSecurityContext:()Lorg/jboss/security/SecurityContext;
       7: astore_3
       8: aload_3
       9: ifnonnull     28
      12: new           #75                 // class org/jboss/security/plugins/JBossSecurityContext
      15: dup
      16: aload_0
      17: getfield      #8                  // Field securityDomain:Ljava/lang/String;
      20: invokespecial #76                 // Method org/jboss/security/plugins/JBossSecurityContext."<init>":(Ljava/lang/String;)V
      23: astore_3
      24: aload_3
      25: invokestatic  #77                 // Method org/jboss/security/plugins/SubjectActions.setSecurityContext:(Lorg/jboss/security/SecurityContext;)V
      28: aload_0
      29: aload_1
      30: aload_2
      31: aload_3
      32: invokespecial #70                 // Method getCurrentRoles:(Ljava/security/Principal;Ljavax/security/auth/Subject;Lorg/jboss/security/SecurityContext;)Lorg/jboss/security/identity/RoleGroup;
      35: areturn

  private org.jboss.security.identity.RoleGroup getCurrentRoles(java.security.Principal, javax.security.auth.Subject, org.jboss.security.SecurityContext);
    Code:
       0: aload_2
       1: ifnonnull     15
       4: getstatic     #41                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
       7: ldc           #78                 // String subject
       9: invokeinterface #43,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullArgument:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      14: athrow
      15: aload_3
      16: ifnonnull     30
      19: getstatic     #41                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      22: ldc           #79                 // String securityContext
      24: invokeinterface #43,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullArgument:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      29: athrow
      30: aload_0
      31: aload_2
      32: invokespecial #80                 // Method getGroupFromSubject:(Ljavax/security/auth/Subject;)Ljava/security/acl/Group;
      35: astore        4
      37: iconst_0
      38: istore        5
      40: aload_3
      41: invokeinterface #81,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
      46: invokevirtual #82                 // Method org/jboss/security/SecurityContextUtil.getRoles:()Lorg/jboss/security/identity/RoleGroup;
      49: astore        6
      51: aload         6
      53: ifnull        67
      56: ldc           #83                 // String true
      58: invokestatic  #84                 // Method org/jboss/security/plugins/SubjectActions.getRefreshSecurityContextRoles:()Ljava/lang/String;
      61: invokevirtual #85                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
      64: ifeq          70
      67: iconst_1
      68: istore        5
      70: aload_0
      71: aload         6
      73: aload         4
      75: invokespecial #86                 // Method copyGroups:(Lorg/jboss/security/identity/RoleGroup;Ljava/security/acl/Group;)Lorg/jboss/security/identity/RoleGroup;
      78: astore        6
      80: aload         4
      82: aload         6
      84: if_acmpne     92
      87: iload         5
      89: ifeq          302
      92: aload_3
      93: invokeinterface #87,  1           // InterfaceMethod org/jboss/security/SecurityContext.getMappingManager:()Lorg/jboss/security/mapping/MappingManager;
      98: astore        7
     100: aload         7
     102: getstatic     #88                 // Field org/jboss/security/mapping/MappingType.ROLE:Lorg/jboss/security/mapping/MappingType;
     105: invokevirtual #89                 // Method org/jboss/security/mapping/MappingType.name:()Ljava/lang/String;
     108: invokeinterface #90,  2           // InterfaceMethod org/jboss/security/mapping/MappingManager.getMappingContext:(Ljava/lang/String;)Lorg/jboss/security/mapping/MappingContext;
     113: astore        8
     115: aload         6
     117: astore        9
     119: aload         8
     121: ifnull        286
     124: aload         8
     126: invokevirtual #91                 // Method org/jboss/security/mapping/MappingContext.hasModules:()Z
     129: ifeq          286
     132: new           #92                 // class java/util/HashMap
     135: dup
     136: invokespecial #93                 // Method java/util/HashMap."<init>":()V
     139: astore        10
     141: aload         10
     143: ldc           #72                 // String Roles
     145: aload         6
     147: invokeinterface #94,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     152: pop
     153: aload_1
     154: ifnull        168
     157: aload         10
     159: ldc           #95                 // String Principal
     161: aload_1
     162: invokeinterface #94,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     167: pop
     168: aload         10
     170: ldc           #96                 // String deploymentPrincipalRolesMap
     172: invokestatic  #97                 // Method org/jboss/security/SecurityRolesAssociation.getSecurityRoles:()Ljava/util/Map;
     175: invokeinterface #94,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     180: pop
     181: aload         10
     183: ldc           #98                 // String PrincipalsSet
     185: aload_2
     186: invokevirtual #99                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     189: invokeinterface #94,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     194: pop
     195: getstatic     #14                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     198: invokeinterface #15,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.isTraceEnabled:()Z
     203: ifeq          229
     206: getstatic     #14                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     209: aload         6
     211: ifnull        222
     214: aload         6
     216: invokevirtual #16                 // Method java/lang/Object.toString:()Ljava/lang/String;
     219: goto          224
     222: ldc           #17                 // String
     224: invokeinterface #100,  2          // InterfaceMethod org/jboss/security/PicketBoxLogger.traceRolesBeforeMapping:(Ljava/lang/String;)V
     229: aload         6
     231: ifnonnull     240
     234: aload_0
     235: invokespecial #101                // Method getEmptyRoleGroup:()Lorg/jboss/security/identity/RoleGroup;
     238: astore        6
     240: aload         8
     242: aload         10
     244: aload         6
     246: invokevirtual #102                // Method org/jboss/security/mapping/MappingContext.performMapping:(Ljava/util/Map;Ljava/lang/Object;)V
     249: aload         8
     251: invokevirtual #103                // Method org/jboss/security/mapping/MappingContext.getMappingResult:()Lorg/jboss/security/mapping/MappingResult;
     254: invokevirtual #104                // Method org/jboss/security/mapping/MappingResult.getMappedObject:()Ljava/lang/Object;
     257: checkcast     #105                // class org/jboss/security/identity/RoleGroup
     260: astore        9
     262: getstatic     #14                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     265: invokeinterface #15,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.isTraceEnabled:()Z
     270: ifeq          286
     273: getstatic     #14                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     276: aload         6
     278: invokevirtual #16                 // Method java/lang/Object.toString:()Ljava/lang/String;
     281: invokeinterface #106,  2          // InterfaceMethod org/jboss/security/PicketBoxLogger.traceRolesAfterMapping:(Ljava/lang/String;)V
     286: aload_3
     287: invokeinterface #107,  1          // InterfaceMethod org/jboss/security/SecurityContext.getData:()Ljava/util/Map;
     292: ldc           #72                 // String Roles
     294: aload         9
     296: invokeinterface #94,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     301: pop
     302: aload_3
     303: invokeinterface #81,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
     308: invokevirtual #82                 // Method org/jboss/security/SecurityContextUtil.getRoles:()Lorg/jboss/security/identity/RoleGroup;
     311: ifnonnull     325
     314: aload_3
     315: invokeinterface #81,  1           // InterfaceMethod org/jboss/security/SecurityContext.getUtil:()Lorg/jboss/security/SecurityContextUtil;
     320: aload         6
     322: invokevirtual #108                // Method org/jboss/security/SecurityContextUtil.setRoles:(Lorg/jboss/security/identity/RoleGroup;)V
     325: aload         6
     327: areturn

  private org.jboss.security.identity.RoleGroup copyGroups(org.jboss.security.identity.RoleGroup, java.security.acl.Group);
    Code:
       0: aload_2
       1: ifnonnull     6
       4: aload_1
       5: areturn
       6: aload_1
       7: ifnonnull     19
      10: aload_2
      11: ifnull        19
      14: aload_0
      15: invokespecial #101                // Method getEmptyRoleGroup:()Lorg/jboss/security/identity/RoleGroup;
      18: astore_1
      19: aload_2
      20: invokeinterface #109,  1          // InterfaceMethod java/security/acl/Group.members:()Ljava/util/Enumeration;
      25: astore_3
      26: aload_3
      27: invokeinterface #110,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      32: ifeq          65
      35: aload_1
      36: new           #27                 // class org/jboss/security/identity/plugins/SimpleRole
      39: dup
      40: aload_3
      41: invokeinterface #111,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      46: checkcast     #22                 // class java/security/Principal
      49: invokeinterface #28,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      54: invokespecial #29                 // Method org/jboss/security/identity/plugins/SimpleRole."<init>":(Ljava/lang/String;)V
      57: invokeinterface #112,  2          // InterfaceMethod org/jboss/security/identity/RoleGroup.addRole:(Lorg/jboss/security/identity/Role;)V
      62: goto          26
      65: aload_1
      66: areturn

  private int internalAuthorization(org.jboss.security.authorization.Resource, javax.security.auth.Subject, org.jboss.security.identity.RoleGroup) throws org.jboss.security.authorization.AuthorizationException;
    Code:
       0: aload_0
       1: getfield      #3                  // Field authorizationContext:Lorg/jboss/security/authorization/AuthorizationContext;
       4: ifnonnull     22
       7: aload_0
       8: new           #113                // class org/jboss/security/plugins/authorization/JBossAuthorizationContext
      11: dup
      12: aload_0
      13: getfield      #8                  // Field securityDomain:Ljava/lang/String;
      16: invokespecial #114                // Method org/jboss/security/plugins/authorization/JBossAuthorizationContext."<init>":(Ljava/lang/String;)V
      19: invokevirtual #115                // Method setAuthorizationContext:(Lorg/jboss/security/authorization/AuthorizationContext;)V
      22: aload_0
      23: getfield      #3                  // Field authorizationContext:Lorg/jboss/security/authorization/AuthorizationContext;
      26: aload_1
      27: aload_2
      28: aload_3
      29: invokevirtual #116                // Method org/jboss/security/authorization/AuthorizationContext.authorize:(Lorg/jboss/security/authorization/Resource;Ljavax/security/auth/Subject;Lorg/jboss/security/identity/RoleGroup;)I
      32: ireturn

  private java.security.acl.Group getGroupFromSubject(javax.security.auth.Subject);
    Code:
       0: aload_1
       1: ifnonnull     15
       4: getstatic     #41                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
       7: ldc           #117                // String theSubject
       9: invokeinterface #43,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullArgument:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      14: athrow
      15: aload_1
      16: ldc           #118                // class java/security/acl/Group
      18: invokevirtual #119                // Method javax/security/auth/Subject.getPrincipals:(Ljava/lang/Class;)Ljava/util/Set;
      21: astore_2
      22: aload_2
      23: invokeinterface #19,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      28: astore_3
      29: aconst_null
      30: astore        4
      32: aload_3
      33: invokeinterface #20,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      38: ifeq          78
      41: aload_3
      42: invokeinterface #21,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      47: checkcast     #118                // class java/security/acl/Group
      50: astore        5
      52: aload         5
      54: invokeinterface #120,  1          // InterfaceMethod java/security/acl/Group.getName:()Ljava/lang/String;
      59: astore        6
      61: aload         6
      63: ldc           #72                 // String Roles
      65: invokevirtual #45                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      68: ifeq          75
      71: aload         5
      73: astore        4
      75: goto          32
      78: aload         4
      80: areturn

  private org.jboss.security.identity.RoleGroup getRoleGroup(java.security.acl.Group);
    Code:
       0: aload_1
       1: ifnonnull     15
       4: getstatic     #41                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
       7: ldc           #121                // String roleGroup
       9: invokeinterface #43,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullArgument:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      14: athrow
      15: new           #71                 // class org/jboss/security/identity/plugins/SimpleRoleGroup
      18: dup
      19: aload_1
      20: invokeinterface #120,  1          // InterfaceMethod java/security/acl/Group.getName:()Ljava/lang/String;
      25: invokespecial #73                 // Method org/jboss/security/identity/plugins/SimpleRoleGroup."<init>":(Ljava/lang/String;)V
      28: astore_2
      29: aload_1
      30: invokeinterface #109,  1          // InterfaceMethod java/security/acl/Group.members:()Ljava/util/Enumeration;
      35: astore_3
      36: aload_3
      37: invokeinterface #110,  1          // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      42: ifeq          73
      45: aload_2
      46: new           #27                 // class org/jboss/security/identity/plugins/SimpleRole
      49: dup
      50: aload_3
      51: invokeinterface #111,  1          // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      56: checkcast     #22                 // class java/security/Principal
      59: invokeinterface #28,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      64: invokespecial #29                 // Method org/jboss/security/identity/plugins/SimpleRole."<init>":(Ljava/lang/String;)V
      67: invokevirtual #122                // Method org/jboss/security/identity/plugins/SimpleRoleGroup.addRole:(Lorg/jboss/security/identity/Role;)V
      70: goto          36
      73: aload_2
      74: areturn

  private void validateResource(org.jboss.security.authorization.Resource);
    Code:
       0: aload_1
       1: ifnonnull     15
       4: getstatic     #41                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
       7: ldc           #123                // String resource
       9: invokeinterface #43,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullArgument:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      14: athrow
      15: aload_1
      16: invokeinterface #124,  1          // InterfaceMethod org/jboss/security/authorization/Resource.getMap:()Ljava/util/Map;
      21: ifnonnull     35
      24: getstatic     #41                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      27: ldc           #125                // String resource.contextMap
      29: invokeinterface #43,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullArgument:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      34: athrow
      35: return

  private org.jboss.security.identity.RoleGroup getEmptyRoleGroup();
    Code:
       0: new           #71                 // class org/jboss/security/identity/plugins/SimpleRoleGroup
       3: dup
       4: ldc           #72                 // String Roles
       6: invokespecial #73                 // Method org/jboss/security/identity/plugins/SimpleRoleGroup."<init>":(Ljava/lang/String;)V
       9: areturn
}
