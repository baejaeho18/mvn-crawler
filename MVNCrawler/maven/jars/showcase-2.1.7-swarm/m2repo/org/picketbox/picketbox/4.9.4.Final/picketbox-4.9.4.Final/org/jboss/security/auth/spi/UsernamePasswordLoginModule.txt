Compiled from "UsernamePasswordLoginModule.java"
public abstract class org.jboss.security.auth.spi.UsernamePasswordLoginModule extends org.jboss.security.auth.spi.AbstractServerLoginModule {
  private static final java.lang.String HASH_ALGORITHM;

  private static final java.lang.String HASH_ENCODING;

  private static final java.lang.String HASH_CHARSET;

  private static final java.lang.String HASH_STORE_PASSWORD;

  private static final java.lang.String HASH_USER_PASSWORD;

  private static final java.lang.String DIGEST_CALLBACK;

  private static final java.lang.String STORE_DIGEST_CALLBACK;

  private static final java.lang.String IGNORE_PASSWORD_CASE;

  private static final java.lang.String LEGACY_CREATE_PASSWORD_HASH;

  private static final java.lang.String THROW_VALIDATE_ERROR;

  private static final java.lang.String INPUT_VALIDATOR;

  private static final java.lang.String PASS_IS_A1_HASH;

  private static final java.lang.String[] ALL_VALID_OPTIONS;

  private java.security.Principal identity;

  private char[] credential;

  private java.lang.String hashAlgorithm;

  private java.lang.String hashCharset;

  private java.lang.String hashEncoding;

  private boolean ignorePasswordCase;

  private boolean hashStorePassword;

  private boolean hashUserPassword;

  private boolean legacyCreatePasswordHash;

  private boolean throwValidateError;

  private java.lang.Throwable validateError;

  private org.jboss.security.auth.spi.InputValidator inputValidator;

  public org.jboss.security.auth.spi.UsernamePasswordLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jboss/security/auth/spi/AbstractServerLoginModule."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #2                  // Field hashAlgorithm:Ljava/lang/String;
       9: aload_0
      10: aconst_null
      11: putfield      #3                  // Field hashCharset:Ljava/lang/String;
      14: aload_0
      15: aconst_null
      16: putfield      #4                  // Field hashEncoding:Ljava/lang/String;
      19: aload_0
      20: iconst_1
      21: putfield      #5                  // Field hashUserPassword:Z
      24: aload_0
      25: iconst_0
      26: putfield      #6                  // Field throwValidateError:Z
      29: aload_0
      30: aconst_null
      31: putfield      #7                  // Field inputValidator:Lorg/jboss/security/auth/spi/InputValidator;
      34: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map<java.lang.String, ?>, java.util.Map<java.lang.String, ?>);
    Code:
       0: aload_0
       1: getstatic     #8                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
       4: invokevirtual #9                  // Method addValidOptions:([Ljava/lang/String;)V
       7: aload_0
       8: aload_1
       9: aload_2
      10: aload_3
      11: aload         4
      13: invokespecial #10                 // Method org/jboss/security/auth/spi/AbstractServerLoginModule.initialize:(Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;Ljava/util/Map;Ljava/util/Map;)V
      16: aload_0
      17: aload         4
      19: ldc           #12                 // String hashAlgorithm
      21: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      26: checkcast     #14                 // class java/lang/String
      29: putfield      #2                  // Field hashAlgorithm:Ljava/lang/String;
      32: aload_0
      33: getfield      #2                  // Field hashAlgorithm:Ljava/lang/String;
      36: ifnull        128
      39: aload_0
      40: aload         4
      42: ldc           #15                 // String hashEncoding
      44: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      49: checkcast     #14                 // class java/lang/String
      52: putfield      #4                  // Field hashEncoding:Ljava/lang/String;
      55: aload_0
      56: getfield      #4                  // Field hashEncoding:Ljava/lang/String;
      59: ifnonnull     68
      62: aload_0
      63: ldc           #17                 // String BASE64
      65: putfield      #4                  // Field hashEncoding:Ljava/lang/String;
      68: aload_0
      69: aload         4
      71: ldc           #18                 // String hashCharset
      73: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      78: checkcast     #14                 // class java/lang/String
      81: putfield      #3                  // Field hashCharset:Ljava/lang/String;
      84: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      87: aload_0
      88: getfield      #2                  // Field hashAlgorithm:Ljava/lang/String;
      91: aload_0
      92: getfield      #4                  // Field hashEncoding:Ljava/lang/String;
      95: aload_0
      96: getfield      #3                  // Field hashCharset:Ljava/lang/String;
      99: aload         4
     101: ldc           #20                 // String digestCallback
     103: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     108: checkcast     #14                 // class java/lang/String
     111: aload         4
     113: ldc           #21                 // String storeDigestCallback
     115: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     120: checkcast     #14                 // class java/lang/String
     123: invokeinterface #22,  6           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugPasswordHashing:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     128: aload         4
     130: ldc           #23                 // String ignorePasswordCase
     132: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     137: checkcast     #14                 // class java/lang/String
     140: astore        5
     142: aload_0
     143: aload         5
     145: invokestatic  #24                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     148: invokevirtual #25                 // Method java/lang/Boolean.booleanValue:()Z
     151: putfield      #26                 // Field ignorePasswordCase:Z
     154: aload         4
     156: ldc           #27                 // String hashStorePassword
     158: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     163: checkcast     #14                 // class java/lang/String
     166: astore        5
     168: aload_0
     169: aload         5
     171: invokestatic  #24                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     174: invokevirtual #25                 // Method java/lang/Boolean.booleanValue:()Z
     177: putfield      #28                 // Field hashStorePassword:Z
     180: aload         4
     182: ldc           #29                 // String hashUserPassword
     184: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     189: checkcast     #14                 // class java/lang/String
     192: astore        5
     194: aload         5
     196: ifnull        211
     199: aload_0
     200: aload         5
     202: invokestatic  #24                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     205: invokevirtual #25                 // Method java/lang/Boolean.booleanValue:()Z
     208: putfield      #5                  // Field hashUserPassword:Z
     211: aload         4
     213: ldc           #30                 // String legacyCreatePasswordHash
     215: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     220: checkcast     #14                 // class java/lang/String
     223: astore        5
     225: aload         5
     227: ifnull        242
     230: aload_0
     231: aload         5
     233: invokestatic  #24                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     236: invokevirtual #25                 // Method java/lang/Boolean.booleanValue:()Z
     239: putfield      #31                 // Field legacyCreatePasswordHash:Z
     242: aload         4
     244: ldc           #32                 // String throwValidateError
     246: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     251: checkcast     #14                 // class java/lang/String
     254: astore        5
     256: aload         5
     258: ifnull        273
     261: aload_0
     262: aload         5
     264: invokestatic  #24                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     267: invokevirtual #25                 // Method java/lang/Boolean.booleanValue:()Z
     270: putfield      #6                  // Field throwValidateError:Z
     273: aload         4
     275: ldc           #33                 // String inputValidator
     277: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     282: checkcast     #14                 // class java/lang/String
     285: astore        5
     287: aload         5
     289: ifnull        332
     292: aload         5
     294: aload_0
     295: getfield      #34                 // Field jbossModuleName:Ljava/lang/String;
     298: invokestatic  #35                 // Method org/jboss/security/auth/spi/SecurityActions.loadClass:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Class;
     301: astore        6
     303: aload_0
     304: aload         6
     306: invokevirtual #36                 // Method java/lang/Class.newInstance:()Ljava/lang/Object;
     309: checkcast     #37                 // class org/jboss/security/auth/spi/InputValidator
     312: putfield      #7                  // Field inputValidator:Lorg/jboss/security/auth/spi/InputValidator;
     315: goto          332
     318: astore        6
     320: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     323: aload         5
     325: aload         6
     327: invokeinterface #39,  3           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailureToInstantiateClass:(Ljava/lang/String;Ljava/lang/Throwable;)V
     332: return
    Exception table:
       from    to  target type
         292   315   318   Class java/lang/Exception

  public boolean login() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: invokespecial #40                 // Method org/jboss/security/auth/spi/AbstractServerLoginModule.login:()Z
       4: iconst_1
       5: if_icmpne     132
       8: aload_0
       9: getfield      #41                 // Field sharedState:Ljava/util/Map;
      12: ldc           #42                 // String javax.security.auth.login.name
      14: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      19: astore_1
      20: aload_1
      21: instanceof    #43                 // class java/security/Principal
      24: ifeq          38
      27: aload_0
      28: aload_1
      29: checkcast     #43                 // class java/security/Principal
      32: putfield      #44                 // Field identity:Ljava/security/Principal;
      35: goto          80
      38: aload_1
      39: invokevirtual #45                 // Method java/lang/Object.toString:()Ljava/lang/String;
      42: astore_2
      43: aload_0
      44: aload_0
      45: aload_2
      46: invokevirtual #46                 // Method createIdentity:(Ljava/lang/String;)Ljava/security/Principal;
      49: putfield      #44                 // Field identity:Ljava/security/Principal;
      52: goto          80
      55: astore_3
      56: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      59: aload_3
      60: invokevirtual #48                 // Method java/lang/Exception.getLocalizedMessage:()Ljava/lang/String;
      63: invokeinterface #49,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.failedToCreatePrincipal:(Ljava/lang/String;)Ljavax/security/auth/login/LoginException;
      68: astore        4
      70: aload         4
      72: aload_3
      73: invokevirtual #50                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
      76: pop
      77: aload         4
      79: athrow
      80: aload_0
      81: getfield      #41                 // Field sharedState:Ljava/util/Map;
      84: ldc           #51                 // String javax.security.auth.login.password
      86: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      91: astore_2
      92: aload_2
      93: instanceof    #52                 // class "[C"
      96: ifeq          113
      99: aload_0
     100: aload_2
     101: checkcast     #52                 // class "[C"
     104: checkcast     #52                 // class "[C"
     107: putfield      #53                 // Field credential:[C
     110: goto          130
     113: aload_2
     114: ifnull        130
     117: aload_2
     118: invokevirtual #45                 // Method java/lang/Object.toString:()Ljava/lang/String;
     121: astore_3
     122: aload_0
     123: aload_3
     124: invokevirtual #54                 // Method java/lang/String.toCharArray:()[C
     127: putfield      #53                 // Field credential:[C
     130: iconst_1
     131: ireturn
     132: aload_0
     133: iconst_0
     134: putfield      #55                 // Field org/jboss/security/auth/spi/AbstractServerLoginModule.loginOk:Z
     137: aload_0
     138: invokevirtual #56                 // Method getUsernameAndPassword:()[Ljava/lang/String;
     141: astore_1
     142: aload_1
     143: iconst_0
     144: aaload
     145: astore_2
     146: aload_1
     147: iconst_1
     148: aaload
     149: astore_3
     150: aload_0
     151: getfield      #7                  // Field inputValidator:Lorg/jboss/security/auth/spi/InputValidator;
     154: ifnull        186
     157: aload_0
     158: getfield      #7                  // Field inputValidator:Lorg/jboss/security/auth/spi/InputValidator;
     161: aload_2
     162: aload_3
     163: invokeinterface #57,  3           // InterfaceMethod org/jboss/security/auth/spi/InputValidator.validateUsernameAndPassword:(Ljava/lang/String;Ljava/lang/String;)V
     168: goto          186
     171: astore        4
     173: new           #59                 // class javax/security/auth/login/FailedLoginException
     176: dup
     177: aload         4
     179: invokevirtual #60                 // Method org/jboss/security/auth/spi/InputValidationException.getLocalizedMessage:()Ljava/lang/String;
     182: invokespecial #61                 // Method javax/security/auth/login/FailedLoginException."<init>":(Ljava/lang/String;)V
     185: athrow
     186: aload_2
     187: ifnonnull     230
     190: aload_3
     191: ifnonnull     230
     194: aload_0
     195: aload_0
     196: getfield      #62                 // Field unauthenticatedIdentity:Ljava/security/Principal;
     199: putfield      #44                 // Field identity:Ljava/security/Principal;
     202: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     205: aload_0
     206: getfield      #44                 // Field identity:Ljava/security/Principal;
     209: ifnull        224
     212: aload_0
     213: getfield      #44                 // Field identity:Ljava/security/Principal;
     216: invokeinterface #63,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
     221: goto          225
     224: aconst_null
     225: invokeinterface #64,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceUsingUnauthIdentity:(Ljava/lang/String;)V
     230: aload_0
     231: getfield      #44                 // Field identity:Ljava/security/Principal;
     234: ifnonnull     432
     237: aload_0
     238: aload_0
     239: aload_2
     240: invokevirtual #46                 // Method createIdentity:(Ljava/lang/String;)Ljava/security/Principal;
     243: putfield      #44                 // Field identity:Ljava/security/Principal;
     246: goto          277
     249: astore        4
     251: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     254: aload         4
     256: invokevirtual #48                 // Method java/lang/Exception.getLocalizedMessage:()Ljava/lang/String;
     259: invokeinterface #49,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.failedToCreatePrincipal:(Ljava/lang/String;)Ljavax/security/auth/login/LoginException;
     264: astore        5
     266: aload         5
     268: aload         4
     270: invokevirtual #50                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     273: pop
     274: aload         5
     276: athrow
     277: aload_0
     278: getfield      #2                  // Field hashAlgorithm:Ljava/lang/String;
     281: ifnull        301
     284: aload_0
     285: getfield      #5                  // Field hashUserPassword:Z
     288: iconst_1
     289: if_icmpne     301
     292: aload_0
     293: aload_2
     294: aload_3
     295: ldc           #20                 // String digestCallback
     297: invokevirtual #65                 // Method createPasswordHash:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     300: astore_3
     301: aload_0
     302: invokevirtual #66                 // Method getUsersPassword:()Ljava/lang/String;
     305: astore        4
     307: aload         4
     309: invokestatic  #67                 // Method org/jboss/security/vault/SecurityVaultUtil.isVaultFormat:(Ljava/lang/String;)Z
     312: ifeq          348
     315: aload         4
     317: invokestatic  #68                 // Method org/jboss/security/vault/SecurityVaultUtil.getValueAsString:(Ljava/lang/String;)Ljava/lang/String;
     320: astore        4
     322: goto          348
     325: astore        5
     327: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     330: invokeinterface #70,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.unableToGetPasswordFromVault:()Ljavax/security/auth/login/LoginException;
     335: astore        6
     337: aload         6
     339: aload         5
     341: invokevirtual #50                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     344: pop
     345: aload         6
     347: athrow
     348: aload_0
     349: getfield      #2                  // Field hashAlgorithm:Ljava/lang/String;
     352: ifnull        374
     355: aload_0
     356: getfield      #28                 // Field hashStorePassword:Z
     359: iconst_1
     360: if_icmpne     374
     363: aload_0
     364: aload_2
     365: aload         4
     367: ldc           #21                 // String storeDigestCallback
     369: invokevirtual #65                 // Method createPasswordHash:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     372: astore        4
     374: aload_0
     375: aload_3
     376: aload         4
     378: invokevirtual #71                 // Method validatePassword:(Ljava/lang/String;Ljava/lang/String;)Z
     381: ifne          432
     384: aload_0
     385: invokevirtual #72                 // Method getValidateError:()Ljava/lang/Throwable;
     388: astore        5
     390: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     393: invokeinterface #73,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidPassword:()Ljavax/security/auth/login/FailedLoginException;
     398: astore        6
     400: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     403: aload_2
     404: invokeinterface #74,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugBadPasswordForUsername:(Ljava/lang/String;)V
     409: aload         5
     411: ifnull        429
     414: aload_0
     415: getfield      #6                  // Field throwValidateError:Z
     418: ifeq          429
     421: aload         6
     423: aload         5
     425: invokevirtual #75                 // Method javax/security/auth/login/FailedLoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     428: pop
     429: aload         6
     431: athrow
     432: aload_0
     433: invokevirtual #76                 // Method getUseFirstPass:()Z
     436: iconst_1
     437: if_icmpne     472
     440: aload_0
     441: getfield      #41                 // Field sharedState:Ljava/util/Map;
     444: ldc           #42                 // String javax.security.auth.login.name
     446: aload_0
     447: getfield      #44                 // Field identity:Ljava/security/Principal;
     450: invokeinterface #77,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     455: pop
     456: aload_0
     457: getfield      #41                 // Field sharedState:Ljava/util/Map;
     460: ldc           #51                 // String javax.security.auth.login.password
     462: aload_0
     463: getfield      #53                 // Field credential:[C
     466: invokeinterface #77,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     471: pop
     472: aload_0
     473: iconst_1
     474: putfield      #55                 // Field org/jboss/security/auth/spi/AbstractServerLoginModule.loginOk:Z
     477: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     480: aload_0
     481: getfield      #55                 // Field org/jboss/security/auth/spi/AbstractServerLoginModule.loginOk:Z
     484: invokeinterface #78,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceEndLogin:(Z)V
     489: iconst_1
     490: ireturn
    Exception table:
       from    to  target type
          43    52    55   Class java/lang/Exception
         157   168   171   Class org/jboss/security/auth/spi/InputValidationException
         237   246   249   Class java/lang/Exception
         315   322   325   Class org/jboss/security/vault/SecurityVaultException

  protected java.security.Principal getIdentity();
    Code:
       0: aload_0
       1: getfield      #44                 // Field identity:Ljava/security/Principal;
       4: areturn

  protected java.security.Principal getUnauthenticatedIdentity();
    Code:
       0: aload_0
       1: getfield      #62                 // Field unauthenticatedIdentity:Ljava/security/Principal;
       4: areturn

  protected java.lang.Object getCredentials();
    Code:
       0: aload_0
       1: getfield      #53                 // Field credential:[C
       4: areturn

  protected java.lang.String getUsername();
    Code:
       0: aconst_null
       1: astore_1
       2: aload_0
       3: invokevirtual #79                 // Method getIdentity:()Ljava/security/Principal;
       6: ifnull        19
       9: aload_0
      10: invokevirtual #79                 // Method getIdentity:()Ljava/security/Principal;
      13: invokeinterface #63,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      18: astore_1
      19: aload_1
      20: areturn

  protected java.lang.String[] getUsernameAndPassword() throws javax.security.auth.login.LoginException;
    Code:
       0: iconst_2
       1: anewarray     #14                 // class java/lang/String
       4: dup
       5: iconst_0
       6: aconst_null
       7: aastore
       8: dup
       9: iconst_1
      10: aconst_null
      11: aastore
      12: astore_1
      13: aload_0
      14: getfield      #80                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      17: ifnonnull     29
      20: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      23: invokeinterface #81,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.noCallbackHandlerAvailable:()Ljavax/security/auth/login/LoginException;
      28: athrow
      29: new           #82                 // class javax/security/auth/callback/NameCallback
      32: dup
      33: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      36: invokeinterface #83,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.enterUsernameMessage:()Ljava/lang/String;
      41: ldc           #84                 // String guest
      43: invokespecial #85                 // Method javax/security/auth/callback/NameCallback."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      46: astore_2
      47: new           #86                 // class javax/security/auth/callback/PasswordCallback
      50: dup
      51: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      54: invokeinterface #87,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.enterPasswordMessage:()Ljava/lang/String;
      59: iconst_0
      60: invokespecial #88                 // Method javax/security/auth/callback/PasswordCallback."<init>":(Ljava/lang/String;Z)V
      63: astore_3
      64: iconst_2
      65: anewarray     #89                 // class javax/security/auth/callback/Callback
      68: dup
      69: iconst_0
      70: aload_2
      71: aastore
      72: dup
      73: iconst_1
      74: aload_3
      75: aastore
      76: astore        4
      78: aconst_null
      79: astore        5
      81: aconst_null
      82: astore        6
      84: aload_0
      85: getfield      #80                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
      88: aload         4
      90: invokeinterface #90,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
      95: aload_2
      96: invokevirtual #91                 // Method javax/security/auth/callback/NameCallback.getName:()Ljava/lang/String;
      99: astore        5
     101: aload_3
     102: invokevirtual #92                 // Method javax/security/auth/callback/PasswordCallback.getPassword:()[C
     105: astore        7
     107: aload         7
     109: ifnull        152
     112: aload_0
     113: aload         7
     115: arraylength
     116: newarray       char
     118: putfield      #53                 // Field credential:[C
     121: aload         7
     123: iconst_0
     124: aload_0
     125: getfield      #53                 // Field credential:[C
     128: iconst_0
     129: aload         7
     131: arraylength
     132: invokestatic  #93                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     135: aload_3
     136: invokevirtual #94                 // Method javax/security/auth/callback/PasswordCallback.clearPassword:()V
     139: new           #14                 // class java/lang/String
     142: dup
     143: aload_0
     144: getfield      #53                 // Field credential:[C
     147: invokespecial #95                 // Method java/lang/String."<init>":([C)V
     150: astore        6
     152: goto          200
     155: astore        7
     157: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     160: invokeinterface #97,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.failedToInvokeCallbackHandler:()Ljavax/security/auth/login/LoginException;
     165: astore        8
     167: aload         8
     169: aload         7
     171: invokevirtual #50                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     174: pop
     175: aload         8
     177: athrow
     178: astore        7
     180: new           #99                 // class javax/security/auth/login/LoginException
     183: dup
     184: invokespecial #100                // Method javax/security/auth/login/LoginException."<init>":()V
     187: astore        8
     189: aload         8
     191: aload         7
     193: invokevirtual #50                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     196: pop
     197: aload         8
     199: athrow
     200: aload_1
     201: iconst_0
     202: aload         5
     204: aastore
     205: aload_1
     206: iconst_1
     207: aload         6
     209: aastore
     210: aload_1
     211: areturn
    Exception table:
       from    to  target type
          84   152   155   Class java/io/IOException
          84   152   178   Class javax/security/auth/callback/UnsupportedCallbackException

  protected java.lang.String createPasswordHash(java.lang.String, java.lang.String, java.lang.String) throws javax.security.auth.login.LoginException;
    Code:
       0: aconst_null
       1: astore        4
       3: aload_0
       4: getfield      #101                // Field options:Ljava/util/Map;
       7: aload_3
       8: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      13: checkcast     #14                 // class java/lang/String
      16: astore        5
      18: aload         5
      20: ifnull        222
      23: aload         5
      25: aload_0
      26: getfield      #34                 // Field jbossModuleName:Ljava/lang/String;
      29: invokestatic  #35                 // Method org/jboss/security/auth/spi/SecurityActions.loadClass:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Class;
      32: astore        6
      34: aload         6
      36: invokevirtual #36                 // Method java/lang/Class.newInstance:()Ljava/lang/Object;
      39: checkcast     #102                // class org/jboss/crypto/digest/DigestCallback
      42: astore        4
      44: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      47: aload         5
      49: invokeinterface #103,  2          // InterfaceMethod org/jboss/security/PicketBoxLogger.traceCreateDigestCallback:(Ljava/lang/String;)V
      54: goto          89
      57: astore        6
      59: new           #99                 // class javax/security/auth/login/LoginException
      62: dup
      63: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      66: ldc           #89                 // class javax/security/auth/callback/Callback
      68: invokeinterface #104,  2          // InterfaceMethod org/jboss/security/PicketBoxMessages.failedToInstantiateClassMessage:(Ljava/lang/Class;)Ljava/lang/String;
      73: invokespecial #105                // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      76: astore        7
      78: aload         7
      80: aload         6
      82: invokevirtual #50                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
      85: pop
      86: aload         7
      88: athrow
      89: new           #106                // class java/util/HashMap
      92: dup
      93: invokespecial #107                // Method java/util/HashMap."<init>":()V
      96: astore        6
      98: aload         6
     100: aload_0
     101: getfield      #101                // Field options:Ljava/util/Map;
     104: invokeinterface #108,  2          // InterfaceMethod java/util/Map.putAll:(Ljava/util/Map;)V
     109: aload         6
     111: ldc           #42                 // String javax.security.auth.login.name
     113: aload_1
     114: invokeinterface #77,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     119: pop
     120: aload         6
     122: ldc           #51                 // String javax.security.auth.login.password
     124: aload_2
     125: invokeinterface #77,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     130: pop
     131: aload         4
     133: aload         6
     135: invokeinterface #109,  2          // InterfaceMethod org/jboss/crypto/digest/DigestCallback.init:(Ljava/util/Map;)V
     140: aload         6
     142: ldc           #110                // String callbacks
     144: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     149: checkcast     #111                // class "[Ljavax/security/auth/callback/Callback;"
     152: checkcast     #111                // class "[Ljavax/security/auth/callback/Callback;"
     155: astore        7
     157: aload         7
     159: ifnull        222
     162: aload_0
     163: getfield      #80                 // Field callbackHandler:Ljavax/security/auth/callback/CallbackHandler;
     166: aload         7
     168: invokeinterface #90,  2           // InterfaceMethod javax/security/auth/callback/CallbackHandler.handle:([Ljavax/security/auth/callback/Callback;)V
     173: goto          222
     176: astore        8
     178: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     181: invokeinterface #97,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.failedToInvokeCallbackHandler:()Ljavax/security/auth/login/LoginException;
     186: astore        9
     188: aload         9
     190: aload         8
     192: invokevirtual #50                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     195: pop
     196: aload         9
     198: athrow
     199: astore        8
     201: getstatic     #47                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     204: invokeinterface #97,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.failedToInvokeCallbackHandler:()Ljavax/security/auth/login/LoginException;
     209: astore        9
     211: aload         9
     213: aload         8
     215: invokevirtual #50                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     218: pop
     219: aload         9
     221: athrow
     222: aload_0
     223: getfield      #2                  // Field hashAlgorithm:Ljava/lang/String;
     226: aload_0
     227: getfield      #4                  // Field hashEncoding:Ljava/lang/String;
     230: aload_0
     231: getfield      #3                  // Field hashCharset:Ljava/lang/String;
     234: aload_1
     235: aload_2
     236: aload         4
     238: invokestatic  #112                // Method org/jboss/security/auth/spi/Util.createPasswordHash:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Lorg/jboss/crypto/digest/DigestCallback;)Ljava/lang/String;
     241: astore        6
     243: aload         6
     245: areturn
    Exception table:
       from    to  target type
          23    54    57   Class java/lang/Exception
         162   173   176   Class java/io/IOException
         162   173   199   Class javax/security/auth/callback/UnsupportedCallbackException

  protected java.lang.Throwable getValidateError();
    Code:
       0: aload_0
       1: getfield      #113                // Field validateError:Ljava/lang/Throwable;
       4: areturn

  protected void setValidateError(java.lang.Throwable);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #113                // Field validateError:Ljava/lang/Throwable;
       5: return

  protected boolean validatePassword(java.lang.String, java.lang.String);
    Code:
       0: aload_1
       1: ifnull        8
       4: aload_2
       5: ifnonnull     10
       8: iconst_0
       9: ireturn
      10: iconst_0
      11: istore_3
      12: aload_0
      13: getfield      #26                 // Field ignorePasswordCase:Z
      16: iconst_1
      17: if_icmpne     29
      20: aload_1
      21: aload_2
      22: invokevirtual #114                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
      25: istore_3
      26: goto          35
      29: aload_1
      30: aload_2
      31: invokevirtual #115                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      34: istore_3
      35: iload_3
      36: ireturn

  protected abstract java.lang.String getUsersPassword() throws javax.security.auth.login.LoginException;

  protected void safeClose(java.io.InputStream);
    Code:
       0: aload_1
       1: ifnull        8
       4: aload_1
       5: invokevirtual #116                // Method java/io/InputStream.close:()V
       8: goto          12
      11: astore_2
      12: return
    Exception table:
       from    to  target type
           0     8    11   Class java/lang/Exception

  static {};
    Code:
       0: bipush        12
       2: anewarray     #14                 // class java/lang/String
       5: dup
       6: iconst_0
       7: ldc           #12                 // String hashAlgorithm
       9: aastore
      10: dup
      11: iconst_1
      12: ldc           #15                 // String hashEncoding
      14: aastore
      15: dup
      16: iconst_2
      17: ldc           #18                 // String hashCharset
      19: aastore
      20: dup
      21: iconst_3
      22: ldc           #27                 // String hashStorePassword
      24: aastore
      25: dup
      26: iconst_4
      27: ldc           #29                 // String hashUserPassword
      29: aastore
      30: dup
      31: iconst_5
      32: ldc           #20                 // String digestCallback
      34: aastore
      35: dup
      36: bipush        6
      38: ldc           #21                 // String storeDigestCallback
      40: aastore
      41: dup
      42: bipush        7
      44: ldc           #23                 // String ignorePasswordCase
      46: aastore
      47: dup
      48: bipush        8
      50: ldc           #30                 // String legacyCreatePasswordHash
      52: aastore
      53: dup
      54: bipush        9
      56: ldc           #32                 // String throwValidateError
      58: aastore
      59: dup
      60: bipush        10
      62: ldc           #33                 // String inputValidator
      64: aastore
      65: dup
      66: bipush        11
      68: ldc           #117                // String passwordIsA1Hash
      70: aastore
      71: putstatic     #8                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
      74: return
}
