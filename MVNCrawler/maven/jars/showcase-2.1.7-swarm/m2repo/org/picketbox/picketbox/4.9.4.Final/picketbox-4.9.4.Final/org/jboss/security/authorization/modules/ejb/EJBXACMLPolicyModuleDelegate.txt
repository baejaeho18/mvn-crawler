Compiled from "EJBXACMLPolicyModuleDelegate.java"
public class org.jboss.security.authorization.modules.ejb.EJBXACMLPolicyModuleDelegate extends org.jboss.security.authorization.modules.ejb.EJBPolicyModuleDelegate {
  private java.lang.String policyContextID;

  public org.jboss.security.authorization.modules.ejb.EJBXACMLPolicyModuleDelegate();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jboss/security/authorization/modules/ejb/EJBPolicyModuleDelegate."<init>":()V
       4: return

  public int authorize(org.jboss.security.authorization.Resource, javax.security.auth.Subject, org.jboss.security.identity.RoleGroup);
    Code:
       0: aload_1
       1: instanceof    #2                  // class org/jboss/security/authorization/resources/EJBResource
       4: ifne          21
       7: getstatic     #3                  // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      10: ldc           #2                  // class org/jboss/security/authorization/resources/EJBResource
      12: invokevirtual #4                  // Method java/lang/Class.getName:()Ljava/lang/String;
      15: invokeinterface #5,  2            // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidType:(Ljava/lang/String;)Ljava/lang/IllegalArgumentException;
      20: athrow
      21: aload_1
      22: checkcast     #2                  // class org/jboss/security/authorization/resources/EJBResource
      25: astore        4
      27: aload_1
      28: invokeinterface #6,  1            // InterfaceMethod org/jboss/security/authorization/Resource.getMap:()Ljava/util/Map;
      33: astore        5
      35: aload         5
      37: ifnonnull     51
      40: getstatic     #3                  // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      43: ldc           #7                  // String resourceMap
      45: invokeinterface #8,  2            // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullProperty:(Ljava/lang/String;)Ljava/lang/IllegalStateException;
      50: athrow
      51: aload_0
      52: aload         5
      54: ldc           #10                 // String policyRegistration
      56: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      61: checkcast     #12                 // class org/jboss/security/authorization/PolicyRegistration
      64: putfield      #13                 // Field policyRegistration:Lorg/jboss/security/authorization/PolicyRegistration;
      67: aload_0
      68: getfield      #13                 // Field policyRegistration:Lorg/jboss/security/authorization/PolicyRegistration;
      71: ifnonnull     85
      74: getstatic     #3                  // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      77: ldc           #10                 // String policyRegistration
      79: invokeinterface #8,  2            // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullProperty:(Ljava/lang/String;)Ljava/lang/IllegalStateException;
      84: athrow
      85: aload_0
      86: aload         4
      88: invokevirtual #14                 // Method org/jboss/security/authorization/resources/EJBResource.getCallerRunAsIdentity:()Lorg/jboss/security/RunAs;
      91: putfield      #15                 // Field callerRunAs:Lorg/jboss/security/RunAs;
      94: aload_0
      95: aload         4
      97: invokevirtual #16                 // Method org/jboss/security/authorization/resources/EJBResource.getEjbName:()Ljava/lang/String;
     100: putfield      #17                 // Field ejbName:Ljava/lang/String;
     103: aload_0
     104: aload         4
     106: invokevirtual #18                 // Method org/jboss/security/authorization/resources/EJBResource.getEjbMethod:()Ljava/lang/reflect/Method;
     109: putfield      #19                 // Field ejbMethod:Ljava/lang/reflect/Method;
     112: aload_0
     113: aload         4
     115: invokevirtual #20                 // Method org/jboss/security/authorization/resources/EJBResource.getPrincipal:()Ljava/security/Principal;
     118: putfield      #21                 // Field ejbPrincipal:Ljava/security/Principal;
     121: aload_0
     122: aload         4
     124: invokevirtual #22                 // Method org/jboss/security/authorization/resources/EJBResource.getPolicyContextID:()Ljava/lang/String;
     127: putfield      #23                 // Field policyContextID:Ljava/lang/String;
     130: aload_0
     131: getfield      #23                 // Field policyContextID:Ljava/lang/String;
     134: ifnonnull     148
     137: getstatic     #3                  // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     140: ldc           #24                 // String contextID
     142: invokeinterface #8,  2            // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullProperty:(Ljava/lang/String;)Ljava/lang/IllegalStateException;
     147: athrow
     148: aload_0
     149: aload         4
     151: invokevirtual #25                 // Method org/jboss/security/authorization/resources/EJBResource.getSecurityRoleReferences:()Ljava/util/Set;
     154: putfield      #26                 // Field securityRoleReferences:Ljava/util/Set;
     157: aload_0
     158: aload         5
     160: ldc           #27                 // String roleName
     162: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     167: checkcast     #28                 // class java/lang/String
     170: putfield      #29                 // Field roleName:Ljava/lang/String;
     173: aload_0
     174: aload         5
     176: ldc           #30                 // String roleRefPermissionCheck
     178: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     183: checkcast     #31                 // class java/lang/Boolean
     186: invokespecial #32                 // Method checkBooleanValue:(Ljava/lang/Boolean;)Ljava/lang/Boolean;
     189: astore        6
     191: aload         6
     193: invokevirtual #33                 // Method java/lang/Boolean.booleanValue:()Z
     196: ifeq          205
     199: aload_0
     200: aload_3
     201: invokevirtual #34                 // Method checkRoleRef:(Lorg/jboss/security/identity/RoleGroup;)I
     204: ireturn
     205: aload_0
     206: aload_3
     207: invokespecial #35                 // Method process:(Lorg/jboss/security/identity/RoleGroup;)I
     210: ireturn

  private int process(org.jboss.security.identity.RoleGroup);
    Code:
       0: iconst_m1
       1: istore_2
       2: new           #37                 // class org/jboss/security/authorization/modules/ejb/EJBXACMLUtil
       5: dup
       6: invokespecial #38                 // Method org/jboss/security/authorization/modules/ejb/EJBXACMLUtil."<init>":()V
       9: astore_3
      10: aload_3
      11: aload_0
      12: getfield      #17                 // Field ejbName:Ljava/lang/String;
      15: aload_0
      16: getfield      #19                 // Field ejbMethod:Ljava/lang/reflect/Method;
      19: aload_0
      20: getfield      #21                 // Field ejbPrincipal:Ljava/security/Principal;
      23: aload_1
      24: invokevirtual #39                 // Method org/jboss/security/authorization/modules/ejb/EJBXACMLUtil.createXACMLRequest:(Ljava/lang/String;Ljava/lang/reflect/Method;Ljava/security/Principal;Lorg/jboss/security/identity/RoleGroup;)Lorg/jboss/security/xacml/interfaces/RequestContext;
      27: astore        4
      29: aload_3
      30: aload_0
      31: getfield      #13                 // Field policyRegistration:Lorg/jboss/security/authorization/PolicyRegistration;
      34: aload_0
      35: getfield      #23                 // Field policyContextID:Ljava/lang/String;
      38: invokevirtual #40                 // Method org/jboss/security/authorization/modules/ejb/EJBXACMLUtil.getPDP:(Lorg/jboss/security/authorization/PolicyRegistration;Ljava/lang/String;)Lorg/jboss/security/xacml/interfaces/PolicyDecisionPoint;
      41: astore        5
      43: aload         5
      45: ifnonnull     59
      48: getstatic     #3                  // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      51: ldc           #41                 // String PDP
      53: invokeinterface #8,  2            // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullProperty:(Ljava/lang/String;)Ljava/lang/IllegalStateException;
      58: athrow
      59: aload         5
      61: aload         4
      63: invokeinterface #42,  2           // InterfaceMethod org/jboss/security/xacml/interfaces/PolicyDecisionPoint.evaluate:(Lorg/jboss/security/xacml/interfaces/RequestContext;)Lorg/jboss/security/xacml/interfaces/ResponseContext;
      68: astore        6
      70: aload         6
      72: invokeinterface #43,  1           // InterfaceMethod org/jboss/security/xacml/interfaces/ResponseContext.getDecision:()I
      77: ifne          84
      80: iconst_1
      81: goto          85
      84: iconst_m1
      85: istore_2
      86: goto          103
      89: astore        4
      91: getstatic     #45                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      94: aload         4
      96: invokeinterface #46,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugIgnoredException:(Ljava/lang/Throwable;)V
     101: iconst_m1
     102: istore_2
     103: iload_2
     104: ireturn
    Exception table:
       from    to  target type
          10    86    89   Class java/lang/Exception

  private java.lang.Boolean checkBooleanValue(java.lang.Boolean);
    Code:
       0: aload_1
       1: ifnonnull     8
       4: getstatic     #47                 // Field java/lang/Boolean.FALSE:Ljava/lang/Boolean;
       7: areturn
       8: aload_1
       9: areturn
}
