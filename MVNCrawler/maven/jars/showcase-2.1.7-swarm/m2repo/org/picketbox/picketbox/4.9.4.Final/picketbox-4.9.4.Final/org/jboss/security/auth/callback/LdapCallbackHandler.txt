Compiled from "LdapCallbackHandler.java"
public class org.jboss.security.auth.callback.LdapCallbackHandler extends org.jboss.security.auth.callback.AbstractCallbackHandler implements javax.security.auth.callback.CallbackHandler {
  private static final java.lang.String PASSWORD_ATTRIBUTE_ID;

  private static final java.lang.String BIND_DN;

  private static final java.lang.String BIND_CREDENTIAL;

  private static final java.lang.String BASE_CTX_DN;

  private static final java.lang.String BASE_FILTER_OPT;

  private static final java.lang.String SEARCH_TIME_LIMIT_OPT;

  private static final java.lang.String SECURITY_DOMAIN_OPT;

  private static final java.lang.String DISTINGUISHED_NAME_ATTRIBUTE_OPT;

  protected java.lang.String bindDN;

  protected java.lang.String bindCredential;

  protected java.lang.String passwordAttributeID;

  protected int searchTimeLimit;

  protected java.lang.String distinguishedNameAttribute;

  protected boolean isPasswordValidated;

  protected java.util.Map<java.lang.String, java.lang.String> options;

  public org.jboss.security.auth.callback.LdapCallbackHandler();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jboss/security/auth/callback/AbstractCallbackHandler."<init>":()V
       4: aload_0
       5: ldc           #2                  // String userPassword
       7: putfield      #3                  // Field passwordAttributeID:Ljava/lang/String;
      10: aload_0
      11: sipush        10000
      14: putfield      #4                  // Field searchTimeLimit:I
      17: aload_0
      18: iconst_0
      19: putfield      #5                  // Field isPasswordValidated:Z
      22: aload_0
      23: new           #6                  // class java/util/HashMap
      26: dup
      27: invokespecial #7                  // Method java/util/HashMap."<init>":()V
      30: putfield      #8                  // Field options:Ljava/util/Map;
      33: return

  public void setConfiguration(java.util.Map<java.lang.String, java.lang.String>);
    Code:
       0: aload_1
       1: ifnull        14
       4: aload_0
       5: getfield      #8                  // Field options:Ljava/util/Map;
       8: aload_1
       9: invokeinterface #9,  2            // InterfaceMethod java/util/Map.putAll:(Ljava/util/Map;)V
      14: return

  public void handle(javax.security.auth.callback.Callback[]) throws java.io.IOException, javax.security.auth.callback.UnsupportedCallbackException;
    Code:
       0: aload_0
       1: getfield      #10                 // Field userName:Ljava/lang/String;
       4: ifnonnull     16
       7: aload_0
       8: aload_0
       9: aload_1
      10: invokevirtual #11                 // Method getUserName:([Ljavax/security/auth/callback/Callback;)Ljava/lang/String;
      13: putfield      #10                 // Field userName:Ljava/lang/String;
      16: iconst_0
      17: istore_2
      18: iload_2
      19: aload_1
      20: arraylength
      21: if_icmpge     54
      24: aload_1
      25: iload_2
      26: aaload
      27: astore_3
      28: aload_0
      29: aload_3
      30: invokevirtual #12                 // Method handleCallBack:(Ljavax/security/auth/callback/Callback;)V
      33: goto          48
      36: astore        4
      38: new           #14                 // class java/io/IOException
      41: dup
      42: aload         4
      44: invokespecial #15                 // Method java/io/IOException."<init>":(Ljava/lang/Throwable;)V
      47: athrow
      48: iinc          2, 1
      51: goto          18
      54: return
    Exception table:
       from    to  target type
          28    33    36   Class javax/naming/NamingException

  protected void handleCallBack(javax.security.auth.callback.Callback) throws javax.security.auth.callback.UnsupportedCallbackException, javax.naming.NamingException;
    Code:
       0: aload_1
       1: instanceof    #16                 // class org/jboss/security/auth/callback/VerifyPasswordCallback
       4: ifeq          16
       7: aload_0
       8: aload_1
       9: checkcast     #16                 // class org/jboss/security/auth/callback/VerifyPasswordCallback
      12: invokevirtual #17                 // Method verifyPassword:(Lorg/jboss/security/auth/callback/VerifyPasswordCallback;)V
      15: return
      16: aload_1
      17: instanceof    #18                 // class javax/security/auth/callback/PasswordCallback
      20: ifne          24
      23: return
      24: aload_1
      25: checkcast     #18                 // class javax/security/auth/callback/PasswordCallback
      28: astore_2
      29: aload_0
      30: invokevirtual #19                 // Method getBindDN:()Ljava/lang/String;
      33: astore_3
      34: aload_0
      35: invokevirtual #20                 // Method getBindCredential:()Ljava/lang/String;
      38: astore        4
      40: aload_0
      41: getfield      #8                  // Field options:Ljava/util/Map;
      44: ldc           #22                 // String passwordAttributeID
      46: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      51: checkcast     #24                 // class java/lang/String
      54: astore        5
      56: aload         5
      58: ifnull        75
      61: aload         5
      63: invokevirtual #25                 // Method java/lang/String.length:()I
      66: ifle          75
      69: aload_0
      70: aload         5
      72: putfield      #3                  // Field passwordAttributeID:Ljava/lang/String;
      75: aconst_null
      76: astore        6
      78: invokestatic  #26                 // Method org/jboss/security/auth/callback/SecurityActions.getContextClassLoader:()Ljava/lang/ClassLoader;
      81: astore        7
      83: aload         7
      85: ifnull        93
      88: aconst_null
      89: invokestatic  #27                 // Method org/jboss/security/auth/callback/SecurityActions.setContextClassLoader:(Ljava/lang/ClassLoader;)Ljava/lang/Void;
      92: pop
      93: aload_0
      94: aload_3
      95: aload         4
      97: invokespecial #28                 // Method constructInitialLdapContext:(Ljava/lang/String;Ljava/lang/Object;)Ljavax/naming/ldap/InitialLdapContext;
     100: astore        6
     102: goto          134
     105: astore        8
     107: aload_0
     108: aload         6
     110: invokevirtual #29                 // Method safeClose:(Ljavax/naming/ldap/InitialLdapContext;)V
     113: aload         7
     115: ifnull        124
     118: aload         7
     120: invokestatic  #27                 // Method org/jboss/security/auth/callback/SecurityActions.setContextClassLoader:(Ljava/lang/ClassLoader;)Ljava/lang/Void;
     123: pop
     124: new           #30                 // class java/lang/RuntimeException
     127: dup
     128: aload         8
     130: invokespecial #31                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
     133: athrow
     134: aload_0
     135: getfield      #8                  // Field options:Ljava/util/Map;
     138: ldc           #32                 // String searchTimeLimit
     140: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     145: checkcast     #24                 // class java/lang/String
     148: astore        8
     150: aload         8
     152: ifnull        169
     155: aload_0
     156: aload         8
     158: invokestatic  #33                 // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
     161: putfield      #4                  // Field searchTimeLimit:I
     164: goto          169
     167: astore        9
     169: aload_0
     170: getfield      #4                  // Field searchTimeLimit:I
     173: ifne          183
     176: aload_0
     177: sipush        10000
     180: putfield      #4                  // Field searchTimeLimit:I
     183: aload_0
     184: getfield      #8                  // Field options:Ljava/util/Map;
     187: ldc           #35                 // String baseCtxDN
     189: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     194: checkcast     #24                 // class java/lang/String
     197: astore        9
     199: aload_0
     200: getfield      #8                  // Field options:Ljava/util/Map;
     203: ldc           #36                 // String baseFilter
     205: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     210: checkcast     #24                 // class java/lang/String
     213: astore        10
     215: new           #37                 // class javax/naming/directory/SearchControls
     218: dup
     219: invokespecial #38                 // Method javax/naming/directory/SearchControls."<init>":()V
     222: astore        11
     224: aload         11
     226: iconst_2
     227: invokevirtual #39                 // Method javax/naming/directory/SearchControls.setSearchScope:(I)V
     230: aload         11
     232: aload_0
     233: getfield      #4                  // Field searchTimeLimit:I
     236: invokevirtual #40                 // Method javax/naming/directory/SearchControls.setTimeLimit:(I)V
     239: aconst_null
     240: astore        12
     242: iconst_1
     243: anewarray     #41                 // class java/lang/Object
     246: dup
     247: iconst_0
     248: aload_0
     249: getfield      #10                 // Field userName:Ljava/lang/String;
     252: aastore
     253: astore        13
     255: aload         9
     257: ifnonnull     269
     260: getstatic     #42                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     263: invokeinterface #43,  1           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidNullBaseContextDN:()Ljavax/naming/NamingException;
     268: athrow
     269: aload         6
     271: aload         9
     273: aload         10
     275: aload         13
     277: aload         11
     279: invokevirtual #44                 // Method javax/naming/ldap/InitialLdapContext.search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;Ljavax/naming/directory/SearchControls;)Ljavax/naming/NamingEnumeration;
     282: astore        12
     284: aload         12
     286: invokeinterface #45,  1           // InterfaceMethod javax/naming/NamingEnumeration.hasMore:()Z
     291: ifne          311
     294: aload_0
     295: aload         12
     297: invokevirtual #46                 // Method safeClose:(Ljavax/naming/NamingEnumeration;)V
     300: getstatic     #42                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     303: aload         9
     305: invokeinterface #47,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.failedToFindBaseContextDN:(Ljava/lang/String;)Ljavax/naming/NamingException;
     310: athrow
     311: aload         12
     313: invokeinterface #48,  1           // InterfaceMethod javax/naming/NamingEnumeration.next:()Ljava/lang/Object;
     318: checkcast     #49                 // class javax/naming/directory/SearchResult
     321: astore        14
     323: aload         14
     325: invokevirtual #50                 // Method javax/naming/directory/SearchResult.getName:()Ljava/lang/String;
     328: astore        15
     330: aconst_null
     331: astore        16
     333: aload         14
     335: invokevirtual #51                 // Method javax/naming/directory/SearchResult.isRelative:()Z
     338: iconst_1
     339: if_icmpne     372
     342: new           #52                 // class java/lang/StringBuilder
     345: dup
     346: invokespecial #53                 // Method java/lang/StringBuilder."<init>":()V
     349: aload         15
     351: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     354: ldc           #55                 // String ,
     356: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     359: aload         9
     361: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     364: invokevirtual #56                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     367: astore        16
     369: goto          383
     372: getstatic     #42                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     375: aload         15
     377: invokeinterface #57,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.unableToFollowReferralForAuth:(Ljava/lang/String;)Ljavax/naming/NamingException;
     382: athrow
     383: aload_0
     384: aload         12
     386: invokevirtual #46                 // Method safeClose:(Ljavax/naming/NamingEnumeration;)V
     389: iconst_2
     390: anewarray     #41                 // class java/lang/Object
     393: dup
     394: iconst_0
     395: aload_0
     396: getfield      #10                 // Field userName:Ljava/lang/String;
     399: aastore
     400: dup
     401: iconst_1
     402: aload         16
     404: aastore
     405: astore        13
     407: aload         6
     409: aload         16
     411: aload         10
     413: aload         13
     415: aload         11
     417: invokevirtual #44                 // Method javax/naming/ldap/InitialLdapContext.search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;Ljavax/naming/directory/SearchControls;)Ljavax/naming/NamingEnumeration;
     420: astore        12
     422: aload         12
     424: invokeinterface #45,  1           // InterfaceMethod javax/naming/NamingEnumeration.hasMore:()Z
     429: ifeq          526
     432: aload         12
     434: invokeinterface #48,  1           // InterfaceMethod javax/naming/NamingEnumeration.next:()Ljava/lang/Object;
     439: checkcast     #49                 // class javax/naming/directory/SearchResult
     442: astore        14
     444: aload         14
     446: invokevirtual #58                 // Method javax/naming/directory/SearchResult.getAttributes:()Ljavax/naming/directory/Attributes;
     449: astore        17
     451: aload         17
     453: invokeinterface #59,  1           // InterfaceMethod javax/naming/directory/Attributes.getAll:()Ljavax/naming/NamingEnumeration;
     458: astore        18
     460: aload         18
     462: ifnull        523
     465: aload         18
     467: invokeinterface #60,  1           // InterfaceMethod javax/naming/NamingEnumeration.hasMoreElements:()Z
     472: ifeq          523
     475: aload         18
     477: invokeinterface #48,  1           // InterfaceMethod javax/naming/NamingEnumeration.next:()Ljava/lang/Object;
     482: checkcast     #61                 // class javax/naming/directory/Attribute
     485: astore        19
     487: aload_0
     488: getfield      #3                  // Field passwordAttributeID:Ljava/lang/String;
     491: aload         19
     493: invokeinterface #62,  1           // InterfaceMethod javax/naming/directory/Attribute.getID:()Ljava/lang/String;
     498: invokevirtual #63                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     501: ifeq          520
     504: aload         19
     506: invokeinterface #64,  1           // InterfaceMethod javax/naming/directory/Attribute.get:()Ljava/lang/Object;
     511: astore        20
     513: aload_0
     514: aload         20
     516: aload_2
     517: invokevirtual #65                 // Method setPasswordCallbackValue:(Ljava/lang/Object;Ljavax/security/auth/callback/PasswordCallback;)V
     520: goto          460
     523: goto          422
     526: aload_0
     527: aload         12
     529: invokevirtual #46                 // Method safeClose:(Ljavax/naming/NamingEnumeration;)V
     532: aload_0
     533: aload         6
     535: invokevirtual #29                 // Method safeClose:(Ljavax/naming/ldap/InitialLdapContext;)V
     538: aload         7
     540: ifnull        618
     543: aload         7
     545: invokestatic  #27                 // Method org/jboss/security/auth/callback/SecurityActions.setContextClassLoader:(Ljava/lang/ClassLoader;)Ljava/lang/Void;
     548: pop
     549: goto          618
     552: astore        14
     554: getstatic     #66                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     557: aload         14
     559: invokeinterface #67,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.error:(Ljava/lang/Object;)V
     564: aload_0
     565: aload         12
     567: invokevirtual #46                 // Method safeClose:(Ljavax/naming/NamingEnumeration;)V
     570: aload_0
     571: aload         6
     573: invokevirtual #29                 // Method safeClose:(Ljavax/naming/ldap/InitialLdapContext;)V
     576: aload         7
     578: ifnull        618
     581: aload         7
     583: invokestatic  #27                 // Method org/jboss/security/auth/callback/SecurityActions.setContextClassLoader:(Ljava/lang/ClassLoader;)Ljava/lang/Void;
     586: pop
     587: goto          618
     590: astore        21
     592: aload_0
     593: aload         12
     595: invokevirtual #46                 // Method safeClose:(Ljavax/naming/NamingEnumeration;)V
     598: aload_0
     599: aload         6
     601: invokevirtual #29                 // Method safeClose:(Ljavax/naming/ldap/InitialLdapContext;)V
     604: aload         7
     606: ifnull        615
     609: aload         7
     611: invokestatic  #27                 // Method org/jboss/security/auth/callback/SecurityActions.setContextClassLoader:(Ljava/lang/ClassLoader;)Ljava/lang/Void;
     614: pop
     615: aload         21
     617: athrow
     618: return
    Exception table:
       from    to  target type
          83   102   105   Class javax/naming/NamingException
         155   164   167   Class java/lang/NumberFormatException
         255   526   552   Class javax/naming/NamingException
         255   526   590   any
         552   564   590   any
         590   592   590   any

  protected void verifyPassword(org.jboss.security.auth.callback.VerifyPasswordCallback) throws javax.naming.NamingException;
    Code:
       0: aload_1
       1: invokevirtual #68                 // Method org/jboss/security/auth/callback/VerifyPasswordCallback.getValue:()Ljava/lang/String;
       4: astore_2
       5: invokestatic  #26                 // Method org/jboss/security/auth/callback/SecurityActions.getContextClassLoader:()Ljava/lang/ClassLoader;
       8: astore_3
       9: aload_3
      10: ifnull        18
      13: aconst_null
      14: invokestatic  #27                 // Method org/jboss/security/auth/callback/SecurityActions.setContextClassLoader:(Ljava/lang/ClassLoader;)Ljava/lang/Void;
      17: pop
      18: aload_0
      19: getfield      #8                  // Field options:Ljava/util/Map;
      22: ldc           #35                 // String baseCtxDN
      24: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      29: checkcast     #24                 // class java/lang/String
      32: astore        4
      34: aload_0
      35: getfield      #8                  // Field options:Ljava/util/Map;
      38: ldc           #36                 // String baseFilter
      40: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      45: checkcast     #24                 // class java/lang/String
      48: astore        5
      50: aload_0
      51: aload_0
      52: getfield      #69                 // Field bindDN:Ljava/lang/String;
      55: aload_0
      56: getfield      #70                 // Field bindCredential:Ljava/lang/String;
      59: invokespecial #28                 // Method constructInitialLdapContext:(Ljava/lang/String;Ljava/lang/Object;)Ljavax/naming/ldap/InitialLdapContext;
      62: astore        6
      64: aload_0
      65: aload         6
      67: aload_0
      68: getfield      #10                 // Field userName:Ljava/lang/String;
      71: aload_2
      72: aload         4
      74: aload         5
      76: invokevirtual #71                 // Method bindDNAuthentication:(Ljavax/naming/ldap/InitialLdapContext;Ljava/lang/String;Ljava/lang/Object;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      79: pop
      80: aload_1
      81: iconst_1
      82: invokevirtual #72                 // Method org/jboss/security/auth/callback/VerifyPasswordCallback.setVerified:(Z)V
      85: return

  protected java.lang.String getBindDN();
    Code:
       0: aload_0
       1: getfield      #8                  // Field options:Ljava/util/Map;
       4: ldc           #73                 // String bindDN
       6: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      11: checkcast     #24                 // class java/lang/String
      14: astore_1
      15: aload_1
      16: ifnull        26
      19: aload_1
      20: invokevirtual #25                 // Method java/lang/String.length:()I
      23: ifne          34
      26: getstatic     #66                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      29: invokeinterface #74,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBindDNNotFound:()V
      34: aload_1
      35: areturn

  protected java.lang.String getBindCredential();
    Code:
       0: aload_0
       1: getfield      #8                  // Field options:Ljava/util/Map;
       4: ldc           #75                 // String bindCredential
       6: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      11: checkcast     #24                 // class java/lang/String
      14: astore_1
      15: aload_1
      16: invokestatic  #76                 // Method org/jboss/security/Util.isPasswordCommand:(Ljava/lang/String;)Z
      19: ifeq          47
      22: new           #24                 // class java/lang/String
      25: dup
      26: aload_1
      27: invokestatic  #77                 // Method org/jboss/security/Util.loadPassword:(Ljava/lang/String;)[C
      30: invokespecial #78                 // Method java/lang/String."<init>":([C)V
      33: astore_1
      34: goto          47
      37: astore_2
      38: getstatic     #66                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      41: aload_2
      42: invokeinterface #80,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.errorDecryptingBindCredential:(Ljava/lang/Throwable;)V
      47: aload_0
      48: getfield      #8                  // Field options:Ljava/util/Map;
      51: ldc           #81                 // String jaasSecurityDomain
      53: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      58: checkcast     #24                 // class java/lang/String
      61: astore_2
      62: aload_2
      63: ifnull        105
      66: new           #82                 // class javax/management/ObjectName
      69: dup
      70: aload_2
      71: invokespecial #83                 // Method javax/management/ObjectName."<init>":(Ljava/lang/String;)V
      74: astore_3
      75: aload_1
      76: aload_3
      77: invokestatic  #84                 // Method org/jboss/security/auth/callback/DecodeAction.decode:(Ljava/lang/String;Ljavax/management/ObjectName;)[C
      80: astore        4
      82: new           #24                 // class java/lang/String
      85: dup
      86: aload         4
      88: invokespecial #78                 // Method java/lang/String."<init>":([C)V
      91: astore_1
      92: goto          105
      95: astore_3
      96: getstatic     #66                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      99: aload_3
     100: invokeinterface #80,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.errorDecryptingBindCredential:(Ljava/lang/Throwable;)V
     105: aload_1
     106: areturn
    Exception table:
       from    to  target type
          22    34    37   Class java/lang/Exception
          66    92    95   Class java/lang/Exception

  protected void setPasswordCallbackValue(java.lang.Object, javax.security.auth.callback.PasswordCallback);
    Code:
       0: aload_1
       1: instanceof    #24                 // class java/lang/String
       4: ifeq          23
       7: aload_1
       8: checkcast     #24                 // class java/lang/String
      11: astore_3
      12: aload_2
      13: aload_3
      14: invokevirtual #85                 // Method java/lang/String.toCharArray:()[C
      17: invokevirtual #86                 // Method javax/security/auth/callback/PasswordCallback.setPassword:([C)V
      20: goto          100
      23: aload_1
      24: instanceof    #87                 // class "[C"
      27: ifeq          44
      30: aload_2
      31: aload_1
      32: checkcast     #87                 // class "[C"
      35: checkcast     #87                 // class "[C"
      38: invokevirtual #86                 // Method javax/security/auth/callback/PasswordCallback.setPassword:([C)V
      41: goto          100
      44: aload_1
      45: instanceof    #88                 // class "[B"
      48: ifeq          79
      51: aload_1
      52: checkcast     #88                 // class "[B"
      55: checkcast     #88                 // class "[B"
      58: astore        4
      60: aload_2
      61: new           #24                 // class java/lang/String
      64: dup
      65: aload         4
      67: invokespecial #89                 // Method java/lang/String."<init>":([B)V
      70: invokevirtual #85                 // Method java/lang/String.toCharArray:()[C
      73: invokevirtual #86                 // Method javax/security/auth/callback/PasswordCallback.setPassword:([C)V
      76: goto          100
      79: getstatic     #42                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      82: aload_1
      83: ifnull        93
      86: aload_1
      87: invokevirtual #90                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      90: goto          94
      93: aconst_null
      94: invokeinterface #91,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.invalidPasswordType:(Ljava/lang/Class;)Ljava/lang/RuntimeException;
      99: athrow
     100: return

  private javax.naming.ldap.InitialLdapContext constructInitialLdapContext(java.lang.String, java.lang.Object) throws javax.naming.NamingException;
    Code:
       0: new           #92                 // class java/util/Properties
       3: dup
       4: invokespecial #93                 // Method java/util/Properties."<init>":()V
       7: astore_3
       8: aload_0
       9: getfield      #8                  // Field options:Ljava/util/Map;
      12: invokeinterface #94,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
      17: invokeinterface #95,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      22: astore        4
      24: aload         4
      26: invokeinterface #96,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      31: ifeq          68
      34: aload         4
      36: invokeinterface #97,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      41: checkcast     #98                 // class java/util/Map$Entry
      44: astore        5
      46: aload_3
      47: aload         5
      49: invokeinterface #99,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
      54: aload         5
      56: invokeinterface #100,  1          // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
      61: invokevirtual #101                // Method java/util/Properties.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      64: pop
      65: goto          24
      68: aload_3
      69: ldc           #103                // String java.naming.factory.initial
      71: invokevirtual #104                // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      74: astore        4
      76: aload         4
      78: ifnonnull     94
      81: ldc           #105                // String com.sun.jndi.ldap.LdapCtxFactory
      83: astore        4
      85: aload_3
      86: ldc           #103                // String java.naming.factory.initial
      88: aload         4
      90: invokevirtual #106                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      93: pop
      94: aload_3
      95: ldc           #107                // String java.naming.security.authentication
      97: invokevirtual #104                // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     100: astore        5
     102: aload         5
     104: ifnonnull     116
     107: aload_3
     108: ldc           #107                // String java.naming.security.authentication
     110: ldc           #108                // String simple
     112: invokevirtual #106                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
     115: pop
     116: aload_3
     117: ldc           #109                // String java.naming.security.protocol
     119: invokevirtual #104                // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     122: astore        6
     124: aload_0
     125: getfield      #8                  // Field options:Ljava/util/Map;
     128: ldc           #110                // String java.naming.provider.url
     130: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     135: checkcast     #24                 // class java/lang/String
     138: astore        7
     140: aload         7
     142: ifnonnull     187
     145: new           #52                 // class java/lang/StringBuilder
     148: dup
     149: invokespecial #53                 // Method java/lang/StringBuilder."<init>":()V
     152: ldc           #111                // String ldap://localhost:
     154: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     157: aload         6
     159: ifnull        177
     162: aload         6
     164: ldc           #112                // String ssl
     166: invokevirtual #113                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     169: ifeq          177
     172: ldc           #114                // String 636
     174: goto          179
     177: ldc           #115                // String 389
     179: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     182: invokevirtual #56                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     185: astore        7
     187: aload_3
     188: ldc           #110                // String java.naming.provider.url
     190: aload         7
     192: invokevirtual #106                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
     195: pop
     196: aload_0
     197: aload_0
     198: getfield      #8                  // Field options:Ljava/util/Map;
     201: ldc           #116                // String distinguishedNameAttribute
     203: invokeinterface #23,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     208: checkcast     #24                 // class java/lang/String
     211: putfield      #117                // Field distinguishedNameAttribute:Ljava/lang/String;
     214: aload_0
     215: getfield      #117                // Field distinguishedNameAttribute:Ljava/lang/String;
     218: ifnonnull     227
     221: aload_0
     222: ldc           #118                // String distinguishedName
     224: putfield      #117                // Field distinguishedNameAttribute:Ljava/lang/String;
     227: aload_1
     228: ifnull        239
     231: aload_3
     232: ldc           #119                // String java.naming.security.principal
     234: aload_1
     235: invokevirtual #106                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
     238: pop
     239: aload_2
     240: ifnull        251
     243: aload_3
     244: ldc           #120                // String java.naming.security.credentials
     246: aload_2
     247: invokevirtual #101                // Method java/util/Properties.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     250: pop
     251: aload_0
     252: aload_3
     253: invokespecial #121                // Method traceLDAPEnv:(Ljava/util/Properties;)V
     256: new           #122                // class javax/naming/ldap/InitialLdapContext
     259: dup
     260: aload_3
     261: aconst_null
     262: invokespecial #123                // Method javax/naming/ldap/InitialLdapContext."<init>":(Ljava/util/Hashtable;[Ljavax/naming/ldap/Control;)V
     265: areturn

  protected java.lang.String bindDNAuthentication(javax.naming.ldap.InitialLdapContext, java.lang.String, java.lang.Object, java.lang.String, java.lang.String) throws javax.naming.NamingException;
    Code:
       0: new           #37                 // class javax/naming/directory/SearchControls
       3: dup
       4: invokespecial #38                 // Method javax/naming/directory/SearchControls."<init>":()V
       7: astore        6
       9: aload         6
      11: iconst_2
      12: invokevirtual #39                 // Method javax/naming/directory/SearchControls.setSearchScope:(I)V
      15: aload         6
      17: aload_0
      18: getfield      #4                  // Field searchTimeLimit:I
      21: invokevirtual #40                 // Method javax/naming/directory/SearchControls.setTimeLimit:(I)V
      24: iconst_1
      25: anewarray     #24                 // class java/lang/String
      28: dup
      29: iconst_0
      30: aload_0
      31: getfield      #117                // Field distinguishedNameAttribute:Ljava/lang/String;
      34: aastore
      35: astore        7
      37: aload         6
      39: aload         7
      41: invokevirtual #124                // Method javax/naming/directory/SearchControls.setReturningAttributes:([Ljava/lang/String;)V
      44: aconst_null
      45: astore        8
      47: iconst_1
      48: anewarray     #41                 // class java/lang/Object
      51: dup
      52: iconst_0
      53: aload_2
      54: aastore
      55: astore        9
      57: aload_1
      58: aload         4
      60: aload         5
      62: aload         9
      64: aload         6
      66: invokevirtual #44                 // Method javax/naming/ldap/InitialLdapContext.search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;Ljavax/naming/directory/SearchControls;)Ljavax/naming/NamingEnumeration;
      69: astore        8
      71: aload         8
      73: invokeinterface #45,  1           // InterfaceMethod javax/naming/NamingEnumeration.hasMore:()Z
      78: ifne          99
      81: aload         8
      83: invokeinterface #125,  1          // InterfaceMethod javax/naming/NamingEnumeration.close:()V
      88: getstatic     #42                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      91: aload         4
      93: invokeinterface #47,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.failedToFindBaseContextDN:(Ljava/lang/String;)Ljavax/naming/NamingException;
      98: athrow
      99: aload         8
     101: invokeinterface #48,  1           // InterfaceMethod javax/naming/NamingEnumeration.next:()Ljava/lang/Object;
     106: checkcast     #49                 // class javax/naming/directory/SearchResult
     109: astore        10
     111: aload         10
     113: invokevirtual #50                 // Method javax/naming/directory/SearchResult.getName:()Ljava/lang/String;
     116: astore        11
     118: aconst_null
     119: astore        12
     121: aload         10
     123: invokevirtual #58                 // Method javax/naming/directory/SearchResult.getAttributes:()Ljavax/naming/directory/Attributes;
     126: astore        13
     128: aload         13
     130: ifnull        163
     133: aload         13
     135: aload_0
     136: getfield      #117                // Field distinguishedNameAttribute:Ljava/lang/String;
     139: invokeinterface #126,  2          // InterfaceMethod javax/naming/directory/Attributes.get:(Ljava/lang/String;)Ljavax/naming/directory/Attribute;
     144: astore        14
     146: aload         14
     148: ifnull        163
     151: aload         14
     153: invokeinterface #64,  1           // InterfaceMethod javax/naming/directory/Attribute.get:()Ljava/lang/Object;
     158: checkcast     #24                 // class java/lang/String
     161: astore        12
     163: aload         12
     165: ifnonnull     246
     168: aload         10
     170: invokevirtual #51                 // Method javax/naming/directory/SearchResult.isRelative:()Z
     173: iconst_1
     174: if_icmpne     235
     177: new           #52                 // class java/lang/StringBuilder
     180: dup
     181: invokespecial #53                 // Method java/lang/StringBuilder."<init>":()V
     184: aload         11
     186: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     189: ldc           #127                // String
     191: aload         4
     193: invokevirtual #113                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     196: ifeq          204
     199: ldc           #127                // String
     201: goto          224
     204: new           #52                 // class java/lang/StringBuilder
     207: dup
     208: invokespecial #53                 // Method java/lang/StringBuilder."<init>":()V
     211: ldc           #55                 // String ,
     213: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     216: aload         4
     218: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     221: invokevirtual #56                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     224: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     227: invokevirtual #56                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     230: astore        12
     232: goto          246
     235: getstatic     #42                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     238: aload         11
     240: invokeinterface #57,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.unableToFollowReferralForAuth:(Ljava/lang/String;)Ljavax/naming/NamingException;
     245: athrow
     246: aload_0
     247: aload         8
     249: invokevirtual #46                 // Method safeClose:(Ljavax/naming/NamingEnumeration;)V
     252: aconst_null
     253: astore        8
     255: aload_0
     256: aload         12
     258: aload_3
     259: invokespecial #28                 // Method constructInitialLdapContext:(Ljava/lang/String;Ljava/lang/Object;)Ljavax/naming/ldap/InitialLdapContext;
     262: astore        14
     264: aload_0
     265: aload         14
     267: invokevirtual #29                 // Method safeClose:(Ljavax/naming/ldap/InitialLdapContext;)V
     270: aload         12
     272: areturn

  private void traceLDAPEnv(java.util.Properties);
    Code:
       0: new           #92                 // class java/util/Properties
       3: dup
       4: invokespecial #93                 // Method java/util/Properties."<init>":()V
       7: astore_2
       8: aload_2
       9: aload_1
      10: invokevirtual #128                // Method java/util/Properties.putAll:(Ljava/util/Map;)V
      13: aload_2
      14: ldc           #120                // String java.naming.security.credentials
      16: invokevirtual #129                // Method java/util/Properties.containsKey:(Ljava/lang/Object;)Z
      19: ifeq          31
      22: aload_2
      23: ldc           #120                // String java.naming.security.credentials
      25: ldc           #130                // String ******
      27: invokevirtual #106                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      30: pop
      31: aload_2
      32: ldc           #75                 // String bindCredential
      34: invokevirtual #129                // Method java/util/Properties.containsKey:(Ljava/lang/Object;)Z
      37: ifeq          49
      40: aload_2
      41: ldc           #75                 // String bindCredential
      43: ldc           #130                // String ******
      45: invokevirtual #106                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      48: pop
      49: getstatic     #66                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      52: aload_2
      53: invokeinterface #131,  2          // InterfaceMethod org/jboss/security/PicketBoxLogger.traceLDAPConnectionEnv:(Ljava/util/Properties;)V
      58: return

  protected void safeClose(javax.naming.NamingEnumeration);
    Code:
       0: aload_1
       1: ifnull        14
       4: aload_1
       5: invokeinterface #125,  1          // InterfaceMethod javax/naming/NamingEnumeration.close:()V
      10: goto          14
      13: astore_2
      14: return
    Exception table:
       from    to  target type
           4    10    13   Class javax/naming/NamingException

  protected void safeClose(javax.naming.ldap.InitialLdapContext);
    Code:
       0: aload_1
       1: ifnull        12
       4: aload_1
       5: invokevirtual #132                // Method javax/naming/ldap/InitialLdapContext.close:()V
       8: goto          12
      11: astore_2
      12: return
    Exception table:
       from    to  target type
           4     8    11   Class javax/naming/NamingException
}
