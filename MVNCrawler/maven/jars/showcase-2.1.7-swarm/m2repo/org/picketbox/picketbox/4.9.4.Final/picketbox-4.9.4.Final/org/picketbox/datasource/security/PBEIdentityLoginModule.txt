Compiled from "PBEIdentityLoginModule.java"
public class org.picketbox.datasource.security.PBEIdentityLoginModule extends org.picketbox.datasource.security.AbstractPasswordCredentialLoginModule {
  private java.lang.String username;

  private java.lang.String password;

  private char[] pbepass;

  private java.lang.String pbealgo;

  private byte[] salt;

  private int iterationCount;

  private javax.crypto.spec.PBEParameterSpec cipherSpec;

  public org.picketbox.datasource.security.PBEIdentityLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/picketbox/datasource/security/AbstractPasswordCredentialLoginModule."<init>":()V
       4: aload_0
       5: ldc           #2                  // String jaas is the way
       7: invokevirtual #3                  // Method java/lang/String.toCharArray:()[C
      10: putfield      #4                  // Field pbepass:[C
      13: aload_0
      14: ldc           #5                  // String PBEwithMD5andDES
      16: putfield      #6                  // Field pbealgo:Ljava/lang/String;
      19: aload_0
      20: bipush        8
      22: newarray       byte
      24: dup
      25: iconst_0
      26: iconst_1
      27: bastore
      28: dup
      29: iconst_1
      30: bipush        7
      32: bastore
      33: dup
      34: iconst_2
      35: iconst_2
      36: bastore
      37: dup
      38: iconst_3
      39: bipush        9
      41: bastore
      42: dup
      43: iconst_4
      44: iconst_3
      45: bastore
      46: dup
      47: iconst_5
      48: bipush        11
      50: bastore
      51: dup
      52: bipush        6
      54: iconst_4
      55: bastore
      56: dup
      57: bipush        7
      59: bipush        13
      61: bastore
      62: putfield      #7                  // Field salt:[B
      65: aload_0
      66: bipush        37
      68: putfield      #8                  // Field iterationCount:I
      71: return

  org.picketbox.datasource.security.PBEIdentityLoginModule(java.lang.String, char[], byte[], int);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/picketbox/datasource/security/AbstractPasswordCredentialLoginModule."<init>":()V
       4: aload_0
       5: ldc           #2                  // String jaas is the way
       7: invokevirtual #3                  // Method java/lang/String.toCharArray:()[C
      10: putfield      #4                  // Field pbepass:[C
      13: aload_0
      14: ldc           #5                  // String PBEwithMD5andDES
      16: putfield      #6                  // Field pbealgo:Ljava/lang/String;
      19: aload_0
      20: bipush        8
      22: newarray       byte
      24: dup
      25: iconst_0
      26: iconst_1
      27: bastore
      28: dup
      29: iconst_1
      30: bipush        7
      32: bastore
      33: dup
      34: iconst_2
      35: iconst_2
      36: bastore
      37: dup
      38: iconst_3
      39: bipush        9
      41: bastore
      42: dup
      43: iconst_4
      44: iconst_3
      45: bastore
      46: dup
      47: iconst_5
      48: bipush        11
      50: bastore
      51: dup
      52: bipush        6
      54: iconst_4
      55: bastore
      56: dup
      57: bipush        7
      59: bipush        13
      61: bastore
      62: putfield      #7                  // Field salt:[B
      65: aload_0
      66: bipush        37
      68: putfield      #8                  // Field iterationCount:I
      71: aload_2
      72: ifnull        80
      75: aload_0
      76: aload_2
      77: putfield      #4                  // Field pbepass:[C
      80: aload_1
      81: ifnull        89
      84: aload_0
      85: aload_1
      86: putfield      #6                  // Field pbealgo:Ljava/lang/String;
      89: aload_3
      90: ifnull        98
      93: aload_0
      94: aload_3
      95: putfield      #7                  // Field salt:[B
      98: iload         4
     100: ifle          109
     103: aload_0
     104: iload         4
     106: putfield      #8                  // Field iterationCount:I
     109: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map<java.lang.String, ?>, java.util.Map<java.lang.String, ?>);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: invokespecial #9                  // Method org/picketbox/datasource/security/AbstractPasswordCredentialLoginModule.initialize:(Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;Ljava/util/Map;Ljava/util/Map;)V
       9: aload_0
      10: aload         4
      12: ldc           #10                 // String username
      14: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      19: checkcast     #12                 // class java/lang/String
      22: putfield      #13                 // Field username:Ljava/lang/String;
      25: aload_0
      26: getfield      #13                 // Field username:Ljava/lang/String;
      29: ifnonnull     73
      32: aload_0
      33: aload         4
      35: ldc           #14                 // String userName
      37: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      42: checkcast     #12                 // class java/lang/String
      45: putfield      #13                 // Field username:Ljava/lang/String;
      48: aload_0
      49: getfield      #13                 // Field username:Ljava/lang/String;
      52: ifnonnull     73
      55: new           #15                 // class java/lang/IllegalArgumentException
      58: dup
      59: getstatic     #16                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
      62: ldc           #10                 // String username
      64: invokeinterface #17,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.missingRequiredModuleOptionMessage:(Ljava/lang/String;)Ljava/lang/String;
      69: invokespecial #18                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      72: athrow
      73: aload_0
      74: aload         4
      76: ldc           #19                 // String password
      78: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      83: checkcast     #12                 // class java/lang/String
      86: putfield      #20                 // Field password:Ljava/lang/String;
      89: aload_0
      90: getfield      #20                 // Field password:Ljava/lang/String;
      93: ifnonnull     114
      96: new           #15                 // class java/lang/IllegalArgumentException
      99: dup
     100: getstatic     #16                 // Field org/jboss/security/PicketBoxMessages.MESSAGES:Lorg/jboss/security/PicketBoxMessages;
     103: ldc           #19                 // String password
     105: invokeinterface #17,  2           // InterfaceMethod org/jboss/security/PicketBoxMessages.missingRequiredModuleOptionMessage:(Ljava/lang/String;)Ljava/lang/String;
     110: invokespecial #18                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     113: athrow
     114: aload         4
     116: ldc           #21                 // String pbepass
     118: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     123: checkcast     #12                 // class java/lang/String
     126: astore        5
     128: aload         5
     130: ifnull        157
     133: aload_0
     134: aload         5
     136: invokestatic  #22                 // Method org/jboss/security/Util.loadPassword:(Ljava/lang/String;)[C
     139: putfield      #4                  // Field pbepass:[C
     142: goto          157
     145: astore        6
     147: new           #24                 // class java/lang/IllegalStateException
     150: dup
     151: aload         6
     153: invokespecial #25                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/Throwable;)V
     156: athrow
     157: aload         4
     159: ldc           #26                 // String pbealgo
     161: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     166: checkcast     #12                 // class java/lang/String
     169: astore        5
     171: aload         5
     173: ifnull        182
     176: aload_0
     177: aload         5
     179: putfield      #6                  // Field pbealgo:Ljava/lang/String;
     182: aload         4
     184: ldc           #27                 // String salt
     186: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     191: checkcast     #12                 // class java/lang/String
     194: astore        5
     196: aload         5
     198: ifnull        216
     201: aload_0
     202: aload         5
     204: iconst_0
     205: bipush        8
     207: invokevirtual #28                 // Method java/lang/String.substring:(II)Ljava/lang/String;
     210: invokevirtual #29                 // Method java/lang/String.getBytes:()[B
     213: putfield      #7                  // Field salt:[B
     216: aload         4
     218: ldc           #30                 // String iterationCount
     220: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     225: checkcast     #12                 // class java/lang/String
     228: astore        5
     230: aload         5
     232: ifnull        244
     235: aload_0
     236: aload         5
     238: invokestatic  #31                 // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
     241: putfield      #8                  // Field iterationCount:I
     244: return
    Exception table:
       from    to  target type
         133   142   145   Class java/lang/Exception

  public boolean login() throws javax.security.auth.login.LoginException;
    Code:
       0: getstatic     #32                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: invokeinterface #33,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginLogin:()V
       8: aload_0
       9: invokespecial #34                 // Method org/picketbox/datasource/security/AbstractPasswordCredentialLoginModule.login:()Z
      12: ifeq          17
      15: iconst_1
      16: ireturn
      17: aload_0
      18: iconst_1
      19: putfield      #35                 // Field org/picketbox/datasource/security/AbstractPasswordCredentialLoginModule.loginOk:Z
      22: iconst_1
      23: ireturn

  public boolean commit() throws javax.security.auth.login.LoginException;
    Code:
       0: new           #36                 // class org/jboss/security/SimplePrincipal
       3: dup
       4: aload_0
       5: getfield      #13                 // Field username:Ljava/lang/String;
       8: invokespecial #37                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
      11: astore_1
      12: aload_0
      13: getfield      #38                 // Field subject:Ljavax/security/auth/Subject;
      16: aload_1
      17: invokestatic  #39                 // Method org/picketbox/datasource/security/SubjectActions.addPrincipals:(Ljavax/security/auth/Subject;Ljava/security/Principal;)V
      20: aload_0
      21: getfield      #40                 // Field sharedState:Ljava/util/Map;
      24: ldc           #41                 // String javax.security.auth.login.name
      26: aload_0
      27: getfield      #13                 // Field username:Ljava/lang/String;
      30: invokeinterface #42,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      35: pop
      36: aload_0
      37: aload_0
      38: getfield      #20                 // Field password:Ljava/lang/String;
      41: invokespecial #43                 // Method decode:(Ljava/lang/String;)[C
      44: astore_2
      45: new           #44                 // class javax/resource/spi/security/PasswordCredential
      48: dup
      49: aload_0
      50: getfield      #13                 // Field username:Ljava/lang/String;
      53: aload_2
      54: invokespecial #45                 // Method javax/resource/spi/security/PasswordCredential."<init>":(Ljava/lang/String;[C)V
      57: astore_3
      58: aload_0
      59: getfield      #38                 // Field subject:Ljavax/security/auth/Subject;
      62: aload_3
      63: invokestatic  #46                 // Method org/picketbox/datasource/security/SubjectActions.addCredentials:(Ljavax/security/auth/Subject;Ljavax/resource/spi/security/PasswordCredential;)V
      66: goto          90
      69: astore_2
      70: new           #47                 // class javax/security/auth/login/LoginException
      73: dup
      74: aload_2
      75: invokevirtual #48                 // Method java/lang/Exception.getLocalizedMessage:()Ljava/lang/String;
      78: invokespecial #49                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      81: astore_3
      82: aload_3
      83: aload_2
      84: invokevirtual #50                 // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
      87: pop
      88: aload_3
      89: athrow
      90: iconst_1
      91: ireturn
    Exception table:
       from    to  target type
          36    66    69   Class java/lang/Exception

  public boolean abort();
    Code:
       0: aload_0
       1: aconst_null
       2: putfield      #13                 // Field username:Ljava/lang/String;
       5: aload_0
       6: aconst_null
       7: putfield      #20                 // Field password:Ljava/lang/String;
      10: iconst_1
      11: ireturn

  protected java.security.Principal getIdentity();
    Code:
       0: getstatic     #32                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
       3: aload_0
       4: getfield      #13                 // Field username:Ljava/lang/String;
       7: invokeinterface #51,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceBeginGetIdentity:(Ljava/lang/String;)V
      12: new           #36                 // class org/jboss/security/SimplePrincipal
      15: dup
      16: aload_0
      17: getfield      #13                 // Field username:Ljava/lang/String;
      20: invokespecial #37                 // Method org/jboss/security/SimplePrincipal."<init>":(Ljava/lang/String;)V
      23: astore_1
      24: aload_1
      25: areturn

  protected java.security.acl.Group[] getRoleSets() throws javax.security.auth.login.LoginException;
    Code:
       0: iconst_0
       1: anewarray     #52                 // class java/security/acl/Group
       4: areturn

  private java.lang.String encode(java.lang.String) throws java.lang.Exception;
    Code:
       0: aload_0
       1: new           #53                 // class javax/crypto/spec/PBEParameterSpec
       4: dup
       5: aload_0
       6: getfield      #7                  // Field salt:[B
       9: aload_0
      10: getfield      #8                  // Field iterationCount:I
      13: invokespecial #54                 // Method javax/crypto/spec/PBEParameterSpec."<init>":([BI)V
      16: putfield      #55                 // Field cipherSpec:Ljavax/crypto/spec/PBEParameterSpec;
      19: new           #56                 // class javax/crypto/spec/PBEKeySpec
      22: dup
      23: aload_0
      24: getfield      #4                  // Field pbepass:[C
      27: invokespecial #57                 // Method javax/crypto/spec/PBEKeySpec."<init>":([C)V
      30: astore_2
      31: aload_0
      32: getfield      #6                  // Field pbealgo:Ljava/lang/String;
      35: invokestatic  #58                 // Method javax/crypto/SecretKeyFactory.getInstance:(Ljava/lang/String;)Ljavax/crypto/SecretKeyFactory;
      38: astore_3
      39: aload_3
      40: aload_2
      41: invokevirtual #59                 // Method javax/crypto/SecretKeyFactory.generateSecret:(Ljava/security/spec/KeySpec;)Ljavax/crypto/SecretKey;
      44: astore        4
      46: aload_0
      47: getfield      #6                  // Field pbealgo:Ljava/lang/String;
      50: invokestatic  #60                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
      53: astore        5
      55: aload         5
      57: iconst_1
      58: aload         4
      60: aload_0
      61: getfield      #55                 // Field cipherSpec:Ljavax/crypto/spec/PBEParameterSpec;
      64: invokevirtual #62                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
      67: aload         5
      69: aload_1
      70: invokevirtual #29                 // Method java/lang/String.getBytes:()[B
      73: invokevirtual #63                 // Method javax/crypto/Cipher.doFinal:([B)[B
      76: astore        6
      78: aload         6
      80: invokestatic  #64                 // Method org/jboss/security/Base64Utils.tob64:([B)Ljava/lang/String;
      83: areturn

  private char[] decode(java.lang.String) throws java.lang.Exception;
    Code:
       0: aload_0
       1: new           #53                 // class javax/crypto/spec/PBEParameterSpec
       4: dup
       5: aload_0
       6: getfield      #7                  // Field salt:[B
       9: aload_0
      10: getfield      #8                  // Field iterationCount:I
      13: invokespecial #54                 // Method javax/crypto/spec/PBEParameterSpec."<init>":([BI)V
      16: putfield      #55                 // Field cipherSpec:Ljavax/crypto/spec/PBEParameterSpec;
      19: new           #56                 // class javax/crypto/spec/PBEKeySpec
      22: dup
      23: aload_0
      24: getfield      #4                  // Field pbepass:[C
      27: invokespecial #57                 // Method javax/crypto/spec/PBEKeySpec."<init>":([C)V
      30: astore_2
      31: aload_0
      32: getfield      #6                  // Field pbealgo:Ljava/lang/String;
      35: invokestatic  #58                 // Method javax/crypto/SecretKeyFactory.getInstance:(Ljava/lang/String;)Ljavax/crypto/SecretKeyFactory;
      38: astore_3
      39: aload_3
      40: aload_2
      41: invokevirtual #59                 // Method javax/crypto/SecretKeyFactory.generateSecret:(Ljava/security/spec/KeySpec;)Ljavax/crypto/SecretKey;
      44: astore        4
      46: aload_1
      47: invokestatic  #65                 // Method org/jboss/security/Base64Utils.fromb64:(Ljava/lang/String;)[B
      50: astore        5
      52: goto          108
      55: astore        6
      57: new           #66                 // class java/lang/StringBuilder
      60: dup
      61: invokespecial #67                 // Method java/lang/StringBuilder."<init>":()V
      64: ldc           #68                 // String 0
      66: invokevirtual #69                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      69: aload_1
      70: invokevirtual #69                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      73: invokevirtual #70                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      76: invokestatic  #65                 // Method org/jboss/security/Base64Utils.fromb64:(Ljava/lang/String;)[B
      79: astore        5
      81: getstatic     #32                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      84: new           #66                 // class java/lang/StringBuilder
      87: dup
      88: invokespecial #67                 // Method java/lang/StringBuilder."<init>":()V
      91: ldc           #68                 // String 0
      93: invokevirtual #69                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      96: aload_1
      97: invokevirtual #69                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     100: invokevirtual #70                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     103: invokeinterface #71,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.wrongBase64StringUsed:(Ljava/lang/String;)V
     108: aload_0
     109: getfield      #6                  // Field pbealgo:Ljava/lang/String;
     112: invokestatic  #60                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
     115: astore        6
     117: aload         6
     119: iconst_2
     120: aload         4
     122: aload_0
     123: getfield      #55                 // Field cipherSpec:Ljavax/crypto/spec/PBEParameterSpec;
     126: invokevirtual #62                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
     129: aload         6
     131: aload         5
     133: invokevirtual #63                 // Method javax/crypto/Cipher.doFinal:([B)[B
     136: astore        7
     138: new           #12                 // class java/lang/String
     141: dup
     142: aload         7
     144: invokespecial #72                 // Method java/lang/String."<init>":([B)V
     147: invokevirtual #3                  // Method java/lang/String.toCharArray:()[C
     150: areturn
    Exception table:
       from    to  target type
          46    52    55   Class java/lang/IllegalArgumentException

  public static void main(java.lang.String[]) throws java.lang.Exception;
    Code:
       0: aconst_null
       1: astore_1
       2: ldc           #2                  // String jaas is the way
       4: invokevirtual #3                  // Method java/lang/String.toCharArray:()[C
       7: astore_2
       8: aconst_null
       9: astore_3
      10: iconst_m1
      11: istore        4
      13: aload_0
      14: arraylength
      15: iconst_2
      16: if_icmplt     26
      19: aload_0
      20: iconst_1
      21: aaload
      22: invokevirtual #3                  // Method java/lang/String.toCharArray:()[C
      25: astore_2
      26: aload_0
      27: arraylength
      28: iconst_3
      29: if_icmplt     39
      32: aload_0
      33: iconst_2
      34: aaload
      35: invokevirtual #29                 // Method java/lang/String.getBytes:()[B
      38: astore_3
      39: aload_0
      40: arraylength
      41: iconst_4
      42: if_icmplt     56
      45: aload_0
      46: iconst_3
      47: aaload
      48: invokestatic  #73                 // Method java/lang/Integer.decode:(Ljava/lang/String;)Ljava/lang/Integer;
      51: invokevirtual #74                 // Method java/lang/Integer.intValue:()I
      54: istore        4
      56: aload_0
      57: arraylength
      58: iconst_5
      59: if_icmplt     66
      62: aload_0
      63: iconst_4
      64: aaload
      65: astore_1
      66: new           #75                 // class org/picketbox/datasource/security/PBEIdentityLoginModule
      69: dup
      70: aload_1
      71: aload_2
      72: aload_3
      73: iload         4
      75: invokespecial #76                 // Method "<init>":(Ljava/lang/String;[C[BI)V
      78: astore        5
      80: aload         5
      82: aload_0
      83: iconst_0
      84: aaload
      85: invokespecial #77                 // Method encode:(Ljava/lang/String;)Ljava/lang/String;
      88: astore        6
      90: getstatic     #78                 // Field java/lang/System.out:Ljava/io/PrintStream;
      93: new           #66                 // class java/lang/StringBuilder
      96: dup
      97: invokespecial #67                 // Method java/lang/StringBuilder."<init>":()V
     100: ldc           #79                 // String Encoded password:
     102: invokevirtual #69                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     105: aload         6
     107: invokevirtual #69                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     110: invokevirtual #70                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     113: invokevirtual #80                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V
     116: return
}
