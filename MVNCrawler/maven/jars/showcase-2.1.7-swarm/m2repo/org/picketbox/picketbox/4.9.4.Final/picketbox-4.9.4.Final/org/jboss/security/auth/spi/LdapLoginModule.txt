Compiled from "LdapLoginModule.java"
public class org.jboss.security.auth.spi.LdapLoginModule extends org.jboss.security.auth.spi.UsernamePasswordLoginModule {
  private static final java.lang.String PRINCIPAL_DN_PREFIX_OPT;

  private static final java.lang.String PRINCIPAL_DN_SUFFIX_OPT;

  private static final java.lang.String ROLES_CTX_DN_OPT;

  private static final java.lang.String USER_ROLES_CTX_DN_ATTRIBUTE_ID_OPT;

  private static final java.lang.String UID_ATTRIBUTE_ID_OPT;

  private static final java.lang.String ROLE_ATTRIBUTE_ID_OPT;

  private static final java.lang.String MATCH_ON_USER_DN_OPT;

  private static final java.lang.String ROLE_ATTRIBUTE_IS_DN_OPT;

  private static final java.lang.String ROLE_NAME_ATTRIBUTE_ID_OPT;

  private static final java.lang.String SEARCH_TIME_LIMIT_OPT;

  private static final java.lang.String SEARCH_SCOPE_OPT;

  private static final java.lang.String SECURITY_DOMAIN_OPT;

  private static final java.lang.String ALLOW_EMPTY_PASSWORDS;

  private static final java.lang.String[] ALL_VALID_OPTIONS;

  private transient org.jboss.security.SimpleGroup userRoles;

  public org.jboss.security.auth.spi.LdapLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jboss/security/auth/spi/UsernamePasswordLoginModule."<init>":()V
       4: aload_0
       5: new           #2                  // class org/jboss/security/SimpleGroup
       8: dup
       9: ldc           #3                  // String Roles
      11: invokespecial #4                  // Method org/jboss/security/SimpleGroup."<init>":(Ljava/lang/String;)V
      14: putfield      #5                  // Field userRoles:Lorg/jboss/security/SimpleGroup;
      17: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map<java.lang.String, ?>, java.util.Map<java.lang.String, ?>);
    Code:
       0: aload_0
       1: getstatic     #6                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
       4: invokevirtual #7                  // Method addValidOptions:([Ljava/lang/String;)V
       7: aload_0
       8: aload_1
       9: aload_2
      10: aload_3
      11: aload         4
      13: invokespecial #8                  // Method org/jboss/security/auth/spi/UsernamePasswordLoginModule.initialize:(Ljavax/security/auth/Subject;Ljavax/security/auth/callback/CallbackHandler;Ljava/util/Map;Ljava/util/Map;)V
      16: return

  protected java.lang.String getUsersPassword() throws javax.security.auth.login.LoginException;
    Code:
       0: ldc           #9                  // String
       2: areturn

  protected java.security.acl.Group[] getRoleSets() throws javax.security.auth.login.LoginException;
    Code:
       0: iconst_1
       1: anewarray     #10                 // class java/security/acl/Group
       4: dup
       5: iconst_0
       6: aload_0
       7: getfield      #5                  // Field userRoles:Lorg/jboss/security/SimpleGroup;
      10: aastore
      11: astore_1
      12: aload_1
      13: areturn

  protected boolean validatePassword(java.lang.String, java.lang.String);
    Code:
       0: iconst_0
       1: istore_3
       2: aload_1
       3: ifnull        88
       6: aload_1
       7: invokevirtual #11                 // Method java/lang/String.length:()I
      10: ifne          62
      13: iconst_0
      14: istore        4
      16: aload_0
      17: getfield      #12                 // Field options:Ljava/util/Map;
      20: ldc           #14                 // String allowEmptyPasswords
      22: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      27: checkcast     #16                 // class java/lang/String
      30: astore        5
      32: aload         5
      34: ifnull        47
      37: aload         5
      39: invokestatic  #17                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
      42: invokevirtual #18                 // Method java/lang/Boolean.booleanValue:()Z
      45: istore        4
      47: iload         4
      49: ifne          62
      52: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      55: invokeinterface #20,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceRejectingEmptyPassword:()V
      60: iconst_0
      61: ireturn
      62: aload_0
      63: invokevirtual #21                 // Method getUsername:()Ljava/lang/String;
      66: astore        4
      68: aload_0
      69: aload         4
      71: aload_1
      72: invokespecial #22                 // Method createLdapInitContext:(Ljava/lang/String;Ljava/lang/Object;)V
      75: iconst_1
      76: istore_3
      77: goto          88
      80: astore        4
      82: aload_0
      83: aload         4
      85: invokespecial #24                 // Method org/jboss/security/auth/spi/UsernamePasswordLoginModule.setValidateError:(Ljava/lang/Throwable;)V
      88: iload_3
      89: ireturn
    Exception table:
       from    to  target type
          62    77    80   Class java/lang/Throwable

  private void createLdapInitContext(java.lang.String, java.lang.Object) throws java.lang.Exception;
    Code:
       0: new           #25                 // class java/util/Properties
       3: dup
       4: invokespecial #26                 // Method java/util/Properties."<init>":()V
       7: astore_3
       8: aload_0
       9: getfield      #12                 // Field options:Ljava/util/Map;
      12: invokeinterface #27,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
      17: invokeinterface #28,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      22: astore        4
      24: aload         4
      26: invokeinterface #29,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      31: ifeq          68
      34: aload         4
      36: invokeinterface #30,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      41: checkcast     #31                 // class java/util/Map$Entry
      44: astore        5
      46: aload_3
      47: aload         5
      49: invokeinterface #32,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
      54: aload         5
      56: invokeinterface #33,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
      61: invokevirtual #34                 // Method java/util/Properties.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      64: pop
      65: goto          24
      68: aload_3
      69: ldc           #36                 // String java.naming.factory.initial
      71: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      74: astore        5
      76: aload         5
      78: ifnonnull     94
      81: ldc           #38                 // String com.sun.jndi.ldap.LdapCtxFactory
      83: astore        5
      85: aload_3
      86: ldc           #36                 // String java.naming.factory.initial
      88: aload         5
      90: invokevirtual #39                 // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      93: pop
      94: aload_3
      95: ldc           #40                 // String java.naming.security.authentication
      97: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     100: astore        6
     102: aload         6
     104: ifnonnull     116
     107: aload_3
     108: ldc           #40                 // String java.naming.security.authentication
     110: ldc           #41                 // String simple
     112: invokevirtual #39                 // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
     115: pop
     116: aload_3
     117: ldc           #42                 // String java.naming.security.protocol
     119: invokevirtual #37                 // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     122: astore        7
     124: aload_0
     125: getfield      #12                 // Field options:Ljava/util/Map;
     128: ldc           #43                 // String java.naming.provider.url
     130: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     135: checkcast     #16                 // class java/lang/String
     138: astore        8
     140: aload         8
     142: ifnonnull     187
     145: new           #44                 // class java/lang/StringBuilder
     148: dup
     149: invokespecial #45                 // Method java/lang/StringBuilder."<init>":()V
     152: ldc           #46                 // String ldap://localhost:
     154: invokevirtual #47                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     157: aload         7
     159: ifnull        177
     162: aload         7
     164: ldc           #48                 // String ssl
     166: invokevirtual #49                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     169: ifeq          177
     172: ldc           #50                 // String 636
     174: goto          179
     177: ldc           #51                 // String 389
     179: invokevirtual #47                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     182: invokevirtual #52                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     185: astore        8
     187: aload_0
     188: getfield      #12                 // Field options:Ljava/util/Map;
     191: ldc           #53                 // String java.naming.security.principal
     193: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     198: checkcast     #16                 // class java/lang/String
     201: astore        9
     203: aload_0
     204: getfield      #12                 // Field options:Ljava/util/Map;
     207: ldc           #54                 // String java.naming.security.credentials
     209: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     214: checkcast     #16                 // class java/lang/String
     217: astore        10
     219: aload_0
     220: getfield      #12                 // Field options:Ljava/util/Map;
     223: ldc           #55                 // String jaasSecurityDomain
     225: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     230: checkcast     #16                 // class java/lang/String
     233: astore        11
     235: aload         11
     237: ifnull        271
     240: new           #56                 // class javax/management/ObjectName
     243: dup
     244: aload         11
     246: invokespecial #57                 // Method javax/management/ObjectName."<init>":(Ljava/lang/String;)V
     249: astore        12
     251: aload         10
     253: aload         12
     255: invokestatic  #58                 // Method org/jboss/security/auth/spi/DecodeAction.decode:(Ljava/lang/String;Ljavax/management/ObjectName;)[C
     258: astore        13
     260: new           #16                 // class java/lang/String
     263: dup
     264: aload         13
     266: invokespecial #59                 // Method java/lang/String."<init>":([C)V
     269: astore        10
     271: aload         10
     273: ifnull        291
     276: aload         10
     278: invokestatic  #60                 // Method org/jboss/security/vault/SecurityVaultUtil.isVaultFormat:(Ljava/lang/String;)Z
     281: ifeq          291
     284: aload         10
     286: invokestatic  #61                 // Method org/jboss/security/vault/SecurityVaultUtil.getValueAsString:(Ljava/lang/String;)Ljava/lang/String;
     289: astore        10
     291: aload_0
     292: getfield      #12                 // Field options:Ljava/util/Map;
     295: ldc           #62                 // String principalDNPrefix
     297: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     302: checkcast     #16                 // class java/lang/String
     305: astore        12
     307: aload         12
     309: ifnonnull     316
     312: ldc           #9                  // String
     314: astore        12
     316: aload_0
     317: getfield      #12                 // Field options:Ljava/util/Map;
     320: ldc           #63                 // String principalDNSuffix
     322: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     327: checkcast     #16                 // class java/lang/String
     330: astore        13
     332: aload         13
     334: ifnonnull     341
     337: ldc           #9                  // String
     339: astore        13
     341: aload_0
     342: getfield      #12                 // Field options:Ljava/util/Map;
     345: ldc           #64                 // String matchOnUserDN
     347: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     352: checkcast     #16                 // class java/lang/String
     355: astore        14
     357: aload         14
     359: invokestatic  #17                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     362: invokevirtual #18                 // Method java/lang/Boolean.booleanValue:()Z
     365: istore        15
     367: new           #44                 // class java/lang/StringBuilder
     370: dup
     371: invokespecial #45                 // Method java/lang/StringBuilder."<init>":()V
     374: aload         12
     376: invokevirtual #47                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     379: aload_1
     380: invokevirtual #47                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     383: aload         13
     385: invokevirtual #47                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     388: invokevirtual #52                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     391: astore        16
     393: aload_3
     394: ldc           #43                 // String java.naming.provider.url
     396: aload         8
     398: invokevirtual #39                 // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
     401: pop
     402: aload_3
     403: ldc           #53                 // String java.naming.security.principal
     405: aload         16
     407: invokevirtual #39                 // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
     410: pop
     411: aload_3
     412: ldc           #54                 // String java.naming.security.credentials
     414: aload_2
     415: invokevirtual #34                 // Method java/util/Properties.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     418: pop
     419: aload_0
     420: aload_3
     421: invokespecial #65                 // Method traceLDAPEnv:(Ljava/util/Properties;)V
     424: aconst_null
     425: astore        17
     427: invokestatic  #66                 // Method org/jboss/security/auth/spi/SecurityActions.getContextClassLoader:()Ljava/lang/ClassLoader;
     430: astore        18
     432: aload         18
     434: ifnull        442
     437: aconst_null
     438: invokestatic  #67                 // Method org/jboss/security/auth/spi/SecurityActions.setContextClassLoader:(Ljava/lang/ClassLoader;)Ljava/lang/Void;
     441: pop
     442: new           #68                 // class javax/naming/ldap/InitialLdapContext
     445: dup
     446: aload_3
     447: aconst_null
     448: invokespecial #69                 // Method javax/naming/ldap/InitialLdapContext."<init>":(Ljava/util/Hashtable;[Ljavax/naming/ldap/Control;)V
     451: astore        17
     453: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     456: invokeinterface #70,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.isTraceEnabled:()Z
     461: ifeq          477
     464: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     467: aload         17
     469: invokevirtual #71                 // Method java/lang/Object.toString:()Ljava/lang/String;
     472: invokeinterface #72,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceSuccessfulLogInToLDAP:(Ljava/lang/String;)V
     477: aload         9
     479: ifnull        541
     482: aload         17
     484: invokevirtual #73                 // Method javax/naming/ldap/InitialLdapContext.close:()V
     487: goto          502
     490: astore        19
     492: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     495: aload         19
     497: invokeinterface #75,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.warnProblemClosingOriginalLdapContextDuringRebind:(Ljavax/naming/NamingException;)V
     502: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     505: aload         9
     507: invokeinterface #76,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceRebindWithConfiguredPrincipal:(Ljava/lang/String;)V
     512: aload_3
     513: ldc           #53                 // String java.naming.security.principal
     515: aload         9
     517: invokevirtual #39                 // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
     520: pop
     521: aload_3
     522: ldc           #54                 // String java.naming.security.credentials
     524: aload         10
     526: invokevirtual #34                 // Method java/util/Properties.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     529: pop
     530: new           #68                 // class javax/naming/ldap/InitialLdapContext
     533: dup
     534: aload_3
     535: aconst_null
     536: invokespecial #69                 // Method javax/naming/ldap/InitialLdapContext."<init>":(Ljava/util/Hashtable;[Ljavax/naming/ldap/Control;)V
     539: astore        17
     541: aload_0
     542: getfield      #12                 // Field options:Ljava/util/Map;
     545: ldc           #77                 // String rolesCtxDN
     547: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     552: checkcast     #16                 // class java/lang/String
     555: astore        19
     557: aload_0
     558: getfield      #12                 // Field options:Ljava/util/Map;
     561: ldc           #78                 // String userRolesCtxDNAttributeName
     563: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     568: checkcast     #16                 // class java/lang/String
     571: astore        20
     573: aload         20
     575: ifnull        660
     578: iconst_1
     579: anewarray     #16                 // class java/lang/String
     582: dup
     583: iconst_0
     584: aload         20
     586: aastore
     587: astore        21
     589: aload         17
     591: aload         16
     593: aload         21
     595: invokevirtual #79                 // Method javax/naming/ldap/InitialLdapContext.getAttributes:(Ljava/lang/String;[Ljava/lang/String;)Ljavax/naming/directory/Attributes;
     598: astore        22
     600: aload         22
     602: aload         20
     604: invokeinterface #80,  2           // InterfaceMethod javax/naming/directory/Attributes.get:(Ljava/lang/String;)Ljavax/naming/directory/Attribute;
     609: ifnull        641
     612: aload         22
     614: aload         20
     616: invokeinterface #80,  2           // InterfaceMethod javax/naming/directory/Attributes.get:(Ljava/lang/String;)Ljavax/naming/directory/Attribute;
     621: invokeinterface #81,  1           // InterfaceMethod javax/naming/directory/Attribute.get:()Ljava/lang/Object;
     626: invokevirtual #71                 // Method java/lang/Object.toString:()Ljava/lang/String;
     629: astore        19
     631: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     634: aload         19
     636: invokeinterface #82,  2           // InterfaceMethod org/jboss/security/PicketBoxLogger.traceFoundUserRolesContextDN:(Ljava/lang/String;)V
     641: goto          660
     644: astore        22
     646: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     649: aload         20
     651: aload         16
     653: aload         22
     655: invokeinterface #83,  4           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailureToQueryLDAPAttribute:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
     660: aload         19
     662: ifnull        1338
     665: aload_0
     666: getfield      #12                 // Field options:Ljava/util/Map;
     669: ldc           #84                 // String uidAttributeID
     671: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     676: checkcast     #16                 // class java/lang/String
     679: astore        21
     681: aload         21
     683: ifnonnull     690
     686: ldc           #85                 // String uid
     688: astore        21
     690: aload_0
     691: getfield      #12                 // Field options:Ljava/util/Map;
     694: ldc           #86                 // String roleAttributeID
     696: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     701: checkcast     #16                 // class java/lang/String
     704: astore        22
     706: aload         22
     708: ifnonnull     715
     711: ldc           #87                 // String roles
     713: astore        22
     715: new           #88                 // class java/lang/StringBuffer
     718: dup
     719: ldc           #89                 // String (
     721: invokespecial #90                 // Method java/lang/StringBuffer."<init>":(Ljava/lang/String;)V
     724: astore        23
     726: aload         23
     728: aload         21
     730: invokevirtual #91                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     733: pop
     734: aload         23
     736: ldc           #92                 // String ={0})
     738: invokevirtual #91                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     741: pop
     742: aload_1
     743: astore        24
     745: iload         15
     747: iconst_1
     748: if_icmpne     755
     751: aload         16
     753: astore        24
     755: iconst_1
     756: anewarray     #16                 // class java/lang/String
     759: dup
     760: iconst_0
     761: aload         22
     763: aastore
     764: astore        25
     766: aload_0
     767: getfield      #12                 // Field options:Ljava/util/Map;
     770: ldc           #93                 // String roleAttributeIsDN
     772: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     777: checkcast     #16                 // class java/lang/String
     780: astore        26
     782: aload         26
     784: invokestatic  #17                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
     787: invokevirtual #18                 // Method java/lang/Boolean.booleanValue:()Z
     790: istore        27
     792: aload_0
     793: getfield      #12                 // Field options:Ljava/util/Map;
     796: ldc           #94                 // String roleNameAttributeID
     798: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     803: checkcast     #16                 // class java/lang/String
     806: astore        28
     808: aload         28
     810: ifnonnull     817
     813: ldc           #95                 // String name
     815: astore        28
     817: iconst_2
     818: istore        29
     820: sipush        10000
     823: istore        30
     825: aload_0
     826: getfield      #12                 // Field options:Ljava/util/Map;
     829: ldc           #97                 // String searchTimeLimit
     831: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     836: checkcast     #16                 // class java/lang/String
     839: astore        31
     841: aload         31
     843: ifnull        871
     846: aload         31
     848: invokestatic  #98                 // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
     851: istore        30
     853: goto          871
     856: astore        32
     858: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     861: ldc           #97                 // String searchTimeLimit
     863: iload         30
     865: i2l
     866: invokeinterface #100,  4          // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailureToParseNumberProperty:(Ljava/lang/String;J)V
     871: aload_0
     872: getfield      #12                 // Field options:Ljava/util/Map;
     875: ldc           #101                // String searchScope
     877: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     882: checkcast     #16                 // class java/lang/String
     885: astore        32
     887: ldc           #102                // String OBJECT_SCOPE
     889: aload         32
     891: invokevirtual #103                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     894: ifeq          903
     897: iconst_0
     898: istore        29
     900: goto          916
     903: ldc           #104                // String ONELEVEL_SCOPE
     905: aload         32
     907: invokevirtual #103                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     910: ifeq          916
     913: iconst_1
     914: istore        29
     916: ldc           #105                // String SUBTREE_SCOPE
     918: aload         32
     920: invokevirtual #103                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     923: ifeq          929
     926: iconst_2
     927: istore        29
     929: aconst_null
     930: astore        33
     932: new           #96                 // class javax/naming/directory/SearchControls
     935: dup
     936: invokespecial #106                // Method javax/naming/directory/SearchControls."<init>":()V
     939: astore        34
     941: aload         34
     943: iload         29
     945: invokevirtual #107                // Method javax/naming/directory/SearchControls.setSearchScope:(I)V
     948: aload         34
     950: aload         25
     952: invokevirtual #108                // Method javax/naming/directory/SearchControls.setReturningAttributes:([Ljava/lang/String;)V
     955: aload         34
     957: iload         30
     959: invokevirtual #109                // Method javax/naming/directory/SearchControls.setTimeLimit:(I)V
     962: iconst_1
     963: anewarray     #110                // class java/lang/Object
     966: dup
     967: iconst_0
     968: aload         24
     970: aastore
     971: astore        35
     973: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     976: invokeinterface #70,  1           // InterfaceMethod org/jboss/security/PicketBoxLogger.isTraceEnabled:()Z
     981: ifeq          1010
     984: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
     987: aload         19
     989: aload         23
     991: invokevirtual #111                // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
     994: aload         24
     996: aload         25
     998: invokestatic  #112                // Method java/util/Arrays.toString:([Ljava/lang/Object;)Ljava/lang/String;
    1001: iload         29
    1003: iload         30
    1005: invokeinterface #113,  7          // InterfaceMethod org/jboss/security/PicketBoxLogger.traceRolesDNSearch:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;II)V
    1010: aload         17
    1012: aload         19
    1014: aload         23
    1016: invokevirtual #111                // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
    1019: aload         35
    1021: aload         34
    1023: invokevirtual #114                // Method javax/naming/ldap/InitialLdapContext.search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;Ljavax/naming/directory/SearchControls;)Ljavax/naming/NamingEnumeration;
    1026: astore        33
    1028: aload         33
    1030: invokeinterface #115,  1          // InterfaceMethod javax/naming/NamingEnumeration.hasMore:()Z
    1035: ifeq          1279
    1038: aload         33
    1040: invokeinterface #116,  1          // InterfaceMethod javax/naming/NamingEnumeration.next:()Ljava/lang/Object;
    1045: checkcast     #117                // class javax/naming/directory/SearchResult
    1048: astore        36
    1050: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
    1053: aload         36
    1055: invokevirtual #118                // Method javax/naming/directory/SearchResult.getName:()Ljava/lang/String;
    1058: invokeinterface #119,  2          // InterfaceMethod org/jboss/security/PicketBoxLogger.traceCheckSearchResult:(Ljava/lang/String;)V
    1063: aload         36
    1065: invokevirtual #120                // Method javax/naming/directory/SearchResult.getAttributes:()Ljavax/naming/directory/Attributes;
    1068: astore        37
    1070: aload         37
    1072: aload         22
    1074: invokeinterface #80,  2           // InterfaceMethod javax/naming/directory/Attributes.get:(Ljava/lang/String;)Ljavax/naming/directory/Attribute;
    1079: astore        38
    1081: aload         38
    1083: ifnull        1261
    1086: iconst_0
    1087: istore        39
    1089: iload         39
    1091: aload         38
    1093: invokeinterface #121,  1          // InterfaceMethod javax/naming/directory/Attribute.size:()I
    1098: if_icmpge     1258
    1101: aload         38
    1103: iload         39
    1105: invokeinterface #122,  2          // InterfaceMethod javax/naming/directory/Attribute.get:(I)Ljava/lang/Object;
    1110: astore        40
    1112: aconst_null
    1113: astore        41
    1115: iload         27
    1117: iconst_1
    1118: if_icmpne     1239
    1121: aload         40
    1123: invokevirtual #71                 // Method java/lang/Object.toString:()Ljava/lang/String;
    1126: astore        42
    1128: iconst_1
    1129: anewarray     #16                 // class java/lang/String
    1132: dup
    1133: iconst_0
    1134: aload         28
    1136: aastore
    1137: astore        43
    1139: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
    1142: aload         42
    1144: invokeinterface #123,  2          // InterfaceMethod org/jboss/security/PicketBoxLogger.traceFollowRoleDN:(Ljava/lang/String;)V
    1149: aload         17
    1151: aload         42
    1153: aload         43
    1155: invokevirtual #79                 // Method javax/naming/ldap/InitialLdapContext.getAttributes:(Ljava/lang/String;[Ljava/lang/String;)Ljavax/naming/directory/Attributes;
    1158: astore        44
    1160: aload         44
    1162: aload         28
    1164: invokeinterface #80,  2           // InterfaceMethod javax/naming/directory/Attributes.get:(Ljava/lang/String;)Ljavax/naming/directory/Attribute;
    1169: astore        45
    1171: aload         45
    1173: ifnull        1217
    1176: iconst_0
    1177: istore        46
    1179: iload         46
    1181: aload         45
    1183: invokeinterface #121,  1          // InterfaceMethod javax/naming/directory/Attribute.size:()I
    1188: if_icmpge     1217
    1191: aload         45
    1193: iload         46
    1195: invokeinterface #122,  2          // InterfaceMethod javax/naming/directory/Attribute.get:(I)Ljava/lang/Object;
    1200: checkcast     #16                 // class java/lang/String
    1203: astore        41
    1205: aload_0
    1206: aload         41
    1208: invokespecial #124                // Method addRole:(Ljava/lang/String;)V
    1211: iinc          46, 1
    1214: goto          1179
    1217: goto          1236
    1220: astore        44
    1222: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
    1225: aload         28
    1227: aload         42
    1229: aload         44
    1231: invokeinterface #83,  4           // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailureToQueryLDAPAttribute:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
    1236: goto          1252
    1239: aload         40
    1241: invokevirtual #71                 // Method java/lang/Object.toString:()Ljava/lang/String;
    1244: astore        41
    1246: aload_0
    1247: aload         41
    1249: invokespecial #124                // Method addRole:(Ljava/lang/String;)V
    1252: iinc          39, 1
    1255: goto          1089
    1258: goto          1276
    1261: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
    1264: aload         22
    1266: aload         36
    1268: invokevirtual #118                // Method javax/naming/directory/SearchResult.getName:()Ljava/lang/String;
    1271: invokeinterface #125,  3          // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailureToFindAttrInSearchResult:(Ljava/lang/String;Ljava/lang/String;)V
    1276: goto          1028
    1279: aload         33
    1281: ifnull        1338
    1284: aload         33
    1286: invokeinterface #126,  1          // InterfaceMethod javax/naming/NamingEnumeration.close:()V
    1291: goto          1338
    1294: astore        34
    1296: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
    1299: aload         34
    1301: invokeinterface #127,  2          // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailureToExecuteRolesDNSearch:(Ljava/lang/Throwable;)V
    1306: aload         33
    1308: ifnull        1338
    1311: aload         33
    1313: invokeinterface #126,  1          // InterfaceMethod javax/naming/NamingEnumeration.close:()V
    1318: goto          1338
    1321: astore        47
    1323: aload         33
    1325: ifnull        1335
    1328: aload         33
    1330: invokeinterface #126,  1          // InterfaceMethod javax/naming/NamingEnumeration.close:()V
    1335: aload         47
    1337: athrow
    1338: aload         17
    1340: ifnull        1348
    1343: aload         17
    1345: invokevirtual #73                 // Method javax/naming/ldap/InitialLdapContext.close:()V
    1348: aload         18
    1350: ifnull        1388
    1353: aload         18
    1355: invokestatic  #67                 // Method org/jboss/security/auth/spi/SecurityActions.setContextClassLoader:(Ljava/lang/ClassLoader;)Ljava/lang/Void;
    1358: pop
    1359: goto          1388
    1362: astore        48
    1364: aload         17
    1366: ifnull        1374
    1369: aload         17
    1371: invokevirtual #73                 // Method javax/naming/ldap/InitialLdapContext.close:()V
    1374: aload         18
    1376: ifnull        1385
    1379: aload         18
    1381: invokestatic  #67                 // Method org/jboss/security/auth/spi/SecurityActions.setContextClassLoader:(Ljava/lang/ClassLoader;)Ljava/lang/Void;
    1384: pop
    1385: aload         48
    1387: athrow
    1388: return
    Exception table:
       from    to  target type
         482   487   490   Class javax/naming/NamingException
         589   641   644   Class javax/naming/NamingException
         846   853   856   Class java/lang/NumberFormatException
        1149  1217  1220   Class javax/naming/NamingException
         932  1279  1294   Class javax/naming/NamingException
         932  1279  1321   any
        1294  1306  1321   any
        1321  1323  1321   any
         432  1338  1362   any
        1362  1364  1362   any

  private void addRole(java.lang.String);
    Code:
       0: aload_1
       1: ifnull        42
       4: aload_0
       5: aload_1
       6: invokespecial #128                // Method org/jboss/security/auth/spi/UsernamePasswordLoginModule.createIdentity:(Ljava/lang/String;)Ljava/security/Principal;
       9: astore_2
      10: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      13: aload_1
      14: invokeinterface #129,  2          // InterfaceMethod org/jboss/security/PicketBoxLogger.traceAssignUserToRole:(Ljava/lang/String;)V
      19: aload_0
      20: getfield      #5                  // Field userRoles:Lorg/jboss/security/SimpleGroup;
      23: aload_2
      24: invokevirtual #130                // Method org/jboss/security/SimpleGroup.addMember:(Ljava/security/Principal;)Z
      27: pop
      28: goto          42
      31: astore_2
      32: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      35: aload_1
      36: aload_2
      37: invokeinterface #132,  3          // InterfaceMethod org/jboss/security/PicketBoxLogger.debugFailureToCreatePrincipal:(Ljava/lang/String;Ljava/lang/Throwable;)V
      42: return
    Exception table:
       from    to  target type
           4    28    31   Class java/lang/Exception

  private void traceLDAPEnv(java.util.Properties);
    Code:
       0: new           #25                 // class java/util/Properties
       3: dup
       4: invokespecial #26                 // Method java/util/Properties."<init>":()V
       7: astore_2
       8: aload_2
       9: aload_1
      10: invokevirtual #133                // Method java/util/Properties.putAll:(Ljava/util/Map;)V
      13: aload_2
      14: ldc           #54                 // String java.naming.security.credentials
      16: invokevirtual #134                // Method java/util/Properties.containsKey:(Ljava/lang/Object;)Z
      19: ifeq          31
      22: aload_2
      23: ldc           #54                 // String java.naming.security.credentials
      25: ldc           #135                // String ******
      27: invokevirtual #39                 // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      30: pop
      31: getstatic     #19                 // Field org/jboss/security/PicketBoxLogger.LOGGER:Lorg/jboss/security/PicketBoxLogger;
      34: aload_2
      35: invokeinterface #136,  2          // InterfaceMethod org/jboss/security/PicketBoxLogger.traceLDAPConnectionEnv:(Ljava/util/Properties;)V
      40: return

  static {};
    Code:
       0: bipush        28
       2: anewarray     #16                 // class java/lang/String
       5: dup
       6: iconst_0
       7: ldc           #62                 // String principalDNPrefix
       9: aastore
      10: dup
      11: iconst_1
      12: ldc           #63                 // String principalDNSuffix
      14: aastore
      15: dup
      16: iconst_2
      17: ldc           #77                 // String rolesCtxDN
      19: aastore
      20: dup
      21: iconst_3
      22: ldc           #78                 // String userRolesCtxDNAttributeName
      24: aastore
      25: dup
      26: iconst_4
      27: ldc           #84                 // String uidAttributeID
      29: aastore
      30: dup
      31: iconst_5
      32: ldc           #86                 // String roleAttributeID
      34: aastore
      35: dup
      36: bipush        6
      38: ldc           #64                 // String matchOnUserDN
      40: aastore
      41: dup
      42: bipush        7
      44: ldc           #93                 // String roleAttributeIsDN
      46: aastore
      47: dup
      48: bipush        8
      50: ldc           #94                 // String roleNameAttributeID
      52: aastore
      53: dup
      54: bipush        9
      56: ldc           #97                 // String searchTimeLimit
      58: aastore
      59: dup
      60: bipush        10
      62: ldc           #101                // String searchScope
      64: aastore
      65: dup
      66: bipush        11
      68: ldc           #55                 // String jaasSecurityDomain
      70: aastore
      71: dup
      72: bipush        12
      74: ldc           #14                 // String allowEmptyPasswords
      76: aastore
      77: dup
      78: bipush        13
      80: ldc           #36                 // String java.naming.factory.initial
      82: aastore
      83: dup
      84: bipush        14
      86: ldc           #137                // String java.naming.factory.object
      88: aastore
      89: dup
      90: bipush        15
      92: ldc           #138                // String java.naming.factory.state
      94: aastore
      95: dup
      96: bipush        16
      98: ldc           #139                // String java.naming.factory.url.pkgs
     100: aastore
     101: dup
     102: bipush        17
     104: ldc           #43                 // String java.naming.provider.url
     106: aastore
     107: dup
     108: bipush        18
     110: ldc           #140                // String java.naming.dns.url
     112: aastore
     113: dup
     114: bipush        19
     116: ldc           #141                // String java.naming.authoritative
     118: aastore
     119: dup
     120: bipush        20
     122: ldc           #142                // String java.naming.batchsize
     124: aastore
     125: dup
     126: bipush        21
     128: ldc           #143                // String java.naming.referral
     130: aastore
     131: dup
     132: bipush        22
     134: ldc           #42                 // String java.naming.security.protocol
     136: aastore
     137: dup
     138: bipush        23
     140: ldc           #40                 // String java.naming.security.authentication
     142: aastore
     143: dup
     144: bipush        24
     146: ldc           #53                 // String java.naming.security.principal
     148: aastore
     149: dup
     150: bipush        25
     152: ldc           #54                 // String java.naming.security.credentials
     154: aastore
     155: dup
     156: bipush        26
     158: ldc           #144                // String java.naming.language
     160: aastore
     161: dup
     162: bipush        27
     164: ldc           #145                // String java.naming.applet
     166: aastore
     167: putstatic     #6                  // Field ALL_VALID_OPTIONS:[Ljava/lang/String;
     170: return
}
