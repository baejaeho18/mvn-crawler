Compiled from "BaseSignatureTrustEngine.java"
public abstract class org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine<TrustBasisType> implements org.opensaml.xmlsec.signature.support.SignatureTrustEngine {
  private final org.slf4j.Logger log;

  private final org.opensaml.xmlsec.keyinfo.KeyInfoCredentialResolver keyInfoCredentialResolver;

  public org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine(org.opensaml.xmlsec.keyinfo.KeyInfoCredentialResolver);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc_w         #2                  // class org/opensaml/xmlsec/signature/support/impl/BaseSignatureTrustEngine
       8: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      11: putfield      #4                  // Field log:Lorg/slf4j/Logger;
      14: aload_0
      15: aload_1
      16: ldc           #5                  // String KeyInfo credential resolver cannot be null
      18: invokestatic  #6                  // Method net/shibboleth/utilities/java/support/logic/Constraint.isNotNull:(Ljava/lang/Object;Ljava/lang/String;)Ljava/lang/Object;
      21: checkcast     #7                  // class org/opensaml/xmlsec/keyinfo/KeyInfoCredentialResolver
      24: putfield      #8                  // Field keyInfoCredentialResolver:Lorg/opensaml/xmlsec/keyinfo/KeyInfoCredentialResolver;
      27: return

  public org.opensaml.xmlsec.keyinfo.KeyInfoCredentialResolver getKeyInfoResolver();
    Code:
       0: aload_0
       1: getfield      #8                  // Field keyInfoCredentialResolver:Lorg/opensaml/xmlsec/keyinfo/KeyInfoCredentialResolver;
       4: areturn

  public final boolean validate(org.opensaml.xmlsec.signature.Signature, net.shibboleth.utilities.java.support.resolver.CriteriaSet) throws org.opensaml.security.SecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokevirtual #9                  // Method checkParams:(Lorg/opensaml/xmlsec/signature/Signature;Lnet/shibboleth/utilities/java/support/resolver/CriteriaSet;)V
       6: aload_2
       7: ldc_w         #10                 // class org/opensaml/xmlsec/signature/support/SignatureValidationParametersCriterion
      10: invokevirtual #11                 // Method net/shibboleth/utilities/java/support/resolver/CriteriaSet.get:(Ljava/lang/Class;)Ljava/lang/Object;
      13: checkcast     #10                 // class org/opensaml/xmlsec/signature/support/SignatureValidationParametersCriterion
      16: astore_3
      17: aload_3
      18: ifnull        69
      21: aload_0
      22: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      25: ldc           #12                 // String Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
      27: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      32: new           #14                 // class org/opensaml/xmlsec/signature/support/impl/SignatureAlgorithmValidator
      35: dup
      36: aload_3
      37: invokevirtual #15                 // Method org/opensaml/xmlsec/signature/support/SignatureValidationParametersCriterion.getSignatureValidationParameters:()Lorg/opensaml/xmlsec/SignatureValidationParameters;
      40: invokespecial #16                 // Method org/opensaml/xmlsec/signature/support/impl/SignatureAlgorithmValidator."<init>":(Lorg/opensaml/xmlsec/SignatureValidationParameters;)V
      43: astore        4
      45: aload         4
      47: aload_1
      48: invokevirtual #17                 // Method org/opensaml/xmlsec/signature/support/impl/SignatureAlgorithmValidator.validate:(Lorg/opensaml/xmlsec/signature/Signature;)V
      51: goto          69
      54: astore        5
      56: aload_0
      57: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      60: ldc           #19                 // String XML signature failed algorithm whitelist/blacklist validation
      62: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      67: iconst_0
      68: ireturn
      69: aload_0
      70: aload_1
      71: aload_2
      72: invokevirtual #21                 // Method doValidate:(Lorg/opensaml/xmlsec/signature/Signature;Lnet/shibboleth/utilities/java/support/resolver/CriteriaSet;)Z
      75: ireturn
    Exception table:
       from    to  target type
          45    51    54   Class org/opensaml/xmlsec/signature/support/SignatureException

  protected abstract boolean doValidate(org.opensaml.xmlsec.signature.Signature, net.shibboleth.utilities.java.support.resolver.CriteriaSet) throws org.opensaml.security.SecurityException;

  public final boolean validate(byte[], byte[], java.lang.String, net.shibboleth.utilities.java.support.resolver.CriteriaSet, org.opensaml.security.credential.Credential) throws org.opensaml.security.SecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: invokevirtual #22                 // Method checkParamsRaw:([B[BLjava/lang/String;Lnet/shibboleth/utilities/java/support/resolver/CriteriaSet;)V
       9: aload         4
      11: ldc_w         #10                 // class org/opensaml/xmlsec/signature/support/SignatureValidationParametersCriterion
      14: invokevirtual #11                 // Method net/shibboleth/utilities/java/support/resolver/CriteriaSet.get:(Ljava/lang/Class;)Ljava/lang/Object;
      17: checkcast     #10                 // class org/opensaml/xmlsec/signature/support/SignatureValidationParametersCriterion
      20: astore        6
      22: aload         6
      24: ifnull        75
      27: aload_0
      28: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      31: ldc           #12                 // String Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
      33: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      38: aload         6
      40: invokevirtual #15                 // Method org/opensaml/xmlsec/signature/support/SignatureValidationParametersCriterion.getSignatureValidationParameters:()Lorg/opensaml/xmlsec/SignatureValidationParameters;
      43: astore        7
      45: aload_3
      46: aload         7
      48: invokevirtual #23                 // Method org/opensaml/xmlsec/SignatureValidationParameters.getWhitelistedAlgorithms:()Ljava/util/Collection;
      51: aload         7
      53: invokevirtual #24                 // Method org/opensaml/xmlsec/SignatureValidationParameters.getBlacklistedAlgorithms:()Ljava/util/Collection;
      56: invokestatic  #25                 // Method org/opensaml/xmlsec/algorithm/AlgorithmSupport.validateAlgorithmURI:(Ljava/lang/String;Ljava/util/Collection;Ljava/util/Collection;)Z
      59: ifne          75
      62: aload_0
      63: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      66: ldc           #26                 // String Simple/raw signature failed algorithm whitelist/blacklist validation
      68: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      73: iconst_0
      74: ireturn
      75: aload_0
      76: aload_1
      77: aload_2
      78: aload_3
      79: aload         4
      81: aload         5
      83: invokevirtual #27                 // Method doValidate:([B[BLjava/lang/String;Lnet/shibboleth/utilities/java/support/resolver/CriteriaSet;Lorg/opensaml/security/credential/Credential;)Z
      86: ireturn

  protected abstract boolean doValidate(byte[], byte[], java.lang.String, net.shibboleth.utilities.java.support.resolver.CriteriaSet, org.opensaml.security.credential.Credential) throws org.opensaml.security.SecurityException;

  protected boolean validate(org.opensaml.xmlsec.signature.Signature, TrustBasisType) throws org.opensaml.security.SecurityException;
    Code:
       0: aload_0
       1: getfield      #4                  // Field log:Lorg/slf4j/Logger;
       4: ldc           #28                 // String Attempting to verify signature and establish trust using KeyInfo-derived credentials
       6: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      11: aload_1
      12: invokeinterface #29,  1           // InterfaceMethod org/opensaml/xmlsec/signature/Signature.getKeyInfo:()Lorg/opensaml/xmlsec/signature/KeyInfo;
      17: ifnull        180
      20: new           #30                 // class org/opensaml/xmlsec/keyinfo/KeyInfoCriterion
      23: dup
      24: aload_1
      25: invokeinterface #29,  1           // InterfaceMethod org/opensaml/xmlsec/signature/Signature.getKeyInfo:()Lorg/opensaml/xmlsec/signature/KeyInfo;
      30: invokespecial #31                 // Method org/opensaml/xmlsec/keyinfo/KeyInfoCriterion."<init>":(Lorg/opensaml/xmlsec/signature/KeyInfo;)V
      33: astore_3
      34: new           #32                 // class net/shibboleth/utilities/java/support/resolver/CriteriaSet
      37: dup
      38: iconst_1
      39: anewarray     #33                 // class net/shibboleth/utilities/java/support/resolver/Criterion
      42: dup
      43: iconst_0
      44: aload_3
      45: aastore
      46: invokespecial #34                 // Method net/shibboleth/utilities/java/support/resolver/CriteriaSet."<init>":([Lnet/shibboleth/utilities/java/support/resolver/Criterion;)V
      49: astore        4
      51: aload_0
      52: invokevirtual #35                 // Method getKeyInfoResolver:()Lorg/opensaml/xmlsec/keyinfo/KeyInfoCredentialResolver;
      55: aload         4
      57: invokeinterface #36,  2           // InterfaceMethod org/opensaml/xmlsec/keyinfo/KeyInfoCredentialResolver.resolve:(Ljava/lang/Object;)Ljava/lang/Iterable;
      62: invokeinterface #37,  1           // InterfaceMethod java/lang/Iterable.iterator:()Ljava/util/Iterator;
      67: astore        5
      69: aload         5
      71: invokeinterface #38,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      76: ifeq          160
      79: aload         5
      81: invokeinterface #39,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      86: checkcast     #40                 // class org/opensaml/security/credential/Credential
      89: astore        6
      91: aload_0
      92: aload_1
      93: aload         6
      95: invokevirtual #41                 // Method verifySignature:(Lorg/opensaml/xmlsec/signature/Signature;Lorg/opensaml/security/credential/Credential;)Z
      98: ifeq          157
     101: aload_0
     102: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     105: ldc           #42                 // String Successfully verified signature using KeyInfo-derived credential
     107: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     112: aload_0
     113: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     116: ldc           #43                 // String Attempting to establish trust of KeyInfo-derived credential
     118: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     123: aload_0
     124: aload         6
     126: aload_2
     127: invokevirtual #44                 // Method evaluateTrust:(Lorg/opensaml/security/credential/Credential;Ljava/lang/Object;)Z
     130: ifeq          146
     133: aload_0
     134: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     137: ldc           #45                 // String Successfully established trust of KeyInfo-derived credential
     139: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     144: iconst_1
     145: ireturn
     146: aload_0
     147: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     150: ldc           #46                 // String Failed to establish trust of KeyInfo-derived credential
     152: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     157: goto          69
     160: goto          177
     163: astore        5
     165: new           #48                 // class org/opensaml/security/SecurityException
     168: dup
     169: ldc           #49                 // String Error resolving KeyInfo from KeyInfoResolver
     171: aload         5
     173: invokespecial #50                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;Ljava/lang/Exception;)V
     176: athrow
     177: goto          191
     180: aload_0
     181: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     184: ldc           #51                 // String Signature contained no KeyInfo element, could not resolve verification credentials
     186: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     191: aload_0
     192: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     195: ldc           #52                 // String Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
     197: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     202: iconst_0
     203: ireturn
    Exception table:
       from    to  target type
          51   145   163   Class net/shibboleth/utilities/java/support/resolver/ResolverException
         146   160   163   Class net/shibboleth/utilities/java/support/resolver/ResolverException

  protected abstract boolean evaluateTrust(org.opensaml.security.credential.Credential, TrustBasisType) throws org.opensaml.security.SecurityException;

  protected boolean verifySignature(org.opensaml.xmlsec.signature.Signature, org.opensaml.security.credential.Credential);
    Code:
       0: aload_1
       1: aload_2
       2: invokestatic  #53                 // Method org/opensaml/xmlsec/signature/support/SignatureValidator.validate:(Lorg/opensaml/xmlsec/signature/Signature;Lorg/opensaml/security/credential/Credential;)V
       5: goto          23
       8: astore_3
       9: aload_0
      10: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      13: ldc           #54                 // String Signature validation using candidate validation credential failed
      15: aload_3
      16: invokeinterface #55,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
      21: iconst_0
      22: ireturn
      23: aload_0
      24: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      27: ldc           #56                 // String Signature validation using candidate credential was successful
      29: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      34: iconst_1
      35: ireturn
    Exception table:
       from    to  target type
           0     5     8   Class org/opensaml/xmlsec/signature/support/SignatureException

  protected void checkParams(org.opensaml.xmlsec.signature.Signature, net.shibboleth.utilities.java.support.resolver.CriteriaSet) throws org.opensaml.security.SecurityException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #48                 // class org/opensaml/security/SecurityException
       7: dup
       8: ldc           #57                 // String Signature cannot be null
      10: invokespecial #58                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;)V
      13: athrow
      14: aload_2
      15: ifnonnull     28
      18: new           #48                 // class org/opensaml/security/SecurityException
      21: dup
      22: ldc           #59                 // String Trust basis criteria set cannot be null
      24: invokespecial #58                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;)V
      27: athrow
      28: aload_2
      29: invokevirtual #60                 // Method net/shibboleth/utilities/java/support/resolver/CriteriaSet.isEmpty:()Z
      32: ifeq          45
      35: new           #48                 // class org/opensaml/security/SecurityException
      38: dup
      39: ldc           #61                 // String Trust basis criteria set cannot be empty
      41: invokespecial #58                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;)V
      44: athrow
      45: return

  protected void checkParamsRaw(byte[], byte[], java.lang.String, net.shibboleth.utilities.java.support.resolver.CriteriaSet) throws org.opensaml.security.SecurityException;
    Code:
       0: aload_1
       1: ifnull        9
       4: aload_1
       5: arraylength
       6: ifne          19
       9: new           #48                 // class org/opensaml/security/SecurityException
      12: dup
      13: ldc           #62                 // String Signature byte array cannot be null or empty
      15: invokespecial #58                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;)V
      18: athrow
      19: aload_2
      20: ifnull        28
      23: aload_2
      24: arraylength
      25: ifne          38
      28: new           #48                 // class org/opensaml/security/SecurityException
      31: dup
      32: ldc           #63                 // String Content byte array cannot be null or empty
      34: invokespecial #58                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;)V
      37: athrow
      38: aload_3
      39: invokestatic  #64                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      42: ifeq          55
      45: new           #48                 // class org/opensaml/security/SecurityException
      48: dup
      49: ldc           #65                 // String Signature algorithm cannot be null or empty
      51: invokespecial #58                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;)V
      54: athrow
      55: aload         4
      57: ifnonnull     70
      60: new           #48                 // class org/opensaml/security/SecurityException
      63: dup
      64: ldc           #59                 // String Trust basis criteria set cannot be null
      66: invokespecial #58                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;)V
      69: athrow
      70: aload         4
      72: invokevirtual #60                 // Method net/shibboleth/utilities/java/support/resolver/CriteriaSet.isEmpty:()Z
      75: ifeq          88
      78: new           #48                 // class org/opensaml/security/SecurityException
      81: dup
      82: ldc           #61                 // String Trust basis criteria set cannot be empty
      84: invokespecial #58                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;)V
      87: athrow
      88: return

  public boolean validate(java.lang.Object, net.shibboleth.utilities.java.support.resolver.CriteriaSet) throws org.opensaml.security.SecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: checkcast     #66                 // class org/opensaml/xmlsec/signature/Signature
       5: aload_2
       6: invokevirtual #67                 // Method validate:(Lorg/opensaml/xmlsec/signature/Signature;Lnet/shibboleth/utilities/java/support/resolver/CriteriaSet;)Z
       9: ireturn
}
