Compiled from "PKIXSignatureTrustEngine.java"
public class org.opensaml.xmlsec.signature.support.impl.PKIXSignatureTrustEngine extends org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine<net.shibboleth.utilities.java.support.collection.Pair<java.util.Set<java.lang.String>, java.lang.Iterable<org.opensaml.security.x509.PKIXValidationInformation>>> implements org.opensaml.security.x509.PKIXTrustEngine<org.opensaml.xmlsec.signature.Signature> {
  private final org.slf4j.Logger log;

  private final org.opensaml.security.x509.PKIXValidationInformationResolver pkixResolver;

  private final org.opensaml.security.x509.PKIXTrustEvaluator pkixTrustEvaluator;

  private final org.opensaml.security.x509.impl.X509CredentialNameEvaluator credNameEvaluator;

  public org.opensaml.xmlsec.signature.support.impl.PKIXSignatureTrustEngine(org.opensaml.security.x509.PKIXValidationInformationResolver, org.opensaml.xmlsec.keyinfo.KeyInfoCredentialResolver);
    Code:
       0: aload_0
       1: aload_2
       2: invokespecial #1                  // Method org/opensaml/xmlsec/signature/support/impl/BaseSignatureTrustEngine."<init>":(Lorg/opensaml/xmlsec/keyinfo/KeyInfoCredentialResolver;)V
       5: aload_0
       6: ldc_w         #2                  // class org/opensaml/xmlsec/signature/support/impl/PKIXSignatureTrustEngine
       9: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      12: putfield      #4                  // Field log:Lorg/slf4j/Logger;
      15: aload_0
      16: aload_1
      17: ldc           #5                  // String PKIX trust information resolver cannot be null
      19: invokestatic  #6                  // Method net/shibboleth/utilities/java/support/logic/Constraint.isNotNull:(Ljava/lang/Object;Ljava/lang/String;)Ljava/lang/Object;
      22: checkcast     #7                  // class org/opensaml/security/x509/PKIXValidationInformationResolver
      25: putfield      #8                  // Field pkixResolver:Lorg/opensaml/security/x509/PKIXValidationInformationResolver;
      28: aload_0
      29: new           #9                  // class org/opensaml/security/x509/impl/CertPathPKIXTrustEvaluator
      32: dup
      33: invokespecial #10                 // Method org/opensaml/security/x509/impl/CertPathPKIXTrustEvaluator."<init>":()V
      36: putfield      #11                 // Field pkixTrustEvaluator:Lorg/opensaml/security/x509/PKIXTrustEvaluator;
      39: aload_0
      40: new           #12                 // class org/opensaml/security/x509/impl/BasicX509CredentialNameEvaluator
      43: dup
      44: invokespecial #13                 // Method org/opensaml/security/x509/impl/BasicX509CredentialNameEvaluator."<init>":()V
      47: putfield      #14                 // Field credNameEvaluator:Lorg/opensaml/security/x509/impl/X509CredentialNameEvaluator;
      50: return

  public org.opensaml.xmlsec.signature.support.impl.PKIXSignatureTrustEngine(org.opensaml.security.x509.PKIXValidationInformationResolver, org.opensaml.xmlsec.keyinfo.KeyInfoCredentialResolver, org.opensaml.security.x509.PKIXTrustEvaluator, org.opensaml.security.x509.impl.X509CredentialNameEvaluator);
    Code:
       0: aload_0
       1: aload_2
       2: invokespecial #1                  // Method org/opensaml/xmlsec/signature/support/impl/BaseSignatureTrustEngine."<init>":(Lorg/opensaml/xmlsec/keyinfo/KeyInfoCredentialResolver;)V
       5: aload_0
       6: ldc_w         #2                  // class org/opensaml/xmlsec/signature/support/impl/PKIXSignatureTrustEngine
       9: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      12: putfield      #4                  // Field log:Lorg/slf4j/Logger;
      15: aload_0
      16: aload_1
      17: ldc           #5                  // String PKIX trust information resolver cannot be null
      19: invokestatic  #6                  // Method net/shibboleth/utilities/java/support/logic/Constraint.isNotNull:(Ljava/lang/Object;Ljava/lang/String;)Ljava/lang/Object;
      22: checkcast     #7                  // class org/opensaml/security/x509/PKIXValidationInformationResolver
      25: putfield      #8                  // Field pkixResolver:Lorg/opensaml/security/x509/PKIXValidationInformationResolver;
      28: aload_0
      29: aload_3
      30: ldc           #15                 // String PKIX trust evaluator cannot be null
      32: invokestatic  #6                  // Method net/shibboleth/utilities/java/support/logic/Constraint.isNotNull:(Ljava/lang/Object;Ljava/lang/String;)Ljava/lang/Object;
      35: checkcast     #16                 // class org/opensaml/security/x509/PKIXTrustEvaluator
      38: putfield      #11                 // Field pkixTrustEvaluator:Lorg/opensaml/security/x509/PKIXTrustEvaluator;
      41: aload_0
      42: aload         4
      44: putfield      #14                 // Field credNameEvaluator:Lorg/opensaml/security/x509/impl/X509CredentialNameEvaluator;
      47: return

  public org.opensaml.security.x509.PKIXTrustEvaluator getPKIXTrustEvaluator();
    Code:
       0: aload_0
       1: getfield      #11                 // Field pkixTrustEvaluator:Lorg/opensaml/security/x509/PKIXTrustEvaluator;
       4: areturn

  public org.opensaml.security.x509.impl.X509CredentialNameEvaluator getX509CredentialNameEvaluator();
    Code:
       0: aload_0
       1: getfield      #14                 // Field credNameEvaluator:Lorg/opensaml/security/x509/impl/X509CredentialNameEvaluator;
       4: areturn

  public org.opensaml.security.x509.PKIXValidationInformationResolver getPKIXResolver();
    Code:
       0: aload_0
       1: getfield      #8                  // Field pkixResolver:Lorg/opensaml/security/x509/PKIXValidationInformationResolver;
       4: areturn

  protected boolean doValidate(org.opensaml.xmlsec.signature.Signature, net.shibboleth.utilities.java.support.resolver.CriteriaSet) throws org.opensaml.security.SecurityException;
    Code:
       0: aload_0
       1: aload_2
       2: invokevirtual #17                 // Method resolveValidationInfo:(Lnet/shibboleth/utilities/java/support/resolver/CriteriaSet;)Lnet/shibboleth/utilities/java/support/collection/Pair;
       5: astore_3
       6: aload_0
       7: aload_1
       8: aload_3
       9: invokevirtual #18                 // Method validate:(Lorg/opensaml/xmlsec/signature/Signature;Ljava/lang/Object;)Z
      12: ifeq          17
      15: iconst_1
      16: ireturn
      17: aload_0
      18: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      21: ldc           #19                 // String PKIX validation of signature failed, unable to resolve valid and trusted signing key
      23: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      28: iconst_0
      29: ireturn

  protected boolean doValidate(byte[], byte[], java.lang.String, net.shibboleth.utilities.java.support.resolver.CriteriaSet, org.opensaml.security.credential.Credential) throws org.opensaml.security.SecurityException;
    Code:
       0: aload         5
       2: ifnull        13
       5: aload         5
       7: invokestatic  #21                 // Method org/opensaml/security/credential/CredentialSupport.extractVerificationKey:(Lorg/opensaml/security/credential/Credential;)Ljava/security/Key;
      10: ifnonnull     37
      13: aload_0
      14: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      17: ldc           #22                 // String Candidate credential was either not supplied or did not contain verification key
      19: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      24: aload_0
      25: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      28: ldc           #23                 // String PKIX trust engine requires supplied key, skipping PKIX trust evaluation
      30: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      35: iconst_0
      36: ireturn
      37: aload_0
      38: aload         4
      40: invokevirtual #17                 // Method resolveValidationInfo:(Lnet/shibboleth/utilities/java/support/resolver/CriteriaSet;)Lnet/shibboleth/utilities/java/support/collection/Pair;
      43: astore        6
      45: aload         5
      47: aload_3
      48: aload_1
      49: aload_2
      50: invokestatic  #24                 // Method org/opensaml/xmlsec/crypto/XMLSigningUtil.verifyWithURI:(Lorg/opensaml/security/credential/Credential;Ljava/lang/String;[B[B)Z
      53: ifeq          116
      56: aload_0
      57: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      60: ldc           #25                 // String Successfully verified raw signature using supplied candidate credential
      62: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      67: aload_0
      68: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      71: ldc           #26                 // String Attempting to establish trust of supplied candidate credential
      73: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      78: aload_0
      79: aload         5
      81: aload         6
      83: invokevirtual #27                 // Method evaluateTrust:(Lorg/opensaml/security/credential/Credential;Lnet/shibboleth/utilities/java/support/collection/Pair;)Z
      86: ifeq          102
      89: aload_0
      90: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      93: ldc           #28                 // String Successfully established trust of supplied candidate credential
      95: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     100: iconst_1
     101: ireturn
     102: aload_0
     103: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     106: ldc           #29                 // String Failed to establish trust of supplied candidate credential
     108: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     113: goto          127
     116: aload_0
     117: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     120: ldc           #30                 // String Cryptographic verification of raw signature failed with candidate credential
     122: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     127: goto          132
     130: astore        7
     132: aload_0
     133: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     136: ldc           #32                 // String PKIX validation of raw signature failed, unable to establish trust of supplied verification credential
     138: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     143: iconst_0
     144: ireturn
    Exception table:
       from    to  target type
          45   101   130   Class org/opensaml/security/SecurityException
         102   127   130   Class org/opensaml/security/SecurityException

  protected boolean evaluateTrust(org.opensaml.security.credential.Credential, net.shibboleth.utilities.java.support.collection.Pair<java.util.Set<java.lang.String>, java.lang.Iterable<org.opensaml.security.x509.PKIXValidationInformation>>) throws org.opensaml.security.SecurityException;
    Code:
       0: aload_1
       1: instanceof    #33                 // class org/opensaml/security/x509/X509Credential
       4: ifne          20
       7: aload_0
       8: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      11: ldc           #34                 // String Can not evaluate trust of non-X509Credential
      13: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      18: iconst_0
      19: ireturn
      20: aload_1
      21: checkcast     #33                 // class org/opensaml/security/x509/X509Credential
      24: astore_3
      25: aload_2
      26: invokevirtual #35                 // Method net/shibboleth/utilities/java/support/collection/Pair.getFirst:()Ljava/lang/Object;
      29: checkcast     #36                 // class java/util/Set
      32: astore        4
      34: aload_2
      35: invokevirtual #37                 // Method net/shibboleth/utilities/java/support/collection/Pair.getSecond:()Ljava/lang/Object;
      38: checkcast     #38                 // class java/lang/Iterable
      41: astore        5
      43: aload         5
      45: ifnonnull     61
      48: aload_0
      49: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      52: ldc           #39                 // String PKIX validation information not available. Aborting PKIX validation
      54: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      59: iconst_0
      60: ireturn
      61: aload_0
      62: aload         4
      64: aload_3
      65: invokevirtual #40                 // Method checkNames:(Ljava/util/Set;Lorg/opensaml/security/x509/X509Credential;)Z
      68: ifne          84
      71: aload_0
      72: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      75: ldc           #41                 // String Evaluation of credential against trusted names failed. Aborting PKIX validation
      77: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      82: iconst_0
      83: ireturn
      84: aload         5
      86: invokeinterface #42,  1           // InterfaceMethod java/lang/Iterable.iterator:()Ljava/util/Iterator;
      91: astore        6
      93: aload         6
      95: invokeinterface #43,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     100: ifeq          164
     103: aload         6
     105: invokeinterface #44,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     110: checkcast     #45                 // class org/opensaml/security/x509/PKIXValidationInformation
     113: astore        7
     115: aload_0
     116: getfield      #11                 // Field pkixTrustEvaluator:Lorg/opensaml/security/x509/PKIXTrustEvaluator;
     119: aload         7
     121: aload_3
     122: invokeinterface #46,  3           // InterfaceMethod org/opensaml/security/x509/PKIXTrustEvaluator.validate:(Lorg/opensaml/security/x509/PKIXValidationInformation;Lorg/opensaml/security/x509/X509Credential;)Z
     127: ifeq          143
     130: aload_0
     131: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     134: ldc           #47                 // String Signature trust established via PKIX validation of signing credential
     136: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     141: iconst_1
     142: ireturn
     143: goto          161
     146: astore        8
     148: aload_0
     149: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     152: ldc           #48                 // String Error performing PKIX validation on untrusted credential
     154: aload         8
     156: invokeinterface #49,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
     161: goto          93
     164: aload_0
     165: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     168: ldc           #50                 // String Signature trust could not be established via PKIX validation of signing credential
     170: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     175: iconst_0
     176: ireturn
    Exception table:
       from    to  target type
         115   142   146   Class org/opensaml/security/SecurityException

  protected net.shibboleth.utilities.java.support.collection.Pair<java.util.Set<java.lang.String>, java.lang.Iterable<org.opensaml.security.x509.PKIXValidationInformation>> resolveValidationInfo(net.shibboleth.utilities.java.support.resolver.CriteriaSet) throws org.opensaml.security.SecurityException;
    Code:
       0: aconst_null
       1: astore_2
       2: aload_0
       3: getfield      #8                  // Field pkixResolver:Lorg/opensaml/security/x509/PKIXValidationInformationResolver;
       6: invokeinterface #51,  1           // InterfaceMethod org/opensaml/security/x509/PKIXValidationInformationResolver.supportsTrustedNameResolution:()Z
      11: ifeq          52
      14: aload_0
      15: getfield      #8                  // Field pkixResolver:Lorg/opensaml/security/x509/PKIXValidationInformationResolver;
      18: aload_1
      19: invokeinterface #52,  2           // InterfaceMethod org/opensaml/security/x509/PKIXValidationInformationResolver.resolveTrustedNames:(Lnet/shibboleth/utilities/java/support/resolver/CriteriaSet;)Ljava/util/Set;
      24: astore_2
      25: goto          63
      28: astore_3
      29: new           #31                 // class org/opensaml/security/SecurityException
      32: dup
      33: ldc           #54                 // String Error resolving trusted names
      35: aload_3
      36: invokespecial #55                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;Ljava/lang/Exception;)V
      39: athrow
      40: astore_3
      41: new           #31                 // class org/opensaml/security/SecurityException
      44: dup
      45: ldc           #54                 // String Error resolving trusted names
      47: aload_3
      48: invokespecial #55                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;Ljava/lang/Exception;)V
      51: athrow
      52: aload_0
      53: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      56: ldc           #57                 // String PKIX resolver does not support resolution of trusted names, skipping name checking
      58: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      63: aload_0
      64: getfield      #8                  // Field pkixResolver:Lorg/opensaml/security/x509/PKIXValidationInformationResolver;
      67: aload_1
      68: invokeinterface #58,  2           // InterfaceMethod org/opensaml/security/x509/PKIXValidationInformationResolver.resolve:(Ljava/lang/Object;)Ljava/lang/Iterable;
      73: astore_3
      74: goto          91
      77: astore        4
      79: new           #31                 // class org/opensaml/security/SecurityException
      82: dup
      83: ldc           #59                 // String Error resolving trusted PKIX validation information
      85: aload         4
      87: invokespecial #55                 // Method org/opensaml/security/SecurityException."<init>":(Ljava/lang/String;Ljava/lang/Exception;)V
      90: athrow
      91: new           #60                 // class net/shibboleth/utilities/java/support/collection/Pair
      94: dup
      95: aload_2
      96: aload_3
      97: invokespecial #61                 // Method net/shibboleth/utilities/java/support/collection/Pair."<init>":(Ljava/lang/Object;Ljava/lang/Object;)V
     100: areturn
    Exception table:
       from    to  target type
          14    25    28   Class java/lang/UnsupportedOperationException
          14    25    40   Class net/shibboleth/utilities/java/support/resolver/ResolverException
          63    74    77   Class net/shibboleth/utilities/java/support/resolver/ResolverException

  protected boolean checkNames(java.util.Set<java.lang.String>, org.opensaml.security.x509.X509Credential) throws org.opensaml.security.SecurityException;
    Code:
       0: aload_0
       1: getfield      #14                 // Field credNameEvaluator:Lorg/opensaml/security/x509/impl/X509CredentialNameEvaluator;
       4: ifnonnull     20
       7: aload_0
       8: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      11: ldc           #62                 // String No credential name evaluator was available, skipping trusted name evaluation
      13: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      18: iconst_1
      19: ireturn
      20: aload_1
      21: ifnonnull     37
      24: aload_0
      25: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      28: ldc           #63                 // String Trusted names was null, signalling PKIX resolver does not support trusted names resolution, skipping trusted name evaluation
      30: invokeinterface #20,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      35: iconst_1
      36: ireturn
      37: aload_0
      38: getfield      #14                 // Field credNameEvaluator:Lorg/opensaml/security/x509/impl/X509CredentialNameEvaluator;
      41: aload_2
      42: aload_1
      43: invokeinterface #64,  3           // InterfaceMethod org/opensaml/security/x509/impl/X509CredentialNameEvaluator.evaluate:(Lorg/opensaml/security/x509/X509Credential;Ljava/util/Set;)Z
      48: ireturn

  protected boolean evaluateTrust(org.opensaml.security.credential.Credential, java.lang.Object) throws org.opensaml.security.SecurityException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: checkcast     #60                 // class net/shibboleth/utilities/java/support/collection/Pair
       6: invokevirtual #27                 // Method evaluateTrust:(Lorg/opensaml/security/credential/Credential;Lnet/shibboleth/utilities/java/support/collection/Pair;)Z
       9: ireturn
}
