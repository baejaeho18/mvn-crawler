Compiled from "SignatureAlgorithmValidator.java"
public class org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator {
  private static final javax.xml.namespace.QName ELEMENT_NAME_SIGNED_INFO;

  private static final javax.xml.namespace.QName ELEMENT_NAME_SIGNATURE_METHOD;

  private static final javax.xml.namespace.QName ELEMENT_NAME_REFERENCE;

  private static final javax.xml.namespace.QName ELEMENT_NAME_DIGEST_METHOD;

  private static final java.lang.String ATTR_NAME_ALGORTHM;

  private org.slf4j.Logger log;

  private java.util.Collection<java.lang.String> whitelistedAlgorithmURIs;

  private java.util.Collection<java.lang.String> blacklistedAlgorithmURIs;

  public org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator(org.opensaml.xmlsec.SignatureValidationParameters);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc_w         #2                  // class org/opensaml/xmlsec/signature/support/impl/SignatureAlgorithmValidator
       8: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      11: putfield      #4                  // Field log:Lorg/slf4j/Logger;
      14: aload_1
      15: ldc           #5                  // String SignatureValidationParameters may not be null
      17: invokestatic  #6                  // Method net/shibboleth/utilities/java/support/logic/Constraint.isNotNull:(Ljava/lang/Object;Ljava/lang/String;)Ljava/lang/Object;
      20: pop
      21: aload_0
      22: aload_1
      23: invokevirtual #7                  // Method org/opensaml/xmlsec/SignatureValidationParameters.getWhitelistedAlgorithms:()Ljava/util/Collection;
      26: putfield      #8                  // Field whitelistedAlgorithmURIs:Ljava/util/Collection;
      29: aload_0
      30: aload_1
      31: invokevirtual #9                  // Method org/opensaml/xmlsec/SignatureValidationParameters.getBlacklistedAlgorithms:()Ljava/util/Collection;
      34: putfield      #10                 // Field blacklistedAlgorithmURIs:Ljava/util/Collection;
      37: return

  public org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator(java.util.Collection<java.lang.String>, java.util.Collection<java.lang.String>);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc_w         #2                  // class org/opensaml/xmlsec/signature/support/impl/SignatureAlgorithmValidator
       8: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      11: putfield      #4                  // Field log:Lorg/slf4j/Logger;
      14: aload_0
      15: aload_1
      16: putfield      #8                  // Field whitelistedAlgorithmURIs:Ljava/util/Collection;
      19: aload_0
      20: aload_2
      21: putfield      #10                 // Field blacklistedAlgorithmURIs:Ljava/util/Collection;
      24: return

  public void validate(org.opensaml.xmlsec.signature.Signature) throws org.opensaml.xmlsec.signature.support.SignatureException;
    Code:
       0: aload_1
       1: ldc           #11                 // String Signature was null
       3: invokestatic  #6                  // Method net/shibboleth/utilities/java/support/logic/Constraint.isNotNull:(Ljava/lang/Object;Ljava/lang/String;)Ljava/lang/Object;
       6: pop
       7: aload_0
       8: aload_1
       9: invokevirtual #12                 // Method checkDOM:(Lorg/opensaml/xmlsec/signature/Signature;)V
      12: aload_0
      13: aload_1
      14: invokevirtual #13                 // Method getSignatureAlgorithm:(Lorg/opensaml/xmlsec/signature/Signature;)Ljava/lang/String;
      17: astore_2
      18: aload_0
      19: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      22: ldc           #14                 // String Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: {}
      24: aload_2
      25: invokeinterface #15,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      30: aload_0
      31: aload_2
      32: invokevirtual #16                 // Method validateAlgorithmURI:(Ljava/lang/String;)V
      35: aload_0
      36: aload_1
      37: invokevirtual #17                 // Method getDigestMethods:(Lorg/opensaml/xmlsec/signature/Signature;)Ljava/util/List;
      40: invokeinterface #18,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      45: astore_3
      46: aload_3
      47: invokeinterface #19,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      52: ifeq          88
      55: aload_3
      56: invokeinterface #20,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      61: checkcast     #21                 // class java/lang/String
      64: astore        4
      66: aload_0
      67: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      70: ldc           #22                 // String Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: {}
      72: aload         4
      74: invokeinterface #15,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      79: aload_0
      80: aload         4
      82: invokevirtual #16                 // Method validateAlgorithmURI:(Ljava/lang/String;)V
      85: goto          46
      88: return

  protected void checkDOM(org.opensaml.xmlsec.signature.Signature) throws org.opensaml.xmlsec.signature.support.SignatureException;
    Code:
       0: aload_1
       1: invokeinterface #23,  1           // InterfaceMethod org/opensaml/xmlsec/signature/Signature.getDOM:()Lorg/w3c/dom/Element;
       6: ifnonnull     30
       9: aload_0
      10: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      13: ldc           #24                 // String Signgaure does not have a cached DOM Element.
      15: invokeinterface #25,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      20: new           #26                 // class org/opensaml/xmlsec/signature/support/SignatureException
      23: dup
      24: ldc           #27                 // String Signature does not have a cached DOM Element.
      26: invokespecial #28                 // Method org/opensaml/xmlsec/signature/support/SignatureException."<init>":(Ljava/lang/String;)V
      29: athrow
      30: return

  protected java.lang.String getSignatureAlgorithm(org.opensaml.xmlsec.signature.Signature) throws org.opensaml.xmlsec.signature.support.SignatureException;
    Code:
       0: aload_1
       1: invokeinterface #23,  1           // InterfaceMethod org/opensaml/xmlsec/signature/Signature.getDOM:()Lorg/w3c/dom/Element;
       6: astore_2
       7: aload_2
       8: getstatic     #29                 // Field ELEMENT_NAME_SIGNED_INFO:Ljavax/xml/namespace/QName;
      11: invokestatic  #30                 // Method net/shibboleth/utilities/java/support/xml/ElementSupport.getFirstChildElement:(Lorg/w3c/dom/Node;Ljavax/xml/namespace/QName;)Lorg/w3c/dom/Element;
      14: astore_3
      15: aload_3
      16: getstatic     #31                 // Field ELEMENT_NAME_SIGNATURE_METHOD:Ljavax/xml/namespace/QName;
      19: invokestatic  #30                 // Method net/shibboleth/utilities/java/support/xml/ElementSupport.getFirstChildElement:(Lorg/w3c/dom/Node;Ljavax/xml/namespace/QName;)Lorg/w3c/dom/Element;
      22: astore        4
      24: aload         4
      26: aconst_null
      27: ldc           #32                 // String Algorithm
      29: invokestatic  #33                 // Method net/shibboleth/utilities/java/support/xml/AttributeSupport.getAttributeValue:(Lorg/w3c/dom/Element;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      32: invokestatic  #34                 // Method net/shibboleth/utilities/java/support/primitive/StringSupport.trimOrNull:(Ljava/lang/String;)Ljava/lang/String;
      35: astore        5
      37: aload         5
      39: ifnull        45
      42: aload         5
      44: areturn
      45: new           #26                 // class org/opensaml/xmlsec/signature/support/SignatureException
      48: dup
      49: ldc           #35                 // String SignatureMethod Algorithm was null
      51: invokespecial #28                 // Method org/opensaml/xmlsec/signature/support/SignatureException."<init>":(Ljava/lang/String;)V
      54: athrow

  protected java.util.List<java.lang.String> getDigestMethods(org.opensaml.xmlsec.signature.Signature) throws org.opensaml.xmlsec.signature.support.SignatureException;
    Code:
       0: new           #36                 // class java/util/ArrayList
       3: dup
       4: invokespecial #37                 // Method java/util/ArrayList."<init>":()V
       7: astore_2
       8: aload_1
       9: invokeinterface #23,  1           // InterfaceMethod org/opensaml/xmlsec/signature/Signature.getDOM:()Lorg/w3c/dom/Element;
      14: astore_3
      15: aload_3
      16: getstatic     #29                 // Field ELEMENT_NAME_SIGNED_INFO:Ljavax/xml/namespace/QName;
      19: invokestatic  #30                 // Method net/shibboleth/utilities/java/support/xml/ElementSupport.getFirstChildElement:(Lorg/w3c/dom/Node;Ljavax/xml/namespace/QName;)Lorg/w3c/dom/Element;
      22: astore        4
      24: aload         4
      26: getstatic     #38                 // Field ELEMENT_NAME_REFERENCE:Ljavax/xml/namespace/QName;
      29: invokestatic  #39                 // Method net/shibboleth/utilities/java/support/xml/ElementSupport.getChildElements:(Lorg/w3c/dom/Node;Ljavax/xml/namespace/QName;)Ljava/util/List;
      32: invokeinterface #18,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      37: astore        5
      39: aload         5
      41: invokeinterface #19,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      46: ifeq          112
      49: aload         5
      51: invokeinterface #20,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      56: checkcast     #40                 // class org/w3c/dom/Element
      59: astore        6
      61: aload         6
      63: getstatic     #41                 // Field ELEMENT_NAME_DIGEST_METHOD:Ljavax/xml/namespace/QName;
      66: invokestatic  #30                 // Method net/shibboleth/utilities/java/support/xml/ElementSupport.getFirstChildElement:(Lorg/w3c/dom/Node;Ljavax/xml/namespace/QName;)Lorg/w3c/dom/Element;
      69: astore        7
      71: aload         7
      73: aconst_null
      74: ldc           #32                 // String Algorithm
      76: invokestatic  #33                 // Method net/shibboleth/utilities/java/support/xml/AttributeSupport.getAttributeValue:(Lorg/w3c/dom/Element;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      79: invokestatic  #34                 // Method net/shibboleth/utilities/java/support/primitive/StringSupport.trimOrNull:(Ljava/lang/String;)Ljava/lang/String;
      82: astore        8
      84: aload         8
      86: ifnull        99
      89: aload_2
      90: aload         8
      92: invokevirtual #42                 // Method java/util/ArrayList.add:(Ljava/lang/Object;)Z
      95: pop
      96: goto          109
      99: new           #26                 // class org/opensaml/xmlsec/signature/support/SignatureException
     102: dup
     103: ldc           #43                 // String Saw null DigestMethod Algorithm
     105: invokespecial #28                 // Method org/opensaml/xmlsec/signature/support/SignatureException."<init>":(Ljava/lang/String;)V
     108: athrow
     109: goto          39
     112: aload_2
     113: areturn

  protected void validateAlgorithmURI(java.lang.String) throws org.opensaml.xmlsec.signature.support.SignatureException;
    Code:
       0: aload_0
       1: getfield      #4                  // Field log:Lorg/slf4j/Logger;
       4: ldc           #44                 // String Validating algorithm URI against whitelist and blacklist: algorithm: {}, whitelist: {}, blacklist: {}
       6: iconst_3
       7: anewarray     #45                 // class java/lang/Object
      10: dup
      11: iconst_0
      12: aload_1
      13: aastore
      14: dup
      15: iconst_1
      16: aload_0
      17: getfield      #8                  // Field whitelistedAlgorithmURIs:Ljava/util/Collection;
      20: aastore
      21: dup
      22: iconst_2
      23: aload_0
      24: getfield      #10                 // Field blacklistedAlgorithmURIs:Ljava/util/Collection;
      27: aastore
      28: invokeinterface #46,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
      33: aload_1
      34: aload_0
      35: getfield      #8                  // Field whitelistedAlgorithmURIs:Ljava/util/Collection;
      38: aload_0
      39: getfield      #10                 // Field blacklistedAlgorithmURIs:Ljava/util/Collection;
      42: invokestatic  #47                 // Method org/opensaml/xmlsec/algorithm/AlgorithmSupport.validateAlgorithmURI:(Ljava/lang/String;Ljava/util/Collection;Ljava/util/Collection;)Z
      45: ifne          75
      48: new           #26                 // class org/opensaml/xmlsec/signature/support/SignatureException
      51: dup
      52: new           #48                 // class java/lang/StringBuilder
      55: dup
      56: invokespecial #49                 // Method java/lang/StringBuilder."<init>":()V
      59: ldc           #50                 // String Algorithm failed whitelist/blacklist validation:
      61: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      64: aload_1
      65: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      68: invokevirtual #52                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      71: invokespecial #28                 // Method org/opensaml/xmlsec/signature/support/SignatureException."<init>":(Ljava/lang/String;)V
      74: athrow
      75: return

  static {};
    Code:
       0: new           #53                 // class javax/xml/namespace/QName
       3: dup
       4: ldc           #54                 // String http://www.w3.org/2000/09/xmldsig#
       6: ldc           #55                 // String SignedInfo
       8: invokespecial #56                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      11: putstatic     #29                 // Field ELEMENT_NAME_SIGNED_INFO:Ljavax/xml/namespace/QName;
      14: new           #53                 // class javax/xml/namespace/QName
      17: dup
      18: ldc           #54                 // String http://www.w3.org/2000/09/xmldsig#
      20: ldc           #57                 // String SignatureMethod
      22: invokespecial #56                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      25: putstatic     #31                 // Field ELEMENT_NAME_SIGNATURE_METHOD:Ljavax/xml/namespace/QName;
      28: new           #53                 // class javax/xml/namespace/QName
      31: dup
      32: ldc           #54                 // String http://www.w3.org/2000/09/xmldsig#
      34: ldc           #58                 // String Reference
      36: invokespecial #56                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      39: putstatic     #38                 // Field ELEMENT_NAME_REFERENCE:Ljavax/xml/namespace/QName;
      42: new           #53                 // class javax/xml/namespace/QName
      45: dup
      46: ldc           #54                 // String http://www.w3.org/2000/09/xmldsig#
      48: ldc           #59                 // String DigestMethod
      50: invokespecial #56                 // Method javax/xml/namespace/QName."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      53: putstatic     #41                 // Field ELEMENT_NAME_DIGEST_METHOD:Ljavax/xml/namespace/QName;
      56: return
}
