Compiled from "ServletFormAuthenticationMechanism.java"
public class io.undertow.servlet.handlers.security.ServletFormAuthenticationMechanism extends io.undertow.security.impl.FormAuthenticationMechanism {
  public static final io.undertow.security.api.AuthenticationMechanismFactory FACTORY;

  private static final java.lang.String SESSION_KEY;

  public static final java.lang.String SAVE_ORIGINAL_REQUEST;

  private final boolean saveOriginalRequest;

  private final java.util.Set<io.undertow.server.session.SessionManager> seenSessionManagers;

  private final java.lang.String defaultPage;

  private final boolean overrideInitial;

  private static final io.undertow.server.session.SessionListener LISTENER;

  public io.undertow.servlet.handlers.security.ServletFormAuthenticationMechanism(java.lang.String, java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: invokespecial #2                  // Method io/undertow/security/impl/FormAuthenticationMechanism."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
       7: aload_0
       8: new           #3                  // class java/util/WeakHashMap
      11: dup
      12: invokespecial #4                  // Method java/util/WeakHashMap."<init>":()V
      15: invokestatic  #5                  // Method java/util/Collections.newSetFromMap:(Ljava/util/Map;)Ljava/util/Set;
      18: invokestatic  #6                  // Method java/util/Collections.synchronizedSet:(Ljava/util/Set;)Ljava/util/Set;
      21: putfield      #7                  // Field seenSessionManagers:Ljava/util/Set;
      24: aload_0
      25: iconst_1
      26: putfield      #8                  // Field saveOriginalRequest:Z
      29: aload_0
      30: aconst_null
      31: putfield      #9                  // Field defaultPage:Ljava/lang/String;
      34: aload_0
      35: iconst_0
      36: putfield      #10                 // Field overrideInitial:Z
      39: return

  public io.undertow.servlet.handlers.security.ServletFormAuthenticationMechanism(java.lang.String, java.lang.String, java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: invokespecial #11                 // Method io/undertow/security/impl/FormAuthenticationMechanism."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
       9: aload_0
      10: new           #3                  // class java/util/WeakHashMap
      13: dup
      14: invokespecial #4                  // Method java/util/WeakHashMap."<init>":()V
      17: invokestatic  #5                  // Method java/util/Collections.newSetFromMap:(Ljava/util/Map;)Ljava/util/Set;
      20: invokestatic  #6                  // Method java/util/Collections.synchronizedSet:(Ljava/util/Set;)Ljava/util/Set;
      23: putfield      #7                  // Field seenSessionManagers:Ljava/util/Set;
      26: aload_0
      27: iconst_1
      28: putfield      #8                  // Field saveOriginalRequest:Z
      31: aload_0
      32: aconst_null
      33: putfield      #9                  // Field defaultPage:Ljava/lang/String;
      36: aload_0
      37: iconst_0
      38: putfield      #10                 // Field overrideInitial:Z
      41: return

  public io.undertow.servlet.handlers.security.ServletFormAuthenticationMechanism(io.undertow.server.handlers.form.FormParserFactory, java.lang.String, java.lang.String, java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: aload         5
       8: invokespecial #12                 // Method io/undertow/security/impl/FormAuthenticationMechanism."<init>":(Lio/undertow/server/handlers/form/FormParserFactory;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
      11: aload_0
      12: new           #3                  // class java/util/WeakHashMap
      15: dup
      16: invokespecial #4                  // Method java/util/WeakHashMap."<init>":()V
      19: invokestatic  #5                  // Method java/util/Collections.newSetFromMap:(Ljava/util/Map;)Ljava/util/Set;
      22: invokestatic  #6                  // Method java/util/Collections.synchronizedSet:(Ljava/util/Set;)Ljava/util/Set;
      25: putfield      #7                  // Field seenSessionManagers:Ljava/util/Set;
      28: aload_0
      29: iconst_1
      30: putfield      #8                  // Field saveOriginalRequest:Z
      33: aload_0
      34: aconst_null
      35: putfield      #9                  // Field defaultPage:Ljava/lang/String;
      38: aload_0
      39: iconst_0
      40: putfield      #10                 // Field overrideInitial:Z
      43: return

  public io.undertow.servlet.handlers.security.ServletFormAuthenticationMechanism(io.undertow.server.handlers.form.FormParserFactory, java.lang.String, java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: invokespecial #13                 // Method io/undertow/security/impl/FormAuthenticationMechanism."<init>":(Lio/undertow/server/handlers/form/FormParserFactory;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
       9: aload_0
      10: new           #3                  // class java/util/WeakHashMap
      13: dup
      14: invokespecial #4                  // Method java/util/WeakHashMap."<init>":()V
      17: invokestatic  #5                  // Method java/util/Collections.newSetFromMap:(Ljava/util/Map;)Ljava/util/Set;
      20: invokestatic  #6                  // Method java/util/Collections.synchronizedSet:(Ljava/util/Set;)Ljava/util/Set;
      23: putfield      #7                  // Field seenSessionManagers:Ljava/util/Set;
      26: aload_0
      27: iconst_1
      28: putfield      #8                  // Field saveOriginalRequest:Z
      31: aload_0
      32: aconst_null
      33: putfield      #9                  // Field defaultPage:Ljava/lang/String;
      36: aload_0
      37: iconst_0
      38: putfield      #10                 // Field overrideInitial:Z
      41: return

  public io.undertow.servlet.handlers.security.ServletFormAuthenticationMechanism(io.undertow.server.handlers.form.FormParserFactory, java.lang.String, java.lang.String, java.lang.String, io.undertow.security.idm.IdentityManager);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: aload         5
       8: invokespecial #14                 // Method io/undertow/security/impl/FormAuthenticationMechanism."<init>":(Lio/undertow/server/handlers/form/FormParserFactory;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Lio/undertow/security/idm/IdentityManager;)V
      11: aload_0
      12: new           #3                  // class java/util/WeakHashMap
      15: dup
      16: invokespecial #4                  // Method java/util/WeakHashMap."<init>":()V
      19: invokestatic  #5                  // Method java/util/Collections.newSetFromMap:(Ljava/util/Map;)Ljava/util/Set;
      22: invokestatic  #6                  // Method java/util/Collections.synchronizedSet:(Ljava/util/Set;)Ljava/util/Set;
      25: putfield      #7                  // Field seenSessionManagers:Ljava/util/Set;
      28: aload_0
      29: iconst_1
      30: putfield      #8                  // Field saveOriginalRequest:Z
      33: aload_0
      34: aconst_null
      35: putfield      #9                  // Field defaultPage:Ljava/lang/String;
      38: aload_0
      39: iconst_0
      40: putfield      #10                 // Field overrideInitial:Z
      43: return

  public io.undertow.servlet.handlers.security.ServletFormAuthenticationMechanism(io.undertow.server.handlers.form.FormParserFactory, java.lang.String, java.lang.String, java.lang.String, io.undertow.security.idm.IdentityManager, boolean);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: aload         5
       8: invokespecial #14                 // Method io/undertow/security/impl/FormAuthenticationMechanism."<init>":(Lio/undertow/server/handlers/form/FormParserFactory;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Lio/undertow/security/idm/IdentityManager;)V
      11: aload_0
      12: new           #3                  // class java/util/WeakHashMap
      15: dup
      16: invokespecial #4                  // Method java/util/WeakHashMap."<init>":()V
      19: invokestatic  #5                  // Method java/util/Collections.newSetFromMap:(Ljava/util/Map;)Ljava/util/Set;
      22: invokestatic  #6                  // Method java/util/Collections.synchronizedSet:(Ljava/util/Set;)Ljava/util/Set;
      25: putfield      #7                  // Field seenSessionManagers:Ljava/util/Set;
      28: aload_0
      29: iconst_1
      30: putfield      #8                  // Field saveOriginalRequest:Z
      33: aload_0
      34: aconst_null
      35: putfield      #9                  // Field defaultPage:Ljava/lang/String;
      38: aload_0
      39: iconst_0
      40: putfield      #10                 // Field overrideInitial:Z
      43: return

  public io.undertow.servlet.handlers.security.ServletFormAuthenticationMechanism(io.undertow.server.handlers.form.FormParserFactory, java.lang.String, java.lang.String, java.lang.String, java.lang.String, boolean, io.undertow.security.idm.IdentityManager, boolean);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: aload         7
       8: invokespecial #14                 // Method io/undertow/security/impl/FormAuthenticationMechanism."<init>":(Lio/undertow/server/handlers/form/FormParserFactory;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Lio/undertow/security/idm/IdentityManager;)V
      11: aload_0
      12: new           #3                  // class java/util/WeakHashMap
      15: dup
      16: invokespecial #4                  // Method java/util/WeakHashMap."<init>":()V
      19: invokestatic  #5                  // Method java/util/Collections.newSetFromMap:(Ljava/util/Map;)Ljava/util/Set;
      22: invokestatic  #6                  // Method java/util/Collections.synchronizedSet:(Ljava/util/Set;)Ljava/util/Set;
      25: putfield      #7                  // Field seenSessionManagers:Ljava/util/Set;
      28: aload_0
      29: iload         8
      31: putfield      #8                  // Field saveOriginalRequest:Z
      34: aload_0
      35: aload         5
      37: putfield      #9                  // Field defaultPage:Ljava/lang/String;
      40: aload_0
      41: iload         6
      43: putfield      #10                 // Field overrideInitial:Z
      46: return

  protected java.lang.Integer servePage(io.undertow.server.HttpServerExchange, java.lang.String);
    Code:
       0: aload_1
       1: getstatic     #15                 // Field io/undertow/servlet/handlers/ServletRequestContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
       4: invokevirtual #16                 // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
       7: checkcast     #17                 // class io/undertow/servlet/handlers/ServletRequestContext
      10: astore_3
      11: aload_3
      12: invokevirtual #18                 // Method io/undertow/servlet/handlers/ServletRequestContext.getServletRequest:()Ljakarta/servlet/ServletRequest;
      15: astore        4
      17: aload_3
      18: invokevirtual #19                 // Method io/undertow/servlet/handlers/ServletRequestContext.getServletResponse:()Ljakarta/servlet/ServletResponse;
      21: astore        5
      23: aload         4
      25: aload_2
      26: invokeinterface #20,  2           // InterfaceMethod jakarta/servlet/ServletRequest.getRequestDispatcher:(Ljava/lang/String;)Ljakarta/servlet/RequestDispatcher;
      31: astore        6
      33: aload_1
      34: invokevirtual #21                 // Method io/undertow/server/HttpServerExchange.getResponseHeaders:()Lio/undertow/util/HeaderMap;
      37: getstatic     #22                 // Field io/undertow/util/Headers.CACHE_CONTROL:Lio/undertow/util/HttpString;
      40: ldc           #23                 // String no-cache, no-store, must-revalidate
      42: invokevirtual #24                 // Method io/undertow/util/HeaderMap.add:(Lio/undertow/util/HttpString;Ljava/lang/String;)Lio/undertow/util/HeaderMap;
      45: pop
      46: aload_1
      47: invokevirtual #21                 // Method io/undertow/server/HttpServerExchange.getResponseHeaders:()Lio/undertow/util/HeaderMap;
      50: getstatic     #25                 // Field io/undertow/util/Headers.PRAGMA:Lio/undertow/util/HttpString;
      53: ldc           #26                 // String no-cache
      55: invokevirtual #24                 // Method io/undertow/util/HeaderMap.add:(Lio/undertow/util/HttpString;Ljava/lang/String;)Lio/undertow/util/HeaderMap;
      58: pop
      59: aload_1
      60: invokevirtual #21                 // Method io/undertow/server/HttpServerExchange.getResponseHeaders:()Lio/undertow/util/HeaderMap;
      63: getstatic     #27                 // Field io/undertow/util/Headers.EXPIRES:Lio/undertow/util/HttpString;
      66: ldc           #28                 // String 0
      68: invokevirtual #24                 // Method io/undertow/util/HeaderMap.add:(Lio/undertow/util/HttpString;Ljava/lang/String;)Lio/undertow/util/HeaderMap;
      71: pop
      72: aload_1
      73: invokevirtual #29                 // Method io/undertow/server/HttpServerExchange.getStatusCode:()I
      76: sipush        200
      79: if_icmpeq     105
      82: aload         5
      84: instanceof    #30                 // class jakarta/servlet/http/HttpServletResponse
      87: ifeq          105
      90: new           #31                 // class io/undertow/servlet/handlers/security/ServletFormAuthenticationMechanism$FormResponseWrapper
      93: dup
      94: aload         5
      96: checkcast     #30                 // class jakarta/servlet/http/HttpServletResponse
      99: invokespecial #32                 // Method io/undertow/servlet/handlers/security/ServletFormAuthenticationMechanism$FormResponseWrapper."<init>":(Ljakarta/servlet/http/HttpServletResponse;)V
     102: goto          106
     105: aconst_null
     106: astore        7
     108: aload         6
     110: aload         4
     112: aload         7
     114: ifnull        122
     117: aload         7
     119: goto          124
     122: aload         5
     124: invokeinterface #33,  3           // InterfaceMethod jakarta/servlet/RequestDispatcher.forward:(Ljakarta/servlet/ServletRequest;Ljakarta/servlet/ServletResponse;)V
     129: goto          156
     132: astore        8
     134: new           #35                 // class java/lang/RuntimeException
     137: dup
     138: aload         8
     140: invokespecial #36                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
     143: athrow
     144: astore        8
     146: new           #35                 // class java/lang/RuntimeException
     149: dup
     150: aload         8
     152: invokespecial #36                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
     155: athrow
     156: aload         7
     158: ifnull        172
     161: aload         7
     163: invokevirtual #38                 // Method io/undertow/servlet/handlers/security/ServletFormAuthenticationMechanism$FormResponseWrapper.getStatus:()I
     166: invokestatic  #39                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     169: goto          173
     172: aconst_null
     173: areturn
    Exception table:
       from    to  target type
         108   129   132   Class jakarta/servlet/ServletException
         108   129   144   Class java/io/IOException

  protected void storeInitialLocation(io.undertow.server.HttpServerExchange);
    Code:
       0: aload_0
       1: aload_1
       2: aconst_null
       3: iconst_0
       4: invokevirtual #40                 // Method storeInitialLocation:(Lio/undertow/server/HttpServerExchange;[BI)V
       7: return

  protected void storeInitialLocation(io.undertow.server.HttpServerExchange, byte[], int);
    Code:
       0: aload_0
       1: getfield      #8                  // Field saveOriginalRequest:Z
       4: ifne          8
       7: return
       8: aload_1
       9: getstatic     #15                 // Field io/undertow/servlet/handlers/ServletRequestContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      12: invokevirtual #16                 // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
      15: checkcast     #17                 // class io/undertow/servlet/handlers/ServletRequestContext
      18: astore        4
      20: aload         4
      22: invokevirtual #41                 // Method io/undertow/servlet/handlers/ServletRequestContext.getCurrentServletContext:()Lio/undertow/servlet/spec/ServletContextImpl;
      25: aload_1
      26: iconst_1
      27: invokevirtual #42                 // Method io/undertow/servlet/spec/ServletContextImpl.getSession:(Lio/undertow/server/HttpServerExchange;Z)Lio/undertow/servlet/spec/HttpSessionImpl;
      30: astore        5
      32: invokestatic  #43                 // Method java/lang/System.getSecurityManager:()Ljava/lang/SecurityManager;
      35: ifnonnull     48
      38: aload         5
      40: invokevirtual #44                 // Method io/undertow/servlet/spec/HttpSessionImpl.getSession:()Lio/undertow/server/session/Session;
      43: astore        6
      45: goto          65
      48: new           #45                 // class io/undertow/servlet/spec/HttpSessionImpl$UnwrapSessionAction
      51: dup
      52: aload         5
      54: invokespecial #46                 // Method io/undertow/servlet/spec/HttpSessionImpl$UnwrapSessionAction."<init>":(Ljakarta/servlet/http/HttpSession;)V
      57: invokestatic  #47                 // Method java/security/AccessController.doPrivileged:(Ljava/security/PrivilegedAction;)Ljava/lang/Object;
      60: checkcast     #48                 // class io/undertow/server/session/Session
      63: astore        6
      65: aload         6
      67: invokeinterface #49,  1           // InterfaceMethod io/undertow/server/session/Session.getSessionManager:()Lio/undertow/server/session/SessionManager;
      72: astore        7
      74: aload_0
      75: getfield      #7                  // Field seenSessionManagers:Ljava/util/Set;
      78: aload         7
      80: invokeinterface #50,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      85: ifeq          98
      88: aload         7
      90: getstatic     #51                 // Field LISTENER:Lio/undertow/server/session/SessionListener;
      93: invokeinterface #52,  2           // InterfaceMethod io/undertow/server/session/SessionManager.registerSessionListener:(Lio/undertow/server/session/SessionListener;)V
      98: aload         6
     100: ldc           #54                 // String io.undertow.servlet.form.auth.redirect.location
     102: aload_1
     103: aload_1
     104: invokevirtual #55                 // Method io/undertow/server/HttpServerExchange.getRelativePath:()Ljava/lang/String;
     107: invokestatic  #56                 // Method io/undertow/util/RedirectBuilder.redirect:(Lio/undertow/server/HttpServerExchange;Ljava/lang/String;)Ljava/lang/String;
     110: invokeinterface #57,  3           // InterfaceMethod io/undertow/server/session/Session.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     115: pop
     116: aload_2
     117: ifnonnull     127
     120: aload_1
     121: invokestatic  #58                 // Method io/undertow/servlet/util/SavedRequest.trySaveRequest:(Lio/undertow/server/HttpServerExchange;)V
     124: goto          133
     127: aload_1
     128: aload_2
     129: iload_3
     130: invokestatic  #59                 // Method io/undertow/servlet/util/SavedRequest.trySaveRequest:(Lio/undertow/server/HttpServerExchange;[BI)V
     133: return

  protected void handleRedirectBack(io.undertow.server.HttpServerExchange);
    Code:
       0: aload_1
       1: getstatic     #15                 // Field io/undertow/servlet/handlers/ServletRequestContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
       4: invokevirtual #16                 // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
       7: checkcast     #17                 // class io/undertow/servlet/handlers/ServletRequestContext
      10: astore_2
      11: aload_2
      12: invokevirtual #19                 // Method io/undertow/servlet/handlers/ServletRequestContext.getServletResponse:()Ljakarta/servlet/ServletResponse;
      15: checkcast     #30                 // class jakarta/servlet/http/HttpServletResponse
      18: astore_3
      19: aload_2
      20: invokevirtual #41                 // Method io/undertow/servlet/handlers/ServletRequestContext.getCurrentServletContext:()Lio/undertow/servlet/spec/ServletContextImpl;
      23: aload_1
      24: iconst_0
      25: invokevirtual #42                 // Method io/undertow/servlet/spec/ServletContextImpl.getSession:(Lio/undertow/server/HttpServerExchange;Z)Lio/undertow/servlet/spec/HttpSessionImpl;
      28: astore        4
      30: aload         4
      32: ifnull        135
      35: invokestatic  #43                 // Method java/lang/System.getSecurityManager:()Ljava/lang/SecurityManager;
      38: ifnonnull     51
      41: aload         4
      43: invokevirtual #44                 // Method io/undertow/servlet/spec/HttpSessionImpl.getSession:()Lio/undertow/server/session/Session;
      46: astore        5
      48: goto          68
      51: new           #45                 // class io/undertow/servlet/spec/HttpSessionImpl$UnwrapSessionAction
      54: dup
      55: aload         4
      57: invokespecial #46                 // Method io/undertow/servlet/spec/HttpSessionImpl$UnwrapSessionAction."<init>":(Ljakarta/servlet/http/HttpSession;)V
      60: invokestatic  #47                 // Method java/security/AccessController.doPrivileged:(Ljava/security/PrivilegedAction;)Ljava/lang/Object;
      63: checkcast     #48                 // class io/undertow/server/session/Session
      66: astore        5
      68: aload         5
      70: ldc           #54                 // String io.undertow.servlet.form.auth.redirect.location
      72: invokeinterface #60,  2           // InterfaceMethod io/undertow/server/session/Session.getAttribute:(Ljava/lang/String;)Ljava/lang/Object;
      77: checkcast     #61                 // class java/lang/String
      80: astore        6
      82: aload         6
      84: ifnull        94
      87: aload_0
      88: getfield      #10                 // Field overrideInitial:Z
      91: ifeq          107
      94: aload_0
      95: getfield      #9                  // Field defaultPage:Ljava/lang/String;
      98: ifnull        107
     101: aload_0
     102: getfield      #9                  // Field defaultPage:Ljava/lang/String;
     105: astore        6
     107: aload         6
     109: ifnull        135
     112: aload_3
     113: aload         6
     115: invokeinterface #62,  2           // InterfaceMethod jakarta/servlet/http/HttpServletResponse.sendRedirect:(Ljava/lang/String;)V
     120: goto          135
     123: astore        7
     125: new           #35                 // class java/lang/RuntimeException
     128: dup
     129: aload         7
     131: invokespecial #36                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
     134: athrow
     135: return
    Exception table:
       from    to  target type
         112   120   123   Class java/io/IOException

  static {};
    Code:
       0: new           #63                 // class io/undertow/servlet/handlers/security/ServletFormAuthenticationMechanism$Factory
       3: dup
       4: invokespecial #64                 // Method io/undertow/servlet/handlers/security/ServletFormAuthenticationMechanism$Factory."<init>":()V
       7: putstatic     #65                 // Field FACTORY:Lio/undertow/security/api/AuthenticationMechanismFactory;
      10: new           #66                 // class io/undertow/servlet/handlers/security/ServletFormAuthenticationMechanism$1
      13: dup
      14: invokespecial #67                 // Method io/undertow/servlet/handlers/security/ServletFormAuthenticationMechanism$1."<init>":()V
      17: putstatic     #51                 // Field LISTENER:Lio/undertow/server/session/SessionListener;
      20: return
}
