Compiled from "ProxyProtocolReadListener.java"
class io.undertow.server.protocol.proxy.ProxyProtocolReadListener implements org.xnio.ChannelListener<org.xnio.channels.StreamSourceChannel> {
  private static final int MAX_HEADER_LENGTH;

  private static final byte[] NAME;

  private static final java.lang.String UNKNOWN;

  private static final java.lang.String TCP4;

  private static final java.lang.String TCP6;

  private static final byte[] SIG;

  private final org.xnio.StreamConnection streamConnection;

  private final io.undertow.server.OpenListener openListener;

  private final io.undertow.protocols.ssl.UndertowXnioSsl ssl;

  private final io.undertow.connector.ByteBufferPool bufferPool;

  private final org.xnio.OptionMap sslOptionMap;

  private int byteCount;

  private java.lang.String protocol;

  private java.net.InetAddress sourceAddress;

  private java.net.InetAddress destAddress;

  private int sourcePort;

  private int destPort;

  private java.lang.StringBuilder stringBuilder;

  private boolean carriageReturnSeen;

  private boolean parsingUnknown;

  io.undertow.server.protocol.proxy.ProxyProtocolReadListener(org.xnio.StreamConnection, io.undertow.server.OpenListener, io.undertow.protocols.ssl.UndertowXnioSsl, io.undertow.connector.ByteBufferPool, org.xnio.OptionMap);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iconst_m1
       6: putfield      #2                  // Field sourcePort:I
       9: aload_0
      10: iconst_m1
      11: putfield      #3                  // Field destPort:I
      14: aload_0
      15: new           #4                  // class java/lang/StringBuilder
      18: dup
      19: invokespecial #5                  // Method java/lang/StringBuilder."<init>":()V
      22: putfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
      25: aload_0
      26: iconst_0
      27: putfield      #7                  // Field carriageReturnSeen:Z
      30: aload_0
      31: iconst_0
      32: putfield      #8                  // Field parsingUnknown:Z
      35: aload_0
      36: aload_1
      37: putfield      #9                  // Field streamConnection:Lorg/xnio/StreamConnection;
      40: aload_0
      41: aload_2
      42: putfield      #10                 // Field openListener:Lio/undertow/server/OpenListener;
      45: aload_0
      46: aload_3
      47: putfield      #11                 // Field ssl:Lio/undertow/protocols/ssl/UndertowXnioSsl;
      50: aload_0
      51: aload         4
      53: putfield      #12                 // Field bufferPool:Lio/undertow/connector/ByteBufferPool;
      56: aload_0
      57: aload         5
      59: putfield      #13                 // Field sslOptionMap:Lorg/xnio/OptionMap;
      62: aload         4
      64: invokeinterface #14,  1           // InterfaceMethod io/undertow/connector/ByteBufferPool.getBufferSize:()I
      69: bipush        107
      71: if_icmpge     85
      74: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
      77: bipush        107
      79: invokeinterface #17,  2           // InterfaceMethod io/undertow/UndertowMessages.bufferPoolTooSmall:(I)Ljava/lang/IllegalArgumentException;
      84: athrow
      85: return

  public void handleEvent(org.xnio.channels.StreamSourceChannel);
    Code:
       0: aload_0
       1: getfield      #12                 // Field bufferPool:Lio/undertow/connector/ByteBufferPool;
       4: invokeinterface #18,  1           // InterfaceMethod io/undertow/connector/ByteBufferPool.allocate:()Lio/undertow/connector/PooledByteBuffer;
       9: astore_2
      10: new           #19                 // class java/util/concurrent/atomic/AtomicBoolean
      13: dup
      14: iconst_1
      15: invokespecial #20                 // Method java/util/concurrent/atomic/AtomicBoolean."<init>":(Z)V
      18: astore_3
      19: aload_1
      20: aload_2
      21: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
      26: invokeinterface #22,  2           // InterfaceMethod org/xnio/channels/StreamSourceChannel.read:(Ljava/nio/ByteBuffer;)I
      31: istore        4
      33: iload         4
      35: iconst_m1
      36: if_icmpne     60
      39: aload_0
      40: getfield      #9                  // Field streamConnection:Lorg/xnio/StreamConnection;
      43: invokestatic  #23                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
      46: aload_3
      47: invokevirtual #24                 // Method java/util/concurrent/atomic/AtomicBoolean.get:()Z
      50: ifeq          59
      53: aload_2
      54: invokeinterface #25,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.close:()V
      59: return
      60: iload         4
      62: ifne          79
      65: aload_3
      66: invokevirtual #24                 // Method java/util/concurrent/atomic/AtomicBoolean.get:()Z
      69: ifeq          78
      72: aload_2
      73: invokeinterface #25,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.close:()V
      78: return
      79: aload_2
      80: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
      85: invokevirtual #26                 // Method java/nio/ByteBuffer.flip:()Ljava/nio/ByteBuffer;
      88: pop
      89: aload_2
      90: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
      95: invokevirtual #27                 // Method java/nio/ByteBuffer.hasRemaining:()Z
      98: ifeq          170
     101: aload_2
     102: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     107: invokevirtual #28                 // Method java/nio/ByteBuffer.get:()B
     110: istore        5
     112: aload_0
     113: dup
     114: getfield      #29                 // Field byteCount:I
     117: iconst_1
     118: iadd
     119: putfield      #29                 // Field byteCount:I
     122: iload         5
     124: getstatic     #30                 // Field SIG:[B
     127: iconst_0
     128: baload
     129: if_icmpne     141
     132: aload_0
     133: aload_2
     134: aload_3
     135: invokevirtual #31                 // Method parseProxyProtocolV2:(Lio/undertow/connector/PooledByteBuffer;Ljava/util/concurrent/atomic/AtomicBoolean;)V
     138: goto          170
     141: iload         5
     143: i2c
     144: getstatic     #32                 // Field NAME:[B
     147: iconst_0
     148: baload
     149: if_icmpne     161
     152: aload_0
     153: aload_2
     154: aload_3
     155: invokevirtual #33                 // Method parseProxyProtocolV1:(Lio/undertow/connector/PooledByteBuffer;Ljava/util/concurrent/atomic/AtomicBoolean;)V
     158: goto          170
     161: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     164: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     169: athrow
     170: aload_3
     171: invokevirtual #24                 // Method java/util/concurrent/atomic/AtomicBoolean.get:()Z
     174: ifeq          183
     177: aload_2
     178: invokeinterface #25,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.close:()V
     183: return
     184: astore        4
     186: getstatic     #36                 // Field io/undertow/UndertowLogger.REQUEST_IO_LOGGER:Lio/undertow/UndertowLogger;
     189: aload         4
     191: invokeinterface #37,  2           // InterfaceMethod io/undertow/UndertowLogger.ioException:(Ljava/io/IOException;)V
     196: aload_0
     197: getfield      #9                  // Field streamConnection:Lorg/xnio/StreamConnection;
     200: invokestatic  #23                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
     203: aload_3
     204: invokevirtual #24                 // Method java/util/concurrent/atomic/AtomicBoolean.get:()Z
     207: ifeq          279
     210: aload_2
     211: invokeinterface #25,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.close:()V
     216: goto          279
     219: astore        4
     221: getstatic     #36                 // Field io/undertow/UndertowLogger.REQUEST_IO_LOGGER:Lio/undertow/UndertowLogger;
     224: new           #35                 // class java/io/IOException
     227: dup
     228: aload         4
     230: invokespecial #39                 // Method java/io/IOException."<init>":(Ljava/lang/Throwable;)V
     233: invokeinterface #37,  2           // InterfaceMethod io/undertow/UndertowLogger.ioException:(Ljava/io/IOException;)V
     238: aload_0
     239: getfield      #9                  // Field streamConnection:Lorg/xnio/StreamConnection;
     242: invokestatic  #23                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
     245: aload_3
     246: invokevirtual #24                 // Method java/util/concurrent/atomic/AtomicBoolean.get:()Z
     249: ifeq          279
     252: aload_2
     253: invokeinterface #25,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.close:()V
     258: goto          279
     261: astore        6
     263: aload_3
     264: invokevirtual #24                 // Method java/util/concurrent/atomic/AtomicBoolean.get:()Z
     267: ifeq          276
     270: aload_2
     271: invokeinterface #25,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.close:()V
     276: aload         6
     278: athrow
     279: return
    Exception table:
       from    to  target type
          19    46   184   Class java/io/IOException
          60    65   184   Class java/io/IOException
          79   170   184   Class java/io/IOException
          19    46   219   Class java/lang/Throwable
          60    65   219   Class java/lang/Throwable
          79   170   219   Class java/lang/Throwable
          19    46   261   any
          60    65   261   any
          79   170   261   any
         184   203   261   any
         219   245   261   any
         261   263   261   any

  private void parseProxyProtocolV2(io.undertow.connector.PooledByteBuffer, java.util.concurrent.atomic.AtomicBoolean) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #29                 // Field byteCount:I
       4: getstatic     #30                 // Field SIG:[B
       7: arraylength
       8: if_icmpge     55
      11: aload_1
      12: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
      17: invokevirtual #28                 // Method java/nio/ByteBuffer.get:()B
      20: istore_3
      21: iload_3
      22: getstatic     #30                 // Field SIG:[B
      25: aload_0
      26: getfield      #29                 // Field byteCount:I
      29: baload
      30: if_icmpeq     42
      33: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
      36: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
      41: athrow
      42: aload_0
      43: dup
      44: getfield      #29                 // Field byteCount:I
      47: iconst_1
      48: iadd
      49: putfield      #29                 // Field byteCount:I
      52: goto          0
      55: aload_1
      56: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
      61: invokevirtual #28                 // Method java/nio/ByteBuffer.get:()B
      64: istore_3
      65: aload_1
      66: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
      71: invokevirtual #28                 // Method java/nio/ByteBuffer.get:()B
      74: istore        4
      76: aload_1
      77: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
      82: invokevirtual #40                 // Method java/nio/ByteBuffer.getShort:()S
      85: ldc           #41                 // int 65535
      87: iand
      88: istore        5
      90: iload_3
      91: sipush        240
      94: iand
      95: bipush        32
      97: if_icmpeq     109
     100: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     103: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     108: athrow
     109: iload_3
     110: bipush        15
     112: iand
     113: lookupswitch  { // 2
                     0: 465
                     1: 140
               default: 535
          }
     140: iload         4
     142: lookupswitch  { // 2
                    17: 168
                    33: 311
               default: 456
          }
     168: iload         5
     170: bipush        12
     172: if_icmpge     184
     175: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     178: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     183: athrow
     184: iconst_4
     185: newarray       byte
     187: astore        6
     189: aload_1
     190: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     195: aload         6
     197: invokevirtual #42                 // Method java/nio/ByteBuffer.get:([B)Ljava/nio/ByteBuffer;
     200: pop
     201: aload_0
     202: aload         6
     204: invokestatic  #43                 // Method java/net/InetAddress.getByAddress:([B)Ljava/net/InetAddress;
     207: putfield      #44                 // Field sourceAddress:Ljava/net/InetAddress;
     210: iconst_4
     211: newarray       byte
     213: astore        7
     215: aload_1
     216: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     221: aload         7
     223: invokevirtual #42                 // Method java/nio/ByteBuffer.get:([B)Ljava/nio/ByteBuffer;
     226: pop
     227: aload_0
     228: aload         7
     230: invokestatic  #43                 // Method java/net/InetAddress.getByAddress:([B)Ljava/net/InetAddress;
     233: putfield      #45                 // Field destAddress:Ljava/net/InetAddress;
     236: aload_0
     237: aload_1
     238: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     243: invokevirtual #40                 // Method java/nio/ByteBuffer.getShort:()S
     246: ldc           #41                 // int 65535
     248: iand
     249: putfield      #2                  // Field sourcePort:I
     252: aload_0
     253: aload_1
     254: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     259: invokevirtual #40                 // Method java/nio/ByteBuffer.getShort:()S
     262: ldc           #41                 // int 65535
     264: iand
     265: putfield      #3                  // Field destPort:I
     268: iload         5
     270: bipush        12
     272: if_icmple     544
     275: iload         5
     277: bipush        12
     279: isub
     280: istore        8
     282: aload_1
     283: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     288: invokevirtual #46                 // Method java/nio/ByteBuffer.position:()I
     291: istore        9
     293: aload_1
     294: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     299: iload         9
     301: iload         8
     303: iadd
     304: invokevirtual #47                 // Method java/nio/ByteBuffer.position:(I)Ljava/nio/ByteBuffer;
     307: pop
     308: goto          544
     311: iload         5
     313: bipush        36
     315: if_icmpge     327
     318: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     321: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     326: athrow
     327: bipush        16
     329: newarray       byte
     331: astore        6
     333: aload_1
     334: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     339: aload         6
     341: invokevirtual #42                 // Method java/nio/ByteBuffer.get:([B)Ljava/nio/ByteBuffer;
     344: pop
     345: aload_0
     346: aload         6
     348: invokestatic  #43                 // Method java/net/InetAddress.getByAddress:([B)Ljava/net/InetAddress;
     351: putfield      #44                 // Field sourceAddress:Ljava/net/InetAddress;
     354: bipush        16
     356: newarray       byte
     358: astore        7
     360: aload_1
     361: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     366: aload         7
     368: invokevirtual #42                 // Method java/nio/ByteBuffer.get:([B)Ljava/nio/ByteBuffer;
     371: pop
     372: aload_0
     373: aload         7
     375: invokestatic  #43                 // Method java/net/InetAddress.getByAddress:([B)Ljava/net/InetAddress;
     378: putfield      #45                 // Field destAddress:Ljava/net/InetAddress;
     381: aload_0
     382: aload_1
     383: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     388: invokevirtual #40                 // Method java/nio/ByteBuffer.getShort:()S
     391: ldc           #41                 // int 65535
     393: iand
     394: putfield      #2                  // Field sourcePort:I
     397: aload_0
     398: aload_1
     399: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     404: invokevirtual #40                 // Method java/nio/ByteBuffer.getShort:()S
     407: ldc           #41                 // int 65535
     409: iand
     410: putfield      #3                  // Field destPort:I
     413: iload         5
     415: bipush        36
     417: if_icmple     544
     420: iload         5
     422: bipush        36
     424: isub
     425: istore        8
     427: aload_1
     428: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     433: invokevirtual #46                 // Method java/nio/ByteBuffer.position:()I
     436: istore        9
     438: aload_1
     439: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     444: iload         9
     446: iload         8
     448: iadd
     449: invokevirtual #47                 // Method java/nio/ByteBuffer.position:(I)Ljava/nio/ByteBuffer;
     452: pop
     453: goto          544
     456: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     459: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     464: athrow
     465: iload         5
     467: ifle          500
     470: iload         5
     472: istore        6
     474: aload_1
     475: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     480: invokevirtual #46                 // Method java/nio/ByteBuffer.position:()I
     483: istore        7
     485: aload_1
     486: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     491: iload         7
     493: iload         6
     495: iadd
     496: invokevirtual #47                 // Method java/nio/ByteBuffer.position:(I)Ljava/nio/ByteBuffer;
     499: pop
     500: aload_1
     501: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     506: invokevirtual #27                 // Method java/nio/ByteBuffer.hasRemaining:()Z
     509: ifeq          527
     512: aload_2
     513: iconst_0
     514: invokevirtual #48                 // Method java/util/concurrent/atomic/AtomicBoolean.set:(Z)V
     517: aload_0
     518: aconst_null
     519: aconst_null
     520: aload_1
     521: invokevirtual #49                 // Method proxyAccept:(Ljava/net/SocketAddress;Ljava/net/SocketAddress;Lio/undertow/connector/PooledByteBuffer;)V
     524: goto          534
     527: aload_0
     528: aconst_null
     529: aconst_null
     530: aconst_null
     531: invokevirtual #49                 // Method proxyAccept:(Ljava/net/SocketAddress;Ljava/net/SocketAddress;Lio/undertow/connector/PooledByteBuffer;)V
     534: return
     535: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     538: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     543: athrow
     544: new           #50                 // class java/net/InetSocketAddress
     547: dup
     548: aload_0
     549: getfield      #44                 // Field sourceAddress:Ljava/net/InetAddress;
     552: aload_0
     553: getfield      #2                  // Field sourcePort:I
     556: invokespecial #51                 // Method java/net/InetSocketAddress."<init>":(Ljava/net/InetAddress;I)V
     559: astore        6
     561: new           #50                 // class java/net/InetSocketAddress
     564: dup
     565: aload_0
     566: getfield      #45                 // Field destAddress:Ljava/net/InetAddress;
     569: aload_0
     570: getfield      #3                  // Field destPort:I
     573: invokespecial #51                 // Method java/net/InetSocketAddress."<init>":(Ljava/net/InetAddress;I)V
     576: astore        7
     578: aload_1
     579: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     584: invokevirtual #27                 // Method java/nio/ByteBuffer.hasRemaining:()Z
     587: ifeq          607
     590: aload_2
     591: iconst_0
     592: invokevirtual #48                 // Method java/util/concurrent/atomic/AtomicBoolean.set:(Z)V
     595: aload_0
     596: aload         6
     598: aload         7
     600: aload_1
     601: invokevirtual #49                 // Method proxyAccept:(Ljava/net/SocketAddress;Ljava/net/SocketAddress;Lio/undertow/connector/PooledByteBuffer;)V
     604: goto          616
     607: aload_0
     608: aload         6
     610: aload         7
     612: aconst_null
     613: invokevirtual #49                 // Method proxyAccept:(Ljava/net/SocketAddress;Ljava/net/SocketAddress;Lio/undertow/connector/PooledByteBuffer;)V
     616: return

  private void parseProxyProtocolV1(io.undertow.connector.PooledByteBuffer, java.util.concurrent.atomic.AtomicBoolean) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
       6: invokevirtual #27                 // Method java/nio/ByteBuffer.hasRemaining:()Z
       9: ifeq          639
      12: aload_1
      13: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
      18: invokevirtual #28                 // Method java/nio/ByteBuffer.get:()B
      21: i2c
      22: istore_3
      23: aload_0
      24: getfield      #29                 // Field byteCount:I
      27: getstatic     #32                 // Field NAME:[B
      30: arraylength
      31: if_icmpge     55
      34: iload_3
      35: getstatic     #32                 // Field NAME:[B
      38: aload_0
      39: getfield      #29                 // Field byteCount:I
      42: baload
      43: if_icmpeq     608
      46: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
      49: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
      54: athrow
      55: aload_0
      56: getfield      #8                  // Field parsingUnknown:Z
      59: ifeq          149
      62: iload_3
      63: bipush        13
      65: if_icmpne     76
      68: aload_0
      69: iconst_1
      70: putfield      #7                  // Field carriageReturnSeen:Z
      73: goto          608
      76: iload_3
      77: bipush        10
      79: if_icmpne     133
      82: aload_0
      83: getfield      #7                  // Field carriageReturnSeen:Z
      86: ifne          98
      89: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
      92: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
      97: athrow
      98: aload_1
      99: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     104: invokevirtual #27                 // Method java/nio/ByteBuffer.hasRemaining:()Z
     107: ifeq          125
     110: aload_2
     111: iconst_0
     112: invokevirtual #48                 // Method java/util/concurrent/atomic/AtomicBoolean.set:(Z)V
     115: aload_0
     116: aconst_null
     117: aconst_null
     118: aload_1
     119: invokevirtual #49                 // Method proxyAccept:(Ljava/net/SocketAddress;Ljava/net/SocketAddress;Lio/undertow/connector/PooledByteBuffer;)V
     122: goto          132
     125: aload_0
     126: aconst_null
     127: aconst_null
     128: aconst_null
     129: invokevirtual #49                 // Method proxyAccept:(Ljava/net/SocketAddress;Ljava/net/SocketAddress;Lio/undertow/connector/PooledByteBuffer;)V
     132: return
     133: aload_0
     134: getfield      #7                  // Field carriageReturnSeen:Z
     137: ifeq          608
     140: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     143: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     148: athrow
     149: aload_0
     150: getfield      #7                  // Field carriageReturnSeen:Z
     153: ifeq          244
     156: iload_3
     157: bipush        10
     159: if_icmpne     235
     162: new           #50                 // class java/net/InetSocketAddress
     165: dup
     166: aload_0
     167: getfield      #44                 // Field sourceAddress:Ljava/net/InetAddress;
     170: aload_0
     171: getfield      #2                  // Field sourcePort:I
     174: invokespecial #51                 // Method java/net/InetSocketAddress."<init>":(Ljava/net/InetAddress;I)V
     177: astore        4
     179: new           #50                 // class java/net/InetSocketAddress
     182: dup
     183: aload_0
     184: getfield      #45                 // Field destAddress:Ljava/net/InetAddress;
     187: aload_0
     188: getfield      #3                  // Field destPort:I
     191: invokespecial #51                 // Method java/net/InetSocketAddress."<init>":(Ljava/net/InetAddress;I)V
     194: astore        5
     196: aload_1
     197: invokeinterface #21,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
     202: invokevirtual #27                 // Method java/nio/ByteBuffer.hasRemaining:()Z
     205: ifeq          225
     208: aload_2
     209: iconst_0
     210: invokevirtual #48                 // Method java/util/concurrent/atomic/AtomicBoolean.set:(Z)V
     213: aload_0
     214: aload         4
     216: aload         5
     218: aload_1
     219: invokevirtual #49                 // Method proxyAccept:(Ljava/net/SocketAddress;Ljava/net/SocketAddress;Lio/undertow/connector/PooledByteBuffer;)V
     222: goto          234
     225: aload_0
     226: aload         4
     228: aload         5
     230: aconst_null
     231: invokevirtual #49                 // Method proxyAccept:(Ljava/net/SocketAddress;Ljava/net/SocketAddress;Lio/undertow/connector/PooledByteBuffer;)V
     234: return
     235: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     238: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     243: athrow
     244: iload_3
     245: lookupswitch  { // 3
                    10: 590
                    13: 483
                    32: 280
               default: 599
          }
     280: aload_0
     281: getfield      #2                  // Field sourcePort:I
     284: iconst_m1
     285: if_icmpne     298
     288: aload_0
     289: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     292: invokevirtual #52                 // Method java/lang/StringBuilder.length:()I
     295: ifne          307
     298: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     301: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     306: athrow
     307: aload_0
     308: getfield      #53                 // Field protocol:Ljava/lang/String;
     311: ifnonnull     386
     314: aload_0
     315: aload_0
     316: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     319: invokevirtual #54                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     322: putfield      #53                 // Field protocol:Ljava/lang/String;
     325: aload_0
     326: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     329: iconst_0
     330: invokevirtual #55                 // Method java/lang/StringBuilder.setLength:(I)V
     333: aload_0
     334: getfield      #53                 // Field protocol:Ljava/lang/String;
     337: ldc           #56                 // String UNKNOWN
     339: invokevirtual #57                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     342: ifeq          353
     345: aload_0
     346: iconst_1
     347: putfield      #8                  // Field parsingUnknown:Z
     350: goto          608
     353: aload_0
     354: getfield      #53                 // Field protocol:Ljava/lang/String;
     357: ldc           #58                 // String TCP4
     359: invokevirtual #57                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     362: ifne          608
     365: aload_0
     366: getfield      #53                 // Field protocol:Ljava/lang/String;
     369: ldc           #59                 // String TCP6
     371: invokevirtual #57                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     374: ifne          608
     377: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     380: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     385: athrow
     386: aload_0
     387: getfield      #44                 // Field sourceAddress:Ljava/net/InetAddress;
     390: ifnonnull     422
     393: aload_0
     394: aload_0
     395: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     398: invokevirtual #54                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     401: aload_0
     402: getfield      #53                 // Field protocol:Ljava/lang/String;
     405: invokestatic  #60                 // Method parseAddress:(Ljava/lang/String;Ljava/lang/String;)Ljava/net/InetAddress;
     408: putfield      #44                 // Field sourceAddress:Ljava/net/InetAddress;
     411: aload_0
     412: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     415: iconst_0
     416: invokevirtual #55                 // Method java/lang/StringBuilder.setLength:(I)V
     419: goto          608
     422: aload_0
     423: getfield      #45                 // Field destAddress:Ljava/net/InetAddress;
     426: ifnonnull     458
     429: aload_0
     430: aload_0
     431: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     434: invokevirtual #54                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     437: aload_0
     438: getfield      #53                 // Field protocol:Ljava/lang/String;
     441: invokestatic  #60                 // Method parseAddress:(Ljava/lang/String;Ljava/lang/String;)Ljava/net/InetAddress;
     444: putfield      #45                 // Field destAddress:Ljava/net/InetAddress;
     447: aload_0
     448: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     451: iconst_0
     452: invokevirtual #55                 // Method java/lang/StringBuilder.setLength:(I)V
     455: goto          608
     458: aload_0
     459: aload_0
     460: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     463: invokevirtual #54                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     466: invokestatic  #61                 // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
     469: putfield      #2                  // Field sourcePort:I
     472: aload_0
     473: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     476: iconst_0
     477: invokevirtual #55                 // Method java/lang/StringBuilder.setLength:(I)V
     480: goto          608
     483: aload_0
     484: getfield      #3                  // Field destPort:I
     487: iconst_m1
     488: if_icmpne     546
     491: aload_0
     492: getfield      #2                  // Field sourcePort:I
     495: iconst_m1
     496: if_icmpeq     546
     499: aload_0
     500: getfield      #7                  // Field carriageReturnSeen:Z
     503: ifne          546
     506: aload_0
     507: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     510: invokevirtual #52                 // Method java/lang/StringBuilder.length:()I
     513: ifle          546
     516: aload_0
     517: aload_0
     518: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     521: invokevirtual #54                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     524: invokestatic  #61                 // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
     527: putfield      #3                  // Field destPort:I
     530: aload_0
     531: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     534: iconst_0
     535: invokevirtual #55                 // Method java/lang/StringBuilder.setLength:(I)V
     538: aload_0
     539: iconst_1
     540: putfield      #7                  // Field carriageReturnSeen:Z
     543: goto          608
     546: aload_0
     547: getfield      #53                 // Field protocol:Ljava/lang/String;
     550: ifnonnull     581
     553: ldc           #56                 // String UNKNOWN
     555: aload_0
     556: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     559: invokevirtual #54                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     562: invokevirtual #57                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     565: ifeq          608
     568: aload_0
     569: iconst_1
     570: putfield      #8                  // Field parsingUnknown:Z
     573: aload_0
     574: iconst_1
     575: putfield      #7                  // Field carriageReturnSeen:Z
     578: goto          608
     581: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     584: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     589: athrow
     590: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     593: invokeinterface #34,  1           // InterfaceMethod io/undertow/UndertowMessages.invalidProxyHeader:()Ljava/io/IOException;
     598: athrow
     599: aload_0
     600: getfield      #6                  // Field stringBuilder:Ljava/lang/StringBuilder;
     603: iload_3
     604: invokevirtual #62                 // Method java/lang/StringBuilder.append:(C)Ljava/lang/StringBuilder;
     607: pop
     608: aload_0
     609: dup
     610: getfield      #29                 // Field byteCount:I
     613: iconst_1
     614: iadd
     615: putfield      #29                 // Field byteCount:I
     618: aload_0
     619: getfield      #29                 // Field byteCount:I
     622: bipush        107
     624: if_icmpne     636
     627: getstatic     #16                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     630: invokeinterface #63,  1           // InterfaceMethod io/undertow/UndertowMessages.headerSizeToLarge:()Ljava/io/IOException;
     635: athrow
     636: goto          0
     639: return

  private void proxyAccept(java.net.SocketAddress, java.net.SocketAddress, io.undertow.connector.PooledByteBuffer);
    Code:
       0: aload_0
       1: getfield      #9                  // Field streamConnection:Lorg/xnio/StreamConnection;
       4: astore        4
       6: aload_1
       7: ifnull        23
      10: new           #64                 // class io/undertow/server/protocol/proxy/ProxyProtocolReadListener$AddressWrappedConnection
      13: dup
      14: aload         4
      16: aload_1
      17: aload_2
      18: invokespecial #65                 // Method io/undertow/server/protocol/proxy/ProxyProtocolReadListener$AddressWrappedConnection."<init>":(Lorg/xnio/StreamConnection;Ljava/net/SocketAddress;Ljava/net/SocketAddress;)V
      21: astore        4
      23: aload_0
      24: getfield      #11                 // Field ssl:Lio/undertow/protocols/ssl/UndertowXnioSsl;
      27: ifnull        117
      30: aload_3
      31: ifnull        74
      34: new           #66                 // class org/xnio/conduits/PushBackStreamSourceConduit
      37: dup
      38: aload         4
      40: invokevirtual #67                 // Method org/xnio/StreamConnection.getSourceChannel:()Lorg/xnio/conduits/ConduitStreamSourceChannel;
      43: invokevirtual #68                 // Method org/xnio/conduits/ConduitStreamSourceChannel.getConduit:()Lorg/xnio/conduits/StreamSourceConduit;
      46: invokespecial #69                 // Method org/xnio/conduits/PushBackStreamSourceConduit."<init>":(Lorg/xnio/conduits/StreamSourceConduit;)V
      49: astore        5
      51: aload         5
      53: new           #70                 // class io/undertow/util/PooledAdaptor
      56: dup
      57: aload_3
      58: invokespecial #71                 // Method io/undertow/util/PooledAdaptor."<init>":(Lio/undertow/connector/PooledByteBuffer;)V
      61: invokevirtual #72                 // Method org/xnio/conduits/PushBackStreamSourceConduit.pushBack:(Lorg/xnio/Pooled;)V
      64: aload         4
      66: invokevirtual #67                 // Method org/xnio/StreamConnection.getSourceChannel:()Lorg/xnio/conduits/ConduitStreamSourceChannel;
      69: aload         5
      71: invokevirtual #73                 // Method org/xnio/conduits/ConduitStreamSourceChannel.setConduit:(Lorg/xnio/conduits/StreamSourceConduit;)V
      74: aload_0
      75: getfield      #11                 // Field ssl:Lio/undertow/protocols/ssl/UndertowXnioSsl;
      78: aload         4
      80: aload_0
      81: getfield      #13                 // Field sslOptionMap:Lorg/xnio/OptionMap;
      84: ifnonnull     93
      87: getstatic     #74                 // Field org/xnio/OptionMap.EMPTY:Lorg/xnio/OptionMap;
      90: goto          97
      93: aload_0
      94: getfield      #13                 // Field sslOptionMap:Lorg/xnio/OptionMap;
      97: iconst_0
      98: invokevirtual #75                 // Method io/undertow/protocols/ssl/UndertowXnioSsl.wrapExistingConnection:(Lorg/xnio/StreamConnection;Lorg/xnio/OptionMap;Z)Lorg/xnio/ssl/SslConnection;
     101: astore        5
     103: aload         5
     105: astore        4
     107: aload_0
     108: aload         4
     110: aconst_null
     111: invokevirtual #76                 // Method callOpenListener:(Lorg/xnio/StreamConnection;Lio/undertow/connector/PooledByteBuffer;)V
     114: goto          124
     117: aload_0
     118: aload         4
     120: aload_3
     121: invokevirtual #76                 // Method callOpenListener:(Lorg/xnio/StreamConnection;Lio/undertow/connector/PooledByteBuffer;)V
     124: return

  private void callOpenListener(org.xnio.StreamConnection, io.undertow.connector.PooledByteBuffer);
    Code:
       0: aload_0
       1: getfield      #10                 // Field openListener:Lio/undertow/server/OpenListener;
       4: instanceof    #77                 // class io/undertow/server/DelegateOpenListener
       7: ifeq          27
      10: aload_0
      11: getfield      #10                 // Field openListener:Lio/undertow/server/OpenListener;
      14: checkcast     #77                 // class io/undertow/server/DelegateOpenListener
      17: aload_1
      18: aload_2
      19: invokeinterface #78,  3           // InterfaceMethod io/undertow/server/DelegateOpenListener.handleEvent:(Lorg/xnio/StreamConnection;Lio/undertow/connector/PooledByteBuffer;)V
      24: goto          76
      27: aload_2
      28: ifnull        66
      31: new           #66                 // class org/xnio/conduits/PushBackStreamSourceConduit
      34: dup
      35: aload_1
      36: invokevirtual #67                 // Method org/xnio/StreamConnection.getSourceChannel:()Lorg/xnio/conduits/ConduitStreamSourceChannel;
      39: invokevirtual #68                 // Method org/xnio/conduits/ConduitStreamSourceChannel.getConduit:()Lorg/xnio/conduits/StreamSourceConduit;
      42: invokespecial #69                 // Method org/xnio/conduits/PushBackStreamSourceConduit."<init>":(Lorg/xnio/conduits/StreamSourceConduit;)V
      45: astore_3
      46: aload_3
      47: new           #70                 // class io/undertow/util/PooledAdaptor
      50: dup
      51: aload_2
      52: invokespecial #71                 // Method io/undertow/util/PooledAdaptor."<init>":(Lio/undertow/connector/PooledByteBuffer;)V
      55: invokevirtual #72                 // Method org/xnio/conduits/PushBackStreamSourceConduit.pushBack:(Lorg/xnio/Pooled;)V
      58: aload_1
      59: invokevirtual #67                 // Method org/xnio/StreamConnection.getSourceChannel:()Lorg/xnio/conduits/ConduitStreamSourceChannel;
      62: aload_3
      63: invokevirtual #73                 // Method org/xnio/conduits/ConduitStreamSourceChannel.setConduit:(Lorg/xnio/conduits/StreamSourceConduit;)V
      66: aload_0
      67: getfield      #10                 // Field openListener:Lio/undertow/server/OpenListener;
      70: aload_1
      71: invokeinterface #79,  2           // InterfaceMethod io/undertow/server/OpenListener.handleEvent:(Ljava/nio/channels/Channel;)V
      76: return

  static java.net.InetAddress parseAddress(java.lang.String, java.lang.String) throws java.io.IOException;
    Code:
       0: aload_1
       1: ldc           #58                 // String TCP4
       3: invokevirtual #57                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       6: ifeq          14
       9: aload_0
      10: invokestatic  #80                 // Method io/undertow/util/NetworkUtils.parseIpv4Address:(Ljava/lang/String;)Ljava/net/InetAddress;
      13: areturn
      14: aload_0
      15: invokestatic  #81                 // Method io/undertow/util/NetworkUtils.parseIpv6Address:(Ljava/lang/String;)Ljava/net/InetAddress;
      18: areturn

  public void handleEvent(java.nio.channels.Channel);
    Code:
       0: aload_0
       1: aload_1
       2: checkcast     #82                 // class org/xnio/channels/StreamSourceChannel
       5: invokevirtual #83                 // Method handleEvent:(Lorg/xnio/channels/StreamSourceChannel;)V
       8: return

  static {};
    Code:
       0: ldc           #84                 // String PROXY
       2: getstatic     #85                 // Field java/nio/charset/StandardCharsets.US_ASCII:Ljava/nio/charset/Charset;
       5: invokevirtual #86                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
       8: putstatic     #32                 // Field NAME:[B
      11: bipush        12
      13: newarray       byte
      15: dup
      16: iconst_0
      17: bipush        13
      19: bastore
      20: dup
      21: iconst_1
      22: bipush        10
      24: bastore
      25: dup
      26: iconst_2
      27: bipush        13
      29: bastore
      30: dup
      31: iconst_3
      32: bipush        10
      34: bastore
      35: dup
      36: iconst_4
      37: iconst_0
      38: bastore
      39: dup
      40: iconst_5
      41: bipush        13
      43: bastore
      44: dup
      45: bipush        6
      47: bipush        10
      49: bastore
      50: dup
      51: bipush        7
      53: bipush        81
      55: bastore
      56: dup
      57: bipush        8
      59: bipush        85
      61: bastore
      62: dup
      63: bipush        9
      65: bipush        73
      67: bastore
      68: dup
      69: bipush        10
      71: bipush        84
      73: bastore
      74: dup
      75: bipush        11
      77: bipush        10
      79: bastore
      80: putstatic     #30                 // Field SIG:[B
      83: return
}
