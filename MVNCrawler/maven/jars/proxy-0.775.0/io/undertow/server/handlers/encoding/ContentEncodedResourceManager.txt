Compiled from "ContentEncodedResourceManager.java"
public class io.undertow.server.handlers.encoding.ContentEncodedResourceManager {
  private final java.nio.file.Path encodedResourcesRoot;

  private final io.undertow.server.handlers.resource.CachingResourceManager encoded;

  private final io.undertow.server.handlers.encoding.ContentEncodingRepository contentEncodingRepository;

  private final int minResourceSize;

  private final int maxResourceSize;

  private final io.undertow.predicate.Predicate encodingAllowed;

  private final java.util.concurrent.ConcurrentMap<io.undertow.server.handlers.encoding.ContentEncodedResourceManager$LockKey, java.lang.Object> fileLocks;

  public io.undertow.server.handlers.encoding.ContentEncodedResourceManager(java.nio.file.Path, io.undertow.server.handlers.resource.CachingResourceManager, io.undertow.server.handlers.encoding.ContentEncodingRepository, int, int, io.undertow.predicate.Predicate);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/concurrent/ConcurrentHashMap
       8: dup
       9: invokespecial #3                  // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      12: putfield      #4                  // Field fileLocks:Ljava/util/concurrent/ConcurrentMap;
      15: aload_0
      16: aload_1
      17: putfield      #5                  // Field encodedResourcesRoot:Ljava/nio/file/Path;
      20: aload_0
      21: aload_2
      22: putfield      #6                  // Field encoded:Lio/undertow/server/handlers/resource/CachingResourceManager;
      25: aload_0
      26: aload_3
      27: putfield      #7                  // Field contentEncodingRepository:Lio/undertow/server/handlers/encoding/ContentEncodingRepository;
      30: aload_0
      31: iload         4
      33: putfield      #8                  // Field minResourceSize:I
      36: aload_0
      37: iload         5
      39: putfield      #9                  // Field maxResourceSize:I
      42: aload_0
      43: aload         6
      45: putfield      #10                 // Field encodingAllowed:Lio/undertow/predicate/Predicate;
      48: return

  public io.undertow.server.handlers.encoding.ContentEncodedResource getResource(io.undertow.server.handlers.resource.Resource, io.undertow.server.HttpServerExchange) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokeinterface #11,  1           // InterfaceMethod io/undertow/server/handlers/resource/Resource.getPath:()Ljava/lang/String;
       6: astore_3
       7: aload_1
       8: invokeinterface #12,  1           // InterfaceMethod io/undertow/server/handlers/resource/Resource.getFilePath:()Ljava/nio/file/Path;
      13: astore        4
      15: aload         4
      17: ifnonnull     22
      20: aconst_null
      21: areturn
      22: aload_0
      23: getfield      #8                  // Field minResourceSize:I
      26: ifle          47
      29: aload_1
      30: invokeinterface #13,  1           // InterfaceMethod io/undertow/server/handlers/resource/Resource.getContentLength:()Ljava/lang/Long;
      35: invokevirtual #14                 // Method java/lang/Long.longValue:()J
      38: aload_0
      39: getfield      #8                  // Field minResourceSize:I
      42: i2l
      43: lcmp
      44: iflt          92
      47: aload_0
      48: getfield      #9                  // Field maxResourceSize:I
      51: ifle          72
      54: aload_1
      55: invokeinterface #13,  1           // InterfaceMethod io/undertow/server/handlers/resource/Resource.getContentLength:()Ljava/lang/Long;
      60: invokevirtual #14                 // Method java/lang/Long.longValue:()J
      63: aload_0
      64: getfield      #9                  // Field maxResourceSize:I
      67: i2l
      68: lcmp
      69: ifgt          92
      72: aload_0
      73: getfield      #10                 // Field encodingAllowed:Lio/undertow/predicate/Predicate;
      76: ifnull        94
      79: aload_0
      80: getfield      #10                 // Field encodingAllowed:Lio/undertow/predicate/Predicate;
      83: aload_2
      84: invokeinterface #15,  2           // InterfaceMethod io/undertow/predicate/Predicate.resolve:(Lio/undertow/server/HttpServerExchange;)Z
      89: ifne          94
      92: aconst_null
      93: areturn
      94: aload_0
      95: getfield      #7                  // Field contentEncodingRepository:Lio/undertow/server/handlers/encoding/ContentEncodingRepository;
      98: aload_2
      99: invokevirtual #16                 // Method io/undertow/server/handlers/encoding/ContentEncodingRepository.getContentEncodings:(Lio/undertow/server/HttpServerExchange;)Lio/undertow/server/handlers/encoding/AllowedContentEncodings;
     102: astore        5
     104: aload         5
     106: ifnull        117
     109: aload         5
     111: invokevirtual #17                 // Method io/undertow/server/handlers/encoding/AllowedContentEncodings.isNoEncodingsAllowed:()Z
     114: ifeq          119
     117: aconst_null
     118: areturn
     119: aload         5
     121: invokevirtual #18                 // Method io/undertow/server/handlers/encoding/AllowedContentEncodings.getEncoding:()Lio/undertow/server/handlers/encoding/EncodingMapping;
     124: astore        6
     126: aload         6
     128: ifnull        144
     131: aload         6
     133: invokevirtual #19                 // Method io/undertow/server/handlers/encoding/EncodingMapping.getName:()Ljava/lang/String;
     136: ldc           #21                 // String identity
     138: invokevirtual #22                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     141: ifeq          146
     144: aconst_null
     145: areturn
     146: aload_3
     147: aload         6
     149: invokevirtual #19                 // Method io/undertow/server/handlers/encoding/EncodingMapping.getName:()Ljava/lang/String;
     152: invokedynamic #23,  0             // InvokeDynamic #0:makeConcatWithConstants:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     157: astore        7
     159: aload_0
     160: getfield      #6                  // Field encoded:Lio/undertow/server/handlers/resource/CachingResourceManager;
     163: aload         7
     165: invokevirtual #24                 // Method io/undertow/server/handlers/resource/CachingResourceManager.getResource:(Ljava/lang/String;)Lio/undertow/server/handlers/resource/CachedResource;
     168: astore        8
     170: aload         8
     172: ifnull        190
     175: new           #25                 // class io/undertow/server/handlers/encoding/ContentEncodedResource
     178: dup
     179: aload         8
     181: aload         6
     183: invokevirtual #19                 // Method io/undertow/server/handlers/encoding/EncodingMapping.getName:()Ljava/lang/String;
     186: invokespecial #26                 // Method io/undertow/server/handlers/encoding/ContentEncodedResource."<init>":(Lio/undertow/server/handlers/resource/Resource;Ljava/lang/String;)V
     189: areturn
     190: new           #27                 // class io/undertow/server/handlers/encoding/ContentEncodedResourceManager$LockKey
     193: dup
     194: aload_3
     195: aload         6
     197: invokevirtual #19                 // Method io/undertow/server/handlers/encoding/EncodingMapping.getName:()Ljava/lang/String;
     200: invokespecial #28                 // Method io/undertow/server/handlers/encoding/ContentEncodedResourceManager$LockKey."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     203: astore        9
     205: aload_0
     206: getfield      #4                  // Field fileLocks:Ljava/util/concurrent/ConcurrentMap;
     209: aload         9
     211: aload_0
     212: invokeinterface #29,  3           // InterfaceMethod java/util/concurrent/ConcurrentMap.putIfAbsent:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     217: ifnull        222
     220: aconst_null
     221: areturn
     222: aconst_null
     223: astore        10
     225: aconst_null
     226: astore        11
     228: aload_0
     229: getfield      #6                  // Field encoded:Lio/undertow/server/handlers/resource/CachingResourceManager;
     232: aload         7
     234: invokevirtual #24                 // Method io/undertow/server/handlers/resource/CachingResourceManager.getResource:(Ljava/lang/String;)Lio/undertow/server/handlers/resource/CachedResource;
     237: astore        8
     239: aload         8
     241: ifnull        285
     244: new           #25                 // class io/undertow/server/handlers/encoding/ContentEncodedResource
     247: dup
     248: aload         8
     250: aload         6
     252: invokevirtual #19                 // Method io/undertow/server/handlers/encoding/EncodingMapping.getName:()Ljava/lang/String;
     255: invokespecial #26                 // Method io/undertow/server/handlers/encoding/ContentEncodedResource."<init>":(Lio/undertow/server/handlers/resource/Resource;Ljava/lang/String;)V
     258: astore        12
     260: aload         10
     262: invokestatic  #30                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
     265: aload         11
     267: invokestatic  #30                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
     270: aload_0
     271: getfield      #4                  // Field fileLocks:Ljava/util/concurrent/ConcurrentMap;
     274: aload         9
     276: invokeinterface #31,  2           // InterfaceMethod java/util/concurrent/ConcurrentMap.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     281: pop
     282: aload         12
     284: areturn
     285: aload_0
     286: getfield      #5                  // Field encodedResourcesRoot:Ljava/nio/file/Path;
     289: aload         7
     291: invokeinterface #32,  2           // InterfaceMethod java/nio/file/Path.resolve:(Ljava/lang/String;)Ljava/nio/file/Path;
     296: astore        12
     298: aload_0
     299: getfield      #5                  // Field encodedResourcesRoot:Ljava/nio/file/Path;
     302: aload         7
     304: invokeinterface #32,  2           // InterfaceMethod java/nio/file/Path.resolve:(Ljava/lang/String;)Ljava/nio/file/Path;
     309: astore        13
     311: aload         13
     313: iconst_0
     314: anewarray     #33                 // class java/nio/file/OpenOption
     317: invokestatic  #34                 // Method java/nio/file/Files.newOutputStream:(Ljava/nio/file/Path;[Ljava/nio/file/OpenOption;)Ljava/io/OutputStream;
     320: astore        14
     322: aload         14
     324: invokevirtual #35                 // Method java/io/OutputStream.close:()V
     327: aload         14
     329: invokestatic  #30                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
     332: goto          345
     335: astore        15
     337: aload         14
     339: invokestatic  #30                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
     342: aload         15
     344: athrow
     345: aload         13
     347: iconst_2
     348: anewarray     #33                 // class java/nio/file/OpenOption
     351: dup
     352: iconst_0
     353: getstatic     #36                 // Field java/nio/file/StandardOpenOption.READ:Ljava/nio/file/StandardOpenOption;
     356: aastore
     357: dup
     358: iconst_1
     359: getstatic     #37                 // Field java/nio/file/StandardOpenOption.WRITE:Ljava/nio/file/StandardOpenOption;
     362: aastore
     363: invokestatic  #38                 // Method java/nio/channels/FileChannel.open:(Ljava/nio/file/Path;[Ljava/nio/file/OpenOption;)Ljava/nio/channels/FileChannel;
     366: astore        10
     368: aload         4
     370: iconst_1
     371: anewarray     #33                 // class java/nio/file/OpenOption
     374: dup
     375: iconst_0
     376: getstatic     #36                 // Field java/nio/file/StandardOpenOption.READ:Ljava/nio/file/StandardOpenOption;
     379: aastore
     380: invokestatic  #38                 // Method java/nio/channels/FileChannel.open:(Ljava/nio/file/Path;[Ljava/nio/file/OpenOption;)Ljava/nio/channels/FileChannel;
     383: astore        11
     385: aload         6
     387: invokevirtual #39                 // Method io/undertow/server/handlers/encoding/EncodingMapping.getEncoding:()Lio/undertow/server/handlers/encoding/ContentEncodingProvider;
     390: invokeinterface #40,  1           // InterfaceMethod io/undertow/server/handlers/encoding/ContentEncodingProvider.getResponseWrapper:()Lio/undertow/server/ConduitWrapper;
     395: new           #41                 // class io/undertow/util/ImmediateConduitFactory
     398: dup
     399: new           #42                 // class io/undertow/server/handlers/encoding/ContentEncodedResourceManager$FileConduitTarget
     402: dup
     403: aload         10
     405: aload_2
     406: invokespecial #43                 // Method io/undertow/server/handlers/encoding/ContentEncodedResourceManager$FileConduitTarget."<init>":(Ljava/nio/channels/FileChannel;Lio/undertow/server/HttpServerExchange;)V
     409: invokespecial #44                 // Method io/undertow/util/ImmediateConduitFactory."<init>":(Lorg/xnio/conduits/Conduit;)V
     412: aload_2
     413: invokeinterface #45,  3           // InterfaceMethod io/undertow/server/ConduitWrapper.wrap:(Lio/undertow/util/ConduitFactory;Lio/undertow/server/HttpServerExchange;)Lorg/xnio/conduits/Conduit;
     418: checkcast     #46                 // class org/xnio/conduits/StreamSinkConduit
     421: astore        15
     423: new           #47                 // class org/xnio/conduits/ConduitStreamSinkChannel
     426: dup
     427: aconst_null
     428: aload         15
     430: invokespecial #48                 // Method org/xnio/conduits/ConduitStreamSinkChannel."<init>":(Lorg/xnio/channels/Configurable;Lorg/xnio/conduits/StreamSinkConduit;)V
     433: astore        16
     435: aload         11
     437: lconst_0
     438: aload_1
     439: invokeinterface #13,  1           // InterfaceMethod io/undertow/server/handlers/resource/Resource.getContentLength:()Ljava/lang/Long;
     444: invokevirtual #14                 // Method java/lang/Long.longValue:()J
     447: aload         16
     449: invokevirtual #49                 // Method java/nio/channels/FileChannel.transferTo:(JJLjava/nio/channels/WritableByteChannel;)J
     452: lstore        17
     454: aload         16
     456: invokevirtual #50                 // Method org/xnio/conduits/ConduitStreamSinkChannel.shutdownWrites:()V
     459: aload         16
     461: invokestatic  #51                 // Method org/xnio/channels/Channels.flushBlocking:(Lorg/xnio/channels/SuspendableWriteChannel;)V
     464: lload         17
     466: aload_1
     467: invokeinterface #13,  1           // InterfaceMethod io/undertow/server/handlers/resource/Resource.getContentLength:()Ljava/lang/Long;
     472: invokevirtual #14                 // Method java/lang/Long.longValue:()J
     475: lcmp
     476: ifeq          487
     479: getstatic     #52                 // Field io/undertow/UndertowLogger.REQUEST_LOGGER:Lio/undertow/UndertowLogger;
     482: invokeinterface #53,  1           // InterfaceMethod io/undertow/UndertowLogger.failedToWritePreCachedFile:()V
     487: aload         13
     489: aload         12
     491: iconst_0
     492: anewarray     #54                 // class java/nio/file/CopyOption
     495: invokestatic  #55                 // Method java/nio/file/Files.move:(Ljava/nio/file/Path;Ljava/nio/file/Path;[Ljava/nio/file/CopyOption;)Ljava/nio/file/Path;
     498: pop
     499: aload_0
     500: getfield      #6                  // Field encoded:Lio/undertow/server/handlers/resource/CachingResourceManager;
     503: aload         7
     505: invokevirtual #56                 // Method io/undertow/server/handlers/resource/CachingResourceManager.invalidate:(Ljava/lang/String;)V
     508: aload_0
     509: getfield      #6                  // Field encoded:Lio/undertow/server/handlers/resource/CachingResourceManager;
     512: aload         7
     514: invokevirtual #24                 // Method io/undertow/server/handlers/resource/CachingResourceManager.getResource:(Ljava/lang/String;)Lio/undertow/server/handlers/resource/CachedResource;
     517: astore        19
     519: new           #25                 // class io/undertow/server/handlers/encoding/ContentEncodedResource
     522: dup
     523: aload         19
     525: aload         6
     527: invokevirtual #19                 // Method io/undertow/server/handlers/encoding/EncodingMapping.getName:()Ljava/lang/String;
     530: invokespecial #26                 // Method io/undertow/server/handlers/encoding/ContentEncodedResource."<init>":(Lio/undertow/server/handlers/resource/Resource;Ljava/lang/String;)V
     533: astore        20
     535: aload         10
     537: invokestatic  #30                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
     540: aload         11
     542: invokestatic  #30                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
     545: aload_0
     546: getfield      #4                  // Field fileLocks:Ljava/util/concurrent/ConcurrentMap;
     549: aload         9
     551: invokeinterface #31,  2           // InterfaceMethod java/util/concurrent/ConcurrentMap.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     556: pop
     557: aload         20
     559: areturn
     560: astore        21
     562: aload         10
     564: invokestatic  #30                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
     567: aload         11
     569: invokestatic  #30                 // Method org/xnio/IoUtils.safeClose:(Ljava/io/Closeable;)V
     572: aload_0
     573: getfield      #4                  // Field fileLocks:Ljava/util/concurrent/ConcurrentMap;
     576: aload         9
     578: invokeinterface #31,  2           // InterfaceMethod java/util/concurrent/ConcurrentMap.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     583: pop
     584: aload         21
     586: athrow
    Exception table:
       from    to  target type
         322   327   335   any
         335   337   335   any
         228   260   560   any
         285   535   560   any
         560   562   560   any
}
