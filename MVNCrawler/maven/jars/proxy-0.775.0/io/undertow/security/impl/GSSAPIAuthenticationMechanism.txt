Compiled from "GSSAPIAuthenticationMechanism.java"
public class io.undertow.security.impl.GSSAPIAuthenticationMechanism implements io.undertow.security.api.AuthenticationMechanism {
  public static final io.undertow.server.handlers.proxy.ExclusivityChecker EXCLUSIVITY_CHECKER;

  private static final java.lang.String NEGOTIATION_PLAIN;

  private static final java.lang.String NEGOTIATE_PREFIX;

  private static final org.ietf.jgss.Oid[] DEFAULT_MECHANISMS;

  private static final java.lang.String name;

  private final io.undertow.security.idm.IdentityManager identityManager;

  private final io.undertow.security.api.GSSAPIServerSubjectFactory subjectFactory;

  private final org.ietf.jgss.Oid[] mechanisms;

  public io.undertow.security.impl.GSSAPIAuthenticationMechanism(io.undertow.security.api.GSSAPIServerSubjectFactory, io.undertow.security.idm.IdentityManager, org.ietf.jgss.Oid...);
    Code:
       0: aload_0
       1: invokespecial #2                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #3                  // Field subjectFactory:Lio/undertow/security/api/GSSAPIServerSubjectFactory;
       9: aload_0
      10: aload_2
      11: putfield      #4                  // Field identityManager:Lio/undertow/security/idm/IdentityManager;
      14: aload_0
      15: aload_3
      16: putfield      #5                  // Field mechanisms:[Lorg/ietf/jgss/Oid;
      19: return

  public io.undertow.security.impl.GSSAPIAuthenticationMechanism(io.undertow.security.api.GSSAPIServerSubjectFactory, org.ietf.jgss.Oid...);
    Code:
       0: aload_0
       1: aload_1
       2: aconst_null
       3: aload_2
       4: invokespecial #6                  // Method "<init>":(Lio/undertow/security/api/GSSAPIServerSubjectFactory;Lio/undertow/security/idm/IdentityManager;[Lorg/ietf/jgss/Oid;)V
       7: return

  public io.undertow.security.impl.GSSAPIAuthenticationMechanism(io.undertow.security.api.GSSAPIServerSubjectFactory);
    Code:
       0: aload_0
       1: aload_1
       2: getstatic     #7                  // Field DEFAULT_MECHANISMS:[Lorg/ietf/jgss/Oid;
       5: invokespecial #8                  // Method "<init>":(Lio/undertow/security/api/GSSAPIServerSubjectFactory;[Lorg/ietf/jgss/Oid;)V
       8: return

  private io.undertow.security.idm.IdentityManager getIdentityManager(io.undertow.security.api.SecurityContext);
    Code:
       0: aload_0
       1: getfield      #4                  // Field identityManager:Lio/undertow/security/idm/IdentityManager;
       4: ifnull        14
       7: aload_0
       8: getfield      #4                  // Field identityManager:Lio/undertow/security/idm/IdentityManager;
      11: goto          20
      14: aload_1
      15: invokeinterface #9,  1            // InterfaceMethod io/undertow/security/api/SecurityContext.getIdentityManager:()Lio/undertow/security/idm/IdentityManager;
      20: areturn

  public io.undertow.security.api.AuthenticationMechanism$AuthenticationMechanismOutcome authenticate(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_1
       1: invokevirtual #10                 // Method io/undertow/server/HttpServerExchange.getConnection:()Lio/undertow/server/ServerConnection;
       4: astore_3
       5: aload_3
       6: getstatic     #11                 // Field io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
       9: invokevirtual #12                 // Method io/undertow/server/ServerConnection.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
      12: checkcast     #13                 // class io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext
      15: astore        4
      17: aload         4
      19: ifnull        137
      22: getstatic     #14                 // Field io/undertow/UndertowLogger.SECURITY_LOGGER:Lio/undertow/UndertowLogger;
      25: ldc           #15                 // String Existing negotiation context found for %s
      27: aload_1
      28: invokeinterface #16,  3           // InterfaceMethod io/undertow/UndertowLogger.debugf:(Ljava/lang/String;Ljava/lang/Object;)V
      33: aload_1
      34: getstatic     #11                 // Field io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      37: aload         4
      39: invokevirtual #17                 // Method io/undertow/server/HttpServerExchange.putAttachment:(Lio/undertow/util/AttachmentKey;Ljava/lang/Object;)Ljava/lang/Object;
      42: pop
      43: aload         4
      45: invokevirtual #18                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.isEstablished:()Z
      48: ifeq          137
      51: aload_0
      52: aload_2
      53: invokevirtual #19                 // Method getIdentityManager:(Lio/undertow/security/api/SecurityContext;)Lio/undertow/security/idm/IdentityManager;
      56: astore        5
      58: aload         5
      60: new           #20                 // class io/undertow/security/idm/GSSContextCredential
      63: dup
      64: aload         4
      66: invokevirtual #21                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.getGssContext:()Lorg/ietf/jgss/GSSContext;
      69: invokespecial #22                 // Method io/undertow/security/idm/GSSContextCredential."<init>":(Lorg/ietf/jgss/GSSContext;)V
      72: invokeinterface #23,  2           // InterfaceMethod io/undertow/security/idm/IdentityManager.verify:(Lio/undertow/security/idm/Credential;)Lio/undertow/security/idm/Account;
      77: astore        6
      79: aload         6
      81: ifnull        122
      84: aload_2
      85: aload         6
      87: ldc           #25                 // String SPNEGO
      89: iconst_0
      90: invokeinterface #26,  4           // InterfaceMethod io/undertow/security/api/SecurityContext.authenticationComplete:(Lio/undertow/security/idm/Account;Ljava/lang/String;Z)V
      95: getstatic     #14                 // Field io/undertow/UndertowLogger.SECURITY_LOGGER:Lio/undertow/UndertowLogger;
      98: ldc           #27                 // String Authenticated as user %s with existing GSSAPI negotiation context for %s
     100: aload         6
     102: invokeinterface #28,  1           // InterfaceMethod io/undertow/security/idm/Account.getPrincipal:()Ljava/security/Principal;
     107: invokeinterface #29,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
     112: aload_1
     113: invokeinterface #30,  4           // InterfaceMethod io/undertow/UndertowLogger.debugf:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     118: getstatic     #31                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     121: areturn
     122: getstatic     #14                 // Field io/undertow/UndertowLogger.SECURITY_LOGGER:Lio/undertow/UndertowLogger;
     125: ldc           #32                 // String Failed to authenticate with existing GSSAPI negotiation context for %s
     127: aload_1
     128: invokeinterface #16,  3           // InterfaceMethod io/undertow/UndertowLogger.debugf:(Ljava/lang/String;Ljava/lang/Object;)V
     133: getstatic     #33                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     136: areturn
     137: aload_1
     138: invokevirtual #34                 // Method io/undertow/server/HttpServerExchange.getRequestHeaders:()Lio/undertow/util/HeaderMap;
     141: getstatic     #35                 // Field io/undertow/util/Headers.AUTHORIZATION:Lio/undertow/util/HttpString;
     144: invokevirtual #36                 // Method io/undertow/util/HeaderMap.get:(Lio/undertow/util/HttpString;)Lio/undertow/util/HeaderValues;
     147: astore        5
     149: aload         5
     151: ifnull        234
     154: aload         5
     156: invokeinterface #37,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     161: astore        6
     163: aload         6
     165: invokeinterface #38,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     170: ifeq          234
     173: aload         6
     175: invokeinterface #39,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     180: checkcast     #40                 // class java/lang/String
     183: astore        7
     185: aload         7
     187: getstatic     #41                 // Field NEGOTIATE_PREFIX:Ljava/lang/String;
     190: invokevirtual #42                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     193: ifeq          231
     196: aload         7
     198: getstatic     #41                 // Field NEGOTIATE_PREFIX:Ljava/lang/String;
     201: invokevirtual #43                 // Method java/lang/String.length:()I
     204: invokevirtual #44                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     207: astore        8
     209: aload         8
     211: invokestatic  #45                 // Method io/undertow/util/FlexBase64.decode:(Ljava/lang/String;)Ljava/nio/ByteBuffer;
     214: astore        9
     216: aload_0
     217: aload_1
     218: aload         9
     220: aload_2
     221: invokevirtual #46                 // Method runGSSAPI:(Lio/undertow/server/HttpServerExchange;Ljava/nio/ByteBuffer;Lio/undertow/security/api/SecurityContext;)Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     224: areturn
     225: astore        9
     227: getstatic     #33                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     230: areturn
     231: goto          163
     234: getstatic     #48                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_ATTEMPTED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     237: areturn
    Exception table:
       from    to  target type
         209   224   225   Class java/io/IOException

  public io.undertow.security.api.AuthenticationMechanism$ChallengeResult sendChallenge(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_1
       1: getstatic     #11                 // Field io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
       4: invokevirtual #49                 // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
       7: checkcast     #13                 // class io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext
      10: astore_3
      11: getstatic     #50                 // Field NEGOTIATION_PLAIN:Ljava/lang/String;
      14: astore        4
      16: aload_3
      17: ifnull        59
      20: aload_3
      21: invokevirtual #51                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.useResponseToken:()[B
      24: astore        5
      26: aload_1
      27: getstatic     #11                 // Field io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      30: aconst_null
      31: invokevirtual #17                 // Method io/undertow/server/HttpServerExchange.putAttachment:(Lio/undertow/util/AttachmentKey;Ljava/lang/Object;)Ljava/lang/Object;
      34: pop
      35: aload         5
      37: ifnull        56
      40: getstatic     #41                 // Field NEGOTIATE_PREFIX:Ljava/lang/String;
      43: aload         5
      45: iconst_0
      46: invokestatic  #52                 // Method io/undertow/util/FlexBase64.encodeString:([BZ)Ljava/lang/String;
      49: invokedynamic #53,  0             // InvokeDynamic #0:makeConcatWithConstants:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      54: astore        4
      56: goto          92
      59: aconst_null
      60: astore        5
      62: aload_0
      63: getfield      #3                  // Field subjectFactory:Lio/undertow/security/api/GSSAPIServerSubjectFactory;
      66: aload_0
      67: aload_1
      68: invokevirtual #54                 // Method getHostName:(Lio/undertow/server/HttpServerExchange;)Ljava/lang/String;
      71: invokeinterface #55,  2           // InterfaceMethod io/undertow/security/api/GSSAPIServerSubjectFactory.getSubjectForHost:(Ljava/lang/String;)Ljavax/security/auth/Subject;
      76: astore        5
      78: goto          83
      81: astore        6
      83: aload         5
      85: ifnonnull     92
      88: getstatic     #57                 // Field io/undertow/security/api/AuthenticationMechanism$ChallengeResult.NOT_SENT:Lio/undertow/security/api/AuthenticationMechanism$ChallengeResult;
      91: areturn
      92: aload_1
      93: invokevirtual #58                 // Method io/undertow/server/HttpServerExchange.getResponseHeaders:()Lio/undertow/util/HeaderMap;
      96: getstatic     #59                 // Field io/undertow/util/Headers.WWW_AUTHENTICATE:Lio/undertow/util/HttpString;
      99: aload         4
     101: invokevirtual #60                 // Method io/undertow/util/HeaderMap.add:(Lio/undertow/util/HttpString;Ljava/lang/String;)Lio/undertow/util/HeaderMap;
     104: pop
     105: getstatic     #14                 // Field io/undertow/UndertowLogger.SECURITY_LOGGER:Lio/undertow/UndertowLogger;
     108: ldc           #61                 // String Sending GSSAPI challenge for %s
     110: aload_1
     111: invokeinterface #16,  3           // InterfaceMethod io/undertow/UndertowLogger.debugf:(Ljava/lang/String;Ljava/lang/Object;)V
     116: new           #62                 // class io/undertow/security/api/AuthenticationMechanism$ChallengeResult
     119: dup
     120: iconst_1
     121: sipush        401
     124: invokestatic  #63                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     127: invokespecial #64                 // Method io/undertow/security/api/AuthenticationMechanism$ChallengeResult."<init>":(ZLjava/lang/Integer;)V
     130: areturn
    Exception table:
       from    to  target type
          62    78    81   Class java/security/GeneralSecurityException

  public io.undertow.security.api.AuthenticationMechanism$AuthenticationMechanismOutcome runGSSAPI(io.undertow.server.HttpServerExchange, java.nio.ByteBuffer, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_0
       1: getfield      #3                  // Field subjectFactory:Lio/undertow/security/api/GSSAPIServerSubjectFactory;
       4: aload_0
       5: aload_1
       6: invokevirtual #54                 // Method getHostName:(Lio/undertow/server/HttpServerExchange;)Ljava/lang/String;
       9: invokeinterface #55,  2           // InterfaceMethod io/undertow/security/api/GSSAPIServerSubjectFactory.getSubjectForHost:(Ljava/lang/String;)Ljavax/security/auth/Subject;
      14: astore        4
      16: aload         4
      18: new           #65                 // class io/undertow/security/impl/GSSAPIAuthenticationMechanism$AcceptSecurityContext
      21: dup
      22: aload_0
      23: aload_1
      24: aload_2
      25: aload_3
      26: invokespecial #66                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$AcceptSecurityContext."<init>":(Lio/undertow/security/impl/GSSAPIAuthenticationMechanism;Lio/undertow/server/HttpServerExchange;Ljava/nio/ByteBuffer;Lio/undertow/security/api/SecurityContext;)V
      29: invokestatic  #67                 // Method javax/security/auth/Subject.doAs:(Ljavax/security/auth/Subject;Ljava/security/PrivilegedExceptionAction;)Ljava/lang/Object;
      32: checkcast     #68                 // class io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome
      35: areturn
      36: astore        4
      38: getstatic     #14                 // Field io/undertow/UndertowLogger.SECURITY_LOGGER:Lio/undertow/UndertowLogger;
      41: aload_1
      42: aload         4
      44: invokeinterface #69,  3           // InterfaceMethod io/undertow/UndertowLogger.failedToObtainSubject:(Lio/undertow/server/HttpServerExchange;Ljava/security/GeneralSecurityException;)V
      49: getstatic     #33                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
      52: areturn
      53: astore        4
      55: getstatic     #14                 // Field io/undertow/UndertowLogger.SECURITY_LOGGER:Lio/undertow/UndertowLogger;
      58: aload_1
      59: aload         4
      61: invokevirtual #71                 // Method java/security/PrivilegedActionException.getCause:()Ljava/lang/Throwable;
      64: invokeinterface #72,  3           // InterfaceMethod io/undertow/UndertowLogger.failedToNegotiateAtGSSAPI:(Lio/undertow/server/HttpServerExchange;Ljava/lang/Throwable;)V
      69: getstatic     #33                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
      72: areturn
    Exception table:
       from    to  target type
           0    35    36   Class java/security/GeneralSecurityException
           0    35    53   Class java/security/PrivilegedActionException

  private java.lang.String getHostName(io.undertow.server.HttpServerExchange);
    Code:
       0: aload_1
       1: invokevirtual #34                 // Method io/undertow/server/HttpServerExchange.getRequestHeaders:()Lio/undertow/util/HeaderMap;
       4: getstatic     #73                 // Field io/undertow/util/Headers.HOST:Lio/undertow/util/HttpString;
       7: invokevirtual #74                 // Method io/undertow/util/HeaderMap.getFirst:(Lio/undertow/util/HttpString;)Ljava/lang/String;
      10: astore_2
      11: aload_2
      12: ifnull        73
      15: aload_2
      16: ldc           #75                 // String [
      18: invokevirtual #42                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      21: ifeq          50
      24: aload_2
      25: ldc           #76                 // String ]
      27: invokevirtual #77                 // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
      30: ifeq          50
      33: aload_2
      34: iconst_0
      35: aload_2
      36: bipush        93
      38: invokevirtual #78                 // Method java/lang/String.indexOf:(I)I
      41: iconst_1
      42: iadd
      43: invokevirtual #79                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      46: astore_2
      47: goto          71
      50: aload_2
      51: ldc           #80                 // String :
      53: invokevirtual #77                 // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
      56: ifeq          71
      59: aload_2
      60: iconst_0
      61: aload_2
      62: ldc           #80                 // String :
      64: invokevirtual #81                 // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      67: invokevirtual #79                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      70: astore_2
      71: aload_2
      72: areturn
      73: aconst_null
      74: areturn

  static {};
    Code:
       0: new           #82                 // class io/undertow/security/impl/GSSAPIAuthenticationMechanism$1
       3: dup
       4: invokespecial #83                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$1."<init>":()V
       7: putstatic     #84                 // Field EXCLUSIVITY_CHECKER:Lio/undertow/server/handlers/proxy/ExclusivityChecker;
      10: getstatic     #85                 // Field io/undertow/util/Headers.NEGOTIATE:Lio/undertow/util/HttpString;
      13: invokevirtual #86                 // Method io/undertow/util/HttpString.toString:()Ljava/lang/String;
      16: putstatic     #50                 // Field NEGOTIATION_PLAIN:Ljava/lang/String;
      19: getstatic     #85                 // Field io/undertow/util/Headers.NEGOTIATE:Lio/undertow/util/HttpString;
      22: invokedynamic #87,  0             // InvokeDynamic #1:makeConcatWithConstants:(Lio/undertow/util/HttpString;)Ljava/lang/String;
      27: putstatic     #41                 // Field NEGOTIATE_PREFIX:Ljava/lang/String;
      30: new           #88                 // class org/ietf/jgss/Oid
      33: dup
      34: ldc           #89                 // String 1.3.6.1.5.5.2
      36: invokespecial #90                 // Method org/ietf/jgss/Oid."<init>":(Ljava/lang/String;)V
      39: astore_0
      40: new           #88                 // class org/ietf/jgss/Oid
      43: dup
      44: ldc           #91                 // String 1.2.840.113554.1.2.2
      46: invokespecial #90                 // Method org/ietf/jgss/Oid."<init>":(Ljava/lang/String;)V
      49: astore_1
      50: iconst_2
      51: anewarray     #88                 // class org/ietf/jgss/Oid
      54: dup
      55: iconst_0
      56: aload_0
      57: aastore
      58: dup
      59: iconst_1
      60: aload_1
      61: aastore
      62: putstatic     #7                  // Field DEFAULT_MECHANISMS:[Lorg/ietf/jgss/Oid;
      65: goto          78
      68: astore_0
      69: new           #93                 // class java/lang/RuntimeException
      72: dup
      73: aload_0
      74: invokespecial #94                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
      77: athrow
      78: return
    Exception table:
       from    to  target type
          30    65    68   Class org/ietf/jgss/GSSException
}
