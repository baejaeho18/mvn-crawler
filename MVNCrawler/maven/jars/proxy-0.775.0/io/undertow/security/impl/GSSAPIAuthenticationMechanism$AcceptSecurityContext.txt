Compiled from "GSSAPIAuthenticationMechanism.java"
class io.undertow.security.impl.GSSAPIAuthenticationMechanism$AcceptSecurityContext implements java.security.PrivilegedExceptionAction<io.undertow.security.api.AuthenticationMechanism$AuthenticationMechanismOutcome> {
  private final io.undertow.server.HttpServerExchange exchange;

  private final java.nio.ByteBuffer challenge;

  private final io.undertow.security.api.SecurityContext securityContext;

  final io.undertow.security.impl.GSSAPIAuthenticationMechanism this$0;

  private io.undertow.security.impl.GSSAPIAuthenticationMechanism$AcceptSecurityContext(io.undertow.security.impl.GSSAPIAuthenticationMechanism, io.undertow.server.HttpServerExchange, java.nio.ByteBuffer, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #2                  // Field this$0:Lio/undertow/security/impl/GSSAPIAuthenticationMechanism;
       5: aload_0
       6: invokespecial #3                  // Method java/lang/Object."<init>":()V
       9: aload_0
      10: aload_2
      11: putfield      #4                  // Field exchange:Lio/undertow/server/HttpServerExchange;
      14: aload_0
      15: aload_3
      16: putfield      #5                  // Field challenge:Ljava/nio/ByteBuffer;
      19: aload_0
      20: aload         4
      22: putfield      #6                  // Field securityContext:Lio/undertow/security/api/SecurityContext;
      25: return

  public io.undertow.security.api.AuthenticationMechanism$AuthenticationMechanismOutcome run() throws org.ietf.jgss.GSSException;
    Code:
       0: aload_0
       1: getfield      #4                  // Field exchange:Lio/undertow/server/HttpServerExchange;
       4: getstatic     #7                  // Field io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
       7: invokevirtual #8                  // Method io/undertow/server/HttpServerExchange.getAttachment:(Lio/undertow/util/AttachmentKey;)Ljava/lang/Object;
      10: checkcast     #9                  // class io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext
      13: astore_1
      14: aload_1
      15: ifnonnull     53
      18: new           #9                  // class io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext
      21: dup
      22: invokespecial #10                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext."<init>":()V
      25: astore_1
      26: aload_0
      27: getfield      #4                  // Field exchange:Lio/undertow/server/HttpServerExchange;
      30: getstatic     #7                  // Field io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      33: aload_1
      34: invokevirtual #11                 // Method io/undertow/server/HttpServerExchange.putAttachment:(Lio/undertow/util/AttachmentKey;Ljava/lang/Object;)Ljava/lang/Object;
      37: pop
      38: aload_0
      39: getfield      #4                  // Field exchange:Lio/undertow/server/HttpServerExchange;
      42: invokevirtual #12                 // Method io/undertow/server/HttpServerExchange.getConnection:()Lio/undertow/server/ServerConnection;
      45: getstatic     #7                  // Field io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.ATTACHMENT_KEY:Lio/undertow/util/AttachmentKey;
      48: aload_1
      49: invokevirtual #13                 // Method io/undertow/server/ServerConnection.putAttachment:(Lio/undertow/util/AttachmentKey;Ljava/lang/Object;)Ljava/lang/Object;
      52: pop
      53: aload_1
      54: invokevirtual #14                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.getGssContext:()Lorg/ietf/jgss/GSSContext;
      57: astore_2
      58: aload_2
      59: ifnonnull     95
      62: invokestatic  #15                 // Method org/ietf/jgss/GSSManager.getInstance:()Lorg/ietf/jgss/GSSManager;
      65: astore_3
      66: aload_3
      67: aconst_null
      68: ldc           #17                 // int 2147483647
      70: aload_0
      71: getfield      #2                  // Field this$0:Lio/undertow/security/impl/GSSAPIAuthenticationMechanism;
      74: getfield      #18                 // Field io/undertow/security/impl/GSSAPIAuthenticationMechanism.mechanisms:[Lorg/ietf/jgss/Oid;
      77: iconst_2
      78: invokevirtual #19                 // Method org/ietf/jgss/GSSManager.createCredential:(Lorg/ietf/jgss/GSSName;I[Lorg/ietf/jgss/Oid;I)Lorg/ietf/jgss/GSSCredential;
      81: astore        4
      83: aload_3
      84: aload         4
      86: invokevirtual #20                 // Method org/ietf/jgss/GSSManager.createContext:(Lorg/ietf/jgss/GSSCredential;)Lorg/ietf/jgss/GSSContext;
      89: astore_2
      90: aload_1
      91: aload_2
      92: invokevirtual #21                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.setGssContext:(Lorg/ietf/jgss/GSSContext;)V
      95: aload_2
      96: aload_0
      97: getfield      #5                  // Field challenge:Ljava/nio/ByteBuffer;
     100: invokevirtual #22                 // Method java/nio/ByteBuffer.array:()[B
     103: aload_0
     104: getfield      #5                  // Field challenge:Ljava/nio/ByteBuffer;
     107: invokevirtual #23                 // Method java/nio/ByteBuffer.arrayOffset:()I
     110: aload_0
     111: getfield      #5                  // Field challenge:Ljava/nio/ByteBuffer;
     114: invokevirtual #24                 // Method java/nio/ByteBuffer.limit:()I
     117: invokeinterface #25,  4           // InterfaceMethod org/ietf/jgss/GSSContext.acceptSecContext:([BII)[B
     122: astore_3
     123: aload_1
     124: aload_3
     125: invokevirtual #26                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.setResponseToken:([B)V
     128: aload_1
     129: invokevirtual #27                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.isEstablished:()Z
     132: ifeq          224
     135: aload_3
     136: ifnull        166
     139: aload_0
     140: getfield      #4                  // Field exchange:Lio/undertow/server/HttpServerExchange;
     143: invokevirtual #28                 // Method io/undertow/server/HttpServerExchange.getResponseHeaders:()Lio/undertow/util/HeaderMap;
     146: getstatic     #29                 // Field io/undertow/util/Headers.WWW_AUTHENTICATE:Lio/undertow/util/HttpString;
     149: getstatic     #30                 // Field io/undertow/security/impl/GSSAPIAuthenticationMechanism.NEGOTIATE_PREFIX:Ljava/lang/String;
     152: aload_3
     153: iconst_0
     154: invokestatic  #31                 // Method io/undertow/util/FlexBase64.encodeString:([BZ)Ljava/lang/String;
     157: invokedynamic #32,  0             // InvokeDynamic #0:makeConcatWithConstants:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     162: invokevirtual #33                 // Method io/undertow/util/HeaderMap.add:(Lio/undertow/util/HttpString;Ljava/lang/String;)Lio/undertow/util/HeaderMap;
     165: pop
     166: aload_0
     167: getfield      #6                  // Field securityContext:Lio/undertow/security/api/SecurityContext;
     170: invokeinterface #34,  1           // InterfaceMethod io/undertow/security/api/SecurityContext.getIdentityManager:()Lio/undertow/security/idm/IdentityManager;
     175: astore        4
     177: aload         4
     179: new           #35                 // class io/undertow/security/idm/GSSContextCredential
     182: dup
     183: aload_1
     184: invokevirtual #14                 // Method io/undertow/security/impl/GSSAPIAuthenticationMechanism$NegotiationContext.getGssContext:()Lorg/ietf/jgss/GSSContext;
     187: invokespecial #36                 // Method io/undertow/security/idm/GSSContextCredential."<init>":(Lorg/ietf/jgss/GSSContext;)V
     190: invokeinterface #37,  2           // InterfaceMethod io/undertow/security/idm/IdentityManager.verify:(Lio/undertow/security/idm/Credential;)Lio/undertow/security/idm/Account;
     195: astore        5
     197: aload         5
     199: ifnull        220
     202: aload_0
     203: getfield      #6                  // Field securityContext:Lio/undertow/security/api/SecurityContext;
     206: aload         5
     208: ldc           #38                 // String SPNEGO
     210: iconst_0
     211: invokeinterface #39,  4           // InterfaceMethod io/undertow/security/api/SecurityContext.authenticationComplete:(Lio/undertow/security/idm/Account;Ljava/lang/String;Z)V
     216: getstatic     #40                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     219: areturn
     220: getstatic     #41                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     223: areturn
     224: getstatic     #41                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     227: areturn

  public java.lang.Object run() throws java.lang.Exception;
    Code:
       0: aload_0
       1: invokevirtual #42                 // Method run:()Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
       4: areturn
}
