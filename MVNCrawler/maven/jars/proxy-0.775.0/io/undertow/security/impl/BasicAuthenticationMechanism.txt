Compiled from "BasicAuthenticationMechanism.java"
public class io.undertow.security.impl.BasicAuthenticationMechanism implements io.undertow.security.api.AuthenticationMechanism {
  public static final io.undertow.security.api.AuthenticationMechanismFactory FACTORY;

  public static final java.lang.String SILENT;

  public static final java.lang.String CHARSET;

  public static final java.lang.String USER_AGENT_CHARSETS;

  private final java.lang.String name;

  private final java.lang.String challenge;

  private static final java.lang.String BASIC_PREFIX;

  private static final java.lang.String LOWERCASE_BASIC_PREFIX;

  private static final int PREFIX_LENGTH;

  private static final java.lang.String COLON;

  private final boolean silent;

  private final io.undertow.security.idm.IdentityManager identityManager;

  private final java.nio.charset.Charset charset;

  private final java.util.Map<java.util.regex.Pattern, java.nio.charset.Charset> userAgentCharsets;

  public io.undertow.security.impl.BasicAuthenticationMechanism(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: ldc           #2                  // String BASIC
       4: invokespecial #3                  // Method "<init>":(Ljava/lang/String;Ljava/lang/String;)V
       7: return

  public io.undertow.security.impl.BasicAuthenticationMechanism(java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: iconst_0
       4: invokespecial #4                  // Method "<init>":(Ljava/lang/String;Ljava/lang/String;Z)V
       7: return

  public io.undertow.security.impl.BasicAuthenticationMechanism(java.lang.String, java.lang.String, boolean);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: iload_3
       4: aconst_null
       5: invokespecial #5                  // Method "<init>":(Ljava/lang/String;Ljava/lang/String;ZLio/undertow/security/idm/IdentityManager;)V
       8: return

  public io.undertow.security.impl.BasicAuthenticationMechanism(java.lang.String, java.lang.String, boolean, io.undertow.security.idm.IdentityManager);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: iload_3
       4: aload         4
       6: getstatic     #6                  // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
       9: invokestatic  #7                  // Method java/util/Collections.emptyMap:()Ljava/util/Map;
      12: invokespecial #8                  // Method "<init>":(Ljava/lang/String;Ljava/lang/String;ZLio/undertow/security/idm/IdentityManager;Ljava/nio/charset/Charset;Ljava/util/Map;)V
      15: return

  public io.undertow.security.impl.BasicAuthenticationMechanism(java.lang.String, java.lang.String, boolean, io.undertow.security.idm.IdentityManager, java.nio.charset.Charset, java.util.Map<java.util.regex.Pattern, java.nio.charset.Charset>);
    Code:
       0: aload_0
       1: invokespecial #9                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: getstatic     #10                 // Field BASIC_PREFIX:Ljava/lang/String;
       8: aload_1
       9: invokedynamic #11,  0             // InvokeDynamic #0:makeConcatWithConstants:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      14: putfield      #12                 // Field challenge:Ljava/lang/String;
      17: aload_0
      18: aload_2
      19: putfield      #13                 // Field name:Ljava/lang/String;
      22: aload_0
      23: iload_3
      24: putfield      #14                 // Field silent:Z
      27: aload_0
      28: aload         4
      30: putfield      #15                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
      33: aload_0
      34: aload         5
      36: putfield      #16                 // Field charset:Ljava/nio/charset/Charset;
      39: aload_0
      40: new           #17                 // class java/util/LinkedHashMap
      43: dup
      44: aload         6
      46: invokespecial #18                 // Method java/util/LinkedHashMap."<init>":(Ljava/util/Map;)V
      49: invokestatic  #19                 // Method java/util/Collections.unmodifiableMap:(Ljava/util/Map;)Ljava/util/Map;
      52: putfield      #20                 // Field userAgentCharsets:Ljava/util/Map;
      55: return

  private io.undertow.security.idm.IdentityManager getIdentityManager(io.undertow.security.api.SecurityContext);
    Code:
       0: aload_0
       1: getfield      #15                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
       4: ifnull        14
       7: aload_0
       8: getfield      #15                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
      11: goto          20
      14: aload_1
      15: invokeinterface #21,  1           // InterfaceMethod io/undertow/security/api/SecurityContext.getIdentityManager:()Lio/undertow/security/idm/IdentityManager;
      20: areturn

  public io.undertow.security.api.AuthenticationMechanism$AuthenticationMechanismOutcome authenticate(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_1
       1: invokevirtual #22                 // Method io/undertow/server/HttpServerExchange.getRequestHeaders:()Lio/undertow/util/HeaderMap;
       4: getstatic     #23                 // Field io/undertow/util/Headers.AUTHORIZATION:Lio/undertow/util/HttpString;
       7: invokevirtual #24                 // Method io/undertow/util/HeaderMap.get:(Lio/undertow/util/HttpString;)Lio/undertow/util/HeaderValues;
      10: astore_3
      11: aload_3
      12: ifnull        405
      15: aload_3
      16: invokeinterface #25,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      21: astore        4
      23: aload         4
      25: invokeinterface #26,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      30: ifeq          405
      33: aload         4
      35: invokeinterface #27,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      40: checkcast     #28                 // class java/lang/String
      43: astore        5
      45: aload         5
      47: getstatic     #29                 // Field java/util/Locale.ENGLISH:Ljava/util/Locale;
      50: invokevirtual #30                 // Method java/lang/String.toLowerCase:(Ljava/util/Locale;)Ljava/lang/String;
      53: getstatic     #31                 // Field LOWERCASE_BASIC_PREFIX:Ljava/lang/String;
      56: invokevirtual #32                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      59: ifeq          402
      62: aload         5
      64: getstatic     #33                 // Field PREFIX_LENGTH:I
      67: invokevirtual #34                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      70: astore        6
      72: aconst_null
      73: astore        7
      75: aload         6
      77: invokestatic  #35                 // Method io/undertow/util/FlexBase64.decode:(Ljava/lang/String;)Ljava/nio/ByteBuffer;
      80: astore        8
      82: aload_0
      83: getfield      #16                 // Field charset:Ljava/nio/charset/Charset;
      86: astore        9
      88: aload_0
      89: getfield      #20                 // Field userAgentCharsets:Ljava/util/Map;
      92: invokeinterface #36,  1           // InterfaceMethod java/util/Map.isEmpty:()Z
      97: ifne          194
     100: aload_1
     101: invokevirtual #22                 // Method io/undertow/server/HttpServerExchange.getRequestHeaders:()Lio/undertow/util/HeaderMap;
     104: getstatic     #37                 // Field io/undertow/util/Headers.USER_AGENT:Lio/undertow/util/HttpString;
     107: invokevirtual #38                 // Method io/undertow/util/HeaderMap.getFirst:(Lio/undertow/util/HttpString;)Ljava/lang/String;
     110: astore        10
     112: aload         10
     114: ifnull        194
     117: aload_0
     118: getfield      #20                 // Field userAgentCharsets:Ljava/util/Map;
     121: invokeinterface #39,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
     126: invokeinterface #40,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     131: astore        11
     133: aload         11
     135: invokeinterface #26,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     140: ifeq          194
     143: aload         11
     145: invokeinterface #27,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     150: checkcast     #41                 // class java/util/Map$Entry
     153: astore        12
     155: aload         12
     157: invokeinterface #42,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
     162: checkcast     #43                 // class java/util/regex/Pattern
     165: aload         10
     167: invokevirtual #44                 // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
     170: invokevirtual #45                 // Method java/util/regex/Matcher.find:()Z
     173: ifeq          191
     176: aload         12
     178: invokeinterface #46,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     183: checkcast     #47                 // class java/nio/charset/Charset
     186: astore        9
     188: goto          194
     191: goto          133
     194: new           #28                 // class java/lang/String
     197: dup
     198: aload         8
     200: invokevirtual #48                 // Method java/nio/ByteBuffer.array:()[B
     203: aload         8
     205: invokevirtual #49                 // Method java/nio/ByteBuffer.arrayOffset:()I
     208: aload         8
     210: invokevirtual #50                 // Method java/nio/ByteBuffer.limit:()I
     213: aload         9
     215: invokespecial #51                 // Method java/lang/String."<init>":([BIILjava/nio/charset/Charset;)V
     218: astore        7
     220: getstatic     #52                 // Field io/undertow/UndertowLogger.SECURITY_LOGGER:Lio/undertow/UndertowLogger;
     223: ldc           #53                 // String Found basic auth header (decoded using charset %s) in %s
     225: aload         9
     227: aload_1
     228: invokeinterface #54,  4           // InterfaceMethod io/undertow/UndertowLogger.debugf:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     233: goto          251
     236: astore        8
     238: getstatic     #52                 // Field io/undertow/UndertowLogger.SECURITY_LOGGER:Lio/undertow/UndertowLogger;
     241: aload         8
     243: ldc           #56                 // String Failed to decode basic auth header in %s
     245: aload_1
     246: invokeinterface #57,  4           // InterfaceMethod io/undertow/UndertowLogger.debugf:(Ljava/lang/Throwable;Ljava/lang/String;Ljava/lang/Object;)V
     251: aload         7
     253: ifnull        398
     256: aload         7
     258: ldc           #59                 // String :
     260: invokevirtual #60                 // Method java/lang/String.indexOf:(Ljava/lang/String;)I
     263: dup
     264: istore        8
     266: iconst_m1
     267: if_icmple     398
     270: aload         7
     272: iconst_0
     273: iload         8
     275: invokevirtual #61                 // Method java/lang/String.substring:(II)Ljava/lang/String;
     278: astore        9
     280: aload         7
     282: iload         8
     284: iconst_1
     285: iadd
     286: invokevirtual #34                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     289: invokevirtual #62                 // Method java/lang/String.toCharArray:()[C
     292: astore        10
     294: aload_0
     295: aload_2
     296: invokevirtual #63                 // Method getIdentityManager:(Lio/undertow/security/api/SecurityContext;)Lio/undertow/security/idm/IdentityManager;
     299: astore        11
     301: new           #64                 // class io/undertow/security/idm/PasswordCredential
     304: dup
     305: aload         10
     307: invokespecial #65                 // Method io/undertow/security/idm/PasswordCredential."<init>":([C)V
     310: astore        12
     312: aload         11
     314: aload         9
     316: aload         12
     318: invokeinterface #66,  3           // InterfaceMethod io/undertow/security/idm/IdentityManager.verify:(Ljava/lang/String;Lio/undertow/security/idm/Credential;)Lio/undertow/security/idm/Account;
     323: astore        14
     325: aload         14
     327: ifnull        351
     330: aload_2
     331: aload         14
     333: aload_0
     334: getfield      #13                 // Field name:Ljava/lang/String;
     337: iconst_0
     338: invokeinterface #67,  4           // InterfaceMethod io/undertow/security/api/SecurityContext.authenticationComplete:(Lio/undertow/security/idm/Account;Ljava/lang/String;Z)V
     343: getstatic     #68                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     346: astore        13
     348: goto          376
     351: aload_2
     352: getstatic     #69                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     355: aload         9
     357: invokeinterface #70,  2           // InterfaceMethod io/undertow/UndertowMessages.authenticationFailed:(Ljava/lang/String;)Ljava/lang/String;
     362: aload_0
     363: getfield      #13                 // Field name:Ljava/lang/String;
     366: invokeinterface #71,  3           // InterfaceMethod io/undertow/security/api/SecurityContext.authenticationFailed:(Ljava/lang/String;Ljava/lang/String;)V
     371: getstatic     #72                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     374: astore        13
     376: aload         13
     378: astore        15
     380: aload         10
     382: invokestatic  #73                 // Method clear:([C)V
     385: aload         15
     387: areturn
     388: astore        16
     390: aload         10
     392: invokestatic  #73                 // Method clear:([C)V
     395: aload         16
     397: athrow
     398: getstatic     #72                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     401: areturn
     402: goto          23
     405: getstatic     #74                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_ATTEMPTED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     408: areturn
    Exception table:
       from    to  target type
          75   233   236   Class java/io/IOException
         312   380   388   any
         388   390   388   any

  public io.undertow.security.api.AuthenticationMechanism$ChallengeResult sendChallenge(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_0
       1: getfield      #14                 // Field silent:Z
       4: ifeq          26
       7: aload_1
       8: invokevirtual #22                 // Method io/undertow/server/HttpServerExchange.getRequestHeaders:()Lio/undertow/util/HeaderMap;
      11: getstatic     #23                 // Field io/undertow/util/Headers.AUTHORIZATION:Lio/undertow/util/HttpString;
      14: invokevirtual #38                 // Method io/undertow/util/HeaderMap.getFirst:(Lio/undertow/util/HttpString;)Ljava/lang/String;
      17: astore_3
      18: aload_3
      19: ifnonnull     26
      22: getstatic     #75                 // Field io/undertow/security/api/AuthenticationMechanism$ChallengeResult.NOT_SENT:Lio/undertow/security/api/AuthenticationMechanism$ChallengeResult;
      25: areturn
      26: aload_1
      27: invokevirtual #76                 // Method io/undertow/server/HttpServerExchange.getResponseHeaders:()Lio/undertow/util/HeaderMap;
      30: getstatic     #77                 // Field io/undertow/util/Headers.WWW_AUTHENTICATE:Lio/undertow/util/HttpString;
      33: aload_0
      34: getfield      #12                 // Field challenge:Ljava/lang/String;
      37: invokevirtual #78                 // Method io/undertow/util/HeaderMap.add:(Lio/undertow/util/HttpString;Ljava/lang/String;)Lio/undertow/util/HeaderMap;
      40: pop
      41: getstatic     #52                 // Field io/undertow/UndertowLogger.SECURITY_LOGGER:Lio/undertow/UndertowLogger;
      44: ldc           #79                 // String Sending basic auth challenge %s for %s
      46: aload_0
      47: getfield      #12                 // Field challenge:Ljava/lang/String;
      50: aload_1
      51: invokeinterface #54,  4           // InterfaceMethod io/undertow/UndertowLogger.debugf:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      56: new           #80                 // class io/undertow/security/api/AuthenticationMechanism$ChallengeResult
      59: dup
      60: iconst_1
      61: sipush        401
      64: invokestatic  #81                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      67: invokespecial #82                 // Method io/undertow/security/api/AuthenticationMechanism$ChallengeResult."<init>":(ZLjava/lang/Integer;)V
      70: areturn

  private static void clear(char[]);
    Code:
       0: iconst_0
       1: istore_1
       2: iload_1
       3: aload_0
       4: arraylength
       5: if_icmpge     18
       8: aload_0
       9: iload_1
      10: iconst_0
      11: castore
      12: iinc          1, 1
      15: goto          2
      18: return

  static {};
    Code:
       0: new           #83                 // class io/undertow/security/impl/BasicAuthenticationMechanism$Factory
       3: dup
       4: invokespecial #84                 // Method io/undertow/security/impl/BasicAuthenticationMechanism$Factory."<init>":()V
       7: putstatic     #85                 // Field FACTORY:Lio/undertow/security/api/AuthenticationMechanismFactory;
      10: getstatic     #86                 // Field io/undertow/util/Headers.BASIC:Lio/undertow/util/HttpString;
      13: invokedynamic #87,  0             // InvokeDynamic #1:makeConcatWithConstants:(Lio/undertow/util/HttpString;)Ljava/lang/String;
      18: putstatic     #10                 // Field BASIC_PREFIX:Ljava/lang/String;
      21: getstatic     #10                 // Field BASIC_PREFIX:Ljava/lang/String;
      24: getstatic     #29                 // Field java/util/Locale.ENGLISH:Ljava/util/Locale;
      27: invokevirtual #30                 // Method java/lang/String.toLowerCase:(Ljava/util/Locale;)Ljava/lang/String;
      30: putstatic     #31                 // Field LOWERCASE_BASIC_PREFIX:Ljava/lang/String;
      33: getstatic     #10                 // Field BASIC_PREFIX:Ljava/lang/String;
      36: invokevirtual #88                 // Method java/lang/String.length:()I
      39: putstatic     #33                 // Field PREFIX_LENGTH:I
      42: return
}
