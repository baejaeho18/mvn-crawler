<j:jelly xmlns:j="jelly:core" xmlns:st="jelly:stapler" xmlns:d="jelly:define" xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form" xmlns:i="jelly:fmt" xmlns:local="local" xmlns:test="/lib/test">
  <l:layout title="Test">
    <st:include page="sidepanel.jelly" it="${it.owner}"/>
    <l:main-panel>
      <h1>${it.displayName}</h1>
      <test:bar/>


      <h2>Drill Down</h2>
      <table class="pane sortable">
        <tr>
          <td class="pane-header">Test</td>
          <td class="pane-header" style="text-align:right">Fail</td>
          <td class="pane-header" style="text-align:right">Total</td>
        </tr>
        <j:forEach var="i" items="${it.individuals}">
          <j:set var="prev" value="${i.previousResult}" />
          <tr>
            <td class="pane">
              <t:buildLink jobName="${i.owner.project.fullDisplayName}" job="${i.owner.project}"
                           number="${i.owner.number}" href="${rootURL}/${i.owner.url}${i.urlName}/" />
            </td>
            <td class="pane" style="text-align:right">
              ${i.failCount}
              ${h.getDiffString2(' (',i.failCount-prev.failCount,')')}
            </td>
            <td class="pane" style="text-align:right">
              ${i.totalCount}
              ${h.getDiffString2(' (',i.totalCount-prev.totalCount,')')}
            </td>
          </tr>
        </j:forEach>
        <j:forEach var="i" items="${it.didntRun}">
          <tr>
            <td class="pane">
              <a href="${rootURL}${i.url}">${i.fullDisplayName}</a>
              (hasn't run yet)
            </td>
            <td class="pane">
              N/A
            </td>
            <td class="pane">
              N/A
            </td>
          </tr>
        </j:forEach>
      </table>
    </l:main-panel>
  </l:layout>
</j:jelly>