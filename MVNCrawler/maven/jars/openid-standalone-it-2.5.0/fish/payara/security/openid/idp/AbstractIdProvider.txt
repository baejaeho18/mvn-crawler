Compiled from "AbstractIdProvider.java"
public abstract class fish.payara.security.openid.idp.AbstractIdProvider {
  static final java.lang.String AUTHORIZATION_HEADER;

  static final java.lang.String BEARER_TYPE;

  private static final java.util.concurrent.ConcurrentMap<java.lang.String, fish.payara.security.openid.idp.AuthCode> codeRepo;

  private static final java.util.concurrent.ConcurrentMap<java.lang.String, fish.payara.security.openid.idp.Token> tokenRepo;

  protected javax.ws.rs.core.UriInfo uriInfo;

  private final java.util.logging.Logger LOGGER;

  protected static com.nimbusds.jose.jwk.ECKey EC_KEY;

  protected static com.nimbusds.jose.jwk.RSAKey RSA_KEY;

  public fish.payara.security.openid.idp.AbstractIdProvider();
    Code:
       0: aload_0
       1: invokespecial #3                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_0
       6: invokevirtual #4                  // Method java/lang/Object.getClass:()Ljava/lang/Class;
       9: invokevirtual #5                  // Method java/lang/Class.getName:()Ljava/lang/String;
      12: invokestatic  #6                  // Method java/util/logging/Logger.getLogger:(Ljava/lang/String;)Ljava/util/logging/Logger;
      15: putfield      #7                  // Field LOGGER:Ljava/util/logging/Logger;
      18: return

  protected static void clear();
    Code:
       0: getstatic     #8                  // Field tokenRepo:Ljava/util/concurrent/ConcurrentMap;
       3: invokeinterface #9,  1            // InterfaceMethod java/util/concurrent/ConcurrentMap.clear:()V
       8: getstatic     #10                 // Field codeRepo:Ljava/util/concurrent/ConcurrentMap;
      11: invokeinterface #9,  1            // InterfaceMethod java/util/concurrent/ConcurrentMap.clear:()V
      16: return

  public javax.ws.rs.core.Response getConfiguration(javax.ws.rs.core.UriInfo);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #11                 // Method providerRoot:(Ljavax/ws/rs/core/UriInfo;)Ljava/net/URI;
       5: astore_2
       6: invokestatic  #12                 // Method javax/json/Json.createObjectBuilder:()Ljavax/json/JsonObjectBuilder;
       9: ldc           #13                 // String issuer
      11: aload_2
      12: invokevirtual #14                 // Method java/net/URI.toString:()Ljava/lang/String;
      15: invokeinterface #15,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljava/lang/String;)Ljavax/json/JsonObjectBuilder;
      20: ldc           #16                 // String authorization_endpoint
      22: aload_2
      23: ldc           #17                 // String auth
      25: invokevirtual #18                 // Method java/net/URI.resolve:(Ljava/lang/String;)Ljava/net/URI;
      28: invokevirtual #14                 // Method java/net/URI.toString:()Ljava/lang/String;
      31: invokeinterface #15,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljava/lang/String;)Ljavax/json/JsonObjectBuilder;
      36: ldc           #19                 // String token_endpoint
      38: aload_2
      39: ldc           #20                 // String token
      41: invokevirtual #18                 // Method java/net/URI.resolve:(Ljava/lang/String;)Ljava/net/URI;
      44: invokevirtual #14                 // Method java/net/URI.toString:()Ljava/lang/String;
      47: invokeinterface #15,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljava/lang/String;)Ljavax/json/JsonObjectBuilder;
      52: ldc           #21                 // String userinfo_endpoint
      54: aload_2
      55: ldc           #22                 // String userinfo
      57: invokevirtual #18                 // Method java/net/URI.resolve:(Ljava/lang/String;)Ljava/net/URI;
      60: invokevirtual #14                 // Method java/net/URI.toString:()Ljava/lang/String;
      63: invokeinterface #15,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljava/lang/String;)Ljavax/json/JsonObjectBuilder;
      68: ldc           #23                 // String jwks_uri
      70: aload_2
      71: ldc           #24                 // String jwks
      73: invokevirtual #18                 // Method java/net/URI.resolve:(Ljava/lang/String;)Ljava/net/URI;
      76: invokevirtual #14                 // Method java/net/URI.toString:()Ljava/lang/String;
      79: invokeinterface #15,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljava/lang/String;)Ljavax/json/JsonObjectBuilder;
      84: ldc           #25                 // String scopes_supported
      86: invokestatic  #26                 // Method javax/json/Json.createArrayBuilder:()Ljavax/json/JsonArrayBuilder;
      89: ldc           #27                 // String openid
      91: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
      96: ldc           #29                 // String email
      98: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
     103: ldc           #30                 // String profile
     105: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
     110: invokeinterface #31,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljavax/json/JsonArrayBuilder;)Ljavax/json/JsonObjectBuilder;
     115: ldc           #32                 // String response_types_supported
     117: invokestatic  #26                 // Method javax/json/Json.createArrayBuilder:()Ljavax/json/JsonArrayBuilder;
     120: ldc           #33                 // String code
     122: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
     127: ldc           #34                 // String id_token
     129: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
     134: ldc           #35                 // String token id_token
     136: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
     141: invokeinterface #31,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljavax/json/JsonArrayBuilder;)Ljavax/json/JsonObjectBuilder;
     146: ldc           #36                 // String subject_types_supported
     148: invokestatic  #26                 // Method javax/json/Json.createArrayBuilder:()Ljavax/json/JsonArrayBuilder;
     151: ldc           #37                 // String public
     153: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
     158: invokeinterface #31,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljavax/json/JsonArrayBuilder;)Ljavax/json/JsonObjectBuilder;
     163: ldc           #38                 // String id_token_signing_alg_values_supported
     165: invokestatic  #26                 // Method javax/json/Json.createArrayBuilder:()Ljavax/json/JsonArrayBuilder;
     168: ldc           #39                 // String RS256
     170: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
     175: ldc           #40                 // String none
     177: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
     182: invokeinterface #31,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljavax/json/JsonArrayBuilder;)Ljavax/json/JsonObjectBuilder;
     187: ldc           #41                 // String claims_supported
     189: invokestatic  #26                 // Method javax/json/Json.createArrayBuilder:()Ljavax/json/JsonArrayBuilder;
     192: ldc           #42                 // String aud
     194: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
     199: ldc           #29                 // String email
     201: invokeinterface #28,  2           // InterfaceMethod javax/json/JsonArrayBuilder.add:(Ljava/lang/String;)Ljavax/json/JsonArrayBuilder;
     206: invokeinterface #31,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljavax/json/JsonArrayBuilder;)Ljavax/json/JsonObjectBuilder;
     211: astore_3
     212: aload_0
     213: aload_3
     214: aload_2
     215: invokevirtual #43                 // Method customizeConfig:(Ljavax/json/JsonObjectBuilder;Ljava/net/URI;)V
     218: aload_3
     219: invokeinterface #44,  1           // InterfaceMethod javax/json/JsonObjectBuilder.build:()Ljavax/json/JsonObject;
     224: invokestatic  #45                 // Method javax/ws/rs/core/Response.ok:(Ljava/lang/Object;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     227: ldc           #46                 // String Access-Control-Allow-Origin
     229: ldc           #47                 // String *
     231: invokevirtual #48                 // Method javax/ws/rs/core/Response$ResponseBuilder.header:(Ljava/lang/String;Ljava/lang/Object;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     234: invokevirtual #49                 // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
     237: areturn

  protected java.net.URI providerRoot(javax.ws.rs.core.UriInfo);
    Code:
       0: aload_1
       1: invokeinterface #50,  1           // InterfaceMethod javax/ws/rs/core/UriInfo.getRequestUri:()Ljava/net/URI;
       6: ldc           #51                 // String ../
       8: invokevirtual #18                 // Method java/net/URI.resolve:(Ljava/lang/String;)Ljava/net/URI;
      11: astore_2
      12: aload_2
      13: areturn

  protected void customizeConfig(javax.json.JsonObjectBuilder, java.net.URI);
    Code:
       0: return

  public javax.ws.rs.core.Response authEndpoint(fish.payara.security.openid.idp.AbstractIdProvider$AuthRequest) throws java.net.URISyntaxException;
    Code:
       0: new           #52                 // class fish/payara/security/openid/idp/AuthCode
       3: dup
       4: aload_1
       5: invokespecial #53                 // Method fish/payara/security/openid/idp/AuthCode."<init>":(Lfish/payara/security/openid/idp/AbstractIdProvider$AuthRequest;)V
       8: astore_2
       9: aload_2
      10: aload_0
      11: aload_1
      12: invokevirtual #54                 // Method authenticate:(Lfish/payara/security/openid/idp/AbstractIdProvider$AuthRequest;)Ljava/lang/Object;
      15: invokevirtual #55                 // Method fish/payara/security/openid/idp/AuthCode.setIdentity:(Ljava/lang/Object;)V
      18: getstatic     #10                 // Field codeRepo:Ljava/util/concurrent/ConcurrentMap;
      21: aload_2
      22: invokevirtual #56                 // Method fish/payara/security/openid/idp/AuthCode.getCode:()Ljava/lang/String;
      25: aload_2
      26: invokeinterface #57,  3           // InterfaceMethod java/util/concurrent/ConcurrentMap.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      31: pop
      32: aload_1
      33: getfield      #58                 // Field fish/payara/security/openid/idp/AbstractIdProvider$AuthRequest.redirectUri:Ljava/lang/String;
      36: invokestatic  #59                 // Method javax/ws/rs/core/UriBuilder.fromUri:(Ljava/lang/String;)Ljavax/ws/rs/core/UriBuilder;
      39: ldc           #33                 // String code
      41: iconst_1
      42: anewarray     #60                 // class java/lang/Object
      45: dup
      46: iconst_0
      47: aload_2
      48: invokevirtual #56                 // Method fish/payara/security/openid/idp/AuthCode.getCode:()Ljava/lang/String;
      51: aastore
      52: invokevirtual #61                 // Method javax/ws/rs/core/UriBuilder.queryParam:(Ljava/lang/String;[Ljava/lang/Object;)Ljavax/ws/rs/core/UriBuilder;
      55: astore_3
      56: aload_1
      57: invokevirtual #62                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthRequest.getState:()Ljava/lang/String;
      60: ifnull        81
      63: aload_3
      64: ldc           #63                 // String state
      66: iconst_1
      67: anewarray     #60                 // class java/lang/Object
      70: dup
      71: iconst_0
      72: aload_1
      73: invokevirtual #62                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthRequest.getState:()Ljava/lang/String;
      76: aastore
      77: invokevirtual #61                 // Method javax/ws/rs/core/UriBuilder.queryParam:(Ljava/lang/String;[Ljava/lang/Object;)Ljavax/ws/rs/core/UriBuilder;
      80: pop
      81: aload_3
      82: iconst_0
      83: anewarray     #60                 // class java/lang/Object
      86: invokevirtual #64                 // Method javax/ws/rs/core/UriBuilder.build:([Ljava/lang/Object;)Ljava/net/URI;
      89: astore        4
      91: aload_0
      92: getfield      #7                  // Field LOGGER:Ljava/util/logging/Logger;
      95: new           #65                 // class java/lang/StringBuilder
      98: dup
      99: invokespecial #66                 // Method java/lang/StringBuilder."<init>":()V
     102: ldc           #67                 // String Authorization successful, redirecting to
     104: invokevirtual #68                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     107: aload         4
     109: invokevirtual #69                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     112: invokevirtual #70                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     115: invokevirtual #71                 // Method java/util/logging/Logger.info:(Ljava/lang/String;)V
     118: aload         4
     120: invokestatic  #72                 // Method javax/ws/rs/core/Response.seeOther:(Ljava/net/URI;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     123: invokevirtual #49                 // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
     126: areturn
     127: astore_2
     128: aload_0
     129: getfield      #7                  // Field LOGGER:Ljava/util/logging/Logger;
     132: getstatic     #74                 // Field java/util/logging/Level.INFO:Ljava/util/logging/Level;
     135: ldc           #75                 // String Authentication failed
     137: aload_2
     138: invokevirtual #76                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     141: getstatic     #77                 // Field javax/ws/rs/core/Response$Status.BAD_REQUEST:Ljavax/ws/rs/core/Response$Status;
     144: invokestatic  #78                 // Method javax/ws/rs/core/Response.status:(Ljavax/ws/rs/core/Response$Status;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     147: ldc           #79                 // String application/json
     149: invokevirtual #80                 // Method javax/ws/rs/core/Response$ResponseBuilder.type:(Ljava/lang/String;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     152: aload_2
     153: invokevirtual #81                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException.asJson:()Ljavax/json/JsonObject;
     156: invokevirtual #82                 // Method javax/ws/rs/core/Response$ResponseBuilder.entity:(Ljava/lang/Object;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     159: invokevirtual #49                 // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
     162: areturn
     163: astore_2
     164: aload_0
     165: getfield      #7                  // Field LOGGER:Ljava/util/logging/Logger;
     168: getstatic     #84                 // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
     171: ldc           #85                 // String Authentication Exception
     173: aload_2
     174: invokevirtual #76                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     177: invokestatic  #86                 // Method javax/ws/rs/core/Response.serverError:()Ljavax/ws/rs/core/Response$ResponseBuilder;
     180: ldc           #79                 // String application/json
     182: invokevirtual #80                 // Method javax/ws/rs/core/Response$ResponseBuilder.type:(Ljava/lang/String;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     185: new           #73                 // class fish/payara/security/openid/idp/AbstractIdProvider$AuthException
     188: dup
     189: ldc           #87                 // String server_error
     191: aconst_null
     192: aload_1
     193: invokevirtual #62                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthRequest.getState:()Ljava/lang/String;
     196: invokespecial #88                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     199: invokevirtual #81                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException.asJson:()Ljavax/json/JsonObject;
     202: invokevirtual #82                 // Method javax/ws/rs/core/Response$ResponseBuilder.entity:(Ljava/lang/Object;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     205: invokevirtual #49                 // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
     208: areturn
    Exception table:
       from    to  target type
           0   126   127   Class fish/payara/security/openid/idp/AbstractIdProvider$AuthException
           0   126   163   Class java/lang/Exception

  protected abstract java.lang.Object authenticate(fish.payara.security.openid.idp.AbstractIdProvider$AuthRequest) throws fish.payara.security.openid.idp.AbstractIdProvider$AuthException;

  public javax.ws.rs.core.Response tokenEndpoint(javax.ws.rs.core.MultivaluedMap<java.lang.String, java.lang.String>);
    Code:
       0: new           #89                 // class fish/payara/security/openid/idp/AbstractIdProvider$TokenRequest
       3: dup
       4: aload_1
       5: invokespecial #90                 // Method fish/payara/security/openid/idp/AbstractIdProvider$TokenRequest."<init>":(Ljavax/ws/rs/core/MultivaluedMap;)V
       8: astore_2
       9: ldc           #91                 // String authorization_code
      11: aload_2
      12: getfield      #92                 // Field fish/payara/security/openid/idp/AbstractIdProvider$TokenRequest.grantType:Ljava/lang/String;
      15: invokevirtual #93                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      18: ifeq          63
      21: getstatic     #10                 // Field codeRepo:Ljava/util/concurrent/ConcurrentMap;
      24: aload_2
      25: getfield      #94                 // Field fish/payara/security/openid/idp/AbstractIdProvider$TokenRequest.code:Ljava/lang/String;
      28: invokeinterface #95,  2           // InterfaceMethod java/util/concurrent/ConcurrentMap.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      33: checkcast     #52                 // class fish/payara/security/openid/idp/AuthCode
      36: astore        4
      38: aload         4
      40: ifnonnull     53
      43: new           #73                 // class fish/payara/security/openid/idp/AbstractIdProvider$AuthException
      46: dup
      47: ldc           #96                 // String invalid_code
      49: invokespecial #97                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException."<init>":(Ljava/lang/String;)V
      52: athrow
      53: aload_0
      54: aload         4
      56: invokevirtual #98                 // Method exchangeToken:(Lfish/payara/security/openid/idp/AuthCode;)Lfish/payara/security/openid/idp/Token;
      59: astore_3
      60: goto          69
      63: aload_0
      64: aload_2
      65: invokevirtual #99                 // Method exchangeToken:(Lfish/payara/security/openid/idp/AbstractIdProvider$TokenRequest;)Lfish/payara/security/openid/idp/Token;
      68: astore_3
      69: aload_3
      70: ifnonnull     85
      73: new           #73                 // class fish/payara/security/openid/idp/AbstractIdProvider$AuthException
      76: dup
      77: ldc           #96                 // String invalid_code
      79: ldc           #100                // String No token exchanged
      81: invokespecial #101                // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      84: athrow
      85: invokestatic  #12                 // Method javax/json/Json.createObjectBuilder:()Ljavax/json/JsonObjectBuilder;
      88: astore        4
      90: aload_0
      91: aload_3
      92: invokevirtual #102                // Method fish/payara/security/openid/idp/Token.getIdToken:()Lcom/nimbusds/jwt/JWTClaimsSet;
      95: invokevirtual #103                // Method encodeJWT:(Lcom/nimbusds/jwt/JWTClaimsSet;)Lcom/nimbusds/jwt/JWT;
      98: astore        5
     100: aload_3
     101: aload_0
     102: invokedynamic #104,  0            // InvokeDynamic #0:apply:(Lfish/payara/security/openid/idp/AbstractIdProvider;)Ljava/util/function/Function;
     107: invokevirtual #105                // Method fish/payara/security/openid/idp/Token.getAccessToken:(Ljava/util/function/Function;)Ljava/lang/String;
     110: astore        6
     112: aload         4
     114: ldc           #34                 // String id_token
     116: aload         5
     118: invokeinterface #106,  1          // InterfaceMethod com/nimbusds/jwt/JWT.serialize:()Ljava/lang/String;
     123: invokeinterface #15,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljava/lang/String;)Ljavax/json/JsonObjectBuilder;
     128: ldc           #107                // String access_token
     130: aload         6
     132: invokeinterface #15,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljava/lang/String;)Ljavax/json/JsonObjectBuilder;
     137: ldc           #108                // String token_type
     139: ldc           #110                // String Bearer
     141: invokeinterface #15,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljava/lang/String;)Ljavax/json/JsonObjectBuilder;
     146: ldc           #111                // String expires_in
     148: aload_3
     149: invokevirtual #112                // Method fish/payara/security/openid/idp/Token.getDurationInSeconds:()J
     152: invokeinterface #113,  4          // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;J)Ljavax/json/JsonObjectBuilder;
     157: pop
     158: aload_3
     159: invokevirtual #114                // Method fish/payara/security/openid/idp/Token.getRefreshToken:()Ljava/lang/String;
     162: ifnull        179
     165: aload         4
     167: ldc           #115                // String refresh_token
     169: aload_3
     170: getfield      #116                // Field fish/payara/security/openid/idp/Token.refreshToken:Ljava/lang/String;
     173: invokeinterface #15,  3           // InterfaceMethod javax/json/JsonObjectBuilder.add:(Ljava/lang/String;Ljava/lang/String;)Ljavax/json/JsonObjectBuilder;
     178: pop
     179: getstatic     #8                  // Field tokenRepo:Ljava/util/concurrent/ConcurrentMap;
     182: aload         6
     184: aload_3
     185: invokeinterface #57,  3           // InterfaceMethod java/util/concurrent/ConcurrentMap.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     190: pop
     191: invokestatic  #117                // Method javax/ws/rs/core/Response.ok:()Ljavax/ws/rs/core/Response$ResponseBuilder;
     194: ldc           #79                 // String application/json
     196: invokevirtual #80                 // Method javax/ws/rs/core/Response$ResponseBuilder.type:(Ljava/lang/String;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     199: aload         4
     201: invokeinterface #44,  1           // InterfaceMethod javax/json/JsonObjectBuilder.build:()Ljavax/json/JsonObject;
     206: invokevirtual #82                 // Method javax/ws/rs/core/Response$ResponseBuilder.entity:(Ljava/lang/Object;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     209: invokevirtual #49                 // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
     212: areturn
     213: astore_3
     214: aload_0
     215: getfield      #7                  // Field LOGGER:Ljava/util/logging/Logger;
     218: getstatic     #74                 // Field java/util/logging/Level.INFO:Ljava/util/logging/Level;
     221: ldc           #118                // String Token exchange failed
     223: aload_3
     224: invokevirtual #76                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     227: getstatic     #77                 // Field javax/ws/rs/core/Response$Status.BAD_REQUEST:Ljavax/ws/rs/core/Response$Status;
     230: invokestatic  #78                 // Method javax/ws/rs/core/Response.status:(Ljavax/ws/rs/core/Response$Status;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     233: ldc           #79                 // String application/json
     235: invokevirtual #80                 // Method javax/ws/rs/core/Response$ResponseBuilder.type:(Ljava/lang/String;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     238: aload_3
     239: invokevirtual #81                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException.asJson:()Ljavax/json/JsonObject;
     242: invokevirtual #82                 // Method javax/ws/rs/core/Response$ResponseBuilder.entity:(Ljava/lang/Object;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     245: invokevirtual #49                 // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
     248: areturn
     249: astore_3
     250: aload_0
     251: getfield      #7                  // Field LOGGER:Ljava/util/logging/Logger;
     254: getstatic     #84                 // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
     257: ldc           #119                // String Token exchange Exception
     259: aload_3
     260: invokevirtual #76                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     263: invokestatic  #86                 // Method javax/ws/rs/core/Response.serverError:()Ljavax/ws/rs/core/Response$ResponseBuilder;
     266: ldc           #79                 // String application/json
     268: invokevirtual #80                 // Method javax/ws/rs/core/Response$ResponseBuilder.type:(Ljava/lang/String;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     271: new           #73                 // class fish/payara/security/openid/idp/AbstractIdProvider$AuthException
     274: dup
     275: ldc           #87                 // String server_error
     277: invokespecial #97                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException."<init>":(Ljava/lang/String;)V
     280: invokevirtual #81                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException.asJson:()Ljavax/json/JsonObject;
     283: invokevirtual #82                 // Method javax/ws/rs/core/Response$ResponseBuilder.entity:(Ljava/lang/Object;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     286: invokevirtual #49                 // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
     289: areturn
    Exception table:
       from    to  target type
           9   212   213   Class fish/payara/security/openid/idp/AbstractIdProvider$AuthException
           9   212   249   Class java/lang/Exception

  private com.nimbusds.jwt.JWT encodeJWTHandlingExceptions(com.nimbusds.jwt.JWTClaimsSet);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #103                // Method encodeJWT:(Lcom/nimbusds/jwt/JWTClaimsSet;)Lcom/nimbusds/jwt/JWT;
       5: areturn
       6: astore_2
       7: new           #121                // class java/lang/RuntimeException
      10: dup
      11: aload_2
      12: invokespecial #122                // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
      15: athrow
    Exception table:
       from    to  target type
           0     5     6   Class com/nimbusds/jose/JOSEException

  public java.lang.String getKeystore();
    Code:
       0: aload_0
       1: invokevirtual #123                // Method getKeyset:()Lcom/nimbusds/jose/jwk/JWKSet;
       4: iconst_1
       5: invokevirtual #124                // Method com/nimbusds/jose/jwk/JWKSet.toString:(Z)Ljava/lang/String;
       8: areturn

  protected com.nimbusds.jose.jwk.JWKSet getKeyset();
    Code:
       0: new           #125                // class com/nimbusds/jose/jwk/JWKSet
       3: dup
       4: invokespecial #126                // Method com/nimbusds/jose/jwk/JWKSet."<init>":()V
       7: areturn

  protected abstract fish.payara.security.openid.idp.Token exchangeToken(fish.payara.security.openid.idp.AuthCode) throws fish.payara.security.openid.idp.AbstractIdProvider$AuthException;

  protected fish.payara.security.openid.idp.Token exchangeToken(fish.payara.security.openid.idp.AbstractIdProvider$TokenRequest) throws fish.payara.security.openid.idp.AbstractIdProvider$AuthException;
    Code:
       0: new           #73                 // class fish/payara/security/openid/idp/AbstractIdProvider$AuthException
       3: dup
       4: ldc           #127                // String not_supported
       6: invokespecial #97                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException."<init>":(Ljava/lang/String;)V
       9: athrow

  protected abstract com.nimbusds.jwt.JWT encodeJWT(com.nimbusds.jwt.JWTClaimsSet) throws com.nimbusds.jose.JOSEException;

  protected com.nimbusds.jwt.JWT rs256(com.nimbusds.jwt.JWTClaimsSet) throws com.nimbusds.jose.JOSEException;
    Code:
       0: new           #128                // class com/nimbusds/jwt/SignedJWT
       3: dup
       4: new           #129                // class com/nimbusds/jose/JWSHeader$Builder
       7: dup
       8: getstatic     #130                // Field com/nimbusds/jose/JWSAlgorithm.RS256:Lcom/nimbusds/jose/JWSAlgorithm;
      11: invokespecial #131                // Method com/nimbusds/jose/JWSHeader$Builder."<init>":(Lcom/nimbusds/jose/JWSAlgorithm;)V
      14: invokestatic  #132                // Method rsaKey:()Lcom/nimbusds/jose/jwk/RSAKey;
      17: invokevirtual #133                // Method com/nimbusds/jose/jwk/RSAKey.getKeyID:()Ljava/lang/String;
      20: invokevirtual #134                // Method com/nimbusds/jose/JWSHeader$Builder.keyID:(Ljava/lang/String;)Lcom/nimbusds/jose/JWSHeader$Builder;
      23: invokevirtual #135                // Method com/nimbusds/jose/JWSHeader$Builder.build:()Lcom/nimbusds/jose/JWSHeader;
      26: aload_1
      27: invokespecial #136                // Method com/nimbusds/jwt/SignedJWT."<init>":(Lcom/nimbusds/jose/JWSHeader;Lcom/nimbusds/jwt/JWTClaimsSet;)V
      30: astore_2
      31: aload_2
      32: new           #137                // class com/nimbusds/jose/crypto/RSASSASigner
      35: dup
      36: invokestatic  #132                // Method rsaKey:()Lcom/nimbusds/jose/jwk/RSAKey;
      39: invokespecial #138                // Method com/nimbusds/jose/crypto/RSASSASigner."<init>":(Lcom/nimbusds/jose/jwk/RSAKey;)V
      42: invokevirtual #139                // Method com/nimbusds/jwt/SignedJWT.sign:(Lcom/nimbusds/jose/JWSSigner;)V
      45: aload_2
      46: areturn

  protected com.nimbusds.jwt.JWT es256(com.nimbusds.jwt.JWTClaimsSet) throws com.nimbusds.jose.JOSEException;
    Code:
       0: new           #128                // class com/nimbusds/jwt/SignedJWT
       3: dup
       4: new           #129                // class com/nimbusds/jose/JWSHeader$Builder
       7: dup
       8: getstatic     #140                // Field com/nimbusds/jose/JWSAlgorithm.ES256:Lcom/nimbusds/jose/JWSAlgorithm;
      11: invokespecial #131                // Method com/nimbusds/jose/JWSHeader$Builder."<init>":(Lcom/nimbusds/jose/JWSAlgorithm;)V
      14: invokestatic  #141                // Method ecKey:()Lcom/nimbusds/jose/jwk/ECKey;
      17: invokevirtual #142                // Method com/nimbusds/jose/jwk/ECKey.getKeyID:()Ljava/lang/String;
      20: invokevirtual #134                // Method com/nimbusds/jose/JWSHeader$Builder.keyID:(Ljava/lang/String;)Lcom/nimbusds/jose/JWSHeader$Builder;
      23: invokevirtual #135                // Method com/nimbusds/jose/JWSHeader$Builder.build:()Lcom/nimbusds/jose/JWSHeader;
      26: aload_1
      27: invokespecial #136                // Method com/nimbusds/jwt/SignedJWT."<init>":(Lcom/nimbusds/jose/JWSHeader;Lcom/nimbusds/jwt/JWTClaimsSet;)V
      30: astore_2
      31: aload_2
      32: new           #143                // class com/nimbusds/jose/crypto/ECDSASigner
      35: dup
      36: invokestatic  #141                // Method ecKey:()Lcom/nimbusds/jose/jwk/ECKey;
      39: invokespecial #144                // Method com/nimbusds/jose/crypto/ECDSASigner."<init>":(Lcom/nimbusds/jose/jwk/ECKey;)V
      42: invokevirtual #139                // Method com/nimbusds/jwt/SignedJWT.sign:(Lcom/nimbusds/jose/JWSSigner;)V
      45: aload_2
      46: areturn

  public javax.ws.rs.core.Response userinfoEndpoint(java.lang.String);
    Code:
       0: aload_1
       1: ldc           #110                // String Bearer
       3: invokevirtual #145                // Method java/lang/String.length:()I
       6: iconst_1
       7: iadd
       8: invokevirtual #146                // Method java/lang/String.substring:(I)Ljava/lang/String;
      11: astore_2
      12: getstatic     #8                  // Field tokenRepo:Ljava/util/concurrent/ConcurrentMap;
      15: aload_2
      16: invokeinterface #147,  2          // InterfaceMethod java/util/concurrent/ConcurrentMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
      21: checkcast     #148                // class fish/payara/security/openid/idp/Token
      24: astore_3
      25: aload_3
      26: ifnonnull     39
      29: new           #73                 // class fish/payara/security/openid/idp/AbstractIdProvider$AuthException
      32: dup
      33: ldc           #149                // String invalid_token
      35: invokespecial #97                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException."<init>":(Ljava/lang/String;)V
      38: athrow
      39: aload_0
      40: aload_3
      41: invokevirtual #150                // Method userInfo:(Lfish/payara/security/openid/idp/Token;)Ljavax/json/JsonObject;
      44: astore        4
      46: aload         4
      48: invokestatic  #45                 // Method javax/ws/rs/core/Response.ok:(Ljava/lang/Object;)Ljavax/ws/rs/core/Response$ResponseBuilder;
      51: invokevirtual #49                 // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
      54: areturn
      55: astore        4
      57: aload_0
      58: getfield      #7                  // Field LOGGER:Ljava/util/logging/Logger;
      61: getstatic     #74                 // Field java/util/logging/Level.INFO:Ljava/util/logging/Level;
      64: ldc           #151                // String User info failed
      66: aload         4
      68: invokevirtual #76                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
      71: getstatic     #77                 // Field javax/ws/rs/core/Response$Status.BAD_REQUEST:Ljavax/ws/rs/core/Response$Status;
      74: invokestatic  #78                 // Method javax/ws/rs/core/Response.status:(Ljavax/ws/rs/core/Response$Status;)Ljavax/ws/rs/core/Response$ResponseBuilder;
      77: aload         4
      79: invokevirtual #81                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException.asJson:()Ljavax/json/JsonObject;
      82: invokevirtual #82                 // Method javax/ws/rs/core/Response$ResponseBuilder.entity:(Ljava/lang/Object;)Ljavax/ws/rs/core/Response$ResponseBuilder;
      85: invokevirtual #49                 // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
      88: areturn
      89: astore        4
      91: aload_0
      92: getfield      #7                  // Field LOGGER:Ljava/util/logging/Logger;
      95: getstatic     #84                 // Field java/util/logging/Level.SEVERE:Ljava/util/logging/Level;
      98: ldc           #152                // String User info Exception
     100: aload         4
     102: invokevirtual #76                 // Method java/util/logging/Logger.log:(Ljava/util/logging/Level;Ljava/lang/String;Ljava/lang/Throwable;)V
     105: invokestatic  #86                 // Method javax/ws/rs/core/Response.serverError:()Ljavax/ws/rs/core/Response$ResponseBuilder;
     108: new           #73                 // class fish/payara/security/openid/idp/AbstractIdProvider$AuthException
     111: dup
     112: ldc           #87                 // String server_error
     114: invokespecial #97                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException."<init>":(Ljava/lang/String;)V
     117: invokevirtual #81                 // Method fish/payara/security/openid/idp/AbstractIdProvider$AuthException.asJson:()Ljavax/json/JsonObject;
     120: invokevirtual #82                 // Method javax/ws/rs/core/Response$ResponseBuilder.entity:(Ljava/lang/Object;)Ljavax/ws/rs/core/Response$ResponseBuilder;
     123: invokevirtual #49                 // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
     126: areturn
    Exception table:
       from    to  target type
          25    54    55   Class fish/payara/security/openid/idp/AbstractIdProvider$AuthException
          25    54    89   Class java/lang/Exception

  protected static com.nimbusds.jose.jwk.ECKey ecKey();
    Code:
       0: getstatic     #153                // Field EC_KEY:Lcom/nimbusds/jose/jwk/ECKey;
       3: ifnonnull     34
       6: new           #154                // class com/nimbusds/jose/jwk/gen/ECKeyGenerator
       9: dup
      10: getstatic     #155                // Field com/nimbusds/jose/jwk/Curve.P_256:Lcom/nimbusds/jose/jwk/Curve;
      13: invokespecial #156                // Method com/nimbusds/jose/jwk/gen/ECKeyGenerator."<init>":(Lcom/nimbusds/jose/jwk/Curve;)V
      16: ldc           #157                // String ec
      18: invokevirtual #158                // Method com/nimbusds/jose/jwk/gen/ECKeyGenerator.keyID:(Ljava/lang/String;)Lcom/nimbusds/jose/jwk/gen/JWKGenerator;
      21: invokevirtual #159                // Method com/nimbusds/jose/jwk/gen/JWKGenerator.generate:()Lcom/nimbusds/jose/jwk/JWK;
      24: checkcast     #160                // class com/nimbusds/jose/jwk/ECKey
      27: putstatic     #153                // Field EC_KEY:Lcom/nimbusds/jose/jwk/ECKey;
      30: goto          34
      33: astore_0
      34: getstatic     #153                // Field EC_KEY:Lcom/nimbusds/jose/jwk/ECKey;
      37: areturn
    Exception table:
       from    to  target type
           6    30    33   Class com/nimbusds/jose/JOSEException

  protected static com.nimbusds.jose.jwk.RSAKey rsaKey();
    Code:
       0: getstatic     #161                // Field RSA_KEY:Lcom/nimbusds/jose/jwk/RSAKey;
       3: ifnonnull     43
       6: new           #162                // class com/nimbusds/jose/jwk/gen/RSAKeyGenerator
       9: dup
      10: sipush        2048
      13: invokespecial #163                // Method com/nimbusds/jose/jwk/gen/RSAKeyGenerator."<init>":(I)V
      16: ldc           #164                // String rsa
      18: invokevirtual #165                // Method com/nimbusds/jose/jwk/gen/RSAKeyGenerator.keyID:(Ljava/lang/String;)Lcom/nimbusds/jose/jwk/gen/JWKGenerator;
      21: invokevirtual #159                // Method com/nimbusds/jose/jwk/gen/JWKGenerator.generate:()Lcom/nimbusds/jose/jwk/JWK;
      24: checkcast     #166                // class com/nimbusds/jose/jwk/RSAKey
      27: putstatic     #161                // Field RSA_KEY:Lcom/nimbusds/jose/jwk/RSAKey;
      30: goto          43
      33: astore_0
      34: new           #121                // class java/lang/RuntimeException
      37: dup
      38: aload_0
      39: invokespecial #122                // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
      42: athrow
      43: getstatic     #161                // Field RSA_KEY:Lcom/nimbusds/jose/jwk/RSAKey;
      46: areturn
    Exception table:
       from    to  target type
           6    30    33   Class com/nimbusds/jose/JOSEException

  protected abstract javax.json.JsonObject userInfo(fish.payara.security.openid.idp.Token);

  static {};
    Code:
       0: new           #167                // class java/util/concurrent/ConcurrentHashMap
       3: dup
       4: invokespecial #168                // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
       7: putstatic     #10                 // Field codeRepo:Ljava/util/concurrent/ConcurrentMap;
      10: new           #167                // class java/util/concurrent/ConcurrentHashMap
      13: dup
      14: invokespecial #168                // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      17: putstatic     #8                  // Field tokenRepo:Ljava/util/concurrent/ConcurrentMap;
      20: return
}
