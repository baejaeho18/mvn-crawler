Compiled from "BarrierMessageHandler.java"
public class org.springframework.integration.aggregator.BarrierMessageHandler extends org.springframework.integration.handler.AbstractReplyProducingMessageHandler implements org.springframework.integration.handler.MessageTriggerAction,org.springframework.integration.handler.DiscardingMessageHandler {
  private final java.util.Map<java.lang.Object, java.util.concurrent.SynchronousQueue<org.springframework.messaging.Message<?>>> suspensions;

  private final java.util.Map<java.lang.Object, java.lang.Thread> inProcess;

  private final long timeout;

  private final org.springframework.integration.aggregator.CorrelationStrategy correlationStrategy;

  private final org.springframework.integration.aggregator.MessageGroupProcessor messageGroupProcessor;

  private volatile org.springframework.messaging.MessageChannel discardChannel;

  private java.lang.String discardChannelName;

  public org.springframework.integration.aggregator.BarrierMessageHandler(long);
    Code:
       0: aload_0
       1: lload_1
       2: new           #1                  // class org/springframework/integration/aggregator/DefaultAggregatingMessageGroupProcessor
       5: dup
       6: invokespecial #2                  // Method org/springframework/integration/aggregator/DefaultAggregatingMessageGroupProcessor."<init>":()V
       9: invokespecial #3                  // Method "<init>":(JLorg/springframework/integration/aggregator/MessageGroupProcessor;)V
      12: return

  public org.springframework.integration.aggregator.BarrierMessageHandler(long, org.springframework.integration.aggregator.MessageGroupProcessor);
    Code:
       0: aload_0
       1: lload_1
       2: aload_3
       3: aconst_null
       4: invokespecial #4                  // Method "<init>":(JLorg/springframework/integration/aggregator/MessageGroupProcessor;Lorg/springframework/integration/aggregator/CorrelationStrategy;)V
       7: return

  public org.springframework.integration.aggregator.BarrierMessageHandler(long, org.springframework.integration.aggregator.CorrelationStrategy);
    Code:
       0: aload_0
       1: lload_1
       2: new           #1                  // class org/springframework/integration/aggregator/DefaultAggregatingMessageGroupProcessor
       5: dup
       6: invokespecial #2                  // Method org/springframework/integration/aggregator/DefaultAggregatingMessageGroupProcessor."<init>":()V
       9: aload_3
      10: invokespecial #4                  // Method "<init>":(JLorg/springframework/integration/aggregator/MessageGroupProcessor;Lorg/springframework/integration/aggregator/CorrelationStrategy;)V
      13: return

  public org.springframework.integration.aggregator.BarrierMessageHandler(long, org.springframework.integration.aggregator.MessageGroupProcessor, org.springframework.integration.aggregator.CorrelationStrategy);
    Code:
       0: aload_0
       1: invokespecial #5                  // Method org/springframework/integration/handler/AbstractReplyProducingMessageHandler."<init>":()V
       4: aload_0
       5: new           #6                  // class java/util/concurrent/ConcurrentHashMap
       8: dup
       9: invokespecial #7                  // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      12: putfield      #8                  // Field suspensions:Ljava/util/Map;
      15: aload_0
      16: new           #6                  // class java/util/concurrent/ConcurrentHashMap
      19: dup
      20: invokespecial #7                  // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      23: putfield      #9                  // Field inProcess:Ljava/util/Map;
      26: aload_3
      27: ldc           #10                 // String \'messageGroupProcessor\' cannot be null
      29: invokestatic  #11                 // Method org/springframework/util/Assert.notNull:(Ljava/lang/Object;Ljava/lang/String;)V
      32: aload_0
      33: aload_3
      34: putfield      #12                 // Field messageGroupProcessor:Lorg/springframework/integration/aggregator/MessageGroupProcessor;
      37: aload_0
      38: aload         4
      40: ifnonnull     55
      43: new           #13                 // class org/springframework/integration/aggregator/HeaderAttributeCorrelationStrategy
      46: dup
      47: ldc           #15                 // String correlationId
      49: invokespecial #16                 // Method org/springframework/integration/aggregator/HeaderAttributeCorrelationStrategy."<init>":(Ljava/lang/String;)V
      52: goto          57
      55: aload         4
      57: putfield      #17                 // Field correlationStrategy:Lorg/springframework/integration/aggregator/CorrelationStrategy;
      60: aload_0
      61: lload_1
      62: putfield      #18                 // Field timeout:J
      65: return

  public void setDiscardChannelName(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #19                 // Field discardChannelName:Ljava/lang/String;
       5: return

  public void setDiscardChannel(org.springframework.messaging.MessageChannel);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #20                 // Field discardChannel:Lorg/springframework/messaging/MessageChannel;
       5: return

  public org.springframework.messaging.MessageChannel getDiscardChannel();
    Code:
       0: aload_0
       1: getfield      #20                 // Field discardChannel:Lorg/springframework/messaging/MessageChannel;
       4: ifnonnull     41
       7: aload_0
       8: getfield      #19                 // Field discardChannelName:Ljava/lang/String;
      11: ifnull        41
      14: aload_0
      15: invokevirtual #21                 // Method getChannelResolver:()Lorg/springframework/messaging/core/DestinationResolver;
      18: ifnull        41
      21: aload_0
      22: aload_0
      23: invokevirtual #21                 // Method getChannelResolver:()Lorg/springframework/messaging/core/DestinationResolver;
      26: aload_0
      27: getfield      #19                 // Field discardChannelName:Ljava/lang/String;
      30: invokeinterface #22,  2           // InterfaceMethod org/springframework/messaging/core/DestinationResolver.resolveDestination:(Ljava/lang/String;)Ljava/lang/Object;
      35: checkcast     #23                 // class org/springframework/messaging/MessageChannel
      38: putfield      #20                 // Field discardChannel:Lorg/springframework/messaging/MessageChannel;
      41: aload_0
      42: getfield      #20                 // Field discardChannel:Lorg/springframework/messaging/MessageChannel;
      45: areturn

  public java.lang.String getComponentType();
    Code:
       0: ldc           #24                 // String barrier
       2: areturn

  protected java.lang.Object handleRequestMessage(org.springframework.messaging.Message<?>);
    Code:
       0: aload_0
       1: getfield      #17                 // Field correlationStrategy:Lorg/springframework/integration/aggregator/CorrelationStrategy;
       4: aload_1
       5: invokeinterface #25,  2           // InterfaceMethod org/springframework/integration/aggregator/CorrelationStrategy.getCorrelationKey:(Lorg/springframework/messaging/Message;)Ljava/lang/Object;
      10: astore_2
      11: aload_2
      12: ifnonnull     26
      15: new           #26                 // class org/springframework/messaging/MessagingException
      18: dup
      19: aload_1
      20: ldc           #27                 // String Correlation Strategy returned null
      22: invokespecial #28                 // Method org/springframework/messaging/MessagingException."<init>":(Lorg/springframework/messaging/Message;Ljava/lang/String;)V
      25: athrow
      26: aload_0
      27: getfield      #9                  // Field inProcess:Ljava/util/Map;
      30: aload_2
      31: invokestatic  #29                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
      34: invokeinterface #30,  3           // InterfaceMethod java/util/Map.putIfAbsent:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      39: checkcast     #31                 // class java/lang/Thread
      42: astore_3
      43: aload_3
      44: ifnull        87
      47: new           #26                 // class org/springframework/messaging/MessagingException
      50: dup
      51: aload_1
      52: new           #32                 // class java/lang/StringBuilder
      55: dup
      56: invokespecial #33                 // Method java/lang/StringBuilder."<init>":()V
      59: ldc           #34                 // String Correlation key (
      61: invokevirtual #35                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      64: aload_2
      65: invokevirtual #36                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      68: ldc           #37                 // String ) is already in use by
      70: invokevirtual #35                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      73: aload_3
      74: invokevirtual #38                 // Method java/lang/Thread.getName:()Ljava/lang/String;
      77: invokevirtual #35                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      80: invokevirtual #39                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      83: invokespecial #28                 // Method org/springframework/messaging/MessagingException."<init>":(Lorg/springframework/messaging/Message;Ljava/lang/String;)V
      86: athrow
      87: aload_0
      88: aload_2
      89: invokespecial #40                 // Method createOrObtainQueue:(Ljava/lang/Object;)Ljava/util/concurrent/SynchronousQueue;
      92: astore        4
      94: aload         4
      96: aload_0
      97: getfield      #18                 // Field timeout:J
     100: getstatic     #41                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
     103: invokevirtual #42                 // Method java/util/concurrent/SynchronousQueue.poll:(JLjava/util/concurrent/TimeUnit;)Ljava/lang/Object;
     106: checkcast     #43                 // class org/springframework/messaging/Message
     109: astore        5
     111: aload         5
     113: ifnull        151
     116: aload_0
     117: aload_2
     118: aload_1
     119: aload         5
     121: invokespecial #44                 // Method processRelease:(Ljava/lang/Object;Lorg/springframework/messaging/Message;Lorg/springframework/messaging/Message;)Ljava/lang/Object;
     124: astore        6
     126: aload_0
     127: getfield      #9                  // Field inProcess:Ljava/util/Map;
     130: aload_2
     131: invokeinterface #45,  2           // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     136: pop
     137: aload_0
     138: getfield      #8                  // Field suspensions:Ljava/util/Map;
     141: aload_2
     142: invokeinterface #45,  2           // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     147: pop
     148: aload         6
     150: areturn
     151: aload_0
     152: getfield      #9                  // Field inProcess:Ljava/util/Map;
     155: aload_2
     156: invokeinterface #45,  2           // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     161: pop
     162: aload_0
     163: getfield      #8                  // Field suspensions:Ljava/util/Map;
     166: aload_2
     167: invokeinterface #45,  2           // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     172: pop
     173: goto          224
     176: astore        5
     178: invokestatic  #29                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     181: invokevirtual #47                 // Method java/lang/Thread.interrupt:()V
     184: new           #48                 // class org/springframework/messaging/MessageHandlingException
     187: dup
     188: aload_1
     189: ldc           #49                 // String Interrupted while waiting for release
     191: aload         5
     193: invokespecial #50                 // Method org/springframework/messaging/MessageHandlingException."<init>":(Lorg/springframework/messaging/Message;Ljava/lang/String;Ljava/lang/Throwable;)V
     196: athrow
     197: astore        7
     199: aload_0
     200: getfield      #9                  // Field inProcess:Ljava/util/Map;
     203: aload_2
     204: invokeinterface #45,  2           // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     209: pop
     210: aload_0
     211: getfield      #8                  // Field suspensions:Ljava/util/Map;
     214: aload_2
     215: invokeinterface #45,  2           // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     220: pop
     221: aload         7
     223: athrow
     224: aconst_null
     225: areturn
    Exception table:
       from    to  target type
          94   126   176   Class java/lang/InterruptedException
          94   126   197   any
         176   199   197   any

  private java.lang.Object processRelease(java.lang.Object, org.springframework.messaging.Message<?>, org.springframework.messaging.Message<?>);
    Code:
       0: aload_0
       1: getfield      #8                  // Field suspensions:Ljava/util/Map;
       4: aload_1
       5: invokeinterface #45,  2           // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      10: pop
      11: aload_3
      12: invokeinterface #51,  1           // InterfaceMethod org/springframework/messaging/Message.getPayload:()Ljava/lang/Object;
      17: instanceof    #52                 // class java/lang/Throwable
      20: ifeq          43
      23: new           #26                 // class org/springframework/messaging/MessagingException
      26: dup
      27: aload_2
      28: ldc           #53                 // String Releasing flow returned a throwable
      30: aload_3
      31: invokeinterface #51,  1           // InterfaceMethod org/springframework/messaging/Message.getPayload:()Ljava/lang/Object;
      36: checkcast     #52                 // class java/lang/Throwable
      39: invokespecial #54                 // Method org/springframework/messaging/MessagingException."<init>":(Lorg/springframework/messaging/Message;Ljava/lang/String;Ljava/lang/Throwable;)V
      42: athrow
      43: aload_0
      44: aload_1
      45: aload_2
      46: aload_3
      47: invokevirtual #55                 // Method buildResult:(Ljava/lang/Object;Lorg/springframework/messaging/Message;Lorg/springframework/messaging/Message;)Ljava/lang/Object;
      50: areturn

  protected java.lang.Object buildResult(java.lang.Object, org.springframework.messaging.Message<?>, org.springframework.messaging.Message<?>);
    Code:
       0: new           #56                 // class org/springframework/integration/store/SimpleMessageGroup
       3: dup
       4: aload_1
       5: invokespecial #57                 // Method org/springframework/integration/store/SimpleMessageGroup."<init>":(Ljava/lang/Object;)V
       8: astore        4
      10: aload         4
      12: aload_2
      13: invokevirtual #58                 // Method org/springframework/integration/store/SimpleMessageGroup.add:(Lorg/springframework/messaging/Message;)V
      16: aload         4
      18: aload_3
      19: invokevirtual #58                 // Method org/springframework/integration/store/SimpleMessageGroup.add:(Lorg/springframework/messaging/Message;)V
      22: aload_0
      23: getfield      #12                 // Field messageGroupProcessor:Lorg/springframework/integration/aggregator/MessageGroupProcessor;
      26: aload         4
      28: invokeinterface #59,  2           // InterfaceMethod org/springframework/integration/aggregator/MessageGroupProcessor.processMessageGroup:(Lorg/springframework/integration/store/MessageGroup;)Ljava/lang/Object;
      33: areturn

  private java.util.concurrent.SynchronousQueue<org.springframework.messaging.Message<?>> createOrObtainQueue(java.lang.Object);
    Code:
       0: new           #60                 // class java/util/concurrent/SynchronousQueue
       3: dup
       4: invokespecial #61                 // Method java/util/concurrent/SynchronousQueue."<init>":()V
       7: astore_2
       8: aload_0
       9: getfield      #8                  // Field suspensions:Ljava/util/Map;
      12: aload_1
      13: aload_2
      14: invokeinterface #30,  3           // InterfaceMethod java/util/Map.putIfAbsent:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      19: checkcast     #60                 // class java/util/concurrent/SynchronousQueue
      22: astore_3
      23: aload_3
      24: ifnull        29
      27: aload_3
      28: astore_2
      29: aload_2
      30: areturn

  public void trigger(org.springframework.messaging.Message<?>);
    Code:
       0: aload_0
       1: getfield      #17                 // Field correlationStrategy:Lorg/springframework/integration/aggregator/CorrelationStrategy;
       4: aload_1
       5: invokeinterface #25,  2           // InterfaceMethod org/springframework/integration/aggregator/CorrelationStrategy.getCorrelationKey:(Lorg/springframework/messaging/Message;)Ljava/lang/Object;
      10: astore_2
      11: aload_2
      12: ifnonnull     26
      15: new           #26                 // class org/springframework/messaging/MessagingException
      18: dup
      19: aload_1
      20: ldc           #27                 // String Correlation Strategy returned null
      22: invokespecial #28                 // Method org/springframework/messaging/MessagingException."<init>":(Lorg/springframework/messaging/Message;Ljava/lang/String;)V
      25: athrow
      26: aload_0
      27: aload_2
      28: invokespecial #40                 // Method createOrObtainQueue:(Ljava/lang/Object;)Ljava/util/concurrent/SynchronousQueue;
      31: astore_3
      32: aload_3
      33: aload_1
      34: aload_0
      35: getfield      #18                 // Field timeout:J
      38: getstatic     #41                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
      41: invokevirtual #62                 // Method java/util/concurrent/SynchronousQueue.offer:(Ljava/lang/Object;JLjava/util/concurrent/TimeUnit;)Z
      44: ifne          105
      47: aload_0
      48: getfield      #63                 // Field logger:Lorg/apache/commons/logging/Log;
      51: new           #32                 // class java/lang/StringBuilder
      54: dup
      55: invokespecial #33                 // Method java/lang/StringBuilder."<init>":()V
      58: ldc           #64                 // String Suspending thread timed out or did not arrive within timeout for:
      60: invokevirtual #35                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      63: aload_1
      64: invokevirtual #36                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      67: invokevirtual #39                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      70: invokeinterface #65,  2           // InterfaceMethod org/apache/commons/logging/Log.error:(Ljava/lang/Object;)V
      75: aload_0
      76: getfield      #8                  // Field suspensions:Ljava/util/Map;
      79: aload_2
      80: invokeinterface #45,  2           // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      85: pop
      86: aload_0
      87: invokevirtual #66                 // Method getDiscardChannel:()Lorg/springframework/messaging/MessageChannel;
      90: ifnull        105
      93: aload_0
      94: getfield      #67                 // Field messagingTemplate:Lorg/springframework/integration/core/MessagingTemplate;
      97: aload_0
      98: invokevirtual #66                 // Method getDiscardChannel:()Lorg/springframework/messaging/MessageChannel;
     101: aload_1
     102: invokevirtual #68                 // Method org/springframework/integration/core/MessagingTemplate.send:(Ljava/lang/Object;Lorg/springframework/messaging/Message;)V
     105: goto          155
     108: astore        4
     110: invokestatic  #29                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     113: invokevirtual #47                 // Method java/lang/Thread.interrupt:()V
     116: aload_0
     117: getfield      #63                 // Field logger:Lorg/apache/commons/logging/Log;
     120: new           #32                 // class java/lang/StringBuilder
     123: dup
     124: invokespecial #33                 // Method java/lang/StringBuilder."<init>":()V
     127: ldc           #69                 // String Interrupted while waiting for the suspending thread for:
     129: invokevirtual #35                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     132: aload_1
     133: invokevirtual #36                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     136: invokevirtual #39                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     139: invokeinterface #65,  2           // InterfaceMethod org/apache/commons/logging/Log.error:(Ljava/lang/Object;)V
     144: aload_0
     145: getfield      #8                  // Field suspensions:Ljava/util/Map;
     148: aload_2
     149: invokeinterface #45,  2           // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     154: pop
     155: return
    Exception table:
       from    to  target type
          32   105   108   Class java/lang/InterruptedException
}
