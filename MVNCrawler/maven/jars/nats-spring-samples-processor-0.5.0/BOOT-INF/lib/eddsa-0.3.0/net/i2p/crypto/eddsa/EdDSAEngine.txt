Compiled from "EdDSAEngine.java"
public final class net.i2p.crypto.eddsa.EdDSAEngine extends java.security.Signature {
  public static final java.lang.String SIGNATURE_ALGORITHM;

  private java.security.MessageDigest digest;

  private java.io.ByteArrayOutputStream baos;

  private net.i2p.crypto.eddsa.EdDSAKey key;

  private boolean oneShotMode;

  private byte[] oneShotBytes;

  private int oneShotOffset;

  private int oneShotLength;

  public static final java.security.spec.AlgorithmParameterSpec ONE_SHOT_MODE;

  public net.i2p.crypto.eddsa.EdDSAEngine();
    Code:
       0: aload_0
       1: ldc           #2                  // String NONEwithEdDSA
       3: invokespecial #3                  // Method java/security/Signature."<init>":(Ljava/lang/String;)V
       6: return

  public net.i2p.crypto.eddsa.EdDSAEngine(java.security.MessageDigest);
    Code:
       0: aload_0
       1: invokespecial #4                  // Method "<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #5                  // Field digest:Ljava/security/MessageDigest;
       9: return

  private void reset();
    Code:
       0: aload_0
       1: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
       4: ifnull        14
       7: aload_0
       8: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
      11: invokevirtual #6                  // Method java/security/MessageDigest.reset:()V
      14: aload_0
      15: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      18: ifnull        28
      21: aload_0
      22: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      25: invokevirtual #8                  // Method java/io/ByteArrayOutputStream.reset:()V
      28: aload_0
      29: iconst_0
      30: putfield      #9                  // Field oneShotMode:Z
      33: aload_0
      34: aconst_null
      35: putfield      #10                 // Field oneShotBytes:[B
      38: return

  protected void engineInitSign(java.security.PrivateKey) throws java.security.InvalidKeyException;
    Code:
       0: aload_0
       1: invokespecial #11                 // Method reset:()V
       4: aload_1
       5: instanceof    #12                 // class net/i2p/crypto/eddsa/EdDSAPrivateKey
       8: ifeq          137
      11: aload_1
      12: checkcast     #12                 // class net/i2p/crypto/eddsa/EdDSAPrivateKey
      15: astore_2
      16: aload_0
      17: aload_2
      18: putfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      21: aload_0
      22: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
      25: ifnonnull     94
      28: aload_0
      29: aload_0
      30: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      33: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
      38: invokevirtual #15                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getHashAlgorithm:()Ljava/lang/String;
      41: invokestatic  #16                 // Method java/security/MessageDigest.getInstance:(Ljava/lang/String;)Ljava/security/MessageDigest;
      44: putfield      #5                  // Field digest:Ljava/security/MessageDigest;
      47: goto          129
      50: astore_3
      51: new           #18                 // class java/security/InvalidKeyException
      54: dup
      55: new           #19                 // class java/lang/StringBuilder
      58: dup
      59: invokespecial #20                 // Method java/lang/StringBuilder."<init>":()V
      62: ldc           #21                 // String cannot get required digest
      64: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      67: aload_0
      68: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      71: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
      76: invokevirtual #15                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getHashAlgorithm:()Ljava/lang/String;
      79: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      82: ldc           #23                 // String  for private key.
      84: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      87: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      90: invokespecial #25                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      93: athrow
      94: aload_0
      95: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      98: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
     103: invokevirtual #15                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getHashAlgorithm:()Ljava/lang/String;
     106: aload_0
     107: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
     110: invokevirtual #26                 // Method java/security/MessageDigest.getAlgorithm:()Ljava/lang/String;
     113: invokevirtual #27                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     116: ifne          129
     119: new           #18                 // class java/security/InvalidKeyException
     122: dup
     123: ldc           #28                 // String Key hash algorithm does not match chosen digest
     125: invokespecial #25                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     128: athrow
     129: aload_0
     130: aload_2
     131: invokespecial #29                 // Method digestInitSign:(Lnet/i2p/crypto/eddsa/EdDSAPrivateKey;)V
     134: goto          167
     137: new           #18                 // class java/security/InvalidKeyException
     140: dup
     141: new           #19                 // class java/lang/StringBuilder
     144: dup
     145: invokespecial #20                 // Method java/lang/StringBuilder."<init>":()V
     148: ldc           #30                 // String cannot identify EdDSA private key:
     150: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     153: aload_1
     154: invokevirtual #31                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
     157: invokevirtual #32                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     160: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     163: invokespecial #25                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     166: athrow
     167: return
    Exception table:
       from    to  target type
          28    47    50   Class java/security/NoSuchAlgorithmException

  private void digestInitSign(net.i2p.crypto.eddsa.EdDSAPrivateKey);
    Code:
       0: aload_1
       1: invokevirtual #33                 // Method net/i2p/crypto/eddsa/EdDSAPrivateKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
       4: invokevirtual #34                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getCurve:()Lnet/i2p/crypto/eddsa/math/Curve;
       7: invokevirtual #35                 // Method net/i2p/crypto/eddsa/math/Curve.getField:()Lnet/i2p/crypto/eddsa/math/Field;
      10: invokevirtual #36                 // Method net/i2p/crypto/eddsa/math/Field.getb:()I
      13: istore_2
      14: aload_0
      15: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
      18: aload_1
      19: invokevirtual #37                 // Method net/i2p/crypto/eddsa/EdDSAPrivateKey.getH:()[B
      22: iload_2
      23: bipush        8
      25: idiv
      26: iload_2
      27: iconst_4
      28: idiv
      29: iload_2
      30: bipush        8
      32: idiv
      33: isub
      34: invokevirtual #38                 // Method java/security/MessageDigest.update:([BII)V
      37: return

  protected void engineInitVerify(java.security.PublicKey) throws java.security.InvalidKeyException;
    Code:
       0: aload_0
       1: invokespecial #11                 // Method reset:()V
       4: aload_1
       5: instanceof    #39                 // class net/i2p/crypto/eddsa/EdDSAPublicKey
       8: ifeq          127
      11: aload_0
      12: aload_1
      13: checkcast     #39                 // class net/i2p/crypto/eddsa/EdDSAPublicKey
      16: putfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      19: aload_0
      20: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
      23: ifnonnull     92
      26: aload_0
      27: aload_0
      28: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      31: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
      36: invokevirtual #15                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getHashAlgorithm:()Ljava/lang/String;
      39: invokestatic  #16                 // Method java/security/MessageDigest.getInstance:(Ljava/lang/String;)Ljava/security/MessageDigest;
      42: putfield      #5                  // Field digest:Ljava/security/MessageDigest;
      45: goto          229
      48: astore_2
      49: new           #18                 // class java/security/InvalidKeyException
      52: dup
      53: new           #19                 // class java/lang/StringBuilder
      56: dup
      57: invokespecial #20                 // Method java/lang/StringBuilder."<init>":()V
      60: ldc           #21                 // String cannot get required digest
      62: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      65: aload_0
      66: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      69: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
      74: invokevirtual #15                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getHashAlgorithm:()Ljava/lang/String;
      77: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      80: ldc           #23                 // String  for private key.
      82: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      85: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      88: invokespecial #25                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      91: athrow
      92: aload_0
      93: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      96: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
     101: invokevirtual #15                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getHashAlgorithm:()Ljava/lang/String;
     104: aload_0
     105: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
     108: invokevirtual #26                 // Method java/security/MessageDigest.getAlgorithm:()Ljava/lang/String;
     111: invokevirtual #27                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     114: ifne          229
     117: new           #18                 // class java/security/InvalidKeyException
     120: dup
     121: ldc           #28                 // String Key hash algorithm does not match chosen digest
     123: invokespecial #25                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     126: athrow
     127: aload_1
     128: instanceof    #40                 // class sun/security/x509/X509Key
     131: ifeq          199
     134: new           #39                 // class net/i2p/crypto/eddsa/EdDSAPublicKey
     137: dup
     138: new           #41                 // class java/security/spec/X509EncodedKeySpec
     141: dup
     142: aload_1
     143: invokeinterface #42,  1           // InterfaceMethod java/security/PublicKey.getEncoded:()[B
     148: invokespecial #43                 // Method java/security/spec/X509EncodedKeySpec."<init>":([B)V
     151: invokespecial #44                 // Method net/i2p/crypto/eddsa/EdDSAPublicKey."<init>":(Ljava/security/spec/X509EncodedKeySpec;)V
     154: astore_2
     155: goto          191
     158: astore_3
     159: new           #18                 // class java/security/InvalidKeyException
     162: dup
     163: new           #19                 // class java/lang/StringBuilder
     166: dup
     167: invokespecial #20                 // Method java/lang/StringBuilder."<init>":()V
     170: ldc           #46                 // String cannot handle X.509 EdDSA public key:
     172: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     175: aload_1
     176: invokeinterface #47,  1           // InterfaceMethod java/security/PublicKey.getAlgorithm:()Ljava/lang/String;
     181: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     184: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     187: invokespecial #25                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     190: athrow
     191: aload_0
     192: aload_2
     193: invokevirtual #48                 // Method engineInitVerify:(Ljava/security/PublicKey;)V
     196: goto          229
     199: new           #18                 // class java/security/InvalidKeyException
     202: dup
     203: new           #19                 // class java/lang/StringBuilder
     206: dup
     207: invokespecial #20                 // Method java/lang/StringBuilder."<init>":()V
     210: ldc           #49                 // String cannot identify EdDSA public key:
     212: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     215: aload_1
     216: invokevirtual #31                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
     219: invokevirtual #32                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     222: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     225: invokespecial #25                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     228: athrow
     229: return
    Exception table:
       from    to  target type
          26    45    48   Class java/security/NoSuchAlgorithmException
         134   155   158   Class java/security/spec/InvalidKeySpecException

  protected void engineUpdate(byte) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: getfield      #9                  // Field oneShotMode:Z
       4: ifeq          17
       7: new           #50                 // class java/security/SignatureException
      10: dup
      11: ldc           #51                 // String unsupported in one-shot mode
      13: invokespecial #52                 // Method java/security/SignatureException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_0
      18: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      21: ifnonnull     38
      24: aload_0
      25: new           #53                 // class java/io/ByteArrayOutputStream
      28: dup
      29: sipush        256
      32: invokespecial #54                 // Method java/io/ByteArrayOutputStream."<init>":(I)V
      35: putfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      38: aload_0
      39: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      42: iload_1
      43: invokevirtual #55                 // Method java/io/ByteArrayOutputStream.write:(I)V
      46: return

  protected void engineUpdate(byte[], int, int) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: getfield      #9                  // Field oneShotMode:Z
       4: ifeq          42
       7: aload_0
       8: getfield      #10                 // Field oneShotBytes:[B
      11: ifnull        24
      14: new           #50                 // class java/security/SignatureException
      17: dup
      18: ldc           #56                 // String update() already called
      20: invokespecial #52                 // Method java/security/SignatureException."<init>":(Ljava/lang/String;)V
      23: athrow
      24: aload_0
      25: aload_1
      26: putfield      #10                 // Field oneShotBytes:[B
      29: aload_0
      30: iload_2
      31: putfield      #57                 // Field oneShotOffset:I
      34: aload_0
      35: iload_3
      36: putfield      #58                 // Field oneShotLength:I
      39: goto          73
      42: aload_0
      43: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      46: ifnonnull     63
      49: aload_0
      50: new           #53                 // class java/io/ByteArrayOutputStream
      53: dup
      54: sipush        256
      57: invokespecial #54                 // Method java/io/ByteArrayOutputStream."<init>":(I)V
      60: putfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      63: aload_0
      64: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      67: aload_1
      68: iload_2
      69: iload_3
      70: invokevirtual #59                 // Method java/io/ByteArrayOutputStream.write:([BII)V
      73: return

  protected byte[] engineSign() throws java.security.SignatureException;
    Code:
       0: aload_0
       1: invokespecial #60                 // Method x_engineSign:()[B
       4: astore_1
       5: aload_0
       6: invokespecial #11                 // Method reset:()V
       9: aload_0
      10: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      13: checkcast     #12                 // class net/i2p/crypto/eddsa/EdDSAPrivateKey
      16: astore_2
      17: aload_0
      18: aload_2
      19: invokespecial #29                 // Method digestInitSign:(Lnet/i2p/crypto/eddsa/EdDSAPrivateKey;)V
      22: aload_1
      23: areturn
      24: astore_3
      25: aload_0
      26: invokespecial #11                 // Method reset:()V
      29: aload_0
      30: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      33: checkcast     #12                 // class net/i2p/crypto/eddsa/EdDSAPrivateKey
      36: astore        4
      38: aload_0
      39: aload         4
      41: invokespecial #29                 // Method digestInitSign:(Lnet/i2p/crypto/eddsa/EdDSAPrivateKey;)V
      44: aload_3
      45: athrow
    Exception table:
       from    to  target type
           0     5    24   any

  private byte[] x_engineSign() throws java.security.SignatureException;
    Code:
       0: aload_0
       1: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
       4: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
       9: invokevirtual #34                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getCurve:()Lnet/i2p/crypto/eddsa/math/Curve;
      12: astore_1
      13: aload_0
      14: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      17: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
      22: invokevirtual #61                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getScalarOps:()Lnet/i2p/crypto/eddsa/math/ScalarOps;
      25: astore_2
      26: aload_0
      27: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      30: checkcast     #12                 // class net/i2p/crypto/eddsa/EdDSAPrivateKey
      33: invokevirtual #62                 // Method net/i2p/crypto/eddsa/EdDSAPrivateKey.geta:()[B
      36: astore_3
      37: aload_0
      38: getfield      #9                  // Field oneShotMode:Z
      41: ifeq          82
      44: aload_0
      45: getfield      #10                 // Field oneShotBytes:[B
      48: ifnonnull     61
      51: new           #50                 // class java/security/SignatureException
      54: dup
      55: ldc           #63                 // String update() not called first
      57: invokespecial #52                 // Method java/security/SignatureException."<init>":(Ljava/lang/String;)V
      60: athrow
      61: aload_0
      62: getfield      #10                 // Field oneShotBytes:[B
      65: astore        4
      67: aload_0
      68: getfield      #57                 // Field oneShotOffset:I
      71: istore        5
      73: aload_0
      74: getfield      #58                 // Field oneShotLength:I
      77: istore        6
      79: goto          114
      82: aload_0
      83: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      86: ifnonnull     97
      89: iconst_0
      90: newarray       byte
      92: astore        4
      94: goto          106
      97: aload_0
      98: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
     101: invokevirtual #64                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     104: astore        4
     106: iconst_0
     107: istore        5
     109: aload         4
     111: arraylength
     112: istore        6
     114: aload_0
     115: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
     118: aload         4
     120: iload         5
     122: iload         6
     124: invokevirtual #38                 // Method java/security/MessageDigest.update:([BII)V
     127: aload_0
     128: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
     131: invokevirtual #65                 // Method java/security/MessageDigest.digest:()[B
     134: astore        7
     136: aload_2
     137: aload         7
     139: invokeinterface #66,  2           // InterfaceMethod net/i2p/crypto/eddsa/math/ScalarOps.reduce:([B)[B
     144: astore        7
     146: aload_0
     147: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
     150: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
     155: invokevirtual #67                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getB:()Lnet/i2p/crypto/eddsa/math/GroupElement;
     158: aload         7
     160: invokevirtual #68                 // Method net/i2p/crypto/eddsa/math/GroupElement.scalarMultiply:([B)Lnet/i2p/crypto/eddsa/math/GroupElement;
     163: astore        8
     165: aload         8
     167: invokevirtual #69                 // Method net/i2p/crypto/eddsa/math/GroupElement.toByteArray:()[B
     170: astore        9
     172: aload_0
     173: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
     176: aload         9
     178: invokevirtual #70                 // Method java/security/MessageDigest.update:([B)V
     181: aload_0
     182: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
     185: aload_0
     186: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
     189: checkcast     #12                 // class net/i2p/crypto/eddsa/EdDSAPrivateKey
     192: invokevirtual #71                 // Method net/i2p/crypto/eddsa/EdDSAPrivateKey.getAbyte:()[B
     195: invokevirtual #70                 // Method java/security/MessageDigest.update:([B)V
     198: aload_0
     199: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
     202: aload         4
     204: iload         5
     206: iload         6
     208: invokevirtual #38                 // Method java/security/MessageDigest.update:([BII)V
     211: aload_0
     212: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
     215: invokevirtual #65                 // Method java/security/MessageDigest.digest:()[B
     218: astore        10
     220: aload_2
     221: aload         10
     223: invokeinterface #66,  2           // InterfaceMethod net/i2p/crypto/eddsa/math/ScalarOps.reduce:([B)[B
     228: astore        10
     230: aload_2
     231: aload         10
     233: aload_3
     234: aload         7
     236: invokeinterface #72,  4           // InterfaceMethod net/i2p/crypto/eddsa/math/ScalarOps.multiplyAndAdd:([B[B[B)[B
     241: astore        11
     243: aload_1
     244: invokevirtual #35                 // Method net/i2p/crypto/eddsa/math/Curve.getField:()Lnet/i2p/crypto/eddsa/math/Field;
     247: invokevirtual #36                 // Method net/i2p/crypto/eddsa/math/Field.getb:()I
     250: istore        12
     252: iload         12
     254: iconst_4
     255: idiv
     256: invokestatic  #73                 // Method java/nio/ByteBuffer.allocate:(I)Ljava/nio/ByteBuffer;
     259: astore        13
     261: aload         13
     263: aload         9
     265: invokevirtual #74                 // Method java/nio/ByteBuffer.put:([B)Ljava/nio/ByteBuffer;
     268: aload         11
     270: invokevirtual #74                 // Method java/nio/ByteBuffer.put:([B)Ljava/nio/ByteBuffer;
     273: pop
     274: aload         13
     276: invokevirtual #75                 // Method java/nio/ByteBuffer.array:()[B
     279: areturn

  protected boolean engineVerify(byte[]) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #76                 // Method x_engineVerify:([B)Z
       5: istore_2
       6: aload_0
       7: invokespecial #11                 // Method reset:()V
      10: iload_2
      11: ireturn
      12: astore_3
      13: aload_0
      14: invokespecial #11                 // Method reset:()V
      17: aload_3
      18: athrow
    Exception table:
       from    to  target type
           0     6    12   any

  private boolean x_engineVerify(byte[]) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
       4: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
       9: invokevirtual #34                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getCurve:()Lnet/i2p/crypto/eddsa/math/Curve;
      12: astore_2
      13: aload_2
      14: invokevirtual #35                 // Method net/i2p/crypto/eddsa/math/Curve.getField:()Lnet/i2p/crypto/eddsa/math/Field;
      17: invokevirtual #36                 // Method net/i2p/crypto/eddsa/math/Field.getb:()I
      20: istore_3
      21: aload_1
      22: arraylength
      23: iload_3
      24: iconst_4
      25: idiv
      26: if_icmpeq     39
      29: new           #50                 // class java/security/SignatureException
      32: dup
      33: ldc           #77                 // String signature length is wrong
      35: invokespecial #52                 // Method java/security/SignatureException."<init>":(Ljava/lang/String;)V
      38: athrow
      39: aload_0
      40: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
      43: aload_1
      44: iconst_0
      45: iload_3
      46: bipush        8
      48: idiv
      49: invokevirtual #38                 // Method java/security/MessageDigest.update:([BII)V
      52: aload_0
      53: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
      56: aload_0
      57: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
      60: checkcast     #39                 // class net/i2p/crypto/eddsa/EdDSAPublicKey
      63: invokevirtual #78                 // Method net/i2p/crypto/eddsa/EdDSAPublicKey.getAbyte:()[B
      66: invokevirtual #70                 // Method java/security/MessageDigest.update:([B)V
      69: aload_0
      70: getfield      #9                  // Field oneShotMode:Z
      73: ifeq          114
      76: aload_0
      77: getfield      #10                 // Field oneShotBytes:[B
      80: ifnonnull     93
      83: new           #50                 // class java/security/SignatureException
      86: dup
      87: ldc           #63                 // String update() not called first
      89: invokespecial #52                 // Method java/security/SignatureException."<init>":(Ljava/lang/String;)V
      92: athrow
      93: aload_0
      94: getfield      #10                 // Field oneShotBytes:[B
      97: astore        4
      99: aload_0
     100: getfield      #57                 // Field oneShotOffset:I
     103: istore        5
     105: aload_0
     106: getfield      #58                 // Field oneShotLength:I
     109: istore        6
     111: goto          146
     114: aload_0
     115: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
     118: ifnonnull     129
     121: iconst_0
     122: newarray       byte
     124: astore        4
     126: goto          138
     129: aload_0
     130: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
     133: invokevirtual #64                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     136: astore        4
     138: iconst_0
     139: istore        5
     141: aload         4
     143: arraylength
     144: istore        6
     146: aload_0
     147: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
     150: aload         4
     152: iload         5
     154: iload         6
     156: invokevirtual #38                 // Method java/security/MessageDigest.update:([BII)V
     159: aload_0
     160: getfield      #5                  // Field digest:Ljava/security/MessageDigest;
     163: invokevirtual #65                 // Method java/security/MessageDigest.digest:()[B
     166: astore        7
     168: aload_0
     169: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
     172: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
     177: invokevirtual #61                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getScalarOps:()Lnet/i2p/crypto/eddsa/math/ScalarOps;
     180: aload         7
     182: invokeinterface #66,  2           // InterfaceMethod net/i2p/crypto/eddsa/math/ScalarOps.reduce:([B)[B
     187: astore        7
     189: aload_1
     190: iload_3
     191: bipush        8
     193: idiv
     194: iload_3
     195: iconst_4
     196: idiv
     197: invokestatic  #79                 // Method java/util/Arrays.copyOfRange:([BII)[B
     200: astore        8
     202: aload_0
     203: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
     206: invokeinterface #14,  1           // InterfaceMethod net/i2p/crypto/eddsa/EdDSAKey.getParams:()Lnet/i2p/crypto/eddsa/spec/EdDSAParameterSpec;
     211: invokevirtual #67                 // Method net/i2p/crypto/eddsa/spec/EdDSAParameterSpec.getB:()Lnet/i2p/crypto/eddsa/math/GroupElement;
     214: aload_0
     215: getfield      #13                 // Field key:Lnet/i2p/crypto/eddsa/EdDSAKey;
     218: checkcast     #39                 // class net/i2p/crypto/eddsa/EdDSAPublicKey
     221: invokevirtual #80                 // Method net/i2p/crypto/eddsa/EdDSAPublicKey.getNegativeA:()Lnet/i2p/crypto/eddsa/math/GroupElement;
     224: aload         7
     226: aload         8
     228: invokevirtual #81                 // Method net/i2p/crypto/eddsa/math/GroupElement.doubleScalarMultiplyVariableTime:(Lnet/i2p/crypto/eddsa/math/GroupElement;[B[B)Lnet/i2p/crypto/eddsa/math/GroupElement;
     231: astore        9
     233: aload         9
     235: invokevirtual #69                 // Method net/i2p/crypto/eddsa/math/GroupElement.toByteArray:()[B
     238: astore        10
     240: iconst_0
     241: istore        11
     243: iload         11
     245: aload         10
     247: arraylength
     248: if_icmpge     271
     251: aload         10
     253: iload         11
     255: baload
     256: aload_1
     257: iload         11
     259: baload
     260: if_icmpeq     265
     263: iconst_0
     264: ireturn
     265: iinc          11, 1
     268: goto          243
     271: iconst_1
     272: ireturn

  public byte[] signOneShot(byte[]) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: aload_1
       2: iconst_0
       3: aload_1
       4: arraylength
       5: invokevirtual #82                 // Method signOneShot:([BII)[B
       8: areturn

  public byte[] signOneShot(byte[], int, int) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: iconst_1
       2: putfield      #9                  // Field oneShotMode:Z
       5: aload_0
       6: aload_1
       7: iload_2
       8: iload_3
       9: invokevirtual #83                 // Method update:([BII)V
      12: aload_0
      13: invokevirtual #84                 // Method sign:()[B
      16: areturn

  public boolean verifyOneShot(byte[], byte[]) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: aload_1
       2: iconst_0
       3: aload_1
       4: arraylength
       5: aload_2
       6: iconst_0
       7: aload_2
       8: arraylength
       9: invokevirtual #85                 // Method verifyOneShot:([BII[BII)Z
      12: ireturn

  public boolean verifyOneShot(byte[], int, int, byte[]) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: aload_1
       2: iload_2
       3: iload_3
       4: aload         4
       6: iconst_0
       7: aload         4
       9: arraylength
      10: invokevirtual #85                 // Method verifyOneShot:([BII[BII)Z
      13: ireturn

  public boolean verifyOneShot(byte[], byte[], int, int) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: aload_1
       2: iconst_0
       3: aload_1
       4: arraylength
       5: aload_2
       6: iload_3
       7: iload         4
       9: invokevirtual #85                 // Method verifyOneShot:([BII[BII)Z
      12: ireturn

  public boolean verifyOneShot(byte[], int, int, byte[], int, int) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: iconst_1
       2: putfield      #9                  // Field oneShotMode:Z
       5: aload_0
       6: aload_1
       7: iload_2
       8: iload_3
       9: invokevirtual #83                 // Method update:([BII)V
      12: aload_0
      13: aload         4
      15: iload         5
      17: iload         6
      19: invokevirtual #86                 // Method verify:([BII)Z
      22: ireturn

  protected void engineSetParameter(java.security.spec.AlgorithmParameterSpec) throws java.security.InvalidAlgorithmParameterException;
    Code:
       0: aload_1
       1: getstatic     #87                 // Field ONE_SHOT_MODE:Ljava/security/spec/AlgorithmParameterSpec;
       4: invokevirtual #88                 // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
       7: ifeq          52
      10: aload_0
      11: getfield      #10                 // Field oneShotBytes:[B
      14: ifnonnull     34
      17: aload_0
      18: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      21: ifnull        44
      24: aload_0
      25: getfield      #7                  // Field baos:Ljava/io/ByteArrayOutputStream;
      28: invokevirtual #89                 // Method java/io/ByteArrayOutputStream.size:()I
      31: ifle          44
      34: new           #90                 // class java/security/InvalidAlgorithmParameterException
      37: dup
      38: ldc           #56                 // String update() already called
      40: invokespecial #91                 // Method java/security/InvalidAlgorithmParameterException."<init>":(Ljava/lang/String;)V
      43: athrow
      44: aload_0
      45: iconst_1
      46: putfield      #9                  // Field oneShotMode:Z
      49: goto          57
      52: aload_0
      53: aload_1
      54: invokespecial #92                 // Method java/security/Signature.engineSetParameter:(Ljava/security/spec/AlgorithmParameterSpec;)V
      57: return

  protected void engineSetParameter(java.lang.String, java.lang.Object);
    Code:
       0: new           #93                 // class java/lang/UnsupportedOperationException
       3: dup
       4: ldc           #94                 // String engineSetParameter unsupported
       6: invokespecial #95                 // Method java/lang/UnsupportedOperationException."<init>":(Ljava/lang/String;)V
       9: athrow

  protected java.lang.Object engineGetParameter(java.lang.String);
    Code:
       0: new           #93                 // class java/lang/UnsupportedOperationException
       3: dup
       4: ldc           #94                 // String engineSetParameter unsupported
       6: invokespecial #95                 // Method java/lang/UnsupportedOperationException."<init>":(Ljava/lang/String;)V
       9: athrow

  static {};
    Code:
       0: new           #96                 // class net/i2p/crypto/eddsa/EdDSAEngine$OneShotSpec
       3: dup
       4: aconst_null
       5: invokespecial #97                 // Method net/i2p/crypto/eddsa/EdDSAEngine$OneShotSpec."<init>":(Lnet/i2p/crypto/eddsa/EdDSAEngine$1;)V
       8: putstatic     #87                 // Field ONE_SHOT_MODE:Ljava/security/spec/AlgorithmParameterSpec;
      11: return
}
