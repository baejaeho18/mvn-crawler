Compiled from "FlakyTestRetryAnalyzer.java"
public class io.trino.testng.services.FlakyTestRetryAnalyzer implements org.testng.IRetryAnalyzer {
  private static final io.airlift.log.Logger log;

  private static final java.lang.String ENABLED_SYSTEM_PROPERTY;

  static final int ALLOWED_RETRIES_COUNT;

  private final java.util.Map<java.lang.String, java.lang.Long> retryCounter;

  public io.trino.testng.services.FlakyTestRetryAnalyzer();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/HashMap
       8: dup
       9: invokespecial #3                  // Method java/util/HashMap."<init>":()V
      12: putfield      #4                  // Field retryCounter:Ljava/util/Map;
      15: return

  public boolean retry(org.testng.ITestResult);
    Code:
       0: aload_1
       1: invokeinterface #5,  1            // InterfaceMethod org/testng/ITestResult.isSuccess:()Z
       6: ifeq          11
       9: iconst_0
      10: ireturn
      11: ldc           #7                  // String io.trino.testng.services.FlakyTestRetryAnalyzer.enabled
      13: invokestatic  #8                  // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      16: invokestatic  #9                  // Method java/util/Optional.ofNullable:(Ljava/lang/Object;)Ljava/util/Optional;
      19: astore_2
      20: aload_2
      21: invokedynamic #10,  0             // InvokeDynamic #0:apply:()Ljava/util/function/Function;
      26: invokevirtual #11                 // Method java/util/Optional.map:(Ljava/util/function/Function;)Ljava/util/Optional;
      29: ldc           #12                 // String CONTINUOUS_INTEGRATION
      31: invokestatic  #13                 // Method java/lang/System.getenv:(Ljava/lang/String;)Ljava/lang/String;
      34: ifnull        41
      37: iconst_1
      38: goto          42
      41: iconst_0
      42: invokestatic  #14                 // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
      45: invokevirtual #15                 // Method java/util/Optional.orElse:(Ljava/lang/Object;)Ljava/lang/Object;
      48: checkcast     #16                 // class java/lang/Boolean
      51: invokevirtual #17                 // Method java/lang/Boolean.booleanValue:()Z
      54: ifne          85
      57: getstatic     #18                 // Field log:Lio/airlift/log/Logger;
      60: ldc           #19                 // String FlakyTestRetryAnalyzer not enabled: CONTINUOUS_INTEGRATION environment is not detected or system property \'%s\' is not set to \'true\' (actual: %s)
      62: iconst_2
      63: anewarray     #20                 // class java/lang/Object
      66: dup
      67: iconst_0
      68: ldc           #7                  // String io.trino.testng.services.FlakyTestRetryAnalyzer.enabled
      70: aastore
      71: dup
      72: iconst_1
      73: aload_2
      74: ldc           #21                 // String <not set>
      76: invokevirtual #15                 // Method java/util/Optional.orElse:(Ljava/lang/Object;)Ljava/lang/Object;
      79: aastore
      80: invokevirtual #22                 // Method io/airlift/log/Logger.info:(Ljava/lang/String;[Ljava/lang/Object;)V
      83: iconst_0
      84: ireturn
      85: aload_1
      86: invokeinterface #23,  1           // InterfaceMethod org/testng/ITestResult.getMethod:()Lorg/testng/ITestNGMethod;
      91: invokeinterface #24,  1           // InterfaceMethod org/testng/ITestNGMethod.getConstructorOrMethod:()Lorg/testng/internal/ConstructorOrMethod;
      96: invokevirtual #25                 // Method org/testng/internal/ConstructorOrMethod.getMethod:()Ljava/lang/reflect/Method;
      99: astore_3
     100: aload_3
     101: ifnonnull     114
     104: getstatic     #18                 // Field log:Lio/airlift/log/Logger;
     107: ldc           #26                 // String not retrying; cannot get java method
     109: invokevirtual #27                 // Method io/airlift/log/Logger.info:(Ljava/lang/String;)V
     112: iconst_0
     113: ireturn
     114: aload_3
     115: ldc           #28                 // class io/trino/testng/services/Flaky
     117: invokevirtual #29                 // Method java/lang/reflect/Method.getAnnotation:(Ljava/lang/Class;)Ljava/lang/annotation/Annotation;
     120: checkcast     #28                 // class io/trino/testng/services/Flaky
     123: astore        4
     125: aload         4
     127: ifnonnull     140
     130: getstatic     #18                 // Field log:Lio/airlift/log/Logger;
     133: ldc           #30                 // String not retrying; @Flaky annotation not present
     135: invokevirtual #27                 // Method io/airlift/log/Logger.info:(Ljava/lang/String;)V
     138: iconst_0
     139: ireturn
     140: aload_1
     141: invokeinterface #31,  1           // InterfaceMethod org/testng/ITestResult.getThrowable:()Ljava/lang/Throwable;
     146: ifnonnull     159
     149: getstatic     #18                 // Field log:Lio/airlift/log/Logger;
     152: ldc           #32                 // String not retrying; throwable not present in result
     154: invokevirtual #27                 // Method io/airlift/log/Logger.info:(Ljava/lang/String;)V
     157: iconst_0
     158: ireturn
     159: aload_1
     160: invokeinterface #31,  1           // InterfaceMethod org/testng/ITestResult.getThrowable:()Ljava/lang/Throwable;
     165: invokestatic  #33                 // Method com/google/common/base/Throwables.getStackTraceAsString:(Ljava/lang/Throwable;)Ljava/lang/String;
     168: astore        5
     170: aload         4
     172: invokeinterface #34,  1           // InterfaceMethod io/trino/testng/services/Flaky.match:()Ljava/lang/String;
     177: invokestatic  #35                 // Method java/util/regex/Pattern.compile:(Ljava/lang/String;)Ljava/util/regex/Pattern;
     180: aload         5
     182: invokevirtual #36                 // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
     185: invokevirtual #37                 // Method java/util/regex/Matcher.find:()Z
     188: ifne          220
     191: getstatic     #18                 // Field log:Lio/airlift/log/Logger;
     194: ldc           #38                 // String not retrying; stacktrace \'%s\' does not match pattern \'%s\'
     196: iconst_2
     197: anewarray     #20                 // class java/lang/Object
     200: dup
     201: iconst_0
     202: aload         5
     204: aastore
     205: dup
     206: iconst_1
     207: aload         4
     209: invokeinterface #34,  1           // InterfaceMethod io/trino/testng/services/Flaky.match:()Ljava/lang/String;
     214: aastore
     215: invokevirtual #39                 // Method io/airlift/log/Logger.warn:(Ljava/lang/String;[Ljava/lang/Object;)V
     218: iconst_0
     219: ireturn
     220: aload_1
     221: invokeinterface #23,  1           // InterfaceMethod org/testng/ITestResult.getMethod:()Lorg/testng/ITestNGMethod;
     226: astore        8
     228: aload_0
     229: dup
     230: astore        9
     232: monitorenter
     233: aload         8
     235: aload_1
     236: invokeinterface #40,  1           // InterfaceMethod org/testng/ITestResult.getParameters:()[Ljava/lang/Object;
     241: invokestatic  #41                 // Method getName:(Lorg/testng/ITestNGMethod;[Ljava/lang/Object;)Ljava/lang/String;
     244: astore        10
     246: aload_0
     247: getfield      #4                  // Field retryCounter:Ljava/util/Map;
     250: aload         10
     252: lconst_0
     253: invokestatic  #42                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     256: invokeinterface #43,  3           // InterfaceMethod java/util/Map.getOrDefault:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     261: checkcast     #44                 // class java/lang/Long
     264: invokevirtual #45                 // Method java/lang/Long.longValue:()J
     267: lstore        6
     269: lload         6
     271: lconst_1
     272: ladd
     273: lstore        6
     275: lload         6
     277: ldc2_w        #46                 // long 2l
     280: lcmp
     281: ifle          289
     284: iconst_0
     285: aload         9
     287: monitorexit
     288: ireturn
     289: aload_0
     290: getfield      #4                  // Field retryCounter:Ljava/util/Map;
     293: aload         10
     295: lload         6
     297: invokestatic  #42                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     300: invokeinterface #48,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     305: pop
     306: aload         9
     308: monitorexit
     309: goto          320
     312: astore        11
     314: aload         9
     316: monitorexit
     317: aload         11
     319: athrow
     320: getstatic     #18                 // Field log:Lio/airlift/log/Logger;
     323: aload_1
     324: invokeinterface #31,  1           // InterfaceMethod org/testng/ITestResult.getThrowable:()Ljava/lang/Throwable;
     329: ldc           #49                 // String Test %s::%s attempt %s failed, retrying...,
     331: iconst_3
     332: anewarray     #20                 // class java/lang/Object
     335: dup
     336: iconst_0
     337: aload_1
     338: invokeinterface #50,  1           // InterfaceMethod org/testng/ITestResult.getTestClass:()Lorg/testng/IClass;
     343: invokeinterface #51,  1           // InterfaceMethod org/testng/IClass.getName:()Ljava/lang/String;
     348: aastore
     349: dup
     350: iconst_1
     351: aload         8
     353: invokeinterface #52,  1           // InterfaceMethod org/testng/ITestNGMethod.getMethodName:()Ljava/lang/String;
     358: aastore
     359: dup
     360: iconst_2
     361: lload         6
     363: invokestatic  #42                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     366: aastore
     367: invokevirtual #53                 // Method io/airlift/log/Logger.warn:(Ljava/lang/Throwable;Ljava/lang/String;[Ljava/lang/Object;)V
     370: iconst_1
     371: ireturn
    Exception table:
       from    to  target type
         233   288   312   any
         289   309   312   any
         312   317   312   any

  private static java.lang.String getName(org.testng.ITestNGMethod, java.lang.Object[]);
    Code:
       0: aload_0
       1: invokeinterface #54,  1           // InterfaceMethod org/testng/ITestNGMethod.getTestClass:()Lorg/testng/ITestClass;
       6: invokeinterface #55,  1           // InterfaceMethod org/testng/ITestClass.getName:()Ljava/lang/String;
      11: astore_2
      12: aload_1
      13: arraylength
      14: ifeq          73
      17: ldc           #56                 // String %s::%s(%s)
      19: iconst_3
      20: anewarray     #20                 // class java/lang/Object
      23: dup
      24: iconst_0
      25: aload_2
      26: aastore
      27: dup
      28: iconst_1
      29: aload_0
      30: invokeinterface #52,  1           // InterfaceMethod org/testng/ITestNGMethod.getMethodName:()Ljava/lang/String;
      35: aastore
      36: dup
      37: iconst_2
      38: ldc           #57                 // String ,
      40: aload_1
      41: invokestatic  #58                 // InterfaceMethod java/util/stream/Stream.of:([Ljava/lang/Object;)Ljava/util/stream/Stream;
      44: invokedynamic #59,  0             // InvokeDynamic #1:apply:()Ljava/util/function/Function;
      49: invokeinterface #60,  2           // InterfaceMethod java/util/stream/Stream.map:(Ljava/util/function/Function;)Ljava/util/stream/Stream;
      54: invokestatic  #61                 // Method com/google/common/collect/ImmutableList.toImmutableList:()Ljava/util/stream/Collector;
      57: invokeinterface #62,  2           // InterfaceMethod java/util/stream/Stream.collect:(Ljava/util/stream/Collector;)Ljava/lang/Object;
      62: checkcast     #63                 // class java/lang/Iterable
      65: invokestatic  #64                 // Method java/lang/String.join:(Ljava/lang/CharSequence;Ljava/lang/Iterable;)Ljava/lang/String;
      68: aastore
      69: invokestatic  #65                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      72: areturn
      73: ldc           #66                 // String %s::%s
      75: iconst_2
      76: anewarray     #20                 // class java/lang/Object
      79: dup
      80: iconst_0
      81: aload_2
      82: aastore
      83: dup
      84: iconst_1
      85: aload_0
      86: invokeinterface #52,  1           // InterfaceMethod org/testng/ITestNGMethod.getMethodName:()Ljava/lang/String;
      91: aastore
      92: invokestatic  #65                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      95: areturn

  static {};
    Code:
       0: ldc           #6                  // class io/trino/testng/services/FlakyTestRetryAnalyzer
       2: invokestatic  #67                 // Method io/airlift/log/Logger.get:(Ljava/lang/Class;)Lio/airlift/log/Logger;
       5: putstatic     #18                 // Field log:Lio/airlift/log/Logger;
       8: return
}
