Compiled from "ClientCertRenegotiationTestCase.java"
public class io.undertow.server.security.ClientCertRenegotiationTestCase extends io.undertow.server.security.AuthenticationTestBase {
  private static javax.net.ssl.SSLContext clientSSLContext;

  public io.undertow.server.security.ClientCertRenegotiationTestCase();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method io/undertow/server/security/AuthenticationTestBase."<init>":()V
       4: return

  protected java.util.List<io.undertow.security.api.AuthenticationMechanism> getTestMechanisms();
    Code:
       0: new           #2                  // class io/undertow/security/impl/ClientCertAuthenticationMechanism
       3: dup
       4: invokespecial #3                  // Method io/undertow/security/impl/ClientCertAuthenticationMechanism."<init>":()V
       7: astore_1
       8: aload_1
       9: invokestatic  #4                  // Method java/util/Collections.singletonList:(Ljava/lang/Object;)Ljava/util/List;
      12: areturn

  public static void startSSL() throws java.lang.Exception;
    Code:
       0: getstatic     #5                  // Field org/xnio/Options.SSL_CLIENT_AUTH_MODE:Lorg/xnio/Option;
       3: getstatic     #6                  // Field org/xnio/SslClientAuthMode.NOT_REQUESTED:Lorg/xnio/SslClientAuthMode;
       6: invokestatic  #7                  // Method org/xnio/OptionMap.create:(Lorg/xnio/Option;Ljava/lang/Object;)Lorg/xnio/OptionMap;
       9: invokestatic  #8                  // Method io/undertow/testutils/DefaultServer.startSSLServer:(Lorg/xnio/OptionMap;)V
      12: invokestatic  #9                  // Method io/undertow/testutils/DefaultServer.getClientSSLContext:()Ljavax/net/ssl/SSLContext;
      15: putstatic     #10                 // Field clientSSLContext:Ljavax/net/ssl/SSLContext;
      18: return

  public static void stopSSL() throws java.lang.Exception;
    Code:
       0: aconst_null
       1: putstatic     #10                 // Field clientSSLContext:Ljavax/net/ssl/SSLContext;
       4: invokestatic  #11                 // Method io/undertow/testutils/DefaultServer.stopSSLServer:()V
       7: return

  public void testClientCertSuccess() throws java.lang.Exception;
    Code:
       0: new           #12                 // class io/undertow/testutils/TestHttpClient
       3: dup
       4: invokespecial #13                 // Method io/undertow/testutils/TestHttpClient."<init>":()V
       7: astore_1
       8: aload_1
       9: getstatic     #10                 // Field clientSSLContext:Ljavax/net/ssl/SSLContext;
      12: invokevirtual #14                 // Method io/undertow/testutils/TestHttpClient.setSSLContext:(Ljavax/net/ssl/SSLContext;)V
      15: new           #15                 // class org/apache/http/client/methods/HttpGet
      18: dup
      19: invokestatic  #16                 // Method io/undertow/testutils/DefaultServer.getDefaultServerSSLAddress:()Ljava/lang/String;
      22: invokespecial #17                 // Method org/apache/http/client/methods/HttpGet."<init>":(Ljava/lang/String;)V
      25: astore_2
      26: aload_1
      27: aload_2
      28: invokevirtual #18                 // Method io/undertow/testutils/TestHttpClient.execute:(Lorg/apache/http/client/methods/HttpUriRequest;)Lorg/apache/http/HttpResponse;
      31: astore_3
      32: ldc2_w        #20                 // long 200l
      35: aload_3
      36: invokeinterface #22,  1           // InterfaceMethod org/apache/http/HttpResponse.getStatusLine:()Lorg/apache/http/StatusLine;
      41: invokeinterface #23,  1           // InterfaceMethod org/apache/http/StatusLine.getStatusCode:()I
      46: i2l
      47: invokestatic  #24                 // Method org/junit/Assert.assertEquals:(JJ)V
      50: aload_3
      51: ldc           #25                 // String ProcessedBy
      53: invokeinterface #26,  2           // InterfaceMethod org/apache/http/HttpResponse.getHeaders:(Ljava/lang/String;)[Lorg/apache/http/Header;
      58: astore        4
      60: ldc           #27                 // String ProcessedBy Headers
      62: lconst_1
      63: aload         4
      65: arraylength
      66: i2l
      67: invokestatic  #28                 // Method org/junit/Assert.assertEquals:(Ljava/lang/String;JJ)V
      70: ldc           #29                 // String ResponseHandler
      72: aload         4
      74: iconst_0
      75: aaload
      76: invokeinterface #30,  1           // InterfaceMethod org/apache/http/Header.getValue:()Ljava/lang/String;
      81: invokestatic  #31                 // Method org/junit/Assert.assertEquals:(Ljava/lang/Object;Ljava/lang/Object;)V
      84: aload_3
      85: ldc           #32                 // String AuthenticatedUser
      87: invokeinterface #26,  2           // InterfaceMethod org/apache/http/HttpResponse.getHeaders:(Ljava/lang/String;)[Lorg/apache/http/Header;
      92: astore        4
      94: ldc           #33                 // String AuthenticatedUser Headers
      96: lconst_1
      97: aload         4
      99: arraylength
     100: i2l
     101: invokestatic  #28                 // Method org/junit/Assert.assertEquals:(Ljava/lang/String;JJ)V
     104: ldc           #34                 // String CN=Test Client,OU=OU,O=Org,L=City,ST=State,C=GB
     106: aload         4
     108: iconst_0
     109: aaload
     110: invokeinterface #30,  1           // InterfaceMethod org/apache/http/Header.getValue:()Ljava/lang/String;
     115: invokestatic  #31                 // Method org/junit/Assert.assertEquals:(Ljava/lang/Object;Ljava/lang/Object;)V
     118: aload_3
     119: invokestatic  #35                 // Method io/undertow/testutils/HttpClientUtils.readResponse:(Lorg/apache/http/HttpResponse;)Ljava/lang/String;
     122: pop
     123: getstatic     #36                 // Field io/undertow/security/api/SecurityNotification$EventType.AUTHENTICATED:Lio/undertow/security/api/SecurityNotification$EventType;
     126: invokestatic  #37                 // Method assertSingleNotificationType:(Lio/undertow/security/api/SecurityNotification$EventType;)V
     129: return

  public void testClientCertSuccessWithPostBody() throws java.lang.Exception;
    Code:
       0: new           #12                 // class io/undertow/testutils/TestHttpClient
       3: dup
       4: invokespecial #13                 // Method io/undertow/testutils/TestHttpClient."<init>":()V
       7: astore_1
       8: aload_1
       9: getstatic     #10                 // Field clientSSLContext:Ljavax/net/ssl/SSLContext;
      12: invokevirtual #14                 // Method io/undertow/testutils/TestHttpClient.setSSLContext:(Ljavax/net/ssl/SSLContext;)V
      15: new           #38                 // class org/apache/http/client/methods/HttpPost
      18: dup
      19: invokestatic  #16                 // Method io/undertow/testutils/DefaultServer.getDefaultServerSSLAddress:()Ljava/lang/String;
      22: invokespecial #39                 // Method org/apache/http/client/methods/HttpPost."<init>":(Ljava/lang/String;)V
      25: astore_2
      26: aload_2
      27: new           #40                 // class org/apache/http/entity/StringEntity
      30: dup
      31: ldc           #41                 // String hi
      33: invokespecial #42                 // Method org/apache/http/entity/StringEntity."<init>":(Ljava/lang/String;)V
      36: invokevirtual #43                 // Method org/apache/http/client/methods/HttpPost.setEntity:(Lorg/apache/http/HttpEntity;)V
      39: aload_1
      40: aload_2
      41: invokevirtual #18                 // Method io/undertow/testutils/TestHttpClient.execute:(Lorg/apache/http/client/methods/HttpUriRequest;)Lorg/apache/http/HttpResponse;
      44: astore_3
      45: ldc2_w        #20                 // long 200l
      48: aload_3
      49: invokeinterface #22,  1           // InterfaceMethod org/apache/http/HttpResponse.getStatusLine:()Lorg/apache/http/StatusLine;
      54: invokeinterface #23,  1           // InterfaceMethod org/apache/http/StatusLine.getStatusCode:()I
      59: i2l
      60: invokestatic  #24                 // Method org/junit/Assert.assertEquals:(JJ)V
      63: aload_3
      64: ldc           #25                 // String ProcessedBy
      66: invokeinterface #26,  2           // InterfaceMethod org/apache/http/HttpResponse.getHeaders:(Ljava/lang/String;)[Lorg/apache/http/Header;
      71: astore        4
      73: ldc           #27                 // String ProcessedBy Headers
      75: lconst_1
      76: aload         4
      78: arraylength
      79: i2l
      80: invokestatic  #28                 // Method org/junit/Assert.assertEquals:(Ljava/lang/String;JJ)V
      83: ldc           #29                 // String ResponseHandler
      85: aload         4
      87: iconst_0
      88: aaload
      89: invokeinterface #30,  1           // InterfaceMethod org/apache/http/Header.getValue:()Ljava/lang/String;
      94: invokestatic  #31                 // Method org/junit/Assert.assertEquals:(Ljava/lang/Object;Ljava/lang/Object;)V
      97: aload_3
      98: ldc           #32                 // String AuthenticatedUser
     100: invokeinterface #26,  2           // InterfaceMethod org/apache/http/HttpResponse.getHeaders:(Ljava/lang/String;)[Lorg/apache/http/Header;
     105: astore        4
     107: ldc           #33                 // String AuthenticatedUser Headers
     109: lconst_1
     110: aload         4
     112: arraylength
     113: i2l
     114: invokestatic  #28                 // Method org/junit/Assert.assertEquals:(Ljava/lang/String;JJ)V
     117: ldc           #34                 // String CN=Test Client,OU=OU,O=Org,L=City,ST=State,C=GB
     119: aload         4
     121: iconst_0
     122: aaload
     123: invokeinterface #30,  1           // InterfaceMethod org/apache/http/Header.getValue:()Ljava/lang/String;
     128: invokestatic  #31                 // Method org/junit/Assert.assertEquals:(Ljava/lang/Object;Ljava/lang/Object;)V
     131: aload_3
     132: invokestatic  #35                 // Method io/undertow/testutils/HttpClientUtils.readResponse:(Lorg/apache/http/HttpResponse;)Ljava/lang/String;
     135: pop
     136: getstatic     #36                 // Field io/undertow/security/api/SecurityNotification$EventType.AUTHENTICATED:Lio/undertow/security/api/SecurityNotification$EventType;
     139: invokestatic  #37                 // Method assertSingleNotificationType:(Lio/undertow/security/api/SecurityNotification$EventType;)V
     142: aload_1
     143: invokevirtual #44                 // Method io/undertow/testutils/TestHttpClient.getConnectionManager:()Lorg/apache/http/conn/ClientConnectionManager;
     146: invokeinterface #45,  1           // InterfaceMethod org/apache/http/conn/ClientConnectionManager.shutdown:()V
     151: goto          168
     154: astore        5
     156: aload_1
     157: invokevirtual #44                 // Method io/undertow/testutils/TestHttpClient.getConnectionManager:()Lorg/apache/http/conn/ClientConnectionManager;
     160: invokeinterface #45,  1           // InterfaceMethod org/apache/http/conn/ClientConnectionManager.shutdown:()V
     165: aload         5
     167: athrow
     168: return
    Exception table:
       from    to  target type
           8   142   154   any
         154   156   154   any

  public void testClientCertSuccessWithLargePostBody() throws java.lang.Exception;
    Code:
       0: invokestatic  #46                 // Method io/undertow/testutils/DefaultServer.getBufferPool:()Lio/undertow/connector/ByteBufferPool;
       3: invokeinterface #47,  1           // InterfaceMethod io/undertow/connector/ByteBufferPool.allocate:()Lio/undertow/connector/PooledByteBuffer;
       8: astore_1
       9: aload_1
      10: invokeinterface #48,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.getBuffer:()Ljava/nio/ByteBuffer;
      15: invokevirtual #49                 // Method java/nio/ByteBuffer.limit:()I
      18: iconst_1
      19: isub
      20: istore_2
      21: aload_1
      22: invokeinterface #50,  1           // InterfaceMethod io/undertow/connector/PooledByteBuffer.close:()V
      27: new           #51                 // class java/lang/StringBuilder
      30: dup
      31: iload_2
      32: invokespecial #52                 // Method java/lang/StringBuilder."<init>":(I)V
      35: astore_3
      36: iconst_0
      37: istore        4
      39: iload         4
      41: iload_2
      42: if_icmpge     58
      45: aload_3
      46: ldc           #53                 // String *
      48: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      51: pop
      52: iinc          4, 1
      55: goto          39
      58: new           #12                 // class io/undertow/testutils/TestHttpClient
      61: dup
      62: invokespecial #13                 // Method io/undertow/testutils/TestHttpClient."<init>":()V
      65: astore        4
      67: aload         4
      69: getstatic     #10                 // Field clientSSLContext:Ljavax/net/ssl/SSLContext;
      72: invokevirtual #14                 // Method io/undertow/testutils/TestHttpClient.setSSLContext:(Ljavax/net/ssl/SSLContext;)V
      75: new           #38                 // class org/apache/http/client/methods/HttpPost
      78: dup
      79: invokestatic  #16                 // Method io/undertow/testutils/DefaultServer.getDefaultServerSSLAddress:()Ljava/lang/String;
      82: invokespecial #39                 // Method org/apache/http/client/methods/HttpPost."<init>":(Ljava/lang/String;)V
      85: astore        5
      87: aload         5
      89: new           #40                 // class org/apache/http/entity/StringEntity
      92: dup
      93: aload_3
      94: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      97: invokespecial #42                 // Method org/apache/http/entity/StringEntity."<init>":(Ljava/lang/String;)V
     100: invokevirtual #43                 // Method org/apache/http/client/methods/HttpPost.setEntity:(Lorg/apache/http/HttpEntity;)V
     103: aload         4
     105: aload         5
     107: invokevirtual #18                 // Method io/undertow/testutils/TestHttpClient.execute:(Lorg/apache/http/client/methods/HttpUriRequest;)Lorg/apache/http/HttpResponse;
     110: astore        6
     112: ldc2_w        #20                 // long 200l
     115: aload         6
     117: invokeinterface #22,  1           // InterfaceMethod org/apache/http/HttpResponse.getStatusLine:()Lorg/apache/http/StatusLine;
     122: invokeinterface #23,  1           // InterfaceMethod org/apache/http/StatusLine.getStatusCode:()I
     127: i2l
     128: invokestatic  #24                 // Method org/junit/Assert.assertEquals:(JJ)V
     131: aload         6
     133: ldc           #25                 // String ProcessedBy
     135: invokeinterface #26,  2           // InterfaceMethod org/apache/http/HttpResponse.getHeaders:(Ljava/lang/String;)[Lorg/apache/http/Header;
     140: astore        7
     142: ldc           #27                 // String ProcessedBy Headers
     144: lconst_1
     145: aload         7
     147: arraylength
     148: i2l
     149: invokestatic  #28                 // Method org/junit/Assert.assertEquals:(Ljava/lang/String;JJ)V
     152: ldc           #29                 // String ResponseHandler
     154: aload         7
     156: iconst_0
     157: aaload
     158: invokeinterface #30,  1           // InterfaceMethod org/apache/http/Header.getValue:()Ljava/lang/String;
     163: invokestatic  #31                 // Method org/junit/Assert.assertEquals:(Ljava/lang/Object;Ljava/lang/Object;)V
     166: aload         6
     168: ldc           #32                 // String AuthenticatedUser
     170: invokeinterface #26,  2           // InterfaceMethod org/apache/http/HttpResponse.getHeaders:(Ljava/lang/String;)[Lorg/apache/http/Header;
     175: astore        7
     177: ldc           #33                 // String AuthenticatedUser Headers
     179: lconst_1
     180: aload         7
     182: arraylength
     183: i2l
     184: invokestatic  #28                 // Method org/junit/Assert.assertEquals:(Ljava/lang/String;JJ)V
     187: ldc           #34                 // String CN=Test Client,OU=OU,O=Org,L=City,ST=State,C=GB
     189: aload         7
     191: iconst_0
     192: aaload
     193: invokeinterface #30,  1           // InterfaceMethod org/apache/http/Header.getValue:()Ljava/lang/String;
     198: invokestatic  #31                 // Method org/junit/Assert.assertEquals:(Ljava/lang/Object;Ljava/lang/Object;)V
     201: aload         6
     203: invokestatic  #35                 // Method io/undertow/testutils/HttpClientUtils.readResponse:(Lorg/apache/http/HttpResponse;)Ljava/lang/String;
     206: pop
     207: getstatic     #36                 // Field io/undertow/security/api/SecurityNotification$EventType.AUTHENTICATED:Lio/undertow/security/api/SecurityNotification$EventType;
     210: invokestatic  #37                 // Method assertSingleNotificationType:(Lio/undertow/security/api/SecurityNotification$EventType;)V
     213: return
}
