^1375347079385
@xworker.dataObject.swt.ImportAttributeDialog
sname
ImportAttributeDialog
slabel
ImportAttributeDialog
sid
ImportAttributeDialog
sdescriptors
xworker.swt.widgets.Display
@xworker.dataObject.swt.ImportAttributeDialog/@shell
sname
shell
stext
导入属性
sNO_TRIM
false
sCLOSE
true
sTITLE
true
sMIN
true
sMAX
true
sBORDER
false
sRESIZE
true
sON_TOP
false
sTOOL
false
sNO_FOCUS
false
swidth
680
sheight
500
scenterScreen
true
spack
false
smaximized
false
sfullScreen
false
sH_SCROLL
false
sV_SCROLL
false
sNO_BACKGROUND
false
sNO_MERGE_PAINTS
false
sNO_REDRAW_RESIZE
false
sNO_RADIO_GROUP
false
sEMBEDDED
false
sDOUBLE_BUFFERED
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sid
shell
sdescriptors
xworker.swt.widgets.Display/@Shell
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@shellGridLayout
sname
shellGridLayout
smakeColumnsEqualWidth
false
smarginWidth
5
smarginHeight
5
smarginLeft
0
smarginTop
0
smarginRight
0
smarginBottom
0
shorizontalSpacing
5
sverticalSpacing
5
sid
shellGridLayout
slabel
shellGridLayout
sdescriptors
xworker.swt.Layouts/@GridLayout
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@selectLabel
sname
selectLabel
stext
请选择一个数据对象：
stype
HORIZONTAL
sshadow
SHADOW_OUT
sBORDER
false
salignment
LEFT
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sid
selectLabel
slabel
selectLabel
sdescriptors
xworker.swt.Widgets/@Label
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@form
sname
form
sformType
edit
sid
form
sdescriptors
xworker.app.view.swt.Items/@DataObjectForm
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@form/@dataObjects
sname
dataObjects
sid
dataObjects
slabel
dataObjects
sdescriptors
xworker.app.view.swt.widgets.form.DataObjectForm/@DataObjects
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@form/@dataObjects/@AbstractDataObject
sname
AbstractDataObject
seditCols
2
spaging
false
sreadUrl
do?sc=xworker.app.view.extjs.server.DataObjectStore/@read
screateUrl
do?sc=xworker.app.view.extjs.server.DataObjectStore/@create
supdateUrl
do?sc=xworker.app.view.extjs.server.DataObjectStore/@update
sdestroyUrl
do?sc=xworker.app.view.extjs.server.DataObjectStore/@destroy
LstoreAutoDestroy
false
sstoreAutoLoad
false
LstoreAutoSave
true
LstoreBatch
true
LstorePruneModifiedRecords
false
LstoreRemoteSort
false
LstoreRestful
false
sstoreRoot
'rows'
sstoreSuccessProperty
'success'
sstoreTotalProperty
'totalCount'
sstoreMessageProperty
'msg'
sgridEditable
false
sformReadUrl
do?sc=xworker.app.view.extjs.server.DataObjectForm/@read
sformCreateUrl
do?sc=xworker.app.view.extjs.server.DataObjectForm/@create
sformUpdateUrl
do?sc=xworker.app.view.extjs.server.DataObjectForm/@update
sformDestroyUrl
do?sc=xworker.app.view.extjs.server.DataObjectForm/@delete
spaging_afterPageText
页 共
spaging_beforePageText
第
Lpaging_displayInfo
false
spaging_displayMsg
第{0}-第{1}条，共{2}条
spaging_emptyMsg
没有数据
spaging_firstText
首页
spaging_lastText
最后一页
spaging_nextText
下一页
Lpaging_prependButtons
false
spaging_prevText
上一页
spaging_refreshText
刷新
sgridColumnLocking
false
sgridLockText
'锁定'
sgridUnlockText
'解锁'
scolumnGroup
false
sgridCheckable
false
sgridRowNumber
false
sgridGrouping
false
sgridGroupTextTpl
'{text} ({[values.rs.length]} 条)'
sgridRowExpander
false
sautoGenerateId
false
sidGenerateType
action
sidAction
generateId
sstoreSortDir
ASC
sautoInit
false
sautoInitAction
autoInit
sid
AbstractDataObject
sdescriptors
xworker.dataObject.DataObjects/@AbstractDataObject
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@form/@dataObjects/@AbstractDataObject/@dataObjectPath
sname
dataObjectPath
slabel
数据对象路径
stype
string
soptional
true
skey
false
sdataField
true
sviewField
true
sreadField
true
screateEditor
true
seditEditor
true
sviewEditor
true
sgridEditor
true
squeryEditor
true
sinputtype
openWindow
ssize
60
sreadOnly
false
seditable
true
scolspan
2
sshowLabel
true
slabelAlign
right
slabelVAlign
baseline
svalidateAllowBlank
true
LvalidateOnBlur
true
LallowDecimals
true
LallowNegative
true
sinputattrs
xworker.swt.xworker.attributeEditor.openWins.SelectThingOpenWindow/@shell|descriptor=xworker.dataObject.DataObject,returnType=path
sshowInTable
true
sgridFixed
false
sgridHidden
false
sgridHideable
true
sgridSortable
false
scolumnLocked
false
sgridGroupable
true
sgridMenuDisabled
false
sgridResizable
true
sid
dataObjectPath
sdescriptors
xworker.dataObject.AbstractDataObject/@attribute
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@form/@dataObjects/@AbstractDataObject/@dataObjectPath/@SwtObject
sname
SwtObject
sid
SwtObject
slabel
SwtObject
sdescriptors
xworker.dataObject.AttributeEditConfig/@SwtObject
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@form/@dataObjects/@AbstractDataObject/@dataObjectPath/@SwtObject/@inputExtend
sname
inputExtend
sid
inputExtend
slabel
inputExtend
sdescriptors
xworker.dataObject.AttributeEditConfig/@SwtObject/@inputExtend
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@form/@dataObjects/@AbstractDataObject/@dataObjectPath/@SwtObject/@inputExtend/@listeners
sname
listeners
sid
listeners
slabel
listeners
sdescriptors
xworker.swt.events.Listeners/@listeners
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@form/@dataObjects/@AbstractDataObject/@dataObjectPath/@SwtObject/@inputExtend/@listeners/@modifyListener
sname
modifyListener
stype
Modify
sid
modifyListener
slabel
modifyListener
sdescriptors
xworker.swt.events.Listeners/@listeners/@Listener
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@form/@dataObjects/@AbstractDataObject/@dataObjectPath/@SwtObject/@inputExtend/@listeners/@modifyListener/@thingModified
sname
thingModified
sisSynchronized
false
sthrowException
true
suseOtherAction
false
svarScope
Local
sdisableGlobalContext
false
Scode
#$@text#$@
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TableItem;

def dataObject = world.getThing(event.widget.getText());
if(dataObject != null){
    for(item in parentContext.dataTable.getItems()){
        item.dispose();
    }
    
    for(child in dataObject.getChilds()){
        TableItem item = new TableItem(parentContext.dataTable, SWT.NONE);
        item.setText([child.thingName, child.metadata.name, child.metadata.label, child.metadata.path] as String[]);
        item.setData(child);
    }
}
#$@text#$@
sid
thingModified
sdescriptors
xworker.lang.actions.Actions/@GroovyAction
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@form/@formGridData
sname
formGridData
sstyle
FILL_HORIZONTAL
shorizontalIndent
0
swidth
-1
sheight
-1
shorizontalAlignment
BEGINNING
sverticalAlignment
CENTER
shorizontalSpan
1
sverticalSpan
1
sgrabExcessHorizontalSpace
false
sgrabExcessVerticalSpace
false
sxw_cl_global
false
sid
formGridData
slabel
formGridData
sdescriptors
xworker.swt.layout.LayoutDatas/@GridData
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@dataTable
sname
dataTable
sselectStyle
SINGLE
sV_SCROLL
true
sH_SCROLL
true
sCHECK
true
sFULL_SELECTION
true
sHIDE_SELECTION
true
sBORDER
true
slineVisible
true
smultipleColumns
true
sheaderVisible
true
ssortIndicator
true
smoveableColumns
true
sheadImages
false
ssubImages
false
sVIRTUAL
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sid
dataTable
slabel
dataTable
sdescriptors
xworker.swt.Widgets/@Table
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@dataTable/@store
sname
store
sattachToParent
true
sloadBackground
true
sautoLoad
false
sautoSave
false
spaging
extend
spageSize
50
sstoreSortField
_extend
sstoreSortDir
ASC
seditable
extend
seditmethod
extend
sid
store
slabel
store
sdescriptors
xworker.swt.widgets.Table/@DataStore
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@dataTable/@store/@dataObjects
sname
dataObjects
sid
dataObjects
slabel
dataObjects
sdescriptors
xworker.app.view.swt.data.DataStore/@DataObjects
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@dataTable/@store/@dataObjects/@AbstractDataObject
sname
AbstractDataObject
seditCols
2
spaging
false
sreadUrl
do?sc=xworker.app.view.extjs.server.DataObjectStore/@read
screateUrl
do?sc=xworker.app.view.extjs.server.DataObjectStore/@create
supdateUrl
do?sc=xworker.app.view.extjs.server.DataObjectStore/@update
sdestroyUrl
do?sc=xworker.app.view.extjs.server.DataObjectStore/@destroy
LstoreAutoDestroy
false
sstoreAutoLoad
false
LstoreAutoSave
true
LstoreBatch
true
LstorePruneModifiedRecords
false
LstoreRemoteSort
false
LstoreRestful
false
sstoreRoot
'rows'
sstoreSuccessProperty
'success'
sstoreTotalProperty
'totalCount'
sstoreMessageProperty
'msg'
sgridEditable
false
sformReadUrl
do?sc=xworker.app.view.extjs.server.DataObjectForm/@read
sformCreateUrl
do?sc=xworker.app.view.extjs.server.DataObjectForm/@create
sformUpdateUrl
do?sc=xworker.app.view.extjs.server.DataObjectForm/@update
sformDestroyUrl
do?sc=xworker.app.view.extjs.server.DataObjectForm/@delete
spaging_afterPageText
页 共
spaging_beforePageText
第
Lpaging_displayInfo
false
spaging_displayMsg
第{0}-第{1}条，共{2}条
spaging_emptyMsg
没有数据
spaging_firstText
首页
spaging_lastText
最后一页
spaging_nextText
下一页
Lpaging_prependButtons
false
spaging_prevText
上一页
spaging_refreshText
刷新
sgridColumnLocking
false
sgridLockText
'锁定'
sgridUnlockText
'解锁'
scolumnGroup
false
sgridCheckable
false
sgridRowNumber
false
sgridGrouping
false
sgridGroupTextTpl
'{text} ({[values.rs.length]} 条)'
sgridRowExpander
false
sautoGenerateId
false
sidGenerateType
action
sidAction
generateId
sstoreSortDir
ASC
sautoInit
false
sautoInitAction
autoInit
sid
AbstractDataObject
sdescriptors
xworker.dataObject.DataObjects/@AbstractDataObject
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@dataTable/@store/@dataObjects/@AbstractDataObject/@type
sname
type
slabel
类型
stype
string
soptional
true
skey
false
sdataField
true
sviewField
true
sreadField
true
screateEditor
true
seditEditor
true
sviewEditor
true
sgridEditor
true
squeryEditor
true
sreadOnly
false
seditable
true
sshowLabel
true
slabelAlign
right
slabelVAlign
baseline
svalidateAllowBlank
true
LvalidateOnBlur
true
LallowDecimals
true
LallowNegative
true
sshowInTable
true
sgridFixed
false
sgridHidden
false
sgridHideable
true
sgridSortable
false
scolumnLocked
false
sgridGroupable
true
sgridMenuDisabled
false
sgridResizable
true
sid
type
sdescriptors
xworker.dataObject.AbstractDataObject/@attribute
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@dataTable/@store/@dataObjects/@AbstractDataObject/@name
sname
name
slabel
名称
stype
string
soptional
true
skey
false
sdataField
true
sviewField
true
sreadField
true
screateEditor
true
seditEditor
true
sviewEditor
true
sgridEditor
true
squeryEditor
true
sreadOnly
false
seditable
true
sshowLabel
true
slabelAlign
right
slabelVAlign
baseline
svalidateAllowBlank
true
LvalidateOnBlur
true
LallowDecimals
true
LallowNegative
true
sshowInTable
true
sgridWidth
120
sgridFixed
false
sgridHidden
false
sgridHideable
true
sgridSortable
false
scolumnLocked
false
sgridGroupable
true
sgridMenuDisabled
false
sgridResizable
true
sid
name
sdescriptors
xworker.dataObject.AbstractDataObject/@attribute
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@dataTable/@store/@dataObjects/@AbstractDataObject/@label
sname
label
slabel
标签
stype
string
soptional
true
skey
false
sdataField
true
sviewField
true
sreadField
true
screateEditor
true
seditEditor
true
sviewEditor
true
sgridEditor
true
squeryEditor
true
sreadOnly
false
seditable
true
sshowLabel
true
slabelAlign
right
slabelVAlign
baseline
svalidateAllowBlank
true
LvalidateOnBlur
true
LallowDecimals
true
LallowNegative
true
sshowInTable
true
sgridWidth
120
sgridFixed
false
sgridHidden
false
sgridHideable
true
sgridSortable
false
scolumnLocked
false
sgridGroupable
true
sgridMenuDisabled
false
sgridResizable
true
sid
label
sdescriptors
xworker.dataObject.AbstractDataObject/@attribute
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@dataTable/@store/@dataObjects/@AbstractDataObject/@path
sname
path
slabel
路径
stype
string
soptional
true
skey
false
sdataField
true
sviewField
true
sreadField
true
screateEditor
true
seditEditor
true
sviewEditor
true
sgridEditor
true
squeryEditor
true
sreadOnly
false
seditable
true
sshowLabel
true
slabelAlign
right
slabelVAlign
baseline
svalidateAllowBlank
true
LvalidateOnBlur
true
LallowDecimals
true
LallowNegative
true
sshowInTable
true
sgridWidth
400
sgridFixed
false
sgridHidden
false
sgridHideable
true
sgridSortable
false
scolumnLocked
false
sgridGroupable
true
sgridMenuDisabled
false
sgridResizable
true
sid
path
sdescriptors
xworker.dataObject.AbstractDataObject/@attribute
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@dataTable/@dataTableGridData
sname
dataTableGridData
sstyle
FILL_BOTH
shorizontalIndent
0
swidth
-1
sheight
-1
shorizontalAlignment
BEGINNING
sverticalAlignment
CENTER
shorizontalSpan
1
sverticalSpan
1
sgrabExcessHorizontalSpace
false
sgrabExcessVerticalSpace
false
sxw_cl_global
false
sid
dataTableGridData
slabel
dataTableGridData
sdescriptors
xworker.swt.layout.LayoutDatas/@GridData
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252
sname
buttonComposite
sBORDER
false
sH_SCROLL
false
sV_SCROLL
false
sNO_BACKGROUND
false
sNO_FOCUS
false
sNO_MERGE_PAINTS
false
sNO_REDRAW_RESIZE
false
sNO_RADIO_GROUP
false
sEMBEDDED
false
sDOUBLE_BUFFERED
false
scapture
false
senabled
true
sredraw
true
svisible
true
sid
3252
sdescriptors
xworker.swt.Widgets/@Composite
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3253
sname
buttonCompositeGridData
sstyle
FILL_HORIZONTAL
shorizontalIndent
0
swidth
-1
sheight
-1
shorizontalAlignment
END
sverticalAlignment
CENTER
shorizontalSpan
1
sverticalSpan
1
sgrabExcessHorizontalSpace
false
sgrabExcessVerticalSpace
false
sid
3253
slabel
buttonCompositeGridData
sdescriptors
xworker.swt.layout.LayoutDatas/@GridData
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3254
sname
buttonCompositeRowLayout
sfill
false
sjustify
false
smarginWidth
0
smarginHeight
0
smarginLeft
3
smarginTop
3
smarginRight
3
smarginBottom
3
spack
true
sspacing
3
stype
SWT.HORIZONTAL
swrap
true
sid
3254
slabel
buttonCompositeRowLayout
sdescriptors
xworker.swt.Layouts/@RowLayout
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3255
sname
importButton
stext
导入
stype
SWT.PUSH
sflat
false
sborder
false
sselected
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sid
3255
slabel
importButton
sdescriptors
xworker.swt.Widgets/@Button
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3255/@3256
sname
RowData
sexclude
false
swidth
80
sheight
-1
sid
3256
slabel
RowData
sdescriptors
xworker.swt.layout.LayoutDatas/@RowData
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3255/@3257
sname
Listeners
sid
3257
slabel
Listeners
sdescriptors
xworker.swt.widgets.Widget/@Listeners
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3255/@3257/@3258
sname
importButtonSelection
stype
Selection
sid
3258
slabel
importButtonSelection
sdescriptors
xworker.swt.events.Listeners/@listeners/@Listener
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3255/@3257/@3258/@GroovyAction
sname
GroovyAction
sisSynchronized
false
sthrowException
true
suseOtherAction
false
svarScope
Local
sdisableGlobalContext
false
Scode
#$@text#$@
import org.xmeta.Thing;

import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;

def attributeDesc = thing.getDescriptor().doAction("getAttributeDescriptor", actionContext);

for(item in dataTable.getItems()){ 
    if(item.getChecked()){
        def itemThing = item.getData().detach();
        thing.addChild(itemThing);
        def treeItem = thingContext.get("innerOutline").getSelection()[0];
        def childTreeItem = new TreeItem(treeItem, SWT.NONE);
        childTreeItem.setText(itemThing.metadata.label + " (" + itemThing.thingName + ")");
        childTreeItem.setData(itemThing);
    }
}

def box = new MessageBox(shell, SWT.ICON_INFORMATION | SWT.OK);
box.setText("提示");
box.setMessage("导入成功");
box.open();
#$@text#$@
sinitBreakPoint
false
ssuccessBreakPoint
false
sexceptionBreakPoint
false
seditBreakPoint
false
sinterpretationType
Action
screateLocalVarScope
false
ssaveReturn
false
sid
GroovyAction
sdescriptors
xworker.lang.actions.Actions/@GroovyAction
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@6379
sname
importGroupBtn
stext
导入分组属性
stype
SWT.PUSH
sflat
false
sborder
false
sselected
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sid
6379
slabel
importGroupBtn
sdescriptors
xworker.swt.Widgets/@Button
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@6379/@6380
sname
RowData
sexclude
false
swidth
80
sheight
-1
sid
6380
slabel
RowData
sdescriptors
xworker.swt.layout.LayoutDatas/@RowData
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@6379/@6381
sname
Listeners
sid
6381
slabel
Listeners
sdescriptors
xworker.swt.widgets.Widget/@Listeners
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@6379/@6381/@6382
sname
importGroupBtnSelection
stype
Selection
sid
6382
slabel
importGroupBtnSelection
sdescriptors
xworker.swt.events.Listeners/@listeners/@Listener
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@6379/@6381/@6382/@GroovyAction
sname
GroovyAction
sisSynchronized
false
sthrowException
true
suseOtherAction
false
svarScope
Local
sdisableGlobalContext
false
Scode
#$@text#$@
import org.xmeta.Thing;

import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;

//选择的数据对象
def formValues = form.doAction("getValues", actionContext);
def dataObject = world.getThing(formValues.get("dataObjectPath"));
if(dataObject == null){
    def box = new MessageBox(shell, SWT.ICON_WARNING | SWT.OK);
    box.setText("提示");
    box.setMessage("请先选择一个正确的数据对象。");
    box.open();
    return;
}

def attributeDesc = thing.getDescriptor().doAction("getAttributeDescriptor", actionContext);

//分组属性
def groupAttr = null;
for(child in thing.getChilds()){
    if(child.thingName == "attribute" && child.name == "groupColumns"){
        groupAttr = child;
        break;
    }
}
if(groupAttr == null){
    groupAttr = new Thing(attributeDesc);
    groupAttr.set("name", "groupColumns");
    groupAttr.set("label", "分组");
    groupAttr.set("inputtype", "select");
    thing.addChild(groupAttr);
    
    def treeItem = thingContext.get("innerOutline").getSelection()[0];
    def childTreeItem = new TreeItem(treeItem, SWT.NONE);
    childTreeItem.setText(groupAttr.metadata.label + " (" + groupAttr.thingName + ")");
    childTreeItem.setData(groupAttr);
}

//分组属性的可选值
for(objChild in dataObject.getChilds()){ 
    if(objChild.thingName == "group"){
        def groupName = objChild.name;
        boolean have = false;
        for(child in groupAttr.get("value@")){
            if(child.name == groupName){
                have = true;
                break;
            }
        }
        if(!have){
             def groupValue = new Thing(attributeDesc + "/@value");
             groupValue.name = groupName;
             groupValue.value = groupName;
             groupValue.label = objChild.label;
             groupAttr.addChild(groupValue);
             
             def treeItem = thingContext.get("innerOutline").getSelection()[0];
             for(item in treeItem.getItems()){
                 if(item.getData().thingName == "attribute" && item.getData().name == "groupColumns"){
                     treeItem = item;
                     break;
                 }
             }
             if(treeItem != null){
                 def childTreeItem = new TreeItem(treeItem, SWT.NONE);
                 childTreeItem.setText(groupValue.metadata.label + " (" + groupValue.thingName + ")");
                 childTreeItem.setData(groupValue);
             }
        }
    }
}

def box = new MessageBox(shell, SWT.ICON_INFORMATION | SWT.OK);
box.setText("提示");
box.setMessage("导入成功");
box.open();
#$@text#$@
sinitBreakPoint
false
ssuccessBreakPoint
false
sexceptionBreakPoint
false
seditBreakPoint
false
sinterpretationType
Action
screateLocalVarScope
false
ssaveReturn
false
sid
GroovyAction
sdescriptors
xworker.lang.actions.Actions/@GroovyAction
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@6383
sname
importAggrateBtn
stext
导入聚合属性
stype
SWT.PUSH
sflat
false
sborder
false
sselected
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sid
6383
slabel
importAggrateBtn
sdescriptors
xworker.swt.Widgets/@Button
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@6383/@6384
sname
RowData
sexclude
false
swidth
80
sheight
-1
sid
6384
slabel
RowData
sdescriptors
xworker.swt.layout.LayoutDatas/@RowData
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@6383/@6385
sname
Listeners
sid
6385
slabel
Listeners
sdescriptors
xworker.swt.widgets.Widget/@Listeners
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@6383/@6385/@6386
sname
importAggrateBtnSelection
stype
Selection
sid
6386
slabel
importAggrateBtnSelection
sdescriptors
xworker.swt.events.Listeners/@listeners/@Listener
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@6383/@6385/@6386/@GroovyAction
sname
GroovyAction
sisSynchronized
false
sthrowException
true
suseOtherAction
false
svarScope
Local
sdisableGlobalContext
false
Scode
#$@text#$@
import org.xmeta.Thing;

import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.TreeItem;
import org.eclipse.swt.widgets.MessageBox;

//选择的数据对象
def formValues = form.doAction("getValues", actionContext);
def dataObject = world.getThing(formValues.get("dataObjectPath"));
if(dataObject == null){
    def box = new MessageBox(shell, SWT.ICON_WARNING | SWT.OK);
    box.setText("提示");
    box.setMessage("请先选择一个正确的数据对象。");
    box.open();
    return;
}

def attributeDesc = thing.getDescriptor().doAction("getAttributeDescriptor", actionContext);

//分组属性
def groupAttr = null;
for(child in thing.getChilds()){
    if(child.thingName == "attribute" && child.name == "aggregateColumns"){
        groupAttr = child;
        break;
    }
}
if(groupAttr == null){
    groupAttr = new Thing(attributeDesc);
    groupAttr.set("name", "aggregateColumns");
    groupAttr.set("label", "统计");
    groupAttr.set("inputtype", "select");
    thing.addChild(groupAttr);
    
    def treeItem = thingContext.get("innerOutline").getSelection()[0];
    def childTreeItem = new TreeItem(treeItem, SWT.NONE);
    childTreeItem.setText(groupAttr.metadata.label + " (" + groupAttr.thingName + ")");
    childTreeItem.setData(groupAttr);
}

//分组属性的可选值
for(objChild in dataObject.getChilds()){ 
    if(objChild.thingName == "aggregate"){
        def groupName = objChild.name;
        boolean have = false;
        for(child in groupAttr.get("value@")){
            if(child.name == groupName){
                have = true;
                break;
            }
        }
        if(!have){
             def groupValue = new Thing(attributeDesc + "/@value");
             groupValue.name = groupName;
             groupValue.value = groupName;
             groupValue.label = objChild.label;
             groupAttr.addChild(groupValue);
             
             def treeItem = thingContext.get("innerOutline").getSelection()[0];
             for(item in treeItem.getItems()){
                 if(item.getData().thingName == "attribute" && item.getData().name == "aggregateColumns"){
                     treeItem = item;
                     break;
                 }
             }
             if(treeItem != null){
                 def childTreeItem = new TreeItem(treeItem, SWT.NONE);
                 childTreeItem.setText(groupValue.metadata.label + " (" + groupValue.thingName + ")");
                 childTreeItem.setData(groupValue);
             }
        }
    }
}

def box = new MessageBox(shell, SWT.ICON_INFORMATION | SWT.OK);
box.setText("提示");
box.setMessage("导入成功");
box.open();
#$@text#$@
sinitBreakPoint
false
ssuccessBreakPoint
false
sexceptionBreakPoint
false
seditBreakPoint
false
sinterpretationType
Action
screateLocalVarScope
false
ssaveReturn
false
sid
GroovyAction
sdescriptors
xworker.lang.actions.Actions/@GroovyAction
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3259
sname
closeButton
stext
关闭
stype
SWT.PUSH
sflat
false
sborder
false
sselected
false
scapture
false
senabled
true
sredraw
true
svisible
true
sxw_cl_global
false
sid
3259
slabel
closeButton
sdescriptors
xworker.swt.Widgets/@Button
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3259/@3260
sname
RowData
sexclude
false
swidth
80
sheight
-1
sid
3260
slabel
RowData
sdescriptors
xworker.swt.layout.LayoutDatas/@RowData
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3259/@3261
sname
Listeners
sid
3261
slabel
Listeners
sdescriptors
xworker.swt.widgets.Widget/@Listeners
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3259/@3261/@3262
sname
closeButtonSelection
stype
Selection
sid
3262
slabel
closeButtonSelection
sdescriptors
xworker.swt.events.Listeners/@listeners/@Listener
@xworker.dataObject.swt.ImportAttributeDialog/@shell/@3252/@3259/@3261/@3262/@shellDispose
sname
shellDispose
sshellName
shell
smethod
dispose
sinitBreakPoint
false
ssuccessBreakPoint
false
sexceptionBreakPoint
false
seditBreakPoint
false
sinterpretationType
Self
svarScope
Local
sid
shellDispose
sdescriptors
xworker.swt.actions.ShellActions/@ShellNormalActions1
