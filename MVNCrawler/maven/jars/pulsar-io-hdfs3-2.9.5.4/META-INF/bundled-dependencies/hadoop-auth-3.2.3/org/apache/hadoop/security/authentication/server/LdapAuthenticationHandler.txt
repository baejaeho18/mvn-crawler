Compiled from "LdapAuthenticationHandler.java"
public class org.apache.hadoop.security.authentication.server.LdapAuthenticationHandler implements org.apache.hadoop.security.authentication.server.AuthenticationHandler {
  private static org.slf4j.Logger logger;

  public static final java.lang.String TYPE;

  public static final java.lang.String SECURITY_AUTHENTICATION;

  public static final java.lang.String PROVIDER_URL;

  public static final java.lang.String BASE_DN;

  public static final java.lang.String LDAP_BIND_DOMAIN;

  public static final java.lang.String ENABLE_START_TLS;

  private java.lang.String ldapDomain;

  private java.lang.String baseDN;

  private java.lang.String providerUrl;

  private java.lang.Boolean enableStartTls;

  private java.lang.Boolean disableHostNameVerification;

  public org.apache.hadoop.security.authentication.server.LdapAuthenticationHandler();
    Code:
       0: aload_0
       1: invokespecial #2                  // Method java/lang/Object."<init>":()V
       4: return

  public void setEnableStartTls(java.lang.Boolean);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #3                  // Field enableStartTls:Ljava/lang/Boolean;
       5: return

  public void setDisableHostNameVerification(java.lang.Boolean);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #4                  // Field disableHostNameVerification:Ljava/lang/Boolean;
       5: return

  public java.lang.String getType();
    Code:
       0: ldc           #5                  // String ldap
       2: areturn

  public void init(java.util.Properties) throws javax.servlet.ServletException;
    Code:
       0: aload_0
       1: aload_1
       2: ldc           #6                  // String ldap.basedn
       4: invokevirtual #7                  // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       7: putfield      #8                  // Field baseDN:Ljava/lang/String;
      10: aload_0
      11: aload_1
      12: ldc           #9                  // String ldap.providerurl
      14: invokevirtual #7                  // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      17: putfield      #10                 // Field providerUrl:Ljava/lang/String;
      20: aload_0
      21: aload_1
      22: ldc           #11                 // String ldap.binddomain
      24: invokevirtual #7                  // Method java/util/Properties.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      27: putfield      #12                 // Field ldapDomain:Ljava/lang/String;
      30: aload_0
      31: aload_1
      32: ldc           #13                 // String ldap.enablestarttls
      34: ldc           #14                 // String false
      36: invokevirtual #15                 // Method java/util/Properties.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      39: invokestatic  #16                 // Method java/lang/Boolean.valueOf:(Ljava/lang/String;)Ljava/lang/Boolean;
      42: putfield      #3                  // Field enableStartTls:Ljava/lang/Boolean;
      45: aload_0
      46: getfield      #10                 // Field providerUrl:Ljava/lang/String;
      49: ldc           #17                 // String The LDAP URI can not be null
      51: invokestatic  #18                 // Method com/google/common/base/Preconditions.checkNotNull:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      54: pop
      55: aload_0
      56: getfield      #8                  // Field baseDN:Ljava/lang/String;
      59: ifnonnull     66
      62: iconst_1
      63: goto          67
      66: iconst_0
      67: aload_0
      68: getfield      #12                 // Field ldapDomain:Ljava/lang/String;
      71: ifnonnull     78
      74: iconst_1
      75: goto          79
      78: iconst_0
      79: ixor
      80: ldc           #19                 // String Either LDAP base DN or LDAP domain value needs to be specified
      82: invokestatic  #20                 // Method com/google/common/base/Preconditions.checkArgument:(ZLjava/lang/Object;)V
      85: aload_0
      86: getfield      #3                  // Field enableStartTls:Ljava/lang/Boolean;
      89: invokevirtual #21                 // Method java/lang/Boolean.booleanValue:()Z
      92: ifeq          122
      95: aload_0
      96: getfield      #10                 // Field providerUrl:Ljava/lang/String;
      99: invokevirtual #22                 // Method java/lang/String.toLowerCase:()Ljava/lang/String;
     102: astore_2
     103: aload_2
     104: ldc           #23                 // String ldaps
     106: invokevirtual #24                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     109: ifne          116
     112: iconst_1
     113: goto          117
     116: iconst_0
     117: ldc           #25                 // String Can not use ldaps and StartTLS option at the same time
     119: invokestatic  #20                 // Method com/google/common/base/Preconditions.checkArgument:(ZLjava/lang/Object;)V
     122: return

  public void destroy();
    Code:
       0: return

  public boolean managementOperation(org.apache.hadoop.security.authentication.server.AuthenticationToken, javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse) throws java.io.IOException, org.apache.hadoop.security.authentication.client.AuthenticationException;
    Code:
       0: iconst_1
       1: ireturn

  public org.apache.hadoop.security.authentication.server.AuthenticationToken authenticate(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse) throws java.io.IOException, org.apache.hadoop.security.authentication.client.AuthenticationException;
    Code:
       0: aconst_null
       1: astore_3
       2: aload_1
       3: ldc           #27                 // String Authorization
       5: invokeinterface #28,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getHeader:(Ljava/lang/String;)Ljava/lang/String;
      10: astore        4
      12: aload         4
      14: ifnull        27
      17: ldc           #29                 // String Basic
      19: aload         4
      21: invokestatic  #30                 // Method org/apache/hadoop/security/authentication/server/AuthenticationHandlerUtil.matchAuthScheme:(Ljava/lang/String;Ljava/lang/String;)Z
      24: ifne          79
      27: aload_2
      28: ldc           #32                 // String WWW-Authenticate
      30: ldc           #29                 // String Basic
      32: invokeinterface #33,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
      37: aload_2
      38: sipush        401
      41: invokeinterface #35,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setStatus:(I)V
      46: aload         4
      48: ifnonnull     64
      51: getstatic     #36                 // Field logger:Lorg/slf4j/Logger;
      54: ldc           #37                 // String Basic auth starting
      56: invokeinterface #38,  2           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;)V
      61: goto          158
      64: getstatic     #36                 // Field logger:Lorg/slf4j/Logger;
      67: ldc           #39                 // String \'Authorization\' does not start with \'Basic\' :  {}
      69: aload         4
      71: invokeinterface #40,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
      76: goto          158
      79: aload         4
      81: ldc           #29                 // String Basic
      83: invokevirtual #41                 // Method java/lang/String.length:()I
      86: invokevirtual #42                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      89: invokevirtual #43                 // Method java/lang/String.trim:()Ljava/lang/String;
      92: astore        4
      94: new           #44                 // class org/apache/commons/codec/binary/Base64
      97: dup
      98: iconst_0
      99: invokespecial #45                 // Method org/apache/commons/codec/binary/Base64."<init>":(I)V
     102: astore        5
     104: new           #46                 // class java/lang/String
     107: dup
     108: aload         5
     110: aload         4
     112: invokevirtual #47                 // Method org/apache/commons/codec/binary/Base64.decode:(Ljava/lang/String;)[B
     115: getstatic     #48                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     118: invokespecial #49                 // Method java/lang/String."<init>":([BLjava/nio/charset/Charset;)V
     121: ldc           #50                 // String :
     123: iconst_2
     124: invokevirtual #51                 // Method java/lang/String.split:(Ljava/lang/String;I)[Ljava/lang/String;
     127: astore        6
     129: aload         6
     131: arraylength
     132: iconst_2
     133: if_icmpne     158
     136: aload_0
     137: aload         6
     139: iconst_0
     140: aaload
     141: aload         6
     143: iconst_1
     144: aaload
     145: invokespecial #52                 // Method authenticateUser:(Ljava/lang/String;Ljava/lang/String;)Lorg/apache/hadoop/security/authentication/server/AuthenticationToken;
     148: astore_3
     149: aload_2
     150: sipush        200
     153: invokeinterface #35,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setStatus:(I)V
     158: aload_3
     159: areturn

  private org.apache.hadoop.security.authentication.server.AuthenticationToken authenticateUser(java.lang.String, java.lang.String) throws org.apache.hadoop.security.authentication.client.AuthenticationException;
    Code:
       0: aload_1
       1: ifnull        11
       4: aload_1
       5: invokevirtual #53                 // Method java/lang/String.isEmpty:()Z
       8: ifeq          21
      11: new           #54                 // class org/apache/hadoop/security/authentication/client/AuthenticationException
      14: dup
      15: ldc           #55                 // String Error validating LDAP user: a null or blank username has been provided
      17: invokespecial #56                 // Method org/apache/hadoop/security/authentication/client/AuthenticationException."<init>":(Ljava/lang/String;)V
      20: athrow
      21: aload_1
      22: invokestatic  #57                 // Method hasDomain:(Ljava/lang/String;)Z
      25: ifne          62
      28: aload_0
      29: getfield      #12                 // Field ldapDomain:Ljava/lang/String;
      32: ifnull        62
      35: new           #58                 // class java/lang/StringBuilder
      38: dup
      39: invokespecial #59                 // Method java/lang/StringBuilder."<init>":()V
      42: aload_1
      43: invokevirtual #60                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      46: ldc           #61                 // String @
      48: invokevirtual #60                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      51: aload_0
      52: getfield      #12                 // Field ldapDomain:Ljava/lang/String;
      55: invokevirtual #60                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      58: invokevirtual #62                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      61: astore_1
      62: aload_2
      63: ifnull        85
      66: aload_2
      67: invokevirtual #53                 // Method java/lang/String.isEmpty:()Z
      70: ifne          85
      73: aload_2
      74: getstatic     #48                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
      77: invokevirtual #63                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
      80: iconst_0
      81: baload
      82: ifne          95
      85: new           #54                 // class org/apache/hadoop/security/authentication/client/AuthenticationException
      88: dup
      89: ldc           #64                 // String Error validating LDAP user: a null or blank password has been provided
      91: invokespecial #56                 // Method org/apache/hadoop/security/authentication/client/AuthenticationException."<init>":(Ljava/lang/String;)V
      94: athrow
      95: aload_0
      96: getfield      #8                  // Field baseDN:Ljava/lang/String;
      99: ifnonnull     107
     102: aload_1
     103: astore_3
     104: goto          139
     107: new           #58                 // class java/lang/StringBuilder
     110: dup
     111: invokespecial #59                 // Method java/lang/StringBuilder."<init>":()V
     114: ldc           #65                 // String uid=
     116: invokevirtual #60                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     119: aload_1
     120: invokevirtual #60                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     123: ldc           #66                 // String ,
     125: invokevirtual #60                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     128: aload_0
     129: getfield      #8                  // Field baseDN:Ljava/lang/String;
     132: invokevirtual #60                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     135: invokevirtual #62                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     138: astore_3
     139: aload_0
     140: getfield      #3                  // Field enableStartTls:Ljava/lang/Boolean;
     143: invokevirtual #21                 // Method java/lang/Boolean.booleanValue:()Z
     146: ifeq          158
     149: aload_0
     150: aload_3
     151: aload_2
     152: invokespecial #67                 // Method authenticateWithTlsExtension:(Ljava/lang/String;Ljava/lang/String;)V
     155: goto          164
     158: aload_0
     159: aload_3
     160: aload_2
     161: invokespecial #68                 // Method authenticateWithoutTlsExtension:(Ljava/lang/String;Ljava/lang/String;)V
     164: new           #69                 // class org/apache/hadoop/security/authentication/server/AuthenticationToken
     167: dup
     168: aload_1
     169: aload_1
     170: ldc           #5                  // String ldap
     172: invokespecial #70                 // Method org/apache/hadoop/security/authentication/server/AuthenticationToken."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     175: areturn

  private void authenticateWithTlsExtension(java.lang.String, java.lang.String) throws org.apache.hadoop.security.authentication.client.AuthenticationException;
    Code:
       0: aconst_null
       1: astore_3
       2: new           #71                 // class java/util/Hashtable
       5: dup
       6: invokespecial #72                 // Method java/util/Hashtable."<init>":()V
       9: astore        4
      11: aload         4
      13: ldc           #74                 // String java.naming.factory.initial
      15: ldc           #75                 // String com.sun.jndi.ldap.LdapCtxFactory
      17: invokevirtual #76                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      20: pop
      21: aload         4
      23: ldc           #77                 // String java.naming.provider.url
      25: aload_0
      26: getfield      #10                 // Field providerUrl:Ljava/lang/String;
      29: invokevirtual #76                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      32: pop
      33: new           #78                 // class javax/naming/ldap/InitialLdapContext
      36: dup
      37: aload         4
      39: aconst_null
      40: invokespecial #79                 // Method javax/naming/ldap/InitialLdapContext."<init>":(Ljava/util/Hashtable;[Ljavax/naming/ldap/Control;)V
      43: astore_3
      44: aload_3
      45: new           #80                 // class javax/naming/ldap/StartTlsRequest
      48: dup
      49: invokespecial #81                 // Method javax/naming/ldap/StartTlsRequest."<init>":()V
      52: invokeinterface #82,  2           // InterfaceMethod javax/naming/ldap/LdapContext.extendedOperation:(Ljavax/naming/ldap/ExtendedRequest;)Ljavax/naming/ldap/ExtendedResponse;
      57: checkcast     #83                 // class javax/naming/ldap/StartTlsResponse
      60: astore        5
      62: aload_0
      63: getfield      #4                  // Field disableHostNameVerification:Ljava/lang/Boolean;
      66: invokevirtual #21                 // Method java/lang/Boolean.booleanValue:()Z
      69: ifeq          85
      72: aload         5
      74: new           #84                 // class org/apache/hadoop/security/authentication/server/LdapAuthenticationHandler$1
      77: dup
      78: aload_0
      79: invokespecial #85                 // Method org/apache/hadoop/security/authentication/server/LdapAuthenticationHandler$1."<init>":(Lorg/apache/hadoop/security/authentication/server/LdapAuthenticationHandler;)V
      82: invokevirtual #86                 // Method javax/naming/ldap/StartTlsResponse.setHostnameVerifier:(Ljavax/net/ssl/HostnameVerifier;)V
      85: aload         5
      87: invokevirtual #87                 // Method javax/naming/ldap/StartTlsResponse.negotiate:()Ljavax/net/ssl/SSLSession;
      90: pop
      91: aload_3
      92: ldc           #88                 // String java.naming.security.authentication
      94: ldc           #89                 // String simple
      96: invokeinterface #90,  3           // InterfaceMethod javax/naming/ldap/LdapContext.addToEnvironment:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     101: pop
     102: aload_3
     103: ldc           #91                 // String java.naming.security.principal
     105: aload_1
     106: invokeinterface #90,  3           // InterfaceMethod javax/naming/ldap/LdapContext.addToEnvironment:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     111: pop
     112: aload_3
     113: ldc           #92                 // String java.naming.security.credentials
     115: aload_2
     116: invokeinterface #90,  3           // InterfaceMethod javax/naming/ldap/LdapContext.addToEnvironment:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     121: pop
     122: aload_3
     123: aload_1
     124: invokeinterface #93,  2           // InterfaceMethod javax/naming/ldap/LdapContext.lookup:(Ljava/lang/String;)Ljava/lang/Object;
     129: pop
     130: getstatic     #36                 // Field logger:Lorg/slf4j/Logger;
     133: ldc           #94                 // String Authentication successful for {}
     135: aload_1
     136: invokeinterface #95,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
     141: aload_3
     142: ifnull        193
     145: aload_3
     146: invokeinterface #96,  1           // InterfaceMethod javax/naming/ldap/LdapContext.close:()V
     151: goto          193
     154: astore        5
     156: goto          193
     159: astore        5
     161: new           #54                 // class org/apache/hadoop/security/authentication/client/AuthenticationException
     164: dup
     165: ldc           #99                 // String Error validating LDAP user
     167: aload         5
     169: invokespecial #100                // Method org/apache/hadoop/security/authentication/client/AuthenticationException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     172: athrow
     173: astore        6
     175: aload_3
     176: ifnull        190
     179: aload_3
     180: invokeinterface #96,  1           // InterfaceMethod javax/naming/ldap/LdapContext.close:()V
     185: goto          190
     188: astore        7
     190: aload         6
     192: athrow
     193: return
    Exception table:
       from    to  target type
         145   151   154   Class javax/naming/NamingException
          33   141   159   Class javax/naming/NamingException
          33   141   159   Class java/io/IOException
          33   141   173   any
         179   185   188   Class javax/naming/NamingException
         159   175   173   any

  private void authenticateWithoutTlsExtension(java.lang.String, java.lang.String) throws org.apache.hadoop.security.authentication.client.AuthenticationException;
    Code:
       0: new           #71                 // class java/util/Hashtable
       3: dup
       4: invokespecial #72                 // Method java/util/Hashtable."<init>":()V
       7: astore_3
       8: aload_3
       9: ldc           #74                 // String java.naming.factory.initial
      11: ldc           #75                 // String com.sun.jndi.ldap.LdapCtxFactory
      13: invokevirtual #76                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      16: pop
      17: aload_3
      18: ldc           #77                 // String java.naming.provider.url
      20: aload_0
      21: getfield      #10                 // Field providerUrl:Ljava/lang/String;
      24: invokevirtual #76                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      27: pop
      28: aload_3
      29: ldc           #88                 // String java.naming.security.authentication
      31: ldc           #89                 // String simple
      33: invokevirtual #76                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      36: pop
      37: aload_3
      38: ldc           #91                 // String java.naming.security.principal
      40: aload_1
      41: invokevirtual #76                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      44: pop
      45: aload_3
      46: ldc           #92                 // String java.naming.security.credentials
      48: aload_2
      49: invokevirtual #76                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      52: pop
      53: new           #101                // class javax/naming/directory/InitialDirContext
      56: dup
      57: aload_3
      58: invokespecial #102                // Method javax/naming/directory/InitialDirContext."<init>":(Ljava/util/Hashtable;)V
      61: astore        4
      63: aload         4
      65: invokeinterface #103,  1          // InterfaceMethod javax/naming/Context.close:()V
      70: getstatic     #36                 // Field logger:Lorg/slf4j/Logger;
      73: ldc           #94                 // String Authentication successful for {}
      75: aload_1
      76: invokeinterface #95,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      81: goto          98
      84: astore        4
      86: new           #54                 // class org/apache/hadoop/security/authentication/client/AuthenticationException
      89: dup
      90: ldc           #99                 // String Error validating LDAP user
      92: aload         4
      94: invokespecial #100                // Method org/apache/hadoop/security/authentication/client/AuthenticationException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      97: athrow
      98: return
    Exception table:
       from    to  target type
          53    81    84   Class javax/naming/NamingException

  private static boolean hasDomain(java.lang.String);
    Code:
       0: aload_0
       1: invokestatic  #104                // Method indexOfDomainMatch:(Ljava/lang/String;)I
       4: ifle          11
       7: iconst_1
       8: goto          12
      11: iconst_0
      12: ireturn

  private static int indexOfDomainMatch(java.lang.String);
    Code:
       0: aload_0
       1: ifnonnull     6
       4: iconst_m1
       5: ireturn
       6: aload_0
       7: bipush        47
       9: invokevirtual #105                // Method java/lang/String.indexOf:(I)I
      12: istore_1
      13: aload_0
      14: bipush        64
      16: invokevirtual #105                // Method java/lang/String.indexOf:(I)I
      19: istore_2
      20: iload_1
      21: iload_2
      22: invokestatic  #106                // Method java/lang/Math.min:(II)I
      25: istore_3
      26: iload_3
      27: iconst_m1
      28: if_icmpne     37
      31: iload_1
      32: iload_2
      33: invokestatic  #107                // Method java/lang/Math.max:(II)I
      36: istore_3
      37: iload_3
      38: ireturn

  static {};
    Code:
       0: ldc           #1                  // class org/apache/hadoop/security/authentication/server/LdapAuthenticationHandler
       2: invokestatic  #108                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #36                 // Field logger:Lorg/slf4j/Logger;
       8: return
}
