Compiled from "SshFenceByTcpPort.java"
public class org.apache.hadoop.ha.SshFenceByTcpPort extends org.apache.hadoop.conf.Configured implements org.apache.hadoop.ha.FenceMethod {
  static final org.slf4j.Logger LOG;

  static final java.lang.String CONF_CONNECT_TIMEOUT_KEY;

  private static final int CONF_CONNECT_TIMEOUT_DEFAULT;

  static final java.lang.String CONF_IDENTITIES_KEY;

  public org.apache.hadoop.ha.SshFenceByTcpPort();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/hadoop/conf/Configured."<init>":()V
       4: return

  public void checkArgs(java.lang.String) throws org.apache.hadoop.ha.BadFencingConfigurationException;
    Code:
       0: aload_1
       1: ifnull        13
       4: new           #2                  // class org/apache/hadoop/ha/SshFenceByTcpPort$Args
       7: dup
       8: aload_1
       9: invokespecial #3                  // Method org/apache/hadoop/ha/SshFenceByTcpPort$Args."<init>":(Ljava/lang/String;)V
      12: pop
      13: return

  public boolean tryFence(org.apache.hadoop.ha.HAServiceTarget, java.lang.String) throws org.apache.hadoop.ha.BadFencingConfigurationException;
    Code:
       0: new           #2                  // class org/apache/hadoop/ha/SshFenceByTcpPort$Args
       3: dup
       4: aload_2
       5: invokespecial #3                  // Method org/apache/hadoop/ha/SshFenceByTcpPort$Args."<init>":(Ljava/lang/String;)V
       8: astore_3
       9: aload_1
      10: invokevirtual #4                  // Method org/apache/hadoop/ha/HAServiceTarget.getAddress:()Ljava/net/InetSocketAddress;
      13: astore        4
      15: aload         4
      17: invokevirtual #5                  // Method java/net/InetSocketAddress.getHostName:()Ljava/lang/String;
      20: astore        5
      22: aload_0
      23: aload         4
      25: invokevirtual #5                  // Method java/net/InetSocketAddress.getHostName:()Ljava/lang/String;
      28: aload_3
      29: invokespecial #6                  // Method createSession:(Ljava/lang/String;Lorg/apache/hadoop/ha/SshFenceByTcpPort$Args;)Lcom/jcraft/jsch/Session;
      32: astore        6
      34: goto          53
      37: astore        7
      39: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
      42: ldc           #9                  // String Unable to create SSH session
      44: aload         7
      46: invokeinterface #10,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
      51: iconst_0
      52: ireturn
      53: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
      56: new           #11                 // class java/lang/StringBuilder
      59: dup
      60: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      63: ldc           #13                 // String Connecting to
      65: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      68: aload         5
      70: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      73: ldc           #15                 // String ...
      75: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      78: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      81: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      86: aload         6
      88: aload_0
      89: invokespecial #18                 // Method getSshConnectTimeout:()I
      92: invokevirtual #19                 // Method com/jcraft/jsch/Session.connect:(I)V
      95: goto          144
      98: astore        7
     100: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     103: new           #11                 // class java/lang/StringBuilder
     106: dup
     107: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
     110: ldc           #20                 // String Unable to connect to
     112: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     115: aload         5
     117: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     120: ldc           #21                 // String  as user
     122: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     125: aload_3
     126: getfield      #22                 // Field org/apache/hadoop/ha/SshFenceByTcpPort$Args.user:Ljava/lang/String;
     129: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     132: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     135: aload         7
     137: invokeinterface #10,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     142: iconst_0
     143: ireturn
     144: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     147: new           #11                 // class java/lang/StringBuilder
     150: dup
     151: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
     154: ldc           #23                 // String Connected to
     156: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     159: aload         5
     161: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     164: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     167: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     172: aload_0
     173: aload         6
     175: aload         4
     177: invokespecial #24                 // Method doFence:(Lcom/jcraft/jsch/Session;Ljava/net/InetSocketAddress;)Z
     180: istore        7
     182: aload         6
     184: invokevirtual #25                 // Method com/jcraft/jsch/Session.disconnect:()V
     187: iload         7
     189: ireturn
     190: astore        7
     192: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     195: ldc           #26                 // String Unable to achieve fencing on remote host
     197: aload         7
     199: invokeinterface #10,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     204: iconst_0
     205: istore        8
     207: aload         6
     209: invokevirtual #25                 // Method com/jcraft/jsch/Session.disconnect:()V
     212: iload         8
     214: ireturn
     215: astore        9
     217: aload         6
     219: invokevirtual #25                 // Method com/jcraft/jsch/Session.disconnect:()V
     222: aload         9
     224: athrow
    Exception table:
       from    to  target type
          22    34    37   Class com/jcraft/jsch/JSchException
          86    95    98   Class com/jcraft/jsch/JSchException
         172   182   190   Class com/jcraft/jsch/JSchException
         172   182   215   any
         190   207   215   any
         215   217   215   any

  private com.jcraft.jsch.Session createSession(java.lang.String, org.apache.hadoop.ha.SshFenceByTcpPort$Args) throws com.jcraft.jsch.JSchException;
    Code:
       0: new           #27                 // class com/jcraft/jsch/JSch
       3: dup
       4: invokespecial #28                 // Method com/jcraft/jsch/JSch."<init>":()V
       7: astore_3
       8: aload_0
       9: invokespecial #29                 // Method getKeyFiles:()Ljava/util/Collection;
      12: invokeinterface #30,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      17: astore        4
      19: aload         4
      21: invokeinterface #31,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      26: ifeq          50
      29: aload         4
      31: invokeinterface #32,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      36: checkcast     #33                 // class java/lang/String
      39: astore        5
      41: aload_3
      42: aload         5
      44: invokevirtual #34                 // Method com/jcraft/jsch/JSch.addIdentity:(Ljava/lang/String;)V
      47: goto          19
      50: new           #35                 // class org/apache/hadoop/ha/SshFenceByTcpPort$LogAdapter
      53: dup
      54: aconst_null
      55: invokespecial #36                 // Method org/apache/hadoop/ha/SshFenceByTcpPort$LogAdapter."<init>":(Lorg/apache/hadoop/ha/SshFenceByTcpPort$1;)V
      58: invokestatic  #37                 // Method com/jcraft/jsch/JSch.setLogger:(Lcom/jcraft/jsch/Logger;)V
      61: aload_3
      62: aload_2
      63: getfield      #22                 // Field org/apache/hadoop/ha/SshFenceByTcpPort$Args.user:Ljava/lang/String;
      66: aload_1
      67: aload_2
      68: getfield      #38                 // Field org/apache/hadoop/ha/SshFenceByTcpPort$Args.sshPort:I
      71: invokevirtual #39                 // Method com/jcraft/jsch/JSch.getSession:(Ljava/lang/String;Ljava/lang/String;I)Lcom/jcraft/jsch/Session;
      74: astore        4
      76: aload         4
      78: ldc           #40                 // String StrictHostKeyChecking
      80: ldc           #41                 // String no
      82: invokevirtual #42                 // Method com/jcraft/jsch/Session.setConfig:(Ljava/lang/String;Ljava/lang/String;)V
      85: aload         4
      87: areturn

  private boolean doFence(com.jcraft.jsch.Session, java.net.InetSocketAddress) throws com.jcraft.jsch.JSchException;
    Code:
       0: aload_2
       1: invokevirtual #43                 // Method java/net/InetSocketAddress.getPort:()I
       4: istore_3
       5: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
       8: new           #11                 // class java/lang/StringBuilder
      11: dup
      12: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      15: ldc           #44                 // String Looking for process running on port
      17: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      20: iload_3
      21: invokevirtual #45                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      24: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      27: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      32: aload_0
      33: aload_1
      34: new           #11                 // class java/lang/StringBuilder
      37: dup
      38: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      41: ldc           #46                 // String PATH=$PATH:/sbin:/usr/sbin fuser -v -k -n tcp
      43: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      46: iload_3
      47: invokevirtual #45                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      50: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      53: invokespecial #47                 // Method execCommand:(Lcom/jcraft/jsch/Session;Ljava/lang/String;)I
      56: istore        4
      58: iload         4
      60: ifne          92
      63: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
      66: new           #11                 // class java/lang/StringBuilder
      69: dup
      70: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      73: ldc           #48                 // String Successfully killed process that was listening on port
      75: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      78: iload_3
      79: invokevirtual #45                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      82: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      85: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      90: iconst_1
      91: ireturn
      92: iload         4
      94: iconst_1
      95: if_icmpne     178
      98: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     101: ldc           #49                 // String Indeterminate response from trying to kill service. Verifying whether it is running using nc...
     103: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     108: aload_0
     109: aload_1
     110: new           #11                 // class java/lang/StringBuilder
     113: dup
     114: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
     117: ldc           #50                 // String nc -z
     119: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     122: aload_2
     123: invokevirtual #5                  // Method java/net/InetSocketAddress.getHostName:()Ljava/lang/String;
     126: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     129: ldc           #51                 // String
     131: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     134: aload_2
     135: invokevirtual #43                 // Method java/net/InetSocketAddress.getPort:()I
     138: invokevirtual #45                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     141: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     144: invokespecial #47                 // Method execCommand:(Lcom/jcraft/jsch/Session;Ljava/lang/String;)I
     147: istore        4
     149: iload         4
     151: ifne          166
     154: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     157: ldc           #52                 // String Unable to fence - it is running but we cannot kill it
     159: invokeinterface #53,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     164: iconst_0
     165: ireturn
     166: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     169: ldc           #54                 // String Verified that the service is down.
     171: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     176: iconst_1
     177: ireturn
     178: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     181: new           #11                 // class java/lang/StringBuilder
     184: dup
     185: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
     188: ldc           #55                 // String rc:
     190: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     193: iload         4
     195: invokevirtual #45                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     198: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     201: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     206: iload         4
     208: ifne          215
     211: iconst_1
     212: goto          216
     215: iconst_0
     216: ireturn
     217: astore        4
     219: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     222: ldc           #57                 // String Interrupted while trying to fence via ssh
     224: aload         4
     226: invokeinterface #10,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     231: iconst_0
     232: ireturn
     233: astore        4
     235: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     238: ldc           #59                 // String Unknown failure while trying to fence via ssh
     240: aload         4
     242: invokeinterface #10,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     247: iconst_0
     248: ireturn
    Exception table:
       from    to  target type
           5    91   217   Class java/lang/InterruptedException
          92   165   217   Class java/lang/InterruptedException
         166   177   217   Class java/lang/InterruptedException
         178   216   217   Class java/lang/InterruptedException
           5    91   233   Class java/io/IOException
          92   165   233   Class java/io/IOException
         166   177   233   Class java/io/IOException
         178   216   233   Class java/io/IOException

  private int execCommand(com.jcraft.jsch.Session, java.lang.String) throws com.jcraft.jsch.JSchException, java.lang.InterruptedException, java.io.IOException;
    Code:
       0: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
       3: new           #11                 // class java/lang/StringBuilder
       6: dup
       7: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      10: ldc           #60                 // String Running cmd:
      12: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      15: aload_2
      16: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      19: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      22: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      27: aconst_null
      28: astore_3
      29: aload_1
      30: ldc           #62                 // String exec
      32: invokevirtual #63                 // Method com/jcraft/jsch/Session.openChannel:(Ljava/lang/String;)Lcom/jcraft/jsch/Channel;
      35: checkcast     #64                 // class com/jcraft/jsch/ChannelExec
      38: astore_3
      39: aload_3
      40: aload_2
      41: invokevirtual #65                 // Method com/jcraft/jsch/ChannelExec.setCommand:(Ljava/lang/String;)V
      44: aload_3
      45: aconst_null
      46: invokevirtual #66                 // Method com/jcraft/jsch/ChannelExec.setInputStream:(Ljava/io/InputStream;)V
      49: aload_3
      50: invokevirtual #67                 // Method com/jcraft/jsch/ChannelExec.connect:()V
      53: new           #68                 // class org/apache/hadoop/ha/StreamPumper
      56: dup
      57: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
      60: new           #11                 // class java/lang/StringBuilder
      63: dup
      64: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      67: aload_2
      68: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      71: ldc           #69                 // String  via ssh
      73: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      76: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      79: aload_3
      80: invokevirtual #70                 // Method com/jcraft/jsch/ChannelExec.getInputStream:()Ljava/io/InputStream;
      83: getstatic     #71                 // Field org/apache/hadoop/ha/StreamPumper$StreamType.STDOUT:Lorg/apache/hadoop/ha/StreamPumper$StreamType;
      86: invokespecial #72                 // Method org/apache/hadoop/ha/StreamPumper."<init>":(Lorg/slf4j/Logger;Ljava/lang/String;Ljava/io/InputStream;Lorg/apache/hadoop/ha/StreamPumper$StreamType;)V
      89: astore        4
      91: aload         4
      93: invokevirtual #73                 // Method org/apache/hadoop/ha/StreamPumper.start:()V
      96: new           #68                 // class org/apache/hadoop/ha/StreamPumper
      99: dup
     100: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
     103: new           #11                 // class java/lang/StringBuilder
     106: dup
     107: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
     110: aload_2
     111: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     114: ldc           #69                 // String  via ssh
     116: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     119: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     122: aload_3
     123: invokevirtual #74                 // Method com/jcraft/jsch/ChannelExec.getErrStream:()Ljava/io/InputStream;
     126: getstatic     #75                 // Field org/apache/hadoop/ha/StreamPumper$StreamType.STDERR:Lorg/apache/hadoop/ha/StreamPumper$StreamType;
     129: invokespecial #72                 // Method org/apache/hadoop/ha/StreamPumper."<init>":(Lorg/slf4j/Logger;Ljava/lang/String;Ljava/io/InputStream;Lorg/apache/hadoop/ha/StreamPumper$StreamType;)V
     132: astore        5
     134: aload         5
     136: invokevirtual #73                 // Method org/apache/hadoop/ha/StreamPumper.start:()V
     139: aload         4
     141: invokevirtual #76                 // Method org/apache/hadoop/ha/StreamPumper.join:()V
     144: aload         5
     146: invokevirtual #76                 // Method org/apache/hadoop/ha/StreamPumper.join:()V
     149: aload_3
     150: invokevirtual #77                 // Method com/jcraft/jsch/ChannelExec.getExitStatus:()I
     153: istore        6
     155: aload_3
     156: invokestatic  #78                 // Method cleanup:(Lcom/jcraft/jsch/ChannelExec;)V
     159: iload         6
     161: ireturn
     162: astore        7
     164: aload_3
     165: invokestatic  #78                 // Method cleanup:(Lcom/jcraft/jsch/ChannelExec;)V
     168: aload         7
     170: athrow
    Exception table:
       from    to  target type
          29   155   162   any
         162   164   162   any

  private static void cleanup(com.jcraft.jsch.ChannelExec);
    Code:
       0: aload_0
       1: ifnull        23
       4: aload_0
       5: invokevirtual #79                 // Method com/jcraft/jsch/ChannelExec.disconnect:()V
       8: goto          23
      11: astore_1
      12: getstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
      15: ldc           #81                 // String Couldn\'t disconnect ssh channel
      17: aload_1
      18: invokeinterface #10,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
      23: return
    Exception table:
       from    to  target type
           4     8    11   Class java/lang/Throwable

  private int getSshConnectTimeout();
    Code:
       0: aload_0
       1: invokevirtual #82                 // Method getConf:()Lorg/apache/hadoop/conf/Configuration;
       4: ldc           #84                 // String dfs.ha.fencing.ssh.connect-timeout
       6: sipush        30000
       9: invokevirtual #85                 // Method org/apache/hadoop/conf/Configuration.getInt:(Ljava/lang/String;I)I
      12: ireturn

  private java.util.Collection<java.lang.String> getKeyFiles();
    Code:
       0: aload_0
       1: invokevirtual #82                 // Method getConf:()Lorg/apache/hadoop/conf/Configuration;
       4: ldc           #86                 // String dfs.ha.fencing.ssh.private-key-files
       6: invokevirtual #87                 // Method org/apache/hadoop/conf/Configuration.getTrimmedStringCollection:(Ljava/lang/String;)Ljava/util/Collection;
       9: areturn

  static {};
    Code:
       0: ldc           #83                 // class org/apache/hadoop/ha/SshFenceByTcpPort
       2: invokestatic  #88                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #8                  // Field LOG:Lorg/slf4j/Logger;
       8: return
}
