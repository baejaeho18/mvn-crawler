Compiled from "Activator.java"
public final class org.apache.logging.log4j.core.osgi.Activator implements org.osgi.framework.BundleActivator,org.osgi.framework.SynchronousBundleListener {
  private static final org.apache.logging.log4j.Logger LOGGER;

  private final java.util.concurrent.atomic.AtomicReference<org.osgi.framework.BundleContext> contextRef;

  org.osgi.framework.ServiceRegistration provideRegistration;

  org.osgi.framework.ServiceRegistration contextDataRegistration;

  public org.apache.logging.log4j.core.osgi.Activator();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/concurrent/atomic/AtomicReference
       8: dup
       9: invokespecial #3                  // Method java/util/concurrent/atomic/AtomicReference."<init>":()V
      12: putfield      #4                  // Field contextRef:Ljava/util/concurrent/atomic/AtomicReference;
      15: aload_0
      16: aconst_null
      17: putfield      #5                  // Field provideRegistration:Lorg/osgi/framework/ServiceRegistration;
      20: aload_0
      21: aconst_null
      22: putfield      #6                  // Field contextDataRegistration:Lorg/osgi/framework/ServiceRegistration;
      25: return

  public void start(org.osgi.framework.BundleContext) throws java.lang.Exception;
    Code:
       0: new           #7                  // class org/apache/logging/log4j/core/impl/Log4jProvider
       3: dup
       4: invokespecial #8                  // Method org/apache/logging/log4j/core/impl/Log4jProvider."<init>":()V
       7: astore_2
       8: new           #9                  // class java/util/Hashtable
      11: dup
      12: invokespecial #10                 // Method java/util/Hashtable."<init>":()V
      15: astore_3
      16: aload_3
      17: ldc           #11                 // String APIVersion
      19: ldc           #12                 // String 2.60
      21: invokevirtual #13                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      24: pop
      25: new           #14                 // class org/apache/logging/log4j/core/impl/ThreadContextDataProvider
      28: dup
      29: invokespecial #15                 // Method org/apache/logging/log4j/core/impl/ThreadContextDataProvider."<init>":()V
      32: astore        4
      34: aload_0
      35: aload_1
      36: ldc           #16                 // class org/apache/logging/log4j/spi/Provider
      38: invokevirtual #17                 // Method java/lang/Class.getName:()Ljava/lang/String;
      41: aload_2
      42: aload_3
      43: invokeinterface #18,  4           // InterfaceMethod org/osgi/framework/BundleContext.registerService:(Ljava/lang/String;Ljava/lang/Object;Ljava/util/Dictionary;)Lorg/osgi/framework/ServiceRegistration;
      48: putfield      #5                  // Field provideRegistration:Lorg/osgi/framework/ServiceRegistration;
      51: aload_0
      52: aload_1
      53: ldc           #19                 // class org/apache/logging/log4j/core/util/ContextDataProvider
      55: invokevirtual #17                 // Method java/lang/Class.getName:()Ljava/lang/String;
      58: aload         4
      60: aconst_null
      61: invokeinterface #18,  4           // InterfaceMethod org/osgi/framework/BundleContext.registerService:(Ljava/lang/String;Ljava/lang/Object;Ljava/util/Dictionary;)Lorg/osgi/framework/ServiceRegistration;
      66: putfield      #6                  // Field contextDataRegistration:Lorg/osgi/framework/ServiceRegistration;
      69: aload_1
      70: invokestatic  #20                 // Method loadContextProviders:(Lorg/osgi/framework/BundleContext;)V
      73: invokestatic  #21                 // Method org/apache/logging/log4j/util/PropertiesUtil.getProperties:()Lorg/apache/logging/log4j/util/PropertiesUtil;
      76: ldc           #23                 // String Log4jContextSelector
      78: invokevirtual #24                 // Method org/apache/logging/log4j/util/PropertiesUtil.getStringProperty:(Ljava/lang/String;)Ljava/lang/String;
      81: ifnonnull     95
      84: ldc           #23                 // String Log4jContextSelector
      86: ldc           #25                 // class org/apache/logging/log4j/core/osgi/BundleContextSelector
      88: invokevirtual #17                 // Method java/lang/Class.getName:()Ljava/lang/String;
      91: invokestatic  #26                 // Method java/lang/System.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      94: pop
      95: aload_0
      96: getfield      #4                  // Field contextRef:Ljava/util/concurrent/atomic/AtomicReference;
      99: aconst_null
     100: aload_1
     101: invokevirtual #27                 // Method java/util/concurrent/atomic/AtomicReference.compareAndSet:(Ljava/lang/Object;Ljava/lang/Object;)Z
     104: ifeq          118
     107: aload_1
     108: aload_0
     109: invokeinterface #28,  2           // InterfaceMethod org/osgi/framework/BundleContext.addBundleListener:(Lorg/osgi/framework/BundleListener;)V
     114: aload_1
     115: invokestatic  #29                 // Method scanInstalledBundlesForPlugins:(Lorg/osgi/framework/BundleContext;)V
     118: return

  private static void scanInstalledBundlesForPlugins(org.osgi.framework.BundleContext);
    Code:
       0: aload_0
       1: invokeinterface #30,  1           // InterfaceMethod org/osgi/framework/BundleContext.getBundles:()[Lorg/osgi/framework/Bundle;
       6: astore_1
       7: aload_1
       8: astore_2
       9: aload_2
      10: arraylength
      11: istore_3
      12: iconst_0
      13: istore        4
      15: iload         4
      17: iload_3
      18: if_icmpge     38
      21: aload_2
      22: iload         4
      24: aaload
      25: astore        5
      27: aload         5
      29: invokestatic  #31                 // Method scanBundleForPlugins:(Lorg/osgi/framework/Bundle;)V
      32: iinc          4, 1
      35: goto          15
      38: return

  private static void scanBundleForPlugins(org.osgi.framework.Bundle);
    Code:
       0: aload_0
       1: invokeinterface #32,  1           // InterfaceMethod org/osgi/framework/Bundle.getBundleId:()J
       6: lstore_1
       7: aload_0
       8: invokeinterface #33,  1           // InterfaceMethod org/osgi/framework/Bundle.getState:()I
      13: bipush        32
      15: if_icmpne     68
      18: lload_1
      19: lconst_0
      20: lcmp
      21: ifeq          68
      24: getstatic     #35                 // Field LOGGER:Lorg/apache/logging/log4j/Logger;
      27: ldc           #36                 // String Scanning bundle [{}, id=%d] for plugins.
      29: aload_0
      30: invokeinterface #37,  1           // InterfaceMethod org/osgi/framework/Bundle.getSymbolicName:()Ljava/lang/String;
      35: lload_1
      36: invokestatic  #38                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      39: invokeinterface #39,  4           // InterfaceMethod org/apache/logging/log4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      44: invokestatic  #40                 // Method org/apache/logging/log4j/core/config/plugins/util/PluginRegistry.getInstance:()Lorg/apache/logging/log4j/core/config/plugins/util/PluginRegistry;
      47: lload_1
      48: aload_0
      49: ldc           #41                 // class org/osgi/framework/wiring/BundleWiring
      51: invokeinterface #42,  2           // InterfaceMethod org/osgi/framework/Bundle.adapt:(Ljava/lang/Class;)Ljava/lang/Object;
      56: checkcast     #41                 // class org/osgi/framework/wiring/BundleWiring
      59: invokeinterface #43,  1           // InterfaceMethod org/osgi/framework/wiring/BundleWiring.getClassLoader:()Ljava/lang/ClassLoader;
      64: invokevirtual #44                 // Method org/apache/logging/log4j/core/config/plugins/util/PluginRegistry.loadFromBundle:(JLjava/lang/ClassLoader;)Ljava/util/Map;
      67: pop
      68: return

  private static void loadContextProviders(org.osgi.framework.BundleContext);
    Code:
       0: aload_0
       1: ldc           #19                 // class org/apache/logging/log4j/core/util/ContextDataProvider
       3: aconst_null
       4: invokeinterface #45,  3           // InterfaceMethod org/osgi/framework/BundleContext.getServiceReferences:(Ljava/lang/Class;Ljava/lang/String;)Ljava/util/Collection;
       9: astore_1
      10: aload_1
      11: invokeinterface #46,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      16: astore_2
      17: aload_2
      18: invokeinterface #47,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      23: ifeq          62
      26: aload_2
      27: invokeinterface #48,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      32: checkcast     #49                 // class org/osgi/framework/ServiceReference
      35: astore_3
      36: aload_0
      37: aload_3
      38: invokeinterface #50,  2           // InterfaceMethod org/osgi/framework/BundleContext.getService:(Lorg/osgi/framework/ServiceReference;)Ljava/lang/Object;
      43: checkcast     #19                 // class org/apache/logging/log4j/core/util/ContextDataProvider
      46: astore        4
      48: getstatic     #51                 // Field org/apache/logging/log4j/core/impl/ThreadContextDataInjector.contextDataProviders:Ljava/util/Collection;
      51: aload         4
      53: invokeinterface #52,  2           // InterfaceMethod java/util/Collection.add:(Ljava/lang/Object;)Z
      58: pop
      59: goto          17
      62: goto          77
      65: astore_1
      66: getstatic     #35                 // Field LOGGER:Lorg/apache/logging/log4j/Logger;
      69: ldc           #54                 // String Error accessing context data provider
      71: aload_1
      72: invokeinterface #55,  3           // InterfaceMethod org/apache/logging/log4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
      77: return
    Exception table:
       from    to  target type
           0    62    65   Class org/osgi/framework/InvalidSyntaxException

  private static void stopBundlePlugins(org.osgi.framework.Bundle);
    Code:
       0: getstatic     #35                 // Field LOGGER:Lorg/apache/logging/log4j/Logger;
       3: ldc           #56                 // String Stopping bundle [{}] plugins.
       5: aload_0
       6: invokeinterface #37,  1           // InterfaceMethod org/osgi/framework/Bundle.getSymbolicName:()Ljava/lang/String;
      11: invokeinterface #57,  3           // InterfaceMethod org/apache/logging/log4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
      16: invokestatic  #40                 // Method org/apache/logging/log4j/core/config/plugins/util/PluginRegistry.getInstance:()Lorg/apache/logging/log4j/core/config/plugins/util/PluginRegistry;
      19: aload_0
      20: invokeinterface #32,  1           // InterfaceMethod org/osgi/framework/Bundle.getBundleId:()J
      25: invokevirtual #58                 // Method org/apache/logging/log4j/core/config/plugins/util/PluginRegistry.clearBundlePlugins:(J)V
      28: return

  public void stop(org.osgi.framework.BundleContext) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #5                  // Field provideRegistration:Lorg/osgi/framework/ServiceRegistration;
       4: invokeinterface #59,  1           // InterfaceMethod org/osgi/framework/ServiceRegistration.unregister:()V
       9: aload_0
      10: getfield      #6                  // Field contextDataRegistration:Lorg/osgi/framework/ServiceRegistration;
      13: invokeinterface #59,  1           // InterfaceMethod org/osgi/framework/ServiceRegistration.unregister:()V
      18: aload_0
      19: getfield      #4                  // Field contextRef:Ljava/util/concurrent/atomic/AtomicReference;
      22: aload_1
      23: aconst_null
      24: invokevirtual #27                 // Method java/util/concurrent/atomic/AtomicReference.compareAndSet:(Ljava/lang/Object;Ljava/lang/Object;)Z
      27: pop
      28: invokestatic  #60                 // Method org/apache/logging/log4j/LogManager.shutdown:()V
      31: return

  public void bundleChanged(org.osgi.framework.BundleEvent);
    Code:
       0: aload_1
       1: invokevirtual #61                 // Method org/osgi/framework/BundleEvent.getType:()I
       4: lookupswitch  { // 2
                     2: 32
                   256: 42
               default: 52
          }
      32: aload_1
      33: invokevirtual #62                 // Method org/osgi/framework/BundleEvent.getBundle:()Lorg/osgi/framework/Bundle;
      36: invokestatic  #31                 // Method scanBundleForPlugins:(Lorg/osgi/framework/Bundle;)V
      39: goto          52
      42: aload_1
      43: invokevirtual #62                 // Method org/osgi/framework/BundleEvent.getBundle:()Lorg/osgi/framework/Bundle;
      46: invokestatic  #63                 // Method stopBundlePlugins:(Lorg/osgi/framework/Bundle;)V
      49: goto          52
      52: return

  static {};
    Code:
       0: invokestatic  #64                 // Method org/apache/logging/log4j/status/StatusLogger.getLogger:()Lorg/apache/logging/log4j/status/StatusLogger;
       3: putstatic     #35                 // Field LOGGER:Lorg/apache/logging/log4j/Logger;
       6: return
}
