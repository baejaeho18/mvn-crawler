Compiled from "PkinitCrypto.java"
public class org.apache.kerby.kerberos.kerb.preauth.pkinit.PkinitCrypto {
  private static final org.slf4j.Logger LOG;

  public org.apache.kerby.kerberos.kerb.preauth.pkinit.PkinitCrypto();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public static void verifyCmsSignedData(org.apache.kerby.kerberos.kerb.preauth.pkinit.CmsMessageType, org.apache.kerby.cms.type.SignedData) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: aload_0
       1: invokestatic  #2                  // Method pkinitType2OID:(Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/CmsMessageType;)Ljava/lang/String;
       4: astore_2
       5: aload_2
       6: ifnonnull     19
       9: new           #3                  // class org/apache/kerby/kerberos/kerb/KrbException
      12: dup
      13: ldc           #4                  // String Can\'t get the right oid
      15: invokespecial #5                  // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Ljava/lang/String;)V
      18: athrow
      19: aload_1
      20: invokevirtual #6                  // Method org/apache/kerby/cms/type/SignedData.getEncapContentInfo:()Lorg/apache/kerby/cms/type/EncapsulatedContentInfo;
      23: invokevirtual #7                  // Method org/apache/kerby/cms/type/EncapsulatedContentInfo.getContentType:()Ljava/lang/String;
      26: astore_3
      27: aload_2
      28: aload_3
      29: invokevirtual #8                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      32: ifeq          48
      35: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      38: ldc           #10                 // String CMS Verification successful
      40: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      45: goto          71
      48: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      51: ldc           #12                 // String Wrong oid in eContentType
      53: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      58: new           #3                  // class org/apache/kerby/kerberos/kerb/KrbException
      61: dup
      62: getstatic     #14                 // Field org/apache/kerby/kerberos/kerb/KrbErrorCode.KDC_ERR_PREAUTH_FAILED:Lorg/apache/kerby/kerberos/kerb/KrbErrorCode;
      65: ldc           #12                 // String Wrong oid in eContentType
      67: invokespecial #15                 // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Lorg/apache/kerby/kerberos/kerb/KrbErrorCode;Ljava/lang/String;)V
      70: athrow
      71: return

  public static java.lang.String pkinitType2OID(org.apache.kerby.kerberos.kerb.preauth.pkinit.CmsMessageType);
    Code:
       0: getstatic     #16                 // Field org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitCrypto$1.$SwitchMap$org$apache$kerby$kerberos$kerb$preauth$pkinit$CmsMessageType:[I
       3: aload_0
       4: invokevirtual #17                 // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/CmsMessageType.ordinal:()I
       7: iaload
       8: tableswitch   { // 1 to 4
                     1: 40
                     2: 42
                     3: 46
                     4: 50
               default: 54
          }
      40: aconst_null
      41: areturn
      42: invokestatic  #18                 // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitPlgCryptoContext.getIdPkinitAuthDataOID:()Ljava/lang/String;
      45: areturn
      46: invokestatic  #19                 // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitPlgCryptoContext.getIdPkinitDHKeyDataOID:()Ljava/lang/String;
      49: areturn
      50: invokestatic  #20                 // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitPlgCryptoContext.getIdPkinitRkeyDataOID:()Ljava/lang/String;
      53: areturn
      54: aconst_null
      55: areturn

  public static void serverCheckDH(org.apache.kerby.kerberos.kerb.preauth.pkinit.PluginOpts, org.apache.kerby.kerberos.kerb.preauth.pkinit.PkinitPlgCryptoContext, org.apache.kerby.x509.type.DhParameter) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: aload_2
       1: invokevirtual #21                 // Method org/apache/kerby/x509/type/DhParameter.getP:()Ljava/math/BigInteger;
       4: invokevirtual #22                 // Method java/math/BigInteger.bitLength:()I
       7: istore_3
       8: iload_3
       9: aload_0
      10: getfield      #23                 // Field org/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts.dhMinBits:I
      13: if_icmpge     72
      16: new           #24                 // class java/lang/StringBuilder
      19: dup
      20: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      23: ldc           #26                 // String client sent dh params with
      25: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      28: iload_3
      29: invokevirtual #28                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      32: ldc           #29                 // String bits, we require
      34: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      37: aload_0
      38: getfield      #23                 // Field org/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts.dhMinBits:I
      41: invokevirtual #28                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      44: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      47: astore        4
      49: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      52: aload         4
      54: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      59: new           #3                  // class org/apache/kerby/kerberos/kerb/KrbException
      62: dup
      63: getstatic     #31                 // Field org/apache/kerby/kerberos/kerb/KrbErrorCode.KDC_ERR_DH_KEY_PARAMETERS_NOT_ACCEPTED:Lorg/apache/kerby/kerberos/kerb/KrbErrorCode;
      66: aload         4
      68: invokespecial #15                 // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Lorg/apache/kerby/kerberos/kerb/KrbErrorCode;Ljava/lang/String;)V
      71: athrow
      72: aload_1
      73: aload_2
      74: iload_3
      75: invokestatic  #32                 // Method checkDHWellknown:(Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitPlgCryptoContext;Lorg/apache/kerby/x509/type/DhParameter;I)Z
      78: ifne          92
      81: new           #3                  // class org/apache/kerby/kerberos/kerb/KrbException
      84: dup
      85: getstatic     #31                 // Field org/apache/kerby/kerberos/kerb/KrbErrorCode.KDC_ERR_DH_KEY_PARAMETERS_NOT_ACCEPTED:Lorg/apache/kerby/kerberos/kerb/KrbErrorCode;
      88: invokespecial #33                 // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Lorg/apache/kerby/kerberos/kerb/KrbErrorCode;)V
      91: athrow
      92: return

  public static boolean checkDHWellknown(org.apache.kerby.kerberos.kerb.preauth.pkinit.PkinitPlgCryptoContext, org.apache.kerby.x509.type.DhParameter, int) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: iconst_0
       1: istore_3
       2: iload_2
       3: lookupswitch  { // 3
                  1024: 36
                  2048: 36
                  4096: 36
               default: 49
          }
      36: aload_0
      37: iload_2
      38: invokevirtual #34                 // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitPlgCryptoContext.createDHParameterSpec:(I)Ljavax/crypto/spec/DHParameterSpec;
      41: aload_1
      42: invokestatic  #35                 // Method pkinitCheckDhParams:(Ljavax/crypto/spec/DHParameterSpec;Lorg/apache/kerby/x509/type/DhParameter;)Z
      45: istore_3
      46: goto          49
      49: iload_3
      50: ireturn

  public static boolean pkinitCheckDhParams(javax.crypto.spec.DHParameterSpec, org.apache.kerby.x509.type.DhParameter);
    Code:
       0: aload_0
       1: invokevirtual #36                 // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
       4: aload_1
       5: invokevirtual #21                 // Method org/apache/kerby/x509/type/DhParameter.getP:()Ljava/math/BigInteger;
       8: invokevirtual #37                 // Method java/math/BigInteger.equals:(Ljava/lang/Object;)Z
      11: ifne          26
      14: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      17: ldc           #38                 // String p is not well-known group dhparameter
      19: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      24: iconst_0
      25: ireturn
      26: aload_0
      27: invokevirtual #39                 // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
      30: aload_1
      31: invokevirtual #40                 // Method org/apache/kerby/x509/type/DhParameter.getG:()Ljava/math/BigInteger;
      34: invokevirtual #37                 // Method java/math/BigInteger.equals:(Ljava/lang/Object;)Z
      37: ifne          52
      40: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      43: ldc           #41                 // String bad g dhparameter
      45: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      50: iconst_0
      51: ireturn
      52: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      55: ldc           #42                 // String Good dhparams
      57: aload_0
      58: invokevirtual #36                 // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
      61: invokevirtual #22                 // Method java/math/BigInteger.bitLength:()I
      64: invokestatic  #43                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      67: invokeinterface #44,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      72: iconst_1
      73: ireturn

  public static javax.crypto.interfaces.DHPublicKey createDHPublicKey(java.math.BigInteger, java.math.BigInteger, java.math.BigInteger);
    Code:
       0: new           #45                 // class javax/crypto/spec/DHPublicKeySpec
       3: dup
       4: aload_2
       5: aload_0
       6: aload_1
       7: invokespecial #46                 // Method javax/crypto/spec/DHPublicKeySpec."<init>":(Ljava/math/BigInteger;Ljava/math/BigInteger;Ljava/math/BigInteger;)V
      10: astore_3
      11: aconst_null
      12: astore        4
      14: ldc           #47                 // String DH
      16: invokestatic  #48                 // Method java/security/KeyFactory.getInstance:(Ljava/lang/String;)Ljava/security/KeyFactory;
      19: astore        4
      21: goto          54
      24: astore        5
      26: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      29: new           #24                 // class java/lang/StringBuilder
      32: dup
      33: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      36: ldc           #50                 // String Fail to get dh instance.
      38: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      41: aload         5
      43: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      46: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      49: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      54: aconst_null
      55: astore        5
      57: aload         4
      59: ifnull        73
      62: aload         4
      64: aload_3
      65: invokevirtual #52                 // Method java/security/KeyFactory.generatePublic:(Ljava/security/spec/KeySpec;)Ljava/security/PublicKey;
      68: checkcast     #53                 // class javax/crypto/interfaces/DHPublicKey
      71: astore        5
      73: goto          106
      76: astore        6
      78: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      81: new           #24                 // class java/lang/StringBuilder
      84: dup
      85: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      88: ldc           #55                 // String Fail to generate public key.
      90: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      93: aload         6
      95: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      98: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     101: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     106: aload         5
     108: areturn
    Exception table:
       from    to  target type
          14    21    24   Class java/security/NoSuchAlgorithmException
          57    73    76   Class java/security/spec/InvalidKeySpecException

  public static byte[] cmsSignedDataCreate(byte[], java.lang.String, int, org.apache.kerby.cms.type.DigestAlgorithmIdentifiers, org.apache.kerby.cms.type.CertificateSet, org.apache.kerby.cms.type.RevocationInfoChoices, org.apache.kerby.cms.type.SignerInfos) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: new           #56                 // class org/apache/kerby/cms/type/SignedContentInfo
       3: dup
       4: invokespecial #57                 // Method org/apache/kerby/cms/type/SignedContentInfo."<init>":()V
       7: astore        7
       9: aload         7
      11: ldc           #58                 // String 1.2.840.113549.1.7.2
      13: invokevirtual #59                 // Method org/apache/kerby/cms/type/SignedContentInfo.setContentType:(Ljava/lang/String;)V
      16: new           #60                 // class org/apache/kerby/cms/type/SignedData
      19: dup
      20: invokespecial #61                 // Method org/apache/kerby/cms/type/SignedData."<init>":()V
      23: astore        8
      25: aload         8
      27: iload_2
      28: invokevirtual #62                 // Method org/apache/kerby/cms/type/SignedData.setVersion:(I)V
      31: aload_3
      32: ifnull        41
      35: aload         8
      37: aload_3
      38: invokevirtual #63                 // Method org/apache/kerby/cms/type/SignedData.setDigestAlgorithms:(Lorg/apache/kerby/cms/type/DigestAlgorithmIdentifiers;)V
      41: new           #64                 // class org/apache/kerby/cms/type/EncapsulatedContentInfo
      44: dup
      45: invokespecial #65                 // Method org/apache/kerby/cms/type/EncapsulatedContentInfo."<init>":()V
      48: astore        9
      50: aload         9
      52: aload_1
      53: invokevirtual #66                 // Method org/apache/kerby/cms/type/EncapsulatedContentInfo.setContentType:(Ljava/lang/String;)V
      56: aload         9
      58: aload_0
      59: invokevirtual #67                 // Method org/apache/kerby/cms/type/EncapsulatedContentInfo.setContent:([B)V
      62: aload         8
      64: aload         9
      66: invokevirtual #68                 // Method org/apache/kerby/cms/type/SignedData.setEncapContentInfo:(Lorg/apache/kerby/cms/type/EncapsulatedContentInfo;)V
      69: aload         4
      71: ifnull        81
      74: aload         8
      76: aload         4
      78: invokevirtual #69                 // Method org/apache/kerby/cms/type/SignedData.setCertificates:(Lorg/apache/kerby/cms/type/CertificateSet;)V
      81: aload         5
      83: ifnull        93
      86: aload         8
      88: aload         5
      90: invokevirtual #70                 // Method org/apache/kerby/cms/type/SignedData.setCrls:(Lorg/apache/kerby/cms/type/RevocationInfoChoices;)V
      93: aload         6
      95: ifnull        105
      98: aload         8
     100: aload         6
     102: invokevirtual #71                 // Method org/apache/kerby/cms/type/SignedData.setSignerInfos:(Lorg/apache/kerby/cms/type/SignerInfos;)V
     105: aload         7
     107: aload         8
     109: invokevirtual #72                 // Method org/apache/kerby/cms/type/SignedContentInfo.setSignedData:(Lorg/apache/kerby/cms/type/SignedData;)V
     112: aload         7
     114: invokestatic  #73                 // Method org/apache/kerby/kerberos/kerb/KrbCodec.encode:(Lorg/apache/kerby/asn1/type/Asn1Type;)[B
     117: areturn

  public static byte[] eContentInfoCreate(byte[], java.lang.String) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: new           #64                 // class org/apache/kerby/cms/type/EncapsulatedContentInfo
       3: dup
       4: invokespecial #65                 // Method org/apache/kerby/cms/type/EncapsulatedContentInfo."<init>":()V
       7: astore_2
       8: aload_2
       9: aload_1
      10: invokevirtual #66                 // Method org/apache/kerby/cms/type/EncapsulatedContentInfo.setContentType:(Ljava/lang/String;)V
      13: aload_2
      14: aload_0
      15: invokevirtual #67                 // Method org/apache/kerby/cms/type/EncapsulatedContentInfo.setContent:([B)V
      18: aload_2
      19: invokestatic  #73                 // Method org/apache/kerby/kerberos/kerb/KrbCodec.encode:(Lorg/apache/kerby/asn1/type/Asn1Type;)[B
      22: areturn

  public static java.security.cert.X509Certificate[] createCertChain(org.apache.kerby.kerberos.kerb.preauth.pkinit.PkinitPlgCryptoContext) throws java.security.cert.CertificateNotYetValidException, java.security.cert.CertificateExpiredException;
    Code:
       0: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
       3: ldc           #74                 // String Building certificate chain.
       5: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      10: iconst_3
      11: anewarray     #75                 // class java/security/cert/X509Certificate
      14: astore_1
      15: aload_1
      16: areturn

  public static boolean verifyKdcSan(java.lang.String, org.apache.kerby.kerberos.kerb.type.base.PrincipalName, java.util.List<org.apache.kerby.x509.type.Certificate>) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: aload_0
       1: ifnonnull     17
       4: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
       7: ldc           #76                 // String No pkinit_kdc_hostname values found in config file
       9: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      14: goto          27
      17: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      20: ldc           #77                 // String pkinit_kdc_hostname values found in config file
      22: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      27: aload_2
      28: invokestatic  #78                 // Method cryptoRetrieveCertSans:(Ljava/util/List;)Ljava/util/List;
      31: astore_3
      32: aload_3
      33: ifnull        144
      36: aload_3
      37: invokeinterface #79,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      42: astore        4
      44: aload         4
      46: invokeinterface #80,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      51: ifeq          100
      54: aload         4
      56: invokeinterface #81,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      61: checkcast     #82                 // class org/apache/kerby/kerberos/kerb/type/base/PrincipalName
      64: astore        5
      66: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      69: new           #24                 // class java/lang/StringBuilder
      72: dup
      73: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      76: ldc           #83                 // String PKINIT client found id-pkinit-san in KDC cert:
      78: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      81: aload         5
      83: invokevirtual #84                 // Method org/apache/kerby/kerberos/kerb/type/base/PrincipalName.getName:()Ljava/lang/String;
      86: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      89: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      92: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      97: goto          44
     100: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     103: ldc           #85                 // String Checking pkinit sans.
     105: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     110: aload_3
     111: aload_1
     112: invokeinterface #86,  2           // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
     117: ifeq          132
     120: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     123: ldc           #87                 // String pkinit san match found
     125: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     130: iconst_1
     131: ireturn
     132: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     135: ldc           #88                 // String no pkinit san match found
     137: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     142: iconst_0
     143: ireturn
     144: iconst_0
     145: ireturn
     146: astore_3
     147: new           #24                 // class java/lang/StringBuilder
     150: dup
     151: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
     154: ldc           #89                 // String PKINIT client failed to decode SANs in KDC cert.
     156: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     159: aload_3
     160: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     163: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     166: astore        4
     168: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     171: aload         4
     173: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     178: new           #3                  // class org/apache/kerby/kerberos/kerb/KrbException
     181: dup
     182: getstatic     #90                 // Field org/apache/kerby/kerberos/kerb/KrbErrorCode.KDC_NAME_MISMATCH:Lorg/apache/kerby/kerberos/kerb/KrbErrorCode;
     185: aload         4
     187: invokespecial #15                 // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Lorg/apache/kerby/kerberos/kerb/KrbErrorCode;Ljava/lang/String;)V
     190: athrow
    Exception table:
       from    to  target type
          27   131   146   Class org/apache/kerby/kerberos/kerb/KrbException
         132   143   146   Class org/apache/kerby/kerberos/kerb/KrbException
         144   145   146   Class org/apache/kerby/kerberos/kerb/KrbException

  public static java.util.List<org.apache.kerby.kerberos.kerb.type.base.PrincipalName> cryptoRetrieveCertSans(java.util.List<org.apache.kerby.x509.type.Certificate>) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: aload_0
       1: invokeinterface #91,  1           // InterfaceMethod java/util/List.size:()I
       6: ifne          21
       9: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      12: ldc           #92                 // String no certificate!
      14: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      19: aconst_null
      20: areturn
      21: aload_0
      22: invokestatic  #93                 // Method cryptoRetrieveX509Sans:(Ljava/util/List;)Ljava/util/List;
      25: areturn

  public static java.util.List<org.apache.kerby.kerberos.kerb.type.base.PrincipalName> cryptoRetrieveX509Sans(java.util.List<org.apache.kerby.x509.type.Certificate>) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: new           #94                 // class java/util/ArrayList
       3: dup
       4: invokespecial #95                 // Method java/util/ArrayList."<init>":()V
       7: astore_1
       8: aload_0
       9: invokeinterface #79,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      14: astore_2
      15: aload_2
      16: invokeinterface #80,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      21: ifeq          70
      24: aload_2
      25: invokeinterface #81,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      30: checkcast     #96                 // class org/apache/kerby/x509/type/Certificate
      33: astore_3
      34: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      37: new           #24                 // class java/lang/StringBuilder
      40: dup
      41: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      44: ldc           #97                 // String Looking for SANs in cert:
      46: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      49: aload_3
      50: invokevirtual #98                 // Method org/apache/kerby/x509/type/Certificate.getTBSCertificate:()Lorg/apache/kerby/x509/type/TBSCertificate;
      53: invokevirtual #99                 // Method org/apache/kerby/x509/type/TBSCertificate.getSubject:()Lorg/apache/kerby/x500/type/Name;
      56: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      59: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      62: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      67: goto          15
      70: aload_1
      71: areturn

  public static void validateChain(java.util.List<org.apache.kerby.x509.type.Certificate>, java.security.cert.X509Certificate) throws java.security.cert.CertificateException, java.security.NoSuchAlgorithmException, java.security.NoSuchProviderException, java.security.InvalidAlgorithmParameterException, java.security.cert.CertPathValidatorException, java.io.IOException;
    Code:
       0: ldc           #100                // String X.509
       2: invokestatic  #101                // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
       5: astore_2
       6: new           #94                 // class java/util/ArrayList
       9: dup
      10: aload_0
      11: invokeinterface #91,  1           // InterfaceMethod java/util/List.size:()I
      16: invokespecial #102                // Method java/util/ArrayList."<init>":(I)V
      19: astore_3
      20: aload_0
      21: invokeinterface #79,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      26: astore        4
      28: aload         4
      30: invokeinterface #80,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      35: ifeq          83
      38: aload         4
      40: invokeinterface #81,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      45: checkcast     #96                 // class org/apache/kerby/x509/type/Certificate
      48: astore        5
      50: aload_2
      51: new           #103                // class java/io/ByteArrayInputStream
      54: dup
      55: aload         5
      57: invokevirtual #104                // Method org/apache/kerby/x509/type/Certificate.encode:()[B
      60: invokespecial #105                // Method java/io/ByteArrayInputStream."<init>":([B)V
      63: invokevirtual #106                // Method java/security/cert/CertificateFactory.generateCertificate:(Ljava/io/InputStream;)Ljava/security/cert/Certificate;
      66: checkcast     #75                 // class java/security/cert/X509Certificate
      69: astore        6
      71: aload_3
      72: aload         6
      74: invokeinterface #107,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      79: pop
      80: goto          28
      83: aload_2
      84: aload_3
      85: invokevirtual #108                // Method java/security/cert/CertificateFactory.generateCertPath:(Ljava/util/List;)Ljava/security/cert/CertPath;
      88: astore        4
      90: ldc           #109                // String PKIX
      92: invokestatic  #110                // Method java/security/cert/CertPathValidator.getInstance:(Ljava/lang/String;)Ljava/security/cert/CertPathValidator;
      95: astore        5
      97: new           #111                // class java/security/cert/TrustAnchor
     100: dup
     101: aload_1
     102: aconst_null
     103: invokespecial #112                // Method java/security/cert/TrustAnchor."<init>":(Ljava/security/cert/X509Certificate;[B)V
     106: astore        6
     108: new           #113                // class java/security/cert/PKIXParameters
     111: dup
     112: aload         6
     114: invokestatic  #114                // Method java/util/Collections.singleton:(Ljava/lang/Object;)Ljava/util/Set;
     117: invokespecial #115                // Method java/security/cert/PKIXParameters."<init>":(Ljava/util/Set;)V
     120: astore        7
     122: aload         7
     124: iconst_0
     125: invokevirtual #116                // Method java/security/cert/PKIXParameters.setRevocationEnabled:(Z)V
     128: aload         5
     130: aload         4
     132: aload         7
     134: invokevirtual #117                // Method java/security/cert/CertPathValidator.validate:(Ljava/security/cert/CertPath;Ljava/security/cert/CertPathParameters;)Ljava/security/cert/CertPathValidatorResult;
     137: pop
     138: return

  public static org.apache.kerby.asn1.type.Asn1ObjectIdentifier createOid(java.lang.String) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: new           #118                // class org/apache/kerby/asn1/type/Asn1ObjectIdentifier
       3: dup
       4: invokespecial #119                // Method org/apache/kerby/asn1/type/Asn1ObjectIdentifier."<init>":()V
       7: astore_1
       8: aload_1
       9: invokevirtual #120                // Method org/apache/kerby/asn1/type/Asn1ObjectIdentifier.useDER:()V
      12: aload_0
      13: invokestatic  #121                // Method org/apache/kerby/util/HexUtil.hex2bytesFriendly:(Ljava/lang/String;)[B
      16: aload_1
      17: invokestatic  #122                // Method org/apache/kerby/kerberos/kerb/KrbCodec.decode:([BLorg/apache/kerby/asn1/type/Asn1Type;)V
      20: aload_1
      21: areturn

  public static org.apache.kerby.x509.type.Certificate changeToCertificate(java.security.cert.X509Certificate);
    Code:
       0: new           #96                 // class org/apache/kerby/x509/type/Certificate
       3: dup
       4: invokespecial #123                // Method org/apache/kerby/x509/type/Certificate."<init>":()V
       7: astore_1
       8: aload_1
       9: aload_0
      10: invokevirtual #124                // Method java/security/cert/X509Certificate.getEncoded:()[B
      13: invokevirtual #125                // Method org/apache/kerby/x509/type/Certificate.decode:([B)V
      16: goto          78
      19: astore_2
      20: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      23: new           #24                 // class java/lang/StringBuilder
      26: dup
      27: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      30: ldc           #127                // String Fail to decode certificate.
      32: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      35: aload_2
      36: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      39: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      42: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      47: goto          78
      50: astore_2
      51: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      54: new           #24                 // class java/lang/StringBuilder
      57: dup
      58: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      61: ldc           #129                // String Fail to encode x509 certificate.
      63: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      66: aload_2
      67: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      70: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      73: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      78: aload_1
      79: areturn
    Exception table:
       from    to  target type
           8    16    19   Class java/io/IOException
           8    16    50   Class java/security/cert/CertificateEncodingException

  static {};
    Code:
       0: ldc_w         #130                // class org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitCrypto
       3: invokestatic  #131                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
       9: return
}
