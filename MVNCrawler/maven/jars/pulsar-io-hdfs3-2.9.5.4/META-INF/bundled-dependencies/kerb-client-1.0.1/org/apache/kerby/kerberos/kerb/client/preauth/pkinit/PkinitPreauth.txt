Compiled from "PkinitPreauth.java"
public class org.apache.kerby.kerberos.kerb.client.preauth.pkinit.PkinitPreauth extends org.apache.kerby.kerberos.kerb.client.preauth.AbstractPreauthPlugin {
  private static final org.slf4j.Logger LOG;

  private org.apache.kerby.kerberos.kerb.client.preauth.pkinit.PkinitContext pkinitContext;

  public org.apache.kerby.kerberos.kerb.client.preauth.pkinit.PkinitPreauth();
    Code:
       0: aload_0
       1: new           #1                  // class org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitPreauthMeta
       4: dup
       5: invokespecial #2                  // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitPreauthMeta."<init>":()V
       8: invokespecial #3                  // Method org/apache/kerby/kerberos/kerb/client/preauth/AbstractPreauthPlugin."<init>":(Lorg/apache/kerby/kerberos/kerb/preauth/PreauthPluginMeta;)V
      11: return

  public void init(org.apache.kerby.kerberos.kerb.client.KrbContext);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #4                  // Method org/apache/kerby/kerberos/kerb/client/preauth/AbstractPreauthPlugin.init:(Lorg/apache/kerby/kerberos/kerb/client/KrbContext;)V
       5: aload_0
       6: new           #5                  // class org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext
       9: dup
      10: invokespecial #6                  // Method org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext."<init>":()V
      13: putfield      #7                  // Field pkinitContext:Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext;
      16: return

  public org.apache.kerby.kerberos.kerb.preauth.PluginRequestContext initRequestContext(org.apache.kerby.kerberos.kerb.client.request.KdcRequest);
    Code:
       0: new           #8                  // class org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext
       3: dup
       4: invokespecial #9                  // Method org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext."<init>":()V
       7: astore_2
       8: aload_2
       9: aload_0
      10: getfield      #7                  // Field pkinitContext:Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext;
      13: getfield      #10                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext.pluginOpts:Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts;
      16: invokevirtual #11                 // Method org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext.updateRequestOpts:(Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts;)V
      19: aload_2
      20: areturn

  public void setPreauthOptions(org.apache.kerby.kerberos.kerb.client.request.KdcRequest, org.apache.kerby.kerberos.kerb.preauth.PluginRequestContext, org.apache.kerby.KOptions);
    Code:
       0: aload_3
       1: getstatic     #12                 // Field org/apache/kerby/kerberos/kerb/client/PkinitOption.X509_IDENTITY:Lorg/apache/kerby/kerberos/kerb/client/PkinitOption;
       4: invokevirtual #13                 // Method org/apache/kerby/KOptions.contains:(Lorg/apache/kerby/KOption;)Z
       7: ifeq          27
      10: aload_0
      11: getfield      #7                  // Field pkinitContext:Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext;
      14: getfield      #14                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext.identityOpts:Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/IdentityOpts;
      17: aload_3
      18: getstatic     #12                 // Field org/apache/kerby/kerberos/kerb/client/PkinitOption.X509_IDENTITY:Lorg/apache/kerby/kerberos/kerb/client/PkinitOption;
      21: invokevirtual #15                 // Method org/apache/kerby/KOptions.getStringOption:(Lorg/apache/kerby/KOption;)Ljava/lang/String;
      24: putfield      #16                 // Field org/apache/kerby/kerberos/kerb/preauth/pkinit/IdentityOpts.identity:Ljava/lang/String;
      27: aload_3
      28: getstatic     #17                 // Field org/apache/kerby/kerberos/kerb/client/PkinitOption.X509_ANCHORS:Lorg/apache/kerby/kerberos/kerb/client/PkinitOption;
      31: invokevirtual #13                 // Method org/apache/kerby/KOptions.contains:(Lorg/apache/kerby/KOption;)Z
      34: ifeq          98
      37: aload_3
      38: getstatic     #17                 // Field org/apache/kerby/kerberos/kerb/client/PkinitOption.X509_ANCHORS:Lorg/apache/kerby/kerberos/kerb/client/PkinitOption;
      41: invokevirtual #15                 // Method org/apache/kerby/KOptions.getStringOption:(Lorg/apache/kerby/KOption;)Ljava/lang/String;
      44: astore        4
      46: aload         4
      48: ifnonnull     66
      51: aload_1
      52: invokevirtual #18                 // Method org/apache/kerby/kerberos/kerb/client/request/KdcRequest.getContext:()Lorg/apache/kerby/kerberos/kerb/client/KrbContext;
      55: invokevirtual #19                 // Method org/apache/kerby/kerberos/kerb/client/KrbContext.getConfig:()Lorg/apache/kerby/kerberos/kerb/client/KrbConfig;
      58: invokevirtual #20                 // Method org/apache/kerby/kerberos/kerb/client/KrbConfig.getPkinitAnchors:()Ljava/util/List;
      61: astore        5
      63: goto          80
      66: iconst_1
      67: anewarray     #21                 // class java/lang/String
      70: dup
      71: iconst_0
      72: aload         4
      74: aastore
      75: invokestatic  #22                 // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
      78: astore        5
      80: aload_0
      81: getfield      #7                  // Field pkinitContext:Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext;
      84: getfield      #14                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext.identityOpts:Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/IdentityOpts;
      87: getfield      #23                 // Field org/apache/kerby/kerberos/kerb/preauth/pkinit/IdentityOpts.anchors:Ljava/util/List;
      90: aload         5
      92: invokeinterface #24,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
      97: pop
      98: aload_3
      99: getstatic     #25                 // Field org/apache/kerby/kerberos/kerb/client/PkinitOption.USING_RSA:Lorg/apache/kerby/kerberos/kerb/client/PkinitOption;
     102: invokevirtual #13                 // Method org/apache/kerby/KOptions.contains:(Lorg/apache/kerby/KOption;)Z
     105: ifeq          129
     108: aload_0
     109: getfield      #7                  // Field pkinitContext:Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext;
     112: getfield      #10                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext.pluginOpts:Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts;
     115: aload_3
     116: getstatic     #25                 // Field org/apache/kerby/kerberos/kerb/client/PkinitOption.USING_RSA:Lorg/apache/kerby/kerberos/kerb/client/PkinitOption;
     119: iconst_1
     120: invokestatic  #26                 // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
     123: invokevirtual #27                 // Method org/apache/kerby/KOptions.getBooleanOption:(Lorg/apache/kerby/KOption;Ljava/lang/Boolean;)Z
     126: putfield      #28                 // Field org/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts.usingRsa:Z
     129: return

  public void prepareQuestions(org.apache.kerby.kerberos.kerb.client.request.KdcRequest, org.apache.kerby.kerberos.kerb.preauth.PluginRequestContext);
    Code:
       0: aload_2
       1: checkcast     #8                  // class org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext
       4: astore_3
       5: aload_3
       6: getfield      #29                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext.identityInitialized:Z
       9: ifne          28
      12: aload_3
      13: getfield      #30                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext.identityOpts:Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/IdentityOpts;
      16: aload_1
      17: invokevirtual #31                 // Method org/apache/kerby/kerberos/kerb/client/request/KdcRequest.getClientPrincipal:()Lorg/apache/kerby/kerberos/kerb/type/base/PrincipalName;
      20: invokestatic  #32                 // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitIdenity.initialize:(Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/IdentityOpts;Lorg/apache/kerby/kerberos/kerb/type/base/PrincipalName;)V
      23: aload_3
      24: iconst_1
      25: putfield      #29                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext.identityInitialized:Z
      28: return

  public void tryFirst(org.apache.kerby.kerberos.kerb.client.request.KdcRequest, org.apache.kerby.kerberos.kerb.preauth.PluginRequestContext, org.apache.kerby.kerberos.kerb.type.pa.PaData) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: aload_1
       1: invokevirtual #33                 // Method org/apache/kerby/kerberos/kerb/client/request/KdcRequest.getChosenNonce:()I
       4: istore        4
       6: invokestatic  #34                 // Method java/lang/System.currentTimeMillis:()J
       9: lstore        5
      11: invokestatic  #35                 // Method java/util/Calendar.getInstance:()Ljava/util/Calendar;
      14: astore        7
      16: aload         7
      18: new           #36                 // class java/util/Date
      21: dup
      22: lload         5
      24: invokespecial #37                 // Method java/util/Date."<init>":(J)V
      27: invokevirtual #38                 // Method java/util/Calendar.setTime:(Ljava/util/Date;)V
      30: aload         7
      32: bipush        13
      34: invokevirtual #39                 // Method java/util/Calendar.get:(I)I
      37: istore        8
      39: new           #40                 // class org/apache/kerby/kerberos/kerb/type/KerberosTime
      42: dup
      43: lload         5
      45: invokespecial #41                 // Method org/apache/kerby/kerberos/kerb/type/KerberosTime."<init>":(J)V
      48: astore        9
      50: aconst_null
      51: astore        10
      53: getstatic     #42                 // Field org/apache/kerby/kerberos/kerb/type/base/CheckSumType.NIST_SHA:Lorg/apache/kerby/kerberos/kerb/type/base/CheckSumType;
      56: aload_1
      57: invokevirtual #43                 // Method org/apache/kerby/kerberos/kerb/client/request/KdcRequest.getKdcReq:()Lorg/apache/kerby/kerberos/kerb/type/kdc/KdcReq;
      60: invokevirtual #44                 // Method org/apache/kerby/kerberos/kerb/type/kdc/KdcReq.getReqBody:()Lorg/apache/kerby/kerberos/kerb/type/kdc/KdcReqBody;
      63: invokestatic  #45                 // Method org/apache/kerby/kerberos/kerb/KrbCodec.encode:(Lorg/apache/kerby/asn1/type/Asn1Type;)[B
      66: invokestatic  #46                 // Method org/apache/kerby/kerberos/kerb/common/CheckSumUtil.makeCheckSum:(Lorg/apache/kerby/kerberos/kerb/type/base/CheckSumType;[B)Lorg/apache/kerby/kerberos/kerb/type/base/CheckSum;
      69: astore        10
      71: goto          88
      74: astore        11
      76: new           #47                 // class org/apache/kerby/kerberos/kerb/KrbException
      79: dup
      80: ldc           #48                 // String Fail to encode checksum.
      82: aload         11
      84: invokespecial #49                 // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      87: athrow
      88: aload_0
      89: aload_1
      90: aload_2
      91: checkcast     #8                  // class org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext
      94: iload         8
      96: aload         9
      98: iload         4
     100: aload         10
     102: invokespecial #50                 // Method makePaPkAsReq:(Lorg/apache/kerby/kerberos/kerb/client/request/KdcRequest;Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext;ILorg/apache/kerby/kerberos/kerb/type/KerberosTime;ILorg/apache/kerby/kerberos/kerb/type/base/CheckSum;)Lorg/apache/kerby/kerberos/kerb/type/pa/pkinit/PaPkAsReq;
     105: astore        11
     107: aload_3
     108: aload_0
     109: aload         11
     111: invokespecial #51                 // Method makeEntry:(Lorg/apache/kerby/kerberos/kerb/type/pa/pkinit/PaPkAsReq;)Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataEntry;
     114: invokevirtual #52                 // Method org/apache/kerby/kerberos/kerb/type/pa/PaData.addElement:(Lorg/apache/kerby/asn1/type/Asn1Type;)V
     117: return
    Exception table:
       from    to  target type
          53    71    74   Class org/apache/kerby/kerberos/kerb/KrbException

  public boolean process(org.apache.kerby.kerberos.kerb.client.request.KdcRequest, org.apache.kerby.kerberos.kerb.preauth.PluginRequestContext, org.apache.kerby.kerberos.kerb.type.pa.PaDataEntry, org.apache.kerby.kerberos.kerb.type.pa.PaData) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: aload_2
       1: checkcast     #8                  // class org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext
       4: astore        5
       6: aload_3
       7: ifnonnull     12
      10: iconst_0
      11: ireturn
      12: iconst_0
      13: istore        6
      15: getstatic     #53                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitPreauth$1.$SwitchMap$org$apache$kerby$kerberos$kerb$type$pa$PaDataType:[I
      18: aload_3
      19: invokevirtual #54                 // Method org/apache/kerby/kerberos/kerb/type/pa/PaDataEntry.getPaDataType:()Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataType;
      22: invokevirtual #55                 // Method org/apache/kerby/kerberos/kerb/type/pa/PaDataType.ordinal:()I
      25: iaload
      26: lookupswitch  { // 2
                     1: 52
                     2: 58
               default: 58
          }
      52: iconst_1
      53: istore        6
      55: goto          58
      58: iload         6
      60: ifeq          74
      63: aload_0
      64: aload         5
      66: aload_1
      67: aload         4
      69: invokespecial #56                 // Method generateRequest:(Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext;Lorg/apache/kerby/kerberos/kerb/client/request/KdcRequest;Lorg/apache/kerby/kerberos/kerb/type/pa/PaData;)V
      72: iconst_1
      73: ireturn
      74: aload_1
      75: invokevirtual #57                 // Method org/apache/kerby/kerberos/kerb/client/request/KdcRequest.getEncType:()Lorg/apache/kerby/kerberos/kerb/type/base/EncryptionType;
      78: astore        7
      80: aload_0
      81: aload_1
      82: aload         5
      84: aload_3
      85: aload         7
      87: invokespecial #58                 // Method processReply:(Lorg/apache/kerby/kerberos/kerb/client/request/KdcRequest;Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext;Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataEntry;Lorg/apache/kerby/kerberos/kerb/type/base/EncryptionType;)V
      90: iconst_1
      91: ireturn

  private void generateRequest(org.apache.kerby.kerberos.kerb.client.preauth.pkinit.PkinitRequestContext, org.apache.kerby.kerberos.kerb.client.request.KdcRequest, org.apache.kerby.kerberos.kerb.type.pa.PaData);
    Code:
       0: return

  private org.apache.kerby.kerberos.kerb.type.pa.pkinit.PaPkAsReq makePaPkAsReq(org.apache.kerby.kerberos.kerb.client.request.KdcRequest, org.apache.kerby.kerberos.kerb.client.preauth.pkinit.PkinitRequestContext, int, org.apache.kerby.kerberos.kerb.type.KerberosTime, int, org.apache.kerby.kerberos.kerb.type.base.CheckSum) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: aload_1
       1: astore        7
       3: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
       6: ldc           #60                 // String Making the PK_AS_REQ.
       8: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      13: new           #62                 // class org/apache/kerby/kerberos/kerb/type/pa/pkinit/PaPkAsReq
      16: dup
      17: invokespecial #63                 // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/PaPkAsReq."<init>":()V
      20: astore        8
      22: new           #64                 // class org/apache/kerby/kerberos/kerb/type/pa/pkinit/AuthPack
      25: dup
      26: invokespecial #65                 // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/AuthPack."<init>":()V
      29: astore        9
      31: new           #66                 // class org/apache/kerby/kerberos/kerb/type/pa/pkinit/PkAuthenticator
      34: dup
      35: invokespecial #67                 // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/PkAuthenticator."<init>":()V
      38: astore        10
      40: aload_0
      41: getfield      #7                  // Field pkinitContext:Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext;
      44: getfield      #10                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext.pluginOpts:Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts;
      47: getfield      #28                 // Field org/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts.usingRsa:Z
      50: istore        11
      52: aload_2
      53: getstatic     #68                 // Field org/apache/kerby/kerberos/kerb/type/pa/PaDataType.PK_AS_REQ:Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataType;
      56: putfield      #69                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext.paType:Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataType;
      59: aload         10
      61: iload_3
      62: invokevirtual #70                 // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/PkAuthenticator.setCusec:(I)V
      65: aload         10
      67: aload         4
      69: invokevirtual #71                 // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/PkAuthenticator.setCtime:(Lorg/apache/kerby/kerberos/kerb/type/KerberosTime;)V
      72: aload         10
      74: iload         5
      76: invokevirtual #72                 // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/PkAuthenticator.setNonce:(I)V
      79: aload         10
      81: aload         6
      83: invokevirtual #73                 // Method org/apache/kerby/kerberos/kerb/type/base/CheckSum.getChecksum:()[B
      86: invokevirtual #74                 // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/PkAuthenticator.setPaChecksum:([B)V
      89: aload         9
      91: aload         10
      93: invokevirtual #75                 // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/AuthPack.setPkAuthenticator:(Lorg/apache/kerby/kerberos/kerb/type/pa/pkinit/PkAuthenticator;)V
      96: aload         9
      98: aload_0
      99: getfield      #7                  // Field pkinitContext:Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext;
     102: getfield      #10                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext.pluginOpts:Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts;
     105: invokevirtual #76                 // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts.createSupportedCMSTypes:()Lorg/apache/kerby/kerberos/kerb/type/pa/pkinit/AlgorithmIdentifiers;
     108: invokevirtual #77                 // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/AuthPack.setsupportedCmsTypes:(Lorg/apache/kerby/kerberos/kerb/type/pa/pkinit/AlgorithmIdentifiers;)V
     111: iload         11
     113: ifne          386
     116: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     119: ldc           #78                 // String DH key transport algorithm.
     121: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     126: ldc           #79                 // String 0x06 07 2A 86 48 ce 3e 02 01
     128: astore        12
     130: aload         12
     132: invokestatic  #80                 // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitCrypto.createOid:(Ljava/lang/String;)Lorg/apache/kerby/asn1/type/Asn1ObjectIdentifier;
     135: astore        13
     137: new           #81                 // class org/apache/kerby/x509/type/AlgorithmIdentifier
     140: dup
     141: invokespecial #82                 // Method org/apache/kerby/x509/type/AlgorithmIdentifier."<init>":()V
     144: astore        14
     146: aload         14
     148: aload         13
     150: invokevirtual #83                 // Method org/apache/kerby/asn1/type/Asn1ObjectIdentifier.getValue:()Ljava/lang/Object;
     153: checkcast     #21                 // class java/lang/String
     156: invokevirtual #84                 // Method org/apache/kerby/x509/type/AlgorithmIdentifier.setAlgorithm:(Ljava/lang/String;)V
     159: new           #85                 // class org/apache/kerby/kerberos/kerb/crypto/dh/DiffieHellmanClient
     162: dup
     163: invokespecial #86                 // Method org/apache/kerby/kerberos/kerb/crypto/dh/DiffieHellmanClient."<init>":()V
     166: astore        15
     168: aconst_null
     169: astore        16
     171: aload         15
     173: getstatic     #87                 // Field org/apache/kerby/kerberos/kerb/crypto/dh/DhGroup.MODP_GROUP2:Ljavax/crypto/spec/DHParameterSpec;
     176: invokevirtual #88                 // Method org/apache/kerby/kerberos/kerb/crypto/dh/DiffieHellmanClient.init:(Ljavax/crypto/spec/DHParameterSpec;)Ljavax/crypto/interfaces/DHPublicKey;
     179: astore        16
     181: goto          214
     184: astore        17
     186: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     189: new           #90                 // class java/lang/StringBuilder
     192: dup
     193: invokespecial #91                 // Method java/lang/StringBuilder."<init>":()V
     196: ldc           #92                 // String DiffieHellmanClient init with failure.
     198: invokevirtual #93                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     201: aload         17
     203: invokevirtual #94                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     206: invokevirtual #95                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     209: invokeinterface #96,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     214: aload_2
     215: aload         15
     217: invokevirtual #97                 // Method org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext.setDhClient:(Lorg/apache/kerby/kerberos/kerb/crypto/dh/DiffieHellmanClient;)V
     220: aconst_null
     221: astore        17
     223: aload         16
     225: invokeinterface #98,  1           // InterfaceMethod javax/crypto/interfaces/DHPublicKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
     230: astore        17
     232: goto          265
     235: astore        18
     237: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     240: new           #90                 // class java/lang/StringBuilder
     243: dup
     244: invokespecial #91                 // Method java/lang/StringBuilder."<init>":()V
     247: ldc           #99                 // String Fail to get params from client public key.
     249: invokevirtual #93                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     252: aload         18
     254: invokevirtual #94                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     257: invokevirtual #95                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     260: invokeinterface #96,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     265: aload         17
     267: invokevirtual #100                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
     270: iconst_1
     271: invokevirtual #101                // Method java/math/BigInteger.shiftRight:(I)Ljava/math/BigInteger;
     274: astore        18
     276: new           #102                // class org/apache/kerby/x509/type/DhParameter
     279: dup
     280: invokespecial #103                // Method org/apache/kerby/x509/type/DhParameter."<init>":()V
     283: astore        19
     285: aload         19
     287: aload         17
     289: invokevirtual #100                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
     292: invokevirtual #104                // Method org/apache/kerby/x509/type/DhParameter.setP:(Ljava/math/BigInteger;)V
     295: aload         19
     297: aload         17
     299: invokevirtual #105                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
     302: invokevirtual #106                // Method org/apache/kerby/x509/type/DhParameter.setG:(Ljava/math/BigInteger;)V
     305: aload         19
     307: aload         18
     309: invokevirtual #107                // Method org/apache/kerby/x509/type/DhParameter.setQ:(Ljava/math/BigInteger;)V
     312: aload         14
     314: aload         19
     316: invokevirtual #108                // Method org/apache/kerby/x509/type/AlgorithmIdentifier.setParameters:(Lorg/apache/kerby/asn1/type/Asn1Type;)V
     319: new           #109                // class org/apache/kerby/x509/type/SubjectPublicKeyInfo
     322: dup
     323: invokespecial #110                // Method org/apache/kerby/x509/type/SubjectPublicKeyInfo."<init>":()V
     326: astore        20
     328: aload         20
     330: aload         14
     332: invokevirtual #111                // Method org/apache/kerby/x509/type/SubjectPublicKeyInfo.setAlgorithm:(Lorg/apache/kerby/x509/type/AlgorithmIdentifier;)V
     335: new           #112                // class org/apache/kerby/asn1/type/Asn1Integer
     338: dup
     339: aload         16
     341: invokeinterface #113,  1          // InterfaceMethod javax/crypto/interfaces/DHPublicKey.getY:()Ljava/math/BigInteger;
     346: invokespecial #114                // Method org/apache/kerby/asn1/type/Asn1Integer."<init>":(Ljava/math/BigInteger;)V
     349: astore        21
     351: aload         20
     353: aload         21
     355: invokestatic  #45                 // Method org/apache/kerby/kerberos/kerb/KrbCodec.encode:(Lorg/apache/kerby/asn1/type/Asn1Type;)[B
     358: invokevirtual #115                // Method org/apache/kerby/x509/type/SubjectPublicKeyInfo.setSubjectPubKey:([B)V
     361: aload         9
     363: aload         20
     365: invokevirtual #116                // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/AuthPack.setClientPublicValue:(Lorg/apache/kerby/x509/type/SubjectPublicKeyInfo;)V
     368: aload_0
     369: aload         9
     371: invokespecial #117                // Method signAuthPack:(Lorg/apache/kerby/kerberos/kerb/type/pa/pkinit/AuthPack;)[B
     374: astore        22
     376: aload         8
     378: aload         22
     380: invokevirtual #118                // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/PaPkAsReq.setSignedAuthPack:([B)V
     383: goto          396
     386: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     389: ldc           #119                // String RSA key transport algorithm
     391: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     396: aload_0
     397: getfield      #7                  // Field pkinitContext:Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext;
     400: getfield      #10                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitContext.pluginOpts:Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts;
     403: invokevirtual #120                // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PluginOpts.createTrustedCertifiers:()Lorg/apache/kerby/kerberos/kerb/type/pa/pkinit/TrustedCertifiers;
     406: astore        12
     408: aload         8
     410: aload         12
     412: invokevirtual #121                // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/PaPkAsReq.setTrustedCertifiers:(Lorg/apache/kerby/kerberos/kerb/type/pa/pkinit/TrustedCertifiers;)V
     415: aload         8
     417: areturn
    Exception table:
       from    to  target type
         171   181   184   Class java/lang/Exception
         223   232   235   Class java/lang/Exception

  private byte[] signAuthPack(org.apache.kerby.kerberos.kerb.type.pa.pkinit.AuthPack) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: invokestatic  #122                // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitPlgCryptoContext.getIdPkinitAuthDataOID:()Ljava/lang/String;
       3: astore_2
       4: aload_1
       5: invokestatic  #45                 // Method org/apache/kerby/kerberos/kerb/KrbCodec.encode:(Lorg/apache/kerby/asn1/type/Asn1Type;)[B
       8: aload_2
       9: invokestatic  #123                // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitCrypto.eContentInfoCreate:([BLjava/lang/String;)[B
      12: astore_3
      13: aload_3
      14: areturn

  private void processReply(org.apache.kerby.kerberos.kerb.client.request.KdcRequest, org.apache.kerby.kerberos.kerb.client.preauth.pkinit.PkinitRequestContext, org.apache.kerby.kerberos.kerb.type.pa.PaDataEntry, org.apache.kerby.kerberos.kerb.type.base.EncryptionType) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: aload_3
       1: invokevirtual #54                 // Method org/apache/kerby/kerberos/kerb/type/pa/PaDataEntry.getPaDataType:()Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataType;
       4: getstatic     #124                // Field org/apache/kerby/kerberos/kerb/type/pa/PaDataType.PK_AS_REP:Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataType;
       7: if_acmpne     695
      10: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
      13: ldc           #125                // String processing PK_AS_REP
      15: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      20: aload_3
      21: invokevirtual #126                // Method org/apache/kerby/kerberos/kerb/type/pa/PaDataEntry.getPaDataValue:()[B
      24: ldc_w         #127                // class org/apache/kerby/kerberos/kerb/type/pa/pkinit/PaPkAsRep
      27: invokestatic  #128                // Method org/apache/kerby/kerberos/kerb/KrbCodec.decode:([BLjava/lang/Class;)Lorg/apache/kerby/asn1/type/Asn1Type;
      30: checkcast     #127                // class org/apache/kerby/kerberos/kerb/type/pa/pkinit/PaPkAsRep
      33: astore        5
      35: aload         5
      37: invokevirtual #129                // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/PaPkAsRep.getDHRepInfo:()Lorg/apache/kerby/kerberos/kerb/type/pa/pkinit/DhRepInfo;
      40: astore        6
      42: aload         6
      44: invokevirtual #130                // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/DhRepInfo.getDHSignedData:()[B
      47: astore        7
      49: new           #131                // class org/apache/kerby/cms/type/ContentInfo
      52: dup
      53: invokespecial #132                // Method org/apache/kerby/cms/type/ContentInfo."<init>":()V
      56: astore        8
      58: aload         8
      60: aload         7
      62: invokevirtual #133                // Method org/apache/kerby/cms/type/ContentInfo.decode:([B)V
      65: goto          98
      68: astore        9
      70: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
      73: new           #90                 // class java/lang/StringBuilder
      76: dup
      77: invokespecial #91                 // Method java/lang/StringBuilder."<init>":()V
      80: ldc           #135                // String Fail to decode dhSignedData.
      82: invokevirtual #93                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      85: aload         9
      87: invokevirtual #94                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      90: invokevirtual #95                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      93: invokeinterface #96,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      98: aload         8
     100: ldc_w         #136                // class org/apache/kerby/cms/type/SignedData
     103: invokevirtual #137                // Method org/apache/kerby/cms/type/ContentInfo.getContentAs:(Ljava/lang/Class;)Lorg/apache/kerby/asn1/type/Asn1Type;
     106: checkcast     #136                // class org/apache/kerby/cms/type/SignedData
     109: astore        9
     111: getstatic     #138                // Field org/apache/kerby/kerberos/kerb/preauth/pkinit/CmsMessageType.CMS_SIGN_SERVER:Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/CmsMessageType;
     114: aload         9
     116: invokestatic  #139                // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitCrypto.verifyCmsSignedData:(Lorg/apache/kerby/kerberos/kerb/preauth/pkinit/CmsMessageType;Lorg/apache/kerby/cms/type/SignedData;)V
     119: aload_1
     120: invokevirtual #18                 // Method org/apache/kerby/kerberos/kerb/client/request/KdcRequest.getContext:()Lorg/apache/kerby/kerberos/kerb/client/KrbContext;
     123: invokevirtual #19                 // Method org/apache/kerby/kerberos/kerb/client/KrbContext.getConfig:()Lorg/apache/kerby/kerberos/kerb/client/KrbConfig;
     126: invokevirtual #20                 // Method org/apache/kerby/kerberos/kerb/client/KrbConfig.getPkinitAnchors:()Ljava/util/List;
     129: invokeinterface #140,  1          // InterfaceMethod java/util/List.isEmpty:()Z
     134: ifeq          157
     137: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     140: ldc           #141                // String No PKINIT anchors specified
     142: invokeinterface #96,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     147: new           #47                 // class org/apache/kerby/kerberos/kerb/KrbException
     150: dup
     151: ldc           #141                // String No PKINIT anchors specified
     153: invokespecial #142                // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Ljava/lang/String;)V
     156: athrow
     157: aload_1
     158: invokevirtual #18                 // Method org/apache/kerby/kerberos/kerb/client/request/KdcRequest.getContext:()Lorg/apache/kerby/kerberos/kerb/client/KrbContext;
     161: invokevirtual #19                 // Method org/apache/kerby/kerberos/kerb/client/KrbContext.getConfig:()Lorg/apache/kerby/kerberos/kerb/client/KrbConfig;
     164: invokevirtual #20                 // Method org/apache/kerby/kerberos/kerb/client/KrbConfig.getPkinitAnchors:()Ljava/util/List;
     167: iconst_0
     168: invokeinterface #143,  2          // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     173: checkcast     #21                 // class java/lang/String
     176: astore        10
     178: aconst_null
     179: astore        11
     181: aload         10
     183: invokestatic  #144                // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/CertificateHelper.loadCerts:(Ljava/lang/String;)Ljava/util/List;
     186: astore        12
     188: aload         12
     190: ifnull        220
     193: aload         12
     195: invokeinterface #140,  1          // InterfaceMethod java/util/List.isEmpty:()Z
     200: ifne          220
     203: aload         12
     205: invokeinterface #145,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     210: invokeinterface #146,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     215: checkcast     #147                // class java/security/cert/X509Certificate
     218: astore        11
     220: goto          253
     223: astore        12
     225: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     228: new           #90                 // class java/lang/StringBuilder
     231: dup
     232: invokespecial #91                 // Method java/lang/StringBuilder."<init>":()V
     235: ldc           #148                // String Fail to load certs from archor file.
     237: invokevirtual #93                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     240: aload         12
     242: invokevirtual #94                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     245: invokevirtual #95                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     248: invokeinterface #96,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     253: aload         11
     255: ifnonnull     278
     258: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     261: ldc           #149                // String Failed to load PKINIT anchor
     263: invokeinterface #96,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     268: new           #47                 // class org/apache/kerby/kerberos/kerb/KrbException
     271: dup
     272: ldc           #149                // String Failed to load PKINIT anchor
     274: invokespecial #142                // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Ljava/lang/String;)V
     277: athrow
     278: aload         9
     280: invokevirtual #150                // Method org/apache/kerby/cms/type/SignedData.getCertificates:()Lorg/apache/kerby/cms/type/CertificateSet;
     283: astore        12
     285: aload         12
     287: ifnull        303
     290: aload         12
     292: invokevirtual #151                // Method org/apache/kerby/cms/type/CertificateSet.getElements:()Ljava/util/List;
     295: invokeinterface #140,  1          // InterfaceMethod java/util/List.isEmpty:()Z
     300: ifeq          313
     303: new           #47                 // class org/apache/kerby/kerberos/kerb/KrbException
     306: dup
     307: ldc           #152                // String No PKINIT Certs
     309: invokespecial #142                // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Ljava/lang/String;)V
     312: athrow
     313: new           #153                // class java/util/ArrayList
     316: dup
     317: invokespecial #154                // Method java/util/ArrayList."<init>":()V
     320: astore        13
     322: aload         12
     324: invokevirtual #151                // Method org/apache/kerby/cms/type/CertificateSet.getElements:()Ljava/util/List;
     327: astore        14
     329: aload         14
     331: invokeinterface #155,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     336: astore        15
     338: aload         15
     340: invokeinterface #156,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     345: ifeq          376
     348: aload         15
     350: invokeinterface #146,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     355: checkcast     #157                // class org/apache/kerby/cms/type/CertificateChoices
     358: astore        16
     360: aload         13
     362: aload         16
     364: invokevirtual #158                // Method org/apache/kerby/cms/type/CertificateChoices.getCertificate:()Lorg/apache/kerby/x509/type/Certificate;
     367: invokeinterface #159,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     372: pop
     373: goto          338
     376: aload         13
     378: aload         11
     380: invokestatic  #160                // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitCrypto.validateChain:(Ljava/util/List;Ljava/security/cert/X509Certificate;)V
     383: goto          401
     386: astore        15
     388: new           #47                 // class org/apache/kerby/kerberos/kerb/KrbException
     391: dup
     392: getstatic     #161                // Field org/apache/kerby/kerberos/kerb/KrbErrorCode.KDC_ERR_INVALID_CERTIFICATE:Lorg/apache/kerby/kerberos/kerb/KrbErrorCode;
     395: aload         15
     397: invokespecial #162                // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Lorg/apache/kerby/kerberos/kerb/KrbErrorCode;Ljava/lang/Throwable;)V
     400: athrow
     401: aload_1
     402: invokevirtual #18                 // Method org/apache/kerby/kerberos/kerb/client/request/KdcRequest.getContext:()Lorg/apache/kerby/kerberos/kerb/client/KrbContext;
     405: invokevirtual #19                 // Method org/apache/kerby/kerberos/kerb/client/KrbContext.getConfig:()Lorg/apache/kerby/kerberos/kerb/client/KrbConfig;
     408: invokevirtual #163                // Method org/apache/kerby/kerberos/kerb/client/KrbConfig.getKdcRealm:()Ljava/lang/String;
     411: invokestatic  #164                // Method org/apache/kerby/kerberos/kerb/common/KrbUtil.makeTgsPrincipal:(Ljava/lang/String;)Lorg/apache/kerby/kerberos/kerb/type/base/PrincipalName;
     414: astore        15
     416: aload_1
     417: invokevirtual #18                 // Method org/apache/kerby/kerberos/kerb/client/request/KdcRequest.getContext:()Lorg/apache/kerby/kerberos/kerb/client/KrbContext;
     420: invokevirtual #19                 // Method org/apache/kerby/kerberos/kerb/client/KrbContext.getConfig:()Lorg/apache/kerby/kerberos/kerb/client/KrbConfig;
     423: invokevirtual #165                // Method org/apache/kerby/kerberos/kerb/client/KrbConfig.getPkinitKdcHostName:()Ljava/lang/String;
     426: aload         15
     428: aload         13
     430: invokestatic  #166                // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitCrypto.verifyKdcSan:(Ljava/lang/String;Lorg/apache/kerby/kerberos/kerb/type/base/PrincipalName;Ljava/util/List;)Z
     433: istore        16
     435: iload         16
     437: ifne          450
     440: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     443: ldc           #167                // String Did not find an acceptable SAN in KDC certificate
     445: invokeinterface #96,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     450: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     453: ldc           #168                // String skipping EKU check
     455: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     460: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     463: ldc           #169                // String as_rep: DH key transport algorithm
     465: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     470: new           #170                // class org/apache/kerby/kerberos/kerb/type/pa/pkinit/KdcDhKeyInfo
     473: dup
     474: invokespecial #171                // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/KdcDhKeyInfo."<init>":()V
     477: astore        17
     479: aload         17
     481: aload         9
     483: invokevirtual #172                // Method org/apache/kerby/cms/type/SignedData.getEncapContentInfo:()Lorg/apache/kerby/cms/type/EncapsulatedContentInfo;
     486: invokevirtual #173                // Method org/apache/kerby/cms/type/EncapsulatedContentInfo.getContent:()[B
     489: invokevirtual #174                // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/KdcDhKeyInfo.decode:([B)V
     492: goto          542
     495: astore        18
     497: new           #90                 // class java/lang/StringBuilder
     500: dup
     501: invokespecial #91                 // Method java/lang/StringBuilder."<init>":()V
     504: ldc           #175                // String failed to decode KdcDhKeyInfo
     506: invokevirtual #93                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     509: aload         18
     511: invokevirtual #176                // Method java/io/IOException.getMessage:()Ljava/lang/String;
     514: invokevirtual #93                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     517: invokevirtual #95                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     520: astore        19
     522: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     525: aload         19
     527: invokeinterface #96,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     532: new           #47                 // class org/apache/kerby/kerberos/kerb/KrbException
     535: dup
     536: aload         19
     538: invokespecial #142                // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Ljava/lang/String;)V
     541: athrow
     542: aload         17
     544: invokevirtual #177                // Method org/apache/kerby/kerberos/kerb/type/pa/pkinit/KdcDhKeyInfo.getSubjectPublicKey:()Lorg/apache/kerby/asn1/type/Asn1BitString;
     547: invokevirtual #178                // Method org/apache/kerby/asn1/type/Asn1BitString.getValue:()Ljava/lang/Object;
     550: checkcast     #179                // class "[B"
     553: astore        18
     555: aload         18
     557: ldc_w         #112                // class org/apache/kerby/asn1/type/Asn1Integer
     560: invokestatic  #128                // Method org/apache/kerby/kerberos/kerb/KrbCodec.decode:([BLjava/lang/Class;)Lorg/apache/kerby/asn1/type/Asn1Type;
     563: checkcast     #112                // class org/apache/kerby/asn1/type/Asn1Integer
     566: astore        19
     568: aload         19
     570: invokevirtual #180                // Method org/apache/kerby/asn1/type/Asn1Integer.getValue:()Ljava/lang/Object;
     573: checkcast     #181                // class java/math/BigInteger
     576: astore        20
     578: aload_2
     579: invokevirtual #182                // Method org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext.getDhClient:()Lorg/apache/kerby/kerberos/kerb/crypto/dh/DiffieHellmanClient;
     582: astore        21
     584: aload         21
     586: invokevirtual #183                // Method org/apache/kerby/kerberos/kerb/crypto/dh/DiffieHellmanClient.getDhParam:()Ljavax/crypto/spec/DHParameterSpec;
     589: invokevirtual #100                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
     592: astore        22
     594: aload         21
     596: invokevirtual #183                // Method org/apache/kerby/kerberos/kerb/crypto/dh/DiffieHellmanClient.getDhParam:()Ljavax/crypto/spec/DHParameterSpec;
     599: invokevirtual #105                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
     602: astore        23
     604: aload         22
     606: aload         23
     608: aload         20
     610: invokestatic  #184                // Method org/apache/kerby/kerberos/kerb/preauth/pkinit/PkinitCrypto.createDHPublicKey:(Ljava/math/BigInteger;Ljava/math/BigInteger;Ljava/math/BigInteger;)Ljavax/crypto/interfaces/DHPublicKey;
     613: astore        24
     615: aconst_null
     616: astore        25
     618: aload         21
     620: aload         24
     622: invokeinterface #185,  1          // InterfaceMethod javax/crypto/interfaces/DHPublicKey.getEncoded:()[B
     627: invokevirtual #186                // Method org/apache/kerby/kerberos/kerb/crypto/dh/DiffieHellmanClient.doPhase:([B)V
     630: aload         21
     632: aconst_null
     633: aconst_null
     634: aload         4
     636: invokevirtual #187                // Method org/apache/kerby/kerberos/kerb/crypto/dh/DiffieHellmanClient.generateKey:([B[BLorg/apache/kerby/kerberos/kerb/type/base/EncryptionType;)Lorg/apache/kerby/kerberos/kerb/type/base/EncryptionKey;
     639: astore        25
     641: goto          674
     644: astore        26
     646: getstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
     649: new           #90                 // class java/lang/StringBuilder
     652: dup
     653: invokespecial #91                 // Method java/lang/StringBuilder."<init>":()V
     656: ldc           #188                // String DiffieHellmanClient do parse failed.
     658: invokevirtual #93                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     661: aload         26
     663: invokevirtual #94                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     666: invokevirtual #95                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     669: invokeinterface #96,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     674: aload         25
     676: ifnonnull     689
     679: new           #47                 // class org/apache/kerby/kerberos/kerb/KrbException
     682: dup
     683: ldc           #189                // String Fail to create client key.
     685: invokespecial #142                // Method org/apache/kerby/kerberos/kerb/KrbException."<init>":(Ljava/lang/String;)V
     688: athrow
     689: aload_1
     690: aload         25
     692: invokevirtual #190                // Method org/apache/kerby/kerberos/kerb/client/request/KdcRequest.setAsKey:(Lorg/apache/kerby/kerberos/kerb/type/base/EncryptionKey;)V
     695: return
    Exception table:
       from    to  target type
          58    65    68   Class java/io/IOException
         181   220   223   Class org/apache/kerby/kerberos/kerb/KrbException
         376   383   386   Class java/lang/Exception
         479   492   495   Class java/io/IOException
         618   641   644   Class java/lang/Exception

  public boolean tryAgain(org.apache.kerby.kerberos.kerb.client.request.KdcRequest, org.apache.kerby.kerberos.kerb.preauth.PluginRequestContext, org.apache.kerby.kerberos.kerb.type.pa.PaDataType, org.apache.kerby.kerberos.kerb.type.pa.PaData, org.apache.kerby.kerberos.kerb.type.pa.PaData);
    Code:
       0: aload_2
       1: checkcast     #8                  // class org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext
       4: astore        6
       6: aload         6
       8: getfield      #69                 // Field org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext.paType:Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataType;
      11: aload_3
      12: if_acmpeq     22
      15: aload         4
      17: ifnonnull     22
      20: iconst_0
      21: ireturn
      22: iconst_0
      23: istore        7
      25: aload         4
      27: invokevirtual #191                // Method org/apache/kerby/kerberos/kerb/type/pa/PaData.getElements:()Ljava/util/List;
      30: invokeinterface #155,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      35: astore        8
      37: aload         8
      39: invokeinterface #156,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      44: ifeq          73
      47: aload         8
      49: invokeinterface #146,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      54: checkcast     #192                // class org/apache/kerby/kerberos/kerb/type/pa/PaDataEntry
      57: astore        9
      59: getstatic     #193                // Field java/lang/System.out:Ljava/io/PrintStream;
      62: aload         9
      64: invokevirtual #54                 // Method org/apache/kerby/kerberos/kerb/type/pa/PaDataEntry.getPaDataType:()Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataType;
      67: invokevirtual #194                // Method java/io/PrintStream.println:(Ljava/lang/Object;)V
      70: goto          37
      73: iload         7
      75: ifeq          87
      78: aload_0
      79: aload         6
      81: aload_1
      82: aload         5
      84: invokespecial #56                 // Method generateRequest:(Lorg/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitRequestContext;Lorg/apache/kerby/kerberos/kerb/client/request/KdcRequest;Lorg/apache/kerby/kerberos/kerb/type/pa/PaData;)V
      87: iconst_0
      88: ireturn

  public org.apache.kerby.kerberos.kerb.preauth.PaFlags getFlags(org.apache.kerby.kerberos.kerb.type.pa.PaDataType);
    Code:
       0: new           #195                // class org/apache/kerby/kerberos/kerb/preauth/PaFlags
       3: dup
       4: iconst_0
       5: invokespecial #196                // Method org/apache/kerby/kerberos/kerb/preauth/PaFlags."<init>":(I)V
       8: astore_2
       9: aload_2
      10: getstatic     #197                // Field org/apache/kerby/kerberos/kerb/preauth/PaFlag.PA_REAL:Lorg/apache/kerby/kerberos/kerb/preauth/PaFlag;
      13: invokevirtual #198                // Method org/apache/kerby/kerberos/kerb/preauth/PaFlags.setFlag:(Lorg/apache/kerby/asn1/EnumType;)V
      16: aload_2
      17: areturn

  private org.apache.kerby.kerberos.kerb.type.pa.PaDataEntry makeEntry(org.apache.kerby.kerberos.kerb.type.pa.pkinit.PaPkAsReq) throws org.apache.kerby.kerberos.kerb.KrbException;
    Code:
       0: new           #192                // class org/apache/kerby/kerberos/kerb/type/pa/PaDataEntry
       3: dup
       4: invokespecial #199                // Method org/apache/kerby/kerberos/kerb/type/pa/PaDataEntry."<init>":()V
       7: astore_2
       8: aload_2
       9: getstatic     #68                 // Field org/apache/kerby/kerberos/kerb/type/pa/PaDataType.PK_AS_REQ:Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataType;
      12: invokevirtual #200                // Method org/apache/kerby/kerberos/kerb/type/pa/PaDataEntry.setPaDataType:(Lorg/apache/kerby/kerberos/kerb/type/pa/PaDataType;)V
      15: aload_2
      16: aload_1
      17: invokestatic  #45                 // Method org/apache/kerby/kerberos/kerb/KrbCodec.encode:(Lorg/apache/kerby/asn1/type/Asn1Type;)[B
      20: invokevirtual #201                // Method org/apache/kerby/kerberos/kerb/type/pa/PaDataEntry.setPaDataValue:([B)V
      23: aload_2
      24: areturn

  static {};
    Code:
       0: ldc_w         #202                // class org/apache/kerby/kerberos/kerb/client/preauth/pkinit/PkinitPreauth
       3: invokestatic  #203                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #59                 // Field LOG:Lorg/slf4j/Logger;
       9: return
}
