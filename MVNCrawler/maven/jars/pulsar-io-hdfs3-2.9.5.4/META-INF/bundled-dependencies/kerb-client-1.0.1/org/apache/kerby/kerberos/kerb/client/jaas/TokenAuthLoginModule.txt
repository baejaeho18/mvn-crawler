Compiled from "TokenAuthLoginModule.java"
public class org.apache.kerby.kerberos.kerb.client.jaas.TokenAuthLoginModule implements javax.security.auth.spi.LoginModule {
  public static final java.lang.String PRINCIPAL;

  public static final java.lang.String TOKEN;

  public static final java.lang.String TOKEN_CACHE;

  public static final java.lang.String ARMOR_CACHE;

  public static final java.lang.String CREDENTIAL_CACHE;

  public static final java.lang.String SIGN_KEY_FILE;

  private static final org.slf4j.Logger LOG;

  private javax.security.auth.Subject subject;

  private java.lang.String tokenCacheName;

  private boolean succeeded;

  private boolean commitSucceeded;

  private java.lang.String princName;

  private java.lang.String tokenStr;

  private org.apache.kerby.kerberos.kerb.type.base.AuthToken authToken;

  private org.apache.kerby.kerberos.kerb.type.base.KrbToken krbToken;

  private java.io.File armorCache;

  private java.io.File cCache;

  private java.io.File signKeyFile;

  private org.apache.kerby.kerberos.kerb.type.ticket.TgtTicket tgtTicket;

  public org.apache.kerby.kerberos.kerb.client.jaas.TokenAuthLoginModule();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #2                  // Field tokenCacheName:Ljava/lang/String;
       9: aload_0
      10: iconst_0
      11: putfield      #3                  // Field succeeded:Z
      14: aload_0
      15: iconst_0
      16: putfield      #4                  // Field commitSucceeded:Z
      19: aload_0
      20: aconst_null
      21: putfield      #5                  // Field princName:Ljava/lang/String;
      24: aload_0
      25: aconst_null
      26: putfield      #6                  // Field tokenStr:Ljava/lang/String;
      29: aload_0
      30: aconst_null
      31: putfield      #7                  // Field authToken:Lorg/apache/kerby/kerberos/kerb/type/base/AuthToken;
      34: aload_0
      35: aconst_null
      36: putfield      #8                  // Field krbToken:Lorg/apache/kerby/kerberos/kerb/type/base/KrbToken;
      39: return

  public void initialize(javax.security.auth.Subject, javax.security.auth.callback.CallbackHandler, java.util.Map<java.lang.String, ?>, java.util.Map<java.lang.String, ?>);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #9                  // Field subject:Ljavax/security/auth/Subject;
       5: aload_0
       6: aload         4
       8: ldc           #10                 // String principal
      10: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      15: checkcast     #12                 // class java/lang/String
      18: putfield      #5                  // Field princName:Ljava/lang/String;
      21: aload_0
      22: aload         4
      24: ldc           #13                 // String token
      26: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      31: checkcast     #12                 // class java/lang/String
      34: putfield      #6                  // Field tokenStr:Ljava/lang/String;
      37: aload_0
      38: aload         4
      40: ldc           #14                 // String tokenCache
      42: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      47: checkcast     #12                 // class java/lang/String
      50: putfield      #2                  // Field tokenCacheName:Ljava/lang/String;
      53: aload         4
      55: ldc           #15                 // String armorCache
      57: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      62: checkcast     #12                 // class java/lang/String
      65: ifnull        91
      68: aload_0
      69: new           #16                 // class java/io/File
      72: dup
      73: aload         4
      75: ldc           #15                 // String armorCache
      77: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      82: checkcast     #12                 // class java/lang/String
      85: invokespecial #17                 // Method java/io/File."<init>":(Ljava/lang/String;)V
      88: putfield      #18                 // Field armorCache:Ljava/io/File;
      91: aload         4
      93: ldc           #19                 // String credentialCache
      95: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     100: checkcast     #12                 // class java/lang/String
     103: ifnull        129
     106: aload_0
     107: new           #16                 // class java/io/File
     110: dup
     111: aload         4
     113: ldc           #19                 // String credentialCache
     115: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     120: checkcast     #12                 // class java/lang/String
     123: invokespecial #17                 // Method java/io/File."<init>":(Ljava/lang/String;)V
     126: putfield      #20                 // Field cCache:Ljava/io/File;
     129: aload         4
     131: ldc           #21                 // String signKeyFile
     133: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     138: checkcast     #12                 // class java/lang/String
     141: ifnull        167
     144: aload_0
     145: new           #16                 // class java/io/File
     148: dup
     149: aload         4
     151: ldc           #21                 // String signKeyFile
     153: invokeinterface #11,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     158: checkcast     #12                 // class java/lang/String
     161: invokespecial #17                 // Method java/io/File."<init>":(Ljava/lang/String;)V
     164: putfield      #22                 // Field signKeyFile:Ljava/io/File;
     167: return

  public boolean login() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: invokespecial #23                 // Method validateConfiguration:()V
       4: aload_0
       5: aload_0
       6: invokespecial #24                 // Method tokenLogin:()Z
       9: putfield      #3                  // Field succeeded:Z
      12: aload_0
      13: getfield      #3                  // Field succeeded:Z
      16: ireturn

  public boolean commit() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #3                  // Field succeeded:Z
       4: ifne          9
       7: iconst_0
       8: ireturn
       9: aconst_null
      10: astore_1
      11: aload_0
      12: getfield      #25                 // Field tgtTicket:Lorg/apache/kerby/kerberos/kerb/type/ticket/TgtTicket;
      15: invokevirtual #26                 // Method org/apache/kerby/kerberos/kerb/type/ticket/TgtTicket.getEncKdcRepPart:()Lorg/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart;
      18: astore_2
      19: bipush        7
      21: newarray       boolean
      23: astore_3
      24: aload_2
      25: invokevirtual #27                 // Method org/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart.getFlags:()Lorg/apache/kerby/kerberos/kerb/type/ticket/TicketFlags;
      28: invokevirtual #28                 // Method org/apache/kerby/kerberos/kerb/type/ticket/TicketFlags.getFlags:()I
      31: istore        4
      33: bipush        6
      35: istore        5
      37: iload         5
      39: iflt          67
      42: aload_3
      43: iload         5
      45: iload         4
      47: iconst_1
      48: iload         5
      50: ishl
      51: iand
      52: ifeq          59
      55: iconst_1
      56: goto          60
      59: iconst_0
      60: bastore
      61: iinc          5, -1
      64: goto          37
      67: aconst_null
      68: astore        5
      70: aload_2
      71: invokevirtual #29                 // Method org/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart.getStartTime:()Lorg/apache/kerby/kerberos/kerb/type/KerberosTime;
      74: ifnull        89
      77: aload_2
      78: invokevirtual #29                 // Method org/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart.getStartTime:()Lorg/apache/kerby/kerberos/kerb/type/KerberosTime;
      81: invokevirtual #30                 // Method org/apache/kerby/kerberos/kerb/type/KerberosTime.getValue:()Ljava/lang/Object;
      84: checkcast     #31                 // class java/util/Date
      87: astore        5
      89: new           #32                 // class javax/security/auth/kerberos/KerberosTicket
      92: dup
      93: aload_0
      94: getfield      #25                 // Field tgtTicket:Lorg/apache/kerby/kerberos/kerb/type/ticket/TgtTicket;
      97: invokevirtual #33                 // Method org/apache/kerby/kerberos/kerb/type/ticket/TgtTicket.getTicket:()Lorg/apache/kerby/kerberos/kerb/type/ticket/Ticket;
     100: invokevirtual #34                 // Method org/apache/kerby/kerberos/kerb/type/ticket/Ticket.encode:()[B
     103: new           #35                 // class javax/security/auth/kerberos/KerberosPrincipal
     106: dup
     107: aload_0
     108: getfield      #25                 // Field tgtTicket:Lorg/apache/kerby/kerberos/kerb/type/ticket/TgtTicket;
     111: invokevirtual #36                 // Method org/apache/kerby/kerberos/kerb/type/ticket/TgtTicket.getClientPrincipal:()Lorg/apache/kerby/kerberos/kerb/type/base/PrincipalName;
     114: invokevirtual #37                 // Method org/apache/kerby/kerberos/kerb/type/base/PrincipalName.getName:()Ljava/lang/String;
     117: invokespecial #38                 // Method javax/security/auth/kerberos/KerberosPrincipal."<init>":(Ljava/lang/String;)V
     120: new           #35                 // class javax/security/auth/kerberos/KerberosPrincipal
     123: dup
     124: aload_0
     125: getfield      #25                 // Field tgtTicket:Lorg/apache/kerby/kerberos/kerb/type/ticket/TgtTicket;
     128: invokevirtual #26                 // Method org/apache/kerby/kerberos/kerb/type/ticket/TgtTicket.getEncKdcRepPart:()Lorg/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart;
     131: invokevirtual #39                 // Method org/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart.getSname:()Lorg/apache/kerby/kerberos/kerb/type/base/PrincipalName;
     134: invokevirtual #37                 // Method org/apache/kerby/kerberos/kerb/type/base/PrincipalName.getName:()Ljava/lang/String;
     137: invokespecial #38                 // Method javax/security/auth/kerberos/KerberosPrincipal."<init>":(Ljava/lang/String;)V
     140: aload_2
     141: invokevirtual #40                 // Method org/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart.getKey:()Lorg/apache/kerby/kerberos/kerb/type/base/EncryptionKey;
     144: invokevirtual #41                 // Method org/apache/kerby/kerberos/kerb/type/base/EncryptionKey.getKeyData:()[B
     147: aload_2
     148: invokevirtual #40                 // Method org/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart.getKey:()Lorg/apache/kerby/kerberos/kerb/type/base/EncryptionKey;
     151: invokevirtual #42                 // Method org/apache/kerby/kerberos/kerb/type/base/EncryptionKey.getKeyType:()Lorg/apache/kerby/kerberos/kerb/type/base/EncryptionType;
     154: invokevirtual #43                 // Method org/apache/kerby/kerberos/kerb/type/base/EncryptionType.getValue:()I
     157: aload_3
     158: aload_2
     159: invokevirtual #44                 // Method org/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart.getAuthTime:()Lorg/apache/kerby/kerberos/kerb/type/KerberosTime;
     162: invokevirtual #30                 // Method org/apache/kerby/kerberos/kerb/type/KerberosTime.getValue:()Ljava/lang/Object;
     165: checkcast     #31                 // class java/util/Date
     168: aload         5
     170: aload_2
     171: invokevirtual #45                 // Method org/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart.getEndTime:()Lorg/apache/kerby/kerberos/kerb/type/KerberosTime;
     174: invokevirtual #30                 // Method org/apache/kerby/kerberos/kerb/type/KerberosTime.getValue:()Ljava/lang/Object;
     177: checkcast     #31                 // class java/util/Date
     180: aload_2
     181: invokevirtual #46                 // Method org/apache/kerby/kerberos/kerb/type/kdc/EncKdcRepPart.getRenewTill:()Lorg/apache/kerby/kerberos/kerb/type/KerberosTime;
     184: invokevirtual #30                 // Method org/apache/kerby/kerberos/kerb/type/KerberosTime.getValue:()Ljava/lang/Object;
     187: checkcast     #31                 // class java/util/Date
     190: aconst_null
     191: invokespecial #47                 // Method javax/security/auth/kerberos/KerberosTicket."<init>":([BLjavax/security/auth/kerberos/KerberosPrincipal;Ljavax/security/auth/kerberos/KerberosPrincipal;[BI[ZLjava/util/Date;Ljava/util/Date;Ljava/util/Date;Ljava/util/Date;[Ljava/net/InetAddress;)V
     194: astore_1
     195: goto          229
     198: astore_2
     199: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
     202: new           #50                 // class java/lang/StringBuilder
     205: dup
     206: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
     209: ldc           #52                 // String Commit Failed.
     211: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     214: aload_2
     215: invokevirtual #54                 // Method java/io/IOException.toString:()Ljava/lang/String;
     218: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     221: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     224: invokeinterface #56,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     229: aload_0
     230: getfield      #9                  // Field subject:Ljavax/security/auth/Subject;
     233: invokevirtual #57                 // Method javax/security/auth/Subject.getPrivateCredentials:()Ljava/util/Set;
     236: aload_1
     237: invokeinterface #58,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     242: pop
     243: aload_0
     244: getfield      #5                  // Field princName:Ljava/lang/String;
     247: ifnull        274
     250: aload_0
     251: getfield      #9                  // Field subject:Ljavax/security/auth/Subject;
     254: invokevirtual #59                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
     257: new           #35                 // class javax/security/auth/kerberos/KerberosPrincipal
     260: dup
     261: aload_0
     262: getfield      #5                  // Field princName:Ljava/lang/String;
     265: invokespecial #38                 // Method javax/security/auth/kerberos/KerberosPrincipal."<init>":(Ljava/lang/String;)V
     268: invokeinterface #58,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     273: pop
     274: aload_0
     275: iconst_1
     276: putfield      #4                  // Field commitSucceeded:Z
     279: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
     282: ldc           #60                 // String Commit Succeeded \n
     284: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     289: iconst_1
     290: ireturn
    Exception table:
       from    to  target type
          11   195   198   Class java/io/IOException

  public boolean abort() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #3                  // Field succeeded:Z
       4: ifne          9
       7: iconst_0
       8: ireturn
       9: aload_0
      10: getfield      #3                  // Field succeeded:Z
      13: iconst_1
      14: if_icmpne     32
      17: aload_0
      18: getfield      #4                  // Field commitSucceeded:Z
      21: ifne          32
      24: aload_0
      25: iconst_0
      26: putfield      #3                  // Field succeeded:Z
      29: goto          37
      32: aload_0
      33: invokevirtual #62                 // Method logout:()Z
      36: pop
      37: iconst_1
      38: ireturn

  public boolean logout() throws javax.security.auth.login.LoginException;
    Code:
       0: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
       3: ldc           #63                 // String \t\t[TokenAuthLoginModule]: Entering logout
       5: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      10: aload_0
      11: getfield      #9                  // Field subject:Ljavax/security/auth/Subject;
      14: invokevirtual #64                 // Method javax/security/auth/Subject.isReadOnly:()Z
      17: ifeq          30
      20: new           #65                 // class javax/security/auth/login/LoginException
      23: dup
      24: ldc           #66                 // String Subject is Readonly
      26: invokespecial #67                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      29: athrow
      30: aload_0
      31: getfield      #9                  // Field subject:Ljavax/security/auth/Subject;
      34: invokevirtual #59                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      37: invokeinterface #68,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      42: astore_1
      43: aload_1
      44: invokeinterface #69,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      49: ifeq          95
      52: aload_1
      53: invokeinterface #70,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      58: checkcast     #71                 // class java/security/Principal
      61: astore_2
      62: aload_2
      63: invokeinterface #72,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      68: aload_0
      69: getfield      #5                  // Field princName:Ljava/lang/String;
      72: invokevirtual #73                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      75: ifeq          92
      78: aload_0
      79: getfield      #9                  // Field subject:Ljavax/security/auth/Subject;
      82: invokevirtual #59                 // Method javax/security/auth/Subject.getPrincipals:()Ljava/util/Set;
      85: aload_2
      86: invokeinterface #74,  2           // InterfaceMethod java/util/Set.remove:(Ljava/lang/Object;)Z
      91: pop
      92: goto          43
      95: aload_0
      96: getfield      #9                  // Field subject:Ljavax/security/auth/Subject;
      99: invokevirtual #57                 // Method javax/security/auth/Subject.getPrivateCredentials:()Ljava/util/Set;
     102: invokeinterface #75,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     107: astore_1
     108: aload_1
     109: invokeinterface #69,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     114: ifeq          140
     117: aload_1
     118: invokeinterface #70,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     123: astore_2
     124: aload_2
     125: instanceof    #76                 // class org/apache/kerby/kerberos/kerb/type/base/KrbToken
     128: ifeq          137
     131: aload_1
     132: invokeinterface #77,  1           // InterfaceMethod java/util/Iterator.remove:()V
     137: goto          108
     140: aload_0
     141: invokespecial #78                 // Method cleanup:()V
     144: aload_0
     145: iconst_0
     146: putfield      #3                  // Field succeeded:Z
     149: aload_0
     150: iconst_0
     151: putfield      #4                  // Field commitSucceeded:Z
     154: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
     157: ldc           #79                 // String \t\t[TokenAuthLoginModule]: logged out Subject
     159: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     164: iconst_1
     165: ireturn

  private void validateConfiguration() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #18                 // Field armorCache:Ljava/io/File;
       4: ifnonnull     17
       7: new           #65                 // class javax/security/auth/login/LoginException
      10: dup
      11: ldc           #80                 // String An armor cache must be specified via the armorCache configuration option
      13: invokespecial #67                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_0
      18: getfield      #20                 // Field cCache:Ljava/io/File;
      21: ifnonnull     34
      24: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
      27: ldc           #81                 // String No credential cache was specified via \'credentialCache\'. The TGT will be stored internally instead
      29: invokeinterface #61,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      34: ldc           #82                 // String
      36: astore_1
      37: aload_0
      38: getfield      #6                  // Field tokenStr:Ljava/lang/String;
      41: ifnonnull     57
      44: aload_0
      45: getfield      #2                  // Field tokenCacheName:Ljava/lang/String;
      48: ifnonnull     57
      51: ldc           #83                 // String useToken is specified but no token or token cache is provided
      53: astore_1
      54: goto          74
      57: aload_0
      58: getfield      #6                  // Field tokenStr:Ljava/lang/String;
      61: ifnull        74
      64: aload_0
      65: getfield      #2                  // Field tokenCacheName:Ljava/lang/String;
      68: ifnull        74
      71: ldc           #84                 // String either token or token cache should be provided but not both
      73: astore_1
      74: aload_1
      75: invokevirtual #85                 // Method java/lang/String.isEmpty:()Z
      78: ifne          90
      81: new           #65                 // class javax/security/auth/login/LoginException
      84: dup
      85: aload_1
      86: invokespecial #67                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      89: athrow
      90: return

  private boolean tokenLogin() throws javax.security.auth.login.LoginException;
    Code:
       0: aload_0
       1: getfield      #6                  // Field tokenStr:Ljava/lang/String;
       4: ifnonnull     55
       7: aload_0
       8: aload_0
       9: getfield      #2                  // Field tokenCacheName:Ljava/lang/String;
      12: invokestatic  #86                 // Method org/apache/kerby/kerberos/kerb/client/jaas/TokenCache.readToken:(Ljava/lang/String;)Ljava/lang/String;
      15: putfield      #6                  // Field tokenStr:Ljava/lang/String;
      18: aload_0
      19: getfield      #6                  // Field tokenStr:Ljava/lang/String;
      22: ifnonnull     55
      25: new           #65                 // class javax/security/auth/login/LoginException
      28: dup
      29: new           #50                 // class java/lang/StringBuilder
      32: dup
      33: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
      36: ldc           #87                 // String No valid token was found in token cache:
      38: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      41: aload_0
      42: getfield      #2                  // Field tokenCacheName:Ljava/lang/String;
      45: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      48: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      51: invokespecial #67                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      54: athrow
      55: aload_0
      56: new           #76                 // class org/apache/kerby/kerberos/kerb/type/base/KrbToken
      59: dup
      60: invokespecial #88                 // Method org/apache/kerby/kerberos/kerb/type/base/KrbToken."<init>":()V
      63: putfield      #8                  // Field krbToken:Lorg/apache/kerby/kerberos/kerb/type/base/KrbToken;
      66: aload_0
      67: getfield      #22                 // Field signKeyFile:Ljava/io/File;
      70: ifnull        359
      73: invokestatic  #89                 // Method org/apache/kerby/kerberos/kerb/KrbRuntime.getTokenProvider:()Lorg/apache/kerby/kerberos/kerb/provider/TokenProvider;
      76: invokeinterface #90,  1           // InterfaceMethod org/apache/kerby/kerberos/kerb/provider/TokenProvider.createTokenDecoder:()Lorg/apache/kerby/kerberos/kerb/provider/TokenDecoder;
      81: astore_1
      82: aload_0
      83: aload_1
      84: aload_0
      85: getfield      #6                  // Field tokenStr:Ljava/lang/String;
      88: invokeinterface #91,  2           // InterfaceMethod org/apache/kerby/kerberos/kerb/provider/TokenDecoder.decodeFromString:(Ljava/lang/String;)Lorg/apache/kerby/kerberos/kerb/type/base/AuthToken;
      93: putfield      #7                  // Field authToken:Lorg/apache/kerby/kerberos/kerb/type/base/AuthToken;
      96: goto          130
      99: astore_2
     100: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
     103: new           #50                 // class java/lang/StringBuilder
     106: dup
     107: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
     110: ldc           #92                 // String Token decode failed.
     112: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     115: aload_2
     116: invokevirtual #54                 // Method java/io/IOException.toString:()Ljava/lang/String;
     119: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     122: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     125: invokeinterface #56,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     130: invokestatic  #89                 // Method org/apache/kerby/kerberos/kerb/KrbRuntime.getTokenProvider:()Lorg/apache/kerby/kerberos/kerb/provider/TokenProvider;
     133: invokeinterface #93,  1           // InterfaceMethod org/apache/kerby/kerberos/kerb/provider/TokenProvider.createTokenEncoder:()Lorg/apache/kerby/kerberos/kerb/provider/TokenEncoder;
     138: astore_2
     139: aload_2
     140: instanceof    #94                 // class org/apache/kerby/kerberos/provider/token/JwtTokenEncoder
     143: ifeq          327
     146: aconst_null
     147: astore_3
     148: aload_0
     149: getfield      #22                 // Field signKeyFile:Ljava/io/File;
     152: invokevirtual #95                 // Method java/io/File.toPath:()Ljava/nio/file/Path;
     155: iconst_0
     156: anewarray     #96                 // class java/nio/file/OpenOption
     159: invokestatic  #97                 // Method java/nio/file/Files.newInputStream:(Ljava/nio/file/Path;[Ljava/nio/file/OpenOption;)Ljava/io/InputStream;
     162: astore        4
     164: aconst_null
     165: astore        5
     167: aload         4
     169: invokestatic  #98                 // Method org/apache/kerby/kerberos/kerb/common/PrivateKeyReader.loadPrivateKey:(Ljava/io/InputStream;)Ljava/security/PrivateKey;
     172: astore_3
     173: aload         4
     175: ifnull        260
     178: aload         5
     180: ifnull        203
     183: aload         4
     185: invokevirtual #99                 // Method java/io/InputStream.close:()V
     188: goto          260
     191: astore        6
     193: aload         5
     195: aload         6
     197: invokevirtual #101                // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     200: goto          260
     203: aload         4
     205: invokevirtual #99                 // Method java/io/InputStream.close:()V
     208: goto          260
     211: astore        6
     213: aload         6
     215: astore        5
     217: aload         6
     219: athrow
     220: astore        7
     222: aload         4
     224: ifnull        257
     227: aload         5
     229: ifnull        252
     232: aload         4
     234: invokevirtual #99                 // Method java/io/InputStream.close:()V
     237: goto          257
     240: astore        8
     242: aload         5
     244: aload         8
     246: invokevirtual #101                // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     249: goto          257
     252: aload         4
     254: invokevirtual #99                 // Method java/io/InputStream.close:()V
     257: aload         7
     259: athrow
     260: goto          316
     263: astore        4
     265: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
     268: new           #50                 // class java/lang/StringBuilder
     271: dup
     272: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
     275: ldc           #102                // String Failed to load private key from file:
     277: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     280: aload_0
     281: getfield      #22                 // Field signKeyFile:Ljava/io/File;
     284: invokevirtual #103                // Method java/io/File.getName:()Ljava/lang/String;
     287: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     290: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     293: invokeinterface #56,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     298: goto          316
     301: astore        4
     303: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
     306: aload         4
     308: invokevirtual #105                // Method java/lang/Exception.toString:()Ljava/lang/String;
     311: invokeinterface #56,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     316: aload_2
     317: checkcast     #94                 // class org/apache/kerby/kerberos/provider/token/JwtTokenEncoder
     320: aload_3
     321: checkcast     #106                // class java/security/interfaces/RSAPrivateKey
     324: invokevirtual #107                // Method org/apache/kerby/kerberos/provider/token/JwtTokenEncoder.setSignKey:(Ljava/security/PrivateKey;)V
     327: aload_0
     328: getfield      #8                  // Field krbToken:Lorg/apache/kerby/kerberos/kerb/type/base/KrbToken;
     331: aload_2
     332: aload_0
     333: getfield      #7                  // Field authToken:Lorg/apache/kerby/kerberos/kerb/type/base/AuthToken;
     336: invokeinterface #108,  2          // InterfaceMethod org/apache/kerby/kerberos/kerb/provider/TokenEncoder.encodeAsBytes:(Lorg/apache/kerby/kerberos/kerb/type/base/AuthToken;)[B
     341: invokevirtual #109                // Method org/apache/kerby/kerberos/kerb/type/base/KrbToken.setTokenValue:([B)V
     344: goto          420
     347: astore_1
     348: new           #111                // class java/lang/RuntimeException
     351: dup
     352: ldc           #112                // String Failed to encode AuthToken
     354: aload_1
     355: invokespecial #113                // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     358: athrow
     359: aload_0
     360: getfield      #8                  // Field krbToken:Lorg/apache/kerby/kerberos/kerb/type/base/KrbToken;
     363: aload_0
     364: getfield      #6                  // Field tokenStr:Ljava/lang/String;
     367: invokevirtual #114                // Method java/lang/String.getBytes:()[B
     370: invokevirtual #109                // Method org/apache/kerby/kerberos/kerb/type/base/KrbToken.setTokenValue:([B)V
     373: aload_0
     374: getfield      #7                  // Field authToken:Lorg/apache/kerby/kerberos/kerb/type/base/AuthToken;
     377: ifnonnull     420
     380: aload_0
     381: getfield      #6                  // Field tokenStr:Ljava/lang/String;
     384: invokestatic  #115                // Method com/nimbusds/jwt/JWTParser.parse:(Ljava/lang/String;)Lcom/nimbusds/jwt/JWT;
     387: astore_1
     388: aload_0
     389: new           #116                // class org/apache/kerby/kerberos/provider/token/JwtAuthToken
     392: dup
     393: aload_1
     394: invokeinterface #117,  1          // InterfaceMethod com/nimbusds/jwt/JWT.getJWTClaimsSet:()Lcom/nimbusds/jwt/ReadOnlyJWTClaimsSet;
     399: invokespecial #118                // Method org/apache/kerby/kerberos/provider/token/JwtAuthToken."<init>":(Lcom/nimbusds/jwt/ReadOnlyJWTClaimsSet;)V
     402: putfield      #7                  // Field authToken:Lorg/apache/kerby/kerberos/kerb/type/base/AuthToken;
     405: goto          420
     408: astore_1
     409: new           #111                // class java/lang/RuntimeException
     412: dup
     413: ldc           #120                // String Failed to parse JWT token string
     415: aload_1
     416: invokespecial #113                // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     419: athrow
     420: aload_0
     421: getfield      #8                  // Field krbToken:Lorg/apache/kerby/kerberos/kerb/type/base/KrbToken;
     424: aload_0
     425: getfield      #7                  // Field authToken:Lorg/apache/kerby/kerberos/kerb/type/base/AuthToken;
     428: invokevirtual #121                // Method org/apache/kerby/kerberos/kerb/type/base/KrbToken.setInnerToken:(Lorg/apache/kerby/kerberos/kerb/type/base/AuthToken;)V
     431: aload_0
     432: getfield      #8                  // Field krbToken:Lorg/apache/kerby/kerberos/kerb/type/base/KrbToken;
     435: invokevirtual #122                // Method org/apache/kerby/kerberos/kerb/type/base/KrbToken.setTokenType:()V
     438: aload_0
     439: getfield      #8                  // Field krbToken:Lorg/apache/kerby/kerberos/kerb/type/base/KrbToken;
     442: getstatic     #123                // Field org/apache/kerby/kerberos/kerb/type/base/TokenFormat.JWT:Lorg/apache/kerby/kerberos/kerb/type/base/TokenFormat;
     445: invokevirtual #124                // Method org/apache/kerby/kerberos/kerb/type/base/KrbToken.setTokenFormat:(Lorg/apache/kerby/kerberos/kerb/type/base/TokenFormat;)V
     448: aconst_null
     449: astore_1
     450: new           #16                 // class java/io/File
     453: dup
     454: ldc           #125                // String java.security.krb5.conf
     456: invokestatic  #126                // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     459: invokespecial #17                 // Method java/io/File."<init>":(Ljava/lang/String;)V
     462: astore_2
     463: new           #127                // class org/apache/kerby/kerberos/kerb/client/KrbConfig
     466: dup
     467: invokespecial #128                // Method org/apache/kerby/kerberos/kerb/client/KrbConfig."<init>":()V
     470: astore_3
     471: aload_3
     472: aload_2
     473: invokevirtual #129                // Method org/apache/kerby/kerberos/kerb/client/KrbConfig.addKrb5Config:(Ljava/io/File;)V
     476: new           #130                // class org/apache/kerby/kerberos/kerb/client/KrbClient
     479: dup
     480: aload_3
     481: invokespecial #131                // Method org/apache/kerby/kerberos/kerb/client/KrbClient."<init>":(Lorg/apache/kerby/kerberos/kerb/client/KrbConfig;)V
     484: astore_1
     485: aload_1
     486: invokevirtual #132                // Method org/apache/kerby/kerberos/kerb/client/KrbClient.init:()V
     489: goto          523
     492: astore_2
     493: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
     496: new           #50                 // class java/lang/StringBuilder
     499: dup
     500: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
     503: ldc           #133                // String KrbClient init failed.
     505: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     508: aload_2
     509: invokevirtual #105                // Method java/lang/Exception.toString:()Ljava/lang/String;
     512: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     515: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     518: invokeinterface #56,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     523: new           #134                // class org/apache/kerby/kerberos/kerb/client/KrbTokenClient
     526: dup
     527: aload_1
     528: invokespecial #135                // Method org/apache/kerby/kerberos/kerb/client/KrbTokenClient."<init>":(Lorg/apache/kerby/kerberos/kerb/client/KrbClient;)V
     531: astore_2
     532: aload_0
     533: aload_2
     534: aload_0
     535: getfield      #8                  // Field krbToken:Lorg/apache/kerby/kerberos/kerb/type/base/KrbToken;
     538: aload_0
     539: getfield      #18                 // Field armorCache:Ljava/io/File;
     542: invokevirtual #136                // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
     545: invokevirtual #137                // Method org/apache/kerby/kerberos/kerb/client/KrbTokenClient.requestTgt:(Lorg/apache/kerby/kerberos/kerb/type/base/KrbToken;Ljava/lang/String;)Lorg/apache/kerby/kerberos/kerb/type/ticket/TgtTicket;
     548: putfield      #25                 // Field tgtTicket:Lorg/apache/kerby/kerberos/kerb/type/ticket/TgtTicket;
     551: goto          584
     554: astore_3
     555: aload_0
     556: new           #50                 // class java/lang/StringBuilder
     559: dup
     560: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
     563: ldc           #138                // String Failed to do login with token:
     565: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     568: aload_0
     569: getfield      #6                  // Field tokenStr:Ljava/lang/String;
     572: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     575: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     578: aload_3
     579: invokespecial #139                // Method throwWith:(Ljava/lang/String;Ljava/lang/Exception;)V
     582: iconst_0
     583: ireturn
     584: aload_0
     585: getfield      #20                 // Field cCache:Ljava/io/File;
     588: ifnull        686
     591: aload_0
     592: aload_0
     593: invokespecial #140                // Method makeTgtCache:()Ljava/io/File;
     596: putfield      #20                 // Field cCache:Ljava/io/File;
     599: goto          633
     602: astore_3
     603: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
     606: new           #50                 // class java/lang/StringBuilder
     609: dup
     610: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
     613: ldc           #141                // String Failed to make tgtCache.
     615: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     618: aload_3
     619: invokevirtual #54                 // Method java/io/IOException.toString:()Ljava/lang/String;
     622: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     625: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     628: invokeinterface #56,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     633: aload_1
     634: ifnull        649
     637: aload_1
     638: aload_0
     639: getfield      #25                 // Field tgtTicket:Lorg/apache/kerby/kerberos/kerb/type/ticket/TgtTicket;
     642: aload_0
     643: getfield      #20                 // Field cCache:Ljava/io/File;
     646: invokevirtual #142                // Method org/apache/kerby/kerberos/kerb/client/KrbClient.storeTicket:(Lorg/apache/kerby/kerberos/kerb/type/ticket/TgtTicket;Ljava/io/File;)V
     649: goto          686
     652: astore_3
     653: getstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
     656: new           #50                 // class java/lang/StringBuilder
     659: dup
     660: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
     663: ldc           #143                // String Failed to store tgtTicket to
     665: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     668: aload_0
     669: getfield      #20                 // Field cCache:Ljava/io/File;
     672: invokevirtual #103                // Method java/io/File.getName:()Ljava/lang/String;
     675: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     678: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     681: invokeinterface #56,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     686: iconst_1
     687: ireturn
    Exception table:
       from    to  target type
          82    96    99   Class java/io/IOException
         183   188   191   Class java/lang/Throwable
         167   173   211   Class java/lang/Throwable
         167   173   220   any
         232   237   240   Class java/lang/Throwable
         211   222   220   any
         148   260   263   Class java/io/IOException
         148   260   301   Class java/lang/Exception
          73   344   347   Class org/apache/kerby/kerberos/kerb/KrbException
         380   405   408   Class java/text/ParseException
         450   489   492   Class org/apache/kerby/kerberos/kerb/KrbException
         450   489   492   Class java/io/IOException
         532   551   554   Class org/apache/kerby/kerberos/kerb/KrbException
         591   599   602   Class java/io/IOException
         633   649   652   Class org/apache/kerby/kerberos/kerb/KrbException

  private java.io.File makeTgtCache() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #20                 // Field cCache:Ljava/io/File;
       4: invokevirtual #144                // Method java/io/File.exists:()Z
       7: ifne          53
      10: aload_0
      11: getfield      #20                 // Field cCache:Ljava/io/File;
      14: invokevirtual #145                // Method java/io/File.createNewFile:()Z
      17: ifne          53
      20: new           #48                 // class java/io/IOException
      23: dup
      24: new           #50                 // class java/lang/StringBuilder
      27: dup
      28: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
      31: ldc           #146                // String Failed to create tgtcache file
      33: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      36: aload_0
      37: getfield      #20                 // Field cCache:Ljava/io/File;
      40: invokevirtual #136                // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
      43: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      46: invokevirtual #55                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      49: invokespecial #147                // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      52: athrow
      53: aload_0
      54: getfield      #20                 // Field cCache:Ljava/io/File;
      57: iconst_0
      58: invokevirtual #148                // Method java/io/File.setExecutable:(Z)Z
      61: pop
      62: aload_0
      63: getfield      #20                 // Field cCache:Ljava/io/File;
      66: iconst_1
      67: invokevirtual #149                // Method java/io/File.setReadable:(Z)Z
      70: pop
      71: aload_0
      72: getfield      #20                 // Field cCache:Ljava/io/File;
      75: iconst_1
      76: invokevirtual #150                // Method java/io/File.setWritable:(Z)Z
      79: pop
      80: aload_0
      81: getfield      #20                 // Field cCache:Ljava/io/File;
      84: areturn

  private void cleanup();
    Code:
       0: aload_0
       1: getfield      #20                 // Field cCache:Ljava/io/File;
       4: ifnull        39
       7: aload_0
       8: getfield      #20                 // Field cCache:Ljava/io/File;
      11: invokevirtual #144                // Method java/io/File.exists:()Z
      14: ifeq          39
      17: aload_0
      18: getfield      #20                 // Field cCache:Ljava/io/File;
      21: invokevirtual #151                // Method java/io/File.delete:()Z
      24: istore_1
      25: iload_1
      26: ifne          39
      29: new           #111                // class java/lang/RuntimeException
      32: dup
      33: ldc           #152                // String File delete error!
      35: invokespecial #153                // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
      38: athrow
      39: return

  private void throwWith(java.lang.String, java.lang.Exception) throws javax.security.auth.login.LoginException;
    Code:
       0: new           #65                 // class javax/security/auth/login/LoginException
       3: dup
       4: aload_1
       5: invokespecial #67                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
       8: astore_3
       9: aload_3
      10: aload_2
      11: invokevirtual #154                // Method javax/security/auth/login/LoginException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
      14: pop
      15: aload_3
      16: athrow

  static {};
    Code:
       0: ldc_w         #155                // class org/apache/kerby/kerberos/kerb/client/jaas/TokenAuthLoginModule
       3: invokestatic  #156                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #49                 // Field LOG:Lorg/slf4j/Logger;
       9: return
}
