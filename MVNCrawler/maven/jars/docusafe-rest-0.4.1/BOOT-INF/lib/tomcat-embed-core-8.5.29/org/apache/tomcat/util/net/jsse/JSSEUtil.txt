Compiled from "JSSEUtil.java"
public class org.apache.tomcat.util.net.jsse.JSSEUtil extends org.apache.tomcat.util.net.SSLUtilBase {
  private static final org.apache.juli.logging.Log log;

  private static final org.apache.tomcat.util.res.StringManager sm;

  private static final java.util.Set<java.lang.String> implementedProtocols;

  private static final java.util.Set<java.lang.String> implementedCiphers;

  private final org.apache.tomcat.util.net.SSLHostConfig sslHostConfig;

  public org.apache.tomcat.util.net.jsse.JSSEUtil(org.apache.tomcat.util.net.SSLHostConfigCertificate);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #1                  // Method org/apache/tomcat/util/net/SSLUtilBase."<init>":(Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;)V
       5: aload_0
       6: aload_1
       7: invokevirtual #2                  // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getSSLHostConfig:()Lorg/apache/tomcat/util/net/SSLHostConfig;
      10: putfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
      13: return

  protected org.apache.juli.logging.Log getLog();
    Code:
       0: getstatic     #4                  // Field log:Lorg/apache/juli/logging/Log;
       3: areturn

  protected java.util.Set<java.lang.String> getImplementedProtocols();
    Code:
       0: getstatic     #5                  // Field implementedProtocols:Ljava/util/Set;
       3: areturn

  protected java.util.Set<java.lang.String> getImplementedCiphers();
    Code:
       0: getstatic     #6                  // Field implementedCiphers:Ljava/util/Set;
       3: areturn

  public org.apache.tomcat.util.net.SSLContext createSSLContext(java.util.List<java.lang.String>) throws java.security.NoSuchAlgorithmException;
    Code:
       0: new           #7                  // class org/apache/tomcat/util/net/jsse/JSSESSLContext
       3: dup
       4: aload_0
       5: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
       8: invokevirtual #8                  // Method org/apache/tomcat/util/net/SSLHostConfig.getSslProtocol:()Ljava/lang/String;
      11: invokespecial #9                  // Method org/apache/tomcat/util/net/jsse/JSSESSLContext."<init>":(Ljava/lang/String;)V
      14: areturn

  public javax.net.ssl.KeyManager[] getKeyManagers() throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
       4: invokevirtual #11                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateKeyAlias:()Ljava/lang/String;
       7: astore_1
       8: aload_0
       9: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
      12: invokevirtual #12                 // Method org/apache/tomcat/util/net/SSLHostConfig.getKeyManagerAlgorithm:()Ljava/lang/String;
      15: astore_2
      16: aload_0
      17: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
      20: invokevirtual #13                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateKeyPassword:()Ljava/lang/String;
      23: astore_3
      24: aload_3
      25: ifnonnull     36
      28: aload_0
      29: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
      32: invokevirtual #14                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateKeystorePassword:()Ljava/lang/String;
      35: astore_3
      36: aload_0
      37: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
      40: invokevirtual #15                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateKeystore:()Ljava/security/KeyStore;
      43: astore        4
      45: aload         4
      47: astore        5
      49: aload_3
      50: invokevirtual #16                 // Method java/lang/String.toCharArray:()[C
      53: astore        6
      55: aload         4
      57: ifnonnull     268
      60: aload_0
      61: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
      64: invokevirtual #17                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateFile:()Ljava/lang/String;
      67: ifnonnull     86
      70: new           #18                 // class java/io/IOException
      73: dup
      74: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      77: ldc           #20                 // String jsse.noCertFile
      79: invokevirtual #21                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      82: invokespecial #22                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      85: athrow
      86: new           #23                 // class org/apache/tomcat/util/net/jsse/PEMFile
      89: dup
      90: aload_0
      91: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
      94: invokevirtual #24                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateKeyFile:()Ljava/lang/String;
      97: ifnull        110
     100: aload_0
     101: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
     104: invokevirtual #24                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateKeyFile:()Ljava/lang/String;
     107: goto          117
     110: aload_0
     111: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
     114: invokevirtual #17                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateFile:()Ljava/lang/String;
     117: invokestatic  #25                 // Method org/apache/tomcat/util/net/SSLHostConfig.adjustRelativePath:(Ljava/lang/String;)Ljava/lang/String;
     120: aload_3
     121: invokespecial #26                 // Method org/apache/tomcat/util/net/jsse/PEMFile."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     124: astore        7
     126: new           #23                 // class org/apache/tomcat/util/net/jsse/PEMFile
     129: dup
     130: aload_0
     131: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
     134: invokevirtual #17                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateFile:()Ljava/lang/String;
     137: invokestatic  #25                 // Method org/apache/tomcat/util/net/SSLHostConfig.adjustRelativePath:(Ljava/lang/String;)Ljava/lang/String;
     140: invokespecial #27                 // Method org/apache/tomcat/util/net/jsse/PEMFile."<init>":(Ljava/lang/String;)V
     143: astore        8
     145: new           #28                 // class java/util/ArrayList
     148: dup
     149: invokespecial #29                 // Method java/util/ArrayList."<init>":()V
     152: astore        9
     154: aload         9
     156: aload         8
     158: invokevirtual #30                 // Method org/apache/tomcat/util/net/jsse/PEMFile.getCertificates:()Ljava/util/List;
     161: invokeinterface #31,  2           // InterfaceMethod java/util/Collection.addAll:(Ljava/util/Collection;)Z
     166: pop
     167: aload_0
     168: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
     171: invokevirtual #32                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateChainFile:()Ljava/lang/String;
     174: ifnull        209
     177: new           #23                 // class org/apache/tomcat/util/net/jsse/PEMFile
     180: dup
     181: aload_0
     182: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
     185: invokevirtual #32                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateChainFile:()Ljava/lang/String;
     188: invokestatic  #25                 // Method org/apache/tomcat/util/net/SSLHostConfig.adjustRelativePath:(Ljava/lang/String;)Ljava/lang/String;
     191: invokespecial #27                 // Method org/apache/tomcat/util/net/jsse/PEMFile."<init>":(Ljava/lang/String;)V
     194: astore        10
     196: aload         9
     198: aload         10
     200: invokevirtual #30                 // Method org/apache/tomcat/util/net/jsse/PEMFile.getCertificates:()Ljava/util/List;
     203: invokeinterface #31,  2           // InterfaceMethod java/util/Collection.addAll:(Ljava/util/Collection;)Z
     208: pop
     209: aload_1
     210: ifnonnull     216
     213: ldc           #33                 // String tomcat
     215: astore_1
     216: ldc           #34                 // String JKS
     218: invokestatic  #35                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;)Ljava/security/KeyStore;
     221: astore        5
     223: aload         5
     225: aconst_null
     226: aconst_null
     227: invokevirtual #36                 // Method java/security/KeyStore.load:(Ljava/io/InputStream;[C)V
     230: aload         5
     232: aload_1
     233: aload         7
     235: invokevirtual #37                 // Method org/apache/tomcat/util/net/jsse/PEMFile.getPrivateKey:()Ljava/security/PrivateKey;
     238: aload_3
     239: invokevirtual #16                 // Method java/lang/String.toCharArray:()[C
     242: aload         9
     244: aload         9
     246: invokeinterface #38,  1           // InterfaceMethod java/util/Collection.size:()I
     251: anewarray     #39                 // class java/security/cert/Certificate
     254: invokeinterface #40,  2           // InterfaceMethod java/util/Collection.toArray:([Ljava/lang/Object;)[Ljava/lang/Object;
     259: checkcast     #41                 // class "[Ljava/security/cert/Certificate;"
     262: invokevirtual #42                 // Method java/security/KeyStore.setKeyEntry:(Ljava/lang/String;Ljava/security/Key;[C[Ljava/security/cert/Certificate;)V
     265: goto          508
     268: aload_1
     269: ifnull        305
     272: aload         4
     274: aload_1
     275: invokevirtual #43                 // Method java/security/KeyStore.isKeyEntry:(Ljava/lang/String;)Z
     278: ifne          305
     281: new           #18                 // class java/io/IOException
     284: dup
     285: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     288: ldc           #44                 // String jsse.alias_no_key_entry
     290: iconst_1
     291: anewarray     #45                 // class java/lang/Object
     294: dup
     295: iconst_0
     296: aload_1
     297: aastore
     298: invokevirtual #46                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     301: invokespecial #22                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     304: athrow
     305: aload_1
     306: ifnonnull     412
     309: aload         4
     311: invokevirtual #47                 // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
     314: astore        7
     316: aload         7
     318: invokeinterface #48,  1           // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
     323: ifne          342
     326: new           #18                 // class java/io/IOException
     329: dup
     330: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     333: ldc           #49                 // String jsse.noKeys
     335: invokevirtual #21                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     338: invokespecial #22                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     341: athrow
     342: aload         7
     344: invokeinterface #48,  1           // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
     349: ifeq          381
     352: aload_1
     353: ifnonnull     381
     356: aload         7
     358: invokeinterface #50,  1           // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
     363: checkcast     #51                 // class java/lang/String
     366: astore_1
     367: aload         4
     369: aload_1
     370: invokevirtual #43                 // Method java/security/KeyStore.isKeyEntry:(Ljava/lang/String;)Z
     373: ifne          342
     376: aconst_null
     377: astore_1
     378: goto          342
     381: aload_1
     382: ifnonnull     412
     385: new           #18                 // class java/io/IOException
     388: dup
     389: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     392: ldc           #44                 // String jsse.alias_no_key_entry
     394: iconst_1
     395: anewarray     #45                 // class java/lang/Object
     398: dup
     399: iconst_0
     400: aconst_null
     401: checkcast     #45                 // class java/lang/Object
     404: aastore
     405: invokevirtual #46                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     408: invokespecial #22                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     411: athrow
     412: aload         4
     414: aload_1
     415: aload         6
     417: invokevirtual #52                 // Method java/security/KeyStore.getKey:(Ljava/lang/String;[C)Ljava/security/Key;
     420: astore        7
     422: aload         7
     424: ifnull        508
     427: ldc           #53                 // String PKCS#8
     429: aload         7
     431: invokeinterface #54,  1           // InterfaceMethod java/security/Key.getFormat:()Ljava/lang/String;
     436: invokevirtual #55                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     439: ifeq          508
     442: aload_0
     443: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
     446: invokevirtual #56                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateKeystoreProvider:()Ljava/lang/String;
     449: astore        8
     451: aload         8
     453: ifnonnull     471
     456: aload_0
     457: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
     460: invokevirtual #57                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateKeystoreType:()Ljava/lang/String;
     463: invokestatic  #35                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;)Ljava/security/KeyStore;
     466: astore        5
     468: goto          485
     471: aload_0
     472: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
     475: invokevirtual #57                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateKeystoreType:()Ljava/lang/String;
     478: aload         8
     480: invokestatic  #58                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/KeyStore;
     483: astore        5
     485: aload         5
     487: aconst_null
     488: aconst_null
     489: invokevirtual #36                 // Method java/security/KeyStore.load:(Ljava/io/InputStream;[C)V
     492: aload         5
     494: aload_1
     495: aload         7
     497: aload         6
     499: aload         4
     501: aload_1
     502: invokevirtual #59                 // Method java/security/KeyStore.getCertificateChain:(Ljava/lang/String;)[Ljava/security/cert/Certificate;
     505: invokevirtual #42                 // Method java/security/KeyStore.setKeyEntry:(Ljava/lang/String;Ljava/security/Key;[C[Ljava/security/cert/Certificate;)V
     508: aload_2
     509: invokestatic  #60                 // Method javax/net/ssl/KeyManagerFactory.getInstance:(Ljava/lang/String;)Ljavax/net/ssl/KeyManagerFactory;
     512: astore        7
     514: aload         7
     516: aload         5
     518: aload         6
     520: invokevirtual #61                 // Method javax/net/ssl/KeyManagerFactory.init:(Ljava/security/KeyStore;[C)V
     523: aload         7
     525: invokevirtual #62                 // Method javax/net/ssl/KeyManagerFactory.getKeyManagers:()[Ljavax/net/ssl/KeyManager;
     528: astore        8
     530: aload         8
     532: ifnull        609
     535: aload         5
     537: aload         4
     539: if_acmpne     609
     542: aload_1
     543: astore        9
     545: ldc           #34                 // String JKS
     547: aload_0
     548: getfield      #10                 // Field certificate:Lorg/apache/tomcat/util/net/SSLHostConfigCertificate;
     551: invokevirtual #57                 // Method org/apache/tomcat/util/net/SSLHostConfigCertificate.getCertificateKeystoreType:()Ljava/lang/String;
     554: invokevirtual #63                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     557: ifeq          570
     560: aload         9
     562: getstatic     #64                 // Field java/util/Locale.ENGLISH:Ljava/util/Locale;
     565: invokevirtual #65                 // Method java/lang/String.toLowerCase:(Ljava/util/Locale;)Ljava/lang/String;
     568: astore        9
     570: iconst_0
     571: istore        10
     573: iload         10
     575: aload         8
     577: arraylength
     578: if_icmpge     609
     581: aload         8
     583: iload         10
     585: new           #66                 // class org/apache/tomcat/util/net/jsse/JSSEKeyManager
     588: dup
     589: aload         8
     591: iload         10
     593: aaload
     594: checkcast     #67                 // class javax/net/ssl/X509KeyManager
     597: aload         9
     599: invokespecial #68                 // Method org/apache/tomcat/util/net/jsse/JSSEKeyManager."<init>":(Ljavax/net/ssl/X509KeyManager;Ljava/lang/String;)V
     602: aastore
     603: iinc          10, 1
     606: goto          573
     609: aload         8
     611: areturn

  public javax.net.ssl.TrustManager[] getTrustManagers() throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
       4: invokevirtual #69                 // Method org/apache/tomcat/util/net/SSLHostConfig.getTrustManagerClassName:()Ljava/lang/String;
       7: astore_1
       8: aload_1
       9: ifnull        101
      12: aload_1
      13: invokevirtual #70                 // Method java/lang/String.length:()I
      16: ifle          101
      19: aload_0
      20: invokevirtual #71                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      23: invokevirtual #72                 // Method java/lang/Class.getClassLoader:()Ljava/lang/ClassLoader;
      26: astore_2
      27: aload_2
      28: aload_1
      29: invokevirtual #73                 // Method java/lang/ClassLoader.loadClass:(Ljava/lang/String;)Ljava/lang/Class;
      32: astore_3
      33: ldc_w         #74                 // class javax/net/ssl/TrustManager
      36: aload_3
      37: invokevirtual #75                 // Method java/lang/Class.isAssignableFrom:(Ljava/lang/Class;)Z
      40: ifne          67
      43: new           #76                 // class java/lang/InstantiationException
      46: dup
      47: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      50: ldc           #77                 // String jsse.invalidTrustManagerClassName
      52: iconst_1
      53: anewarray     #45                 // class java/lang/Object
      56: dup
      57: iconst_0
      58: aload_1
      59: aastore
      60: invokevirtual #46                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      63: invokespecial #78                 // Method java/lang/InstantiationException."<init>":(Ljava/lang/String;)V
      66: athrow
      67: aload_3
      68: iconst_0
      69: anewarray     #79                 // class java/lang/Class
      72: invokevirtual #80                 // Method java/lang/Class.getConstructor:([Ljava/lang/Class;)Ljava/lang/reflect/Constructor;
      75: iconst_0
      76: anewarray     #45                 // class java/lang/Object
      79: invokevirtual #81                 // Method java/lang/reflect/Constructor.newInstance:([Ljava/lang/Object;)Ljava/lang/Object;
      82: astore        4
      84: aload         4
      86: checkcast     #74                 // class javax/net/ssl/TrustManager
      89: astore        5
      91: iconst_1
      92: anewarray     #74                 // class javax/net/ssl/TrustManager
      95: dup
      96: iconst_0
      97: aload         5
      99: aastore
     100: areturn
     101: aconst_null
     102: astore_2
     103: aload_0
     104: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
     107: invokevirtual #82                 // Method org/apache/tomcat/util/net/SSLHostConfig.getTruststore:()Ljava/security/KeyStore;
     110: astore_3
     111: aload_3
     112: ifnull        294
     115: aload_0
     116: aload_3
     117: invokespecial #83                 // Method checkTrustStoreEntries:(Ljava/security/KeyStore;)V
     120: aload_0
     121: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
     124: invokevirtual #84                 // Method org/apache/tomcat/util/net/SSLHostConfig.getTruststoreAlgorithm:()Ljava/lang/String;
     127: astore        4
     129: aload_0
     130: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
     133: invokevirtual #85                 // Method org/apache/tomcat/util/net/SSLHostConfig.getCertificateRevocationListFile:()Ljava/lang/String;
     136: astore        5
     138: aload_0
     139: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
     142: invokevirtual #86                 // Method org/apache/tomcat/util/net/SSLHostConfig.getRevocationEnabled:()Z
     145: istore        6
     147: ldc           #87                 // String PKIX
     149: aload         4
     151: invokevirtual #55                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     154: ifeq          202
     157: aload         4
     159: invokestatic  #88                 // Method javax/net/ssl/TrustManagerFactory.getInstance:(Ljava/lang/String;)Ljavax/net/ssl/TrustManagerFactory;
     162: astore        7
     164: aload_0
     165: aload         5
     167: aload_3
     168: iload         6
     170: invokevirtual #89                 // Method getParameters:(Ljava/lang/String;Ljava/security/KeyStore;Z)Ljava/security/cert/CertPathParameters;
     173: astore        8
     175: new           #90                 // class javax/net/ssl/CertPathTrustManagerParameters
     178: dup
     179: aload         8
     181: invokespecial #91                 // Method javax/net/ssl/CertPathTrustManagerParameters."<init>":(Ljava/security/cert/CertPathParameters;)V
     184: astore        9
     186: aload         7
     188: aload         9
     190: invokevirtual #92                 // Method javax/net/ssl/TrustManagerFactory.init:(Ljavax/net/ssl/ManagerFactoryParameters;)V
     193: aload         7
     195: invokevirtual #93                 // Method javax/net/ssl/TrustManagerFactory.getTrustManagers:()[Ljavax/net/ssl/TrustManager;
     198: astore_2
     199: goto          294
     202: aload         4
     204: invokestatic  #88                 // Method javax/net/ssl/TrustManagerFactory.getInstance:(Ljava/lang/String;)Ljavax/net/ssl/TrustManagerFactory;
     207: astore        7
     209: aload         7
     211: aload_3
     212: invokevirtual #94                 // Method javax/net/ssl/TrustManagerFactory.init:(Ljava/security/KeyStore;)V
     215: aload         7
     217: invokevirtual #93                 // Method javax/net/ssl/TrustManagerFactory.getTrustManagers:()[Ljavax/net/ssl/TrustManager;
     220: astore_2
     221: aload         5
     223: ifnull        259
     226: aload         5
     228: invokevirtual #70                 // Method java/lang/String.length:()I
     231: ifle          259
     234: new           #95                 // class java/security/cert/CRLException
     237: dup
     238: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     241: ldc           #96                 // String jsseUtil.noCrlSupport
     243: iconst_1
     244: anewarray     #45                 // class java/lang/Object
     247: dup
     248: iconst_0
     249: aload         4
     251: aastore
     252: invokevirtual #46                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     255: invokespecial #97                 // Method java/security/cert/CRLException."<init>":(Ljava/lang/String;)V
     258: athrow
     259: aload_0
     260: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
     263: invokevirtual #98                 // Method org/apache/tomcat/util/net/SSLHostConfig.isCertificateVerificationDepthConfigured:()Z
     266: ifeq          294
     269: getstatic     #4                  // Field log:Lorg/apache/juli/logging/Log;
     272: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     275: ldc           #99                 // String jsseUtil.noVerificationDepth
     277: iconst_1
     278: anewarray     #45                 // class java/lang/Object
     281: dup
     282: iconst_0
     283: aload         4
     285: aastore
     286: invokevirtual #46                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     289: invokeinterface #100,  2          // InterfaceMethod org/apache/juli/logging/Log.warn:(Ljava/lang/Object;)V
     294: aload_2
     295: areturn

  private void checkTrustStoreEntries(java.security.KeyStore) throws java.lang.Exception;
    Code:
       0: aload_1
       1: invokevirtual #47                 // Method java/security/KeyStore.aliases:()Ljava/util/Enumeration;
       4: astore_2
       5: aload_2
       6: ifnull        192
       9: new           #101                // class java/util/Date
      12: dup
      13: invokespecial #102                // Method java/util/Date."<init>":()V
      16: astore_3
      17: aload_2
      18: invokeinterface #48,  1           // InterfaceMethod java/util/Enumeration.hasMoreElements:()Z
      23: ifeq          192
      26: aload_2
      27: invokeinterface #50,  1           // InterfaceMethod java/util/Enumeration.nextElement:()Ljava/lang/Object;
      32: checkcast     #51                 // class java/lang/String
      35: astore        4
      37: aload_1
      38: aload         4
      40: invokevirtual #103                // Method java/security/KeyStore.isCertificateEntry:(Ljava/lang/String;)Z
      43: ifeq          189
      46: aload_1
      47: aload         4
      49: invokevirtual #104                // Method java/security/KeyStore.getCertificate:(Ljava/lang/String;)Ljava/security/cert/Certificate;
      52: astore        5
      54: aload         5
      56: instanceof    #105                // class java/security/cert/X509Certificate
      59: ifeq          153
      62: aload         5
      64: checkcast     #105                // class java/security/cert/X509Certificate
      67: aload_3
      68: invokevirtual #106                // Method java/security/cert/X509Certificate.checkValidity:(Ljava/util/Date;)V
      71: goto          189
      74: astore        6
      76: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      79: ldc           #109                // String jsseUtil.trustedCertNotValid
      81: iconst_3
      82: anewarray     #45                 // class java/lang/Object
      85: dup
      86: iconst_0
      87: aload         4
      89: aastore
      90: dup
      91: iconst_1
      92: aload         5
      94: checkcast     #105                // class java/security/cert/X509Certificate
      97: invokevirtual #110                // Method java/security/cert/X509Certificate.getSubjectDN:()Ljava/security/Principal;
     100: aastore
     101: dup
     102: iconst_2
     103: aload         6
     105: invokevirtual #111                // Method java/security/cert/CertificateException.getMessage:()Ljava/lang/String;
     108: aastore
     109: invokevirtual #46                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     112: astore        7
     114: getstatic     #4                  // Field log:Lorg/apache/juli/logging/Log;
     117: invokeinterface #112,  1          // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     122: ifeq          140
     125: getstatic     #4                  // Field log:Lorg/apache/juli/logging/Log;
     128: aload         7
     130: aload         6
     132: invokeinterface #113,  3          // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     137: goto          150
     140: getstatic     #4                  // Field log:Lorg/apache/juli/logging/Log;
     143: aload         7
     145: invokeinterface #100,  2          // InterfaceMethod org/apache/juli/logging/Log.warn:(Ljava/lang/Object;)V
     150: goto          189
     153: getstatic     #4                  // Field log:Lorg/apache/juli/logging/Log;
     156: invokeinterface #112,  1          // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     161: ifeq          189
     164: getstatic     #4                  // Field log:Lorg/apache/juli/logging/Log;
     167: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     170: ldc           #114                // String jsseUtil.trustedCertNotChecked
     172: iconst_1
     173: anewarray     #45                 // class java/lang/Object
     176: dup
     177: iconst_0
     178: aload         4
     180: aastore
     181: invokevirtual #46                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     184: invokeinterface #115,  2          // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     189: goto          17
     192: return
    Exception table:
       from    to  target type
          62    71    74   Class java/security/cert/CertificateExpiredException
          62    71    74   Class java/security/cert/CertificateNotYetValidException

  public void configureSessionContext(javax.net.ssl.SSLSessionContext);
    Code:
       0: aload_1
       1: aload_0
       2: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
       5: invokevirtual #116                // Method org/apache/tomcat/util/net/SSLHostConfig.getSessionCacheSize:()I
       8: invokeinterface #117,  2          // InterfaceMethod javax/net/ssl/SSLSessionContext.setSessionCacheSize:(I)V
      13: aload_1
      14: aload_0
      15: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
      18: invokevirtual #118                // Method org/apache/tomcat/util/net/SSLHostConfig.getSessionTimeout:()I
      21: invokeinterface #119,  2          // InterfaceMethod javax/net/ssl/SSLSessionContext.setSessionTimeout:(I)V
      26: return

  protected java.security.cert.CertPathParameters getParameters(java.lang.String, java.security.KeyStore, boolean) throws java.lang.Exception;
    Code:
       0: new           #120                // class java/security/cert/PKIXBuilderParameters
       3: dup
       4: aload_2
       5: new           #121                // class java/security/cert/X509CertSelector
       8: dup
       9: invokespecial #122                // Method java/security/cert/X509CertSelector."<init>":()V
      12: invokespecial #123                // Method java/security/cert/PKIXBuilderParameters."<init>":(Ljava/security/KeyStore;Ljava/security/cert/CertSelector;)V
      15: astore        4
      17: aload_1
      18: ifnull        71
      21: aload_1
      22: invokevirtual #70                 // Method java/lang/String.length:()I
      25: ifle          71
      28: aload_0
      29: aload_1
      30: invokevirtual #124                // Method getCRLs:(Ljava/lang/String;)Ljava/util/Collection;
      33: astore        5
      35: new           #125                // class java/security/cert/CollectionCertStoreParameters
      38: dup
      39: aload         5
      41: invokespecial #126                // Method java/security/cert/CollectionCertStoreParameters."<init>":(Ljava/util/Collection;)V
      44: astore        6
      46: ldc           #127                // String Collection
      48: aload         6
      50: invokestatic  #128                // Method java/security/cert/CertStore.getInstance:(Ljava/lang/String;Ljava/security/cert/CertStoreParameters;)Ljava/security/cert/CertStore;
      53: astore        7
      55: aload         4
      57: aload         7
      59: invokevirtual #129                // Method java/security/cert/PKIXBuilderParameters.addCertStore:(Ljava/security/cert/CertStore;)V
      62: aload         4
      64: iconst_1
      65: invokevirtual #130                // Method java/security/cert/PKIXBuilderParameters.setRevocationEnabled:(Z)V
      68: goto          77
      71: aload         4
      73: iload_3
      74: invokevirtual #130                // Method java/security/cert/PKIXBuilderParameters.setRevocationEnabled:(Z)V
      77: aload         4
      79: aload_0
      80: getfield      #3                  // Field sslHostConfig:Lorg/apache/tomcat/util/net/SSLHostConfig;
      83: invokevirtual #131                // Method org/apache/tomcat/util/net/SSLHostConfig.getCertificateVerificationDepth:()I
      86: invokevirtual #132                // Method java/security/cert/PKIXBuilderParameters.setMaxPathLength:(I)V
      89: aload         4
      91: areturn

  protected java.util.Collection<? extends java.security.cert.CRL> getCRLs(java.lang.String) throws java.io.IOException, java.security.cert.CRLException, java.security.cert.CertificateException;
    Code:
       0: aconst_null
       1: astore_2
       2: ldc           #133                // String X.509
       4: invokestatic  #134                // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
       7: astore_3
       8: aload_1
       9: invokestatic  #135                // Method org/apache/tomcat/util/file/ConfigFileLoader.getInputStream:(Ljava/lang/String;)Ljava/io/InputStream;
      12: astore        4
      14: aconst_null
      15: astore        5
      17: aload_3
      18: aload         4
      20: invokevirtual #136                // Method java/security/cert/CertificateFactory.generateCRLs:(Ljava/io/InputStream;)Ljava/util/Collection;
      23: astore_2
      24: aload         4
      26: ifnull        111
      29: aload         5
      31: ifnull        54
      34: aload         4
      36: invokevirtual #137                // Method java/io/InputStream.close:()V
      39: goto          111
      42: astore        6
      44: aload         5
      46: aload         6
      48: invokevirtual #139                // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
      51: goto          111
      54: aload         4
      56: invokevirtual #137                // Method java/io/InputStream.close:()V
      59: goto          111
      62: astore        6
      64: aload         6
      66: astore        5
      68: aload         6
      70: athrow
      71: astore        7
      73: aload         4
      75: ifnull        108
      78: aload         5
      80: ifnull        103
      83: aload         4
      85: invokevirtual #137                // Method java/io/InputStream.close:()V
      88: goto          108
      91: astore        8
      93: aload         5
      95: aload         8
      97: invokevirtual #139                // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     100: goto          108
     103: aload         4
     105: invokevirtual #137                // Method java/io/InputStream.close:()V
     108: aload         7
     110: athrow
     111: goto          123
     114: astore_3
     115: aload_3
     116: athrow
     117: astore_3
     118: aload_3
     119: athrow
     120: astore_3
     121: aload_3
     122: athrow
     123: aload_2
     124: areturn
    Exception table:
       from    to  target type
          34    39    42   Class java/lang/Throwable
          17    24    62   Class java/lang/Throwable
          17    24    71   any
          83    88    91   Class java/lang/Throwable
          62    73    71   any
           2   111   114   Class java/io/IOException
           2   111   117   Class java/security/cert/CRLException
           2   111   120   Class java/security/cert/CertificateException

  static {};
    Code:
       0: ldc_w         #141                // class org/apache/tomcat/util/net/jsse/JSSEUtil
       3: invokestatic  #142                // Method org/apache/juli/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/juli/logging/Log;
       6: putstatic     #4                  // Field log:Lorg/apache/juli/logging/Log;
       9: ldc_w         #141                // class org/apache/tomcat/util/net/jsse/JSSEUtil
      12: invokestatic  #143                // Method org/apache/tomcat/util/res/StringManager.getManager:(Ljava/lang/Class;)Lorg/apache/tomcat/util/res/StringManager;
      15: putstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      18: new           #7                  // class org/apache/tomcat/util/net/jsse/JSSESSLContext
      21: dup
      22: ldc           #144                // String TLS
      24: invokespecial #9                  // Method org/apache/tomcat/util/net/jsse/JSSESSLContext."<init>":(Ljava/lang/String;)V
      27: astore_0
      28: aload_0
      29: aconst_null
      30: aconst_null
      31: aconst_null
      32: invokeinterface #145,  4          // InterfaceMethod org/apache/tomcat/util/net/SSLContext.init:([Ljavax/net/ssl/KeyManager;[Ljavax/net/ssl/TrustManager;Ljava/security/SecureRandom;)V
      37: goto          50
      40: astore_1
      41: new           #148                // class java/lang/IllegalArgumentException
      44: dup
      45: aload_1
      46: invokespecial #149                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/Throwable;)V
      49: athrow
      50: aload_0
      51: invokeinterface #150,  1          // InterfaceMethod org/apache/tomcat/util/net/SSLContext.getSupportedSSLParameters:()Ljavax/net/ssl/SSLParameters;
      56: invokevirtual #151                // Method javax/net/ssl/SSLParameters.getProtocols:()[Ljava/lang/String;
      59: astore_1
      60: new           #152                // class java/util/HashSet
      63: dup
      64: aload_1
      65: arraylength
      66: invokespecial #153                // Method java/util/HashSet."<init>":(I)V
      69: putstatic     #5                  // Field implementedProtocols:Ljava/util/Set;
      72: aload_1
      73: astore_2
      74: aload_2
      75: arraylength
      76: istore_3
      77: iconst_0
      78: istore        4
      80: iload         4
      82: iload_3
      83: if_icmpge     177
      86: aload_2
      87: iload         4
      89: aaload
      90: astore        5
      92: aload         5
      94: getstatic     #64                 // Field java/util/Locale.ENGLISH:Ljava/util/Locale;
      97: invokevirtual #154                // Method java/lang/String.toUpperCase:(Ljava/util/Locale;)Ljava/lang/String;
     100: astore        6
     102: ldc           #155                // String SSLV2HELLO
     104: aload         6
     106: invokevirtual #63                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     109: ifne          160
     112: ldc           #156                // String SSLV3
     114: aload         6
     116: invokevirtual #63                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     119: ifne          160
     122: aload         6
     124: ldc           #157                // String SSL
     126: invokevirtual #158                // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
     129: ifeq          160
     132: getstatic     #4                  // Field log:Lorg/apache/juli/logging/Log;
     135: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     138: ldc           #159                // String jsse.excludeProtocol
     140: iconst_1
     141: anewarray     #45                 // class java/lang/Object
     144: dup
     145: iconst_0
     146: aload         5
     148: aastore
     149: invokevirtual #46                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     152: invokeinterface #115,  2          // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     157: goto          171
     160: getstatic     #5                  // Field implementedProtocols:Ljava/util/Set;
     163: aload         5
     165: invokeinterface #160,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     170: pop
     171: iinc          4, 1
     174: goto          80
     177: getstatic     #5                  // Field implementedProtocols:Ljava/util/Set;
     180: invokeinterface #161,  1          // InterfaceMethod java/util/Set.size:()I
     185: ifne          204
     188: getstatic     #4                  // Field log:Lorg/apache/juli/logging/Log;
     191: getstatic     #19                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     194: ldc           #162                // String jsse.noDefaultProtocols
     196: invokevirtual #21                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     199: invokeinterface #100,  2          // InterfaceMethod org/apache/juli/logging/Log.warn:(Ljava/lang/Object;)V
     204: aload_0
     205: invokeinterface #150,  1          // InterfaceMethod org/apache/tomcat/util/net/SSLContext.getSupportedSSLParameters:()Ljavax/net/ssl/SSLParameters;
     210: invokevirtual #163                // Method javax/net/ssl/SSLParameters.getCipherSuites:()[Ljava/lang/String;
     213: astore_2
     214: getstatic     #164                // Field org/apache/tomcat/util/compat/JreVendor.IS_IBM_JVM:Z
     217: ifeq          319
     220: new           #152                // class java/util/HashSet
     223: dup
     224: aload_2
     225: arraylength
     226: iconst_2
     227: imul
     228: invokespecial #153                // Method java/util/HashSet."<init>":(I)V
     231: putstatic     #6                  // Field implementedCiphers:Ljava/util/Set;
     234: aload_2
     235: astore_3
     236: aload_3
     237: arraylength
     238: istore        4
     240: iconst_0
     241: istore        5
     243: iload         5
     245: iload         4
     247: if_icmpge     316
     250: aload_3
     251: iload         5
     253: aaload
     254: astore        6
     256: getstatic     #6                  // Field implementedCiphers:Ljava/util/Set;
     259: aload         6
     261: invokeinterface #160,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     266: pop
     267: aload         6
     269: ldc           #157                // String SSL
     271: invokevirtual #165                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     274: ifeq          310
     277: getstatic     #6                  // Field implementedCiphers:Ljava/util/Set;
     280: new           #166                // class java/lang/StringBuilder
     283: dup
     284: invokespecial #167                // Method java/lang/StringBuilder."<init>":()V
     287: ldc           #144                // String TLS
     289: invokevirtual #168                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     292: aload         6
     294: iconst_3
     295: invokevirtual #169                // Method java/lang/String.substring:(I)Ljava/lang/String;
     298: invokevirtual #168                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     301: invokevirtual #170                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     304: invokeinterface #160,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     309: pop
     310: iinc          5, 1
     313: goto          243
     316: goto          344
     319: new           #152                // class java/util/HashSet
     322: dup
     323: aload_2
     324: arraylength
     325: invokespecial #153                // Method java/util/HashSet."<init>":(I)V
     328: putstatic     #6                  // Field implementedCiphers:Ljava/util/Set;
     331: getstatic     #6                  // Field implementedCiphers:Ljava/util/Set;
     334: aload_2
     335: invokestatic  #171                // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
     338: invokeinterface #172,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     343: pop
     344: return
    Exception table:
       from    to  target type
          18    37    40   Class java/security/NoSuchAlgorithmException
          18    37    40   Class java/security/KeyManagementException
}
