Compiled from "RestCsrfPreventionFilter.java"
class org.apache.catalina.filters.RestCsrfPreventionFilter$StateChangingRequest extends org.apache.catalina.filters.RestCsrfPreventionFilter$RestCsrfPreventionStrategy {
  final org.apache.catalina.filters.RestCsrfPreventionFilter this$0;

  private org.apache.catalina.filters.RestCsrfPreventionFilter$StateChangingRequest(org.apache.catalina.filters.RestCsrfPreventionFilter);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #2                  // Field this$0:Lorg/apache/catalina/filters/RestCsrfPreventionFilter;
       5: aload_0
       6: aconst_null
       7: invokespecial #3                  // Method org/apache/catalina/filters/RestCsrfPreventionFilter$RestCsrfPreventionStrategy."<init>":(Lorg/apache/catalina/filters/RestCsrfPreventionFilter$1;)V
      10: return

  public boolean apply(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse) throws java.io.IOException;
    Code:
       0: aload_0
       1: aload_0
       2: aload_1
       3: invokespecial #4                  // Method extractNonceFromRequest:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
       6: aload_0
       7: aload_1
       8: iconst_0
       9: invokeinterface #5,  2            // InterfaceMethod javax/servlet/http/HttpServletRequest.getSession:(Z)Ljavax/servlet/http/HttpSession;
      14: ldc           #6                  // String org.apache.catalina.filters.CSRF_REST_NONCE
      16: invokevirtual #7                  // Method extractNonceFromSession:(Ljavax/servlet/http/HttpSession;Ljava/lang/String;)Ljava/lang/String;
      19: invokespecial #8                  // Method isValidStateChangingRequest:(Ljava/lang/String;Ljava/lang/String;)Z
      22: ifeq          27
      25: iconst_1
      26: ireturn
      27: aload_0
      28: aload_2
      29: ldc           #9                  // String X-CSRF-Token
      31: ldc           #10                 // String Required
      33: invokevirtual #11                 // Method storeNonceToResponse:(Ljavax/servlet/http/HttpServletResponse;Ljava/lang/String;Ljava/lang/String;)V
      36: aload_2
      37: aload_0
      38: getfield      #2                  // Field this$0:Lorg/apache/catalina/filters/RestCsrfPreventionFilter;
      41: invokevirtual #12                 // Method org/apache/catalina/filters/RestCsrfPreventionFilter.getDenyStatus:()I
      44: getstatic     #13                 // Field org/apache/catalina/filters/FilterBase.sm:Lorg/apache/tomcat/util/res/StringManager;
      47: ldc           #14                 // String restCsrfPreventionFilter.invalidNonce
      49: invokevirtual #15                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      52: invokeinterface #16,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(ILjava/lang/String;)V
      57: iconst_0
      58: ireturn

  private boolean isValidStateChangingRequest(java.lang.String, java.lang.String);
    Code:
       0: aload_1
       1: ifnull        20
       4: aload_2
       5: ifnull        20
       8: aload_1
       9: aload_2
      10: invokestatic  #17                 // Method java/util/Objects.equals:(Ljava/lang/Object;Ljava/lang/Object;)Z
      13: ifeq          20
      16: iconst_1
      17: goto          21
      20: iconst_0
      21: ireturn

  private java.lang.String extractNonceFromRequest(javax.servlet.http.HttpServletRequest);
    Code:
       0: aload_0
       1: aload_1
       2: ldc           #9                  // String X-CSRF-Token
       4: invokevirtual #18                 // Method extractNonceFromRequestHeader:(Ljavax/servlet/http/HttpServletRequest;Ljava/lang/String;)Ljava/lang/String;
       7: astore_2
       8: aload_2
       9: ifnull        21
      12: ldc           #19                 // String
      14: aload_2
      15: invokestatic  #17                 // Method java/util/Objects.equals:(Ljava/lang/Object;Ljava/lang/Object;)Z
      18: ifeq          65
      21: aload_0
      22: getfield      #2                  // Field this$0:Lorg/apache/catalina/filters/RestCsrfPreventionFilter;
      25: invokevirtual #20                 // Method org/apache/catalina/filters/RestCsrfPreventionFilter.getPathsAcceptingParams:()Ljava/util/Set;
      28: invokeinterface #21,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
      33: ifne          65
      36: aload_0
      37: getfield      #2                  // Field this$0:Lorg/apache/catalina/filters/RestCsrfPreventionFilter;
      40: invokevirtual #20                 // Method org/apache/catalina/filters/RestCsrfPreventionFilter.getPathsAcceptingParams:()Ljava/util/Set;
      43: aload_0
      44: getfield      #2                  // Field this$0:Lorg/apache/catalina/filters/RestCsrfPreventionFilter;
      47: aload_1
      48: invokevirtual #22                 // Method org/apache/catalina/filters/RestCsrfPreventionFilter.getRequestedPath:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
      51: invokeinterface #23,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      56: ifeq          65
      59: aload_0
      60: aload_1
      61: invokespecial #24                 // Method extractNonceFromRequestParams:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
      64: astore_2
      65: aload_2
      66: areturn

  private java.lang.String extractNonceFromRequestParams(javax.servlet.http.HttpServletRequest);
    Code:
       0: aload_0
       1: aload_1
       2: ldc           #9                  // String X-CSRF-Token
       4: invokevirtual #25                 // Method extractNonceFromRequestParams:(Ljavax/servlet/http/HttpServletRequest;Ljava/lang/String;)[Ljava/lang/String;
       7: astore_2
       8: aload_2
       9: ifnull        65
      12: aload_2
      13: arraylength
      14: ifle          65
      17: aload_2
      18: iconst_0
      19: aaload
      20: astore_3
      21: aload_2
      22: astore        4
      24: aload         4
      26: arraylength
      27: istore        5
      29: iconst_0
      30: istore        6
      32: iload         6
      34: iload         5
      36: if_icmpge     63
      39: aload         4
      41: iload         6
      43: aaload
      44: astore        7
      46: aload         7
      48: aload_3
      49: invokestatic  #17                 // Method java/util/Objects.equals:(Ljava/lang/Object;Ljava/lang/Object;)Z
      52: ifne          57
      55: aconst_null
      56: areturn
      57: iinc          6, 1
      60: goto          32
      63: aload_3
      64: areturn
      65: aconst_null
      66: areturn

  org.apache.catalina.filters.RestCsrfPreventionFilter$StateChangingRequest(org.apache.catalina.filters.RestCsrfPreventionFilter, org.apache.catalina.filters.RestCsrfPreventionFilter$1);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #1                  // Method "<init>":(Lorg/apache/catalina/filters/RestCsrfPreventionFilter;)V
       5: return
}
