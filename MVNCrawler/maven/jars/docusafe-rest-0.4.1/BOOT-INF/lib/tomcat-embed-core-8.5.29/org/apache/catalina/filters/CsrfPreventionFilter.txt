Compiled from "CsrfPreventionFilter.java"
public class org.apache.catalina.filters.CsrfPreventionFilter extends org.apache.catalina.filters.CsrfPreventionFilterBase {
  private final java.util.Set<java.lang.String> entryPoints;

  private int nonceCacheSize;

  public org.apache.catalina.filters.CsrfPreventionFilter();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/catalina/filters/CsrfPreventionFilterBase."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/HashSet
       8: dup
       9: invokespecial #3                  // Method java/util/HashSet."<init>":()V
      12: putfield      #4                  // Field entryPoints:Ljava/util/Set;
      15: aload_0
      16: iconst_5
      17: putfield      #5                  // Field nonceCacheSize:I
      20: return

  public void setEntryPoints(java.lang.String);
    Code:
       0: aload_1
       1: ldc           #6                  // String ,
       3: invokevirtual #7                  // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
       6: astore_2
       7: aload_2
       8: astore_3
       9: aload_3
      10: arraylength
      11: istore        4
      13: iconst_0
      14: istore        5
      16: iload         5
      18: iload         4
      20: if_icmpge     50
      23: aload_3
      24: iload         5
      26: aaload
      27: astore        6
      29: aload_0
      30: getfield      #4                  // Field entryPoints:Ljava/util/Set;
      33: aload         6
      35: invokevirtual #8                  // Method java/lang/String.trim:()Ljava/lang/String;
      38: invokeinterface #9,  2            // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      43: pop
      44: iinc          5, 1
      47: goto          16
      50: return

  public void setNonceCacheSize(int);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #5                  // Field nonceCacheSize:I
       5: return

  public void doFilter(javax.servlet.ServletRequest, javax.servlet.ServletResponse, javax.servlet.FilterChain) throws java.io.IOException, javax.servlet.ServletException;
    Code:
       0: aconst_null
       1: astore        4
       3: aload_1
       4: instanceof    #10                 // class javax/servlet/http/HttpServletRequest
       7: ifeq          222
      10: aload_2
      11: instanceof    #11                 // class javax/servlet/http/HttpServletResponse
      14: ifeq          222
      17: aload_1
      18: checkcast     #10                 // class javax/servlet/http/HttpServletRequest
      21: astore        5
      23: aload_2
      24: checkcast     #11                 // class javax/servlet/http/HttpServletResponse
      27: astore        6
      29: iconst_0
      30: istore        7
      32: ldc           #12                 // String GET
      34: aload         5
      36: invokeinterface #13,  1           // InterfaceMethod javax/servlet/http/HttpServletRequest.getMethod:()Ljava/lang/String;
      41: invokevirtual #14                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      44: ifeq          68
      47: aload_0
      48: getfield      #4                  // Field entryPoints:Ljava/util/Set;
      51: aload_0
      52: aload         5
      54: invokevirtual #15                 // Method getRequestedPath:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
      57: invokeinterface #16,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      62: ifeq          68
      65: iconst_1
      66: istore        7
      68: aload         5
      70: iconst_0
      71: invokeinterface #17,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getSession:(Z)Ljavax/servlet/http/HttpSession;
      76: astore        8
      78: aload         8
      80: ifnonnull     87
      83: aconst_null
      84: goto          99
      87: aload         8
      89: ldc           #18                 // String org.apache.catalina.filters.CSRF_NONCE
      91: invokeinterface #19,  2           // InterfaceMethod javax/servlet/http/HttpSession.getAttribute:(Ljava/lang/String;)Ljava/lang/Object;
      96: checkcast     #20                 // class org/apache/catalina/filters/CsrfPreventionFilter$LruCache
      99: astore        9
     101: iload         7
     103: ifne          149
     106: aload         5
     108: ldc           #18                 // String org.apache.catalina.filters.CSRF_NONCE
     110: invokeinterface #21,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameter:(Ljava/lang/String;)Ljava/lang/String;
     115: astore        10
     117: aload         9
     119: ifnull        137
     122: aload         10
     124: ifnull        137
     127: aload         9
     129: aload         10
     131: invokevirtual #22                 // Method org/apache/catalina/filters/CsrfPreventionFilter$LruCache.contains:(Ljava/lang/Object;)Z
     134: ifne          149
     137: aload         6
     139: aload_0
     140: invokevirtual #23                 // Method getDenyStatus:()I
     143: invokeinterface #24,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(I)V
     148: return
     149: aload         9
     151: ifnonnull     193
     154: new           #20                 // class org/apache/catalina/filters/CsrfPreventionFilter$LruCache
     157: dup
     158: aload_0
     159: getfield      #5                  // Field nonceCacheSize:I
     162: invokespecial #25                 // Method org/apache/catalina/filters/CsrfPreventionFilter$LruCache."<init>":(I)V
     165: astore        9
     167: aload         8
     169: ifnonnull     182
     172: aload         5
     174: iconst_1
     175: invokeinterface #17,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getSession:(Z)Ljavax/servlet/http/HttpSession;
     180: astore        8
     182: aload         8
     184: ldc           #18                 // String org.apache.catalina.filters.CSRF_NONCE
     186: aload         9
     188: invokeinterface #26,  3           // InterfaceMethod javax/servlet/http/HttpSession.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
     193: aload_0
     194: invokevirtual #27                 // Method generateNonce:()Ljava/lang/String;
     197: astore        10
     199: aload         9
     201: aload         10
     203: invokevirtual #28                 // Method org/apache/catalina/filters/CsrfPreventionFilter$LruCache.add:(Ljava/lang/Object;)V
     206: new           #29                 // class org/apache/catalina/filters/CsrfPreventionFilter$CsrfResponseWrapper
     209: dup
     210: aload         6
     212: aload         10
     214: invokespecial #30                 // Method org/apache/catalina/filters/CsrfPreventionFilter$CsrfResponseWrapper."<init>":(Ljavax/servlet/http/HttpServletResponse;Ljava/lang/String;)V
     217: astore        4
     219: goto          225
     222: aload_2
     223: astore        4
     225: aload_3
     226: aload_1
     227: aload         4
     229: invokeinterface #31,  3           // InterfaceMethod javax/servlet/FilterChain.doFilter:(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V
     234: return
}
