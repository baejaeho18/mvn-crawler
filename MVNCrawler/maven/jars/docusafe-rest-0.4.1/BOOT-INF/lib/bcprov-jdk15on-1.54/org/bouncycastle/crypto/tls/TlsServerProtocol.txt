public class org.bouncycastle.crypto.tls.TlsServerProtocol extends org.bouncycastle.crypto.tls.TlsProtocol {
  protected org.bouncycastle.crypto.tls.TlsServer tlsServer;

  org.bouncycastle.crypto.tls.TlsServerContextImpl tlsServerContext;

  protected org.bouncycastle.crypto.tls.TlsKeyExchange keyExchange;

  protected org.bouncycastle.crypto.tls.TlsCredentials serverCredentials;

  protected org.bouncycastle.crypto.tls.CertificateRequest certificateRequest;

  protected short clientCertificateType;

  protected org.bouncycastle.crypto.tls.TlsHandshakeHash prepareFinishHash;

  public org.bouncycastle.crypto.tls.TlsServerProtocol(java.io.InputStream, java.io.OutputStream, java.security.SecureRandom);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: invokespecial #613                // Method org/bouncycastle/crypto/tls/TlsProtocol."<init>":(Ljava/io/InputStream;Ljava/io/OutputStream;Ljava/security/SecureRandom;)V
       7: aload_0
       8: aconst_null
       9: putfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      12: aload_0
      13: aconst_null
      14: putfield      #568                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
      17: aload_0
      18: aconst_null
      19: putfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      22: aload_0
      23: aconst_null
      24: putfield      #564                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
      27: aload_0
      28: aconst_null
      29: putfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      32: aload_0
      33: iconst_m1
      34: putfield      #548                // Field clientCertificateType:S
      37: aload_0
      38: aconst_null
      39: putfield      #565                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      42: return

  public org.bouncycastle.crypto.tls.TlsServerProtocol(java.security.SecureRandom);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #612                // Method org/bouncycastle/crypto/tls/TlsProtocol."<init>":(Ljava/security/SecureRandom;)V
       5: aload_0
       6: aconst_null
       7: putfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      10: aload_0
      11: aconst_null
      12: putfield      #568                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
      15: aload_0
      16: aconst_null
      17: putfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      20: aload_0
      21: aconst_null
      22: putfield      #564                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
      25: aload_0
      26: aconst_null
      27: putfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      30: aload_0
      31: iconst_m1
      32: putfield      #548                // Field clientCertificateType:S
      35: aload_0
      36: aconst_null
      37: putfield      #565                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      40: return

  public void accept(org.bouncycastle.crypto.tls.TlsServer) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #236                // class java/lang/IllegalArgumentException
       7: dup
       8: ldc           #2                  // String \'tlsServer\' cannot be null
      10: invokespecial #571                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      13: athrow
      14: aload_0
      15: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      18: ifnull        31
      21: new           #237                // class java/lang/IllegalStateException
      24: dup
      25: ldc           #1                  // String \'accept\' can only be called once
      27: invokespecial #573                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      30: athrow
      31: aload_0
      32: aload_1
      33: putfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      36: aload_0
      37: new           #249                // class org/bouncycastle/crypto/tls/SecurityParameters
      40: dup
      41: invokespecial #600                // Method org/bouncycastle/crypto/tls/SecurityParameters."<init>":()V
      44: putfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      47: aload_0
      48: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      51: iconst_0
      52: putfield      #535                // Field org/bouncycastle/crypto/tls/SecurityParameters.entity:I
      55: aload_0
      56: new           #261                // class org/bouncycastle/crypto/tls/TlsServerContextImpl
      59: dup
      60: aload_0
      61: getfield      #557                // Field secureRandom:Ljava/security/SecureRandom;
      64: aload_0
      65: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      68: invokespecial #619                // Method org/bouncycastle/crypto/tls/TlsServerContextImpl."<init>":(Ljava/security/SecureRandom;Lorg/bouncycastle/crypto/tls/SecurityParameters;)V
      71: putfield      #568                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
      74: aload_0
      75: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      78: aload_1
      79: invokeinterface #699,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.shouldUseGMTUnixTime:()Z
      84: aload_0
      85: getfield      #568                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
      88: invokevirtual #618                // Method org/bouncycastle/crypto/tls/TlsServerContextImpl.getNonceRandomGenerator:()Lorg/bouncycastle/crypto/prng/RandomGenerator;
      91: invokestatic  #639                // Method createRandomBlock:(ZLorg/bouncycastle/crypto/prng/RandomGenerator;)[B
      94: putfield      #544                // Field org/bouncycastle/crypto/tls/SecurityParameters.serverRandom:[B
      97: aload_0
      98: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     101: aload_0
     102: getfield      #568                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
     105: invokeinterface #716,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.init:(Lorg/bouncycastle/crypto/tls/TlsServerContext;)V
     110: aload_0
     111: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     114: aload_0
     115: getfield      #568                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
     118: invokevirtual #595                // Method org/bouncycastle/crypto/tls/RecordStream.init:(Lorg/bouncycastle/crypto/tls/TlsContext;)V
     121: aload_0
     122: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     125: iconst_0
     126: invokevirtual #592                // Method org/bouncycastle/crypto/tls/RecordStream.setRestrictReadVersion:(Z)V
     129: aload_0
     130: invokevirtual #621                // Method blockForHandshake:()V
     133: return

  protected void cleanupHandshake();
    Code:
       0: aload_0
       1: invokespecial #610                // Method org/bouncycastle/crypto/tls/TlsProtocol.cleanupHandshake:()V
       4: aload_0
       5: aconst_null
       6: putfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
       9: aload_0
      10: aconst_null
      11: putfield      #564                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
      14: aload_0
      15: aconst_null
      16: putfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      19: aload_0
      20: aconst_null
      21: putfield      #565                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      24: return

  protected org.bouncycastle.crypto.tls.TlsContext getContext();
    Code:
       0: aload_0
       1: getfield      #568                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
       4: areturn

  org.bouncycastle.crypto.tls.AbstractTlsContext getContextAdmin();
    Code:
       0: aload_0
       1: getfield      #568                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
       4: areturn

  protected org.bouncycastle.crypto.tls.TlsPeer getPeer();
    Code:
       0: aload_0
       1: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
       4: areturn

  protected void handleHandshakeMessage(short, byte[]) throws java.io.IOException;
    Code:
       0: new           #233                // class java/io/ByteArrayInputStream
       3: dup
       4: aload_2
       5: invokespecial #570                // Method java/io/ByteArrayInputStream."<init>":([B)V
       8: astore_3
       9: iload_1
      10: tableswitch   { // 0 to 23
                     0: 987
                     1: 120
                     2: 987
                     3: 987
                     4: 987
                     5: 987
                     6: 987
                     7: 987
                     8: 987
                     9: 987
                    10: 987
                    11: 584
                    12: 987
                    13: 987
                    14: 987
                    15: 803
                    16: 667
                    17: 987
                    18: 987
                    19: 987
                    20: 865
                    21: 987
                    22: 987
                    23: 529
               default: 987
          }
     120: aload_0
     121: getfield      #549                // Field connection_state:S
     124: lookupswitch  { // 2
                     0: 152
                    16: 512
               default: 519
          }
     152: aload_0
     153: aload_3
     154: invokevirtual #636                // Method receiveClientHelloMessage:(Ljava/io/ByteArrayInputStream;)V
     157: aload_0
     158: iconst_1
     159: putfield      #549                // Field connection_state:S
     162: aload_0
     163: invokevirtual #627                // Method sendServerHelloMessage:()V
     166: aload_0
     167: iconst_2
     168: putfield      #549                // Field connection_state:S
     171: aload_0
     172: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     175: invokevirtual #591                // Method org/bouncycastle/crypto/tls/RecordStream.notifyHelloComplete:()V
     178: aload_0
     179: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     182: invokeinterface #706,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getServerSupplementalData:()Ljava/util/Vector;
     187: astore        4
     189: aload         4
     191: ifnull        200
     194: aload_0
     195: aload         4
     197: invokevirtual #638                // Method sendSupplementalDataMessage:(Ljava/util/Vector;)V
     200: aload_0
     201: iconst_3
     202: putfield      #549                // Field connection_state:S
     205: aload_0
     206: aload_0
     207: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     210: invokeinterface #715,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getKeyExchange:()Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     215: putfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     218: aload_0
     219: getfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     222: aload_0
     223: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     226: invokeinterface #693,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.init:(Lorg/bouncycastle/crypto/tls/TlsContext;)V
     231: aload_0
     232: aload_0
     233: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     236: invokeinterface #714,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getCredentials:()Lorg/bouncycastle/crypto/tls/TlsCredentials;
     241: putfield      #564                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     244: aconst_null
     245: astore        5
     247: aload_0
     248: getfield      #564                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     251: ifnonnull     266
     254: aload_0
     255: getfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     258: invokeinterface #688,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.skipServerCredentials:()V
     263: goto          296
     266: aload_0
     267: getfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     270: aload_0
     271: getfield      #564                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     274: invokeinterface #694,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.processServerCredentials:(Lorg/bouncycastle/crypto/tls/TlsCredentials;)V
     279: aload_0
     280: getfield      #564                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     283: invokeinterface #684,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsCredentials.getCertificate:()Lorg/bouncycastle/crypto/tls/Certificate;
     288: astore        5
     290: aload_0
     291: aload         5
     293: invokevirtual #642                // Method sendCertificateMessage:(Lorg/bouncycastle/crypto/tls/Certificate;)V
     296: aload_0
     297: iconst_4
     298: putfield      #549                // Field connection_state:S
     301: aload         5
     303: ifnull        314
     306: aload         5
     308: invokevirtual #578                // Method org/bouncycastle/crypto/tls/Certificate.isEmpty:()Z
     311: ifeq          319
     314: aload_0
     315: iconst_0
     316: putfield      #550                // Field allowCertificateStatus:Z
     319: aload_0
     320: getfield      #550                // Field allowCertificateStatus:Z
     323: ifeq          348
     326: aload_0
     327: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     330: invokeinterface #710,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getCertificateStatus:()Lorg/bouncycastle/crypto/tls/CertificateStatus;
     335: astore        6
     337: aload         6
     339: ifnull        348
     342: aload_0
     343: aload         6
     345: invokevirtual #644                // Method sendCertificateStatusMessage:(Lorg/bouncycastle/crypto/tls/CertificateStatus;)V
     348: aload_0
     349: iconst_5
     350: putfield      #549                // Field connection_state:S
     353: aload_0
     354: getfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     357: invokeinterface #689,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.generateServerKeyExchange:()[B
     362: astore        6
     364: aload         6
     366: ifnull        375
     369: aload_0
     370: aload         6
     372: invokevirtual #629                // Method sendServerKeyExchangeMessage:([B)V
     375: aload_0
     376: bipush        6
     378: putfield      #549                // Field connection_state:S
     381: aload_0
     382: getfield      #564                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     385: ifnull        481
     388: aload_0
     389: aload_0
     390: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     393: invokeinterface #709,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getCertificateRequest:()Lorg/bouncycastle/crypto/tls/CertificateRequest;
     398: putfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     401: aload_0
     402: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     405: ifnull        481
     408: aload_0
     409: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     412: invokestatic  #669                // Method org/bouncycastle/crypto/tls/TlsUtils.isTLSv12:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
     415: aload_0
     416: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     419: invokevirtual #582                // Method org/bouncycastle/crypto/tls/CertificateRequest.getSupportedSignatureAlgorithms:()Ljava/util/Vector;
     422: ifnull        429
     425: iconst_1
     426: goto          430
     429: iconst_0
     430: if_icmpeq     443
     433: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     436: dup
     437: bipush        80
     439: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     442: athrow
     443: aload_0
     444: getfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     447: aload_0
     448: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     451: invokeinterface #692,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.validateCertificateRequest:(Lorg/bouncycastle/crypto/tls/CertificateRequest;)V
     456: aload_0
     457: aload_0
     458: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     461: invokevirtual #643                // Method sendCertificateRequestMessage:(Lorg/bouncycastle/crypto/tls/CertificateRequest;)V
     464: aload_0
     465: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     468: invokevirtual #596                // Method org/bouncycastle/crypto/tls/RecordStream.getHandshakeHash:()Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
     471: aload_0
     472: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     475: invokevirtual #582                // Method org/bouncycastle/crypto/tls/CertificateRequest.getSupportedSignatureAlgorithms:()Ljava/util/Vector;
     478: invokestatic  #674                // Method org/bouncycastle/crypto/tls/TlsUtils.trackHashAlgorithms:(Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;Ljava/util/Vector;)V
     481: aload_0
     482: bipush        7
     484: putfield      #549                // Field connection_state:S
     487: aload_0
     488: invokevirtual #626                // Method sendServerHelloDoneMessage:()V
     491: aload_0
     492: bipush        8
     494: putfield      #549                // Field connection_state:S
     497: aload_0
     498: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     501: invokevirtual #596                // Method org/bouncycastle/crypto/tls/RecordStream.getHandshakeHash:()Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
     504: invokeinterface #685,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsHandshakeHash.sealHashAlgorithms:()V
     509: goto          997
     512: aload_0
     513: invokevirtual #623                // Method refuseRenegotiation:()V
     516: goto          997
     519: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     522: dup
     523: bipush        10
     525: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     528: athrow
     529: aload_0
     530: getfield      #549                // Field connection_state:S
     533: lookupswitch  { // 1
                     8: 552
               default: 574
          }
     552: aload_0
     553: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     556: aload_3
     557: invokestatic  #652                // Method readSupplementalDataMessage:(Ljava/io/ByteArrayInputStream;)Ljava/util/Vector;
     560: invokeinterface #707,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientSupplementalData:(Ljava/util/Vector;)V
     565: aload_0
     566: bipush        9
     568: putfield      #549                // Field connection_state:S
     571: goto          997
     574: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     577: dup
     578: bipush        10
     580: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     583: athrow
     584: aload_0
     585: getfield      #549                // Field connection_state:S
     588: lookupswitch  { // 2
                     8: 616
                     9: 626
               default: 657
          }
     616: aload_0
     617: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     620: aconst_null
     621: invokeinterface #707,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientSupplementalData:(Ljava/util/Vector;)V
     626: aload_0
     627: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     630: ifnonnull     643
     633: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     636: dup
     637: bipush        10
     639: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     642: athrow
     643: aload_0
     644: aload_3
     645: invokevirtual #634                // Method receiveCertificateMessage:(Ljava/io/ByteArrayInputStream;)V
     648: aload_0
     649: bipush        10
     651: putfield      #549                // Field connection_state:S
     654: goto          997
     657: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     660: dup
     661: bipush        10
     663: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     666: athrow
     667: aload_0
     668: getfield      #549                // Field connection_state:S
     671: tableswitch   { // 8 to 10
                     8: 696
                     9: 706
                    10: 779
               default: 793
          }
     696: aload_0
     697: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     700: aconst_null
     701: invokeinterface #707,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientSupplementalData:(Ljava/util/Vector;)V
     706: aload_0
     707: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     710: ifnonnull     725
     713: aload_0
     714: getfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     717: invokeinterface #687,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.skipClientCredentials:()V
     722: goto          779
     725: aload_0
     726: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     729: invokestatic  #669                // Method org/bouncycastle/crypto/tls/TlsUtils.isTLSv12:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
     732: ifeq          745
     735: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     738: dup
     739: bipush        10
     741: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     744: athrow
     745: aload_0
     746: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     749: invokestatic  #668                // Method org/bouncycastle/crypto/tls/TlsUtils.isSSL:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
     752: ifeq          772
     755: aload_0
     756: getfield      #560                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
     759: ifnonnull     779
     762: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     765: dup
     766: bipush        10
     768: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     771: athrow
     772: aload_0
     773: getstatic     #533                // Field org/bouncycastle/crypto/tls/Certificate.EMPTY_CHAIN:Lorg/bouncycastle/crypto/tls/Certificate;
     776: invokevirtual #641                // Method notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
     779: aload_0
     780: aload_3
     781: invokevirtual #637                // Method receiveClientKeyExchangeMessage:(Ljava/io/ByteArrayInputStream;)V
     784: aload_0
     785: bipush        11
     787: putfield      #549                // Field connection_state:S
     790: goto          997
     793: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     796: dup
     797: bipush        10
     799: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     802: athrow
     803: aload_0
     804: getfield      #549                // Field connection_state:S
     807: lookupswitch  { // 1
                    11: 824
               default: 855
          }
     824: aload_0
     825: invokevirtual #628                // Method expectCertificateVerifyMessage:()Z
     828: ifne          841
     831: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     834: dup
     835: bipush        10
     837: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     840: athrow
     841: aload_0
     842: aload_3
     843: invokevirtual #635                // Method receiveCertificateVerifyMessage:(Ljava/io/ByteArrayInputStream;)V
     846: aload_0
     847: bipush        12
     849: putfield      #549                // Field connection_state:S
     852: goto          997
     855: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     858: dup
     859: bipush        10
     861: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     864: athrow
     865: aload_0
     866: getfield      #549                // Field connection_state:S
     869: lookupswitch  { // 2
                    11: 896
                    12: 913
               default: 977
          }
     896: aload_0
     897: invokevirtual #628                // Method expectCertificateVerifyMessage:()Z
     900: ifeq          913
     903: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     906: dup
     907: bipush        10
     909: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     912: athrow
     913: aload_0
     914: aload_3
     915: invokevirtual #633                // Method processFinishedMessage:(Ljava/io/ByteArrayInputStream;)V
     918: aload_0
     919: bipush        13
     921: putfield      #549                // Field connection_state:S
     924: aload_0
     925: getfield      #551                // Field expectSessionTicket:Z
     928: ifeq          948
     931: aload_0
     932: aload_0
     933: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     936: invokeinterface #711,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getNewSessionTicket:()Lorg/bouncycastle/crypto/tls/NewSessionTicket;
     941: invokevirtual #645                // Method sendNewSessionTicketMessage:(Lorg/bouncycastle/crypto/tls/NewSessionTicket;)V
     944: aload_0
     945: invokevirtual #624                // Method sendChangeCipherSpecMessage:()V
     948: aload_0
     949: bipush        14
     951: putfield      #549                // Field connection_state:S
     954: aload_0
     955: invokevirtual #625                // Method sendFinishedMessage:()V
     958: aload_0
     959: bipush        15
     961: putfield      #549                // Field connection_state:S
     964: aload_0
     965: bipush        16
     967: putfield      #549                // Field connection_state:S
     970: aload_0
     971: invokevirtual #622                // Method completeHandshake:()V
     974: goto          997
     977: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     980: dup
     981: bipush        10
     983: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     986: athrow
     987: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     990: dup
     991: bipush        10
     993: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     996: athrow
     997: return

  protected void handleWarningMessage(short) throws java.io.IOException;
    Code:
       0: iload_1
       1: lookupswitch  { // 1
                    41: 20
               default: 47
          }
      20: aload_0
      21: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      24: invokestatic  #668                // Method org/bouncycastle/crypto/tls/TlsUtils.isSSL:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
      27: ifeq          52
      30: aload_0
      31: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      34: ifnull        52
      37: aload_0
      38: getstatic     #533                // Field org/bouncycastle/crypto/tls/Certificate.EMPTY_CHAIN:Lorg/bouncycastle/crypto/tls/Certificate;
      41: invokevirtual #641                // Method notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      44: goto          52
      47: aload_0
      48: iload_1
      49: invokespecial #611                // Method org/bouncycastle/crypto/tls/TlsProtocol.handleWarningMessage:(S)V
      52: return

  protected void notifyClientCertificate(org.bouncycastle.crypto.tls.Certificate) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
       4: ifnonnull     15
       7: new           #237                // class java/lang/IllegalStateException
      10: dup
      11: invokespecial #572                // Method java/lang/IllegalStateException."<init>":()V
      14: athrow
      15: aload_0
      16: getfield      #560                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
      19: ifnull        32
      22: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      25: dup
      26: bipush        10
      28: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      31: athrow
      32: aload_0
      33: aload_1
      34: putfield      #560                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
      37: aload_1
      38: invokevirtual #578                // Method org/bouncycastle/crypto/tls/Certificate.isEmpty:()Z
      41: ifeq          56
      44: aload_0
      45: getfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      48: invokeinterface #687,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.skipClientCredentials:()V
      53: goto          83
      56: aload_0
      57: aload_1
      58: aload_0
      59: getfield      #564                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
      62: invokeinterface #684,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsCredentials.getCertificate:()Lorg/bouncycastle/crypto/tls/Certificate;
      67: invokestatic  #675                // Method org/bouncycastle/crypto/tls/TlsUtils.getClientCertificateType:(Lorg/bouncycastle/crypto/tls/Certificate;Lorg/bouncycastle/crypto/tls/Certificate;)S
      70: putfield      #548                // Field clientCertificateType:S
      73: aload_0
      74: getfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      77: aload_1
      78: invokeinterface #691,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.processClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      83: aload_0
      84: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      87: aload_1
      88: invokeinterface #708,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      93: return

  protected void receiveCertificateMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokestatic  #580                // Method org/bouncycastle/crypto/tls/Certificate.parse:(Ljava/io/InputStream;)Lorg/bouncycastle/crypto/tls/Certificate;
       4: astore_2
       5: aload_1
       6: invokestatic  #632                // Method assertEmpty:(Ljava/io/ByteArrayInputStream;)V
       9: aload_0
      10: aload_2
      11: invokevirtual #641                // Method notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      14: return

  protected void receiveCertificateVerifyMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
       4: ifnonnull     15
       7: new           #237                // class java/lang/IllegalStateException
      10: dup
      11: invokespecial #572                // Method java/lang/IllegalStateException."<init>":()V
      14: athrow
      15: aload_0
      16: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      19: aload_1
      20: invokestatic  #587                // Method org/bouncycastle/crypto/tls/DigitallySigned.parse:(Lorg/bouncycastle/crypto/tls/TlsContext;Ljava/io/InputStream;)Lorg/bouncycastle/crypto/tls/DigitallySigned;
      23: astore_2
      24: aload_1
      25: invokestatic  #632                // Method assertEmpty:(Ljava/io/ByteArrayInputStream;)V
      28: aload_2
      29: invokevirtual #586                // Method org/bouncycastle/crypto/tls/DigitallySigned.getAlgorithm:()Lorg/bouncycastle/crypto/tls/SignatureAndHashAlgorithm;
      32: astore_3
      33: aload_0
      34: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      37: invokestatic  #669                // Method org/bouncycastle/crypto/tls/TlsUtils.isTLSv12:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
      40: ifeq          72
      43: aload_0
      44: getfield      #561                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      47: invokevirtual #582                // Method org/bouncycastle/crypto/tls/CertificateRequest.getSupportedSignatureAlgorithms:()Ljava/util/Vector;
      50: aload_3
      51: invokestatic  #677                // Method org/bouncycastle/crypto/tls/TlsUtils.verifySupportedSignatureAlgorithm:(Ljava/util/Vector;Lorg/bouncycastle/crypto/tls/SignatureAndHashAlgorithm;)V
      54: aload_0
      55: getfield      #565                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      58: aload_3
      59: invokevirtual #602                // Method org/bouncycastle/crypto/tls/SignatureAndHashAlgorithm.getHash:()S
      62: invokeinterface #686,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsHandshakeHash.getFinalHash:(S)[B
      67: astore        4
      69: goto          81
      72: aload_0
      73: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      76: invokevirtual #601                // Method org/bouncycastle/crypto/tls/SecurityParameters.getSessionHash:()[B
      79: astore        4
      81: aload_0
      82: getfield      #560                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
      85: iconst_0
      86: invokevirtual #579                // Method org/bouncycastle/crypto/tls/Certificate.getCertificateAt:(I)Lorg/bouncycastle/asn1/x509/Certificate;
      89: astore        5
      91: aload         5
      93: invokevirtual #575                // Method org/bouncycastle/asn1/x509/Certificate.getSubjectPublicKeyInfo:()Lorg/bouncycastle/asn1/x509/SubjectPublicKeyInfo;
      96: astore        6
      98: aload         6
     100: invokestatic  #678                // Method org/bouncycastle/crypto/util/PublicKeyFactory.createKey:(Lorg/bouncycastle/asn1/x509/SubjectPublicKeyInfo;)Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     103: astore        7
     105: aload_0
     106: getfield      #548                // Field clientCertificateType:S
     109: invokestatic  #670                // Method org/bouncycastle/crypto/tls/TlsUtils.createTlsSigner:(S)Lorg/bouncycastle/crypto/tls/TlsSigner;
     112: astore        8
     114: aload         8
     116: aload_0
     117: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     120: invokeinterface #717,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsSigner.init:(Lorg/bouncycastle/crypto/tls/TlsContext;)V
     125: aload         8
     127: aload_3
     128: aload_2
     129: invokevirtual #585                // Method org/bouncycastle/crypto/tls/DigitallySigned.getSignature:()[B
     132: aload         7
     134: aload         4
     136: invokeinterface #718,  5          // InterfaceMethod org/bouncycastle/crypto/tls/TlsSigner.verifyRawSignature:(Lorg/bouncycastle/crypto/tls/SignatureAndHashAlgorithm;[BLorg/bouncycastle/crypto/params/AsymmetricKeyParameter;[B)Z
     141: ifne          154
     144: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     147: dup
     148: bipush        51
     150: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     153: athrow
     154: goto          172
     157: astore_3
     158: aload_3
     159: athrow
     160: astore_3
     161: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     164: dup
     165: bipush        51
     167: aload_3
     168: invokespecial #609                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(SLjava/lang/Throwable;)V
     171: athrow
     172: return
    Exception table:
       from    to  target type
          28   154   157   Class org/bouncycastle/crypto/tls/TlsFatalAlert
          28   154   160   Class java/lang/Exception

  protected void receiveClientHelloMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokestatic  #676                // Method org/bouncycastle/crypto/tls/TlsUtils.readVersion:(Ljava/io/InputStream;)Lorg/bouncycastle/crypto/tls/ProtocolVersion;
       4: astore_2
       5: aload_0
       6: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
       9: aload_2
      10: invokevirtual #594                // Method org/bouncycastle/crypto/tls/RecordStream.setWriteVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      13: aload_2
      14: invokevirtual #589                // Method org/bouncycastle/crypto/tls/ProtocolVersion.isDTLS:()Z
      17: ifeq          30
      20: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      23: dup
      24: bipush        47
      26: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      29: athrow
      30: bipush        32
      32: aload_1
      33: invokestatic  #658                // Method org/bouncycastle/crypto/tls/TlsUtils.readFully:(ILjava/io/InputStream;)[B
      36: astore_3
      37: aload_1
      38: invokestatic  #663                // Method org/bouncycastle/crypto/tls/TlsUtils.readOpaque8:(Ljava/io/InputStream;)[B
      41: astore        4
      43: aload         4
      45: arraylength
      46: bipush        32
      48: if_icmple     61
      51: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      54: dup
      55: bipush        47
      57: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      60: athrow
      61: aload_1
      62: invokestatic  #661                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint16:(Ljava/io/InputStream;)I
      65: istore        5
      67: iload         5
      69: iconst_2
      70: if_icmplt     80
      73: iload         5
      75: iconst_1
      76: iand
      77: ifeq          90
      80: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      83: dup
      84: bipush        50
      86: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      89: athrow
      90: aload_0
      91: iload         5
      93: iconst_2
      94: idiv
      95: aload_1
      96: invokestatic  #659                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint16Array:(ILjava/io/InputStream;)[I
      99: putfield      #554                // Field offeredCipherSuites:[I
     102: aload_1
     103: invokestatic  #662                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint8:(Ljava/io/InputStream;)S
     106: istore        6
     108: iload         6
     110: iconst_1
     111: if_icmpge     124
     114: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     117: dup
     118: bipush        47
     120: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     123: athrow
     124: aload_0
     125: iload         6
     127: aload_1
     128: invokestatic  #660                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint8Array:(ILjava/io/InputStream;)[S
     131: putfield      #555                // Field offeredCompressionMethods:[S
     134: aload_0
     135: aload_1
     136: invokestatic  #649                // Method readExtensions:(Ljava/io/ByteArrayInputStream;)Ljava/util/Hashtable;
     139: putfield      #558                // Field clientExtensions:Ljava/util/Hashtable;
     142: aload_0
     143: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     146: aload_0
     147: getfield      #558                // Field clientExtensions:Ljava/util/Hashtable;
     150: invokestatic  #605                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.hasExtendedMasterSecretExtension:(Ljava/util/Hashtable;)Z
     153: putfield      #541                // Field org/bouncycastle/crypto/tls/SecurityParameters.extendedMasterSecret:Z
     156: aload_0
     157: invokevirtual #640                // Method getContextAdmin:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
     160: aload_2
     161: invokevirtual #576                // Method org/bouncycastle/crypto/tls/AbstractTlsContext.setClientVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
     164: aload_0
     165: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     168: aload_2
     169: invokeinterface #713,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyClientVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
     174: aload_0
     175: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     178: aload_0
     179: getfield      #554                // Field offeredCipherSuites:[I
     182: sipush        22016
     185: invokestatic  #680                // Method org/bouncycastle/util/Arrays.contains:([II)Z
     188: invokeinterface #700,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyFallback:(Z)V
     193: aload_0
     194: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     197: aload_3
     198: putfield      #543                // Field org/bouncycastle/crypto/tls/SecurityParameters.clientRandom:[B
     201: aload_0
     202: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     205: aload_0
     206: getfield      #554                // Field offeredCipherSuites:[I
     209: invokeinterface #702,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyOfferedCipherSuites:([I)V
     214: aload_0
     215: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     218: aload_0
     219: getfield      #555                // Field offeredCompressionMethods:[S
     222: invokeinterface #703,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyOfferedCompressionMethods:([S)V
     227: aload_0
     228: getfield      #554                // Field offeredCipherSuites:[I
     231: sipush        255
     234: invokestatic  #680                // Method org/bouncycastle/util/Arrays.contains:([II)Z
     237: ifeq          245
     240: aload_0
     241: iconst_1
     242: putfield      #553                // Field secure_renegotiation:Z
     245: aload_0
     246: getfield      #558                // Field clientExtensions:Ljava/util/Hashtable;
     249: getstatic     #556                // Field EXT_RenegotiationInfo:Ljava/lang/Integer;
     252: invokestatic  #672                // Method org/bouncycastle/crypto/tls/TlsUtils.getExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;)[B
     255: astore        7
     257: aload         7
     259: ifnull        291
     262: aload_0
     263: iconst_1
     264: putfield      #553                // Field secure_renegotiation:Z
     267: aload         7
     269: getstatic     #569                // Field org/bouncycastle/crypto/tls/TlsUtils.EMPTY_BYTES:[B
     272: invokestatic  #630                // Method createRenegotiationInfo:([B)[B
     275: invokestatic  #679                // Method org/bouncycastle/util/Arrays.constantTimeAreEqual:([B[B)Z
     278: ifne          291
     281: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     284: dup
     285: bipush        40
     287: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     290: athrow
     291: aload_0
     292: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     295: aload_0
     296: getfield      #553                // Field secure_renegotiation:Z
     299: invokeinterface #701,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifySecureRenegotiation:(Z)V
     304: aload_0
     305: getfield      #558                // Field clientExtensions:Ljava/util/Hashtable;
     308: ifnull        324
     311: aload_0
     312: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     315: aload_0
     316: getfield      #558                // Field clientExtensions:Ljava/util/Hashtable;
     319: invokeinterface #705,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientExtensions:(Ljava/util/Hashtable;)V
     324: return

  protected void receiveClientKeyExchangeMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
       4: aload_1
       5: invokeinterface #690,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.processClientKeyExchange:(Ljava/io/InputStream;)V
      10: aload_1
      11: invokestatic  #632                // Method assertEmpty:(Ljava/io/ByteArrayInputStream;)V
      14: aload_0
      15: aload_0
      16: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      19: invokevirtual #597                // Method org/bouncycastle/crypto/tls/RecordStream.prepareToFinish:()Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      22: putfield      #565                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      25: aload_0
      26: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      29: aload_0
      30: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      33: aload_0
      34: getfield      #565                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      37: aconst_null
      38: invokestatic  #653                // Method getCurrentPRFHash:(Lorg/bouncycastle/crypto/tls/TlsContext;Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;[B)[B
      41: putfield      #545                // Field org/bouncycastle/crypto/tls/SecurityParameters.sessionHash:[B
      44: aload_0
      45: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      48: aload_0
      49: getfield      #566                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      52: invokestatic  #654                // Method establishMasterSecret:(Lorg/bouncycastle/crypto/tls/TlsContext;Lorg/bouncycastle/crypto/tls/TlsKeyExchange;)V
      55: aload_0
      56: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      59: aload_0
      60: invokevirtual #648                // Method getPeer:()Lorg/bouncycastle/crypto/tls/TlsPeer;
      63: invokeinterface #696,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsPeer.getCompression:()Lorg/bouncycastle/crypto/tls/TlsCompression;
      68: aload_0
      69: invokevirtual #648                // Method getPeer:()Lorg/bouncycastle/crypto/tls/TlsPeer;
      72: invokeinterface #695,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsPeer.getCipher:()Lorg/bouncycastle/crypto/tls/TlsCipher;
      77: invokevirtual #598                // Method org/bouncycastle/crypto/tls/RecordStream.setPendingConnectionState:(Lorg/bouncycastle/crypto/tls/TlsCompression;Lorg/bouncycastle/crypto/tls/TlsCipher;)V
      80: aload_0
      81: getfield      #551                // Field expectSessionTicket:Z
      84: ifne          91
      87: aload_0
      88: invokevirtual #624                // Method sendChangeCipherSpecMessage:()V
      91: return

  protected void sendCertificateRequestMessage(org.bouncycastle.crypto.tls.CertificateRequest) throws java.io.IOException;
    Code:
       0: new           #259                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: bipush        13
       7: invokespecial #616                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
      10: astore_2
      11: aload_1
      12: aload_2
      13: invokevirtual #581                // Method org/bouncycastle/crypto/tls/CertificateRequest.encode:(Ljava/io/OutputStream;)V
      16: aload_2
      17: invokevirtual #614                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      20: return

  protected void sendCertificateStatusMessage(org.bouncycastle.crypto.tls.CertificateStatus) throws java.io.IOException;
    Code:
       0: new           #259                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: bipush        22
       7: invokespecial #616                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
      10: astore_2
      11: aload_1
      12: aload_2
      13: invokevirtual #583                // Method org/bouncycastle/crypto/tls/CertificateStatus.encode:(Ljava/io/OutputStream;)V
      16: aload_2
      17: invokevirtual #614                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      20: return

  protected void sendNewSessionTicketMessage(org.bouncycastle.crypto.tls.NewSessionTicket) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
       7: dup
       8: bipush        80
      10: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      13: athrow
      14: new           #259                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
      17: dup
      18: aload_0
      19: iconst_4
      20: invokespecial #616                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
      23: astore_2
      24: aload_1
      25: aload_2
      26: invokevirtual #588                // Method org/bouncycastle/crypto/tls/NewSessionTicket.encode:(Ljava/io/OutputStream;)V
      29: aload_2
      30: invokevirtual #614                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      33: return

  protected void sendServerHelloMessage() throws java.io.IOException;
    Code:
       0: new           #259                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: iconst_2
       6: invokespecial #616                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
       9: astore_1
      10: aload_0
      11: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      14: invokeinterface #712,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getServerVersion:()Lorg/bouncycastle/crypto/tls/ProtocolVersion;
      19: astore_2
      20: aload_2
      21: aload_0
      22: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
      25: invokeinterface #682,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.getClientVersion:()Lorg/bouncycastle/crypto/tls/ProtocolVersion;
      30: invokevirtual #590                // Method org/bouncycastle/crypto/tls/ProtocolVersion.isEqualOrEarlierVersionOf:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)Z
      33: ifne          46
      36: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      39: dup
      40: bipush        80
      42: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      45: athrow
      46: aload_0
      47: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      50: aload_2
      51: invokevirtual #593                // Method org/bouncycastle/crypto/tls/RecordStream.setReadVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      54: aload_0
      55: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      58: aload_2
      59: invokevirtual #594                // Method org/bouncycastle/crypto/tls/RecordStream.setWriteVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      62: aload_0
      63: getfield      #562                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      66: iconst_1
      67: invokevirtual #592                // Method org/bouncycastle/crypto/tls/RecordStream.setRestrictReadVersion:(Z)V
      70: aload_0
      71: invokevirtual #640                // Method getContextAdmin:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
      74: aload_2
      75: invokevirtual #577                // Method org/bouncycastle/crypto/tls/AbstractTlsContext.setServerVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      78: aload_2
      79: aload_1
      80: invokestatic  #671                // Method org/bouncycastle/crypto/tls/TlsUtils.writeVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;Ljava/io/OutputStream;)V
      83: aload_1
      84: aload_0
      85: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      88: getfield      #544                // Field org/bouncycastle/crypto/tls/SecurityParameters.serverRandom:[B
      91: invokevirtual #615                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.write:([B)V
      94: getstatic     #569                // Field org/bouncycastle/crypto/tls/TlsUtils.EMPTY_BYTES:[B
      97: aload_1
      98: invokestatic  #666                // Method org/bouncycastle/crypto/tls/TlsUtils.writeOpaque8:([BLjava/io/OutputStream;)V
     101: aload_0
     102: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     105: invokeinterface #697,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getSelectedCipherSuite:()I
     110: istore_2
     111: aload_0
     112: getfield      #554                // Field offeredCipherSuites:[I
     115: iload_2
     116: invokestatic  #680                // Method org/bouncycastle/util/Arrays.contains:([II)Z
     119: ifeq          149
     122: iload_2
     123: ifeq          149
     126: iload_2
     127: invokestatic  #584                // Method org/bouncycastle/crypto/tls/CipherSuite.isSCSV:(I)Z
     130: ifne          149
     133: iload_2
     134: aload_0
     135: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     138: invokeinterface #683,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.getServerVersion:()Lorg/bouncycastle/crypto/tls/ProtocolVersion;
     143: invokestatic  #667                // Method org/bouncycastle/crypto/tls/TlsUtils.isValidCipherSuiteForVersion:(ILorg/bouncycastle/crypto/tls/ProtocolVersion;)Z
     146: ifne          159
     149: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     152: dup
     153: bipush        80
     155: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     158: athrow
     159: aload_0
     160: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     163: iload_2
     164: putfield      #534                // Field org/bouncycastle/crypto/tls/SecurityParameters.cipherSuite:I
     167: aload_0
     168: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     171: invokeinterface #698,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getSelectedCompressionMethod:()S
     176: istore_3
     177: aload_0
     178: getfield      #555                // Field offeredCompressionMethods:[S
     181: iload_3
     182: invokestatic  #681                // Method org/bouncycastle/util/Arrays.contains:([SS)Z
     185: ifne          198
     188: new           #254                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     191: dup
     192: bipush        80
     194: invokespecial #608                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     197: athrow
     198: aload_0
     199: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     202: iload_3
     203: putfield      #538                // Field org/bouncycastle/crypto/tls/SecurityParameters.compressionAlgorithm:S
     206: iload_2
     207: aload_1
     208: invokestatic  #664                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint16:(ILjava/io/OutputStream;)V
     211: iload_3
     212: aload_1
     213: invokestatic  #665                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint8:(SLjava/io/OutputStream;)V
     216: aload_0
     217: aload_0
     218: getfield      #567                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     221: invokeinterface #704,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getServerExtensions:()Ljava/util/Hashtable;
     226: putfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     229: aload_0
     230: getfield      #553                // Field secure_renegotiation:Z
     233: ifeq          294
     236: aload_0
     237: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     240: getstatic     #556                // Field EXT_RenegotiationInfo:Ljava/lang/Integer;
     243: invokestatic  #672                // Method org/bouncycastle/crypto/tls/TlsUtils.getExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;)[B
     246: astore        4
     248: aconst_null
     249: aload         4
     251: if_acmpne     258
     254: iconst_1
     255: goto          259
     258: iconst_0
     259: istore        5
     261: iload         5
     263: ifeq          294
     266: aload_0
     267: aload_0
     268: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     271: invokestatic  #607                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.ensureExtensionsInitialised:(Ljava/util/Hashtable;)Ljava/util/Hashtable;
     274: putfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     277: aload_0
     278: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     281: getstatic     #556                // Field EXT_RenegotiationInfo:Ljava/lang/Integer;
     284: getstatic     #569                // Field org/bouncycastle/crypto/tls/TlsUtils.EMPTY_BYTES:[B
     287: invokestatic  #630                // Method createRenegotiationInfo:([B)[B
     290: invokevirtual #574                // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     293: pop
     294: aload_0
     295: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     298: getfield      #541                // Field org/bouncycastle/crypto/tls/SecurityParameters.extendedMasterSecret:Z
     301: ifeq          322
     304: aload_0
     305: aload_0
     306: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     309: invokestatic  #607                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.ensureExtensionsInitialised:(Ljava/util/Hashtable;)Ljava/util/Hashtable;
     312: putfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     315: aload_0
     316: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     319: invokestatic  #603                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.addExtendedMasterSecretExtension:(Ljava/util/Hashtable;)V
     322: aload_0
     323: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     326: ifnull        448
     329: aload_0
     330: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     333: aload_0
     334: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     337: invokestatic  #604                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.hasEncryptThenMACExtension:(Ljava/util/Hashtable;)Z
     340: putfield      #540                // Field org/bouncycastle/crypto/tls/SecurityParameters.encryptThenMAC:Z
     343: aload_0
     344: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     347: aload_0
     348: aload_0
     349: getfield      #558                // Field clientExtensions:Ljava/util/Hashtable;
     352: aload_0
     353: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     356: bipush        80
     358: invokevirtual #651                // Method processMaxFragmentLengthExtension:(Ljava/util/Hashtable;Ljava/util/Hashtable;S)S
     361: putfield      #539                // Field org/bouncycastle/crypto/tls/SecurityParameters.maxFragmentLength:S
     364: aload_0
     365: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     368: aload_0
     369: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     372: invokestatic  #606                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.hasTruncatedHMacExtension:(Ljava/util/Hashtable;)Z
     375: putfield      #542                // Field org/bouncycastle/crypto/tls/SecurityParameters.truncatedHMac:Z
     378: aload_0
     379: aload_0
     380: getfield      #552                // Field resumedSession:Z
     383: ifne          405
     386: aload_0
     387: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     390: getstatic     #546                // Field org/bouncycastle/crypto/tls/TlsExtensionsUtils.EXT_status_request:Ljava/lang/Integer;
     393: bipush        80
     395: invokestatic  #673                // Method org/bouncycastle/crypto/tls/TlsUtils.hasExpectedEmptyExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;S)Z
     398: ifeq          405
     401: iconst_1
     402: goto          406
     405: iconst_0
     406: putfield      #550                // Field allowCertificateStatus:Z
     409: aload_0
     410: aload_0
     411: getfield      #552                // Field resumedSession:Z
     414: ifne          436
     417: aload_0
     418: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     421: getstatic     #547                // Field org/bouncycastle/crypto/tls/TlsProtocol.EXT_SessionTicket:Ljava/lang/Integer;
     424: bipush        80
     426: invokestatic  #673                // Method org/bouncycastle/crypto/tls/TlsUtils.hasExpectedEmptyExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;S)Z
     429: ifeq          436
     432: iconst_1
     433: goto          437
     436: iconst_0
     437: putfield      #551                // Field expectSessionTicket:Z
     440: aload_1
     441: aload_0
     442: getfield      #559                // Field serverExtensions:Ljava/util/Hashtable;
     445: invokestatic  #650                // Method writeExtensions:(Ljava/io/OutputStream;Ljava/util/Hashtable;)V
     448: aload_0
     449: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     452: aload_0
     453: invokevirtual #646                // Method getContext:()Lorg/bouncycastle/crypto/tls/TlsContext;
     456: aload_0
     457: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     460: invokevirtual #599                // Method org/bouncycastle/crypto/tls/SecurityParameters.getCipherSuite:()I
     463: invokestatic  #647                // Method getPRFAlgorithm:(Lorg/bouncycastle/crypto/tls/TlsContext;I)I
     466: putfield      #536                // Field org/bouncycastle/crypto/tls/SecurityParameters.prfAlgorithm:I
     469: aload_0
     470: getfield      #563                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     473: bipush        12
     475: putfield      #537                // Field org/bouncycastle/crypto/tls/SecurityParameters.verifyDataLength:I
     478: aload_0
     479: invokevirtual #620                // Method applyMaxFragmentLengthExtension:()V
     482: aload_1
     483: invokevirtual #614                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
     486: return

  protected void sendServerHelloDoneMessage() throws java.io.IOException;
    Code:
       0: iconst_4
       1: newarray       byte
       3: astore_1
       4: bipush        14
       6: aload_1
       7: iconst_0
       8: invokestatic  #657                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint8:(S[BI)V
      11: iconst_0
      12: aload_1
      13: iconst_1
      14: invokestatic  #655                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint24:(I[BI)V
      17: aload_0
      18: aload_1
      19: iconst_0
      20: aload_1
      21: arraylength
      22: invokevirtual #631                // Method writeHandshakeMessage:([BII)V
      25: return

  protected void sendServerKeyExchangeMessage(byte[]) throws java.io.IOException;
    Code:
       0: new           #259                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: bipush        12
       7: aload_1
       8: arraylength
       9: invokespecial #617                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;SI)V
      12: astore_2
      13: aload_2
      14: aload_1
      15: invokevirtual #615                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.write:([B)V
      18: aload_2
      19: invokevirtual #614                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      22: return

  protected boolean expectCertificateVerifyMessage();
    Code:
       0: aload_0
       1: getfield      #548                // Field clientCertificateType:S
       4: iflt          21
       7: aload_0
       8: getfield      #548                // Field clientCertificateType:S
      11: invokestatic  #656                // Method org/bouncycastle/crypto/tls/TlsUtils.hasSigningCapability:(S)Z
      14: ifeq          21
      17: iconst_1
      18: goto          22
      21: iconst_0
      22: ireturn
}
