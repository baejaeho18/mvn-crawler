Compiled from "X509CredentialsAuthenticationHandler.java"
public class org.apereo.cas.adaptors.x509.authentication.handler.support.X509CredentialsAuthenticationHandler extends org.apereo.cas.authentication.handler.support.AbstractPreAndPostProcessingAuthenticationHandler {
  private static final java.lang.String KEY_USAGE_OID;

  private transient org.slf4j.Logger logger;

  private java.util.regex.Pattern regExTrustedIssuerDnPattern;

  private int maxPathLength;

  private boolean maxPathLengthAllowUnspecified;

  private boolean checkKeyUsage;

  private boolean requireKeyUsage;

  private java.util.regex.Pattern regExSubjectDnPattern;

  private org.apereo.cas.adaptors.x509.authentication.revocation.checker.RevocationChecker revocationChecker;

  public org.apereo.cas.adaptors.x509.authentication.handler.support.X509CredentialsAuthenticationHandler();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apereo/cas/authentication/handler/support/AbstractPreAndPostProcessingAuthenticationHandler."<init>":()V
       4: aload_0
       5: aload_0
       6: invokevirtual #2                  // Method java/lang/Object.getClass:()Ljava/lang/Class;
       9: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      12: putfield      #4                  // Field logger:Lorg/slf4j/Logger;
      15: aload_0
      16: new           #5                  // class org/apereo/cas/adaptors/x509/authentication/revocation/checker/NoOpRevocationChecker
      19: dup
      20: invokespecial #6                  // Method org/apereo/cas/adaptors/x509/authentication/revocation/checker/NoOpRevocationChecker."<init>":()V
      23: putfield      #7                  // Field revocationChecker:Lorg/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker;
      26: return

  public boolean supports(org.apereo.cas.authentication.Credential);
    Code:
       0: aload_1
       1: ifnull        20
       4: ldc           #8                  // class org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential
       6: aload_1
       7: invokevirtual #2                  // Method java/lang/Object.getClass:()Ljava/lang/Class;
      10: invokevirtual #9                  // Method java/lang/Class.isAssignableFrom:(Ljava/lang/Class;)Z
      13: ifeq          20
      16: iconst_1
      17: goto          21
      20: iconst_0
      21: ireturn

  public void init();
    Code:
       0: aload_0
       1: getfield      #7                  // Field revocationChecker:Lorg/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker;
       4: ifnonnull     17
       7: new           #10                 // class java/lang/IllegalArgumentException
      10: dup
      11: ldc           #11                 // String Revocation checker is not configured
      13: invokespecial #12                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: return

  protected org.apereo.cas.authentication.HandlerResult doAuthentication(org.apereo.cas.authentication.Credential) throws java.security.GeneralSecurityException, org.apereo.cas.authentication.PreventedException;
    Code:
       0: aload_1
       1: checkcast     #8                  // class org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential
       4: astore_2
       5: aload_2
       6: invokevirtual #13                 // Method org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential.getCertificates:()[Ljava/security/cert/X509Certificate;
       9: astore_3
      10: aconst_null
      11: astore        4
      13: iconst_0
      14: istore        5
      16: aload_3
      17: arraylength
      18: iconst_1
      19: isub
      20: istore        6
      22: iload         6
      24: iflt          115
      27: aload_3
      28: iload         6
      30: aaload
      31: astore        7
      33: aload_0
      34: getfield      #4                  // Field logger:Lorg/slf4j/Logger;
      37: ldc           #14                 // String Evaluating {}
      39: aload         7
      41: invokestatic  #15                 // Method org/apereo/cas/adaptors/x509/util/CertUtils.toString:(Ljava/security/cert/X509Certificate;)Ljava/lang/String;
      44: invokeinterface #16,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      49: aload_0
      50: aload         7
      52: invokespecial #17                 // Method validate:(Ljava/security/cert/X509Certificate;)V
      55: iload         5
      57: ifne          68
      60: aload_0
      61: aload         7
      63: invokespecial #18                 // Method isCertificateFromTrustedIssuer:(Ljava/security/cert/X509Certificate;)Z
      66: istore        5
      68: aload         7
      70: invokevirtual #19                 // Method java/security/cert/X509Certificate.getBasicConstraints:()I
      73: istore        8
      75: iload         8
      77: ifge          98
      80: aload_0
      81: getfield      #4                  // Field logger:Lorg/slf4j/Logger;
      84: ldc           #20                 // String Found valid client certificate
      86: invokeinterface #21,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      91: aload         7
      93: astore        4
      95: goto          109
      98: aload_0
      99: getfield      #4                  // Field logger:Lorg/slf4j/Logger;
     102: ldc           #22                 // String Found valid CA certificate
     104: invokeinterface #21,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     109: iinc          6, -1
     112: goto          22
     115: iload         5
     117: ifeq          154
     120: aload         4
     122: ifnull        154
     125: aload_2
     126: aload         4
     128: invokevirtual #23                 // Method org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential.setCertificate:(Ljava/security/cert/X509Certificate;)V
     131: new           #24                 // class org/apereo/cas/authentication/DefaultHandlerResult
     134: dup
     135: aload_0
     136: aload_2
     137: aload_0
     138: getfield      #25                 // Field principalFactory:Lorg/apereo/cas/authentication/principal/PrincipalFactory;
     141: aload_2
     142: invokevirtual #26                 // Method org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential.getId:()Ljava/lang/String;
     145: invokeinterface #27,  2           // InterfaceMethod org/apereo/cas/authentication/principal/PrincipalFactory.createPrincipal:(Ljava/lang/String;)Lorg/apereo/cas/authentication/principal/Principal;
     150: invokespecial #28                 // Method org/apereo/cas/authentication/DefaultHandlerResult."<init>":(Lorg/apereo/cas/authentication/AuthenticationHandler;Lorg/apereo/cas/authentication/CredentialMetaData;Lorg/apereo/cas/authentication/principal/Principal;)V
     153: areturn
     154: aload_0
     155: getfield      #4                  // Field logger:Lorg/slf4j/Logger;
     158: ldc           #29                 // String Either client certificate could not be determined, or a trusted issuer could not be located
     160: invokeinterface #30,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     165: new           #31                 // class javax/security/auth/login/FailedLoginException
     168: dup
     169: invokespecial #32                 // Method javax/security/auth/login/FailedLoginException."<init>":()V
     172: athrow

  public void setTrustedIssuerDnPattern(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: invokestatic  #33                 // Method java/util/regex/Pattern.compile:(Ljava/lang/String;)Ljava/util/regex/Pattern;
       5: putfield      #34                 // Field regExTrustedIssuerDnPattern:Ljava/util/regex/Pattern;
       8: return

  public void setMaxPathLength(int);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #35                 // Field maxPathLength:I
       5: return

  public void setMaxPathLengthAllowUnspecified(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #36                 // Field maxPathLengthAllowUnspecified:Z
       5: return

  public void setCheckKeyUsage(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #37                 // Field checkKeyUsage:Z
       5: return

  public void setRequireKeyUsage(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #38                 // Field requireKeyUsage:Z
       5: return

  public void setSubjectDnPattern(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: invokestatic  #33                 // Method java/util/regex/Pattern.compile:(Ljava/lang/String;)Ljava/util/regex/Pattern;
       5: putfield      #39                 // Field regExSubjectDnPattern:Ljava/util/regex/Pattern;
       8: return

  public void setRevocationChecker(org.apereo.cas.adaptors.x509.authentication.revocation.checker.RevocationChecker);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #7                  // Field revocationChecker:Lorg/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker;
       5: return

  private void validate(java.security.cert.X509Certificate) throws java.security.GeneralSecurityException;
    Code:
       0: aload_1
       1: invokevirtual #40                 // Method java/security/cert/X509Certificate.checkValidity:()V
       4: aload_0
       5: getfield      #7                  // Field revocationChecker:Lorg/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker;
       8: aload_1
       9: invokeinterface #41,  2           // InterfaceMethod org/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker.check:(Ljava/security/cert/X509Certificate;)V
      14: aload_1
      15: invokevirtual #19                 // Method java/security/cert/X509Certificate.getBasicConstraints:()I
      18: istore_2
      19: iload_2
      20: ifge          89
      23: aload_0
      24: aload_1
      25: invokespecial #42                 // Method isCertificateAllowed:(Ljava/security/cert/X509Certificate;)Z
      28: ifne          64
      31: new           #31                 // class javax/security/auth/login/FailedLoginException
      34: dup
      35: new           #43                 // class java/lang/StringBuilder
      38: dup
      39: invokespecial #44                 // Method java/lang/StringBuilder."<init>":()V
      42: ldc           #45                 // String Certificate subject does not match pattern
      44: invokevirtual #46                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      47: aload_0
      48: getfield      #39                 // Field regExSubjectDnPattern:Ljava/util/regex/Pattern;
      51: invokevirtual #47                 // Method java/util/regex/Pattern.pattern:()Ljava/lang/String;
      54: invokevirtual #46                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      57: invokevirtual #48                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      60: invokespecial #49                 // Method javax/security/auth/login/FailedLoginException."<init>":(Ljava/lang/String;)V
      63: athrow
      64: aload_0
      65: getfield      #37                 // Field checkKeyUsage:Z
      68: ifeq          160
      71: aload_0
      72: aload_1
      73: invokespecial #50                 // Method isValidKeyUsage:(Ljava/security/cert/X509Certificate;)Z
      76: ifne          160
      79: new           #31                 // class javax/security/auth/login/FailedLoginException
      82: dup
      83: ldc           #51                 // String Certificate keyUsage constraint forbids SSL client authentication.
      85: invokespecial #49                 // Method javax/security/auth/login/FailedLoginException."<init>":(Ljava/lang/String;)V
      88: athrow
      89: iload_2
      90: ldc           #53                 // int 2147483647
      92: if_icmpne     112
      95: aload_0
      96: getfield      #36                 // Field maxPathLengthAllowUnspecified:Z
      99: ifne          112
     102: new           #31                 // class javax/security/auth/login/FailedLoginException
     105: dup
     106: ldc           #54                 // String Unlimited certificate path length not allowed by configuration.
     108: invokespecial #49                 // Method javax/security/auth/login/FailedLoginException."<init>":(Ljava/lang/String;)V
     111: athrow
     112: iload_2
     113: aload_0
     114: getfield      #35                 // Field maxPathLength:I
     117: if_icmple     160
     120: iload_2
     121: ldc           #53                 // int 2147483647
     123: if_icmpge     160
     126: new           #31                 // class javax/security/auth/login/FailedLoginException
     129: dup
     130: ldc           #55                 // String Certificate path length %s exceeds maximum value %s.
     132: iconst_2
     133: anewarray     #56                 // class java/lang/Object
     136: dup
     137: iconst_0
     138: iload_2
     139: invokestatic  #57                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     142: aastore
     143: dup
     144: iconst_1
     145: aload_0
     146: getfield      #35                 // Field maxPathLength:I
     149: invokestatic  #57                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     152: aastore
     153: invokestatic  #58                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     156: invokespecial #49                 // Method javax/security/auth/login/FailedLoginException."<init>":(Ljava/lang/String;)V
     159: athrow
     160: return

  private boolean isValidKeyUsage(java.security.cert.X509Certificate);
    Code:
       0: aload_0
       1: getfield      #4                  // Field logger:Lorg/slf4j/Logger;
       4: ldc           #59                 // String Checking certificate keyUsage extension
       6: invokeinterface #21,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      11: aload_1
      12: invokevirtual #60                 // Method java/security/cert/X509Certificate.getKeyUsage:()[Z
      15: astore_2
      16: aload_2
      17: ifnonnull     44
      20: aload_0
      21: getfield      #4                  // Field logger:Lorg/slf4j/Logger;
      24: ldc           #61                 // String Configuration specifies checkKeyUsage but keyUsage extension not found in certificate.
      26: invokeinterface #30,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      31: aload_0
      32: getfield      #38                 // Field requireKeyUsage:Z
      35: ifne          42
      38: iconst_1
      39: goto          43
      42: iconst_0
      43: ireturn
      44: aload_1
      45: ldc           #63                 // String 2.5.29.15
      47: invokestatic  #64                 // Method isCritical:(Ljava/security/cert/X509Certificate;Ljava/lang/String;)Z
      50: ifne          60
      53: aload_0
      54: getfield      #38                 // Field requireKeyUsage:Z
      57: ifeq          78
      60: aload_0
      61: getfield      #4                  // Field logger:Lorg/slf4j/Logger;
      64: ldc           #65                 // String KeyUsage extension is marked critical or required by configuration.
      66: invokeinterface #21,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      71: aload_2
      72: iconst_0
      73: baload
      74: istore_3
      75: goto          91
      78: aload_0
      79: getfield      #4                  // Field logger:Lorg/slf4j/Logger;
      82: ldc           #66                 // String KeyUsage digitalSignature=%s, Returning true since keyUsage validation not required by configuration.
      84: invokeinterface #21,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      89: iconst_1
      90: istore_3
      91: iload_3
      92: ireturn

  private static boolean isCritical(java.security.cert.X509Certificate, java.lang.String);
    Code:
       0: aload_0
       1: invokevirtual #67                 // Method java/security/cert/X509Certificate.getCriticalExtensionOIDs:()Ljava/util/Set;
       4: astore_2
       5: aload_2
       6: ifnull        18
       9: aload_2
      10: invokeinterface #68,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
      15: ifeq          20
      18: iconst_0
      19: ireturn
      20: aload_2
      21: aload_1
      22: invokeinterface #69,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      27: ireturn

  private boolean isCertificateAllowed(java.security.cert.X509Certificate);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #70                 // Method java/security/cert/X509Certificate.getSubjectDN:()Ljava/security/Principal;
       5: aload_0
       6: getfield      #39                 // Field regExSubjectDnPattern:Ljava/util/regex/Pattern;
       9: invokespecial #71                 // Method doesNameMatchPattern:(Ljava/security/Principal;Ljava/util/regex/Pattern;)Z
      12: ireturn

  private boolean isCertificateFromTrustedIssuer(java.security.cert.X509Certificate);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #72                 // Method java/security/cert/X509Certificate.getIssuerDN:()Ljava/security/Principal;
       5: aload_0
       6: getfield      #34                 // Field regExTrustedIssuerDnPattern:Ljava/util/regex/Pattern;
       9: invokespecial #71                 // Method doesNameMatchPattern:(Ljava/security/Principal;Ljava/util/regex/Pattern;)Z
      12: ireturn

  private boolean doesNameMatchPattern(java.security.Principal, java.util.regex.Pattern);
    Code:
       0: aload_2
       1: ifnull        61
       4: aload_1
       5: invokeinterface #73,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      10: astore_3
      11: aload_2
      12: aload_3
      13: invokevirtual #74                 // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
      16: invokevirtual #75                 // Method java/util/regex/Matcher.matches:()Z
      19: istore        4
      21: aload_0
      22: getfield      #4                  // Field logger:Lorg/slf4j/Logger;
      25: ldc           #76                 // String %s matches %s == %s
      27: iconst_3
      28: anewarray     #56                 // class java/lang/Object
      31: dup
      32: iconst_0
      33: aload_2
      34: invokevirtual #47                 // Method java/util/regex/Pattern.pattern:()Ljava/lang/String;
      37: aastore
      38: dup
      39: iconst_1
      40: aload_3
      41: aastore
      42: dup
      43: iconst_2
      44: iload         4
      46: invokestatic  #77                 // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
      49: aastore
      50: invokestatic  #58                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      53: invokeinterface #21,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      58: iload         4
      60: ireturn
      61: iconst_1
      62: ireturn
}
