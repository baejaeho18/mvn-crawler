Compiled from "ApmAsyncListener.java"
public class co.elastic.apm.agent.servlet.helper.ApmAsyncListener implements javax.servlet.AsyncListener {
  private static final java.util.concurrent.atomic.AtomicIntegerFieldUpdater<co.elastic.apm.agent.servlet.helper.ApmAsyncListener> EVENT_COUNTER_UPDATER;

  private final co.elastic.apm.agent.servlet.ServletTransactionHelper servletTransactionHelper;

  private final co.elastic.apm.agent.impl.transaction.Transaction transaction;

  private volatile int endEventCounter;

  co.elastic.apm.agent.servlet.helper.ApmAsyncListener(co.elastic.apm.agent.servlet.ServletTransactionHelper, co.elastic.apm.agent.impl.transaction.Transaction);
    Code:
       0: aload_0
       1: invokespecial #21                 // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iconst_0
       6: putfield      #23                 // Field endEventCounter:I
       9: aload_0
      10: aload_1
      11: putfield      #25                 // Field servletTransactionHelper:Lco/elastic/apm/agent/servlet/ServletTransactionHelper;
      14: aload_0
      15: aload_2
      16: putfield      #27                 // Field transaction:Lco/elastic/apm/agent/impl/transaction/Transaction;
      19: return

  public void onComplete(javax.servlet.AsyncEvent);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #34                 // Method endTransaction:(Ljavax/servlet/AsyncEvent;)V
       5: return

  public void onTimeout(javax.servlet.AsyncEvent);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #34                 // Method endTransaction:(Ljavax/servlet/AsyncEvent;)V
       5: return

  public void onError(javax.servlet.AsyncEvent);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #34                 // Method endTransaction:(Ljavax/servlet/AsyncEvent;)V
       5: return

  public void onStartAsync(javax.servlet.AsyncEvent);
    Code:
       0: aload_1
       1: invokevirtual #45                 // Method javax/servlet/AsyncEvent.getAsyncContext:()Ljavax/servlet/AsyncContext;
       4: astore_2
       5: aload_2
       6: ifnull        24
       9: aload_2
      10: aload_0
      11: aload_1
      12: invokevirtual #49                 // Method javax/servlet/AsyncEvent.getSuppliedRequest:()Ljavax/servlet/ServletRequest;
      15: aload_1
      16: invokevirtual #53                 // Method javax/servlet/AsyncEvent.getSuppliedResponse:()Ljavax/servlet/ServletResponse;
      19: invokeinterface #59,  4           // InterfaceMethod javax/servlet/AsyncContext.addListener:(Ljavax/servlet/AsyncListener;Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V
      24: return

  private void endTransaction(javax.servlet.AsyncEvent);
    Code:
       0: getstatic     #63                 // Field EVENT_COUNTER_UPDATER:Ljava/util/concurrent/atomic/AtomicIntegerFieldUpdater;
       3: aload_0
       4: invokevirtual #69                 // Method java/util/concurrent/atomic/AtomicIntegerFieldUpdater.getAndIncrement:(Ljava/lang/Object;)I
       7: ifle          11
      10: return
      11: aload_1
      12: invokevirtual #49                 // Method javax/servlet/AsyncEvent.getSuppliedRequest:()Ljavax/servlet/ServletRequest;
      15: checkcast     #71                 // class javax/servlet/http/HttpServletRequest
      18: astore_2
      19: aload_2
      20: getstatic     #77                 // Field co/elastic/apm/agent/servlet/ServletTransactionHelper.TRANSACTION_ATTRIBUTE:Ljava/lang/String;
      23: invokeinterface #81,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.removeAttribute:(Ljava/lang/String;)V
      28: aload_1
      29: invokevirtual #53                 // Method javax/servlet/AsyncEvent.getSuppliedResponse:()Ljavax/servlet/ServletResponse;
      32: checkcast     #83                 // class javax/servlet/http/HttpServletResponse
      35: astore_3
      36: aload_0
      37: getfield      #27                 // Field transaction:Lco/elastic/apm/agent/impl/transaction/Transaction;
      40: invokevirtual #89                 // Method co/elastic/apm/agent/impl/transaction/Transaction.getContext:()Lco/elastic/apm/agent/impl/context/TransactionContext;
      43: invokevirtual #95                 // Method co/elastic/apm/agent/impl/context/TransactionContext.getResponse:()Lco/elastic/apm/agent/impl/context/Response;
      46: astore        4
      48: aload_0
      49: getfield      #27                 // Field transaction:Lco/elastic/apm/agent/impl/transaction/Transaction;
      52: invokevirtual #99                 // Method co/elastic/apm/agent/impl/transaction/Transaction.isSampled:()Z
      55: ifeq          122
      58: aload_0
      59: getfield      #25                 // Field servletTransactionHelper:Lco/elastic/apm/agent/servlet/ServletTransactionHelper;
      62: invokevirtual #102                // Method co/elastic/apm/agent/servlet/ServletTransactionHelper.isCaptureHeaders:()Z
      65: ifeq          122
      68: aload_3
      69: invokeinterface #106,  1          // InterfaceMethod javax/servlet/http/HttpServletResponse.getHeaderNames:()Ljava/util/Collection;
      74: invokeinterface #112,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      79: astore        5
      81: aload         5
      83: invokeinterface #119,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      88: ifeq          122
      91: aload         5
      93: invokeinterface #123,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      98: checkcast     #125                // class java/lang/String
     101: astore        6
     103: aload         4
     105: aload         6
     107: aload_3
     108: aload         6
     110: invokeinterface #129,  2          // InterfaceMethod javax/servlet/http/HttpServletResponse.getHeaders:(Ljava/lang/String;)Ljava/util/Collection;
     115: invokevirtual #133                // Method co/elastic/apm/agent/impl/context/Response.addHeader:(Ljava/lang/String;Ljava/util/Collection;)Lco/elastic/apm/agent/impl/context/Response;
     118: pop
     119: goto          81
     122: aload_2
     123: ldc           #135                // String Content-Type
     125: invokeinterface #139,  2          // InterfaceMethod javax/servlet/http/HttpServletRequest.getHeader:(Ljava/lang/String;)Ljava/lang/String;
     130: astore        5
     132: aload_0
     133: getfield      #27                 // Field transaction:Lco/elastic/apm/agent/impl/transaction/Transaction;
     136: invokevirtual #99                 // Method co/elastic/apm/agent/impl/transaction/Transaction.isSampled:()Z
     139: ifeq          171
     142: aload_0
     143: getfield      #25                 // Field servletTransactionHelper:Lco/elastic/apm/agent/servlet/ServletTransactionHelper;
     146: aload_2
     147: invokeinterface #143,  1          // InterfaceMethod javax/servlet/http/HttpServletRequest.getMethod:()Ljava/lang/String;
     152: aload         5
     154: invokevirtual #147                // Method co/elastic/apm/agent/servlet/ServletTransactionHelper.captureParameters:(Ljava/lang/String;Ljava/lang/String;)Z
     157: ifeq          171
     160: aload_2
     161: invokeinterface #151,  1          // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameterMap:()Ljava/util/Map;
     166: astore        6
     168: goto          174
     171: aconst_null
     172: astore        6
     174: aload_0
     175: getfield      #25                 // Field servletTransactionHelper:Lco/elastic/apm/agent/servlet/ServletTransactionHelper;
     178: aload_0
     179: getfield      #27                 // Field transaction:Lco/elastic/apm/agent/impl/transaction/Transaction;
     182: aload_1
     183: invokevirtual #157                // Method javax/servlet/AsyncEvent.getThrowable:()Ljava/lang/Throwable;
     186: aload_3
     187: invokeinterface #160,  1          // InterfaceMethod javax/servlet/http/HttpServletResponse.isCommitted:()Z
     192: aload_3
     193: invokeinterface #164,  1          // InterfaceMethod javax/servlet/http/HttpServletResponse.getStatus:()I
     198: aload_2
     199: invokeinterface #143,  1          // InterfaceMethod javax/servlet/http/HttpServletRequest.getMethod:()Ljava/lang/String;
     204: aload         6
     206: aload_2
     207: invokeinterface #167,  1          // InterfaceMethod javax/servlet/http/HttpServletRequest.getServletPath:()Ljava/lang/String;
     212: aload_2
     213: invokeinterface #170,  1          // InterfaceMethod javax/servlet/http/HttpServletRequest.getPathInfo:()Ljava/lang/String;
     218: aload         5
     220: invokevirtual #174                // Method co/elastic/apm/agent/servlet/ServletTransactionHelper.onAfter:(Lco/elastic/apm/agent/impl/transaction/Transaction;Ljava/lang/Throwable;ZILjava/lang/String;Ljava/util/Map;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     223: return

  static {};
    Code:
       0: ldc           #2                  // class co/elastic/apm/agent/servlet/helper/ApmAsyncListener
       2: ldc           #187                // String endEventCounter
       4: invokestatic  #191                // Method java/util/concurrent/atomic/AtomicIntegerFieldUpdater.newUpdater:(Ljava/lang/Class;Ljava/lang/String;)Ljava/util/concurrent/atomic/AtomicIntegerFieldUpdater;
       7: putstatic     #63                 // Field EVENT_COUNTER_UPDATER:Ljava/util/concurrent/atomic/AtomicIntegerFieldUpdater;
      10: return
}
