Compiled from "ChatServlet.java"
public class com.acme.ChatServlet extends javax.servlet.http.HttpServlet {
  private static final org.eclipse.jetty.util.log.Logger LOG;

  private long asyncTimeout;

  java.util.Map<java.lang.String, java.util.Map<java.lang.String, com.acme.ChatServlet$Member>> _rooms;

  public com.acme.ChatServlet();
    Code:
       0: aload_0
       1: invokespecial #2                  // Method javax/servlet/http/HttpServlet."<init>":()V
       4: aload_0
       5: ldc2_w        #3                  // long 10000l
       8: putfield      #5                  // Field asyncTimeout:J
      11: aload_0
      12: new           #6                  // class java/util/HashMap
      15: dup
      16: invokespecial #7                  // Method java/util/HashMap."<init>":()V
      19: putfield      #8                  // Field _rooms:Ljava/util/Map;
      22: return

  public void init();
    Code:
       0: aload_0
       1: invokevirtual #9                  // Method getServletConfig:()Ljavax/servlet/ServletConfig;
       4: ldc           #10                 // String asyncTimeout
       6: invokeinterface #11,  2           // InterfaceMethod javax/servlet/ServletConfig.getInitParameter:(Ljava/lang/String;)Ljava/lang/String;
      11: astore_1
      12: aload_1
      13: ifnull        24
      16: aload_0
      17: aload_1
      18: invokestatic  #12                 // Method java/lang/Long.parseLong:(Ljava/lang/String;)J
      21: putfield      #5                  // Field asyncTimeout:J
      24: return

  protected void doPost(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse) throws javax.servlet.ServletException, java.io.IOException;
    Code:
       0: aload_1
       1: ldc           #13                 // String join
       3: invokeinterface #14,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameter:(Ljava/lang/String;)Ljava/lang/String;
       8: invokestatic  #15                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
      11: istore_3
      12: aload_1
      13: ldc           #16                 // String message
      15: invokeinterface #14,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameter:(Ljava/lang/String;)Ljava/lang/String;
      20: astore        4
      22: aload_1
      23: ldc           #17                 // String user
      25: invokeinterface #14,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameter:(Ljava/lang/String;)Ljava/lang/String;
      30: astore        5
      32: getstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
      35: ldc           #18                 // String doPost called. join={},message={},username={}
      37: iconst_3
      38: anewarray     #19                 // class java/lang/Object
      41: dup
      42: iconst_0
      43: iload_3
      44: invokestatic  #20                 // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
      47: aastore
      48: dup
      49: iconst_1
      50: aload         4
      52: aastore
      53: dup
      54: iconst_2
      55: aload         5
      57: aastore
      58: invokeinterface #21,  3           // InterfaceMethod org/eclipse/jetty/util/log/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
      63: aload         5
      65: ifnonnull     94
      68: getstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
      71: ldc           #22                 // String no paramter user set, sending 503
      73: iconst_0
      74: anewarray     #19                 // class java/lang/Object
      77: invokeinterface #21,  3           // InterfaceMethod org/eclipse/jetty/util/log/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
      82: aload_2
      83: sipush        503
      86: ldc           #23                 // String user==null
      88: invokeinterface #24,  3           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendError:(ILjava/lang/String;)V
      93: return
      94: aload_0
      95: aload_1
      96: invokeinterface #25,  1           // InterfaceMethod javax/servlet/http/HttpServletRequest.getPathInfo:()Ljava/lang/String;
     101: invokespecial #26                 // Method getRoom:(Ljava/lang/String;)Ljava/util/Map;
     104: astore        6
     106: aload_0
     107: aload         5
     109: aload         6
     111: invokespecial #27                 // Method getMember:(Ljava/lang/String;Ljava/util/Map;)Lcom/acme/ChatServlet$Member;
     114: astore        7
     116: aload         4
     118: ifnull        131
     121: aload_0
     122: aload         4
     124: aload         5
     126: aload         6
     128: invokespecial #28                 // Method sendMessageToAllMembers:(Ljava/lang/String;Ljava/lang/String;Ljava/util/Map;)V
     131: aload         4
     133: ifnull        140
     136: iload_3
     137: ifeq          256
     140: aload         7
     142: dup
     143: astore        8
     145: monitorenter
     146: getstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
     149: ldc           #29                 // String Queue size: {}
     151: aload         7
     153: getfield      #30                 // Field com/acme/ChatServlet$Member._queue:Ljava/util/Queue;
     156: invokeinterface #31,  1           // InterfaceMethod java/util/Queue.size:()I
     161: i2l
     162: invokeinterface #32,  4           // InterfaceMethod org/eclipse/jetty/util/log/Logger.debug:(Ljava/lang/String;J)V
     167: aload         7
     169: getfield      #30                 // Field com/acme/ChatServlet$Member._queue:Ljava/util/Queue;
     172: invokeinterface #31,  1           // InterfaceMethod java/util/Queue.size:()I
     177: ifle          190
     180: aload_0
     181: aload_2
     182: aload         7
     184: invokespecial #33                 // Method sendSingleMessage:(Ljavax/servlet/http/HttpServletResponse;Lcom/acme/ChatServlet$Member;)V
     187: goto          242
     190: getstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
     193: ldc           #34                 // String starting async
     195: iconst_0
     196: anewarray     #19                 // class java/lang/Object
     199: invokeinterface #21,  3           // InterfaceMethod org/eclipse/jetty/util/log/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
     204: aload_1
     205: invokeinterface #35,  1           // InterfaceMethod javax/servlet/http/HttpServletRequest.startAsync:()Ljavax/servlet/AsyncContext;
     210: astore        9
     212: aload         9
     214: aload_0
     215: getfield      #5                  // Field asyncTimeout:J
     218: invokeinterface #36,  3           // InterfaceMethod javax/servlet/AsyncContext.setTimeout:(J)V
     223: aload         9
     225: aload         7
     227: invokeinterface #37,  2           // InterfaceMethod javax/servlet/AsyncContext.addListener:(Ljavax/servlet/AsyncListener;)V
     232: aload         7
     234: getfield      #38                 // Field com/acme/ChatServlet$Member._async:Ljava/util/concurrent/atomic/AtomicReference;
     237: aload         9
     239: invokevirtual #39                 // Method java/util/concurrent/atomic/AtomicReference.set:(Ljava/lang/Object;)V
     242: aload         8
     244: monitorexit
     245: goto          256
     248: astore        10
     250: aload         8
     252: monitorexit
     253: aload         10
     255: athrow
     256: return
    Exception table:
       from    to  target type
         146   245   248   any
         248   253   248   any

  private com.acme.ChatServlet$Member getMember(java.lang.String, java.util.Map<java.lang.String, com.acme.ChatServlet$Member>);
    Code:
       0: aload_2
       1: aload_1
       2: invokeinterface #40,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
       7: checkcast     #41                 // class com/acme/ChatServlet$Member
      10: astore_3
      11: aload_3
      12: ifnonnull     56
      15: getstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
      18: ldc           #42                 // String user: {} in room: {} doesn\'t exist. Creating new user.
      20: iconst_2
      21: anewarray     #19                 // class java/lang/Object
      24: dup
      25: iconst_0
      26: aload_1
      27: aastore
      28: dup
      29: iconst_1
      30: aload_2
      31: aastore
      32: invokeinterface #21,  3           // InterfaceMethod org/eclipse/jetty/util/log/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
      37: new           #41                 // class com/acme/ChatServlet$Member
      40: dup
      41: aload_0
      42: aload_1
      43: invokespecial #43                 // Method com/acme/ChatServlet$Member."<init>":(Lcom/acme/ChatServlet;Ljava/lang/String;)V
      46: astore_3
      47: aload_2
      48: aload_1
      49: aload_3
      50: invokeinterface #44,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      55: pop
      56: aload_3
      57: areturn

  private java.util.Map<java.lang.String, com.acme.ChatServlet$Member> getRoom(java.lang.String);
    Code:
       0: aload_0
       1: getfield      #8                  // Field _rooms:Ljava/util/Map;
       4: aload_1
       5: invokeinterface #40,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      10: checkcast     #45                 // class java/util/Map
      13: astore_2
      14: aload_2
      15: ifnonnull     56
      18: getstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
      21: ldc           #46                 // String room: {} doesn\'t exist. Creating new room.
      23: iconst_1
      24: anewarray     #19                 // class java/lang/Object
      27: dup
      28: iconst_0
      29: aload_1
      30: aastore
      31: invokeinterface #21,  3           // InterfaceMethod org/eclipse/jetty/util/log/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
      36: new           #6                  // class java/util/HashMap
      39: dup
      40: invokespecial #7                  // Method java/util/HashMap."<init>":()V
      43: astore_2
      44: aload_0
      45: getfield      #8                  // Field _rooms:Ljava/util/Map;
      48: aload_1
      49: aload_2
      50: invokeinterface #44,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      55: pop
      56: aload_2
      57: areturn

  private void sendSingleMessage(javax.servlet.http.HttpServletResponse, com.acme.ChatServlet$Member) throws java.io.IOException;
    Code:
       0: aload_1
       1: ldc           #47                 // String text/json;charset=utf-8
       3: invokeinterface #48,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setContentType:(Ljava/lang/String;)V
       8: new           #49                 // class java/lang/StringBuilder
      11: dup
      12: invokespecial #50                 // Method java/lang/StringBuilder."<init>":()V
      15: astore_3
      16: aload_3
      17: ldc           #51                 // String {\"from\":\"
      19: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      22: pop
      23: aload_3
      24: aload_2
      25: getfield      #30                 // Field com/acme/ChatServlet$Member._queue:Ljava/util/Queue;
      28: invokeinterface #53,  1           // InterfaceMethod java/util/Queue.poll:()Ljava/lang/Object;
      33: checkcast     #54                 // class java/lang/String
      36: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      39: pop
      40: aload_3
      41: ldc           #55                 // String \",
      43: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      46: pop
      47: aload_2
      48: getfield      #30                 // Field com/acme/ChatServlet$Member._queue:Ljava/util/Queue;
      51: invokeinterface #53,  1           // InterfaceMethod java/util/Queue.poll:()Ljava/lang/Object;
      56: checkcast     #54                 // class java/lang/String
      59: astore        4
      61: aload         4
      63: bipush        34
      65: invokevirtual #56                 // Method java/lang/String.indexOf:(I)I
      68: istore        5
      70: iload         5
      72: iflt          129
      75: new           #49                 // class java/lang/StringBuilder
      78: dup
      79: invokespecial #50                 // Method java/lang/StringBuilder."<init>":()V
      82: aload         4
      84: iconst_0
      85: iload         5
      87: invokevirtual #57                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      90: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      93: bipush        92
      95: invokevirtual #58                 // Method java/lang/StringBuilder.append:(C)Ljava/lang/StringBuilder;
      98: aload         4
     100: iload         5
     102: invokevirtual #59                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     105: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     108: invokevirtual #60                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     111: astore        4
     113: aload         4
     115: bipush        34
     117: iload         5
     119: iconst_2
     120: iadd
     121: invokevirtual #61                 // Method java/lang/String.indexOf:(II)I
     124: istore        5
     126: goto          70
     129: aload_3
     130: ldc           #62                 // String \"chat\":\"
     132: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     135: pop
     136: aload_3
     137: aload         4
     139: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     142: pop
     143: aload_3
     144: ldc           #63                 // String \"}
     146: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     149: pop
     150: aload_3
     151: invokevirtual #60                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     154: ldc           #64                 // String utf-8
     156: invokevirtual #65                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
     159: astore        6
     161: aload_1
     162: aload         6
     164: arraylength
     165: invokeinterface #66,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setContentLength:(I)V
     170: aload_1
     171: invokeinterface #67,  1           // InterfaceMethod javax/servlet/http/HttpServletResponse.getOutputStream:()Ljavax/servlet/ServletOutputStream;
     176: aload         6
     178: invokevirtual #68                 // Method javax/servlet/ServletOutputStream.write:([B)V
     181: return

  private void sendMessageToAllMembers(java.lang.String, java.lang.String, java.util.Map<java.lang.String, com.acme.ChatServlet$Member>);
    Code:
       0: getstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
       3: ldc           #69                 // String Sending message: {} from: {}
       5: iconst_2
       6: anewarray     #19                 // class java/lang/Object
       9: dup
      10: iconst_0
      11: aload_1
      12: aastore
      13: dup
      14: iconst_1
      15: aload_2
      16: aastore
      17: invokeinterface #21,  3           // InterfaceMethod org/eclipse/jetty/util/log/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
      22: aload_3
      23: invokeinterface #70,  1           // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
      28: invokeinterface #71,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      33: astore        4
      35: aload         4
      37: invokeinterface #72,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      42: ifeq          182
      45: aload         4
      47: invokeinterface #73,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      52: checkcast     #41                 // class com/acme/ChatServlet$Member
      55: astore        5
      57: aload         5
      59: dup
      60: astore        6
      62: monitorenter
      63: aload         5
      65: getfield      #30                 // Field com/acme/ChatServlet$Member._queue:Ljava/util/Queue;
      68: aload_2
      69: invokeinterface #74,  2           // InterfaceMethod java/util/Queue.add:(Ljava/lang/Object;)Z
      74: pop
      75: aload         5
      77: getfield      #30                 // Field com/acme/ChatServlet$Member._queue:Ljava/util/Queue;
      80: aload_1
      81: invokeinterface #74,  2           // InterfaceMethod java/util/Queue.add:(Ljava/lang/Object;)Z
      86: pop
      87: aload         5
      89: getfield      #38                 // Field com/acme/ChatServlet$Member._async:Ljava/util/concurrent/atomic/AtomicReference;
      92: invokevirtual #75                 // Method java/util/concurrent/atomic/AtomicReference.get:()Ljava/lang/Object;
      95: checkcast     #76                 // class javax/servlet/AsyncContext
      98: astore        7
     100: getstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
     103: ldc           #77                 // String Async found: {}
     105: iconst_1
     106: anewarray     #19                 // class java/lang/Object
     109: dup
     110: iconst_0
     111: aload         7
     113: aastore
     114: invokeinterface #21,  3           // InterfaceMethod org/eclipse/jetty/util/log/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
     119: aload         7
     121: ifnull        128
     124: iconst_1
     125: goto          129
     128: iconst_0
     129: aload         5
     131: getfield      #38                 // Field com/acme/ChatServlet$Member._async:Ljava/util/concurrent/atomic/AtomicReference;
     134: aload         7
     136: aconst_null
     137: invokevirtual #78                 // Method java/util/concurrent/atomic/AtomicReference.compareAndSet:(Ljava/lang/Object;Ljava/lang/Object;)Z
     140: iand
     141: ifeq          165
     144: getstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
     147: ldc           #79                 // String dispatch
     149: iconst_0
     150: anewarray     #19                 // class java/lang/Object
     153: invokeinterface #21,  3           // InterfaceMethod org/eclipse/jetty/util/log/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
     158: aload         7
     160: invokeinterface #80,  1           // InterfaceMethod javax/servlet/AsyncContext.dispatch:()V
     165: aload         6
     167: monitorexit
     168: goto          179
     171: astore        8
     173: aload         6
     175: monitorexit
     176: aload         8
     178: athrow
     179: goto          35
     182: return
    Exception table:
       from    to  target type
          63   168   171   any
         171   176   171   any

  protected void doGet(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse) throws javax.servlet.ServletException, java.io.IOException;
    Code:
       0: aload_1
       1: ldc           #81                 // String action
       3: invokeinterface #14,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameter:(Ljava/lang/String;)Ljava/lang/String;
       8: ifnull        20
      11: aload_0
      12: aload_1
      13: aload_2
      14: invokevirtual #82                 // Method doPost:(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)V
      17: goto          38
      20: aload_0
      21: invokevirtual #83                 // Method getServletContext:()Ljavax/servlet/ServletContext;
      24: ldc           #84                 // String default
      26: invokeinterface #85,  2           // InterfaceMethod javax/servlet/ServletContext.getNamedDispatcher:(Ljava/lang/String;)Ljavax/servlet/RequestDispatcher;
      31: aload_1
      32: aload_2
      33: invokeinterface #86,  3           // InterfaceMethod javax/servlet/RequestDispatcher.forward:(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V
      38: return

  static org.eclipse.jetty.util.log.Logger access$000();
    Code:
       0: getstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
       3: areturn

  static {};
    Code:
       0: ldc           #87                 // class com/acme/ChatServlet
       2: invokestatic  #88                 // Method org/eclipse/jetty/util/log/Log.getLogger:(Ljava/lang/Class;)Lorg/eclipse/jetty/util/log/Logger;
       5: putstatic     #1                  // Field LOG:Lorg/eclipse/jetty/util/log/Logger;
       8: return
}
