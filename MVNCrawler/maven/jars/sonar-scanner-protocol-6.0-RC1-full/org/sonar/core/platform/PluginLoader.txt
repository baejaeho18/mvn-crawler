Compiled from "PluginLoader.java"
public class org.sonar.core.platform.PluginLoader {
  private static final java.lang.String[] DEFAULT_SHARED_RESOURCES;

  private static final java.util.Set<java.lang.String> PRIVILEGED_PLUGINS_BASE_KEYS;

  public static final org.sonar.updatecenter.common.Version COMPATIBILITY_MODE_MAX_VERSION;

  private final org.sonar.core.platform.PluginJarExploder jarExploder;

  private final org.sonar.core.platform.PluginClassloaderFactory classloaderFactory;

  public org.sonar.core.platform.PluginLoader(org.sonar.core.platform.PluginJarExploder, org.sonar.core.platform.PluginClassloaderFactory);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field jarExploder:Lorg/sonar/core/platform/PluginJarExploder;
       9: aload_0
      10: aload_2
      11: putfield      #3                  // Field classloaderFactory:Lorg/sonar/core/platform/PluginClassloaderFactory;
      14: return

  public java.util.Map<java.lang.String, org.sonar.api.Plugin> load(java.util.Map<java.lang.String, org.sonar.core.platform.PluginInfo>);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #4                  // Method defineClassloaders:(Ljava/util/Map;)Ljava/util/Collection;
       5: astore_2
       6: aload_0
       7: getfield      #3                  // Field classloaderFactory:Lorg/sonar/core/platform/PluginClassloaderFactory;
      10: aload_2
      11: invokevirtual #5                  // Method org/sonar/core/platform/PluginClassloaderFactory.create:(Ljava/util/Collection;)Ljava/util/Map;
      14: astore_3
      15: aload_0
      16: aload_3
      17: invokevirtual #6                  // Method instantiatePluginClasses:(Ljava/util/Map;)Ljava/util/Map;
      20: areturn

  java.util.Collection<org.sonar.core.platform.PluginClassLoaderDef> defineClassloaders(java.util.Map<java.lang.String, org.sonar.core.platform.PluginInfo>);
    Code:
       0: new           #7                  // class java/util/HashMap
       3: dup
       4: invokespecial #8                  // Method java/util/HashMap."<init>":()V
       7: astore_2
       8: aload_1
       9: invokeinterface #9,  1            // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
      14: invokeinterface #10,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      19: astore_3
      20: aload_3
      21: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      26: ifeq          324
      29: aload_3
      30: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      35: checkcast     #13                 // class org/sonar/core/platform/PluginInfo
      38: astore        4
      40: aload         4
      42: aload_1
      43: invokestatic  #14                 // Method basePluginKey:(Lorg/sonar/core/platform/PluginInfo;Ljava/util/Map;)Ljava/lang/String;
      46: astore        5
      48: aload_2
      49: aload         5
      51: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      56: checkcast     #16                 // class org/sonar/core/platform/PluginClassLoaderDef
      59: astore        6
      61: aload         6
      63: ifnonnull     88
      66: new           #16                 // class org/sonar/core/platform/PluginClassLoaderDef
      69: dup
      70: aload         5
      72: invokespecial #17                 // Method org/sonar/core/platform/PluginClassLoaderDef."<init>":(Ljava/lang/String;)V
      75: astore        6
      77: aload_2
      78: aload         5
      80: aload         6
      82: invokeinterface #18,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      87: pop
      88: aload_0
      89: getfield      #2                  // Field jarExploder:Lorg/sonar/core/platform/PluginJarExploder;
      92: aload         4
      94: invokevirtual #19                 // Method org/sonar/core/platform/PluginJarExploder.explode:(Lorg/sonar/core/platform/PluginInfo;)Lorg/sonar/core/platform/ExplodedPlugin;
      97: astore        7
      99: aload         6
     101: iconst_1
     102: anewarray     #20                 // class java/io/File
     105: dup
     106: iconst_0
     107: aload         7
     109: invokevirtual #21                 // Method org/sonar/core/platform/ExplodedPlugin.getMain:()Ljava/io/File;
     112: aastore
     113: invokestatic  #22                 // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
     116: invokevirtual #23                 // Method org/sonar/core/platform/PluginClassLoaderDef.addFiles:(Ljava/util/Collection;)V
     119: aload         6
     121: aload         7
     123: invokevirtual #24                 // Method org/sonar/core/platform/ExplodedPlugin.getLibs:()Ljava/util/Collection;
     126: invokevirtual #23                 // Method org/sonar/core/platform/PluginClassLoaderDef.addFiles:(Ljava/util/Collection;)V
     129: aload         6
     131: aload         4
     133: invokevirtual #25                 // Method org/sonar/core/platform/PluginInfo.getKey:()Ljava/lang/String;
     136: aload         4
     138: invokevirtual #26                 // Method org/sonar/core/platform/PluginInfo.getMainClass:()Ljava/lang/String;
     141: invokevirtual #27                 // Method org/sonar/core/platform/PluginClassLoaderDef.addMainClass:(Ljava/lang/String;Ljava/lang/String;)V
     144: getstatic     #28                 // Field DEFAULT_SHARED_RESOURCES:[Ljava/lang/String;
     147: astore        8
     149: aload         8
     151: arraylength
     152: istore        9
     154: iconst_0
     155: istore        10
     157: iload         10
     159: iload         9
     161: if_icmpge     208
     164: aload         8
     166: iload         10
     168: aaload
     169: astore        11
     171: aload         6
     173: invokevirtual #29                 // Method org/sonar/core/platform/PluginClassLoaderDef.getExportMask:()Lorg/sonar/classloader/Mask;
     176: ldc           #30                 // String %s/%s/api/
     178: iconst_2
     179: anewarray     #31                 // class java/lang/Object
     182: dup
     183: iconst_0
     184: aload         11
     186: aastore
     187: dup
     188: iconst_1
     189: aload         4
     191: invokevirtual #25                 // Method org/sonar/core/platform/PluginInfo.getKey:()Ljava/lang/String;
     194: aastore
     195: invokestatic  #32                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     198: invokevirtual #33                 // Method org/sonar/classloader/Mask.addInclusion:(Ljava/lang/String;)Lorg/sonar/classloader/Mask;
     201: pop
     202: iinc          10, 1
     205: goto          157
     208: aload         4
     210: invokevirtual #34                 // Method org/sonar/core/platform/PluginInfo.getBasePlugin:()Ljava/lang/String;
     213: invokestatic  #35                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     216: ifeq          321
     219: aload         6
     221: aload         4
     223: invokevirtual #36                 // Method org/sonar/core/platform/PluginInfo.isUseChildFirstClassLoader:()Z
     226: invokevirtual #37                 // Method org/sonar/core/platform/PluginClassLoaderDef.setSelfFirstStrategy:(Z)V
     229: aload         4
     231: invokevirtual #38                 // Method org/sonar/core/platform/PluginInfo.getMinimalSqVersion:()Lorg/sonar/updatecenter/common/Version;
     234: astore        8
     236: aload         8
     238: ifnull        256
     241: aload         8
     243: getstatic     #39                 // Field COMPATIBILITY_MODE_MAX_VERSION:Lorg/sonar/updatecenter/common/Version;
     246: invokevirtual #40                 // Method org/sonar/updatecenter/common/Version.compareToIgnoreQualifier:(Lorg/sonar/updatecenter/common/Version;)I
     249: ifge          256
     252: iconst_1
     253: goto          257
     256: iconst_0
     257: istore        9
     259: aload         6
     261: iload         9
     263: invokevirtual #41                 // Method org/sonar/core/platform/PluginClassLoaderDef.setCompatibilityMode:(Z)V
     266: aload         6
     268: aload         5
     270: invokestatic  #42                 // Method isPrivileged:(Ljava/lang/String;)Z
     273: invokevirtual #43                 // Method org/sonar/core/platform/PluginClassLoaderDef.setPrivileged:(Z)V
     276: iload         9
     278: ifeq          321
     281: aload_0
     282: invokevirtual #44                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
     285: invokestatic  #45                 // Method org/sonar/api/utils/log/Loggers.get:(Ljava/lang/Class;)Lorg/sonar/api/utils/log/Logger;
     288: ldc           #46                 // String API compatibility mode is enabled on plugin {} [{}] (built with API lower than {})
     290: iconst_3
     291: anewarray     #31                 // class java/lang/Object
     294: dup
     295: iconst_0
     296: aload         4
     298: invokevirtual #47                 // Method org/sonar/core/platform/PluginInfo.getName:()Ljava/lang/String;
     301: aastore
     302: dup
     303: iconst_1
     304: aload         4
     306: invokevirtual #25                 // Method org/sonar/core/platform/PluginInfo.getKey:()Ljava/lang/String;
     309: aastore
     310: dup
     311: iconst_2
     312: getstatic     #39                 // Field COMPATIBILITY_MODE_MAX_VERSION:Lorg/sonar/updatecenter/common/Version;
     315: aastore
     316: invokeinterface #48,  3           // InterfaceMethod org/sonar/api/utils/log/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
     321: goto          20
     324: aload_2
     325: invokeinterface #9,  1            // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
     330: areturn

  private static boolean isPrivileged(java.lang.String);
    Code:
       0: getstatic     #49                 // Field PRIVILEGED_PLUGINS_BASE_KEYS:Ljava/util/Set;
       3: aload_0
       4: invokeinterface #50,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
       9: ireturn

  java.util.Map<java.lang.String, org.sonar.api.Plugin> instantiatePluginClasses(java.util.Map<org.sonar.core.platform.PluginClassLoaderDef, java.lang.ClassLoader>);
    Code:
       0: new           #7                  // class java/util/HashMap
       3: dup
       4: invokespecial #8                  // Method java/util/HashMap."<init>":()V
       7: astore_2
       8: aload_1
       9: invokeinterface #51,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
      14: invokeinterface #52,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      19: astore_3
      20: aload_3
      21: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      26: ifeq          221
      29: aload_3
      30: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      35: checkcast     #53                 // class java/util/Map$Entry
      38: astore        4
      40: aload         4
      42: invokeinterface #54,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
      47: checkcast     #16                 // class org/sonar/core/platform/PluginClassLoaderDef
      50: astore        5
      52: aload         4
      54: invokeinterface #55,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
      59: checkcast     #56                 // class java/lang/ClassLoader
      62: astore        6
      64: aload         5
      66: invokevirtual #57                 // Method org/sonar/core/platform/PluginClassLoaderDef.getMainClassesByPluginKey:()Ljava/util/Map;
      69: invokeinterface #51,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
      74: invokeinterface #52,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      79: astore        7
      81: aload         7
      83: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      88: ifeq          218
      91: aload         7
      93: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      98: checkcast     #53                 // class java/util/Map$Entry
     101: astore        8
     103: aload         8
     105: invokeinterface #54,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
     110: checkcast     #58                 // class java/lang/String
     113: astore        9
     115: aload         8
     117: invokeinterface #55,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     122: checkcast     #58                 // class java/lang/String
     125: astore        10
     127: aload_2
     128: aload         9
     130: aload         6
     132: aload         10
     134: invokevirtual #59                 // Method java/lang/ClassLoader.loadClass:(Ljava/lang/String;)Ljava/lang/Class;
     137: invokevirtual #60                 // Method java/lang/Class.newInstance:()Ljava/lang/Object;
     140: checkcast     #61                 // class org/sonar/api/Plugin
     143: invokeinterface #18,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     148: pop
     149: goto          215
     152: astore        11
     154: new           #63                 // class java/lang/IllegalStateException
     157: dup
     158: ldc           #64                 // String The plugin [%s] does not support Java %s
     160: iconst_2
     161: anewarray     #31                 // class java/lang/Object
     164: dup
     165: iconst_0
     166: aload         9
     168: aastore
     169: dup
     170: iconst_1
     171: getstatic     #65                 // Field org/apache/commons/lang/SystemUtils.JAVA_VERSION_TRIMMED:Ljava/lang/String;
     174: aastore
     175: invokestatic  #32                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     178: aload         11
     180: invokespecial #66                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     183: athrow
     184: astore        11
     186: new           #63                 // class java/lang/IllegalStateException
     189: dup
     190: ldc           #68                 // String Fail to instantiate class [%s] of plugin [%s]
     192: iconst_2
     193: anewarray     #31                 // class java/lang/Object
     196: dup
     197: iconst_0
     198: aload         10
     200: aastore
     201: dup
     202: iconst_1
     203: aload         9
     205: aastore
     206: invokestatic  #32                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     209: aload         11
     211: invokespecial #66                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     214: athrow
     215: goto          81
     218: goto          20
     221: aload_2
     222: areturn
    Exception table:
       from    to  target type
         127   149   152   Class java/lang/UnsupportedClassVersionError
         127   149   184   Class java/lang/Throwable

  public void unload(java.util.Collection<org.sonar.api.Plugin>);
    Code:
       0: aload_1
       1: invokeinterface #10,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
       6: astore_2
       7: aload_2
       8: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      13: ifeq          110
      16: aload_2
      17: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      22: checkcast     #61                 // class org/sonar/api/Plugin
      25: astore_3
      26: aload_3
      27: invokevirtual #44                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      30: invokevirtual #69                 // Method java/lang/Class.getClassLoader:()Ljava/lang/ClassLoader;
      33: astore        4
      35: aload         4
      37: instanceof    #70                 // class java/io/Closeable
      40: ifeq          107
      43: aload         4
      45: aload_0
      46: getfield      #3                  // Field classloaderFactory:Lorg/sonar/core/platform/PluginClassloaderFactory;
      49: invokevirtual #71                 // Method org/sonar/core/platform/PluginClassloaderFactory.baseClassLoader:()Ljava/lang/ClassLoader;
      52: if_acmpeq     107
      55: aload         4
      57: checkcast     #70                 // class java/io/Closeable
      60: invokeinterface #72,  1           // InterfaceMethod java/io/Closeable.close:()V
      65: goto          107
      68: astore        5
      70: aload_0
      71: invokevirtual #44                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      74: invokestatic  #45                 // Method org/sonar/api/utils/log/Loggers.get:(Ljava/lang/Class;)Lorg/sonar/api/utils/log/Logger;
      77: new           #74                 // class java/lang/StringBuilder
      80: dup
      81: invokespecial #75                 // Method java/lang/StringBuilder."<init>":()V
      84: ldc           #76                 // String Fail to close classloader
      86: invokevirtual #77                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      89: aload         4
      91: invokevirtual #78                 // Method java/lang/Object.toString:()Ljava/lang/String;
      94: invokevirtual #77                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      97: invokevirtual #79                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     100: aload         5
     102: invokeinterface #80,  3           // InterfaceMethod org/sonar/api/utils/log/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     107: goto          7
     110: return
    Exception table:
       from    to  target type
          55    65    68   Class java/lang/Exception

  static java.lang.String basePluginKey(org.sonar.core.platform.PluginInfo, java.util.Map<java.lang.String, org.sonar.core.platform.PluginInfo>);
    Code:
       0: aload_0
       1: invokevirtual #25                 // Method org/sonar/core/platform/PluginInfo.getKey:()Ljava/lang/String;
       4: astore_2
       5: aload_0
       6: invokevirtual #34                 // Method org/sonar/core/platform/PluginInfo.getBasePlugin:()Ljava/lang/String;
       9: astore_3
      10: aload_3
      11: invokestatic  #35                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      14: ifne          44
      17: aload_1
      18: aload_3
      19: invokeinterface #15,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      24: checkcast     #13                 // class org/sonar/core/platform/PluginInfo
      27: astore        4
      29: aload         4
      31: invokevirtual #25                 // Method org/sonar/core/platform/PluginInfo.getKey:()Ljava/lang/String;
      34: astore_2
      35: aload         4
      37: invokevirtual #34                 // Method org/sonar/core/platform/PluginInfo.getBasePlugin:()Ljava/lang/String;
      40: astore_3
      41: goto          10
      44: aload_2
      45: areturn

  static {};
    Code:
       0: iconst_3
       1: anewarray     #58                 // class java/lang/String
       4: dup
       5: iconst_0
       6: ldc           #81                 // String org/sonar/plugins
       8: aastore
       9: dup
      10: iconst_1
      11: ldc           #82                 // String com/sonar/plugins
      13: aastore
      14: dup
      15: iconst_2
      16: ldc           #83                 // String com/sonarsource/plugins
      18: aastore
      19: putstatic     #28                 // Field DEFAULT_SHARED_RESOURCES:[Ljava/lang/String;
      22: ldc           #84                 // String views
      24: ldc           #85                 // String devcockpit
      26: ldc           #86                 // String governance
      28: invokestatic  #87                 // Method com/google/common/collect/ImmutableSet.of:(Ljava/lang/Object;Ljava/lang/Object;Ljava/lang/Object;)Lcom/google/common/collect/ImmutableSet;
      31: putstatic     #49                 // Field PRIVILEGED_PLUGINS_BASE_KEYS:Ljava/util/Set;
      34: ldc           #88                 // String 5.2
      36: invokestatic  #89                 // Method org/sonar/updatecenter/common/Version.create:(Ljava/lang/String;)Lorg/sonar/updatecenter/common/Version;
      39: putstatic     #39                 // Field COMPATIBILITY_MODE_MAX_VERSION:Lorg/sonar/updatecenter/common/Version;
      42: return
}
