Compiled from "ResourceLockImpl.java"
public class org.apache.pulsar.metadata.coordination.impl.ResourceLockImpl<T> implements org.apache.pulsar.metadata.api.coordination.ResourceLock<T> {
  private static final org.slf4j.Logger log;

  private final org.apache.pulsar.metadata.api.extended.MetadataStoreExtended store;

  private final org.apache.pulsar.metadata.api.MetadataSerde<T> serde;

  private final java.lang.String path;

  private volatile T value;

  private long version;

  private final java.util.concurrent.CompletableFuture<java.lang.Void> expiredFuture;

  private boolean revalidateAfterReconnection;

  private java.util.concurrent.CompletableFuture<java.lang.Void> revalidateFuture;

  private org.apache.pulsar.metadata.coordination.impl.ResourceLockImpl$State state;

  public org.apache.pulsar.metadata.coordination.impl.ResourceLockImpl(org.apache.pulsar.metadata.api.extended.MetadataStoreExtended, org.apache.pulsar.metadata.api.MetadataSerde<T>, java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iconst_0
       6: putfield      #2                  // Field revalidateAfterReconnection:Z
       9: aload_0
      10: aload_1
      11: putfield      #3                  // Field store:Lorg/apache/pulsar/metadata/api/extended/MetadataStoreExtended;
      14: aload_0
      15: aload_2
      16: putfield      #4                  // Field serde:Lorg/apache/pulsar/metadata/api/MetadataSerde;
      19: aload_0
      20: aload_3
      21: putfield      #5                  // Field path:Ljava/lang/String;
      24: aload_0
      25: ldc2_w        #6                  // long -1l
      28: putfield      #8                  // Field version:J
      31: aload_0
      32: new           #9                  // class java/util/concurrent/CompletableFuture
      35: dup
      36: invokespecial #10                 // Method java/util/concurrent/CompletableFuture."<init>":()V
      39: putfield      #11                 // Field expiredFuture:Ljava/util/concurrent/CompletableFuture;
      42: aload_0
      43: getstatic     #12                 // Field org/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State.Init:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
      46: putfield      #13                 // Field state:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
      49: return

  public synchronized T getValue();
    Code:
       0: aload_0
       1: getfield      #14                 // Field value:Ljava/lang/Object;
       4: areturn

  public synchronized java.util.concurrent.CompletableFuture<java.lang.Void> updateValue(T);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #15                 // Method acquire:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
       5: areturn

  public synchronized java.util.concurrent.CompletableFuture<java.lang.Void> release();
    Code:
       0: aload_0
       1: getfield      #13                 // Field state:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
       4: getstatic     #16                 // Field org/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State.Released:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
       7: if_acmpne     15
      10: aconst_null
      11: invokestatic  #17                 // Method java/util/concurrent/CompletableFuture.completedFuture:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
      14: areturn
      15: aload_0
      16: getstatic     #18                 // Field org/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State.Releasing:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
      19: putfield      #13                 // Field state:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
      22: new           #9                  // class java/util/concurrent/CompletableFuture
      25: dup
      26: invokespecial #10                 // Method java/util/concurrent/CompletableFuture."<init>":()V
      29: astore_1
      30: aload_0
      31: getfield      #3                  // Field store:Lorg/apache/pulsar/metadata/api/extended/MetadataStoreExtended;
      34: aload_0
      35: getfield      #5                  // Field path:Ljava/lang/String;
      38: aload_0
      39: getfield      #8                  // Field version:J
      42: invokestatic  #19                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      45: invokestatic  #20                 // Method java/util/Optional.of:(Ljava/lang/Object;)Ljava/util/Optional;
      48: invokeinterface #21,  3           // InterfaceMethod org/apache/pulsar/metadata/api/extended/MetadataStoreExtended.delete:(Ljava/lang/String;Ljava/util/Optional;)Ljava/util/concurrent/CompletableFuture;
      53: aload_0
      54: aload_1
      55: invokedynamic #22,  0             // InvokeDynamic #0:run:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;Ljava/util/concurrent/CompletableFuture;)Ljava/lang/Runnable;
      60: invokevirtual #23                 // Method java/util/concurrent/CompletableFuture.thenRun:(Ljava/lang/Runnable;)Ljava/util/concurrent/CompletableFuture;
      63: aload_0
      64: aload_1
      65: invokedynamic #24,  0             // InvokeDynamic #1:apply:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;Ljava/util/concurrent/CompletableFuture;)Ljava/util/function/Function;
      70: invokevirtual #25                 // Method java/util/concurrent/CompletableFuture.exceptionally:(Ljava/util/function/Function;)Ljava/util/concurrent/CompletableFuture;
      73: pop
      74: aload_1
      75: areturn

  public java.util.concurrent.CompletableFuture<java.lang.Void> getLockExpiredFuture();
    Code:
       0: aload_0
       1: getfield      #11                 // Field expiredFuture:Ljava/util/concurrent/CompletableFuture;
       4: areturn

  public java.lang.String getPath();
    Code:
       0: aload_0
       1: getfield      #5                  // Field path:Ljava/lang/String;
       4: areturn

  public int hashCode();
    Code:
       0: aload_0
       1: getfield      #5                  // Field path:Ljava/lang/String;
       4: invokevirtual #26                 // Method java/lang/String.hashCode:()I
       7: ireturn

  synchronized java.util.concurrent.CompletableFuture<java.lang.Void> acquire(T);
    Code:
       0: new           #9                  // class java/util/concurrent/CompletableFuture
       3: dup
       4: invokespecial #10                 // Method java/util/concurrent/CompletableFuture."<init>":()V
       7: astore_2
       8: aload_0
       9: aload_1
      10: invokespecial #27                 // Method acquireWithNoRevalidation:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
      13: aload_2
      14: invokedynamic #28,  0             // InvokeDynamic #2:run:(Ljava/util/concurrent/CompletableFuture;)Ljava/lang/Runnable;
      19: invokevirtual #23                 // Method java/util/concurrent/CompletableFuture.thenRun:(Ljava/lang/Runnable;)Ljava/util/concurrent/CompletableFuture;
      22: aload_0
      23: aload_1
      24: aload_2
      25: invokedynamic #29,  0             // InvokeDynamic #3:apply:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;Ljava/lang/Object;Ljava/util/concurrent/CompletableFuture;)Ljava/util/function/Function;
      30: invokevirtual #25                 // Method java/util/concurrent/CompletableFuture.exceptionally:(Ljava/util/function/Function;)Ljava/util/concurrent/CompletableFuture;
      33: pop
      34: aload_2
      35: areturn

  private java.util.concurrent.CompletableFuture<java.lang.Void> acquireWithNoRevalidation(T);
    Code:
       0: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
       3: invokeinterface #31,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
       8: ifeq          29
      11: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
      14: ldc           #32                 // String acquireWithNoRevalidation,newValue={},version={}
      16: aload_1
      17: aload_0
      18: getfield      #8                  // Field version:J
      21: invokestatic  #19                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      24: invokeinterface #33,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      29: aload_0
      30: getfield      #4                  // Field serde:Lorg/apache/pulsar/metadata/api/MetadataSerde;
      33: aload_0
      34: getfield      #5                  // Field path:Ljava/lang/String;
      37: aload_1
      38: invokeinterface #34,  3           // InterfaceMethod org/apache/pulsar/metadata/api/MetadataSerde.serialize:(Ljava/lang/String;Ljava/lang/Object;)[B
      43: astore_2
      44: goto          53
      47: astore_3
      48: aload_3
      49: invokestatic  #36                 // Method org/apache/bookkeeper/common/concurrent/FutureUtils.exception:(Ljava/lang/Throwable;)Ljava/util/concurrent/CompletableFuture;
      52: areturn
      53: new           #9                  // class java/util/concurrent/CompletableFuture
      56: dup
      57: invokespecial #10                 // Method java/util/concurrent/CompletableFuture."<init>":()V
      60: astore_3
      61: aload_0
      62: getfield      #3                  // Field store:Lorg/apache/pulsar/metadata/api/extended/MetadataStoreExtended;
      65: aload_0
      66: getfield      #5                  // Field path:Ljava/lang/String;
      69: aload_2
      70: aload_0
      71: getfield      #8                  // Field version:J
      74: invokestatic  #19                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      77: invokestatic  #20                 // Method java/util/Optional.of:(Ljava/lang/Object;)Ljava/util/Optional;
      80: getstatic     #37                 // Field org/apache/pulsar/metadata/api/extended/CreateOption.Ephemeral:Lorg/apache/pulsar/metadata/api/extended/CreateOption;
      83: invokestatic  #38                 // Method java/util/EnumSet.of:(Ljava/lang/Enum;)Ljava/util/EnumSet;
      86: invokeinterface #39,  5           // InterfaceMethod org/apache/pulsar/metadata/api/extended/MetadataStoreExtended.put:(Ljava/lang/String;[BLjava/util/Optional;Ljava/util/EnumSet;)Ljava/util/concurrent/CompletableFuture;
      91: aload_0
      92: aload_1
      93: aload_3
      94: invokedynamic #40,  0             // InvokeDynamic #4:accept:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;Ljava/lang/Object;Ljava/util/concurrent/CompletableFuture;)Ljava/util/function/Consumer;
      99: invokevirtual #41                 // Method java/util/concurrent/CompletableFuture.thenAccept:(Ljava/util/function/Consumer;)Ljava/util/concurrent/CompletableFuture;
     102: aload_0
     103: aload_3
     104: invokedynamic #42,  0             // InvokeDynamic #5:apply:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;Ljava/util/concurrent/CompletableFuture;)Ljava/util/function/Function;
     109: invokevirtual #25                 // Method java/util/concurrent/CompletableFuture.exceptionally:(Ljava/util/function/Function;)Ljava/util/concurrent/CompletableFuture;
     112: pop
     113: aload_3
     114: areturn
    Exception table:
       from    to  target type
          29    44    47   Class java/lang/Throwable

  synchronized void lockWasInvalidated();
    Code:
       0: aload_0
       1: getfield      #13                 // Field state:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
       4: getstatic     #43                 // Field org/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State.Valid:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
       7: if_acmpeq     11
      10: return
      11: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
      14: ldc           #44                 // String Lock on resource {} was invalidated
      16: aload_0
      17: getfield      #5                  // Field path:Ljava/lang/String;
      20: invokeinterface #45,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      25: aload_0
      26: aload_0
      27: getfield      #14                 // Field value:Ljava/lang/Object;
      30: invokevirtual #46                 // Method revalidate:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
      33: aload_0
      34: invokedynamic #47,  0             // InvokeDynamic #6:run:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;)Ljava/lang/Runnable;
      39: invokevirtual #23                 // Method java/util/concurrent/CompletableFuture.thenRun:(Ljava/lang/Runnable;)Ljava/util/concurrent/CompletableFuture;
      42: aload_0
      43: invokedynamic #48,  0             // InvokeDynamic #7:apply:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;)Ljava/util/function/Function;
      48: invokevirtual #25                 // Method java/util/concurrent/CompletableFuture.exceptionally:(Ljava/util/function/Function;)Ljava/util/concurrent/CompletableFuture;
      51: pop
      52: return

  synchronized java.util.concurrent.CompletableFuture<java.lang.Void> revalidateIfNeededAfterReconnection();
    Code:
       0: aload_0
       1: getfield      #2                  // Field revalidateAfterReconnection:Z
       4: ifeq          35
       7: aload_0
       8: iconst_0
       9: putfield      #2                  // Field revalidateAfterReconnection:Z
      12: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
      15: ldc           #49                 // String Revalidate lock at {} after reconnection
      17: aload_0
      18: getfield      #5                  // Field path:Ljava/lang/String;
      21: invokeinterface #50,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
      26: aload_0
      27: aload_0
      28: getfield      #14                 // Field value:Ljava/lang/Object;
      31: invokevirtual #46                 // Method revalidate:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
      34: areturn
      35: aconst_null
      36: invokestatic  #17                 // Method java/util/concurrent/CompletableFuture.completedFuture:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
      39: areturn

  synchronized java.util.concurrent.CompletableFuture<java.lang.Void> revalidate(T);
    Code:
       0: aload_0
       1: getfield      #51                 // Field revalidateFuture:Ljava/util/concurrent/CompletableFuture;
       4: ifnull        17
       7: aload_0
       8: getfield      #51                 // Field revalidateFuture:Ljava/util/concurrent/CompletableFuture;
      11: invokevirtual #52                 // Method java/util/concurrent/CompletableFuture.isDone:()Z
      14: ifeq          29
      17: aload_0
      18: aload_0
      19: aload_1
      20: invokespecial #53                 // Method doRevalidate:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
      23: putfield      #51                 // Field revalidateFuture:Ljava/util/concurrent/CompletableFuture;
      26: goto          104
      29: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
      32: invokeinterface #31,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
      37: ifeq          75
      40: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
      43: ldc           #54                 // String Previous revalidating is not finished while revalidate newValue={}, value={}, version={}
      45: iconst_3
      46: anewarray     #55                 // class java/lang/Object
      49: dup
      50: iconst_0
      51: aload_1
      52: aastore
      53: dup
      54: iconst_1
      55: aload_0
      56: getfield      #14                 // Field value:Ljava/lang/Object;
      59: aastore
      60: dup
      61: iconst_2
      62: aload_0
      63: getfield      #8                  // Field version:J
      66: invokestatic  #19                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      69: aastore
      70: invokeinterface #56,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
      75: new           #9                  // class java/util/concurrent/CompletableFuture
      78: dup
      79: invokespecial #10                 // Method java/util/concurrent/CompletableFuture."<init>":()V
      82: astore_2
      83: aload_0
      84: getfield      #51                 // Field revalidateFuture:Ljava/util/concurrent/CompletableFuture;
      87: aload_0
      88: aload_1
      89: aload_2
      90: invokedynamic #57,  0             // InvokeDynamic #8:accept:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;Ljava/lang/Object;Ljava/util/concurrent/CompletableFuture;)Ljava/util/function/BiConsumer;
      95: invokevirtual #58                 // Method java/util/concurrent/CompletableFuture.whenComplete:(Ljava/util/function/BiConsumer;)Ljava/util/concurrent/CompletableFuture;
      98: pop
      99: aload_0
     100: aload_2
     101: putfield      #51                 // Field revalidateFuture:Ljava/util/concurrent/CompletableFuture;
     104: aload_0
     105: getfield      #51                 // Field revalidateFuture:Ljava/util/concurrent/CompletableFuture;
     108: areturn

  private synchronized java.util.concurrent.CompletableFuture<java.lang.Void> doRevalidate(T);
    Code:
       0: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
       3: invokeinterface #31,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
       8: ifeq          29
      11: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
      14: ldc           #59                 // String doRevalidate with newValue={}, version={}
      16: aload_1
      17: aload_0
      18: getfield      #8                  // Field version:J
      21: invokestatic  #19                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      24: invokeinterface #33,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      29: aload_0
      30: getfield      #3                  // Field store:Lorg/apache/pulsar/metadata/api/extended/MetadataStoreExtended;
      33: aload_0
      34: getfield      #5                  // Field path:Ljava/lang/String;
      37: invokeinterface #60,  2           // InterfaceMethod org/apache/pulsar/metadata/api/extended/MetadataStoreExtended.get:(Ljava/lang/String;)Ljava/util/concurrent/CompletableFuture;
      42: aload_0
      43: aload_1
      44: invokedynamic #61,  0             // InvokeDynamic #9:apply:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;Ljava/lang/Object;)Ljava/util/function/Function;
      49: invokevirtual #62                 // Method java/util/concurrent/CompletableFuture.thenCompose:(Ljava/util/function/Function;)Ljava/util/concurrent/CompletableFuture;
      52: areturn

  private synchronized void setVersion(long);
    Code:
       0: aload_0
       1: lload_1
       2: putfield      #8                  // Field version:J
       5: return

  private java.util.concurrent.CompletionStage lambda$doRevalidate$20(java.lang.Object, java.util.Optional);
    Code:
       0: aload_2
       1: invokevirtual #63                 // Method java/util/Optional.isPresent:()Z
       4: ifne          29
       7: aload_0
       8: ldc2_w        #6                  // long -1l
      11: invokespecial #64                 // Method setVersion:(J)V
      14: aload_0
      15: aload_1
      16: invokespecial #27                 // Method acquireWithNoRevalidation:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
      19: aload_0
      20: invokedynamic #65,  0             // InvokeDynamic #10:run:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;)Ljava/lang/Runnable;
      25: invokevirtual #23                 // Method java/util/concurrent/CompletableFuture.thenRun:(Ljava/lang/Runnable;)Ljava/util/concurrent/CompletableFuture;
      28: areturn
      29: aload_2
      30: invokevirtual #66                 // Method java/util/Optional.get:()Ljava/lang/Object;
      33: checkcast     #67                 // class org/apache/pulsar/metadata/api/GetResult
      36: astore_3
      37: aload_3
      38: invokevirtual #68                 // Method org/apache/pulsar/metadata/api/GetResult.getStat:()Lorg/apache/pulsar/metadata/api/Stat;
      41: invokevirtual #69                 // Method org/apache/pulsar/metadata/api/Stat.isEphemeral:()Z
      44: ifne          85
      47: new           #70                 // class org/apache/pulsar/metadata/api/MetadataStoreException$LockBusyException
      50: dup
      51: new           #71                 // class java/lang/StringBuilder
      54: dup
      55: invokespecial #72                 // Method java/lang/StringBuilder."<init>":()V
      58: ldc           #73                 // String Path
      60: invokevirtual #74                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      63: aload_0
      64: getfield      #5                  // Field path:Ljava/lang/String;
      67: invokevirtual #74                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      70: ldc           #75                 // String  is already created as non-ephemeral
      72: invokevirtual #74                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      75: invokevirtual #76                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      78: invokespecial #77                 // Method org/apache/pulsar/metadata/api/MetadataStoreException$LockBusyException."<init>":(Ljava/lang/String;)V
      81: invokestatic  #36                 // Method org/apache/bookkeeper/common/concurrent/FutureUtils.exception:(Ljava/lang/Throwable;)Ljava/util/concurrent/CompletableFuture;
      84: areturn
      85: aload_0
      86: getfield      #4                  // Field serde:Lorg/apache/pulsar/metadata/api/MetadataSerde;
      89: aload_0
      90: getfield      #5                  // Field path:Ljava/lang/String;
      93: aload_3
      94: invokevirtual #78                 // Method org/apache/pulsar/metadata/api/GetResult.getValue:()[B
      97: aload_3
      98: invokevirtual #68                 // Method org/apache/pulsar/metadata/api/GetResult.getStat:()Lorg/apache/pulsar/metadata/api/Stat;
     101: invokeinterface #79,  4           // InterfaceMethod org/apache/pulsar/metadata/api/MetadataSerde.deserialize:(Ljava/lang/String;[BLorg/apache/pulsar/metadata/api/Stat;)Ljava/lang/Object;
     106: astore        4
     108: goto          119
     111: astore        5
     113: aload         5
     115: invokestatic  #36                 // Method org/apache/bookkeeper/common/concurrent/FutureUtils.exception:(Ljava/lang/Throwable;)Ljava/util/concurrent/CompletableFuture;
     118: areturn
     119: aload_0
     120: dup
     121: astore        5
     123: monitorenter
     124: aload_1
     125: aload         4
     127: invokevirtual #80                 // Method java/lang/Object.equals:(Ljava/lang/Object;)Z
     130: ifeq          239
     133: aload_3
     134: invokevirtual #68                 // Method org/apache/pulsar/metadata/api/GetResult.getStat:()Lorg/apache/pulsar/metadata/api/Stat;
     137: invokevirtual #81                 // Method org/apache/pulsar/metadata/api/Stat.isCreatedBySelf:()Z
     140: ifeq          167
     143: aload_0
     144: aload_3
     145: invokevirtual #68                 // Method org/apache/pulsar/metadata/api/GetResult.getStat:()Lorg/apache/pulsar/metadata/api/Stat;
     148: invokevirtual #82                 // Method org/apache/pulsar/metadata/api/Stat.getVersion:()J
     151: putfield      #8                  // Field version:J
     154: aload_0
     155: aload_1
     156: putfield      #14                 // Field value:Ljava/lang/Object;
     159: aconst_null
     160: invokestatic  #17                 // Method java/util/concurrent/CompletableFuture.completedFuture:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
     163: aload         5
     165: monitorexit
     166: areturn
     167: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
     170: ldc           #83                 // String Deleting stale lock at {}
     172: aload_0
     173: getfield      #5                  // Field path:Ljava/lang/String;
     176: invokeinterface #45,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     181: aload_0
     182: getfield      #3                  // Field store:Lorg/apache/pulsar/metadata/api/extended/MetadataStoreExtended;
     185: aload_0
     186: getfield      #5                  // Field path:Ljava/lang/String;
     189: aload_3
     190: invokevirtual #68                 // Method org/apache/pulsar/metadata/api/GetResult.getStat:()Lorg/apache/pulsar/metadata/api/Stat;
     193: invokevirtual #82                 // Method org/apache/pulsar/metadata/api/Stat.getVersion:()J
     196: invokestatic  #19                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     199: invokestatic  #20                 // Method java/util/Optional.of:(Ljava/lang/Object;)Ljava/util/Optional;
     202: invokeinterface #21,  3           // InterfaceMethod org/apache/pulsar/metadata/api/extended/MetadataStoreExtended.delete:(Ljava/lang/String;Ljava/util/Optional;)Ljava/util/concurrent/CompletableFuture;
     207: aload_0
     208: invokedynamic #84,  0             // InvokeDynamic #11:run:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;)Ljava/lang/Runnable;
     213: invokevirtual #23                 // Method java/util/concurrent/CompletableFuture.thenRun:(Ljava/lang/Runnable;)Ljava/util/concurrent/CompletableFuture;
     216: aload_0
     217: aload_1
     218: invokedynamic #85,  0             // InvokeDynamic #12:apply:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;Ljava/lang/Object;)Ljava/util/function/Function;
     223: invokevirtual #62                 // Method java/util/concurrent/CompletableFuture.thenCompose:(Ljava/util/function/Function;)Ljava/util/concurrent/CompletableFuture;
     226: aload_0
     227: invokedynamic #86,  0             // InvokeDynamic #13:run:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;)Ljava/lang/Runnable;
     232: invokevirtual #23                 // Method java/util/concurrent/CompletableFuture.thenRun:(Ljava/lang/Runnable;)Ljava/util/concurrent/CompletableFuture;
     235: aload         5
     237: monitorexit
     238: areturn
     239: aload_3
     240: invokevirtual #68                 // Method org/apache/pulsar/metadata/api/GetResult.getStat:()Lorg/apache/pulsar/metadata/api/Stat;
     243: invokevirtual #81                 // Method org/apache/pulsar/metadata/api/Stat.isCreatedBySelf:()Z
     246: ifne          290
     249: new           #70                 // class org/apache/pulsar/metadata/api/MetadataStoreException$LockBusyException
     252: dup
     253: new           #71                 // class java/lang/StringBuilder
     256: dup
     257: invokespecial #72                 // Method java/lang/StringBuilder."<init>":()V
     260: ldc           #87                 // String Resource at
     262: invokevirtual #74                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     265: aload_0
     266: getfield      #5                  // Field path:Ljava/lang/String;
     269: invokevirtual #74                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     272: ldc           #88                 // String  is already locked
     274: invokevirtual #74                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     277: invokevirtual #76                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     280: invokespecial #77                 // Method org/apache/pulsar/metadata/api/MetadataStoreException$LockBusyException."<init>":(Ljava/lang/String;)V
     283: invokestatic  #36                 // Method org/apache/bookkeeper/common/concurrent/FutureUtils.exception:(Ljava/lang/Throwable;)Ljava/util/concurrent/CompletableFuture;
     286: aload         5
     288: monitorexit
     289: areturn
     290: aload_0
     291: getfield      #3                  // Field store:Lorg/apache/pulsar/metadata/api/extended/MetadataStoreExtended;
     294: aload_0
     295: getfield      #5                  // Field path:Ljava/lang/String;
     298: aload_3
     299: invokevirtual #68                 // Method org/apache/pulsar/metadata/api/GetResult.getStat:()Lorg/apache/pulsar/metadata/api/Stat;
     302: invokevirtual #82                 // Method org/apache/pulsar/metadata/api/Stat.getVersion:()J
     305: invokestatic  #19                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     308: invokestatic  #20                 // Method java/util/Optional.of:(Ljava/lang/Object;)Ljava/util/Optional;
     311: invokeinterface #21,  3           // InterfaceMethod org/apache/pulsar/metadata/api/extended/MetadataStoreExtended.delete:(Ljava/lang/String;Ljava/util/Optional;)Ljava/util/concurrent/CompletableFuture;
     316: aload_0
     317: invokedynamic #89,  0             // InvokeDynamic #14:run:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;)Ljava/lang/Runnable;
     322: invokevirtual #23                 // Method java/util/concurrent/CompletableFuture.thenRun:(Ljava/lang/Runnable;)Ljava/util/concurrent/CompletableFuture;
     325: aload_0
     326: aload_1
     327: invokedynamic #90,  0             // InvokeDynamic #15:apply:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;Ljava/lang/Object;)Ljava/util/function/Function;
     332: invokevirtual #62                 // Method java/util/concurrent/CompletableFuture.thenCompose:(Ljava/util/function/Function;)Ljava/util/concurrent/CompletableFuture;
     335: aload_0
     336: invokedynamic #91,  0             // InvokeDynamic #16:run:(Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl;)Ljava/lang/Runnable;
     341: invokevirtual #23                 // Method java/util/concurrent/CompletableFuture.thenRun:(Ljava/lang/Runnable;)Ljava/util/concurrent/CompletableFuture;
     344: aload         5
     346: monitorexit
     347: areturn
     348: astore        6
     350: aload         5
     352: monitorexit
     353: aload         6
     355: athrow
    Exception table:
       from    to  target type
          85   108   111   Class java/lang/Throwable
         124   166   348   any
         167   238   348   any
         239   289   348   any
         290   347   348   any
         348   353   348   any

  private void lambda$null$19();
    Code:
       0: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
       3: ldc           #92                 // String Successfully re-acquired lock at {}
       5: aload_0
       6: getfield      #5                  // Field path:Ljava/lang/String;
       9: invokeinterface #45,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      14: return

  private java.util.concurrent.CompletionStage lambda$null$18(java.lang.Object, java.lang.Void);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #27                 // Method acquireWithNoRevalidation:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
       5: areturn

  private void lambda$null$17();
    Code:
       0: aload_0
       1: ldc2_w        #6                  // long -1l
       4: invokespecial #64                 // Method setVersion:(J)V
       7: return

  private void lambda$null$16();
    Code:
       0: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
       3: ldc           #93                 // String Successfully re-acquired stale lock at {}
       5: aload_0
       6: getfield      #5                  // Field path:Ljava/lang/String;
       9: invokeinterface #45,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      14: return

  private java.util.concurrent.CompletionStage lambda$null$15(java.lang.Object, java.lang.Void);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #27                 // Method acquireWithNoRevalidation:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
       5: areturn

  private void lambda$null$14();
    Code:
       0: aload_0
       1: ldc2_w        #6                  // long -1l
       4: invokespecial #64                 // Method setVersion:(J)V
       7: return

  private void lambda$null$13();
    Code:
       0: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
       3: ldc           #94                 // String Successfully re-acquired missing lock at {}
       5: aload_0
       6: getfield      #5                  // Field path:Ljava/lang/String;
       9: invokeinterface #45,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      14: return

  private void lambda$revalidate$12(java.lang.Object, java.util.concurrent.CompletableFuture, java.lang.Void, java.lang.Throwable);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #53                 // Method doRevalidate:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
       5: aload_2
       6: invokedynamic #95,  0             // InvokeDynamic #17:run:(Ljava/util/concurrent/CompletableFuture;)Ljava/lang/Runnable;
      11: invokevirtual #23                 // Method java/util/concurrent/CompletableFuture.thenRun:(Ljava/lang/Runnable;)Ljava/util/concurrent/CompletableFuture;
      14: aload_2
      15: invokedynamic #96,  0             // InvokeDynamic #18:apply:(Ljava/util/concurrent/CompletableFuture;)Ljava/util/function/Function;
      20: invokevirtual #25                 // Method java/util/concurrent/CompletableFuture.exceptionally:(Ljava/util/function/Function;)Ljava/util/concurrent/CompletableFuture;
      23: pop
      24: return

  private static java.lang.Void lambda$null$11(java.util.concurrent.CompletableFuture, java.lang.Throwable);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #97                 // Method java/util/concurrent/CompletableFuture.completeExceptionally:(Ljava/lang/Throwable;)Z
       5: pop
       6: aconst_null
       7: areturn

  private static void lambda$null$10(java.util.concurrent.CompletableFuture);
    Code:
       0: aload_0
       1: aconst_null
       2: invokevirtual #98                 // Method java/util/concurrent/CompletableFuture.complete:(Ljava/lang/Object;)Z
       5: pop
       6: return

  private java.lang.Void lambda$lockWasInvalidated$9(java.lang.Throwable);
    Code:
       0: aload_0
       1: dup
       2: astore_2
       3: monitorenter
       4: aload_1
       5: invokevirtual #99                 // Method java/lang/Throwable.getCause:()Ljava/lang/Throwable;
       8: instanceof    #100                // class org/apache/pulsar/metadata/api/MetadataStoreException$BadVersionException
      11: ifeq          47
      14: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
      17: ldc           #101                // String Failed to revalidate the lock at {}. Marked as expired
      19: aload_0
      20: getfield      #5                  // Field path:Ljava/lang/String;
      23: invokeinterface #50,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
      28: aload_0
      29: getstatic     #16                 // Field org/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State.Released:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
      32: putfield      #13                 // Field state:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
      35: aload_0
      36: getfield      #11                 // Field expiredFuture:Ljava/util/concurrent/CompletableFuture;
      39: aconst_null
      40: invokevirtual #98                 // Method java/util/concurrent/CompletableFuture.complete:(Ljava/lang/Object;)Z
      43: pop
      44: goto          68
      47: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
      50: ldc           #102                // String Failed to revalidate the lock at {}. Retrying later on reconnection {}
      52: aload_0
      53: getfield      #5                  // Field path:Ljava/lang/String;
      56: aload_1
      57: invokevirtual #99                 // Method java/lang/Throwable.getCause:()Ljava/lang/Throwable;
      60: invokevirtual #103                // Method java/lang/Throwable.getMessage:()Ljava/lang/String;
      63: invokeinterface #104,  4          // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      68: aload_2
      69: monitorexit
      70: goto          78
      73: astore_3
      74: aload_2
      75: monitorexit
      76: aload_3
      77: athrow
      78: aconst_null
      79: areturn
    Exception table:
       from    to  target type
           4    70    73   any
          73    76    73   any

  private void lambda$lockWasInvalidated$8();
    Code:
       0: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
       3: ldc           #105                // String Successfully revalidated the lock on {}
       5: aload_0
       6: getfield      #5                  // Field path:Ljava/lang/String;
       9: invokeinterface #45,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      14: return

  private java.lang.Void lambda$acquireWithNoRevalidation$7(java.util.concurrent.CompletableFuture, java.lang.Throwable);
    Code:
       0: aload_2
       1: invokevirtual #99                 // Method java/lang/Throwable.getCause:()Ljava/lang/Throwable;
       4: instanceof    #100                // class org/apache/pulsar/metadata/api/MetadataStoreException$BadVersionException
       7: ifeq          52
      10: aload_1
      11: new           #70                 // class org/apache/pulsar/metadata/api/MetadataStoreException$LockBusyException
      14: dup
      15: new           #71                 // class java/lang/StringBuilder
      18: dup
      19: invokespecial #72                 // Method java/lang/StringBuilder."<init>":()V
      22: ldc           #87                 // String Resource at
      24: invokevirtual #74                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      27: aload_0
      28: getfield      #5                  // Field path:Ljava/lang/String;
      31: invokevirtual #74                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      34: ldc           #88                 // String  is already locked
      36: invokevirtual #74                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      39: invokevirtual #76                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      42: invokespecial #77                 // Method org/apache/pulsar/metadata/api/MetadataStoreException$LockBusyException."<init>":(Ljava/lang/String;)V
      45: invokevirtual #97                 // Method java/util/concurrent/CompletableFuture.completeExceptionally:(Ljava/lang/Throwable;)Z
      48: pop
      49: goto          61
      52: aload_1
      53: aload_2
      54: invokevirtual #99                 // Method java/lang/Throwable.getCause:()Ljava/lang/Throwable;
      57: invokevirtual #97                 // Method java/util/concurrent/CompletableFuture.completeExceptionally:(Ljava/lang/Throwable;)Z
      60: pop
      61: aconst_null
      62: areturn

  private void lambda$acquireWithNoRevalidation$6(java.lang.Object, java.util.concurrent.CompletableFuture, org.apache.pulsar.metadata.api.Stat);
    Code:
       0: aload_0
       1: dup
       2: astore        4
       4: monitorenter
       5: aload_0
       6: getstatic     #43                 // Field org/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State.Valid:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
       9: putfield      #13                 // Field state:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
      12: aload_0
      13: aload_3
      14: invokevirtual #82                 // Method org/apache/pulsar/metadata/api/Stat.getVersion:()J
      17: putfield      #8                  // Field version:J
      20: aload_0
      21: aload_1
      22: putfield      #14                 // Field value:Ljava/lang/Object;
      25: aload         4
      27: monitorexit
      28: goto          39
      31: astore        5
      33: aload         4
      35: monitorexit
      36: aload         5
      38: athrow
      39: getstatic     #30                 // Field log:Lorg/slf4j/Logger;
      42: ldc           #106                // String Acquired resource lock on {}
      44: aload_0
      45: getfield      #5                  // Field path:Ljava/lang/String;
      48: invokeinterface #45,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      53: aload_2
      54: aconst_null
      55: invokevirtual #98                 // Method java/util/concurrent/CompletableFuture.complete:(Ljava/lang/Object;)Z
      58: pop
      59: return
    Exception table:
       from    to  target type
           5    28    31   any
          31    36    31   any

  private java.lang.Void lambda$acquire$5(java.lang.Object, java.util.concurrent.CompletableFuture, java.lang.Throwable);
    Code:
       0: aload_3
       1: invokevirtual #99                 // Method java/lang/Throwable.getCause:()Ljava/lang/Throwable;
       4: instanceof    #70                 // class org/apache/pulsar/metadata/api/MetadataStoreException$LockBusyException
       7: ifeq          37
      10: aload_0
      11: aload_1
      12: invokevirtual #46                 // Method revalidate:(Ljava/lang/Object;)Ljava/util/concurrent/CompletableFuture;
      15: aload_2
      16: invokedynamic #107,  0            // InvokeDynamic #19:accept:(Ljava/util/concurrent/CompletableFuture;)Ljava/util/function/Consumer;
      21: invokevirtual #41                 // Method java/util/concurrent/CompletableFuture.thenAccept:(Ljava/util/function/Consumer;)Ljava/util/concurrent/CompletableFuture;
      24: aload_2
      25: invokedynamic #108,  0            // InvokeDynamic #20:apply:(Ljava/util/concurrent/CompletableFuture;)Ljava/util/function/Function;
      30: invokevirtual #25                 // Method java/util/concurrent/CompletableFuture.exceptionally:(Ljava/util/function/Function;)Ljava/util/concurrent/CompletableFuture;
      33: pop
      34: goto          46
      37: aload_2
      38: aload_3
      39: invokevirtual #99                 // Method java/lang/Throwable.getCause:()Ljava/lang/Throwable;
      42: invokevirtual #97                 // Method java/util/concurrent/CompletableFuture.completeExceptionally:(Ljava/lang/Throwable;)Z
      45: pop
      46: aconst_null
      47: areturn

  private static java.lang.Void lambda$null$4(java.util.concurrent.CompletableFuture, java.lang.Throwable);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #97                 // Method java/util/concurrent/CompletableFuture.completeExceptionally:(Ljava/lang/Throwable;)Z
       5: pop
       6: aconst_null
       7: areturn

  private static void lambda$null$3(java.util.concurrent.CompletableFuture, java.lang.Void);
    Code:
       0: aload_0
       1: aconst_null
       2: invokevirtual #98                 // Method java/util/concurrent/CompletableFuture.complete:(Ljava/lang/Object;)Z
       5: pop
       6: return

  private static void lambda$acquire$2(java.util.concurrent.CompletableFuture);
    Code:
       0: aload_0
       1: aconst_null
       2: invokevirtual #98                 // Method java/util/concurrent/CompletableFuture.complete:(Ljava/lang/Object;)Z
       5: pop
       6: return

  private java.lang.Void lambda$release$1(java.util.concurrent.CompletableFuture, java.lang.Throwable);
    Code:
       0: aload_2
       1: invokevirtual #99                 // Method java/lang/Throwable.getCause:()Ljava/lang/Throwable;
       4: instanceof    #109                // class org/apache/pulsar/metadata/api/MetadataStoreException$NotFoundException
       7: ifeq          51
      10: aload_0
      11: dup
      12: astore_3
      13: monitorenter
      14: aload_0
      15: getstatic     #16                 // Field org/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State.Released:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
      18: putfield      #13                 // Field state:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
      21: aload_3
      22: monitorexit
      23: goto          33
      26: astore        4
      28: aload_3
      29: monitorexit
      30: aload         4
      32: athrow
      33: aload_0
      34: getfield      #11                 // Field expiredFuture:Ljava/util/concurrent/CompletableFuture;
      37: aconst_null
      38: invokevirtual #98                 // Method java/util/concurrent/CompletableFuture.complete:(Ljava/lang/Object;)Z
      41: pop
      42: aload_1
      43: aconst_null
      44: invokevirtual #98                 // Method java/util/concurrent/CompletableFuture.complete:(Ljava/lang/Object;)Z
      47: pop
      48: goto          57
      51: aload_1
      52: aload_2
      53: invokevirtual #97                 // Method java/util/concurrent/CompletableFuture.completeExceptionally:(Ljava/lang/Throwable;)Z
      56: pop
      57: aconst_null
      58: areturn
    Exception table:
       from    to  target type
          14    23    26   any
          26    30    26   any

  private void lambda$release$0(java.util.concurrent.CompletableFuture);
    Code:
       0: aload_0
       1: dup
       2: astore_2
       3: monitorenter
       4: aload_0
       5: getstatic     #16                 // Field org/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State.Released:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
       8: putfield      #13                 // Field state:Lorg/apache/pulsar/metadata/coordination/impl/ResourceLockImpl$State;
      11: aload_2
      12: monitorexit
      13: goto          21
      16: astore_3
      17: aload_2
      18: monitorexit
      19: aload_3
      20: athrow
      21: aload_0
      22: getfield      #11                 // Field expiredFuture:Ljava/util/concurrent/CompletableFuture;
      25: aconst_null
      26: invokevirtual #98                 // Method java/util/concurrent/CompletableFuture.complete:(Ljava/lang/Object;)Z
      29: pop
      30: aload_1
      31: aconst_null
      32: invokevirtual #98                 // Method java/util/concurrent/CompletableFuture.complete:(Ljava/lang/Object;)Z
      35: pop
      36: return
    Exception table:
       from    to  target type
           4    13    16   any
          16    19    16   any

  static {};
    Code:
       0: ldc           #110                // class org/apache/pulsar/metadata/coordination/impl/ResourceLockImpl
       2: invokestatic  #111                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #30                 // Field log:Lorg/slf4j/Logger;
       8: return
}
