Compiled from "TransactionalEntryLogCompactor.java"
public class org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor extends org.apache.bookkeeper.bookie.AbstractLogCompactor {
  private static final org.slf4j.Logger LOG;

  final org.apache.bookkeeper.bookie.EntryLogger entryLogger;

  final org.apache.bookkeeper.bookie.CompactableLedgerStorage ledgerStorage;

  final java.util.List<org.apache.bookkeeper.bookie.EntryLocation> offsets;

  static final java.lang.String COMPACTING_SUFFIX;

  static final java.lang.String COMPACTED_SUFFIX;

  public org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor(org.apache.bookkeeper.conf.ServerConfiguration, org.apache.bookkeeper.bookie.EntryLogger, org.apache.bookkeeper.bookie.CompactableLedgerStorage, org.apache.bookkeeper.bookie.AbstractLogCompactor$LogRemovalListener);
    Code:
       0: aload_0
       1: aload_1
       2: aload         4
       4: invokespecial #2                  // Method org/apache/bookkeeper/bookie/AbstractLogCompactor."<init>":(Lorg/apache/bookkeeper/conf/ServerConfiguration;Lorg/apache/bookkeeper/bookie/AbstractLogCompactor$LogRemovalListener;)V
       7: aload_0
       8: new           #3                  // class java/util/ArrayList
      11: dup
      12: invokespecial #4                  // Method java/util/ArrayList."<init>":()V
      15: putfield      #5                  // Field offsets:Ljava/util/List;
      18: aload_0
      19: aload_2
      20: putfield      #6                  // Field entryLogger:Lorg/apache/bookkeeper/bookie/EntryLogger;
      23: aload_0
      24: aload_3
      25: putfield      #7                  // Field ledgerStorage:Lorg/apache/bookkeeper/bookie/CompactableLedgerStorage;
      28: return

  public void cleanUpAndRecover();
    Code:
       0: aload_0
       1: getfield      #6                  // Field entryLogger:Lorg/apache/bookkeeper/bookie/EntryLogger;
       4: invokevirtual #8                  // Method org/apache/bookkeeper/bookie/EntryLogger.getLedgerDirsManager:()Lorg/apache/bookkeeper/bookie/LedgerDirsManager;
       7: invokevirtual #9                  // Method org/apache/bookkeeper/bookie/LedgerDirsManager.getAllLedgerDirs:()Ljava/util/List;
      10: astore_1
      11: aload_1
      12: invokeinterface #10,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      17: astore_2
      18: aload_2
      19: invokeinterface #11,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      24: ifeq          187
      27: aload_2
      28: invokeinterface #12,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      33: checkcast     #13                 // class java/io/File
      36: astore_3
      37: aload_3
      38: invokedynamic #14,  0             // InvokeDynamic #0:accept:()Ljava/io/FileFilter;
      43: invokevirtual #15                 // Method java/io/File.listFiles:(Ljava/io/FileFilter;)[Ljava/io/File;
      46: astore        4
      48: aload         4
      50: ifnull        105
      53: aload         4
      55: astore        5
      57: aload         5
      59: arraylength
      60: istore        6
      62: iconst_0
      63: istore        7
      65: iload         7
      67: iload         6
      69: if_icmpge     105
      72: aload         5
      74: iload         7
      76: aaload
      77: astore        8
      79: aload         8
      81: invokevirtual #16                 // Method java/io/File.delete:()Z
      84: ifeq          99
      87: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
      90: ldc           #17                 // String Deleted failed compaction file {}
      92: aload         8
      94: invokeinterface #18,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      99: iinc          7, 1
     102: goto          65
     105: aload_3
     106: invokedynamic #19,  0             // InvokeDynamic #1:accept:()Ljava/io/FileFilter;
     111: invokevirtual #15                 // Method java/io/File.listFiles:(Ljava/io/FileFilter;)[Ljava/io/File;
     114: astore        5
     116: aload         5
     118: ifnull        184
     121: aload         5
     123: astore        6
     125: aload         6
     127: arraylength
     128: istore        7
     130: iconst_0
     131: istore        8
     133: iload         8
     135: iload         7
     137: if_icmpge     184
     140: aload         6
     142: iload         8
     144: aaload
     145: astore        9
     147: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     150: ldc           #20                 // String Found compacted log file {} has partially flushed index, recovering index.
     152: aload         9
     154: invokeinterface #18,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     159: new           #21                 // class org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$UpdateIndexPhase
     162: dup
     163: aload_0
     164: aload         9
     166: iconst_1
     167: invokespecial #22                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$UpdateIndexPhase."<init>":(Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;Ljava/io/File;Z)V
     170: astore        10
     172: aload         10
     174: invokevirtual #23                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$CompactionPhase.run:()Z
     177: pop
     178: iinc          8, 1
     181: goto          133
     184: goto          18
     187: return

  public boolean compact(org.apache.bookkeeper.bookie.EntryLogMetadata);
    Code:
       0: aload_1
       1: ifnull        182
       4: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
       7: ldc           #24                 // String Compacting entry log {} with usage {}.
       9: aload_1
      10: invokevirtual #25                 // Method org/apache/bookkeeper/bookie/EntryLogMetadata.getEntryLogId:()J
      13: invokestatic  #26                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      16: aload_1
      17: invokevirtual #27                 // Method org/apache/bookkeeper/bookie/EntryLogMetadata.getUsage:()D
      20: invokestatic  #28                 // Method java/lang/Double.valueOf:(D)Ljava/lang/Double;
      23: invokeinterface #29,  4           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      28: new           #30                 // class org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$ScanEntryLogPhase
      31: dup
      32: aload_0
      33: aload_1
      34: invokespecial #31                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$ScanEntryLogPhase."<init>":(Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;Lorg/apache/bookkeeper/bookie/EntryLogMetadata;)V
      37: astore_2
      38: aload_2
      39: invokevirtual #23                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$CompactionPhase.run:()Z
      42: ifne          64
      45: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
      48: ldc           #32                 // String Compaction for entry log {} end in ScanEntryLogPhase.
      50: aload_1
      51: invokevirtual #25                 // Method org/apache/bookkeeper/bookie/EntryLogMetadata.getEntryLogId:()J
      54: invokestatic  #26                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      57: invokeinterface #18,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      62: iconst_0
      63: ireturn
      64: aload_0
      65: getfield      #6                  // Field entryLogger:Lorg/apache/bookkeeper/bookie/EntryLogger;
      68: invokevirtual #33                 // Method org/apache/bookkeeper/bookie/EntryLogger.getCurCompactionLogFile:()Ljava/io/File;
      71: astore_3
      72: new           #34                 // class org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$FlushCompactionLogPhase
      75: dup
      76: aload_0
      77: aload_1
      78: invokevirtual #25                 // Method org/apache/bookkeeper/bookie/EntryLogMetadata.getEntryLogId:()J
      81: invokespecial #35                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$FlushCompactionLogPhase."<init>":(Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;J)V
      84: astore        4
      86: aload         4
      88: invokevirtual #23                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$CompactionPhase.run:()Z
      91: ifne          113
      94: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
      97: ldc           #36                 // String Compaction for entry log {} end in FlushCompactionLogPhase.
      99: aload_1
     100: invokevirtual #25                 // Method org/apache/bookkeeper/bookie/EntryLogMetadata.getEntryLogId:()J
     103: invokestatic  #26                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     106: invokeinterface #18,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     111: iconst_0
     112: ireturn
     113: aload_0
     114: aload_3
     115: aload_1
     116: invokevirtual #25                 // Method org/apache/bookkeeper/bookie/EntryLogMetadata.getEntryLogId:()J
     119: invokevirtual #37                 // Method getCompactedLogFile:(Ljava/io/File;J)Ljava/io/File;
     122: astore        5
     124: new           #21                 // class org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$UpdateIndexPhase
     127: dup
     128: aload_0
     129: aload         5
     131: invokespecial #38                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$UpdateIndexPhase."<init>":(Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;Ljava/io/File;)V
     134: astore        6
     136: aload         6
     138: invokevirtual #23                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$CompactionPhase.run:()Z
     141: ifne          163
     144: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     147: ldc           #39                 // String Compaction for entry log {} end in UpdateIndexPhase.
     149: aload_1
     150: invokevirtual #25                 // Method org/apache/bookkeeper/bookie/EntryLogMetadata.getEntryLogId:()J
     153: invokestatic  #26                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     156: invokeinterface #18,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     161: iconst_0
     162: ireturn
     163: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     166: ldc           #40                 // String Compacted entry log : {}.
     168: aload_1
     169: invokevirtual #25                 // Method org/apache/bookkeeper/bookie/EntryLogMetadata.getEntryLogId:()J
     172: invokestatic  #26                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     175: invokeinterface #18,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     180: iconst_1
     181: ireturn
     182: iconst_0
     183: ireturn

  java.io.File getCompactedLogFile(java.io.File, long);
    Code:
       0: aload_1
       1: ifnonnull     6
       4: aconst_null
       5: areturn
       6: aload_1
       7: invokevirtual #41                 // Method java/io/File.getParentFile:()Ljava/io/File;
      10: astore        4
      12: aload_1
      13: invokevirtual #42                 // Method java/io/File.getName:()Ljava/lang/String;
      16: astore        5
      18: new           #43                 // class java/lang/StringBuilder
      21: dup
      22: invokespecial #44                 // Method java/lang/StringBuilder."<init>":()V
      25: ldc           #45                 // String .log.
      27: invokevirtual #46                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      30: lload_2
      31: invokestatic  #47                 // Method org/apache/bookkeeper/bookie/EntryLogger.logId2HexString:(J)Ljava/lang/String;
      34: invokevirtual #46                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      37: ldc           #49                 // String .compacted
      39: invokevirtual #46                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      42: invokevirtual #50                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      45: astore        6
      47: aload         5
      49: ldc           #51                 // String .log.compacting
      51: aload         6
      53: invokevirtual #52                 // Method java/lang/String.replace:(Ljava/lang/CharSequence;Ljava/lang/CharSequence;)Ljava/lang/String;
      56: astore        7
      58: new           #13                 // class java/io/File
      61: dup
      62: aload         4
      64: aload         7
      66: invokespecial #53                 // Method java/io/File."<init>":(Ljava/io/File;Ljava/lang/String;)V
      69: areturn

  private static boolean lambda$cleanUpAndRecover$1(java.io.File);
    Code:
       0: aload_0
       1: invokevirtual #42                 // Method java/io/File.getName:()Ljava/lang/String;
       4: ldc           #49                 // String .compacted
       6: invokevirtual #54                 // Method java/lang/String.endsWith:(Ljava/lang/String;)Z
       9: ireturn

  private static boolean lambda$cleanUpAndRecover$0(java.io.File);
    Code:
       0: aload_0
       1: invokevirtual #42                 // Method java/io/File.getName:()Ljava/lang/String;
       4: ldc           #51                 // String .log.compacting
       6: invokevirtual #54                 // Method java/lang/String.endsWith:(Ljava/lang/String;)Z
       9: ireturn

  static org.slf4j.Logger access$000();
    Code:
       0: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
       3: areturn

  static {};
    Code:
       0: ldc           #48                 // class org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor
       2: invokestatic  #55                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
       8: return
}
