Compiled from "Shell.java"
public abstract class org.apache.bookkeeper.util.Shell {
  public static final org.apache.commons.logging.Log LOG;

  protected long timeOutInterval;

  private java.util.concurrent.atomic.AtomicBoolean timedOut;

  public static final boolean WINDOWS;

  private long interval;

  private long lastTime;

  private java.util.Map<java.lang.String, java.lang.String> environment;

  private java.io.File dir;

  private java.lang.Process process;

  private int exitCode;

  private volatile java.util.concurrent.atomic.AtomicBoolean completed;

  public org.apache.bookkeeper.util.Shell();
    Code:
       0: aload_0
       1: lconst_0
       2: invokespecial #3                  // Method "<init>":(J)V
       5: return

  public org.apache.bookkeeper.util.Shell(long);
    Code:
       0: aload_0
       1: invokespecial #4                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: lconst_0
       6: putfield      #5                  // Field timeOutInterval:J
       9: aload_0
      10: lload_1
      11: putfield      #6                  // Field interval:J
      14: aload_0
      15: lload_1
      16: lconst_0
      17: lcmp
      18: ifge          25
      21: lconst_0
      22: goto          27
      25: lload_1
      26: lneg
      27: putfield      #7                  // Field lastTime:J
      30: return

  protected void setEnvironment(java.util.Map<java.lang.String, java.lang.String>);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #8                  // Field environment:Ljava/util/Map;
       5: return

  protected void setWorkingDirectory(java.io.File);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #9                  // Field dir:Ljava/io/File;
       5: return

  protected void run() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #7                  // Field lastTime:J
       4: aload_0
       5: getfield      #6                  // Field interval:J
       8: ladd
       9: invokestatic  #10                 // Method java/lang/System.currentTimeMillis:()J
      12: lcmp
      13: ifle          17
      16: return
      17: aload_0
      18: iconst_0
      19: putfield      #11                 // Field exitCode:I
      22: aload_0
      23: invokespecial #12                 // Method runCommand:()V
      26: return

  private void runCommand() throws java.io.IOException;
    Code:
       0: new           #13                 // class java/lang/ProcessBuilder
       3: dup
       4: aload_0
       5: invokevirtual #14                 // Method getExecString:()[Ljava/lang/String;
       8: invokespecial #15                 // Method java/lang/ProcessBuilder."<init>":([Ljava/lang/String;)V
      11: astore_1
      12: aconst_null
      13: astore_2
      14: aconst_null
      15: astore_3
      16: aload_0
      17: new           #16                 // class java/util/concurrent/atomic/AtomicBoolean
      20: dup
      21: iconst_0
      22: invokespecial #17                 // Method java/util/concurrent/atomic/AtomicBoolean."<init>":(Z)V
      25: putfield      #18                 // Field timedOut:Ljava/util/concurrent/atomic/AtomicBoolean;
      28: aload_0
      29: new           #16                 // class java/util/concurrent/atomic/AtomicBoolean
      32: dup
      33: iconst_0
      34: invokespecial #17                 // Method java/util/concurrent/atomic/AtomicBoolean."<init>":(Z)V
      37: putfield      #2                  // Field completed:Ljava/util/concurrent/atomic/AtomicBoolean;
      40: aload_0
      41: getfield      #8                  // Field environment:Ljava/util/Map;
      44: ifnull        60
      47: aload_1
      48: invokevirtual #19                 // Method java/lang/ProcessBuilder.environment:()Ljava/util/Map;
      51: aload_0
      52: getfield      #8                  // Field environment:Ljava/util/Map;
      55: invokeinterface #20,  2           // InterfaceMethod java/util/Map.putAll:(Ljava/util/Map;)V
      60: aload_0
      61: getfield      #9                  // Field dir:Ljava/io/File;
      64: ifnull        76
      67: aload_1
      68: aload_0
      69: getfield      #9                  // Field dir:Ljava/io/File;
      72: invokevirtual #21                 // Method java/lang/ProcessBuilder.directory:(Ljava/io/File;)Ljava/lang/ProcessBuilder;
      75: pop
      76: getstatic     #22                 // Field WINDOWS:Z
      79: ifeq          92
      82: new           #23                 // class java/io/IOException
      85: dup
      86: ldc           #24                 // String Windows is not supported.
      88: invokespecial #25                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      91: athrow
      92: aload_0
      93: aload_1
      94: invokevirtual #26                 // Method java/lang/ProcessBuilder.start:()Ljava/lang/Process;
      97: putfield      #27                 // Field process:Ljava/lang/Process;
     100: aload_0
     101: getfield      #5                  // Field timeOutInterval:J
     104: lconst_0
     105: lcmp
     106: ifle          137
     109: new           #28                 // class java/util/Timer
     112: dup
     113: ldc           #29                 // String Shell command timeout
     115: invokespecial #30                 // Method java/util/Timer."<init>":(Ljava/lang/String;)V
     118: astore_2
     119: new           #31                 // class org/apache/bookkeeper/util/Shell$ShellTimeoutTimerTask
     122: dup
     123: aload_0
     124: invokespecial #32                 // Method org/apache/bookkeeper/util/Shell$ShellTimeoutTimerTask."<init>":(Lorg/apache/bookkeeper/util/Shell;)V
     127: astore_3
     128: aload_2
     129: aload_3
     130: aload_0
     131: getfield      #5                  // Field timeOutInterval:J
     134: invokevirtual #33                 // Method java/util/Timer.schedule:(Ljava/util/TimerTask;J)V
     137: new           #34                 // class java/io/BufferedReader
     140: dup
     141: new           #35                 // class java/io/InputStreamReader
     144: dup
     145: aload_0
     146: getfield      #27                 // Field process:Ljava/lang/Process;
     149: invokevirtual #36                 // Method java/lang/Process.getErrorStream:()Ljava/io/InputStream;
     152: getstatic     #37                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     155: invokespecial #38                 // Method java/io/InputStreamReader."<init>":(Ljava/io/InputStream;Ljava/nio/charset/Charset;)V
     158: invokespecial #39                 // Method java/io/BufferedReader."<init>":(Ljava/io/Reader;)V
     161: astore        4
     163: new           #34                 // class java/io/BufferedReader
     166: dup
     167: new           #35                 // class java/io/InputStreamReader
     170: dup
     171: aload_0
     172: getfield      #27                 // Field process:Ljava/lang/Process;
     175: invokevirtual #40                 // Method java/lang/Process.getInputStream:()Ljava/io/InputStream;
     178: getstatic     #37                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     181: invokespecial #38                 // Method java/io/InputStreamReader."<init>":(Ljava/io/InputStream;Ljava/nio/charset/Charset;)V
     184: invokespecial #39                 // Method java/io/BufferedReader."<init>":(Ljava/io/Reader;)V
     187: astore        5
     189: new           #41                 // class java/lang/StringBuffer
     192: dup
     193: invokespecial #42                 // Method java/lang/StringBuffer."<init>":()V
     196: astore        6
     198: new           #43                 // class org/apache/bookkeeper/util/Shell$1
     201: dup
     202: aload_0
     203: aload         4
     205: aload         6
     207: invokespecial #44                 // Method org/apache/bookkeeper/util/Shell$1."<init>":(Lorg/apache/bookkeeper/util/Shell;Ljava/io/BufferedReader;Ljava/lang/StringBuffer;)V
     210: astore        7
     212: aload         7
     214: invokevirtual #45                 // Method java/lang/Thread.start:()V
     217: goto          222
     220: astore        8
     222: aload_0
     223: aload         5
     225: invokevirtual #47                 // Method parseExecResult:(Ljava/io/BufferedReader;)V
     228: aload         5
     230: invokevirtual #48                 // Method java/io/BufferedReader.readLine:()Ljava/lang/String;
     233: astore        8
     235: aload         8
     237: ifnull        250
     240: aload         5
     242: invokevirtual #48                 // Method java/io/BufferedReader.readLine:()Ljava/lang/String;
     245: astore        8
     247: goto          235
     250: aload_0
     251: aload_0
     252: getfield      #27                 // Field process:Ljava/lang/Process;
     255: invokevirtual #49                 // Method java/lang/Process.waitFor:()I
     258: putfield      #11                 // Field exitCode:I
     261: aload         7
     263: invokevirtual #50                 // Method java/lang/Thread.join:()V
     266: goto          289
     269: astore        9
     271: invokestatic  #52                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     274: invokevirtual #53                 // Method java/lang/Thread.interrupt:()V
     277: getstatic     #54                 // Field LOG:Lorg/apache/commons/logging/Log;
     280: ldc           #55                 // String Interrupted while reading the error stream
     282: aload         9
     284: invokeinterface #56,  3           // InterfaceMethod org/apache/commons/logging/Log.warn:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     289: aload_0
     290: getfield      #2                  // Field completed:Ljava/util/concurrent/atomic/AtomicBoolean;
     293: iconst_1
     294: invokevirtual #57                 // Method java/util/concurrent/atomic/AtomicBoolean.set:(Z)V
     297: aload_0
     298: getfield      #11                 // Field exitCode:I
     301: ifeq          321
     304: new           #58                 // class org/apache/bookkeeper/util/Shell$ExitCodeException
     307: dup
     308: aload_0
     309: getfield      #11                 // Field exitCode:I
     312: aload         6
     314: invokevirtual #59                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
     317: invokespecial #60                 // Method org/apache/bookkeeper/util/Shell$ExitCodeException."<init>":(ILjava/lang/String;)V
     320: athrow
     321: aload         6
     323: invokevirtual #59                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
     326: astore        9
     328: aload         9
     330: invokevirtual #61                 // Method java/lang/String.isEmpty:()Z
     333: ifne          346
     336: getstatic     #54                 // Field LOG:Lorg/apache/commons/logging/Log;
     339: aload         9
     341: invokeinterface #62,  2           // InterfaceMethod org/apache/commons/logging/Log.error:(Ljava/lang/Object;)V
     346: aload_2
     347: ifnull        354
     350: aload_2
     351: invokevirtual #63                 // Method java/util/Timer.cancel:()V
     354: aload         5
     356: invokevirtual #64                 // Method java/io/BufferedReader.close:()V
     359: goto          376
     362: astore        8
     364: getstatic     #54                 // Field LOG:Lorg/apache/commons/logging/Log;
     367: ldc           #65                 // String Error while closing the input stream
     369: aload         8
     371: invokeinterface #56,  3           // InterfaceMethod org/apache/commons/logging/Log.warn:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     376: aload_0
     377: getfield      #2                  // Field completed:Ljava/util/concurrent/atomic/AtomicBoolean;
     380: invokevirtual #66                 // Method java/util/concurrent/atomic/AtomicBoolean.get:()Z
     383: ifne          391
     386: aload         7
     388: invokevirtual #53                 // Method java/lang/Thread.interrupt:()V
     391: aload         4
     393: invokevirtual #64                 // Method java/io/BufferedReader.close:()V
     396: goto          413
     399: astore        8
     401: getstatic     #54                 // Field LOG:Lorg/apache/commons/logging/Log;
     404: ldc           #67                 // String Error while closing the error stream
     406: aload         8
     408: invokeinterface #56,  3           // InterfaceMethod org/apache/commons/logging/Log.warn:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     413: aload_0
     414: getfield      #27                 // Field process:Ljava/lang/Process;
     417: invokevirtual #68                 // Method java/lang/Process.destroy:()V
     420: aload_0
     421: invokestatic  #10                 // Method java/lang/System.currentTimeMillis:()J
     424: putfield      #7                  // Field lastTime:J
     427: goto          537
     430: astore        8
     432: invokestatic  #52                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
     435: invokevirtual #53                 // Method java/lang/Thread.interrupt:()V
     438: new           #23                 // class java/io/IOException
     441: dup
     442: aload         8
     444: invokevirtual #69                 // Method java/lang/InterruptedException.toString:()Ljava/lang/String;
     447: invokespecial #25                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     450: athrow
     451: astore        10
     453: aload_2
     454: ifnull        461
     457: aload_2
     458: invokevirtual #63                 // Method java/util/Timer.cancel:()V
     461: aload         5
     463: invokevirtual #64                 // Method java/io/BufferedReader.close:()V
     466: goto          483
     469: astore        11
     471: getstatic     #54                 // Field LOG:Lorg/apache/commons/logging/Log;
     474: ldc           #65                 // String Error while closing the input stream
     476: aload         11
     478: invokeinterface #56,  3           // InterfaceMethod org/apache/commons/logging/Log.warn:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     483: aload_0
     484: getfield      #2                  // Field completed:Ljava/util/concurrent/atomic/AtomicBoolean;
     487: invokevirtual #66                 // Method java/util/concurrent/atomic/AtomicBoolean.get:()Z
     490: ifne          498
     493: aload         7
     495: invokevirtual #53                 // Method java/lang/Thread.interrupt:()V
     498: aload         4
     500: invokevirtual #64                 // Method java/io/BufferedReader.close:()V
     503: goto          520
     506: astore        11
     508: getstatic     #54                 // Field LOG:Lorg/apache/commons/logging/Log;
     511: ldc           #67                 // String Error while closing the error stream
     513: aload         11
     515: invokeinterface #56,  3           // InterfaceMethod org/apache/commons/logging/Log.warn:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     520: aload_0
     521: getfield      #27                 // Field process:Ljava/lang/Process;
     524: invokevirtual #68                 // Method java/lang/Process.destroy:()V
     527: aload_0
     528: invokestatic  #10                 // Method java/lang/System.currentTimeMillis:()J
     531: putfield      #7                  // Field lastTime:J
     534: aload         10
     536: athrow
     537: return
    Exception table:
       from    to  target type
         212   217   220   Class java/lang/IllegalStateException
         261   266   269   Class java/lang/InterruptedException
         354   359   362   Class java/io/IOException
         391   396   399   Class java/io/IOException
         222   346   430   Class java/lang/InterruptedException
         222   346   451   any
         461   466   469   Class java/io/IOException
         498   503   506   Class java/io/IOException
         430   453   451   any

  protected abstract java.lang.String[] getExecString();

  protected abstract void parseExecResult(java.io.BufferedReader) throws java.io.IOException;

  public java.lang.Process getProcess();
    Code:
       0: aload_0
       1: getfield      #27                 // Field process:Ljava/lang/Process;
       4: areturn

  public int getExitCode();
    Code:
       0: aload_0
       1: getfield      #11                 // Field exitCode:I
       4: ireturn

  public boolean isTimedOut();
    Code:
       0: aload_0
       1: getfield      #18                 // Field timedOut:Ljava/util/concurrent/atomic/AtomicBoolean;
       4: invokevirtual #66                 // Method java/util/concurrent/atomic/AtomicBoolean.get:()Z
       7: ireturn

  private void setTimedOut();
    Code:
       0: aload_0
       1: getfield      #18                 // Field timedOut:Ljava/util/concurrent/atomic/AtomicBoolean;
       4: iconst_1
       5: invokevirtual #57                 // Method java/util/concurrent/atomic/AtomicBoolean.set:(Z)V
       8: return

  public static java.lang.String execCommand(java.lang.String...) throws java.io.IOException;
    Code:
       0: aconst_null
       1: aload_0
       2: lconst_0
       3: invokestatic  #70                 // Method execCommand:(Ljava/util/Map;[Ljava/lang/String;J)Ljava/lang/String;
       6: areturn

  public static java.lang.String execCommand(java.util.Map<java.lang.String, java.lang.String>, java.lang.String[], long) throws java.io.IOException;
    Code:
       0: new           #71                 // class org/apache/bookkeeper/util/Shell$ShellCommandExecutor
       3: dup
       4: aload_1
       5: aconst_null
       6: aload_0
       7: lload_2
       8: invokespecial #72                 // Method org/apache/bookkeeper/util/Shell$ShellCommandExecutor."<init>":([Ljava/lang/String;Ljava/io/File;Ljava/util/Map;J)V
      11: astore        4
      13: aload         4
      15: invokevirtual #73                 // Method org/apache/bookkeeper/util/Shell$ShellCommandExecutor.execute:()V
      18: aload         4
      20: invokevirtual #74                 // Method org/apache/bookkeeper/util/Shell$ShellCommandExecutor.getOutput:()Ljava/lang/String;
      23: areturn

  public static java.lang.String execCommand(java.util.Map<java.lang.String, java.lang.String>, java.lang.String...) throws java.io.IOException;
    Code:
       0: aload_0
       1: aload_1
       2: lconst_0
       3: invokestatic  #70                 // Method execCommand:(Ljava/util/Map;[Ljava/lang/String;J)Ljava/lang/String;
       6: areturn

  static java.util.concurrent.atomic.AtomicBoolean access$000(org.apache.bookkeeper.util.Shell);
    Code:
       0: aload_0
       1: getfield      #2                  // Field completed:Ljava/util/concurrent/atomic/AtomicBoolean;
       4: areturn

  static void access$100(org.apache.bookkeeper.util.Shell);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method setTimedOut:()V
       4: return

  static {};
    Code:
       0: ldc           #75                 // class org/apache/bookkeeper/util/Shell
       2: invokestatic  #76                 // Method org/apache/commons/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/commons/logging/Log;
       5: putstatic     #54                 // Field LOG:Lorg/apache/commons/logging/Log;
       8: ldc           #77                 // String os.name
      10: invokestatic  #78                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      13: ldc           #79                 // String Windows
      15: invokevirtual #80                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      18: putstatic     #22                 // Field WINDOWS:Z
      21: return
}
