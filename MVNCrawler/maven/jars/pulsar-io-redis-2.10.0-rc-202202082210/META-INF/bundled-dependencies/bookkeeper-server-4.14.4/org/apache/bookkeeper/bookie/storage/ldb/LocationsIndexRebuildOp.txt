Compiled from "LocationsIndexRebuildOp.java"
public class org.apache.bookkeeper.bookie.storage.ldb.LocationsIndexRebuildOp {
  private final org.apache.bookkeeper.conf.ServerConfiguration conf;

  private static final org.slf4j.Logger LOG;

  public org.apache.bookkeeper.bookie.storage.ldb.LocationsIndexRebuildOp(org.apache.bookkeeper.conf.ServerConfiguration);
    Code:
       0: aload_0
       1: invokespecial #2                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #3                  // Field conf:Lorg/apache/bookkeeper/conf/ServerConfiguration;
       9: return

  public void initiate() throws java.io.IOException;
    Code:
       0: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
       3: ldc           #4                  // String Starting index rebuilding
       5: invokeinterface #5,  2            // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      10: aload_0
      11: getfield      #3                  // Field conf:Lorg/apache/bookkeeper/conf/ServerConfiguration;
      14: invokevirtual #6                  // Method org/apache/bookkeeper/conf/ServerConfiguration.getLedgerDirs:()[Ljava/io/File;
      17: iconst_0
      18: aaload
      19: invokestatic  #7                  // Method org/apache/bookkeeper/bookie/Bookie.getCurrentDirectory:(Ljava/io/File;)Ljava/io/File;
      22: invokevirtual #8                  // Method java/io/File.toString:()Ljava/lang/String;
      25: astore_1
      26: invokestatic  #9                  // Method java/nio/file/FileSystems.getDefault:()Ljava/nio/file/FileSystem;
      29: aload_1
      30: iconst_1
      31: anewarray     #10                 // class java/lang/String
      34: dup
      35: iconst_0
      36: ldc           #11                 // String locations
      38: aastore
      39: invokevirtual #12                 // Method java/nio/file/FileSystem.getPath:(Ljava/lang/String;[Ljava/lang/String;)Ljava/nio/file/Path;
      42: astore_2
      43: new           #13                 // class java/text/SimpleDateFormat
      46: dup
      47: ldc           #14                 // String yyyy-MM-dd\'T\'HH:mm:ss.SSSZ
      49: invokespecial #15                 // Method java/text/SimpleDateFormat."<init>":(Ljava/lang/String;)V
      52: new           #16                 // class java/util/Date
      55: dup
      56: invokespecial #17                 // Method java/util/Date."<init>":()V
      59: invokevirtual #18                 // Method java/text/SimpleDateFormat.format:(Ljava/util/Date;)Ljava/lang/String;
      62: astore_3
      63: invokestatic  #9                  // Method java/nio/file/FileSystems.getDefault:()Ljava/nio/file/FileSystem;
      66: aload_1
      67: iconst_1
      68: anewarray     #10                 // class java/lang/String
      71: dup
      72: iconst_0
      73: new           #19                 // class java/lang/StringBuilder
      76: dup
      77: invokespecial #20                 // Method java/lang/StringBuilder."<init>":()V
      80: ldc           #21                 // String locations.BACKUP-
      82: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      85: aload_3
      86: invokevirtual #22                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      89: invokevirtual #23                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      92: aastore
      93: invokevirtual #12                 // Method java/nio/file/FileSystem.getPath:(Ljava/lang/String;[Ljava/lang/String;)Ljava/nio/file/Path;
      96: astore        4
      98: aload_2
      99: aload         4
     101: iconst_0
     102: anewarray     #24                 // class java/nio/file/CopyOption
     105: invokestatic  #25                 // Method java/nio/file/Files.move:(Ljava/nio/file/Path;Ljava/nio/file/Path;[Ljava/nio/file/CopyOption;)Ljava/nio/file/Path;
     108: pop
     109: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     112: ldc           #26                 // String Created locations index backup at {}
     114: aload         4
     116: invokeinterface #27,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     121: invokestatic  #28                 // Method java/lang/System.nanoTime:()J
     124: lstore        5
     126: new           #29                 // class org/apache/bookkeeper/bookie/EntryLogger
     129: dup
     130: aload_0
     131: getfield      #3                  // Field conf:Lorg/apache/bookkeeper/conf/ServerConfiguration;
     134: new           #30                 // class org/apache/bookkeeper/bookie/LedgerDirsManager
     137: dup
     138: aload_0
     139: getfield      #3                  // Field conf:Lorg/apache/bookkeeper/conf/ServerConfiguration;
     142: aload_0
     143: getfield      #3                  // Field conf:Lorg/apache/bookkeeper/conf/ServerConfiguration;
     146: invokevirtual #6                  // Method org/apache/bookkeeper/conf/ServerConfiguration.getLedgerDirs:()[Ljava/io/File;
     149: new           #31                 // class org/apache/bookkeeper/util/DiskChecker
     152: dup
     153: aload_0
     154: getfield      #3                  // Field conf:Lorg/apache/bookkeeper/conf/ServerConfiguration;
     157: invokevirtual #32                 // Method org/apache/bookkeeper/conf/ServerConfiguration.getDiskUsageThreshold:()F
     160: aload_0
     161: getfield      #3                  // Field conf:Lorg/apache/bookkeeper/conf/ServerConfiguration;
     164: invokevirtual #33                 // Method org/apache/bookkeeper/conf/ServerConfiguration.getDiskUsageWarnThreshold:()F
     167: invokespecial #34                 // Method org/apache/bookkeeper/util/DiskChecker."<init>":(FF)V
     170: invokespecial #35                 // Method org/apache/bookkeeper/bookie/LedgerDirsManager."<init>":(Lorg/apache/bookkeeper/conf/ServerConfiguration;[Ljava/io/File;Lorg/apache/bookkeeper/util/DiskChecker;)V
     173: invokespecial #36                 // Method org/apache/bookkeeper/bookie/EntryLogger."<init>":(Lorg/apache/bookkeeper/conf/ServerConfiguration;Lorg/apache/bookkeeper/bookie/LedgerDirsManager;)V
     176: astore        7
     178: aload         7
     180: invokevirtual #37                 // Method org/apache/bookkeeper/bookie/EntryLogger.getEntryLogsSet:()Ljava/util/Set;
     183: astore        8
     185: aload_0
     186: aload_0
     187: getfield      #3                  // Field conf:Lorg/apache/bookkeeper/conf/ServerConfiguration;
     190: getstatic     #38                 // Field org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageRocksDB.factory:Lorg/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageFactory;
     193: aload_1
     194: invokespecial #39                 // Method getActiveLedgers:(Lorg/apache/bookkeeper/conf/ServerConfiguration;Lorg/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageFactory;Ljava/lang/String;)Ljava/util/Set;
     197: astore        9
     199: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     202: ldc           #40                 // String Found {} active ledgers in ledger manager
     204: aload         9
     206: invokeinterface #41,  1           // InterfaceMethod java/util/Set.size:()I
     211: invokestatic  #42                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     214: invokeinterface #27,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     219: getstatic     #38                 // Field org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageRocksDB.factory:Lorg/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageFactory;
     222: aload_1
     223: ldc           #11                 // String locations
     225: getstatic     #43                 // Field org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageFactory$DbConfigType.Huge:Lorg/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageFactory$DbConfigType;
     228: aload_0
     229: getfield      #3                  // Field conf:Lorg/apache/bookkeeper/conf/ServerConfiguration;
     232: invokeinterface #44,  5           // InterfaceMethod org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageFactory.newKeyValueStorage:(Ljava/lang/String;Ljava/lang/String;Lorg/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageFactory$DbConfigType;Lorg/apache/bookkeeper/conf/ServerConfiguration;)Lorg/apache/bookkeeper/bookie/storage/ldb/KeyValueStorage;
     237: astore        10
     239: aload         8
     241: invokeinterface #41,  1           // InterfaceMethod java/util/Set.size:()I
     246: istore        11
     248: iconst_0
     249: istore        12
     251: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     254: ldc           #45                 // String Scanning {} entry logs
     256: iload         11
     258: invokestatic  #42                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     261: invokeinterface #27,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     266: aload         8
     268: invokeinterface #46,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     273: astore        13
     275: aload         13
     277: invokeinterface #47,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     282: ifeq          365
     285: aload         13
     287: invokeinterface #48,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     292: checkcast     #49                 // class java/lang/Long
     295: invokevirtual #50                 // Method java/lang/Long.longValue:()J
     298: lstore        14
     300: aload         7
     302: lload         14
     304: new           #51                 // class org/apache/bookkeeper/bookie/storage/ldb/LocationsIndexRebuildOp$1
     307: dup
     308: aload_0
     309: lload         14
     311: aload         10
     313: aload         9
     315: invokespecial #52                 // Method org/apache/bookkeeper/bookie/storage/ldb/LocationsIndexRebuildOp$1."<init>":(Lorg/apache/bookkeeper/bookie/storage/ldb/LocationsIndexRebuildOp;JLorg/apache/bookkeeper/bookie/storage/ldb/KeyValueStorage;Ljava/util/Set;)V
     318: invokevirtual #53                 // Method org/apache/bookkeeper/bookie/EntryLogger.scanEntryLog:(JLorg/apache/bookkeeper/bookie/EntryLogger$EntryLogScanner;)V
     321: iinc          12, 1
     324: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     327: ldc           #54                 // String Completed scanning of log {}.log -- {} / {}
     329: iconst_3
     330: anewarray     #55                 // class java/lang/Object
     333: dup
     334: iconst_0
     335: lload         14
     337: invokestatic  #56                 // Method java/lang/Long.toHexString:(J)Ljava/lang/String;
     340: aastore
     341: dup
     342: iconst_1
     343: iload         12
     345: invokestatic  #42                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     348: aastore
     349: dup
     350: iconst_2
     351: iload         11
     353: invokestatic  #42                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     356: aastore
     357: invokeinterface #57,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;[Ljava/lang/Object;)V
     362: goto          275
     365: aload         10
     367: invokeinterface #58,  1           // InterfaceMethod org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorage.sync:()V
     372: aload         10
     374: invokeinterface #59,  1           // InterfaceMethod org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorage.close:()V
     379: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     382: ldc           #60                 // String Rebuilding index is done. Total time: {}
     384: getstatic     #61                 // Field java/util/concurrent/TimeUnit.NANOSECONDS:Ljava/util/concurrent/TimeUnit;
     387: invokestatic  #28                 // Method java/lang/System.nanoTime:()J
     390: lload         5
     392: lsub
     393: invokevirtual #62                 // Method java/util/concurrent/TimeUnit.toMillis:(J)J
     396: invokestatic  #63                 // Method org/apache/commons/lang/time/DurationFormatUtils.formatDurationHMS:(J)Ljava/lang/String;
     399: invokeinterface #27,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     404: return

  private java.util.Set<java.lang.Long> getActiveLedgers(org.apache.bookkeeper.conf.ServerConfiguration, org.apache.bookkeeper.bookie.storage.ldb.KeyValueStorageFactory, java.lang.String) throws java.io.IOException;
    Code:
       0: new           #64                 // class org/apache/bookkeeper/bookie/storage/ldb/LedgerMetadataIndex
       3: dup
       4: aload_1
       5: aload_2
       6: aload_3
       7: getstatic     #65                 // Field org/apache/bookkeeper/stats/NullStatsLogger.INSTANCE:Lorg/apache/bookkeeper/stats/NullStatsLogger;
      10: invokespecial #66                 // Method org/apache/bookkeeper/bookie/storage/ldb/LedgerMetadataIndex."<init>":(Lorg/apache/bookkeeper/conf/ServerConfiguration;Lorg/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageFactory;Ljava/lang/String;Lorg/apache/bookkeeper/stats/StatsLogger;)V
      13: astore        4
      15: invokestatic  #67                 // Method com/google/common/collect/Sets.newHashSet:()Ljava/util/HashSet;
      18: astore        5
      20: aload         4
      22: lconst_0
      23: ldc2_w        #68                 // long 9223372036854775807l
      26: invokevirtual #70                 // Method org/apache/bookkeeper/bookie/storage/ldb/LedgerMetadataIndex.getActiveLedgersInRange:(JJ)Ljava/lang/Iterable;
      29: invokeinterface #71,  1           // InterfaceMethod java/lang/Iterable.iterator:()Ljava/util/Iterator;
      34: astore        6
      36: aload         6
      38: invokeinterface #47,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      43: ifeq          71
      46: aload         6
      48: invokeinterface #48,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      53: checkcast     #49                 // class java/lang/Long
      56: astore        7
      58: aload         5
      60: aload         7
      62: invokeinterface #72,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      67: pop
      68: goto          36
      71: aload         4
      73: invokevirtual #73                 // Method org/apache/bookkeeper/bookie/storage/ldb/LedgerMetadataIndex.close:()V
      76: aload         5
      78: areturn

  static org.slf4j.Logger access$000();
    Code:
       0: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
       3: areturn

  static {};
    Code:
       0: ldc           #74                 // class org/apache/bookkeeper/bookie/storage/ldb/LocationsIndexRebuildOp
       2: invokestatic  #75                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
       8: return
}
