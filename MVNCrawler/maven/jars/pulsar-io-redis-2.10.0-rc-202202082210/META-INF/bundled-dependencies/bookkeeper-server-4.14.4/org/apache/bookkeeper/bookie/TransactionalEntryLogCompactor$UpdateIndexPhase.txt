Compiled from "TransactionalEntryLogCompactor.java"
class org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$UpdateIndexPhase extends org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase {
  java.io.File compactedLogFile;

  java.io.File newEntryLogFile;

  private final boolean isInRecovery;

  final org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor this$0;

  public org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$UpdateIndexPhase(org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor, java.io.File);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: iconst_0
       4: invokespecial #1                  // Method "<init>":(Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;Ljava/io/File;Z)V
       7: return

  public org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$UpdateIndexPhase(org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor, java.io.File, boolean);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #2                  // Field this$0:Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;
       5: aload_0
       6: ldc           #3                  // String UpdateIndexPhase
       8: invokespecial #4                  // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$CompactionPhase."<init>":(Ljava/lang/String;)V
      11: aload_0
      12: aload_2
      13: putfield      #5                  // Field compactedLogFile:Ljava/io/File;
      16: aload_0
      17: iload_3
      18: putfield      #6                  // Field isInRecovery:Z
      21: return

  void start() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #5                  // Field compactedLogFile:Ljava/io/File;
       4: ifnull        149
       7: aload_0
       8: getfield      #5                  // Field compactedLogFile:Ljava/io/File;
      11: invokevirtual #7                  // Method java/io/File.exists:()Z
      14: ifeq          149
      17: aload_0
      18: getfield      #5                  // Field compactedLogFile:Ljava/io/File;
      21: invokevirtual #8                  // Method java/io/File.getParentFile:()Ljava/io/File;
      24: astore_1
      25: aload_0
      26: getfield      #5                  // Field compactedLogFile:Ljava/io/File;
      29: invokevirtual #9                  // Method java/io/File.getName:()Ljava/lang/String;
      32: astore_2
      33: aload_0
      34: new           #10                 // class java/io/File
      37: dup
      38: aload_1
      39: aload_2
      40: iconst_0
      41: aload_2
      42: ldc           #11                 // String .log
      44: invokevirtual #12                 // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      47: iconst_4
      48: iadd
      49: invokevirtual #13                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      52: invokespecial #14                 // Method java/io/File."<init>":(Ljava/io/File;Ljava/lang/String;)V
      55: putfield      #15                 // Field newEntryLogFile:Ljava/io/File;
      58: aload_0
      59: getfield      #15                 // Field newEntryLogFile:Ljava/io/File;
      62: invokevirtual #7                  // Method java/io/File.exists:()Z
      65: ifne          79
      68: aload_0
      69: getfield      #5                  // Field compactedLogFile:Ljava/io/File;
      72: aload_0
      73: getfield      #15                 // Field newEntryLogFile:Ljava/io/File;
      76: invokestatic  #16                 // Method org/apache/bookkeeper/util/HardLink.createHardLink:(Ljava/io/File;Ljava/io/File;)V
      79: aload_0
      80: getfield      #6                  // Field isInRecovery:Z
      83: ifeq          100
      86: aload_0
      87: aload_0
      88: getfield      #15                 // Field newEntryLogFile:Ljava/io/File;
      91: invokevirtual #9                  // Method java/io/File.getName:()Ljava/lang/String;
      94: invokestatic  #17                 // Method org/apache/bookkeeper/bookie/EntryLogger.fileName2LogId:(Ljava/lang/String;)J
      97: invokespecial #18                 // Method recoverEntryLocations:(J)V
     100: aload_0
     101: getfield      #2                  // Field this$0:Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;
     104: getfield      #19                 // Field org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.offsets:Ljava/util/List;
     107: invokeinterface #20,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     112: ifne          146
     115: aload_0
     116: getfield      #2                  // Field this$0:Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;
     119: getfield      #21                 // Field org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.ledgerStorage:Lorg/apache/bookkeeper/bookie/CompactableLedgerStorage;
     122: aload_0
     123: getfield      #2                  // Field this$0:Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;
     126: getfield      #19                 // Field org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.offsets:Ljava/util/List;
     129: invokeinterface #22,  2           // InterfaceMethod org/apache/bookkeeper/bookie/CompactableLedgerStorage.updateEntriesLocations:(Ljava/lang/Iterable;)V
     134: aload_0
     135: getfield      #2                  // Field this$0:Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;
     138: getfield      #21                 // Field org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.ledgerStorage:Lorg/apache/bookkeeper/bookie/CompactableLedgerStorage;
     141: invokeinterface #23,  1           // InterfaceMethod org/apache/bookkeeper/bookie/CompactableLedgerStorage.flushEntriesLocationsIndex:()V
     146: goto          159
     149: new           #24                 // class java/io/IOException
     152: dup
     153: ldc           #25                 // String Failed to find compacted log file in UpdateIndexPhase
     155: invokespecial #26                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     158: athrow
     159: return

  boolean complete();
    Code:
       0: aload_0
       1: getfield      #2                  // Field this$0:Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;
       4: getfield      #19                 // Field org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.offsets:Ljava/util/List;
       7: invokeinterface #27,  1           // InterfaceMethod java/util/List.clear:()V
      12: aload_0
      13: getfield      #5                  // Field compactedLogFile:Ljava/io/File;
      16: ifnull        82
      19: aload_0
      20: getfield      #5                  // Field compactedLogFile:Ljava/io/File;
      23: invokevirtual #28                 // Method java/io/File.delete:()Z
      26: ifne          43
      29: invokestatic  #29                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.access$000:()Lorg/slf4j/Logger;
      32: ldc           #30                 // String Could not delete compacted log file {}
      34: aload_0
      35: getfield      #5                  // Field compactedLogFile:Ljava/io/File;
      38: invokeinterface #31,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
      43: aload_0
      44: getfield      #5                  // Field compactedLogFile:Ljava/io/File;
      47: invokevirtual #9                  // Method java/io/File.getName:()Ljava/lang/String;
      50: astore_1
      51: aload_1
      52: aload_1
      53: ldc           #11                 // String .log
      55: invokevirtual #12                 // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      58: iconst_5
      59: iadd
      60: invokevirtual #32                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      63: astore_2
      64: aload_2
      65: invokestatic  #17                 // Method org/apache/bookkeeper/bookie/EntryLogger.fileName2LogId:(Ljava/lang/String;)J
      68: lstore_3
      69: aload_0
      70: getfield      #2                  // Field this$0:Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;
      73: getfield      #33                 // Field org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.logRemovalListener:Lorg/apache/bookkeeper/bookie/AbstractLogCompactor$LogRemovalListener;
      76: lload_3
      77: invokeinterface #34,  3           // InterfaceMethod org/apache/bookkeeper/bookie/AbstractLogCompactor$LogRemovalListener.removeEntryLog:(J)V
      82: iconst_1
      83: ireturn

  void abort();
    Code:
       0: aload_0
       1: getfield      #2                  // Field this$0:Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;
       4: getfield      #19                 // Field org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.offsets:Ljava/util/List;
       7: invokeinterface #27,  1           // InterfaceMethod java/util/List.clear:()V
      12: return

  private void recoverEntryLocations(long) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field this$0:Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;
       4: getfield      #35                 // Field org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.entryLogger:Lorg/apache/bookkeeper/bookie/EntryLogger;
       7: lload_1
       8: new           #36                 // class org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$UpdateIndexPhase$1
      11: dup
      12: aload_0
      13: lload_1
      14: invokespecial #37                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$UpdateIndexPhase$1."<init>":(Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor$UpdateIndexPhase;J)V
      17: invokevirtual #38                 // Method org/apache/bookkeeper/bookie/EntryLogger.scanEntryLog:(JLorg/apache/bookkeeper/bookie/EntryLogger$EntryLogScanner;)V
      20: invokestatic  #29                 // Method org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.access$000:()Lorg/slf4j/Logger;
      23: ldc           #39                 // String Recovered {} entry locations from compacted log {}
      25: aload_0
      26: getfield      #2                  // Field this$0:Lorg/apache/bookkeeper/bookie/TransactionalEntryLogCompactor;
      29: getfield      #19                 // Field org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.offsets:Ljava/util/List;
      32: invokeinterface #40,  1           // InterfaceMethod java/util/List.size:()I
      37: invokestatic  #41                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      40: lload_1
      41: invokestatic  #42                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      44: invokeinterface #43,  4           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      49: return
}
