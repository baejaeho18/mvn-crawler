Compiled from "EntryLogManagerBase.java"
abstract class org.apache.bookkeeper.bookie.EntryLogManagerBase implements org.apache.bookkeeper.bookie.EntryLogManager {
  private static final org.slf4j.Logger log;

  volatile java.util.List<org.apache.bookkeeper.bookie.EntryLogger$BufferedLogChannel> rotatedLogChannels;

  final org.apache.bookkeeper.bookie.EntryLoggerAllocator entryLoggerAllocator;

  final org.apache.bookkeeper.bookie.LedgerDirsManager ledgerDirsManager;

  private final java.util.List<org.apache.bookkeeper.bookie.EntryLogger$EntryLogListener> listeners;

  final long logSizeLimit;

  private final io.netty.util.concurrent.FastThreadLocal<io.netty.buffer.ByteBuf> sizeBufferForAdd;

  org.apache.bookkeeper.bookie.EntryLogManagerBase(org.apache.bookkeeper.conf.ServerConfiguration, org.apache.bookkeeper.bookie.LedgerDirsManager, org.apache.bookkeeper.bookie.EntryLoggerAllocator, java.util.List<org.apache.bookkeeper.bookie.EntryLogger$EntryLogListener>);
    Code:
       0: aload_0
       1: invokespecial #2                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #3                  // class org/apache/bookkeeper/bookie/EntryLogManagerBase$1
       8: dup
       9: aload_0
      10: invokespecial #4                  // Method org/apache/bookkeeper/bookie/EntryLogManagerBase$1."<init>":(Lorg/apache/bookkeeper/bookie/EntryLogManagerBase;)V
      13: putfield      #5                  // Field sizeBufferForAdd:Lio/netty/util/concurrent/FastThreadLocal;
      16: aload_0
      17: aload_2
      18: putfield      #6                  // Field ledgerDirsManager:Lorg/apache/bookkeeper/bookie/LedgerDirsManager;
      21: aload_0
      22: aload_3
      23: putfield      #7                  // Field entryLoggerAllocator:Lorg/apache/bookkeeper/bookie/EntryLoggerAllocator;
      26: aload_0
      27: aload         4
      29: putfield      #8                  // Field listeners:Ljava/util/List;
      32: aload_0
      33: aload_1
      34: invokevirtual #9                  // Method org/apache/bookkeeper/conf/ServerConfiguration.getEntryLogSizeLimit:()J
      37: putfield      #10                 // Field logSizeLimit:J
      40: return

  public long addEntry(long, io.netty.buffer.ByteBuf, boolean) throws java.io.IOException;
    Code:
       0: aload_3
       1: invokevirtual #11                 // Method io/netty/buffer/ByteBuf.readableBytes:()I
       4: iconst_4
       5: iadd
       6: istore        5
       8: aload_0
       9: lload_1
      10: iload         5
      12: iload         4
      14: invokevirtual #12                 // Method getCurrentLogForLedgerForAddEntry:(JIZ)Lorg/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel;
      17: astore        6
      19: aload_0
      20: getfield      #5                  // Field sizeBufferForAdd:Lio/netty/util/concurrent/FastThreadLocal;
      23: invokevirtual #13                 // Method io/netty/util/concurrent/FastThreadLocal.get:()Ljava/lang/Object;
      26: checkcast     #14                 // class io/netty/buffer/ByteBuf
      29: astore        7
      31: aload         7
      33: invokevirtual #15                 // Method io/netty/buffer/ByteBuf.clear:()Lio/netty/buffer/ByteBuf;
      36: pop
      37: aload         7
      39: aload_3
      40: invokevirtual #11                 // Method io/netty/buffer/ByteBuf.readableBytes:()I
      43: invokevirtual #16                 // Method io/netty/buffer/ByteBuf.writeInt:(I)Lio/netty/buffer/ByteBuf;
      46: pop
      47: aload         6
      49: aload         7
      51: invokevirtual #17                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.write:(Lio/netty/buffer/ByteBuf;)V
      54: aload         6
      56: invokevirtual #18                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.position:()J
      59: lstore        8
      61: aload         6
      63: aload_3
      64: invokevirtual #17                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.write:(Lio/netty/buffer/ByteBuf;)V
      67: aload         6
      69: lload_1
      70: iload         5
      72: i2l
      73: invokevirtual #19                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.registerWrittenEntry:(JJ)V
      76: aload         6
      78: invokevirtual #20                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.getLogId:()J
      81: bipush        32
      83: lshl
      84: lload         8
      86: lor
      87: lreturn

  boolean reachEntryLogLimit(org.apache.bookkeeper.bookie.EntryLogger$BufferedLogChannel, long);
    Code:
       0: aload_1
       1: ifnonnull     6
       4: iconst_0
       5: ireturn
       6: aload_1
       7: invokevirtual #18                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.position:()J
      10: lload_2
      11: ladd
      12: aload_0
      13: getfield      #10                 // Field logSizeLimit:J
      16: lcmp
      17: ifle          24
      20: iconst_1
      21: goto          25
      24: iconst_0
      25: ireturn

  boolean readEntryLogHardLimit(org.apache.bookkeeper.bookie.EntryLogger$BufferedLogChannel, long);
    Code:
       0: aload_1
       1: ifnonnull     6
       4: iconst_0
       5: ireturn
       6: aload_1
       7: invokevirtual #18                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.position:()J
      10: lload_2
      11: ladd
      12: ldc2_w        #22                 // long 2147483647l
      15: lcmp
      16: ifle          23
      19: iconst_1
      20: goto          24
      23: iconst_0
      24: ireturn

  abstract org.apache.bookkeeper.bookie.EntryLogger$BufferedLogChannel getCurrentLogForLedger(long) throws java.io.IOException;

  abstract org.apache.bookkeeper.bookie.EntryLogger$BufferedLogChannel getCurrentLogForLedgerForAddEntry(long, int, boolean) throws java.io.IOException;

  abstract void setCurrentLogForLedgerAndAddToRotate(long, org.apache.bookkeeper.bookie.EntryLogger$BufferedLogChannel) throws java.io.IOException;

  abstract void flushCurrentLogs() throws java.io.IOException;

  abstract void flushRotatedLogs() throws java.io.IOException;

  java.util.List<org.apache.bookkeeper.bookie.EntryLogger$BufferedLogChannel> getRotatedLogChannels();
    Code:
       0: aload_0
       1: getfield      #24                 // Field rotatedLogChannels:Ljava/util/List;
       4: areturn

  public void flush() throws java.io.IOException;
    Code:
       0: aload_0
       1: invokevirtual #25                 // Method flushCurrentLogs:()V
       4: aload_0
       5: invokevirtual #26                 // Method flushRotatedLogs:()V
       8: return

  void flushLogChannel(org.apache.bookkeeper.bookie.EntryLogger$BufferedLogChannel, boolean) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnull        26
       4: aload_1
       5: iload_2
       6: invokevirtual #27                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.flushAndForceWrite:(Z)V
       9: getstatic     #28                 // Field log:Lorg/slf4j/Logger;
      12: ldc           #29                 // String Flush and sync current entry logger {}
      14: aload_1
      15: invokevirtual #20                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.getLogId:()J
      18: invokestatic  #30                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      21: invokeinterface #31,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      26: return

  void createNewLog(long) throws java.io.IOException;
    Code:
       0: aload_0
       1: lload_1
       2: ldc           #32                 // String
       4: invokevirtual #33                 // Method createNewLog:(JLjava/lang/String;)V
       7: return

  void createNewLog(long, java.lang.String) throws java.io.IOException;
    Code:
       0: lload_1
       1: ldc2_w        #34                 // long -1l
       4: lcmp
       5: ifeq          26
       8: getstatic     #28                 // Field log:Lorg/slf4j/Logger;
      11: ldc           #36                 // String Creating a new entry log file for ledger \'{}\' {}
      13: lload_1
      14: invokestatic  #30                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      17: aload_3
      18: invokeinterface #37,  4           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      23: goto          37
      26: getstatic     #28                 // Field log:Lorg/slf4j/Logger;
      29: ldc           #38                 // String Creating a new entry log file {}
      31: aload_3
      32: invokeinterface #39,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      37: aload_0
      38: lload_1
      39: invokevirtual #40                 // Method getCurrentLogForLedger:(J)Lorg/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel;
      42: astore        4
      44: aconst_null
      45: aload         4
      47: if_acmpeq     148
      50: aload         4
      52: invokevirtual #41                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.flush:()V
      55: aload         4
      57: invokevirtual #42                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.appendLedgersMap:()V
      60: aload_0
      61: getfield      #7                  // Field entryLoggerAllocator:Lorg/apache/bookkeeper/bookie/EntryLoggerAllocator;
      64: aload_0
      65: invokevirtual #43                 // Method selectDirForNextEntryLog:()Ljava/io/File;
      68: invokevirtual #44                 // Method org/apache/bookkeeper/bookie/EntryLoggerAllocator.createNewLog:(Ljava/io/File;)Lorg/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel;
      71: astore        5
      73: aload_0
      74: lload_1
      75: aload         5
      77: invokevirtual #45                 // Method setCurrentLogForLedgerAndAddToRotate:(JLorg/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel;)V
      80: getstatic     #28                 // Field log:Lorg/slf4j/Logger;
      83: ldc           #46                 // String Flushing entry logger {} back to filesystem, pending for syncing entry loggers : {}.
      85: aload         4
      87: invokevirtual #20                 // Method org/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel.getLogId:()J
      90: invokestatic  #30                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      93: aload_0
      94: getfield      #24                 // Field rotatedLogChannels:Ljava/util/List;
      97: invokeinterface #37,  4           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     102: aload_0
     103: getfield      #8                  // Field listeners:Ljava/util/List;
     106: invokeinterface #47,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     111: astore        6
     113: aload         6
     115: invokeinterface #48,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     120: ifeq          145
     123: aload         6
     125: invokeinterface #49,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     130: checkcast     #50                 // class org/apache/bookkeeper/bookie/EntryLogger$EntryLogListener
     133: astore        7
     135: aload         7
     137: invokeinterface #51,  1           // InterfaceMethod org/apache/bookkeeper/bookie/EntryLogger$EntryLogListener.onRotateEntryLog:()V
     142: goto          113
     145: goto          164
     148: aload_0
     149: lload_1
     150: aload_0
     151: getfield      #7                  // Field entryLoggerAllocator:Lorg/apache/bookkeeper/bookie/EntryLoggerAllocator;
     154: aload_0
     155: invokevirtual #43                 // Method selectDirForNextEntryLog:()Ljava/io/File;
     158: invokevirtual #44                 // Method org/apache/bookkeeper/bookie/EntryLoggerAllocator.createNewLog:(Ljava/io/File;)Lorg/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel;
     161: invokevirtual #45                 // Method setCurrentLogForLedgerAndAddToRotate:(JLorg/apache/bookkeeper/bookie/EntryLogger$BufferedLogChannel;)V
     164: return

  java.io.File selectDirForNextEntryLog() throws org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException;
    Code:
       0: aload_0
       1: aload_0
       2: getfield      #6                  // Field ledgerDirsManager:Lorg/apache/bookkeeper/bookie/LedgerDirsManager;
       5: invokevirtual #52                 // Method org/apache/bookkeeper/bookie/LedgerDirsManager.getWritableLedgerDirsForNewLog:()Ljava/util/List;
       8: invokevirtual #53                 // Method getDirForNextEntryLog:(Ljava/util/List;)Ljava/io/File;
      11: areturn

  static {};
    Code:
       0: ldc           #54                 // class org/apache/bookkeeper/bookie/EntryLogManagerBase
       2: invokestatic  #55                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #28                 // Field log:Lorg/slf4j/Logger;
       8: return
}
