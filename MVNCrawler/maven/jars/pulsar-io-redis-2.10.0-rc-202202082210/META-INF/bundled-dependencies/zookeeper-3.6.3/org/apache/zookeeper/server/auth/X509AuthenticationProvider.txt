Compiled from "X509AuthenticationProvider.java"
public class org.apache.zookeeper.server.auth.X509AuthenticationProvider implements org.apache.zookeeper.server.auth.AuthenticationProvider {
  static final java.lang.String ZOOKEEPER_X509AUTHENTICATIONPROVIDER_SUPERUSER;

  private static final org.slf4j.Logger LOG;

  private final javax.net.ssl.X509TrustManager trustManager;

  private final javax.net.ssl.X509KeyManager keyManager;

  public org.apache.zookeeper.server.auth.X509AuthenticationProvider() throws org.apache.zookeeper.common.X509Exception;
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: new           #2                  // class org/apache/zookeeper/common/ZKConfig
       7: dup
       8: invokespecial #3                  // Method org/apache/zookeeper/common/ZKConfig."<init>":()V
      11: astore_1
      12: new           #4                  // class org/apache/zookeeper/common/ClientX509Util
      15: dup
      16: invokespecial #5                  // Method org/apache/zookeeper/common/ClientX509Util."<init>":()V
      19: astore_2
      20: aconst_null
      21: astore_3
      22: aload_1
      23: aload_2
      24: invokevirtual #6                  // Method org/apache/zookeeper/common/X509Util.getSslKeystoreLocationProperty:()Ljava/lang/String;
      27: ldc           #7                  // String
      29: invokevirtual #8                  // Method org/apache/zookeeper/common/ZKConfig.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      32: astore        4
      34: aload_1
      35: aload_2
      36: invokevirtual #9                  // Method org/apache/zookeeper/common/X509Util.getSslKeystorePasswdProperty:()Ljava/lang/String;
      39: ldc           #7                  // String
      41: invokevirtual #8                  // Method org/apache/zookeeper/common/ZKConfig.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      44: astore        5
      46: aload_1
      47: aload_2
      48: invokevirtual #10                 // Method org/apache/zookeeper/common/X509Util.getSslKeystoreTypeProperty:()Ljava/lang/String;
      51: invokevirtual #11                 // Method org/apache/zookeeper/common/ZKConfig.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      54: astore        6
      56: aload_1
      57: aload_2
      58: invokevirtual #12                 // Method org/apache/zookeeper/common/X509Util.getSslCrlEnabledProperty:()Ljava/lang/String;
      61: invokevirtual #11                 // Method org/apache/zookeeper/common/ZKConfig.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      64: invokestatic  #13                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
      67: istore        7
      69: aload_1
      70: aload_2
      71: invokevirtual #14                 // Method org/apache/zookeeper/common/X509Util.getSslOcspEnabledProperty:()Ljava/lang/String;
      74: invokevirtual #11                 // Method org/apache/zookeeper/common/ZKConfig.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      77: invokestatic  #13                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
      80: istore        8
      82: aload_1
      83: aload_2
      84: invokevirtual #15                 // Method org/apache/zookeeper/common/X509Util.getSslHostnameVerificationEnabledProperty:()Ljava/lang/String;
      87: invokevirtual #11                 // Method org/apache/zookeeper/common/ZKConfig.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      90: invokestatic  #13                 // Method java/lang/Boolean.parseBoolean:(Ljava/lang/String;)Z
      93: istore        9
      95: aconst_null
      96: astore        10
      98: aconst_null
      99: astore        11
     101: aload         4
     103: invokevirtual #16                 // Method java/lang/String.isEmpty:()Z
     106: ifeq          122
     109: getstatic     #17                 // Field LOG:Lorg/slf4j/Logger;
     112: ldc           #18                 // String keystore not specified for client connection
     114: invokeinterface #19,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     119: goto          150
     122: aload         4
     124: aload         5
     126: aload         6
     128: invokestatic  #20                 // Method org/apache/zookeeper/common/X509Util.createKeyManager:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljavax/net/ssl/X509KeyManager;
     131: astore        10
     133: goto          150
     136: astore        12
     138: getstatic     #17                 // Field LOG:Lorg/slf4j/Logger;
     141: ldc           #22                 // String Failed to create key manager
     143: aload         12
     145: invokeinterface #23,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     150: aload_1
     151: aload_2
     152: invokevirtual #24                 // Method org/apache/zookeeper/common/X509Util.getSslTruststoreLocationProperty:()Ljava/lang/String;
     155: ldc           #7                  // String
     157: invokevirtual #8                  // Method org/apache/zookeeper/common/ZKConfig.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     160: astore        12
     162: aload_1
     163: aload_2
     164: invokevirtual #25                 // Method org/apache/zookeeper/common/X509Util.getSslTruststorePasswdProperty:()Ljava/lang/String;
     167: ldc           #7                  // String
     169: invokevirtual #8                  // Method org/apache/zookeeper/common/ZKConfig.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     172: astore        13
     174: aload_1
     175: aload_2
     176: invokevirtual #26                 // Method org/apache/zookeeper/common/X509Util.getSslTruststoreTypeProperty:()Ljava/lang/String;
     179: invokevirtual #11                 // Method org/apache/zookeeper/common/ZKConfig.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     182: astore        14
     184: aload         12
     186: invokevirtual #16                 // Method java/lang/String.isEmpty:()Z
     189: ifeq          205
     192: getstatic     #17                 // Field LOG:Lorg/slf4j/Logger;
     195: ldc           #27                 // String Truststore not specified for client connection
     197: invokeinterface #19,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     202: goto          240
     205: aload         12
     207: aload         13
     209: aload         14
     211: iload         7
     213: iload         8
     215: iload         9
     217: iconst_0
     218: invokestatic  #28                 // Method org/apache/zookeeper/common/X509Util.createTrustManager:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZZZZ)Ljavax/net/ssl/X509TrustManager;
     221: astore        11
     223: goto          240
     226: astore        15
     228: getstatic     #17                 // Field LOG:Lorg/slf4j/Logger;
     231: ldc           #30                 // String Failed to create trust manager
     233: aload         15
     235: invokeinterface #23,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     240: aload_0
     241: aload         10
     243: putfield      #31                 // Field keyManager:Ljavax/net/ssl/X509KeyManager;
     246: aload_0
     247: aload         11
     249: putfield      #32                 // Field trustManager:Ljavax/net/ssl/X509TrustManager;
     252: aload_2
     253: ifnull        328
     256: aload_3
     257: ifnull        278
     260: aload_2
     261: invokevirtual #33                 // Method org/apache/zookeeper/common/X509Util.close:()V
     264: goto          328
     267: astore        4
     269: aload_3
     270: aload         4
     272: invokevirtual #35                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     275: goto          328
     278: aload_2
     279: invokevirtual #33                 // Method org/apache/zookeeper/common/X509Util.close:()V
     282: goto          328
     285: astore        4
     287: aload         4
     289: astore_3
     290: aload         4
     292: athrow
     293: astore        16
     295: aload_2
     296: ifnull        325
     299: aload_3
     300: ifnull        321
     303: aload_2
     304: invokevirtual #33                 // Method org/apache/zookeeper/common/X509Util.close:()V
     307: goto          325
     310: astore        17
     312: aload_3
     313: aload         17
     315: invokevirtual #35                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     318: goto          325
     321: aload_2
     322: invokevirtual #33                 // Method org/apache/zookeeper/common/X509Util.close:()V
     325: aload         16
     327: athrow
     328: return
    Exception table:
       from    to  target type
         122   133   136   Class org/apache/zookeeper/common/X509Exception$KeyManagerException
         205   223   226   Class org/apache/zookeeper/common/X509Exception$TrustManagerException
         260   264   267   Class java/lang/Throwable
          22   252   285   Class java/lang/Throwable
          22   252   293   any
         303   307   310   Class java/lang/Throwable
         285   295   293   any

  public org.apache.zookeeper.server.auth.X509AuthenticationProvider(javax.net.ssl.X509TrustManager, javax.net.ssl.X509KeyManager);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #32                 // Field trustManager:Ljavax/net/ssl/X509TrustManager;
       9: aload_0
      10: aload_2
      11: putfield      #31                 // Field keyManager:Ljavax/net/ssl/X509KeyManager;
      14: return

  public java.lang.String getScheme();
    Code:
       0: ldc           #36                 // String x509
       2: areturn

  public org.apache.zookeeper.KeeperException$Code handleAuthentication(org.apache.zookeeper.server.ServerCnxn, byte[]);
    Code:
       0: aload_1
       1: invokevirtual #37                 // Method org/apache/zookeeper/server/ServerCnxn.getClientCertificateChain:()[Ljava/security/cert/Certificate;
       4: checkcast     #38                 // class "[Ljava/security/cert/X509Certificate;"
       7: checkcast     #38                 // class "[Ljava/security/cert/X509Certificate;"
      10: astore_3
      11: aload_3
      12: ifnull        20
      15: aload_3
      16: arraylength
      17: ifne          24
      20: getstatic     #39                 // Field org/apache/zookeeper/KeeperException$Code.AUTHFAILED:Lorg/apache/zookeeper/KeeperException$Code;
      23: areturn
      24: aload_0
      25: getfield      #32                 // Field trustManager:Ljavax/net/ssl/X509TrustManager;
      28: ifnonnull     52
      31: getstatic     #17                 // Field LOG:Lorg/slf4j/Logger;
      34: ldc           #40                 // String No trust manager available to authenticate session 0x{}
      36: aload_1
      37: invokevirtual #41                 // Method org/apache/zookeeper/server/ServerCnxn.getSessionId:()J
      40: invokestatic  #42                 // Method java/lang/Long.toHexString:(J)Ljava/lang/String;
      43: invokeinterface #43,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;)V
      48: getstatic     #39                 // Field org/apache/zookeeper/KeeperException$Code.AUTHFAILED:Lorg/apache/zookeeper/KeeperException$Code;
      51: areturn
      52: aload_3
      53: iconst_0
      54: aaload
      55: astore        4
      57: aload_0
      58: getfield      #32                 // Field trustManager:Ljavax/net/ssl/X509TrustManager;
      61: aload_3
      62: aload         4
      64: invokevirtual #44                 // Method java/security/cert/X509Certificate.getPublicKey:()Ljava/security/PublicKey;
      67: invokeinterface #45,  1           // InterfaceMethod java/security/PublicKey.getAlgorithm:()Ljava/lang/String;
      72: invokeinterface #46,  3           // InterfaceMethod javax/net/ssl/X509TrustManager.checkClientTrusted:([Ljava/security/cert/X509Certificate;Ljava/lang/String;)V
      77: goto          105
      80: astore        5
      82: getstatic     #17                 // Field LOG:Lorg/slf4j/Logger;
      85: ldc           #48                 // String Failed to trust certificate for session 0x{}
      87: aload_1
      88: invokevirtual #41                 // Method org/apache/zookeeper/server/ServerCnxn.getSessionId:()J
      91: invokestatic  #42                 // Method java/lang/Long.toHexString:(J)Ljava/lang/String;
      94: aload         5
      96: invokeinterface #49,  4           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     101: getstatic     #39                 // Field org/apache/zookeeper/KeeperException$Code.AUTHFAILED:Lorg/apache/zookeeper/KeeperException$Code;
     104: areturn
     105: aload_0
     106: aload         4
     108: invokevirtual #50                 // Method getClientId:(Ljava/security/cert/X509Certificate;)Ljava/lang/String;
     111: astore        5
     113: aload         5
     115: ldc           #52                 // String zookeeper.X509AuthenticationProvider.superUser
     117: invokestatic  #53                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
     120: invokevirtual #54                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     123: ifeq          153
     126: aload_1
     127: new           #55                 // class org/apache/zookeeper/data/Id
     130: dup
     131: ldc           #56                 // String super
     133: aload         5
     135: invokespecial #57                 // Method org/apache/zookeeper/data/Id."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     138: invokevirtual #58                 // Method org/apache/zookeeper/server/ServerCnxn.addAuthInfo:(Lorg/apache/zookeeper/data/Id;)V
     141: getstatic     #17                 // Field LOG:Lorg/slf4j/Logger;
     144: ldc           #59                 // String Authenticated Id \'{}\' as super user
     146: aload         5
     148: invokeinterface #60,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     153: new           #55                 // class org/apache/zookeeper/data/Id
     156: dup
     157: aload_0
     158: invokevirtual #61                 // Method getScheme:()Ljava/lang/String;
     161: aload         5
     163: invokespecial #57                 // Method org/apache/zookeeper/data/Id."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     166: astore        6
     168: aload_1
     169: aload         6
     171: invokevirtual #58                 // Method org/apache/zookeeper/server/ServerCnxn.addAuthInfo:(Lorg/apache/zookeeper/data/Id;)V
     174: getstatic     #17                 // Field LOG:Lorg/slf4j/Logger;
     177: ldc           #62                 // String Authenticated Id \'{}\' for Scheme \'{}\'
     179: aload         6
     181: invokevirtual #63                 // Method org/apache/zookeeper/data/Id.getId:()Ljava/lang/String;
     184: aload         6
     186: invokevirtual #64                 // Method org/apache/zookeeper/data/Id.getScheme:()Ljava/lang/String;
     189: invokeinterface #65,  4           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     194: getstatic     #66                 // Field org/apache/zookeeper/KeeperException$Code.OK:Lorg/apache/zookeeper/KeeperException$Code;
     197: areturn
    Exception table:
       from    to  target type
          57    77    80   Class java/security/cert/CertificateException

  protected java.lang.String getClientId(java.security.cert.X509Certificate);
    Code:
       0: aload_1
       1: invokevirtual #67                 // Method java/security/cert/X509Certificate.getSubjectX500Principal:()Ljavax/security/auth/x500/X500Principal;
       4: invokevirtual #68                 // Method javax/security/auth/x500/X500Principal.getName:()Ljava/lang/String;
       7: areturn

  public boolean matches(java.lang.String, java.lang.String);
    Code:
       0: ldc           #52                 // String zookeeper.X509AuthenticationProvider.superUser
       2: invokestatic  #53                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       5: ifnull        34
       8: aload_1
       9: ldc           #52                 // String zookeeper.X509AuthenticationProvider.superUser
      11: invokestatic  #53                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      14: invokevirtual #54                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      17: ifne          28
      20: aload_1
      21: aload_2
      22: invokevirtual #54                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      25: ifeq          32
      28: iconst_1
      29: goto          33
      32: iconst_0
      33: ireturn
      34: aload_1
      35: aload_2
      36: invokevirtual #54                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      39: ireturn

  public boolean isAuthenticated();
    Code:
       0: iconst_1
       1: ireturn

  public boolean isValid(java.lang.String);
    Code:
       0: new           #69                 // class javax/security/auth/x500/X500Principal
       3: dup
       4: aload_1
       5: invokespecial #70                 // Method javax/security/auth/x500/X500Principal."<init>":(Ljava/lang/String;)V
       8: pop
       9: iconst_1
      10: ireturn
      11: astore_2
      12: iconst_0
      13: ireturn
    Exception table:
       from    to  target type
           0    10    11   Class java/lang/IllegalArgumentException

  public javax.net.ssl.X509TrustManager getTrustManager() throws org.apache.zookeeper.common.X509Exception$TrustManagerException;
    Code:
       0: aload_0
       1: getfield      #32                 // Field trustManager:Ljavax/net/ssl/X509TrustManager;
       4: ifnonnull     17
       7: new           #29                 // class org/apache/zookeeper/common/X509Exception$TrustManagerException
      10: dup
      11: ldc           #72                 // String No trust manager available
      13: invokespecial #73                 // Method org/apache/zookeeper/common/X509Exception$TrustManagerException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_0
      18: getfield      #32                 // Field trustManager:Ljavax/net/ssl/X509TrustManager;
      21: areturn

  public javax.net.ssl.X509KeyManager getKeyManager() throws org.apache.zookeeper.common.X509Exception$KeyManagerException;
    Code:
       0: aload_0
       1: getfield      #31                 // Field keyManager:Ljavax/net/ssl/X509KeyManager;
       4: ifnonnull     17
       7: new           #21                 // class org/apache/zookeeper/common/X509Exception$KeyManagerException
      10: dup
      11: ldc           #74                 // String No key manager available
      13: invokespecial #75                 // Method org/apache/zookeeper/common/X509Exception$KeyManagerException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_0
      18: getfield      #31                 // Field keyManager:Ljavax/net/ssl/X509KeyManager;
      21: areturn

  static {};
    Code:
       0: ldc           #51                 // class org/apache/zookeeper/server/auth/X509AuthenticationProvider
       2: invokestatic  #76                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #17                 // Field LOG:Lorg/slf4j/Logger;
       8: return
}
