Compiled from "SaslQuorumAuthLearner.java"
public class org.apache.zookeeper.server.quorum.auth.SaslQuorumAuthLearner implements org.apache.zookeeper.server.quorum.auth.QuorumAuthLearner {
  private static final org.slf4j.Logger LOG;

  private final org.apache.zookeeper.Login learnerLogin;

  private final boolean quorumRequireSasl;

  private final java.lang.String quorumServicePrincipal;

  public org.apache.zookeeper.server.quorum.auth.SaslQuorumAuthLearner(boolean, java.lang.String, java.lang.String) throws javax.security.sasl.SaslException;
    Code:
       0: aload_0
       1: invokespecial #2                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iload_1
       6: putfield      #3                  // Field quorumRequireSasl:Z
       9: aload_0
      10: aload_2
      11: putfield      #4                  // Field quorumServicePrincipal:Ljava/lang/String;
      14: invokestatic  #5                  // Method javax/security/auth/login/Configuration.getConfiguration:()Ljavax/security/auth/login/Configuration;
      17: aload_3
      18: invokevirtual #6                  // Method javax/security/auth/login/Configuration.getAppConfigurationEntry:(Ljava/lang/String;)[Ljavax/security/auth/login/AppConfigurationEntry;
      21: astore        4
      23: aload         4
      25: ifnull        34
      28: aload         4
      30: arraylength
      31: ifne          55
      34: new           #7                  // class javax/security/auth/login/LoginException
      37: dup
      38: ldc           #8                  // String SASL-authentication failed because the specified JAAS configuration section \'%s\' could not be found.
      40: iconst_1
      41: anewarray     #9                  // class java/lang/Object
      44: dup
      45: iconst_0
      46: aload_3
      47: aastore
      48: invokestatic  #10                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      51: invokespecial #11                 // Method javax/security/auth/login/LoginException."<init>":(Ljava/lang/String;)V
      54: athrow
      55: aload_0
      56: new           #12                 // class org/apache/zookeeper/Login
      59: dup
      60: aload_3
      61: new           #13                 // class org/apache/zookeeper/SaslClientCallbackHandler
      64: dup
      65: aconst_null
      66: ldc           #14                 // String QuorumLearner
      68: invokespecial #15                 // Method org/apache/zookeeper/SaslClientCallbackHandler."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      71: new           #16                 // class org/apache/zookeeper/common/ZKConfig
      74: dup
      75: invokespecial #17                 // Method org/apache/zookeeper/common/ZKConfig."<init>":()V
      78: invokespecial #18                 // Method org/apache/zookeeper/Login."<init>":(Ljava/lang/String;Ljavax/security/auth/callback/CallbackHandler;Lorg/apache/zookeeper/common/ZKConfig;)V
      81: putfield      #19                 // Field learnerLogin:Lorg/apache/zookeeper/Login;
      84: aload_0
      85: getfield      #19                 // Field learnerLogin:Lorg/apache/zookeeper/Login;
      88: invokevirtual #20                 // Method org/apache/zookeeper/Login.startThreadIfNeeded:()V
      91: goto          108
      94: astore        4
      96: new           #21                 // class javax/security/sasl/SaslException
      99: dup
     100: ldc           #22                 // String Failed to initialize authentication mechanism using SASL
     102: aload         4
     104: invokespecial #23                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     107: athrow
     108: return
    Exception table:
       from    to  target type
          14    91    94   Class javax/security/auth/login/LoginException

  public void authenticate(java.net.Socket, java.lang.String) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #3                  // Field quorumRequireSasl:Z
       4: ifne          27
       7: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
      10: ldc           #24                 // String Skipping SASL authentication as {}={}
      12: ldc           #26                 // String quorum.auth.learnerRequireSasl
      14: aload_0
      15: getfield      #3                  // Field quorumRequireSasl:Z
      18: invokestatic  #27                 // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
      21: invokeinterface #28,  4           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      26: return
      27: aconst_null
      28: astore_3
      29: aload_0
      30: getfield      #4                  // Field quorumServicePrincipal:Ljava/lang/String;
      33: aload_2
      34: invokestatic  #29                 // Method org/apache/zookeeper/util/SecurityUtils.getServerPrincipal:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      37: astore        4
      39: new           #30                 // class java/io/DataOutputStream
      42: dup
      43: aload_1
      44: invokevirtual #31                 // Method java/net/Socket.getOutputStream:()Ljava/io/OutputStream;
      47: invokespecial #32                 // Method java/io/DataOutputStream."<init>":(Ljava/io/OutputStream;)V
      50: astore        5
      52: new           #33                 // class java/io/DataInputStream
      55: dup
      56: aload_1
      57: invokevirtual #34                 // Method java/net/Socket.getInputStream:()Ljava/io/InputStream;
      60: invokespecial #35                 // Method java/io/DataInputStream."<init>":(Ljava/io/InputStream;)V
      63: astore        6
      65: iconst_0
      66: newarray       byte
      68: astore        7
      70: aload_0
      71: getfield      #19                 // Field learnerLogin:Lorg/apache/zookeeper/Login;
      74: invokevirtual #36                 // Method org/apache/zookeeper/Login.getSubject:()Ljavax/security/auth/Subject;
      77: aload         4
      79: ldc           #37                 // String zookeeper-quorum
      81: ldc           #38                 // String zk-quorum-sasl-md5
      83: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
      86: ldc           #14                 // String QuorumLearner
      88: invokestatic  #39                 // Method org/apache/zookeeper/util/SecurityUtils.createSaslClient:(Ljavax/security/auth/Subject;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Lorg/slf4j/Logger;Ljava/lang/String;)Ljavax/security/sasl/SaslClient;
      91: astore_3
      92: aload_3
      93: invokeinterface #40,  1           // InterfaceMethod javax/security/sasl/SaslClient.hasInitialResponse:()Z
      98: ifeq          115
     101: aload_0
     102: iconst_0
     103: newarray       byte
     105: aload_3
     106: aload_0
     107: getfield      #19                 // Field learnerLogin:Lorg/apache/zookeeper/Login;
     110: invokespecial #41                 // Method createSaslToken:([BLjavax/security/sasl/SaslClient;Lorg/apache/zookeeper/Login;)[B
     113: astore        7
     115: aload_0
     116: aload         5
     118: aload         7
     120: invokespecial #42                 // Method send:(Ljava/io/DataOutputStream;[B)V
     123: aload_0
     124: aload         6
     126: invokespecial #43                 // Method receive:(Ljava/io/DataInputStream;)Lorg/apache/zookeeper/server/quorum/QuorumAuthPacket;
     129: astore        8
     131: aload         8
     133: invokevirtual #44                 // Method org/apache/zookeeper/server/quorum/QuorumAuthPacket.getStatus:()I
     136: invokestatic  #45                 // Method org/apache/zookeeper/server/quorum/auth/QuorumAuth$Status.getStatus:(I)Lorg/apache/zookeeper/server/quorum/auth/QuorumAuth$Status;
     139: astore        9
     141: aload_3
     142: invokeinterface #46,  1           // InterfaceMethod javax/security/sasl/SaslClient.isComplete:()Z
     147: ifne          332
     150: getstatic     #47                 // Field org/apache/zookeeper/server/quorum/auth/SaslQuorumAuthLearner$2.$SwitchMap$org$apache$zookeeper$server$quorum$auth$QuorumAuth$Status:[I
     153: aload         9
     155: invokevirtual #48                 // Method org/apache/zookeeper/server/quorum/auth/QuorumAuth$Status.ordinal:()I
     158: iaload
     159: tableswitch   { // 1 to 3
                     1: 184
                     2: 215
                     3: 260
               default: 290
          }
     184: aload_0
     185: aload         8
     187: invokevirtual #49                 // Method org/apache/zookeeper/server/quorum/QuorumAuthPacket.getToken:()[B
     190: aload_3
     191: aload_0
     192: getfield      #19                 // Field learnerLogin:Lorg/apache/zookeeper/Login;
     195: invokespecial #41                 // Method createSaslToken:([BLjavax/security/sasl/SaslClient;Lorg/apache/zookeeper/Login;)[B
     198: astore        7
     200: aload         7
     202: ifnull        141
     205: new           #21                 // class javax/security/sasl/SaslException
     208: dup
     209: ldc           #50                 // String Protocol error: attempting to send response after completion
     211: invokespecial #51                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     214: athrow
     215: aload_0
     216: aload         8
     218: invokevirtual #49                 // Method org/apache/zookeeper/server/quorum/QuorumAuthPacket.getToken:()[B
     221: aload_3
     222: aload_0
     223: getfield      #19                 // Field learnerLogin:Lorg/apache/zookeeper/Login;
     226: invokespecial #41                 // Method createSaslToken:([BLjavax/security/sasl/SaslClient;Lorg/apache/zookeeper/Login;)[B
     229: astore        7
     231: aload_0
     232: aload         5
     234: aload         7
     236: invokespecial #42                 // Method send:(Ljava/io/DataOutputStream;[B)V
     239: aload_0
     240: aload         6
     242: invokespecial #43                 // Method receive:(Ljava/io/DataInputStream;)Lorg/apache/zookeeper/server/quorum/QuorumAuthPacket;
     245: astore        8
     247: aload         8
     249: invokevirtual #44                 // Method org/apache/zookeeper/server/quorum/QuorumAuthPacket.getStatus:()I
     252: invokestatic  #45                 // Method org/apache/zookeeper/server/quorum/auth/QuorumAuth$Status.getStatus:(I)Lorg/apache/zookeeper/server/quorum/auth/QuorumAuth$Status;
     255: astore        9
     257: goto          141
     260: new           #21                 // class javax/security/sasl/SaslException
     263: dup
     264: new           #52                 // class java/lang/StringBuilder
     267: dup
     268: invokespecial #53                 // Method java/lang/StringBuilder."<init>":()V
     271: ldc           #54                 // String Authentication failed against server addr:
     273: invokevirtual #55                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     276: aload_1
     277: invokevirtual #56                 // Method java/net/Socket.getRemoteSocketAddress:()Ljava/net/SocketAddress;
     280: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     283: invokevirtual #58                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     286: invokespecial #51                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     289: athrow
     290: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     293: ldc           #59                 // String Unknown status:{}!
     295: aload         9
     297: invokeinterface #60,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
     302: new           #21                 // class javax/security/sasl/SaslException
     305: dup
     306: new           #52                 // class java/lang/StringBuilder
     309: dup
     310: invokespecial #53                 // Method java/lang/StringBuilder."<init>":()V
     313: ldc           #54                 // String Authentication failed against server addr:
     315: invokevirtual #55                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     318: aload_1
     319: invokevirtual #56                 // Method java/net/Socket.getRemoteSocketAddress:()Ljava/net/SocketAddress;
     322: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     325: invokevirtual #58                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     328: invokespecial #51                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     331: athrow
     332: aload_0
     333: aload_1
     334: aload         9
     336: invokespecial #61                 // Method checkAuthStatus:(Ljava/net/Socket;Lorg/apache/zookeeper/server/quorum/auth/QuorumAuth$Status;)V
     339: aload_3
     340: ifnull        401
     343: aload_3
     344: invokeinterface #62,  1           // InterfaceMethod javax/security/sasl/SaslClient.dispose:()V
     349: goto          401
     352: astore        5
     354: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     357: ldc           #63                 // String SaslClient dispose() failed
     359: aload         5
     361: invokeinterface #64,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     366: goto          401
     369: astore        10
     371: aload_3
     372: ifnull        398
     375: aload_3
     376: invokeinterface #62,  1           // InterfaceMethod javax/security/sasl/SaslClient.dispose:()V
     381: goto          398
     384: astore        11
     386: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     389: ldc           #63                 // String SaslClient dispose() failed
     391: aload         11
     393: invokeinterface #64,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     398: aload         10
     400: athrow
     401: return
    Exception table:
       from    to  target type
         343   349   352   Class javax/security/sasl/SaslException
          39   339   369   any
         375   381   384   Class javax/security/sasl/SaslException
         369   371   369   any

  private void checkAuthStatus(java.net.Socket, org.apache.zookeeper.server.quorum.auth.QuorumAuth$Status) throws javax.security.sasl.SaslException;
    Code:
       0: aload_2
       1: getstatic     #65                 // Field org/apache/zookeeper/server/quorum/auth/QuorumAuth$Status.SUCCESS:Lorg/apache/zookeeper/server/quorum/auth/QuorumAuth$Status;
       4: if_acmpne     25
       7: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
      10: ldc           #66                 // String Successfully completed the authentication using SASL. server addr: {}, status: {}
      12: aload_1
      13: invokevirtual #56                 // Method java/net/Socket.getRemoteSocketAddress:()Ljava/net/SocketAddress;
      16: aload_2
      17: invokeinterface #28,  4           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      22: goto          64
      25: new           #21                 // class javax/security/sasl/SaslException
      28: dup
      29: new           #52                 // class java/lang/StringBuilder
      32: dup
      33: invokespecial #53                 // Method java/lang/StringBuilder."<init>":()V
      36: ldc           #54                 // String Authentication failed against server addr:
      38: invokevirtual #55                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      41: aload_1
      42: invokevirtual #56                 // Method java/net/Socket.getRemoteSocketAddress:()Ljava/net/SocketAddress;
      45: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      48: ldc           #67                 // String , qpStatus:
      50: invokevirtual #55                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      53: aload_2
      54: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      57: invokevirtual #58                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      60: invokespecial #51                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      63: athrow
      64: return

  private org.apache.zookeeper.server.quorum.QuorumAuthPacket receive(java.io.DataInputStream) throws java.io.IOException;
    Code:
       0: new           #68                 // class org/apache/zookeeper/server/quorum/QuorumAuthPacket
       3: dup
       4: invokespecial #69                 // Method org/apache/zookeeper/server/quorum/QuorumAuthPacket."<init>":()V
       7: astore_2
       8: aload_1
       9: invokestatic  #70                 // Method org/apache/jute/BinaryInputArchive.getArchive:(Ljava/io/InputStream;)Lorg/apache/jute/BinaryInputArchive;
      12: astore_3
      13: aload_2
      14: aload_3
      15: ldc           #71                 // String qpconnect
      17: invokevirtual #72                 // Method org/apache/zookeeper/server/quorum/QuorumAuthPacket.deserialize:(Lorg/apache/jute/InputArchive;Ljava/lang/String;)V
      20: aload_2
      21: areturn

  private void send(java.io.DataOutputStream, byte[]) throws java.io.IOException;
    Code:
       0: new           #73                 // class java/io/BufferedOutputStream
       3: dup
       4: aload_1
       5: invokespecial #74                 // Method java/io/BufferedOutputStream."<init>":(Ljava/io/OutputStream;)V
       8: astore        4
      10: aload         4
      12: invokestatic  #75                 // Method org/apache/jute/BinaryOutputArchive.getArchive:(Ljava/io/OutputStream;)Lorg/apache/jute/BinaryOutputArchive;
      15: astore        5
      17: getstatic     #76                 // Field org/apache/zookeeper/server/quorum/auth/QuorumAuth$Status.IN_PROGRESS:Lorg/apache/zookeeper/server/quorum/auth/QuorumAuth$Status;
      20: aload_2
      21: invokestatic  #77                 // Method org/apache/zookeeper/server/quorum/auth/QuorumAuth.createPacket:(Lorg/apache/zookeeper/server/quorum/auth/QuorumAuth$Status;[B)Lorg/apache/zookeeper/server/quorum/QuorumAuthPacket;
      24: astore_3
      25: aload         5
      27: aload_3
      28: ldc           #71                 // String qpconnect
      30: invokevirtual #78                 // Method org/apache/jute/BinaryOutputArchive.writeRecord:(Lorg/apache/jute/Record;Ljava/lang/String;)V
      33: aload         4
      35: invokevirtual #79                 // Method java/io/BufferedOutputStream.flush:()V
      38: return

  private byte[] createSaslToken(byte[], javax.security.sasl.SaslClient, org.apache.zookeeper.Login) throws javax.security.sasl.SaslException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #21                 // class javax/security/sasl/SaslException
       7: dup
       8: ldc           #80                 // String Error in authenticating with a Zookeeper Quorum member: the quorum member\'s saslToken is null.
      10: invokespecial #51                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
      13: athrow
      14: aload_3
      15: invokevirtual #36                 // Method org/apache/zookeeper/Login.getSubject:()Ljavax/security/auth/Subject;
      18: ifnull        153
      21: aload_3
      22: dup
      23: astore        4
      25: monitorenter
      26: aload_3
      27: invokevirtual #36                 // Method org/apache/zookeeper/Login.getSubject:()Ljavax/security/auth/Subject;
      30: new           #81                 // class org/apache/zookeeper/server/quorum/auth/SaslQuorumAuthLearner$1
      33: dup
      34: aload_0
      35: aload_1
      36: aload_2
      37: invokespecial #82                 // Method org/apache/zookeeper/server/quorum/auth/SaslQuorumAuthLearner$1."<init>":(Lorg/apache/zookeeper/server/quorum/auth/SaslQuorumAuthLearner;[BLjavax/security/sasl/SaslClient;)V
      40: invokestatic  #83                 // Method javax/security/auth/Subject.doAs:(Ljavax/security/auth/Subject;Ljava/security/PrivilegedExceptionAction;)Ljava/lang/Object;
      43: checkcast     #84                 // class "[B"
      46: astore        5
      48: aload         5
      50: aload         4
      52: monitorexit
      53: areturn
      54: astore        5
      56: new           #52                 // class java/lang/StringBuilder
      59: dup
      60: invokespecial #53                 // Method java/lang/StringBuilder."<init>":()V
      63: ldc           #86                 // String An error: (
      65: invokevirtual #55                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      68: aload         5
      70: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      73: ldc           #87                 // String ) occurred when evaluating Zookeeper Quorum Member\'s received SASL token.
      75: invokevirtual #55                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      78: invokevirtual #58                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      81: astore        6
      83: ldc           #88                 // String (Mechanism level: Server not found in Kerberos database (7) - UNKNOWN_SERVER)
      85: astore        7
      87: aload         5
      89: invokevirtual #89                 // Method java/security/PrivilegedActionException.toString:()Ljava/lang/String;
      92: ldc           #88                 // String (Mechanism level: Server not found in Kerberos database (7) - UNKNOWN_SERVER)
      94: invokevirtual #90                 // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      97: iconst_m1
      98: if_icmple     123
     101: new           #52                 // class java/lang/StringBuilder
     104: dup
     105: invokespecial #53                 // Method java/lang/StringBuilder."<init>":()V
     108: aload         6
     110: invokevirtual #55                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     113: ldc           #91                 // String  This may be caused by Java\'s being unable to resolve the Zookeeper Quorum Member\'s hostname correctly. You may want to try to adding \'-Dsun.net.spi.nameservice.provider.1=dns,sun\' to your server\'s JVMFLAGS environment.
     115: invokevirtual #55                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     118: invokevirtual #58                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     121: astore        6
     123: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
     126: aload         6
     128: invokeinterface #92,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     133: new           #21                 // class javax/security/sasl/SaslException
     136: dup
     137: aload         6
     139: aload         5
     141: invokespecial #23                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     144: athrow
     145: astore        8
     147: aload         4
     149: monitorexit
     150: aload         8
     152: athrow
     153: new           #21                 // class javax/security/sasl/SaslException
     156: dup
     157: ldc           #93                 // String Cannot make SASL token without subject defined. For diagnosis, please look for WARNs and ERRORs in your log related to the Login class.
     159: invokespecial #51                 // Method javax/security/sasl/SaslException."<init>":(Ljava/lang/String;)V
     162: athrow
    Exception table:
       from    to  target type
          26    50    54   Class java/security/PrivilegedActionException
          26    53   145   any
          54   150   145   any

  static org.slf4j.Logger access$000();
    Code:
       0: getstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
       3: areturn

  static {};
    Code:
       0: ldc           #94                 // class org/apache/zookeeper/server/quorum/auth/SaslQuorumAuthLearner
       2: invokestatic  #95                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #1                  // Field LOG:Lorg/slf4j/Logger;
       8: return
}
