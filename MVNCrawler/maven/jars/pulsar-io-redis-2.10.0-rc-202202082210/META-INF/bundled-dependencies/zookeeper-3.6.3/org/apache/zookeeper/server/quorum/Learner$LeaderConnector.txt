Compiled from "Learner.java"
class org.apache.zookeeper.server.quorum.Learner$LeaderConnector implements java.lang.Runnable {
  private java.util.concurrent.atomic.AtomicReference<java.net.Socket> socket;

  private java.net.InetSocketAddress address;

  private java.util.concurrent.CountDownLatch latch;

  final org.apache.zookeeper.server.quorum.Learner this$0;

  org.apache.zookeeper.server.quorum.Learner$LeaderConnector(java.net.InetSocketAddress, java.util.concurrent.atomic.AtomicReference<java.net.Socket>, java.util.concurrent.CountDownLatch);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
       5: aload_0
       6: invokespecial #2                  // Method java/lang/Object."<init>":()V
       9: aload_0
      10: aload_2
      11: putfield      #3                  // Field address:Ljava/net/InetSocketAddress;
      14: aload_0
      15: aload_3
      16: putfield      #4                  // Field socket:Ljava/util/concurrent/atomic/AtomicReference;
      19: aload_0
      20: aload         4
      22: putfield      #5                  // Field latch:Ljava/util/concurrent/CountDownLatch;
      25: return

  public void run();
    Code:
       0: invokestatic  #6                  // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
       3: new           #7                  // class java/lang/StringBuilder
       6: dup
       7: invokespecial #8                  // Method java/lang/StringBuilder."<init>":()V
      10: ldc           #9                  // String LeaderConnector-
      12: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      15: aload_0
      16: getfield      #3                  // Field address:Ljava/net/InetSocketAddress;
      19: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      22: invokevirtual #12                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      25: invokevirtual #13                 // Method java/lang/Thread.setName:(Ljava/lang/String;)V
      28: aload_0
      29: invokespecial #14                 // Method connectToLeader:()Ljava/net/Socket;
      32: astore_1
      33: aload_1
      34: ifnull        87
      37: aload_1
      38: invokevirtual #15                 // Method java/net/Socket.isConnected:()Z
      41: ifeq          87
      44: aload_0
      45: getfield      #4                  // Field socket:Ljava/util/concurrent/atomic/AtomicReference;
      48: aconst_null
      49: aload_1
      50: invokevirtual #16                 // Method java/util/concurrent/atomic/AtomicReference.compareAndSet:(Ljava/lang/Object;Ljava/lang/Object;)Z
      53: ifeq          73
      56: getstatic     #17                 // Field org/apache/zookeeper/server/quorum/Learner.LOG:Lorg/slf4j/Logger;
      59: ldc           #18                 // String Successfully connected to leader, using address: {}
      61: aload_0
      62: getfield      #3                  // Field address:Ljava/net/InetSocketAddress;
      65: invokeinterface #19,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      70: goto          87
      73: getstatic     #17                 // Field org/apache/zookeeper/server/quorum/Learner.LOG:Lorg/slf4j/Logger;
      76: ldc           #20                 // String Connection to the leader is already established, close the redundant connection
      78: invokeinterface #21,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      83: aload_1
      84: invokevirtual #22                 // Method java/net/Socket.close:()V
      87: aload_0
      88: getfield      #5                  // Field latch:Ljava/util/concurrent/CountDownLatch;
      91: invokevirtual #23                 // Method java/util/concurrent/CountDownLatch.countDown:()V
      94: goto          133
      97: astore_1
      98: getstatic     #17                 // Field org/apache/zookeeper/server/quorum/Learner.LOG:Lorg/slf4j/Logger;
     101: ldc           #25                 // String Failed connect to {}
     103: aload_0
     104: getfield      #3                  // Field address:Ljava/net/InetSocketAddress;
     107: aload_1
     108: invokeinterface #26,  4           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     113: aload_0
     114: getfield      #5                  // Field latch:Ljava/util/concurrent/CountDownLatch;
     117: invokevirtual #23                 // Method java/util/concurrent/CountDownLatch.countDown:()V
     120: goto          133
     123: astore_2
     124: aload_0
     125: getfield      #5                  // Field latch:Ljava/util/concurrent/CountDownLatch;
     128: invokevirtual #23                 // Method java/util/concurrent/CountDownLatch.countDown:()V
     131: aload_2
     132: athrow
     133: return
    Exception table:
       from    to  target type
           0    87    97   Class java/lang/Exception
           0    87   123   any
          97   113   123   any

  private java.net.Socket connectToLeader() throws java.io.IOException, org.apache.zookeeper.common.X509Exception, java.lang.InterruptedException;
    Code:
       0: aload_0
       1: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
       4: invokevirtual #27                 // Method org/apache/zookeeper/server/quorum/Learner.createSocket:()Ljava/net/Socket;
       7: astore_1
       8: aload_0
       9: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
      12: getfield      #28                 // Field org/apache/zookeeper/server/quorum/Learner.self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      15: getfield      #29                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.tickTime:I
      18: aload_0
      19: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
      22: getfield      #28                 // Field org/apache/zookeeper/server/quorum/Learner.self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      25: getfield      #30                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.initLimit:I
      28: imul
      29: istore_2
      30: aload_0
      31: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
      34: getfield      #28                 // Field org/apache/zookeeper/server/quorum/Learner.self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      37: getfield      #31                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.connectToLearnerMasterLimit:I
      40: ifle          65
      43: aload_0
      44: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
      47: getfield      #28                 // Field org/apache/zookeeper/server/quorum/Learner.self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      50: getfield      #29                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.tickTime:I
      53: aload_0
      54: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
      57: getfield      #28                 // Field org/apache/zookeeper/server/quorum/Learner.self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      60: getfield      #31                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.connectToLearnerMasterLimit:I
      63: imul
      64: istore_2
      65: aload_0
      66: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
      69: invokevirtual #32                 // Method org/apache/zookeeper/server/quorum/Learner.nanoTime:()J
      72: lstore        4
      74: iconst_0
      75: istore        6
      77: iload         6
      79: iconst_5
      80: if_icmpge     365
      83: aload_0
      84: getfield      #4                  // Field socket:Ljava/util/concurrent/atomic/AtomicReference;
      87: invokevirtual #33                 // Method java/util/concurrent/atomic/AtomicReference.get:()Ljava/lang/Object;
      90: ifnonnull     365
      93: iload_2
      94: aload_0
      95: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
      98: invokevirtual #32                 // Method org/apache/zookeeper/server/quorum/Learner.nanoTime:()J
     101: lload         4
     103: lsub
     104: ldc2_w        #34                 // long 1000000l
     107: ldiv
     108: l2i
     109: isub
     110: istore_3
     111: iload_3
     112: ifgt          135
     115: getstatic     #17                 // Field org/apache/zookeeper/server/quorum/Learner.LOG:Lorg/slf4j/Logger;
     118: ldc           #36                 // String connectToLeader exceeded on retries.
     120: invokeinterface #37,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     125: new           #38                 // class java/io/IOException
     128: dup
     129: ldc           #36                 // String connectToLeader exceeded on retries.
     131: invokespecial #39                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     134: athrow
     135: aload_0
     136: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
     139: aload_1
     140: aload_0
     141: getfield      #3                  // Field address:Ljava/net/InetSocketAddress;
     144: iload_2
     145: iload_3
     146: invokestatic  #40                 // Method java/lang/Math.min:(II)I
     149: invokevirtual #41                 // Method org/apache/zookeeper/server/quorum/Learner.sockConnect:(Ljava/net/Socket;Ljava/net/InetSocketAddress;I)V
     152: aload_0
     153: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
     156: getfield      #28                 // Field org/apache/zookeeper/server/quorum/Learner.self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     159: invokevirtual #42                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.isSslQuorum:()Z
     162: ifeq          172
     165: aload_1
     166: checkcast     #43                 // class javax/net/ssl/SSLSocket
     169: invokevirtual #44                 // Method javax/net/ssl/SSLSocket.startHandshake:()V
     172: aload_1
     173: invokestatic  #45                 // Method org/apache/zookeeper/server/quorum/Learner.access$000:()Z
     176: invokevirtual #46                 // Method java/net/Socket.setTcpNoDelay:(Z)V
     179: goto          365
     182: astore        7
     184: iload_2
     185: aload_0
     186: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
     189: invokevirtual #32                 // Method org/apache/zookeeper/server/quorum/Learner.nanoTime:()J
     192: lload         4
     194: lsub
     195: ldc2_w        #34                 // long 1000000l
     198: ldiv
     199: l2i
     200: isub
     201: istore_3
     202: iload_3
     203: invokestatic  #47                 // Method org/apache/zookeeper/server/quorum/Learner.access$100:()I
     206: if_icmpgt     253
     209: getstatic     #17                 // Field org/apache/zookeeper/server/quorum/Learner.LOG:Lorg/slf4j/Logger;
     212: ldc           #48                 // String Unexpected exception, connectToLeader exceeded. tries={}, remaining init limit={}, connecting to {}
     214: iconst_4
     215: anewarray     #49                 // class java/lang/Object
     218: dup
     219: iconst_0
     220: iload         6
     222: invokestatic  #50                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     225: aastore
     226: dup
     227: iconst_1
     228: iload_3
     229: invokestatic  #50                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     232: aastore
     233: dup
     234: iconst_2
     235: aload_0
     236: getfield      #3                  // Field address:Ljava/net/InetSocketAddress;
     239: aastore
     240: dup
     241: iconst_3
     242: aload         7
     244: aastore
     245: invokeinterface #51,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;[Ljava/lang/Object;)V
     250: aload         7
     252: athrow
     253: iload         6
     255: iconst_4
     256: if_icmplt     303
     259: getstatic     #17                 // Field org/apache/zookeeper/server/quorum/Learner.LOG:Lorg/slf4j/Logger;
     262: ldc           #52                 // String Unexpected exception, retries exceeded. tries={}, remaining init limit={}, connecting to {}
     264: iconst_4
     265: anewarray     #49                 // class java/lang/Object
     268: dup
     269: iconst_0
     270: iload         6
     272: invokestatic  #50                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     275: aastore
     276: dup
     277: iconst_1
     278: iload_3
     279: invokestatic  #50                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     282: aastore
     283: dup
     284: iconst_2
     285: aload_0
     286: getfield      #3                  // Field address:Ljava/net/InetSocketAddress;
     289: aastore
     290: dup
     291: iconst_3
     292: aload         7
     294: aastore
     295: invokeinterface #51,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;[Ljava/lang/Object;)V
     300: aload         7
     302: athrow
     303: getstatic     #17                 // Field org/apache/zookeeper/server/quorum/Learner.LOG:Lorg/slf4j/Logger;
     306: ldc           #53                 // String Unexpected exception, tries={}, remaining init limit={}, connecting to {}
     308: iconst_4
     309: anewarray     #49                 // class java/lang/Object
     312: dup
     313: iconst_0
     314: iload         6
     316: invokestatic  #50                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     319: aastore
     320: dup
     321: iconst_1
     322: iload_3
     323: invokestatic  #50                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     326: aastore
     327: dup
     328: iconst_2
     329: aload_0
     330: getfield      #3                  // Field address:Ljava/net/InetSocketAddress;
     333: aastore
     334: dup
     335: iconst_3
     336: aload         7
     338: aastore
     339: invokeinterface #54,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;[Ljava/lang/Object;)V
     344: aload_0
     345: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/quorum/Learner;
     348: invokevirtual #27                 // Method org/apache/zookeeper/server/quorum/Learner.createSocket:()Ljava/net/Socket;
     351: astore_1
     352: invokestatic  #47                 // Method org/apache/zookeeper/server/quorum/Learner.access$100:()I
     355: i2l
     356: invokestatic  #55                 // Method java/lang/Thread.sleep:(J)V
     359: iinc          6, 1
     362: goto          77
     365: aload_1
     366: areturn
    Exception table:
       from    to  target type
          93   179   182   Class java/io/IOException
}
