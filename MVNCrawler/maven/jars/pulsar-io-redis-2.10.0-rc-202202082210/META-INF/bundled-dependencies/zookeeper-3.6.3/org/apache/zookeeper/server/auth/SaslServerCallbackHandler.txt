Compiled from "SaslServerCallbackHandler.java"
public class org.apache.zookeeper.server.auth.SaslServerCallbackHandler implements javax.security.auth.callback.CallbackHandler {
  private static final java.lang.String USER_PREFIX;

  private static final org.slf4j.Logger LOG;

  private static final java.lang.String SYSPROP_SUPER_PASSWORD;

  private static final java.lang.String SYSPROP_REMOVE_HOST;

  private static final java.lang.String SYSPROP_REMOVE_REALM;

  private java.lang.String userName;

  private final java.util.Map<java.lang.String, java.lang.String> credentials;

  public org.apache.zookeeper.server.auth.SaslServerCallbackHandler(javax.security.auth.login.Configuration) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/HashMap
       8: dup
       9: invokespecial #3                  // Method java/util/HashMap."<init>":()V
      12: putfield      #4                  // Field credentials:Ljava/util/Map;
      15: ldc           #6                  // String zookeeper.sasl.serverconfig
      17: ldc           #7                  // String Server
      19: invokestatic  #8                  // Method java/lang/System.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      22: astore_2
      23: aload_1
      24: aload_2
      25: invokevirtual #9                  // Method javax/security/auth/login/Configuration.getAppConfigurationEntry:(Ljava/lang/String;)[Ljavax/security/auth/login/AppConfigurationEntry;
      28: astore_3
      29: aload_3
      30: ifnonnull     79
      33: new           #10                 // class java/lang/StringBuilder
      36: dup
      37: invokespecial #11                 // Method java/lang/StringBuilder."<init>":()V
      40: ldc           #12                 // String Could not find a \'
      42: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      45: aload_2
      46: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      49: ldc           #14                 // String \' entry in this configuration: Server cannot start.
      51: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      54: invokevirtual #15                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      57: astore        4
      59: getstatic     #16                 // Field LOG:Lorg/slf4j/Logger;
      62: aload         4
      64: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      69: new           #18                 // class java/io/IOException
      72: dup
      73: aload         4
      75: invokespecial #19                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      78: athrow
      79: aload_0
      80: getfield      #4                  // Field credentials:Ljava/util/Map;
      83: invokeinterface #20,  1           // InterfaceMethod java/util/Map.clear:()V
      88: aload_3
      89: astore        4
      91: aload         4
      93: arraylength
      94: istore        5
      96: iconst_0
      97: istore        6
      99: iload         6
     101: iload         5
     103: if_icmpge     221
     106: aload         4
     108: iload         6
     110: aaload
     111: astore        7
     113: aload         7
     115: invokevirtual #21                 // Method javax/security/auth/login/AppConfigurationEntry.getOptions:()Ljava/util/Map;
     118: astore        8
     120: aload         8
     122: invokeinterface #22,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
     127: invokeinterface #23,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     132: astore        9
     134: aload         9
     136: invokeinterface #24,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     141: ifeq          215
     144: aload         9
     146: invokeinterface #25,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     151: checkcast     #26                 // class java/util/Map$Entry
     154: astore        10
     156: aload         10
     158: invokeinterface #27,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
     163: checkcast     #28                 // class java/lang/String
     166: astore        11
     168: aload         11
     170: ldc           #30                 // String user_
     172: invokevirtual #31                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     175: ifeq          212
     178: aload         11
     180: ldc           #30                 // String user_
     182: invokevirtual #32                 // Method java/lang/String.length:()I
     185: invokevirtual #33                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     188: astore        12
     190: aload_0
     191: getfield      #4                  // Field credentials:Ljava/util/Map;
     194: aload         12
     196: aload         10
     198: invokeinterface #34,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     203: checkcast     #28                 // class java/lang/String
     206: invokeinterface #35,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     211: pop
     212: goto          134
     215: iinc          6, 1
     218: goto          99
     221: return

  public void handle(javax.security.auth.callback.Callback[]) throws javax.security.auth.callback.UnsupportedCallbackException;
    Code:
       0: aload_1
       1: astore_2
       2: aload_2
       3: arraylength
       4: istore_3
       5: iconst_0
       6: istore        4
       8: iload         4
      10: iload_3
      11: if_icmpge     103
      14: aload_2
      15: iload         4
      17: aaload
      18: astore        5
      20: aload         5
      22: instanceof    #36                 // class javax/security/auth/callback/NameCallback
      25: ifeq          40
      28: aload_0
      29: aload         5
      31: checkcast     #36                 // class javax/security/auth/callback/NameCallback
      34: invokespecial #37                 // Method handleNameCallback:(Ljavax/security/auth/callback/NameCallback;)V
      37: goto          97
      40: aload         5
      42: instanceof    #38                 // class javax/security/auth/callback/PasswordCallback
      45: ifeq          60
      48: aload_0
      49: aload         5
      51: checkcast     #38                 // class javax/security/auth/callback/PasswordCallback
      54: invokespecial #39                 // Method handlePasswordCallback:(Ljavax/security/auth/callback/PasswordCallback;)V
      57: goto          97
      60: aload         5
      62: instanceof    #40                 // class javax/security/sasl/RealmCallback
      65: ifeq          80
      68: aload_0
      69: aload         5
      71: checkcast     #40                 // class javax/security/sasl/RealmCallback
      74: invokespecial #41                 // Method handleRealmCallback:(Ljavax/security/sasl/RealmCallback;)V
      77: goto          97
      80: aload         5
      82: instanceof    #42                 // class javax/security/sasl/AuthorizeCallback
      85: ifeq          97
      88: aload_0
      89: aload         5
      91: checkcast     #42                 // class javax/security/sasl/AuthorizeCallback
      94: invokespecial #43                 // Method handleAuthorizeCallback:(Ljavax/security/sasl/AuthorizeCallback;)V
      97: iinc          4, 1
     100: goto          8
     103: return

  private void handleNameCallback(javax.security.auth.callback.NameCallback);
    Code:
       0: aload_0
       1: getfield      #4                  // Field credentials:Ljava/util/Map;
       4: aload_1
       5: invokevirtual #44                 // Method javax/security/auth/callback/NameCallback.getDefaultName:()Ljava/lang/String;
       8: invokeinterface #45,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      13: ifnonnull     31
      16: getstatic     #16                 // Field LOG:Lorg/slf4j/Logger;
      19: ldc           #46                 // String User \'{}\' not found in list of DIGEST-MD5 authenticateable users.
      21: aload_1
      22: invokevirtual #44                 // Method javax/security/auth/callback/NameCallback.getDefaultName:()Ljava/lang/String;
      25: invokeinterface #47,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
      30: return
      31: aload_1
      32: aload_1
      33: invokevirtual #44                 // Method javax/security/auth/callback/NameCallback.getDefaultName:()Ljava/lang/String;
      36: invokevirtual #48                 // Method javax/security/auth/callback/NameCallback.setName:(Ljava/lang/String;)V
      39: aload_0
      40: aload_1
      41: invokevirtual #44                 // Method javax/security/auth/callback/NameCallback.getDefaultName:()Ljava/lang/String;
      44: putfield      #49                 // Field userName:Ljava/lang/String;
      47: return

  private void handlePasswordCallback(javax.security.auth.callback.PasswordCallback);
    Code:
       0: ldc           #50                 // String super
       2: aload_0
       3: getfield      #49                 // Field userName:Ljava/lang/String;
       6: invokevirtual #51                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       9: ifeq          35
      12: ldc           #52                 // String zookeeper.SASLAuthenticationProvider.superPassword
      14: invokestatic  #53                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      17: ifnull        35
      20: aload_1
      21: ldc           #52                 // String zookeeper.SASLAuthenticationProvider.superPassword
      23: invokestatic  #53                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      26: invokevirtual #54                 // Method java/lang/String.toCharArray:()[C
      29: invokevirtual #55                 // Method javax/security/auth/callback/PasswordCallback.setPassword:([C)V
      32: goto          91
      35: aload_0
      36: getfield      #4                  // Field credentials:Ljava/util/Map;
      39: aload_0
      40: getfield      #49                 // Field userName:Ljava/lang/String;
      43: invokeinterface #56,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
      48: ifeq          77
      51: aload_1
      52: aload_0
      53: getfield      #4                  // Field credentials:Ljava/util/Map;
      56: aload_0
      57: getfield      #49                 // Field userName:Ljava/lang/String;
      60: invokeinterface #45,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      65: checkcast     #28                 // class java/lang/String
      68: invokevirtual #54                 // Method java/lang/String.toCharArray:()[C
      71: invokevirtual #55                 // Method javax/security/auth/callback/PasswordCallback.setPassword:([C)V
      74: goto          91
      77: getstatic     #16                 // Field LOG:Lorg/slf4j/Logger;
      80: ldc           #57                 // String No password found for user: {}
      82: aload_0
      83: getfield      #49                 // Field userName:Ljava/lang/String;
      86: invokeinterface #47,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
      91: return

  private void handleRealmCallback(javax.security.sasl.RealmCallback);
    Code:
       0: getstatic     #16                 // Field LOG:Lorg/slf4j/Logger;
       3: ldc           #58                 // String client supplied realm: {}
       5: aload_1
       6: invokevirtual #59                 // Method javax/security/sasl/RealmCallback.getDefaultText:()Ljava/lang/String;
       9: invokeinterface #60,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      14: aload_1
      15: aload_1
      16: invokevirtual #59                 // Method javax/security/sasl/RealmCallback.getDefaultText:()Ljava/lang/String;
      19: invokevirtual #61                 // Method javax/security/sasl/RealmCallback.setText:(Ljava/lang/String;)V
      22: return

  private void handleAuthorizeCallback(javax.security.sasl.AuthorizeCallback);
    Code:
       0: aload_1
       1: invokevirtual #62                 // Method javax/security/sasl/AuthorizeCallback.getAuthenticationID:()Ljava/lang/String;
       4: astore_2
       5: aload_1
       6: invokevirtual #63                 // Method javax/security/sasl/AuthorizeCallback.getAuthorizationID:()Ljava/lang/String;
       9: astore_3
      10: getstatic     #16                 // Field LOG:Lorg/slf4j/Logger;
      13: ldc           #64                 // String Successfully authenticated client: authenticationID={};  authorizationID={}.
      15: aload_2
      16: aload_3
      17: invokeinterface #65,  4           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      22: aload_1
      23: iconst_1
      24: invokevirtual #66                 // Method javax/security/sasl/AuthorizeCallback.setAuthorized:(Z)V
      27: new           #67                 // class org/apache/zookeeper/server/auth/KerberosName
      30: dup
      31: aload_2
      32: invokespecial #68                 // Method org/apache/zookeeper/server/auth/KerberosName."<init>":(Ljava/lang/String;)V
      35: astore        4
      37: new           #10                 // class java/lang/StringBuilder
      40: dup
      41: aload         4
      43: invokevirtual #69                 // Method org/apache/zookeeper/server/auth/KerberosName.getShortName:()Ljava/lang/String;
      46: invokespecial #70                 // Method java/lang/StringBuilder."<init>":(Ljava/lang/String;)V
      49: astore        5
      51: aload_0
      52: aload         4
      54: invokespecial #71                 // Method shouldAppendHost:(Lorg/apache/zookeeper/server/auth/KerberosName;)Z
      57: ifeq          76
      60: aload         5
      62: ldc           #72                 // String /
      64: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      67: aload         4
      69: invokevirtual #73                 // Method org/apache/zookeeper/server/auth/KerberosName.getHostName:()Ljava/lang/String;
      72: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      75: pop
      76: aload_0
      77: aload         4
      79: invokespecial #74                 // Method shouldAppendRealm:(Lorg/apache/zookeeper/server/auth/KerberosName;)Z
      82: ifeq          101
      85: aload         5
      87: ldc           #75                 // String @
      89: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      92: aload         4
      94: invokevirtual #76                 // Method org/apache/zookeeper/server/auth/KerberosName.getRealm:()Ljava/lang/String;
      97: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     100: pop
     101: getstatic     #16                 // Field LOG:Lorg/slf4j/Logger;
     104: ldc           #77                 // String Setting authorizedID: {}
     106: aload         5
     108: invokeinterface #78,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     113: aload_1
     114: aload         5
     116: invokevirtual #15                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     119: invokevirtual #79                 // Method javax/security/sasl/AuthorizeCallback.setAuthorizedID:(Ljava/lang/String;)V
     122: goto          139
     125: astore        5
     127: getstatic     #16                 // Field LOG:Lorg/slf4j/Logger;
     130: ldc           #80                 // String Failed to set name based on Kerberos authentication rules.
     132: aload         5
     134: invokeinterface #81,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     139: return
    Exception table:
       from    to  target type
          37   122   125   Class java/io/IOException

  private boolean shouldAppendRealm(org.apache.zookeeper.server.auth.KerberosName);
    Code:
       0: aload_0
       1: ldc           #82                 // String zookeeper.kerberos.removeRealmFromPrincipal
       3: invokespecial #83                 // Method isSystemPropertyTrue:(Ljava/lang/String;)Z
       6: ifne          20
       9: aload_1
      10: invokevirtual #76                 // Method org/apache/zookeeper/server/auth/KerberosName.getRealm:()Ljava/lang/String;
      13: ifnull        20
      16: iconst_1
      17: goto          21
      20: iconst_0
      21: ireturn

  private boolean shouldAppendHost(org.apache.zookeeper.server.auth.KerberosName);
    Code:
       0: aload_0
       1: ldc           #84                 // String zookeeper.kerberos.removeHostFromPrincipal
       3: invokespecial #83                 // Method isSystemPropertyTrue:(Ljava/lang/String;)Z
       6: ifne          20
       9: aload_1
      10: invokevirtual #73                 // Method org/apache/zookeeper/server/auth/KerberosName.getHostName:()Ljava/lang/String;
      13: ifnull        20
      16: iconst_1
      17: goto          21
      20: iconst_0
      21: ireturn

  private boolean isSystemPropertyTrue(java.lang.String);
    Code:
       0: ldc           #85                 // String true
       2: aload_1
       3: invokestatic  #53                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       6: invokevirtual #51                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       9: ireturn

  static {};
    Code:
       0: ldc           #29                 // class org/apache/zookeeper/server/auth/SaslServerCallbackHandler
       2: invokestatic  #86                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #16                 // Field LOG:Lorg/slf4j/Logger;
       8: return
}
