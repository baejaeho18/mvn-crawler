Compiled from "NettyServerCnxnFactory.java"
final class org.apache.zookeeper.server.NettyServerCnxnFactory$CertificateVerifier implements io.netty.util.concurrent.GenericFutureListener<io.netty.util.concurrent.Future<io.netty.channel.Channel>> {
  private final io.netty.handler.ssl.SslHandler sslHandler;

  private final org.apache.zookeeper.server.NettyServerCnxn cnxn;

  final org.apache.zookeeper.server.NettyServerCnxnFactory this$0;

  org.apache.zookeeper.server.NettyServerCnxnFactory$CertificateVerifier(org.apache.zookeeper.server.NettyServerCnxnFactory, io.netty.handler.ssl.SslHandler, org.apache.zookeeper.server.NettyServerCnxn);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/NettyServerCnxnFactory;
       5: aload_0
       6: invokespecial #2                  // Method java/lang/Object."<init>":()V
       9: aload_0
      10: aload_2
      11: putfield      #3                  // Field sslHandler:Lio/netty/handler/ssl/SslHandler;
      14: aload_0
      15: aload_3
      16: putfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
      19: return

  public void operationComplete(io.netty.util.concurrent.Future<io.netty.channel.Channel>);
    Code:
       0: aload_0
       1: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/NettyServerCnxnFactory;
       4: aload_0
       5: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
       8: invokestatic  #5                  // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$200:(Lorg/apache/zookeeper/server/NettyServerCnxnFactory;Lorg/apache/zookeeper/server/NettyServerCnxn;)V
      11: aload_1
      12: invokeinterface #6,  1            // InterfaceMethod io/netty/util/concurrent/Future.isSuccess:()Z
      17: ifeq          335
      20: invokestatic  #7                  // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$000:()Lorg/slf4j/Logger;
      23: ldc           #8                  // String Successful handshake with session 0x{}
      25: aload_0
      26: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
      29: invokevirtual #9                  // Method org/apache/zookeeper/server/NettyServerCnxn.getSessionId:()J
      32: invokestatic  #10                 // Method java/lang/Long.toHexString:(J)Ljava/lang/String;
      35: invokeinterface #11,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      40: aload_0
      41: getfield      #3                  // Field sslHandler:Lio/netty/handler/ssl/SslHandler;
      44: invokevirtual #12                 // Method io/netty/handler/ssl/SslHandler.engine:()Ljavax/net/ssl/SSLEngine;
      47: astore_2
      48: aload_2
      49: invokevirtual #13                 // Method javax/net/ssl/SSLEngine.getNeedClientAuth:()Z
      52: ifne          62
      55: aload_2
      56: invokevirtual #14                 // Method javax/net/ssl/SSLEngine.getWantClientAuth:()Z
      59: ifeq          294
      62: aload_2
      63: invokevirtual #15                 // Method javax/net/ssl/SSLEngine.getSession:()Ljavax/net/ssl/SSLSession;
      66: astore_3
      67: aload_0
      68: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
      71: aload_3
      72: invokeinterface #16,  1           // InterfaceMethod javax/net/ssl/SSLSession.getPeerCertificates:()[Ljava/security/cert/Certificate;
      77: invokevirtual #17                 // Method org/apache/zookeeper/server/NettyServerCnxn.setClientCertificateChain:([Ljava/security/cert/Certificate;)V
      80: goto          175
      83: astore        4
      85: aload_2
      86: invokevirtual #13                 // Method javax/net/ssl/SSLEngine.getNeedClientAuth:()Z
      89: ifeq          112
      92: invokestatic  #7                  // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$000:()Lorg/slf4j/Logger;
      95: ldc           #19                 // String Error getting peer certificates
      97: aload         4
      99: invokeinterface #20,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     104: aload_0
     105: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
     108: invokevirtual #21                 // Method org/apache/zookeeper/server/NettyServerCnxn.close:()V
     111: return
     112: aload_1
     113: invokeinterface #22,  1           // InterfaceMethod io/netty/util/concurrent/Future.getNow:()Ljava/lang/Object;
     118: checkcast     #23                 // class io/netty/channel/Channel
     121: astore        5
     123: aload_0
     124: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/NettyServerCnxnFactory;
     127: invokestatic  #24                 // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$300:(Lorg/apache/zookeeper/server/NettyServerCnxnFactory;)Lio/netty/channel/group/ChannelGroup;
     130: aload         5
     132: invokestatic  #25                 // Method java/util/Objects.requireNonNull:(Ljava/lang/Object;)Ljava/lang/Object;
     135: invokeinterface #26,  2           // InterfaceMethod io/netty/channel/group/ChannelGroup.add:(Ljava/lang/Object;)Z
     140: pop
     141: aload_0
     142: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/NettyServerCnxnFactory;
     145: aload_0
     146: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
     149: invokestatic  #27                 // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$400:(Lorg/apache/zookeeper/server/NettyServerCnxnFactory;Lorg/apache/zookeeper/server/NettyServerCnxn;)V
     152: return
     153: astore        4
     155: invokestatic  #7                  // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$000:()Lorg/slf4j/Logger;
     158: ldc           #19                 // String Error getting peer certificates
     160: aload         4
     162: invokeinterface #20,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     167: aload_0
     168: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
     171: invokevirtual #21                 // Method org/apache/zookeeper/server/NettyServerCnxn.close:()V
     174: return
     175: aload_0
     176: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/NettyServerCnxnFactory;
     179: invokestatic  #29                 // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$1200:(Lorg/apache/zookeeper/server/NettyServerCnxnFactory;)Lorg/apache/zookeeper/common/ClientX509Util;
     182: invokevirtual #30                 // Method org/apache/zookeeper/common/ClientX509Util.getSslAuthProviderProperty:()Ljava/lang/String;
     185: ldc           #31                 // String x509
     187: invokestatic  #32                 // Method java/lang/System.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     190: astore        4
     192: aload         4
     194: invokestatic  #33                 // Method org/apache/zookeeper/server/auth/ProviderRegistry.getProvider:(Ljava/lang/String;)Lorg/apache/zookeeper/server/auth/AuthenticationProvider;
     197: checkcast     #34                 // class org/apache/zookeeper/server/auth/X509AuthenticationProvider
     200: astore        5
     202: aload         5
     204: ifnonnull     230
     207: invokestatic  #7                  // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$000:()Lorg/slf4j/Logger;
     210: ldc           #35                 // String X509 Auth provider not found: {}
     212: aload         4
     214: invokeinterface #36,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;)V
     219: aload_0
     220: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
     223: getstatic     #37                 // Field org/apache/zookeeper/server/ServerCnxn$DisconnectReason.AUTH_PROVIDER_NOT_FOUND:Lorg/apache/zookeeper/server/ServerCnxn$DisconnectReason;
     226: invokevirtual #38                 // Method org/apache/zookeeper/server/NettyServerCnxn.close:(Lorg/apache/zookeeper/server/ServerCnxn$DisconnectReason;)V
     229: return
     230: aload         5
     232: aload_0
     233: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
     236: aconst_null
     237: invokevirtual #39                 // Method org/apache/zookeeper/server/auth/X509AuthenticationProvider.handleAuthentication:(Lorg/apache/zookeeper/server/ServerCnxn;[B)Lorg/apache/zookeeper/KeeperException$Code;
     240: astore        6
     242: getstatic     #40                 // Field org/apache/zookeeper/KeeperException$Code.OK:Lorg/apache/zookeeper/KeeperException$Code;
     245: aload         6
     247: if_acmpeq     294
     250: aload_0
     251: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/NettyServerCnxnFactory;
     254: getfield      #41                 // Field org/apache/zookeeper/server/NettyServerCnxnFactory.zkServer:Lorg/apache/zookeeper/server/ZooKeeperServer;
     257: invokevirtual #42                 // Method org/apache/zookeeper/server/ZooKeeperServer.serverStats:()Lorg/apache/zookeeper/server/ServerStats;
     260: invokevirtual #43                 // Method org/apache/zookeeper/server/ServerStats.incrementAuthFailedCount:()V
     263: invokestatic  #7                  // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$000:()Lorg/slf4j/Logger;
     266: ldc           #44                 // String Authentication failed for session 0x{}
     268: aload_0
     269: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
     272: invokevirtual #9                  // Method org/apache/zookeeper/server/NettyServerCnxn.getSessionId:()J
     275: invokestatic  #10                 // Method java/lang/Long.toHexString:(J)Ljava/lang/String;
     278: invokeinterface #36,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;)V
     283: aload_0
     284: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
     287: getstatic     #45                 // Field org/apache/zookeeper/server/ServerCnxn$DisconnectReason.SASL_AUTH_FAILURE:Lorg/apache/zookeeper/server/ServerCnxn$DisconnectReason;
     290: invokevirtual #38                 // Method org/apache/zookeeper/server/NettyServerCnxn.close:(Lorg/apache/zookeeper/server/ServerCnxn$DisconnectReason;)V
     293: return
     294: aload_1
     295: invokeinterface #22,  1           // InterfaceMethod io/netty/util/concurrent/Future.getNow:()Ljava/lang/Object;
     300: checkcast     #23                 // class io/netty/channel/Channel
     303: astore_3
     304: aload_0
     305: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/NettyServerCnxnFactory;
     308: invokestatic  #24                 // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$300:(Lorg/apache/zookeeper/server/NettyServerCnxnFactory;)Lio/netty/channel/group/ChannelGroup;
     311: aload_3
     312: invokestatic  #25                 // Method java/util/Objects.requireNonNull:(Ljava/lang/Object;)Ljava/lang/Object;
     315: invokeinterface #26,  2           // InterfaceMethod io/netty/channel/group/ChannelGroup.add:(Ljava/lang/Object;)Z
     320: pop
     321: aload_0
     322: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/NettyServerCnxnFactory;
     325: aload_0
     326: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
     329: invokestatic  #27                 // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$400:(Lorg/apache/zookeeper/server/NettyServerCnxnFactory;Lorg/apache/zookeeper/server/NettyServerCnxn;)V
     332: goto          378
     335: aload_0
     336: getfield      #1                  // Field this$0:Lorg/apache/zookeeper/server/NettyServerCnxnFactory;
     339: getfield      #41                 // Field org/apache/zookeeper/server/NettyServerCnxnFactory.zkServer:Lorg/apache/zookeeper/server/ZooKeeperServer;
     342: invokevirtual #42                 // Method org/apache/zookeeper/server/ZooKeeperServer.serverStats:()Lorg/apache/zookeeper/server/ServerStats;
     345: invokevirtual #43                 // Method org/apache/zookeeper/server/ServerStats.incrementAuthFailedCount:()V
     348: invokestatic  #7                  // Method org/apache/zookeeper/server/NettyServerCnxnFactory.access$000:()Lorg/slf4j/Logger;
     351: ldc           #46                 // String Unsuccessful handshake with session 0x{}
     353: aload_0
     354: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
     357: invokevirtual #9                  // Method org/apache/zookeeper/server/NettyServerCnxn.getSessionId:()J
     360: invokestatic  #10                 // Method java/lang/Long.toHexString:(J)Ljava/lang/String;
     363: invokeinterface #36,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;)V
     368: aload_0
     369: getfield      #4                  // Field cnxn:Lorg/apache/zookeeper/server/NettyServerCnxn;
     372: getstatic     #47                 // Field org/apache/zookeeper/server/ServerCnxn$DisconnectReason.FAILED_HANDSHAKE:Lorg/apache/zookeeper/server/ServerCnxn$DisconnectReason;
     375: invokevirtual #38                 // Method org/apache/zookeeper/server/NettyServerCnxn.close:(Lorg/apache/zookeeper/server/ServerCnxn$DisconnectReason;)V
     378: return
    Exception table:
       from    to  target type
          67    80    83   Class javax/net/ssl/SSLPeerUnverifiedException
          67    80   153   Class java/lang/Exception
}
