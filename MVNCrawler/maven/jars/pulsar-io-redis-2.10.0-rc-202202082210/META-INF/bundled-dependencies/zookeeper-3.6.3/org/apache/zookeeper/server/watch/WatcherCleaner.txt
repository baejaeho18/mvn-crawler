Compiled from "WatcherCleaner.java"
public class org.apache.zookeeper.server.watch.WatcherCleaner extends java.lang.Thread {
  private static final org.slf4j.Logger LOG;

  private final org.apache.zookeeper.server.RateLogger RATE_LOGGER;

  private volatile boolean stopped;

  private final java.lang.Object cleanEvent;

  private final java.lang.Object processingCompletedEvent;

  private final org.apache.zookeeper.server.WorkerService cleaners;

  private final java.util.Set<java.lang.Integer> deadWatchers;

  private final org.apache.zookeeper.server.watch.IDeadWatcherListener listener;

  private final int watcherCleanThreshold;

  private final int watcherCleanIntervalInSeconds;

  private final int maxInProcessingDeadWatchers;

  private final java.util.concurrent.atomic.AtomicInteger totalDeadWatchers;

  public org.apache.zookeeper.server.watch.WatcherCleaner(org.apache.zookeeper.server.watch.IDeadWatcherListener);
    Code:
       0: aload_0
       1: aload_1
       2: ldc           #5                  // String zookeeper.watcherCleanThreshold
       4: sipush        1000
       7: invokestatic  #6                  // Method java/lang/Integer.getInteger:(Ljava/lang/String;I)Ljava/lang/Integer;
      10: invokevirtual #7                  // Method java/lang/Integer.intValue:()I
      13: ldc           #8                  // String zookeeper.watcherCleanIntervalInSeconds
      15: sipush        600
      18: invokestatic  #6                  // Method java/lang/Integer.getInteger:(Ljava/lang/String;I)Ljava/lang/Integer;
      21: invokevirtual #7                  // Method java/lang/Integer.intValue:()I
      24: ldc           #9                  // String zookeeper.watcherCleanThreadsNum
      26: iconst_2
      27: invokestatic  #6                  // Method java/lang/Integer.getInteger:(Ljava/lang/String;I)Ljava/lang/Integer;
      30: invokevirtual #7                  // Method java/lang/Integer.intValue:()I
      33: ldc           #10                 // String zookeeper.maxInProcessingDeadWatchers
      35: iconst_m1
      36: invokestatic  #6                  // Method java/lang/Integer.getInteger:(Ljava/lang/String;I)Ljava/lang/Integer;
      39: invokevirtual #7                  // Method java/lang/Integer.intValue:()I
      42: invokespecial #11                 // Method "<init>":(Lorg/apache/zookeeper/server/watch/IDeadWatcherListener;IIII)V
      45: return

  public org.apache.zookeeper.server.watch.WatcherCleaner(org.apache.zookeeper.server.watch.IDeadWatcherListener, int, int, int, int);
    Code:
       0: aload_0
       1: invokespecial #12                 // Method java/lang/Thread."<init>":()V
       4: aload_0
       5: new           #13                 // class org/apache/zookeeper/server/RateLogger
       8: dup
       9: getstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
      12: invokespecial #14                 // Method org/apache/zookeeper/server/RateLogger."<init>":(Lorg/slf4j/Logger;)V
      15: putfield      #15                 // Field RATE_LOGGER:Lorg/apache/zookeeper/server/RateLogger;
      18: aload_0
      19: iconst_0
      20: putfield      #16                 // Field stopped:Z
      23: aload_0
      24: new           #17                 // class java/lang/Object
      27: dup
      28: invokespecial #18                 // Method java/lang/Object."<init>":()V
      31: putfield      #19                 // Field cleanEvent:Ljava/lang/Object;
      34: aload_0
      35: new           #17                 // class java/lang/Object
      38: dup
      39: invokespecial #18                 // Method java/lang/Object."<init>":()V
      42: putfield      #1                  // Field processingCompletedEvent:Ljava/lang/Object;
      45: aload_0
      46: new           #20                 // class java/util/concurrent/atomic/AtomicInteger
      49: dup
      50: invokespecial #21                 // Method java/util/concurrent/atomic/AtomicInteger."<init>":()V
      53: putfield      #2                  // Field totalDeadWatchers:Ljava/util/concurrent/atomic/AtomicInteger;
      56: aload_0
      57: aload_1
      58: putfield      #4                  // Field listener:Lorg/apache/zookeeper/server/watch/IDeadWatcherListener;
      61: aload_0
      62: iload_2
      63: putfield      #22                 // Field watcherCleanThreshold:I
      66: aload_0
      67: iload_3
      68: putfield      #23                 // Field watcherCleanIntervalInSeconds:I
      71: iload_2
      72: iload         4
      74: imul
      75: istore        6
      77: iload         5
      79: ifle          108
      82: iload         5
      84: iload         6
      86: if_icmpge     108
      89: iload         6
      91: istore        5
      93: getstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
      96: ldc           #24                 // String The maxInProcessingDeadWatchers config is smaller than the suggested one, change it to use {}
      98: iload         5
     100: invokestatic  #25                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     103: invokeinterface #26,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     108: aload_0
     109: iload         5
     111: putfield      #27                 // Field maxInProcessingDeadWatchers:I
     114: aload_0
     115: new           #28                 // class java/util/HashSet
     118: dup
     119: invokespecial #29                 // Method java/util/HashSet."<init>":()V
     122: putfield      #30                 // Field deadWatchers:Ljava/util/Set;
     125: aload_0
     126: new           #31                 // class org/apache/zookeeper/server/WorkerService
     129: dup
     130: ldc           #32                 // String DeadWatcherCleanner
     132: iload         4
     134: iconst_0
     135: invokespecial #33                 // Method org/apache/zookeeper/server/WorkerService."<init>":(Ljava/lang/String;IZ)V
     138: putfield      #34                 // Field cleaners:Lorg/apache/zookeeper/server/WorkerService;
     141: getstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
     144: ldc           #35                 // String watcherCleanThreshold={}, watcherCleanIntervalInSeconds={}, watcherCleanThreadsNum={}, maxInProcessingDeadWatchers={}
     146: iconst_4
     147: anewarray     #17                 // class java/lang/Object
     150: dup
     151: iconst_0
     152: iload_2
     153: invokestatic  #25                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     156: aastore
     157: dup
     158: iconst_1
     159: iload_3
     160: invokestatic  #25                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     163: aastore
     164: dup
     165: iconst_2
     166: iload         4
     168: invokestatic  #25                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     171: aastore
     172: dup
     173: iconst_3
     174: iload         5
     176: invokestatic  #25                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     179: aastore
     180: invokeinterface #36,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;[Ljava/lang/Object;)V
     185: return

  public void addDeadWatcher(int);
    Code:
       0: aload_0
       1: getfield      #27                 // Field maxInProcessingDeadWatchers:I
       4: ifle          110
       7: aload_0
       8: getfield      #16                 // Field stopped:Z
      11: ifne          110
      14: aload_0
      15: getfield      #2                  // Field totalDeadWatchers:Ljava/util/concurrent/atomic/AtomicInteger;
      18: invokevirtual #37                 // Method java/util/concurrent/atomic/AtomicInteger.get:()I
      21: aload_0
      22: getfield      #27                 // Field maxInProcessingDeadWatchers:I
      25: if_icmplt     110
      28: aload_0
      29: getfield      #15                 // Field RATE_LOGGER:Lorg/apache/zookeeper/server/RateLogger;
      32: ldc           #38                 // String Waiting for dead watchers cleaning
      34: invokevirtual #39                 // Method org/apache/zookeeper/server/RateLogger.rateLimitLog:(Ljava/lang/String;)V
      37: invokestatic  #40                 // Method org/apache/zookeeper/common/Time.currentElapsedTime:()J
      40: lstore_2
      41: aload_0
      42: getfield      #1                  // Field processingCompletedEvent:Ljava/lang/Object;
      45: dup
      46: astore        4
      48: monitorenter
      49: aload_0
      50: getfield      #1                  // Field processingCompletedEvent:Ljava/lang/Object;
      53: ldc2_w        #41                 // long 100l
      56: invokevirtual #43                 // Method java/lang/Object.wait:(J)V
      59: aload         4
      61: monitorexit
      62: goto          73
      65: astore        5
      67: aload         4
      69: monitorexit
      70: aload         5
      72: athrow
      73: invokestatic  #40                 // Method org/apache/zookeeper/common/Time.currentElapsedTime:()J
      76: lload_2
      77: lsub
      78: lstore        4
      80: invokestatic  #44                 // Method org/apache/zookeeper/server/ServerMetrics.getMetrics:()Lorg/apache/zookeeper/server/ServerMetrics;
      83: getfield      #45                 // Field org/apache/zookeeper/server/ServerMetrics.ADD_DEAD_WATCHER_STALL_TIME:Lorg/apache/zookeeper/metrics/Counter;
      86: lload         4
      88: invokeinterface #46,  3           // InterfaceMethod org/apache/zookeeper/metrics/Counter.add:(J)V
      93: goto          0
      96: astore_2
      97: getstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
     100: ldc           #48                 // String Got interrupted while waiting for dead watches queue size
     102: invokeinterface #49,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     107: goto          110
     110: aload_0
     111: dup
     112: astore_2
     113: monitorenter
     114: aload_0
     115: getfield      #30                 // Field deadWatchers:Ljava/util/Set;
     118: iload_1
     119: invokestatic  #25                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     122: invokeinterface #50,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     127: ifeq          192
     130: aload_0
     131: getfield      #2                  // Field totalDeadWatchers:Ljava/util/concurrent/atomic/AtomicInteger;
     134: invokevirtual #51                 // Method java/util/concurrent/atomic/AtomicInteger.incrementAndGet:()I
     137: pop
     138: invokestatic  #44                 // Method org/apache/zookeeper/server/ServerMetrics.getMetrics:()Lorg/apache/zookeeper/server/ServerMetrics;
     141: getfield      #52                 // Field org/apache/zookeeper/server/ServerMetrics.DEAD_WATCHERS_QUEUED:Lorg/apache/zookeeper/metrics/Counter;
     144: lconst_1
     145: invokeinterface #46,  3           // InterfaceMethod org/apache/zookeeper/metrics/Counter.add:(J)V
     150: aload_0
     151: getfield      #30                 // Field deadWatchers:Ljava/util/Set;
     154: invokeinterface #53,  1           // InterfaceMethod java/util/Set.size:()I
     159: aload_0
     160: getfield      #22                 // Field watcherCleanThreshold:I
     163: if_icmplt     192
     166: aload_0
     167: getfield      #19                 // Field cleanEvent:Ljava/lang/Object;
     170: dup
     171: astore_3
     172: monitorenter
     173: aload_0
     174: getfield      #19                 // Field cleanEvent:Ljava/lang/Object;
     177: invokevirtual #54                 // Method java/lang/Object.notifyAll:()V
     180: aload_3
     181: monitorexit
     182: goto          192
     185: astore        6
     187: aload_3
     188: monitorexit
     189: aload         6
     191: athrow
     192: aload_2
     193: monitorexit
     194: goto          204
     197: astore        7
     199: aload_2
     200: monitorexit
     201: aload         7
     203: athrow
     204: return
    Exception table:
       from    to  target type
          49    62    65   any
          65    70    65   any
          28    93    96   Class java/lang/InterruptedException
         173   182   185   any
         185   189   185   any
         114   194   197   any
         197   201   197   any

  public void run();
    Code:
       0: aload_0
       1: getfield      #16                 // Field stopped:Z
       4: ifne          192
       7: aload_0
       8: getfield      #19                 // Field cleanEvent:Ljava/lang/Object;
      11: dup
      12: astore_1
      13: monitorenter
      14: aload_0
      15: getfield      #16                 // Field stopped:Z
      18: ifne          70
      21: aload_0
      22: getfield      #30                 // Field deadWatchers:Ljava/util/Set;
      25: invokeinterface #53,  1           // InterfaceMethod java/util/Set.size:()I
      30: aload_0
      31: getfield      #22                 // Field watcherCleanThreshold:I
      34: if_icmpge     70
      37: aload_0
      38: getfield      #23                 // Field watcherCleanIntervalInSeconds:I
      41: invokestatic  #55                 // Method java/util/concurrent/ThreadLocalRandom.current:()Ljava/util/concurrent/ThreadLocalRandom;
      44: aload_0
      45: getfield      #23                 // Field watcherCleanIntervalInSeconds:I
      48: iconst_2
      49: idiv
      50: iconst_1
      51: iadd
      52: invokevirtual #56                 // Method java/util/concurrent/ThreadLocalRandom.nextInt:(I)I
      55: iadd
      56: sipush        1000
      59: imul
      60: istore_2
      61: aload_0
      62: getfield      #19                 // Field cleanEvent:Ljava/lang/Object;
      65: iload_2
      66: i2l
      67: invokevirtual #43                 // Method java/lang/Object.wait:(J)V
      70: goto          89
      73: astore_2
      74: getstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
      77: ldc           #57                 // String Received InterruptedException while waiting for cleanEvent
      79: invokeinterface #49,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      84: aload_1
      85: monitorexit
      86: goto          192
      89: aload_1
      90: monitorexit
      91: goto          99
      94: astore_3
      95: aload_1
      96: monitorexit
      97: aload_3
      98: athrow
      99: aload_0
     100: getfield      #30                 // Field deadWatchers:Ljava/util/Set;
     103: invokeinterface #58,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
     108: ifeq          114
     111: goto          0
     114: aload_0
     115: dup
     116: astore_1
     117: monitorenter
     118: new           #28                 // class java/util/HashSet
     121: dup
     122: aload_0
     123: getfield      #30                 // Field deadWatchers:Ljava/util/Set;
     126: invokespecial #59                 // Method java/util/HashSet."<init>":(Ljava/util/Collection;)V
     129: astore_2
     130: aload_0
     131: getfield      #30                 // Field deadWatchers:Ljava/util/Set;
     134: invokeinterface #60,  1           // InterfaceMethod java/util/Set.clear:()V
     139: aload_2
     140: invokeinterface #53,  1           // InterfaceMethod java/util/Set.size:()I
     145: istore_3
     146: getstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
     149: ldc           #61                 // String Processing {} dead watchers
     151: iload_3
     152: invokestatic  #25                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     155: invokeinterface #26,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     160: aload_0
     161: getfield      #34                 // Field cleaners:Lorg/apache/zookeeper/server/WorkerService;
     164: new           #62                 // class org/apache/zookeeper/server/watch/WatcherCleaner$1
     167: dup
     168: aload_0
     169: aload_2
     170: iload_3
     171: invokespecial #63                 // Method org/apache/zookeeper/server/watch/WatcherCleaner$1."<init>":(Lorg/apache/zookeeper/server/watch/WatcherCleaner;Ljava/util/Set;I)V
     174: invokevirtual #64                 // Method org/apache/zookeeper/server/WorkerService.schedule:(Lorg/apache/zookeeper/server/WorkerService$WorkRequest;)V
     177: aload_1
     178: monitorexit
     179: goto          189
     182: astore        4
     184: aload_1
     185: monitorexit
     186: aload         4
     188: athrow
     189: goto          0
     192: getstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
     195: ldc           #65                 // String WatcherCleaner thread exited
     197: invokeinterface #49,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     202: return
    Exception table:
       from    to  target type
          14    70    73   Class java/lang/InterruptedException
          14    86    94   any
          89    91    94   any
          94    97    94   any
         118   179   182   any
         182   186   182   any

  public void shutdown();
    Code:
       0: aload_0
       1: iconst_1
       2: putfield      #16                 // Field stopped:Z
       5: aload_0
       6: getfield      #30                 // Field deadWatchers:Ljava/util/Set;
       9: invokeinterface #60,  1           // InterfaceMethod java/util/Set.clear:()V
      14: aload_0
      15: getfield      #34                 // Field cleaners:Lorg/apache/zookeeper/server/WorkerService;
      18: invokevirtual #66                 // Method org/apache/zookeeper/server/WorkerService.stop:()V
      21: aload_0
      22: invokevirtual #67                 // Method interrupt:()V
      25: getstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
      28: invokeinterface #68,  1           // InterfaceMethod org/slf4j/Logger.isInfoEnabled:()Z
      33: ifeq          46
      36: getstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
      39: ldc           #69                 // String WatcherCleaner thread shutdown is initiated
      41: invokeinterface #49,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      46: return

  static org.apache.zookeeper.server.watch.IDeadWatcherListener access$000(org.apache.zookeeper.server.watch.WatcherCleaner);
    Code:
       0: aload_0
       1: getfield      #4                  // Field listener:Lorg/apache/zookeeper/server/watch/IDeadWatcherListener;
       4: areturn

  static org.slf4j.Logger access$100();
    Code:
       0: getstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
       3: areturn

  static java.util.concurrent.atomic.AtomicInteger access$200(org.apache.zookeeper.server.watch.WatcherCleaner);
    Code:
       0: aload_0
       1: getfield      #2                  // Field totalDeadWatchers:Ljava/util/concurrent/atomic/AtomicInteger;
       4: areturn

  static java.lang.Object access$300(org.apache.zookeeper.server.watch.WatcherCleaner);
    Code:
       0: aload_0
       1: getfield      #1                  // Field processingCompletedEvent:Ljava/lang/Object;
       4: areturn

  static {};
    Code:
       0: ldc           #70                 // class org/apache/zookeeper/server/watch/WatcherCleaner
       2: invokestatic  #71                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #3                  // Field LOG:Lorg/slf4j/Logger;
       8: return
}
