Compiled from "MessageCryptoBc.java"
public class org.apache.pulsar.client.impl.crypto.MessageCryptoBc implements org.apache.pulsar.client.api.MessageCrypto<org.apache.pulsar.common.api.proto.MessageMetadata, org.apache.pulsar.common.api.proto.MessageMetadata> {
  private static final org.slf4j.Logger log;

  private static final java.lang.String ECDSA;

  private static final java.lang.String RSA;

  private static final java.lang.String ECIES;

  private static final java.lang.String RSA_TRANS;

  private static final java.lang.String AESGCM;

  private static javax.crypto.KeyGenerator keyGenerator;

  private static final int tagLen;

  private byte[] iv;

  private javax.crypto.Cipher cipher;

  java.security.MessageDigest digest;

  private java.lang.String logCtx;

  private javax.crypto.SecretKey dataKey;

  private com.google.common.cache.LoadingCache<java.nio.ByteBuffer, javax.crypto.SecretKey> dataKeyCache;

  private java.util.concurrent.ConcurrentHashMap<java.lang.String, org.apache.pulsar.client.api.EncryptionKeyInfo> encryptedDataKeyMap;

  private static final java.security.SecureRandom secureRandom;

  public org.apache.pulsar.client.impl.crypto.MessageCryptoBc(java.lang.String, boolean);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: bipush        12
       7: newarray       byte
       9: putfield      #3                  // Field iv:[B
      12: aload_0
      13: aload_1
      14: putfield      #4                  // Field logCtx:Ljava/lang/String;
      17: aload_0
      18: new           #5                  // class java/util/concurrent/ConcurrentHashMap
      21: dup
      22: invokespecial #6                  // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      25: putfield      #7                  // Field encryptedDataKeyMap:Ljava/util/concurrent/ConcurrentHashMap;
      28: aload_0
      29: invokestatic  #8                  // Method com/google/common/cache/CacheBuilder.newBuilder:()Lcom/google/common/cache/CacheBuilder;
      32: ldc2_w        #9                  // long 4l
      35: getstatic     #11                 // Field java/util/concurrent/TimeUnit.HOURS:Ljava/util/concurrent/TimeUnit;
      38: invokevirtual #12                 // Method com/google/common/cache/CacheBuilder.expireAfterAccess:(JLjava/util/concurrent/TimeUnit;)Lcom/google/common/cache/CacheBuilder;
      41: new           #13                 // class org/apache/pulsar/client/impl/crypto/MessageCryptoBc$1
      44: dup
      45: aload_0
      46: invokespecial #14                 // Method org/apache/pulsar/client/impl/crypto/MessageCryptoBc$1."<init>":(Lorg/apache/pulsar/client/impl/crypto/MessageCryptoBc;)V
      49: invokevirtual #15                 // Method com/google/common/cache/CacheBuilder.build:(Lcom/google/common/cache/CacheLoader;)Lcom/google/common/cache/LoadingCache;
      52: putfield      #16                 // Field dataKeyCache:Lcom/google/common/cache/LoadingCache;
      55: aload_0
      56: ldc           #18                 // String AES/GCM/NoPadding
      58: ldc           #20                 // String BC
      60: invokestatic  #21                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljavax/crypto/Cipher;
      63: putfield      #22                 // Field cipher:Ljavax/crypto/Cipher;
      66: iload_2
      67: ifne          85
      70: aload_0
      71: ldc           #23                 // String MD5
      73: invokestatic  #24                 // Method java/security/MessageDigest.getInstance:(Ljava/lang/String;)Ljava/security/MessageDigest;
      76: putfield      #25                 // Field digest:Ljava/security/MessageDigest;
      79: aload_0
      80: aconst_null
      81: putfield      #26                 // Field dataKey:Ljavax/crypto/SecretKey;
      84: return
      85: ldc           #27                 // String AES
      87: invokestatic  #28                 // Method javax/crypto/KeyGenerator.getInstance:(Ljava/lang/String;)Ljavax/crypto/KeyGenerator;
      90: putstatic     #29                 // Field keyGenerator:Ljavax/crypto/KeyGenerator;
      93: ldc           #27                 // String AES
      95: invokestatic  #30                 // Method javax/crypto/Cipher.getMaxAllowedKeyLength:(Ljava/lang/String;)I
      98: istore_3
      99: iload_3
     100: sipush        128
     103: if_icmpgt     134
     106: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
     109: ldc           #32                 // String {} AES Cryptographic strength is limited to {} bits. Consider installing JCE Unlimited Strength Jurisdiction Policy Files.
     111: aload_1
     112: iload_3
     113: invokestatic  #33                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     116: invokeinterface #34,  4           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     121: getstatic     #29                 // Field keyGenerator:Ljavax/crypto/KeyGenerator;
     124: iload_3
     125: getstatic     #35                 // Field secureRandom:Ljava/security/SecureRandom;
     128: invokevirtual #36                 // Method javax/crypto/KeyGenerator.init:(ILjava/security/SecureRandom;)V
     131: goto          146
     134: getstatic     #29                 // Field keyGenerator:Ljavax/crypto/KeyGenerator;
     137: sipush        256
     140: getstatic     #35                 // Field secureRandom:Ljava/security/SecureRandom;
     143: invokevirtual #36                 // Method javax/crypto/KeyGenerator.init:(ILjava/security/SecureRandom;)V
     146: goto          170
     149: astore_3
     150: aload_0
     151: aconst_null
     152: putfield      #22                 // Field cipher:Ljavax/crypto/Cipher;
     155: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
     158: ldc           #40                 // String {} MessageCrypto initialization Failed {}
     160: aload_1
     161: aload_3
     162: invokevirtual #41                 // Method java/security/GeneralSecurityException.getMessage:()Ljava/lang/String;
     165: invokeinterface #42,  4           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     170: aload_0
     171: getstatic     #29                 // Field keyGenerator:Ljavax/crypto/KeyGenerator;
     174: invokevirtual #43                 // Method javax/crypto/KeyGenerator.generateKey:()Ljavax/crypto/SecretKey;
     177: putfield      #26                 // Field dataKey:Ljavax/crypto/SecretKey;
     180: aload_0
     181: bipush        12
     183: newarray       byte
     185: putfield      #3                  // Field iv:[B
     188: return
    Exception table:
       from    to  target type
          55    84   149   Class java/security/NoSuchAlgorithmException
          55    84   149   Class java/security/NoSuchProviderException
          55    84   149   Class javax/crypto/NoSuchPaddingException
          85   146   149   Class java/security/NoSuchAlgorithmException
          85   146   149   Class java/security/NoSuchProviderException
          85   146   149   Class javax/crypto/NoSuchPaddingException

  private java.security.PublicKey loadPublicKey(byte[]) throws java.lang.Exception;
    Code:
       0: new           #44                 // class java/io/StringReader
       3: dup
       4: new           #45                 // class java/lang/String
       7: dup
       8: aload_1
       9: invokespecial #46                 // Method java/lang/String."<init>":([B)V
      12: invokespecial #47                 // Method java/io/StringReader."<init>":(Ljava/lang/String;)V
      15: astore_2
      16: aconst_null
      17: astore_3
      18: new           #48                 // class org/bouncycastle/openssl/PEMParser
      21: dup
      22: aload_2
      23: invokespecial #49                 // Method org/bouncycastle/openssl/PEMParser."<init>":(Ljava/io/Reader;)V
      26: astore        4
      28: aconst_null
      29: astore        5
      31: aload         4
      33: invokevirtual #50                 // Method org/bouncycastle/openssl/PEMParser.readObject:()Ljava/lang/Object;
      36: astore        6
      38: new           #51                 // class org/bouncycastle/openssl/jcajce/JcaPEMKeyConverter
      41: dup
      42: invokespecial #52                 // Method org/bouncycastle/openssl/jcajce/JcaPEMKeyConverter."<init>":()V
      45: astore        7
      47: aconst_null
      48: astore        8
      50: aconst_null
      51: astore        9
      53: aload         6
      55: instanceof    #53                 // class org/bouncycastle/asn1/ASN1ObjectIdentifier
      58: ifeq          124
      61: aload         6
      63: checkcast     #53                 // class org/bouncycastle/asn1/ASN1ObjectIdentifier
      66: astore        10
      68: aload         10
      70: invokestatic  #54                 // Method org/bouncycastle/asn1/x9/ECNamedCurveTable.getByOID:(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;)Lorg/bouncycastle/asn1/x9/X9ECParameters;
      73: astore        9
      75: aload         9
      77: ifnonnull     114
      80: new           #55                 // class org/bouncycastle/openssl/PEMException
      83: dup
      84: new           #56                 // class java/lang/StringBuilder
      87: dup
      88: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
      91: ldc           #58                 // String Unable to find EC Parameter for the given curve oid:
      93: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      96: aload         6
      98: checkcast     #53                 // class org/bouncycastle/asn1/ASN1ObjectIdentifier
     101: invokevirtual #60                 // Method org/bouncycastle/asn1/ASN1ObjectIdentifier.getId:()Ljava/lang/String;
     104: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     107: invokevirtual #61                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     110: invokespecial #62                 // Method org/bouncycastle/openssl/PEMException."<init>":(Ljava/lang/String;)V
     113: athrow
     114: aload         4
     116: invokevirtual #50                 // Method org/bouncycastle/openssl/PEMParser.readObject:()Ljava/lang/Object;
     119: astore        6
     121: goto          146
     124: aload         6
     126: instanceof    #63                 // class org/bouncycastle/asn1/x9/X9ECParameters
     129: ifeq          146
     132: aload         6
     134: checkcast     #63                 // class org/bouncycastle/asn1/x9/X9ECParameters
     137: astore        9
     139: aload         4
     141: invokevirtual #50                 // Method org/bouncycastle/openssl/PEMParser.readObject:()Ljava/lang/Object;
     144: astore        6
     146: aload         6
     148: instanceof    #64                 // class org/bouncycastle/cert/X509CertificateHolder
     151: ifeq          167
     154: aload         6
     156: checkcast     #64                 // class org/bouncycastle/cert/X509CertificateHolder
     159: invokevirtual #65                 // Method org/bouncycastle/cert/X509CertificateHolder.getSubjectPublicKeyInfo:()Lorg/bouncycastle/asn1/x509/SubjectPublicKeyInfo;
     162: astore        8
     164: goto          174
     167: aload         6
     169: checkcast     #66                 // class org/bouncycastle/asn1/x509/SubjectPublicKeyInfo
     172: astore        8
     174: aload         7
     176: aload         8
     178: invokevirtual #67                 // Method org/bouncycastle/openssl/jcajce/JcaPEMKeyConverter.getPublicKey:(Lorg/bouncycastle/asn1/x509/SubjectPublicKeyInfo;)Ljava/security/PublicKey;
     181: astore_3
     182: aload         9
     184: ifnull        270
     187: ldc           #68                 // String ECDSA
     189: aload_3
     190: invokeinterface #69,  1           // InterfaceMethod java/security/PublicKey.getAlgorithm:()Ljava/lang/String;
     195: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     198: ifeq          270
     201: new           #71                 // class org/bouncycastle/jce/spec/ECParameterSpec
     204: dup
     205: aload         9
     207: invokevirtual #72                 // Method org/bouncycastle/asn1/x9/X9ECParameters.getCurve:()Lorg/bouncycastle/math/ec/ECCurve;
     210: aload         9
     212: invokevirtual #73                 // Method org/bouncycastle/asn1/x9/X9ECParameters.getG:()Lorg/bouncycastle/math/ec/ECPoint;
     215: aload         9
     217: invokevirtual #74                 // Method org/bouncycastle/asn1/x9/X9ECParameters.getN:()Ljava/math/BigInteger;
     220: aload         9
     222: invokevirtual #75                 // Method org/bouncycastle/asn1/x9/X9ECParameters.getH:()Ljava/math/BigInteger;
     225: aload         9
     227: invokevirtual #76                 // Method org/bouncycastle/asn1/x9/X9ECParameters.getSeed:()[B
     230: invokespecial #77                 // Method org/bouncycastle/jce/spec/ECParameterSpec."<init>":(Lorg/bouncycastle/math/ec/ECCurve;Lorg/bouncycastle/math/ec/ECPoint;Ljava/math/BigInteger;Ljava/math/BigInteger;[B)V
     233: astore        10
     235: ldc           #68                 // String ECDSA
     237: ldc           #20                 // String BC
     239: invokestatic  #78                 // Method java/security/KeyFactory.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/KeyFactory;
     242: astore        11
     244: new           #79                 // class org/bouncycastle/jce/spec/ECPublicKeySpec
     247: dup
     248: aload_3
     249: checkcast     #80                 // class org/bouncycastle/jcajce/provider/asymmetric/ec/BCECPublicKey
     252: invokevirtual #81                 // Method org/bouncycastle/jcajce/provider/asymmetric/ec/BCECPublicKey.getQ:()Lorg/bouncycastle/math/ec/ECPoint;
     255: aload         10
     257: invokespecial #82                 // Method org/bouncycastle/jce/spec/ECPublicKeySpec."<init>":(Lorg/bouncycastle/math/ec/ECPoint;Lorg/bouncycastle/jce/spec/ECParameterSpec;)V
     260: astore        12
     262: aload         11
     264: aload         12
     266: invokevirtual #83                 // Method java/security/KeyFactory.generatePublic:(Ljava/security/spec/KeySpec;)Ljava/security/PublicKey;
     269: astore_3
     270: aload         4
     272: ifnull        357
     275: aload         5
     277: ifnull        300
     280: aload         4
     282: invokevirtual #84                 // Method org/bouncycastle/openssl/PEMParser.close:()V
     285: goto          357
     288: astore        6
     290: aload         5
     292: aload         6
     294: invokevirtual #86                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     297: goto          357
     300: aload         4
     302: invokevirtual #84                 // Method org/bouncycastle/openssl/PEMParser.close:()V
     305: goto          357
     308: astore        6
     310: aload         6
     312: astore        5
     314: aload         6
     316: athrow
     317: astore        13
     319: aload         4
     321: ifnull        354
     324: aload         5
     326: ifnull        349
     329: aload         4
     331: invokevirtual #84                 // Method org/bouncycastle/openssl/PEMParser.close:()V
     334: goto          354
     337: astore        14
     339: aload         5
     341: aload         14
     343: invokevirtual #86                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     346: goto          354
     349: aload         4
     351: invokevirtual #84                 // Method org/bouncycastle/openssl/PEMParser.close:()V
     354: aload         13
     356: athrow
     357: goto          372
     360: astore        4
     362: new           #89                 // class java/lang/Exception
     365: dup
     366: aload         4
     368: invokespecial #90                 // Method java/lang/Exception."<init>":(Ljava/lang/Throwable;)V
     371: athrow
     372: aload_3
     373: areturn
    Exception table:
       from    to  target type
         280   285   288   Class java/lang/Throwable
          31   270   308   Class java/lang/Throwable
          31   270   317   any
         329   334   337   Class java/lang/Throwable
         308   319   317   any
          18   357   360   Class java/io/IOException
          18   357   360   Class java/security/NoSuchAlgorithmException
          18   357   360   Class java/security/NoSuchProviderException
          18   357   360   Class java/security/spec/InvalidKeySpecException

  private java.security.PrivateKey loadPrivateKey(byte[]) throws java.lang.Exception;
    Code:
       0: new           #44                 // class java/io/StringReader
       3: dup
       4: new           #45                 // class java/lang/String
       7: dup
       8: aload_1
       9: invokespecial #46                 // Method java/lang/String."<init>":([B)V
      12: invokespecial #47                 // Method java/io/StringReader."<init>":(Ljava/lang/String;)V
      15: astore_2
      16: aconst_null
      17: astore_3
      18: new           #48                 // class org/bouncycastle/openssl/PEMParser
      21: dup
      22: aload_2
      23: invokespecial #49                 // Method org/bouncycastle/openssl/PEMParser."<init>":(Ljava/io/Reader;)V
      26: astore        4
      28: aconst_null
      29: astore        5
      31: aconst_null
      32: astore        6
      34: aload         4
      36: invokevirtual #50                 // Method org/bouncycastle/openssl/PEMParser.readObject:()Ljava/lang/Object;
      39: astore        7
      41: aload         7
      43: instanceof    #53                 // class org/bouncycastle/asn1/ASN1ObjectIdentifier
      46: ifeq          109
      49: aload         7
      51: checkcast     #53                 // class org/bouncycastle/asn1/ASN1ObjectIdentifier
      54: astore        8
      56: aload         8
      58: invokestatic  #54                 // Method org/bouncycastle/asn1/x9/ECNamedCurveTable.getByOID:(Lorg/bouncycastle/asn1/ASN1ObjectIdentifier;)Lorg/bouncycastle/asn1/x9/X9ECParameters;
      61: astore        6
      63: aload         6
      65: ifnonnull     99
      68: new           #55                 // class org/bouncycastle/openssl/PEMException
      71: dup
      72: new           #56                 // class java/lang/StringBuilder
      75: dup
      76: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
      79: ldc           #58                 // String Unable to find EC Parameter for the given curve oid:
      81: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      84: aload         8
      86: invokevirtual #60                 // Method org/bouncycastle/asn1/ASN1ObjectIdentifier.getId:()Ljava/lang/String;
      89: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      92: invokevirtual #61                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      95: invokespecial #62                 // Method org/bouncycastle/openssl/PEMException."<init>":(Ljava/lang/String;)V
      98: athrow
      99: aload         4
     101: invokevirtual #50                 // Method org/bouncycastle/openssl/PEMParser.readObject:()Ljava/lang/Object;
     104: astore        7
     106: goto          131
     109: aload         7
     111: instanceof    #63                 // class org/bouncycastle/asn1/x9/X9ECParameters
     114: ifeq          131
     117: aload         7
     119: checkcast     #63                 // class org/bouncycastle/asn1/x9/X9ECParameters
     122: astore        6
     124: aload         4
     126: invokevirtual #50                 // Method org/bouncycastle/openssl/PEMParser.readObject:()Ljava/lang/Object;
     129: astore        7
     131: aload         7
     133: instanceof    #91                 // class org/bouncycastle/openssl/PEMKeyPair
     136: ifeq          166
     139: aload         7
     141: checkcast     #91                 // class org/bouncycastle/openssl/PEMKeyPair
     144: invokevirtual #92                 // Method org/bouncycastle/openssl/PEMKeyPair.getPrivateKeyInfo:()Lorg/bouncycastle/asn1/pkcs/PrivateKeyInfo;
     147: astore        8
     149: new           #51                 // class org/bouncycastle/openssl/jcajce/JcaPEMKeyConverter
     152: dup
     153: invokespecial #52                 // Method org/bouncycastle/openssl/jcajce/JcaPEMKeyConverter."<init>":()V
     156: astore        9
     158: aload         9
     160: aload         8
     162: invokevirtual #93                 // Method org/bouncycastle/openssl/jcajce/JcaPEMKeyConverter.getPrivateKey:(Lorg/bouncycastle/asn1/pkcs/PrivateKeyInfo;)Ljava/security/PrivateKey;
     165: astore_3
     166: aload         6
     168: ifnull        254
     171: ldc           #68                 // String ECDSA
     173: aload_3
     174: invokeinterface #94,  1           // InterfaceMethod java/security/PrivateKey.getAlgorithm:()Ljava/lang/String;
     179: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     182: ifeq          254
     185: new           #71                 // class org/bouncycastle/jce/spec/ECParameterSpec
     188: dup
     189: aload         6
     191: invokevirtual #72                 // Method org/bouncycastle/asn1/x9/X9ECParameters.getCurve:()Lorg/bouncycastle/math/ec/ECCurve;
     194: aload         6
     196: invokevirtual #73                 // Method org/bouncycastle/asn1/x9/X9ECParameters.getG:()Lorg/bouncycastle/math/ec/ECPoint;
     199: aload         6
     201: invokevirtual #74                 // Method org/bouncycastle/asn1/x9/X9ECParameters.getN:()Ljava/math/BigInteger;
     204: aload         6
     206: invokevirtual #75                 // Method org/bouncycastle/asn1/x9/X9ECParameters.getH:()Ljava/math/BigInteger;
     209: aload         6
     211: invokevirtual #76                 // Method org/bouncycastle/asn1/x9/X9ECParameters.getSeed:()[B
     214: invokespecial #77                 // Method org/bouncycastle/jce/spec/ECParameterSpec."<init>":(Lorg/bouncycastle/math/ec/ECCurve;Lorg/bouncycastle/math/ec/ECPoint;Ljava/math/BigInteger;Ljava/math/BigInteger;[B)V
     217: astore        8
     219: ldc           #68                 // String ECDSA
     221: ldc           #20                 // String BC
     223: invokestatic  #78                 // Method java/security/KeyFactory.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/KeyFactory;
     226: astore        9
     228: new           #95                 // class org/bouncycastle/jce/spec/ECPrivateKeySpec
     231: dup
     232: aload_3
     233: checkcast     #96                 // class org/bouncycastle/jcajce/provider/asymmetric/ec/BCECPrivateKey
     236: invokevirtual #97                 // Method org/bouncycastle/jcajce/provider/asymmetric/ec/BCECPrivateKey.getS:()Ljava/math/BigInteger;
     239: aload         8
     241: invokespecial #98                 // Method org/bouncycastle/jce/spec/ECPrivateKeySpec."<init>":(Ljava/math/BigInteger;Lorg/bouncycastle/jce/spec/ECParameterSpec;)V
     244: astore        10
     246: aload         9
     248: aload         10
     250: invokevirtual #99                 // Method java/security/KeyFactory.generatePrivate:(Ljava/security/spec/KeySpec;)Ljava/security/PrivateKey;
     253: astore_3
     254: aload         4
     256: ifnull        341
     259: aload         5
     261: ifnull        284
     264: aload         4
     266: invokevirtual #84                 // Method org/bouncycastle/openssl/PEMParser.close:()V
     269: goto          341
     272: astore        6
     274: aload         5
     276: aload         6
     278: invokevirtual #86                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     281: goto          341
     284: aload         4
     286: invokevirtual #84                 // Method org/bouncycastle/openssl/PEMParser.close:()V
     289: goto          341
     292: astore        6
     294: aload         6
     296: astore        5
     298: aload         6
     300: athrow
     301: astore        11
     303: aload         4
     305: ifnull        338
     308: aload         5
     310: ifnull        333
     313: aload         4
     315: invokevirtual #84                 // Method org/bouncycastle/openssl/PEMParser.close:()V
     318: goto          338
     321: astore        12
     323: aload         5
     325: aload         12
     327: invokevirtual #86                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     330: goto          338
     333: aload         4
     335: invokevirtual #84                 // Method org/bouncycastle/openssl/PEMParser.close:()V
     338: aload         11
     340: athrow
     341: goto          356
     344: astore        4
     346: new           #89                 // class java/lang/Exception
     349: dup
     350: aload         4
     352: invokespecial #90                 // Method java/lang/Exception."<init>":(Ljava/lang/Throwable;)V
     355: athrow
     356: aload_3
     357: areturn
    Exception table:
       from    to  target type
         264   269   272   Class java/lang/Throwable
          31   254   292   Class java/lang/Throwable
          31   254   301   any
         313   318   321   Class java/lang/Throwable
         292   303   301   any
          18   341   344   Class java/io/IOException

  public synchronized void addPublicKeyCipher(java.util.Set<java.lang.String>, org.apache.pulsar.client.api.CryptoKeyReader) throws org.apache.pulsar.client.api.PulsarClientException$CryptoException;
    Code:
       0: aload_0
       1: getstatic     #29                 // Field keyGenerator:Ljavax/crypto/KeyGenerator;
       4: invokevirtual #43                 // Method javax/crypto/KeyGenerator.generateKey:()Ljavax/crypto/SecretKey;
       7: putfield      #26                 // Field dataKey:Ljavax/crypto/SecretKey;
      10: aload_1
      11: invokeinterface #100,  1          // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      16: astore_3
      17: aload_3
      18: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      23: ifeq          47
      26: aload_3
      27: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      32: checkcast     #45                 // class java/lang/String
      35: astore        4
      37: aload_0
      38: aload         4
      40: aload_2
      41: invokespecial #103                // Method addPublicKeyCipher:(Ljava/lang/String;Lorg/apache/pulsar/client/api/CryptoKeyReader;)V
      44: goto          17
      47: return

  private void addPublicKeyCipher(java.lang.String, org.apache.pulsar.client.api.CryptoKeyReader) throws org.apache.pulsar.client.api.PulsarClientException$CryptoException;
    Code:
       0: aload_1
       1: ifnull        8
       4: aload_2
       5: ifnonnull     18
       8: new           #104                // class org/apache/pulsar/client/api/PulsarClientException$CryptoException
      11: dup
      12: ldc           #105                // String Keyname or KeyReader is null
      14: invokespecial #106                // Method org/apache/pulsar/client/api/PulsarClientException$CryptoException."<init>":(Ljava/lang/String;)V
      17: athrow
      18: aload_2
      19: aload_1
      20: aconst_null
      21: invokeinterface #107,  3          // InterfaceMethod org/apache/pulsar/client/api/CryptoKeyReader.getPublicKey:(Ljava/lang/String;Ljava/util/Map;)Lorg/apache/pulsar/client/api/EncryptionKeyInfo;
      26: astore_3
      27: aload_0
      28: aload_3
      29: invokevirtual #108                // Method org/apache/pulsar/client/api/EncryptionKeyInfo.getKey:()[B
      32: invokespecial #109                // Method loadPublicKey:([B)Ljava/security/PublicKey;
      35: astore        4
      37: goto          103
      40: astore        5
      42: new           #56                 // class java/lang/StringBuilder
      45: dup
      46: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
      49: aload_0
      50: getfield      #4                  // Field logCtx:Ljava/lang/String;
      53: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      56: ldc           #110                // String Failed to load public key
      58: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      61: aload_1
      62: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      65: ldc           #111                // String .
      67: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      70: aload         5
      72: invokevirtual #112                // Method java/lang/Exception.getMessage:()Ljava/lang/String;
      75: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      78: invokevirtual #61                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      81: astore        6
      83: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
      86: aload         6
      88: invokeinterface #113,  2          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      93: new           #104                // class org/apache/pulsar/client/api/PulsarClientException$CryptoException
      96: dup
      97: aload         6
      99: invokespecial #106                // Method org/apache/pulsar/client/api/PulsarClientException$CryptoException."<init>":(Ljava/lang/String;)V
     102: athrow
     103: aconst_null
     104: astore        5
     106: ldc           #114                // String RSA
     108: aload         4
     110: invokeinterface #69,  1           // InterfaceMethod java/security/PublicKey.getAlgorithm:()Ljava/lang/String;
     115: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     118: ifeq          133
     121: ldc           #115                // String RSA/NONE/OAEPWithSHA1AndMGF1Padding
     123: ldc           #20                 // String BC
     125: invokestatic  #21                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljavax/crypto/Cipher;
     128: astore        5
     130: goto          223
     133: ldc           #68                 // String ECDSA
     135: aload         4
     137: invokeinterface #69,  1           // InterfaceMethod java/security/PublicKey.getAlgorithm:()Ljava/lang/String;
     142: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     145: ifeq          160
     148: ldc           #116                // String ECIES
     150: ldc           #20                 // String BC
     152: invokestatic  #21                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljavax/crypto/Cipher;
     155: astore        5
     157: goto          223
     160: new           #56                 // class java/lang/StringBuilder
     163: dup
     164: invokespecial #57                 // Method java/lang/StringBuilder."<init>":()V
     167: aload_0
     168: getfield      #4                  // Field logCtx:Ljava/lang/String;
     171: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     174: ldc           #117                // String Unsupported key type
     176: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     179: aload         4
     181: invokeinterface #69,  1           // InterfaceMethod java/security/PublicKey.getAlgorithm:()Ljava/lang/String;
     186: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     189: ldc           #118                // String  for key
     191: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     194: aload_1
     195: invokevirtual #59                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     198: invokevirtual #61                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     201: astore        7
     203: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
     206: aload         7
     208: invokeinterface #113,  2          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     213: new           #104                // class org/apache/pulsar/client/api/PulsarClientException$CryptoException
     216: dup
     217: aload         7
     219: invokespecial #106                // Method org/apache/pulsar/client/api/PulsarClientException$CryptoException."<init>":(Ljava/lang/String;)V
     222: athrow
     223: aload         5
     225: iconst_1
     226: aload         4
     228: invokevirtual #120                // Method javax/crypto/Cipher.init:(ILjava/security/Key;)V
     231: aload         5
     233: aload_0
     234: getfield      #26                 // Field dataKey:Ljavax/crypto/SecretKey;
     237: invokeinterface #121,  1          // InterfaceMethod javax/crypto/SecretKey.getEncoded:()[B
     242: invokevirtual #122                // Method javax/crypto/Cipher.doFinal:([B)[B
     245: astore        6
     247: goto          298
     250: astore        7
     252: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
     255: ldc           #126                // String {} Failed to encrypt data key {}. {}
     257: iconst_3
     258: anewarray     #127                // class java/lang/Object
     261: dup
     262: iconst_0
     263: aload_0
     264: getfield      #4                  // Field logCtx:Ljava/lang/String;
     267: aastore
     268: dup
     269: iconst_1
     270: aload_1
     271: aastore
     272: dup
     273: iconst_2
     274: aload         7
     276: invokevirtual #41                 // Method java/security/GeneralSecurityException.getMessage:()Ljava/lang/String;
     279: aastore
     280: invokeinterface #128,  3          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;[Ljava/lang/Object;)V
     285: new           #104                // class org/apache/pulsar/client/api/PulsarClientException$CryptoException
     288: dup
     289: aload         7
     291: invokevirtual #41                 // Method java/security/GeneralSecurityException.getMessage:()Ljava/lang/String;
     294: invokespecial #106                // Method org/apache/pulsar/client/api/PulsarClientException$CryptoException."<init>":(Ljava/lang/String;)V
     297: athrow
     298: new           #129                // class org/apache/pulsar/client/api/EncryptionKeyInfo
     301: dup
     302: aload         6
     304: aload_3
     305: invokevirtual #130                // Method org/apache/pulsar/client/api/EncryptionKeyInfo.getMetadata:()Ljava/util/Map;
     308: invokespecial #131                // Method org/apache/pulsar/client/api/EncryptionKeyInfo."<init>":([BLjava/util/Map;)V
     311: astore        7
     313: aload_0
     314: getfield      #7                  // Field encryptedDataKeyMap:Ljava/util/concurrent/ConcurrentHashMap;
     317: aload_1
     318: aload         7
     320: invokevirtual #132                // Method java/util/concurrent/ConcurrentHashMap.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     323: pop
     324: return
    Exception table:
       from    to  target type
          27    37    40   Class java/lang/Exception
         106   247   250   Class javax/crypto/IllegalBlockSizeException
         106   247   250   Class javax/crypto/BadPaddingException
         106   247   250   Class java/security/NoSuchAlgorithmException
         106   247   250   Class java/security/NoSuchProviderException
         106   247   250   Class javax/crypto/NoSuchPaddingException
         106   247   250   Class java/security/InvalidKeyException

  public boolean removeKeyCipher(java.lang.String);
    Code:
       0: aload_1
       1: ifnonnull     6
       4: iconst_0
       5: ireturn
       6: aload_0
       7: getfield      #7                  // Field encryptedDataKeyMap:Ljava/util/concurrent/ConcurrentHashMap;
      10: aload_1
      11: invokevirtual #133                // Method java/util/concurrent/ConcurrentHashMap.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      14: pop
      15: iconst_1
      16: ireturn

  public synchronized void encrypt(java.util.Set<java.lang.String>, org.apache.pulsar.client.api.CryptoKeyReader, java.util.function.Supplier<org.apache.pulsar.common.api.proto.MessageMetadata>, java.nio.ByteBuffer, java.nio.ByteBuffer) throws org.apache.pulsar.client.api.PulsarClientException;
    Code:
       0: aload_3
       1: invokeinterface #134,  1          // InterfaceMethod java/util/function/Supplier.get:()Ljava/lang/Object;
       6: checkcast     #135                // class org/apache/pulsar/common/api/proto/MessageMetadata
       9: astore        6
      11: aload_1
      12: invokeinterface #136,  1          // InterfaceMethod java/util/Set.isEmpty:()Z
      17: ifeq          35
      20: aload         5
      22: aload         4
      24: invokevirtual #137                // Method java/nio/ByteBuffer.put:(Ljava/nio/ByteBuffer;)Ljava/nio/ByteBuffer;
      27: pop
      28: aload         5
      30: invokevirtual #138                // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
      33: pop
      34: return
      35: aload         6
      37: invokevirtual #139                // Method org/apache/pulsar/common/api/proto/MessageMetadata.clearEncryptionKeys:()Lorg/apache/pulsar/common/api/proto/MessageMetadata;
      40: pop
      41: aload_1
      42: invokeinterface #100,  1          // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      47: astore        7
      49: aload         7
      51: invokeinterface #101,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      56: ifeq          211
      59: aload         7
      61: invokeinterface #102,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      66: checkcast     #45                 // class java/lang/String
      69: astore        8
      71: aload_0
      72: getfield      #7                  // Field encryptedDataKeyMap:Ljava/util/concurrent/ConcurrentHashMap;
      75: aload         8
      77: invokevirtual #140                // Method java/util/concurrent/ConcurrentHashMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
      80: ifnonnull     90
      83: aload_0
      84: aload         8
      86: aload_2
      87: invokespecial #103                // Method addPublicKeyCipher:(Ljava/lang/String;Lorg/apache/pulsar/client/api/CryptoKeyReader;)V
      90: aload_0
      91: getfield      #7                  // Field encryptedDataKeyMap:Ljava/util/concurrent/ConcurrentHashMap;
      94: aload         8
      96: invokevirtual #140                // Method java/util/concurrent/ConcurrentHashMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
      99: checkcast     #129                // class org/apache/pulsar/client/api/EncryptionKeyInfo
     102: astore        9
     104: aload         9
     106: ifnull        192
     109: aload         9
     111: invokevirtual #130                // Method org/apache/pulsar/client/api/EncryptionKeyInfo.getMetadata:()Ljava/util/Map;
     114: ifnull        170
     117: aload         9
     119: invokevirtual #130                // Method org/apache/pulsar/client/api/EncryptionKeyInfo.getMetadata:()Ljava/util/Map;
     122: invokeinterface #141,  1          // InterfaceMethod java/util/Map.isEmpty:()Z
     127: ifne          170
     130: aload         6
     132: invokevirtual #142                // Method org/apache/pulsar/common/api/proto/MessageMetadata.addEncryptionKey:()Lorg/apache/pulsar/common/api/proto/EncryptionKeys;
     135: aload         8
     137: invokevirtual #143                // Method org/apache/pulsar/common/api/proto/EncryptionKeys.setKey:(Ljava/lang/String;)Lorg/apache/pulsar/common/api/proto/EncryptionKeys;
     140: aload         9
     142: invokevirtual #108                // Method org/apache/pulsar/client/api/EncryptionKeyInfo.getKey:()[B
     145: invokevirtual #144                // Method org/apache/pulsar/common/api/proto/EncryptionKeys.setValue:([B)Lorg/apache/pulsar/common/api/proto/EncryptionKeys;
     148: astore        10
     150: aload         9
     152: invokevirtual #130                // Method org/apache/pulsar/client/api/EncryptionKeyInfo.getMetadata:()Ljava/util/Map;
     155: aload         10
     157: invokedynamic #145,  0            // InvokeDynamic #0:accept:(Lorg/apache/pulsar/common/api/proto/EncryptionKeys;)Ljava/util/function/BiConsumer;
     162: invokeinterface #146,  2          // InterfaceMethod java/util/Map.forEach:(Ljava/util/function/BiConsumer;)V
     167: goto          208
     170: aload         6
     172: invokevirtual #142                // Method org/apache/pulsar/common/api/proto/MessageMetadata.addEncryptionKey:()Lorg/apache/pulsar/common/api/proto/EncryptionKeys;
     175: aload         8
     177: invokevirtual #143                // Method org/apache/pulsar/common/api/proto/EncryptionKeys.setKey:(Ljava/lang/String;)Lorg/apache/pulsar/common/api/proto/EncryptionKeys;
     180: aload         9
     182: invokevirtual #108                // Method org/apache/pulsar/client/api/EncryptionKeyInfo.getKey:()[B
     185: invokevirtual #144                // Method org/apache/pulsar/common/api/proto/EncryptionKeys.setValue:([B)Lorg/apache/pulsar/common/api/proto/EncryptionKeys;
     188: pop
     189: goto          208
     192: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
     195: ldc           #147                // String {} Failed to find encrypted Data key for key {}.
     197: aload_0
     198: getfield      #4                  // Field logCtx:Ljava/lang/String;
     201: aload         8
     203: invokeinterface #42,  4           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     208: goto          49
     211: getstatic     #35                 // Field secureRandom:Ljava/security/SecureRandom;
     214: aload_0
     215: getfield      #3                  // Field iv:[B
     218: invokevirtual #148                // Method java/security/SecureRandom.nextBytes:([B)V
     221: new           #149                // class javax/crypto/spec/GCMParameterSpec
     224: dup
     225: sipush        128
     228: aload_0
     229: getfield      #3                  // Field iv:[B
     232: invokespecial #150                // Method javax/crypto/spec/GCMParameterSpec."<init>":(I[B)V
     235: astore        7
     237: aload         6
     239: aload_0
     240: getfield      #3                  // Field iv:[B
     243: invokevirtual #151                // Method org/apache/pulsar/common/api/proto/MessageMetadata.setEncryptionParam:([B)Lorg/apache/pulsar/common/api/proto/MessageMetadata;
     246: pop
     247: aload_0
     248: getfield      #22                 // Field cipher:Ljavax/crypto/Cipher;
     251: iconst_1
     252: aload_0
     253: getfield      #26                 // Field dataKey:Ljavax/crypto/SecretKey;
     256: aload         7
     258: invokevirtual #152                // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
     261: aload_0
     262: getfield      #22                 // Field cipher:Ljavax/crypto/Cipher;
     265: aload         4
     267: invokevirtual #153                // Method java/nio/ByteBuffer.remaining:()I
     270: invokevirtual #154                // Method javax/crypto/Cipher.getOutputSize:(I)I
     273: istore        8
     275: aload         5
     277: invokevirtual #153                // Method java/nio/ByteBuffer.remaining:()I
     280: iload         8
     282: if_icmpge     295
     285: new           #155                // class java/lang/IllegalArgumentException
     288: dup
     289: ldc           #156                // String Outbuffer has not enough space available
     291: invokespecial #157                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     294: athrow
     295: aload_0
     296: getfield      #22                 // Field cipher:Ljavax/crypto/Cipher;
     299: aload         4
     301: aload         5
     303: invokevirtual #158                // Method javax/crypto/Cipher.doFinal:(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)I
     306: istore        9
     308: aload         5
     310: invokevirtual #138                // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
     313: pop
     314: aload         5
     316: iload         9
     318: invokevirtual #159                // Method java/nio/ByteBuffer.limit:(I)Ljava/nio/Buffer;
     321: pop
     322: goto          356
     325: astore        8
     327: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
     330: ldc           #162                // String {} Failed to encrypt message. {}
     332: aload_0
     333: getfield      #4                  // Field logCtx:Ljava/lang/String;
     336: aload         8
     338: invokeinterface #42,  4           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     343: new           #104                // class org/apache/pulsar/client/api/PulsarClientException$CryptoException
     346: dup
     347: aload         8
     349: invokevirtual #41                 // Method java/security/GeneralSecurityException.getMessage:()Ljava/lang/String;
     352: invokespecial #106                // Method org/apache/pulsar/client/api/PulsarClientException$CryptoException."<init>":(Ljava/lang/String;)V
     355: athrow
     356: return
    Exception table:
       from    to  target type
         247   322   325   Class javax/crypto/IllegalBlockSizeException
         247   322   325   Class javax/crypto/BadPaddingException
         247   322   325   Class java/security/InvalidKeyException
         247   322   325   Class java/security/InvalidAlgorithmParameterException
         247   322   325   Class javax/crypto/ShortBufferException

  private boolean decryptDataKey(java.lang.String, byte[], java.util.List<org.apache.pulsar.common.api.proto.KeyValue>, org.apache.pulsar.client.api.CryptoKeyReader);
    Code:
       0: new           #163                // class java/util/HashMap
       3: dup
       4: invokespecial #164                // Method java/util/HashMap."<init>":()V
       7: astore        5
       9: aload_3
      10: aload         5
      12: invokedynamic #165,  0            // InvokeDynamic #1:accept:(Ljava/util/Map;)Ljava/util/function/Consumer;
      17: invokeinterface #166,  2          // InterfaceMethod java/util/List.forEach:(Ljava/util/function/Consumer;)V
      22: aload         4
      24: aload_1
      25: aload         5
      27: invokeinterface #167,  3          // InterfaceMethod org/apache/pulsar/client/api/CryptoKeyReader.getPrivateKey:(Ljava/lang/String;Ljava/util/Map;)Lorg/apache/pulsar/client/api/EncryptionKeyInfo;
      32: astore        6
      34: aload_0
      35: aload         6
      37: invokevirtual #108                // Method org/apache/pulsar/client/api/EncryptionKeyInfo.getKey:()[B
      40: invokespecial #168                // Method loadPrivateKey:([B)Ljava/security/PrivateKey;
      43: astore        7
      45: aload         7
      47: ifnonnull     67
      50: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
      53: ldc           #169                // String {} Failed to load private key {}.
      55: aload_0
      56: getfield      #4                  // Field logCtx:Ljava/lang/String;
      59: aload_1
      60: invokeinterface #42,  4           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      65: iconst_0
      66: ireturn
      67: goto          107
      70: astore        8
      72: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
      75: ldc           #170                // String {} Failed to decrypt data key {} to decrypt messages {}
      77: iconst_3
      78: anewarray     #127                // class java/lang/Object
      81: dup
      82: iconst_0
      83: aload_0
      84: getfield      #4                  // Field logCtx:Ljava/lang/String;
      87: aastore
      88: dup
      89: iconst_1
      90: aload_1
      91: aastore
      92: dup
      93: iconst_2
      94: aload         8
      96: invokevirtual #112                // Method java/lang/Exception.getMessage:()Ljava/lang/String;
      99: aastore
     100: invokeinterface #128,  3          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;[Ljava/lang/Object;)V
     105: iconst_0
     106: ireturn
     107: aconst_null
     108: astore        8
     110: aconst_null
     111: astore        9
     113: aconst_null
     114: astore        10
     116: ldc           #114                // String RSA
     118: aload         7
     120: invokeinterface #94,  1           // InterfaceMethod java/security/PrivateKey.getAlgorithm:()Ljava/lang/String;
     125: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     128: ifeq          143
     131: ldc           #115                // String RSA/NONE/OAEPWithSHA1AndMGF1Padding
     133: ldc           #20                 // String BC
     135: invokestatic  #21                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljavax/crypto/Cipher;
     138: astore        8
     140: goto          190
     143: ldc           #68                 // String ECDSA
     145: aload         7
     147: invokeinterface #94,  1           // InterfaceMethod java/security/PrivateKey.getAlgorithm:()Ljava/lang/String;
     152: invokevirtual #70                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     155: ifeq          170
     158: ldc           #116                // String ECIES
     160: ldc           #20                 // String BC
     162: invokestatic  #21                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljavax/crypto/Cipher;
     165: astore        8
     167: goto          190
     170: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
     173: ldc           #171                // String Unsupported key type {} for key {}.
     175: aload         7
     177: invokeinterface #94,  1           // InterfaceMethod java/security/PrivateKey.getAlgorithm:()Ljava/lang/String;
     182: aload_1
     183: invokeinterface #42,  4           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     188: iconst_0
     189: ireturn
     190: aload         8
     192: iconst_2
     193: aload         7
     195: invokevirtual #120                // Method javax/crypto/Cipher.init:(ILjava/security/Key;)V
     198: aload         8
     200: aload_2
     201: invokevirtual #122                // Method javax/crypto/Cipher.doFinal:([B)[B
     204: astore        9
     206: aload_0
     207: getfield      #25                 // Field digest:Ljava/security/MessageDigest;
     210: aload_2
     211: invokevirtual #172                // Method java/security/MessageDigest.digest:([B)[B
     214: astore        10
     216: goto          256
     219: astore        11
     221: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
     224: ldc           #170                // String {} Failed to decrypt data key {} to decrypt messages {}
     226: iconst_3
     227: anewarray     #127                // class java/lang/Object
     230: dup
     231: iconst_0
     232: aload_0
     233: getfield      #4                  // Field logCtx:Ljava/lang/String;
     236: aastore
     237: dup
     238: iconst_1
     239: aload_1
     240: aastore
     241: dup
     242: iconst_2
     243: aload         11
     245: invokevirtual #41                 // Method java/security/GeneralSecurityException.getMessage:()Ljava/lang/String;
     248: aastore
     249: invokeinterface #128,  3          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;[Ljava/lang/Object;)V
     254: iconst_0
     255: ireturn
     256: aload_0
     257: new           #173                // class javax/crypto/spec/SecretKeySpec
     260: dup
     261: aload         9
     263: ldc           #27                 // String AES
     265: invokespecial #174                // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
     268: putfield      #26                 // Field dataKey:Ljavax/crypto/SecretKey;
     271: aload_0
     272: getfield      #16                 // Field dataKeyCache:Lcom/google/common/cache/LoadingCache;
     275: aload         10
     277: invokestatic  #175                // Method java/nio/ByteBuffer.wrap:([B)Ljava/nio/ByteBuffer;
     280: aload_0
     281: getfield      #26                 // Field dataKey:Ljavax/crypto/SecretKey;
     284: invokeinterface #176,  3          // InterfaceMethod com/google/common/cache/LoadingCache.put:(Ljava/lang/Object;Ljava/lang/Object;)V
     289: iconst_1
     290: ireturn
    Exception table:
       from    to  target type
          34    66    70   Class java/lang/Exception
         116   189   219   Class javax/crypto/IllegalBlockSizeException
         116   189   219   Class javax/crypto/BadPaddingException
         116   189   219   Class java/security/NoSuchAlgorithmException
         116   189   219   Class java/security/NoSuchProviderException
         116   189   219   Class javax/crypto/NoSuchPaddingException
         116   189   219   Class java/security/InvalidKeyException
         190   216   219   Class javax/crypto/IllegalBlockSizeException
         190   216   219   Class javax/crypto/BadPaddingException
         190   216   219   Class java/security/NoSuchAlgorithmException
         190   216   219   Class java/security/NoSuchProviderException
         190   216   219   Class javax/crypto/NoSuchPaddingException
         190   216   219   Class java/security/InvalidKeyException

  private boolean decryptData(javax.crypto.SecretKey, org.apache.pulsar.common.api.proto.MessageMetadata, java.nio.ByteBuffer, java.nio.ByteBuffer);
    Code:
       0: aload_0
       1: aload_2
       2: invokevirtual #177                // Method org/apache/pulsar/common/api/proto/MessageMetadata.getEncryptionParam:()[B
       5: putfield      #3                  // Field iv:[B
       8: new           #149                // class javax/crypto/spec/GCMParameterSpec
      11: dup
      12: sipush        128
      15: aload_0
      16: getfield      #3                  // Field iv:[B
      19: invokespecial #150                // Method javax/crypto/spec/GCMParameterSpec."<init>":(I[B)V
      22: astore        5
      24: aload_0
      25: getfield      #22                 // Field cipher:Ljavax/crypto/Cipher;
      28: iconst_2
      29: aload_1
      30: aload         5
      32: invokevirtual #152                // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
      35: aload_0
      36: getfield      #22                 // Field cipher:Ljavax/crypto/Cipher;
      39: aload_3
      40: invokevirtual #153                // Method java/nio/ByteBuffer.remaining:()I
      43: invokevirtual #154                // Method javax/crypto/Cipher.getOutputSize:(I)I
      46: istore        6
      48: aload         4
      50: invokevirtual #153                // Method java/nio/ByteBuffer.remaining:()I
      53: iload         6
      55: if_icmpge     68
      58: new           #155                // class java/lang/IllegalArgumentException
      61: dup
      62: ldc           #178                // String Target buffer size is too small
      64: invokespecial #157                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      67: athrow
      68: aload_0
      69: getfield      #22                 // Field cipher:Ljavax/crypto/Cipher;
      72: aload_3
      73: aload         4
      75: invokevirtual #158                // Method javax/crypto/Cipher.doFinal:(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)I
      78: istore        7
      80: aload         4
      82: invokevirtual #138                // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
      85: pop
      86: aload         4
      88: iload         7
      90: invokevirtual #159                // Method java/nio/ByteBuffer.limit:(I)Ljava/nio/Buffer;
      93: pop
      94: iconst_1
      95: ireturn
      96: astore        6
      98: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
     101: ldc           #179                // String {} Failed to decrypt message {}
     103: aload_0
     104: getfield      #4                  // Field logCtx:Ljava/lang/String;
     107: aload         6
     109: invokevirtual #41                 // Method java/security/GeneralSecurityException.getMessage:()Ljava/lang/String;
     112: invokeinterface #42,  4           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     117: iconst_0
     118: ireturn
    Exception table:
       from    to  target type
          24    95    96   Class java/security/InvalidKeyException
          24    95    96   Class java/security/InvalidAlgorithmParameterException
          24    95    96   Class javax/crypto/IllegalBlockSizeException
          24    95    96   Class javax/crypto/BadPaddingException
          24    95    96   Class javax/crypto/ShortBufferException

  public int getMaxOutputSize(int);
    Code:
       0: iload_1
       1: iload_1
       2: sipush        512
       5: invokestatic  #180                // Method java/lang/Math.max:(II)I
       8: iadd
       9: ireturn

  private boolean getKeyAndDecryptData(org.apache.pulsar.common.api.proto.MessageMetadata, java.nio.ByteBuffer, java.nio.ByteBuffer);
    Code:
       0: aload_1
       1: invokevirtual #181                // Method org/apache/pulsar/common/api/proto/MessageMetadata.getEncryptionKeysList:()Ljava/util/List;
       4: astore        4
       6: iconst_0
       7: istore        5
       9: iload         5
      11: aload         4
      13: invokeinterface #182,  1          // InterfaceMethod java/util/List.size:()I
      18: if_icmpge     107
      21: aload         4
      23: iload         5
      25: invokeinterface #183,  2          // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      30: checkcast     #184                // class org/apache/pulsar/common/api/proto/EncryptionKeys
      33: invokevirtual #185                // Method org/apache/pulsar/common/api/proto/EncryptionKeys.getValue:()[B
      36: astore        6
      38: aload_0
      39: getfield      #25                 // Field digest:Ljava/security/MessageDigest;
      42: aload         6
      44: invokevirtual #172                // Method java/security/MessageDigest.digest:([B)[B
      47: astore        7
      49: aload_0
      50: getfield      #16                 // Field dataKeyCache:Lcom/google/common/cache/LoadingCache;
      53: aload         7
      55: invokestatic  #175                // Method java/nio/ByteBuffer.wrap:([B)Ljava/nio/ByteBuffer;
      58: invokeinterface #186,  2          // InterfaceMethod com/google/common/cache/LoadingCache.getIfPresent:(Ljava/lang/Object;)Ljava/lang/Object;
      63: checkcast     #187                // class javax/crypto/SecretKey
      66: astore        8
      68: aload         8
      70: ifnull        87
      73: aload_0
      74: aload         8
      76: aload_1
      77: aload_2
      78: aload_3
      79: invokespecial #188                // Method decryptData:(Ljavax/crypto/SecretKey;Lorg/apache/pulsar/common/api/proto/MessageMetadata;Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Z
      82: ifeq          101
      85: iconst_1
      86: ireturn
      87: getstatic     #31                 // Field log:Lorg/slf4j/Logger;
      90: ldc           #189                // String {} Failed to decrypt data or data key is not in cache. Will attempt to refresh
      92: aload_0
      93: getfield      #4                  // Field logCtx:Ljava/lang/String;
      96: invokeinterface #190,  3          // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
     101: iinc          5, 1
     104: goto          9
     107: iconst_0
     108: ireturn

  public boolean decrypt(java.util.function.Supplier<org.apache.pulsar.common.api.proto.MessageMetadata>, java.nio.ByteBuffer, java.nio.ByteBuffer, org.apache.pulsar.client.api.CryptoKeyReader);
    Code:
       0: aload_1
       1: invokeinterface #134,  1          // InterfaceMethod java/util/function/Supplier.get:()Ljava/lang/Object;
       6: checkcast     #135                // class org/apache/pulsar/common/api/proto/MessageMetadata
       9: astore        5
      11: aload_0
      12: getfield      #26                 // Field dataKey:Ljavax/crypto/SecretKey;
      15: ifnull        31
      18: aload_0
      19: aload         5
      21: aload_2
      22: aload_3
      23: invokespecial #191                // Method getKeyAndDecryptData:(Lorg/apache/pulsar/common/api/proto/MessageMetadata;Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Z
      26: ifeq          31
      29: iconst_1
      30: ireturn
      31: aload         5
      33: invokevirtual #181                // Method org/apache/pulsar/common/api/proto/MessageMetadata.getEncryptionKeysList:()Ljava/util/List;
      36: astore        6
      38: aload         6
      40: invokeinterface #192,  1          // InterfaceMethod java/util/List.stream:()Ljava/util/stream/Stream;
      45: aload_0
      46: aload         4
      48: invokedynamic #193,  0            // InvokeDynamic #2:test:(Lorg/apache/pulsar/client/impl/crypto/MessageCryptoBc;Lorg/apache/pulsar/client/api/CryptoKeyReader;)Ljava/util/function/Predicate;
      53: invokeinterface #194,  2          // InterfaceMethod java/util/stream/Stream.filter:(Ljava/util/function/Predicate;)Ljava/util/stream/Stream;
      58: invokeinterface #195,  1          // InterfaceMethod java/util/stream/Stream.findFirst:()Ljava/util/Optional;
      63: aconst_null
      64: invokevirtual #196                // Method java/util/Optional.orElse:(Ljava/lang/Object;)Ljava/lang/Object;
      67: checkcast     #184                // class org/apache/pulsar/common/api/proto/EncryptionKeys
      70: astore        7
      72: aload         7
      74: ifnull        84
      77: aload_0
      78: getfield      #26                 // Field dataKey:Ljavax/crypto/SecretKey;
      81: ifnonnull     86
      84: iconst_0
      85: ireturn
      86: aload_0
      87: aload         5
      89: aload_2
      90: aload_3
      91: invokespecial #191                // Method getKeyAndDecryptData:(Lorg/apache/pulsar/common/api/proto/MessageMetadata;Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Z
      94: ireturn

  private boolean lambda$decrypt$2(org.apache.pulsar.client.api.CryptoKeyReader, org.apache.pulsar.common.api.proto.EncryptionKeys);
    Code:
       0: aload_2
       1: invokevirtual #185                // Method org/apache/pulsar/common/api/proto/EncryptionKeys.getValue:()[B
       4: astore_3
       5: aload_2
       6: invokevirtual #197                // Method org/apache/pulsar/common/api/proto/EncryptionKeys.getMetadatasList:()Ljava/util/List;
       9: astore        4
      11: aload_0
      12: aload_2
      13: invokevirtual #198                // Method org/apache/pulsar/common/api/proto/EncryptionKeys.getKey:()Ljava/lang/String;
      16: aload_3
      17: aload         4
      19: aload_1
      20: invokespecial #199                // Method decryptDataKey:(Ljava/lang/String;[BLjava/util/List;Lorg/apache/pulsar/client/api/CryptoKeyReader;)Z
      23: ireturn

  private static void lambda$decryptDataKey$1(java.util.Map, org.apache.pulsar.common.api.proto.KeyValue);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #200                // Method org/apache/pulsar/common/api/proto/KeyValue.getKey:()Ljava/lang/String;
       5: aload_1
       6: invokevirtual #201                // Method org/apache/pulsar/common/api/proto/KeyValue.getValue:()Ljava/lang/String;
       9: invokeinterface #202,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      14: pop
      15: return

  private static void lambda$encrypt$0(org.apache.pulsar.common.api.proto.EncryptionKeys, java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: invokevirtual #203                // Method org/apache/pulsar/common/api/proto/EncryptionKeys.addMetadata:()Lorg/apache/pulsar/common/api/proto/KeyValue;
       4: aload_1
       5: invokevirtual #204                // Method org/apache/pulsar/common/api/proto/KeyValue.setKey:(Ljava/lang/String;)Lorg/apache/pulsar/common/api/proto/KeyValue;
       8: aload_2
       9: invokevirtual #205                // Method org/apache/pulsar/common/api/proto/KeyValue.setValue:(Ljava/lang/String;)Lorg/apache/pulsar/common/api/proto/KeyValue;
      12: pop
      13: return

  static {};
    Code:
       0: ldc           #17                 // class org/apache/pulsar/client/impl/crypto/MessageCryptoBc
       2: invokestatic  #206                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #31                 // Field log:Lorg/slf4j/Logger;
       8: aconst_null
       9: astore_0
      10: ldc           #207                // String NativePRNGNonBlocking
      12: invokestatic  #208                // Method java/security/SecureRandom.getInstance:(Ljava/lang/String;)Ljava/security/SecureRandom;
      15: astore_0
      16: goto          28
      19: astore_1
      20: new           #209                // class java/security/SecureRandom
      23: dup
      24: invokespecial #210                // Method java/security/SecureRandom."<init>":()V
      27: astore_0
      28: aload_0
      29: putstatic     #35                 // Field secureRandom:Ljava/security/SecureRandom;
      32: getstatic     #35                 // Field secureRandom:Ljava/security/SecureRandom;
      35: bipush        12
      37: newarray       byte
      39: invokevirtual #148                // Method java/security/SecureRandom.nextBytes:([B)V
      42: ldc           #20                 // String BC
      44: invokestatic  #211                // Method java/security/Security.getProvider:(Ljava/lang/String;)Ljava/security/Provider;
      47: ifnonnull     61
      50: new           #19                 // class org/bouncycastle/jce/provider/BouncyCastleProvider
      53: dup
      54: invokespecial #212                // Method org/bouncycastle/jce/provider/BouncyCastleProvider."<init>":()V
      57: invokestatic  #213                // Method java/security/Security.addProvider:(Ljava/security/Provider;)I
      60: pop
      61: return
    Exception table:
       from    to  target type
          10    16    19   Class java/security/NoSuchAlgorithmException
}
