Compiled from "OpenSSLECDHKeyAgreement.java"
public final class org.conscrypt.OpenSSLECDHKeyAgreement extends javax.crypto.KeyAgreementSpi {
  private org.conscrypt.OpenSSLKey mOpenSslPrivateKey;

  private int mExpectedResultLength;

  private byte[] mResult;

  public org.conscrypt.OpenSSLECDHKeyAgreement();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method javax/crypto/KeyAgreementSpi."<init>":()V
       4: return

  public java.security.Key engineDoPhase(java.security.Key, boolean) throws java.security.InvalidKeyException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field mOpenSslPrivateKey:Lorg/conscrypt/OpenSSLKey;
       4: ifnonnull     17
       7: new           #3                  // class java/lang/IllegalStateException
      10: dup
      11: ldc           #4                  // String Not initialized
      13: invokespecial #5                  // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: iload_2
      18: ifne          31
      21: new           #3                  // class java/lang/IllegalStateException
      24: dup
      25: ldc           #6                  // String ECDH only has one phase
      27: invokespecial #5                  // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      30: athrow
      31: aload_1
      32: ifnonnull     45
      35: new           #7                  // class java/security/InvalidKeyException
      38: dup
      39: ldc           #8                  // String key == null
      41: invokespecial #9                  // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      44: athrow
      45: aload_1
      46: instanceof    #10                 // class java/security/PublicKey
      49: ifne          82
      52: new           #7                  // class java/security/InvalidKeyException
      55: dup
      56: new           #11                 // class java/lang/StringBuilder
      59: dup
      60: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      63: ldc           #13                 // String Not a public key:
      65: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      68: aload_1
      69: invokevirtual #15                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      72: invokevirtual #16                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      75: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      78: invokespecial #9                  // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      81: athrow
      82: aload_1
      83: checkcast     #10                 // class java/security/PublicKey
      86: invokestatic  #18                 // Method org/conscrypt/OpenSSLKey.fromPublicKey:(Ljava/security/PublicKey;)Lorg/conscrypt/OpenSSLKey;
      89: astore_3
      90: aload_0
      91: getfield      #19                 // Field mExpectedResultLength:I
      94: newarray       byte
      96: astore        4
      98: aload         4
     100: iconst_0
     101: aload_3
     102: invokevirtual #20                 // Method org/conscrypt/OpenSSLKey.getNativeRef:()Lorg/conscrypt/NativeRef$EVP_PKEY;
     105: aload_0
     106: getfield      #2                  // Field mOpenSslPrivateKey:Lorg/conscrypt/OpenSSLKey;
     109: invokevirtual #20                 // Method org/conscrypt/OpenSSLKey.getNativeRef:()Lorg/conscrypt/NativeRef$EVP_PKEY;
     112: invokestatic  #21                 // Method org/conscrypt/NativeCrypto.ECDH_compute_key:([BILorg/conscrypt/NativeRef$EVP_PKEY;Lorg/conscrypt/NativeRef$EVP_PKEY;)I
     115: istore        5
     117: iload         5
     119: iconst_m1
     120: if_icmpne     151
     123: new           #22                 // class java/lang/RuntimeException
     126: dup
     127: new           #11                 // class java/lang/StringBuilder
     130: dup
     131: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
     134: ldc           #23                 // String Engine returned
     136: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     139: iload         5
     141: invokevirtual #24                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     144: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     147: invokespecial #25                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
     150: athrow
     151: iload         5
     153: aload_0
     154: getfield      #19                 // Field mExpectedResultLength:I
     157: if_icmpne     167
     160: aload         4
     162: astore        6
     164: goto          241
     167: iload         5
     169: aload_0
     170: getfield      #19                 // Field mExpectedResultLength:I
     173: if_icmpge     201
     176: iload         5
     178: newarray       byte
     180: astore        6
     182: aload         4
     184: iconst_0
     185: aload_0
     186: getfield      #26                 // Field mResult:[B
     189: iconst_0
     190: aload_0
     191: getfield      #26                 // Field mResult:[B
     194: arraylength
     195: invokestatic  #27                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     198: goto          241
     201: new           #22                 // class java/lang/RuntimeException
     204: dup
     205: new           #11                 // class java/lang/StringBuilder
     208: dup
     209: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
     212: ldc           #28                 // String Engine produced a longer than expected result. Expected:
     214: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     217: aload_0
     218: getfield      #19                 // Field mExpectedResultLength:I
     221: invokevirtual #24                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     224: ldc           #29                 // String , actual:
     226: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     229: iload         5
     231: invokevirtual #24                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     234: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     237: invokespecial #25                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
     240: athrow
     241: aload_0
     242: aload         6
     244: putfield      #26                 // Field mResult:[B
     247: aconst_null
     248: areturn

  protected int engineGenerateSecret(byte[], int) throws javax.crypto.ShortBufferException;
    Code:
       0: aload_0
       1: invokespecial #30                 // Method checkCompleted:()V
       4: aload_1
       5: arraylength
       6: iload_2
       7: isub
       8: istore_3
       9: aload_0
      10: getfield      #26                 // Field mResult:[B
      13: arraylength
      14: iload_3
      15: if_icmple     58
      18: new           #31                 // class org/conscrypt/ShortBufferWithoutStackTraceException
      21: dup
      22: new           #11                 // class java/lang/StringBuilder
      25: dup
      26: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      29: ldc           #32                 // String Needed:
      31: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      34: aload_0
      35: getfield      #26                 // Field mResult:[B
      38: arraylength
      39: invokevirtual #24                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      42: ldc           #33                 // String , available:
      44: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      47: iload_3
      48: invokevirtual #24                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      51: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      54: invokespecial #34                 // Method org/conscrypt/ShortBufferWithoutStackTraceException."<init>":(Ljava/lang/String;)V
      57: athrow
      58: aload_0
      59: getfield      #26                 // Field mResult:[B
      62: iconst_0
      63: aload_1
      64: iload_2
      65: aload_0
      66: getfield      #26                 // Field mResult:[B
      69: arraylength
      70: invokestatic  #27                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      73: aload_0
      74: getfield      #26                 // Field mResult:[B
      77: arraylength
      78: ireturn

  protected byte[] engineGenerateSecret();
    Code:
       0: aload_0
       1: invokespecial #30                 // Method checkCompleted:()V
       4: aload_0
       5: getfield      #26                 // Field mResult:[B
       8: areturn

  protected javax.crypto.SecretKey engineGenerateSecret(java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #30                 // Method checkCompleted:()V
       4: new           #35                 // class javax/crypto/spec/SecretKeySpec
       7: dup
       8: aload_0
       9: invokevirtual #36                 // Method engineGenerateSecret:()[B
      12: aload_1
      13: invokespecial #37                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      16: areturn

  protected void engineInit(java.security.Key, java.security.SecureRandom) throws java.security.InvalidKeyException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #7                  // class java/security/InvalidKeyException
       7: dup
       8: ldc           #8                  // String key == null
      10: invokespecial #9                  // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      13: athrow
      14: aload_1
      15: instanceof    #38                 // class java/security/PrivateKey
      18: ifne          51
      21: new           #7                  // class java/security/InvalidKeyException
      24: dup
      25: new           #11                 // class java/lang/StringBuilder
      28: dup
      29: invokespecial #12                 // Method java/lang/StringBuilder."<init>":()V
      32: ldc           #39                 // String Not a private key:
      34: invokevirtual #14                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      37: aload_1
      38: invokevirtual #15                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      41: invokevirtual #16                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      44: invokevirtual #17                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      47: invokespecial #9                  // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      50: athrow
      51: aload_1
      52: checkcast     #38                 // class java/security/PrivateKey
      55: invokestatic  #40                 // Method org/conscrypt/OpenSSLKey.fromPrivateKey:(Ljava/security/PrivateKey;)Lorg/conscrypt/OpenSSLKey;
      58: astore_3
      59: new           #41                 // class org/conscrypt/NativeRef$EC_GROUP
      62: dup
      63: aload_3
      64: invokevirtual #20                 // Method org/conscrypt/OpenSSLKey.getNativeRef:()Lorg/conscrypt/NativeRef$EVP_PKEY;
      67: invokestatic  #42                 // Method org/conscrypt/NativeCrypto.EC_KEY_get1_group:(Lorg/conscrypt/NativeRef$EVP_PKEY;)J
      70: invokespecial #43                 // Method org/conscrypt/NativeRef$EC_GROUP."<init>":(J)V
      73: invokestatic  #44                 // Method org/conscrypt/NativeCrypto.EC_GROUP_get_degree:(Lorg/conscrypt/NativeRef$EC_GROUP;)I
      76: istore        4
      78: aload_0
      79: iload         4
      81: bipush        7
      83: iadd
      84: bipush        8
      86: idiv
      87: putfield      #19                 // Field mExpectedResultLength:I
      90: aload_0
      91: aload_3
      92: putfield      #2                  // Field mOpenSslPrivateKey:Lorg/conscrypt/OpenSSLKey;
      95: return

  protected void engineInit(java.security.Key, java.security.spec.AlgorithmParameterSpec, java.security.SecureRandom) throws java.security.InvalidKeyException, java.security.InvalidAlgorithmParameterException;
    Code:
       0: aload_2
       1: ifnull        14
       4: new           #45                 // class java/security/InvalidAlgorithmParameterException
       7: dup
       8: ldc           #46                 // String No algorithm parameters supported
      10: invokespecial #47                 // Method java/security/InvalidAlgorithmParameterException."<init>":(Ljava/lang/String;)V
      13: athrow
      14: aload_0
      15: aload_1
      16: aload_3
      17: invokevirtual #48                 // Method engineInit:(Ljava/security/Key;Ljava/security/SecureRandom;)V
      20: return

  private void checkCompleted();
    Code:
       0: aload_0
       1: getfield      #26                 // Field mResult:[B
       4: ifnonnull     17
       7: new           #3                  // class java/lang/IllegalStateException
      10: dup
      11: ldc           #49                 // String Key agreement not completed
      13: invokespecial #5                  // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: return
}
