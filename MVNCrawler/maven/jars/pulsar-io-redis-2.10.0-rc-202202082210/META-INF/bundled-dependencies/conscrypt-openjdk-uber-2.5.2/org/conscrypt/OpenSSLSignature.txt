Compiled from "OpenSSLSignature.java"
public class org.conscrypt.OpenSSLSignature extends java.security.SignatureSpi {
  private org.conscrypt.NativeRef$EVP_MD_CTX ctx;

  private org.conscrypt.OpenSSLKey key;

  private final org.conscrypt.OpenSSLSignature$EngineType engineType;

  private final long evpMdRef;

  private final byte[] singleByte;

  private boolean signing;

  private long evpPkeyCtx;

  private org.conscrypt.OpenSSLSignature(long, org.conscrypt.OpenSSLSignature$EngineType);
    Code:
       0: aload_0
       1: invokespecial #2                  // Method java/security/SignatureSpi."<init>":()V
       4: aload_0
       5: iconst_1
       6: newarray       byte
       8: putfield      #3                  // Field singleByte:[B
      11: aload_0
      12: aload_3
      13: putfield      #4                  // Field engineType:Lorg/conscrypt/OpenSSLSignature$EngineType;
      16: aload_0
      17: lload_1
      18: putfield      #5                  // Field evpMdRef:J
      21: return

  private void resetContext() throws java.security.InvalidAlgorithmParameterException;
    Code:
       0: new           #6                  // class org/conscrypt/NativeRef$EVP_MD_CTX
       3: dup
       4: invokestatic  #7                  // Method org/conscrypt/NativeCrypto.EVP_MD_CTX_create:()J
       7: invokespecial #8                  // Method org/conscrypt/NativeRef$EVP_MD_CTX."<init>":(J)V
      10: astore_1
      11: aload_0
      12: getfield      #9                  // Field signing:Z
      15: ifeq          40
      18: aload_0
      19: aload_1
      20: aload_0
      21: getfield      #5                  // Field evpMdRef:J
      24: aload_0
      25: getfield      #10                 // Field key:Lorg/conscrypt/OpenSSLKey;
      28: invokevirtual #11                 // Method org/conscrypt/OpenSSLKey.getNativeRef:()Lorg/conscrypt/NativeRef$EVP_PKEY;
      31: invokestatic  #12                 // Method org/conscrypt/NativeCrypto.EVP_DigestSignInit:(Lorg/conscrypt/NativeRef$EVP_MD_CTX;JLorg/conscrypt/NativeRef$EVP_PKEY;)J
      34: putfield      #13                 // Field evpPkeyCtx:J
      37: goto          59
      40: aload_0
      41: aload_1
      42: aload_0
      43: getfield      #5                  // Field evpMdRef:J
      46: aload_0
      47: getfield      #10                 // Field key:Lorg/conscrypt/OpenSSLKey;
      50: invokevirtual #11                 // Method org/conscrypt/OpenSSLKey.getNativeRef:()Lorg/conscrypt/NativeRef$EVP_PKEY;
      53: invokestatic  #14                 // Method org/conscrypt/NativeCrypto.EVP_DigestVerifyInit:(Lorg/conscrypt/NativeRef$EVP_MD_CTX;JLorg/conscrypt/NativeRef$EVP_PKEY;)J
      56: putfield      #13                 // Field evpPkeyCtx:J
      59: aload_0
      60: aload_0
      61: getfield      #13                 // Field evpPkeyCtx:J
      64: invokevirtual #15                 // Method configureEVP_PKEY_CTX:(J)V
      67: aload_0
      68: aload_1
      69: putfield      #16                 // Field ctx:Lorg/conscrypt/NativeRef$EVP_MD_CTX;
      72: return

  protected void configureEVP_PKEY_CTX(long) throws java.security.InvalidAlgorithmParameterException;
    Code:
       0: return

  protected void engineUpdate(byte);
    Code:
       0: aload_0
       1: getfield      #3                  // Field singleByte:[B
       4: iconst_0
       5: iload_1
       6: bastore
       7: aload_0
       8: aload_0
       9: getfield      #3                  // Field singleByte:[B
      12: iconst_0
      13: iconst_1
      14: invokevirtual #17                 // Method engineUpdate:([BII)V
      17: return

  protected void engineUpdate(byte[], int, int);
    Code:
       0: aload_0
       1: getfield      #16                 // Field ctx:Lorg/conscrypt/NativeRef$EVP_MD_CTX;
       4: astore        4
       6: aload_0
       7: getfield      #9                  // Field signing:Z
      10: ifeq          24
      13: aload         4
      15: aload_1
      16: iload_2
      17: iload_3
      18: invokestatic  #18                 // Method org/conscrypt/NativeCrypto.EVP_DigestSignUpdate:(Lorg/conscrypt/NativeRef$EVP_MD_CTX;[BII)V
      21: goto          32
      24: aload         4
      26: aload_1
      27: iload_2
      28: iload_3
      29: invokestatic  #19                 // Method org/conscrypt/NativeCrypto.EVP_DigestVerifyUpdate:(Lorg/conscrypt/NativeRef$EVP_MD_CTX;[BII)V
      32: return

  protected void engineUpdate(java.nio.ByteBuffer);
    Code:
       0: aload_1
       1: invokevirtual #20                 // Method java/nio/ByteBuffer.hasRemaining:()Z
       4: ifne          8
       7: return
       8: aload_1
       9: invokevirtual #21                 // Method java/nio/ByteBuffer.isDirect:()Z
      12: ifne          21
      15: aload_0
      16: aload_1
      17: invokespecial #22                 // Method java/security/SignatureSpi.engineUpdate:(Ljava/nio/ByteBuffer;)V
      20: return
      21: aload_1
      22: invokestatic  #23                 // Method org/conscrypt/NativeCrypto.getDirectBufferAddress:(Ljava/nio/Buffer;)J
      25: lstore_2
      26: lload_2
      27: lconst_0
      28: lcmp
      29: ifne          38
      32: aload_0
      33: aload_1
      34: invokespecial #22                 // Method java/security/SignatureSpi.engineUpdate:(Ljava/nio/ByteBuffer;)V
      37: return
      38: aload_1
      39: invokevirtual #24                 // Method java/nio/ByteBuffer.position:()I
      42: istore        4
      44: iload         4
      46: ifge          59
      49: new           #25                 // class java/lang/RuntimeException
      52: dup
      53: ldc           #26                 // String Negative position
      55: invokespecial #27                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
      58: athrow
      59: lload_2
      60: iload         4
      62: i2l
      63: ladd
      64: lstore        5
      66: aload_1
      67: invokevirtual #28                 // Method java/nio/ByteBuffer.remaining:()I
      70: istore        7
      72: iload         7
      74: ifge          87
      77: new           #25                 // class java/lang/RuntimeException
      80: dup
      81: ldc           #29                 // String Negative remaining amount
      83: invokespecial #27                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
      86: athrow
      87: aload_0
      88: getfield      #16                 // Field ctx:Lorg/conscrypt/NativeRef$EVP_MD_CTX;
      91: astore        8
      93: aload_0
      94: getfield      #9                  // Field signing:Z
      97: ifeq          112
     100: aload         8
     102: lload         5
     104: iload         7
     106: invokestatic  #30                 // Method org/conscrypt/NativeCrypto.EVP_DigestSignUpdateDirect:(Lorg/conscrypt/NativeRef$EVP_MD_CTX;JI)V
     109: goto          121
     112: aload         8
     114: lload         5
     116: iload         7
     118: invokestatic  #31                 // Method org/conscrypt/NativeCrypto.EVP_DigestVerifyUpdateDirect:(Lorg/conscrypt/NativeRef$EVP_MD_CTX;JI)V
     121: aload_1
     122: iload         4
     124: iload         7
     126: iadd
     127: invokevirtual #32                 // Method java/nio/ByteBuffer.position:(I)Ljava/nio/Buffer;
     130: pop
     131: return

  protected java.lang.Object engineGetParameter(java.lang.String) throws java.security.InvalidParameterException;
    Code:
       0: aconst_null
       1: areturn

  private void checkEngineType(org.conscrypt.OpenSSLKey) throws java.security.InvalidKeyException;
    Code:
       0: aload_1
       1: invokevirtual #11                 // Method org/conscrypt/OpenSSLKey.getNativeRef:()Lorg/conscrypt/NativeRef$EVP_PKEY;
       4: invokestatic  #33                 // Method org/conscrypt/NativeCrypto.EVP_PKEY_type:(Lorg/conscrypt/NativeRef$EVP_PKEY;)I
       7: istore_2
       8: getstatic     #34                 // Field org/conscrypt/OpenSSLSignature$1.$SwitchMap$org$conscrypt$OpenSSLSignature$EngineType:[I
      11: aload_0
      12: getfield      #4                  // Field engineType:Lorg/conscrypt/OpenSSLSignature$EngineType;
      15: invokevirtual #35                 // Method org/conscrypt/OpenSSLSignature$EngineType.ordinal:()I
      18: iaload
      19: lookupswitch  { // 2
                     1: 44
                     2: 85
               default: 127
          }
      44: iload_2
      45: bipush        6
      47: if_icmpeq     157
      50: new           #37                 // class java/security/InvalidKeyException
      53: dup
      54: new           #38                 // class java/lang/StringBuilder
      57: dup
      58: invokespecial #39                 // Method java/lang/StringBuilder."<init>":()V
      61: ldc           #40                 // String Signature initialized as
      63: invokevirtual #41                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      66: aload_0
      67: getfield      #4                  // Field engineType:Lorg/conscrypt/OpenSSLSignature$EngineType;
      70: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      73: ldc           #43                 // String  (not RSA)
      75: invokevirtual #41                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      78: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      81: invokespecial #45                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      84: athrow
      85: iload_2
      86: sipush        408
      89: if_icmpeq     157
      92: new           #37                 // class java/security/InvalidKeyException
      95: dup
      96: new           #38                 // class java/lang/StringBuilder
      99: dup
     100: invokespecial #39                 // Method java/lang/StringBuilder."<init>":()V
     103: ldc           #40                 // String Signature initialized as
     105: invokevirtual #41                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     108: aload_0
     109: getfield      #4                  // Field engineType:Lorg/conscrypt/OpenSSLSignature$EngineType;
     112: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     115: ldc           #46                 // String  (not EC)
     117: invokevirtual #41                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     120: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     123: invokespecial #45                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     126: athrow
     127: new           #37                 // class java/security/InvalidKeyException
     130: dup
     131: new           #38                 // class java/lang/StringBuilder
     134: dup
     135: invokespecial #39                 // Method java/lang/StringBuilder."<init>":()V
     138: ldc           #47                 // String Key must be of type
     140: invokevirtual #41                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     143: aload_0
     144: getfield      #4                  // Field engineType:Lorg/conscrypt/OpenSSLSignature$EngineType;
     147: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     150: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     153: invokespecial #45                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     156: athrow
     157: return

  private void initInternal(org.conscrypt.OpenSSLKey, boolean) throws java.security.InvalidKeyException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #48                 // Method checkEngineType:(Lorg/conscrypt/OpenSSLKey;)V
       5: aload_0
       6: aload_1
       7: putfield      #10                 // Field key:Lorg/conscrypt/OpenSSLKey;
      10: aload_0
      11: iload_2
      12: putfield      #9                  // Field signing:Z
      15: aload_0
      16: invokespecial #49                 // Method resetContext:()V
      19: goto          32
      22: astore_3
      23: new           #37                 // class java/security/InvalidKeyException
      26: dup
      27: aload_3
      28: invokespecial #51                 // Method java/security/InvalidKeyException."<init>":(Ljava/lang/Throwable;)V
      31: athrow
      32: return
    Exception table:
       from    to  target type
          15    19    22   Class java/security/InvalidAlgorithmParameterException

  protected void engineInitSign(java.security.PrivateKey) throws java.security.InvalidKeyException;
    Code:
       0: aload_0
       1: aload_1
       2: invokestatic  #52                 // Method org/conscrypt/OpenSSLKey.fromPrivateKey:(Ljava/security/PrivateKey;)Lorg/conscrypt/OpenSSLKey;
       5: iconst_1
       6: invokespecial #53                 // Method initInternal:(Lorg/conscrypt/OpenSSLKey;Z)V
       9: return

  protected void engineInitVerify(java.security.PublicKey) throws java.security.InvalidKeyException;
    Code:
       0: aload_0
       1: aload_1
       2: invokestatic  #54                 // Method org/conscrypt/OpenSSLKey.fromPublicKey:(Ljava/security/PublicKey;)Lorg/conscrypt/OpenSSLKey;
       5: iconst_0
       6: invokespecial #53                 // Method initInternal:(Lorg/conscrypt/OpenSSLKey;Z)V
       9: return

  protected void engineSetParameter(java.lang.String, java.lang.Object) throws java.security.InvalidParameterException;
    Code:
       0: return

  protected byte[] engineSign() throws java.security.SignatureException;
    Code:
       0: aload_0
       1: getfield      #16                 // Field ctx:Lorg/conscrypt/NativeRef$EVP_MD_CTX;
       4: astore_1
       5: aload_1
       6: invokestatic  #55                 // Method org/conscrypt/NativeCrypto.EVP_DigestSignFinal:(Lorg/conscrypt/NativeRef$EVP_MD_CTX;)[B
       9: astore_2
      10: aload_0
      11: invokespecial #49                 // Method resetContext:()V
      14: goto          28
      17: astore_3
      18: new           #56                 // class java/lang/AssertionError
      21: dup
      22: ldc           #57                 // String Reset of context failed after it was successful once
      24: invokespecial #58                 // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      27: athrow
      28: aload_2
      29: areturn
      30: astore_2
      31: new           #60                 // class java/security/SignatureException
      34: dup
      35: aload_2
      36: invokespecial #61                 // Method java/security/SignatureException."<init>":(Ljava/lang/Throwable;)V
      39: athrow
      40: astore        4
      42: aload_0
      43: invokespecial #49                 // Method resetContext:()V
      46: goto          61
      49: astore        5
      51: new           #56                 // class java/lang/AssertionError
      54: dup
      55: ldc           #57                 // String Reset of context failed after it was successful once
      57: invokespecial #58                 // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      60: athrow
      61: aload         4
      63: athrow
    Exception table:
       from    to  target type
          10    14    17   Class java/security/InvalidAlgorithmParameterException
           5    10    30   Class java/lang/Exception
           5    10    40   any
          42    46    49   Class java/security/InvalidAlgorithmParameterException
          30    42    40   any

  protected boolean engineVerify(byte[]) throws java.security.SignatureException;
    Code:
       0: aload_0
       1: getfield      #16                 // Field ctx:Lorg/conscrypt/NativeRef$EVP_MD_CTX;
       4: astore_2
       5: aload_2
       6: aload_1
       7: iconst_0
       8: aload_1
       9: arraylength
      10: invokestatic  #62                 // Method org/conscrypt/NativeCrypto.EVP_DigestVerifyFinal:(Lorg/conscrypt/NativeRef$EVP_MD_CTX;[BII)Z
      13: istore_3
      14: aload_0
      15: invokespecial #49                 // Method resetContext:()V
      18: goto          33
      21: astore        4
      23: new           #56                 // class java/lang/AssertionError
      26: dup
      27: ldc           #57                 // String Reset of context failed after it was successful once
      29: invokespecial #58                 // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      32: athrow
      33: iload_3
      34: ireturn
      35: astore_3
      36: new           #60                 // class java/security/SignatureException
      39: dup
      40: aload_3
      41: invokespecial #61                 // Method java/security/SignatureException."<init>":(Ljava/lang/Throwable;)V
      44: athrow
      45: astore        5
      47: aload_0
      48: invokespecial #49                 // Method resetContext:()V
      51: goto          66
      54: astore        6
      56: new           #56                 // class java/lang/AssertionError
      59: dup
      60: ldc           #57                 // String Reset of context failed after it was successful once
      62: invokespecial #58                 // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      65: athrow
      66: aload         5
      68: athrow
    Exception table:
       from    to  target type
          14    18    21   Class java/security/InvalidAlgorithmParameterException
           5    14    35   Class java/lang/Exception
           5    14    45   any
          47    51    54   Class java/security/InvalidAlgorithmParameterException
          35    47    45   any

  protected final long getEVP_PKEY_CTX();
    Code:
       0: aload_0
       1: getfield      #13                 // Field evpPkeyCtx:J
       4: lreturn

  org.conscrypt.OpenSSLSignature(long, org.conscrypt.OpenSSLSignature$EngineType, org.conscrypt.OpenSSLSignature$1);
    Code:
       0: aload_0
       1: lload_1
       2: aload_3
       3: invokespecial #1                  // Method "<init>":(JLorg/conscrypt/OpenSSLSignature$EngineType;)V
       6: return
}
