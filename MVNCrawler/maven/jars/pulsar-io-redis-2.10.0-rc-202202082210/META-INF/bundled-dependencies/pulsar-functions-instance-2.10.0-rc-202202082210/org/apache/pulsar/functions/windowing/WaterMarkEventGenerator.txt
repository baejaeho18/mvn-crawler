Compiled from "WaterMarkEventGenerator.java"
public class org.apache.pulsar.functions.windowing.WaterMarkEventGenerator<T> implements java.lang.Runnable {
  private static final org.slf4j.Logger log;

  private final org.apache.pulsar.functions.windowing.WindowManager<T> windowManager;

  private final long eventTsLagMs;

  private final java.util.Set<java.lang.String> inputTopics;

  private final java.util.Map<java.lang.String, java.lang.Long> topicToTs;

  private final java.util.concurrent.ScheduledExecutorService executorService;

  private final long intervalMs;

  private java.util.concurrent.ScheduledFuture<?> executorFuture;

  private volatile long lastWaterMarkTs;

  private org.apache.pulsar.functions.api.Context context;

  public org.apache.pulsar.functions.windowing.WaterMarkEventGenerator(org.apache.pulsar.functions.windowing.WindowManager<T>, long, long, java.util.Set<java.lang.String>, org.apache.pulsar.functions.api.Context);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field windowManager:Lorg/apache/pulsar/functions/windowing/WindowManager;
       9: aload_0
      10: new           #3                  // class java/util/concurrent/ConcurrentHashMap
      13: dup
      14: invokespecial #4                  // Method java/util/concurrent/ConcurrentHashMap."<init>":()V
      17: putfield      #5                  // Field topicToTs:Ljava/util/Map;
      20: new           #6                  // class com/google/common/util/concurrent/ThreadFactoryBuilder
      23: dup
      24: invokespecial #7                  // Method com/google/common/util/concurrent/ThreadFactoryBuilder."<init>":()V
      27: ldc           #8                  // String watermark-event-generator-%d
      29: invokevirtual #9                  // Method com/google/common/util/concurrent/ThreadFactoryBuilder.setNameFormat:(Ljava/lang/String;)Lcom/google/common/util/concurrent/ThreadFactoryBuilder;
      32: iconst_1
      33: invokevirtual #10                 // Method com/google/common/util/concurrent/ThreadFactoryBuilder.setDaemon:(Z)Lcom/google/common/util/concurrent/ThreadFactoryBuilder;
      36: invokevirtual #11                 // Method com/google/common/util/concurrent/ThreadFactoryBuilder.build:()Ljava/util/concurrent/ThreadFactory;
      39: astore        8
      41: aload_0
      42: aload         8
      44: invokestatic  #12                 // Method java/util/concurrent/Executors.newSingleThreadScheduledExecutor:(Ljava/util/concurrent/ThreadFactory;)Ljava/util/concurrent/ScheduledExecutorService;
      47: putfield      #13                 // Field executorService:Ljava/util/concurrent/ScheduledExecutorService;
      50: aload_0
      51: lload_2
      52: putfield      #14                 // Field intervalMs:J
      55: aload_0
      56: lload         4
      58: putfield      #15                 // Field eventTsLagMs:J
      61: aload_0
      62: aload         6
      64: putfield      #16                 // Field inputTopics:Ljava/util/Set;
      67: aload_0
      68: aload         7
      70: putfield      #17                 // Field context:Lorg/apache/pulsar/functions/api/Context;
      73: return

  public boolean track(java.lang.String, long);
    Code:
       0: aload_0
       1: getfield      #5                  // Field topicToTs:Ljava/util/Map;
       4: aload_1
       5: invokeinterface #18,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      10: checkcast     #19                 // class java/lang/Long
      13: astore        4
      15: aload         4
      17: ifnull        30
      20: lload_2
      21: aload         4
      23: invokevirtual #20                 // Method java/lang/Long.longValue:()J
      26: lcmp
      27: ifle          45
      30: aload_0
      31: getfield      #5                  // Field topicToTs:Ljava/util/Map;
      34: aload_1
      35: lload_2
      36: invokestatic  #21                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      39: invokeinterface #22,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      44: pop
      45: aload_0
      46: invokespecial #23                 // Method checkFailures:()V
      49: lload_2
      50: aload_0
      51: getfield      #24                 // Field lastWaterMarkTs:J
      54: lcmp
      55: iflt          62
      58: iconst_1
      59: goto          63
      62: iconst_0
      63: ireturn

  public void run();
    Code:
       0: ldc           #25                 // String function
       2: aload_0
       3: getfield      #17                 // Field context:Lorg/apache/pulsar/functions/api/Context;
       6: invokeinterface #26,  1           // InterfaceMethod org/apache/pulsar/functions/api/Context.getTenant:()Ljava/lang/String;
      11: aload_0
      12: getfield      #17                 // Field context:Lorg/apache/pulsar/functions/api/Context;
      15: invokeinterface #27,  1           // InterfaceMethod org/apache/pulsar/functions/api/Context.getNamespace:()Ljava/lang/String;
      20: aload_0
      21: getfield      #17                 // Field context:Lorg/apache/pulsar/functions/api/Context;
      24: invokeinterface #28,  1           // InterfaceMethod org/apache/pulsar/functions/api/Context.getFunctionName:()Ljava/lang/String;
      29: invokestatic  #29                 // Method org/apache/pulsar/functions/windowing/WindowUtils.getFullyQualifiedName:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      32: invokestatic  #30                 // Method org/apache/logging/log4j/ThreadContext.put:(Ljava/lang/String;Ljava/lang/String;)V
      35: aload_0
      36: invokespecial #31                 // Method computeWaterMarkTs:()J
      39: lstore_1
      40: lload_1
      41: aload_0
      42: getfield      #24                 // Field lastWaterMarkTs:J
      45: lcmp
      46: ifle          69
      49: aload_0
      50: getfield      #2                  // Field windowManager:Lorg/apache/pulsar/functions/windowing/WindowManager;
      53: new           #32                 // class org/apache/pulsar/functions/windowing/WaterMarkEvent
      56: dup
      57: lload_1
      58: invokespecial #33                 // Method org/apache/pulsar/functions/windowing/WaterMarkEvent."<init>":(J)V
      61: invokevirtual #34                 // Method org/apache/pulsar/functions/windowing/WindowManager.add:(Lorg/apache/pulsar/functions/windowing/Event;)V
      64: aload_0
      65: lload_1
      66: putfield      #24                 // Field lastWaterMarkTs:J
      69: goto          86
      72: astore_1
      73: getstatic     #36                 // Field log:Lorg/slf4j/Logger;
      76: ldc           #37                 // String Failed while processing watermark event
      78: aload_1
      79: invokeinterface #38,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
      84: aload_1
      85: athrow
      86: return
    Exception table:
       from    to  target type
          35    69    72   Class java/lang/Throwable

  private long computeWaterMarkTs();
    Code:
       0: lconst_0
       1: lstore_1
       2: aload_0
       3: getfield      #5                  // Field topicToTs:Ljava/util/Map;
       6: invokeinterface #39,  1           // InterfaceMethod java/util/Map.size:()I
      11: aload_0
      12: getfield      #16                 // Field inputTopics:Ljava/util/Set;
      15: invokeinterface #40,  1           // InterfaceMethod java/util/Set.size:()I
      20: if_icmplt     83
      23: ldc2_w        #41                 // long 9223372036854775807l
      26: lstore_1
      27: aload_0
      28: getfield      #5                  // Field topicToTs:Ljava/util/Map;
      31: invokeinterface #43,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
      36: invokeinterface #44,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      41: astore_3
      42: aload_3
      43: invokeinterface #45,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      48: ifeq          83
      51: aload_3
      52: invokeinterface #46,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      57: checkcast     #47                 // class java/util/Map$Entry
      60: astore        4
      62: lload_1
      63: aload         4
      65: invokeinterface #48,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
      70: checkcast     #19                 // class java/lang/Long
      73: invokevirtual #20                 // Method java/lang/Long.longValue:()J
      76: invokestatic  #49                 // Method java/lang/Math.min:(JJ)J
      79: lstore_1
      80: goto          42
      83: lload_1
      84: aload_0
      85: getfield      #15                 // Field eventTsLagMs:J
      88: lsub
      89: lreturn

  private void checkFailures();
    Code:
       0: aload_0
       1: getfield      #50                 // Field executorFuture:Ljava/util/concurrent/ScheduledFuture;
       4: ifnull        53
       7: aload_0
       8: getfield      #50                 // Field executorFuture:Ljava/util/concurrent/ScheduledFuture;
      11: invokeinterface #51,  1           // InterfaceMethod java/util/concurrent/ScheduledFuture.isDone:()Z
      16: ifeq          53
      19: aload_0
      20: getfield      #50                 // Field executorFuture:Ljava/util/concurrent/ScheduledFuture;
      23: invokeinterface #52,  1           // InterfaceMethod java/util/concurrent/ScheduledFuture.get:()Ljava/lang/Object;
      28: pop
      29: goto          53
      32: astore_1
      33: getstatic     #36                 // Field log:Lorg/slf4j/Logger;
      36: ldc           #55                 // String Got exception
      38: aload_1
      39: invokeinterface #38,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
      44: new           #56                 // class java/lang/RuntimeException
      47: dup
      48: aload_1
      49: invokespecial #57                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
      52: athrow
      53: return
    Exception table:
       from    to  target type
          19    29    32   Class java/lang/InterruptedException
          19    29    32   Class java/util/concurrent/ExecutionException

  public void start();
    Code:
       0: aload_0
       1: aload_0
       2: getfield      #13                 // Field executorService:Ljava/util/concurrent/ScheduledExecutorService;
       5: aload_0
       6: invokestatic  #58                 // Method org/apache/pulsar/common/util/Runnables.catchingAndLoggingThrowables:(Ljava/lang/Runnable;)Ljava/lang/Runnable;
       9: aload_0
      10: getfield      #14                 // Field intervalMs:J
      13: aload_0
      14: getfield      #14                 // Field intervalMs:J
      17: getstatic     #59                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
      20: invokeinterface #60,  7           // InterfaceMethod java/util/concurrent/ScheduledExecutorService.scheduleAtFixedRate:(Ljava/lang/Runnable;JJLjava/util/concurrent/TimeUnit;)Ljava/util/concurrent/ScheduledFuture;
      25: putfield      #50                 // Field executorFuture:Ljava/util/concurrent/ScheduledFuture;
      28: return

  public void shutdown();
    Code:
       0: getstatic     #36                 // Field log:Lorg/slf4j/Logger;
       3: ldc           #61                 // String Shutting down WaterMarkEventGenerator
       5: invokeinterface #62,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      10: aload_0
      11: getfield      #13                 // Field executorService:Ljava/util/concurrent/ScheduledExecutorService;
      14: invokeinterface #63,  1           // InterfaceMethod java/util/concurrent/ScheduledExecutorService.shutdown:()V
      19: aload_0
      20: getfield      #13                 // Field executorService:Ljava/util/concurrent/ScheduledExecutorService;
      23: ldc2_w        #64                 // long 2l
      26: getstatic     #66                 // Field java/util/concurrent/TimeUnit.SECONDS:Ljava/util/concurrent/TimeUnit;
      29: invokeinterface #67,  4           // InterfaceMethod java/util/concurrent/ScheduledExecutorService.awaitTermination:(JLjava/util/concurrent/TimeUnit;)Z
      34: ifne          47
      37: aload_0
      38: getfield      #13                 // Field executorService:Ljava/util/concurrent/ScheduledExecutorService;
      41: invokeinterface #68,  1           // InterfaceMethod java/util/concurrent/ScheduledExecutorService.shutdownNow:()Ljava/util/List;
      46: pop
      47: goto          67
      50: astore_1
      51: aload_0
      52: getfield      #13                 // Field executorService:Ljava/util/concurrent/ScheduledExecutorService;
      55: invokeinterface #68,  1           // InterfaceMethod java/util/concurrent/ScheduledExecutorService.shutdownNow:()Ljava/util/List;
      60: pop
      61: invokestatic  #69                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
      64: invokevirtual #70                 // Method java/lang/Thread.interrupt:()V
      67: return
    Exception table:
       from    to  target type
          19    47    50   Class java/lang/InterruptedException

  static {};
    Code:
       0: ldc           #71                 // class org/apache/pulsar/functions/windowing/WaterMarkEventGenerator
       2: invokestatic  #72                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #36                 // Field log:Lorg/slf4j/Logger;
       8: return
}
