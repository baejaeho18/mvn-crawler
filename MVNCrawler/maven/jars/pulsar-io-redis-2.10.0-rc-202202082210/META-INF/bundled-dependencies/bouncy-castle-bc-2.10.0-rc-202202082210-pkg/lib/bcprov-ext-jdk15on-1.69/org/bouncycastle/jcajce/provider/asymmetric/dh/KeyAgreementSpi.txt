public class org.bouncycastle.jcajce.provider.asymmetric.dh.KeyAgreementSpi extends org.bouncycastle.jcajce.provider.asymmetric.util.BaseAgreementSpi {
  private static final java.math.BigInteger ONE;

  private static final java.math.BigInteger TWO;

  private final org.bouncycastle.crypto.agreement.DHUnifiedAgreement unifiedAgreement;

  private final org.bouncycastle.crypto.BasicAgreement mqvAgreement;

  private org.bouncycastle.jcajce.spec.DHUParameterSpec dheParameters;

  private org.bouncycastle.jcajce.spec.MQVParameterSpec mqvParameters;

  private java.math.BigInteger x;

  private java.math.BigInteger p;

  private java.math.BigInteger g;

  private byte[] result;

  public org.bouncycastle.jcajce.provider.asymmetric.dh.KeyAgreementSpi();
    Code:
       0: aload_0
       1: ldc           #6                  // String Diffie-Hellman
       3: aconst_null
       4: invokespecial #373                // Method "<init>":(Ljava/lang/String;Lorg/bouncycastle/crypto/DerivationFunction;)V
       7: return

  public org.bouncycastle.jcajce.provider.asymmetric.dh.KeyAgreementSpi(java.lang.String, org.bouncycastle.crypto.DerivationFunction);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #379                // Method org/bouncycastle/jcajce/provider/asymmetric/util/BaseAgreementSpi."<init>":(Ljava/lang/String;Lorg/bouncycastle/crypto/DerivationFunction;)V
       6: aload_0
       7: aconst_null
       8: putfield      #338                // Field unifiedAgreement:Lorg/bouncycastle/crypto/agreement/DHUnifiedAgreement;
      11: aload_0
      12: aconst_null
      13: putfield      #336                // Field mqvAgreement:Lorg/bouncycastle/crypto/BasicAgreement;
      16: return

  public org.bouncycastle.jcajce.provider.asymmetric.dh.KeyAgreementSpi(java.lang.String, org.bouncycastle.crypto.agreement.DHUnifiedAgreement, org.bouncycastle.crypto.DerivationFunction);
    Code:
       0: aload_0
       1: aload_1
       2: aload_3
       3: invokespecial #379                // Method org/bouncycastle/jcajce/provider/asymmetric/util/BaseAgreementSpi."<init>":(Ljava/lang/String;Lorg/bouncycastle/crypto/DerivationFunction;)V
       6: aload_0
       7: aload_2
       8: putfield      #338                // Field unifiedAgreement:Lorg/bouncycastle/crypto/agreement/DHUnifiedAgreement;
      11: aload_0
      12: aconst_null
      13: putfield      #336                // Field mqvAgreement:Lorg/bouncycastle/crypto/BasicAgreement;
      16: return

  public org.bouncycastle.jcajce.provider.asymmetric.dh.KeyAgreementSpi(java.lang.String, org.bouncycastle.crypto.BasicAgreement, org.bouncycastle.crypto.DerivationFunction);
    Code:
       0: aload_0
       1: aload_1
       2: aload_3
       3: invokespecial #379                // Method org/bouncycastle/jcajce/provider/asymmetric/util/BaseAgreementSpi."<init>":(Ljava/lang/String;Lorg/bouncycastle/crypto/DerivationFunction;)V
       6: aload_0
       7: aconst_null
       8: putfield      #338                // Field unifiedAgreement:Lorg/bouncycastle/crypto/agreement/DHUnifiedAgreement;
      11: aload_0
      12: aload_2
      13: putfield      #336                // Field mqvAgreement:Lorg/bouncycastle/crypto/BasicAgreement;
      16: return

  protected byte[] bigIntToBytes(java.math.BigInteger);
    Code:
       0: aload_0
       1: getfield      #334                // Field p:Ljava/math/BigInteger;
       4: invokevirtual #344                // Method java/math/BigInteger.bitLength:()I
       7: bipush        7
       9: iadd
      10: bipush        8
      12: idiv
      13: istore_2
      14: aload_1
      15: invokevirtual #345                // Method java/math/BigInteger.toByteArray:()[B
      18: astore_3
      19: aload_3
      20: arraylength
      21: iload_2
      22: if_icmpne     27
      25: aload_3
      26: areturn
      27: aload_3
      28: iconst_0
      29: baload
      30: ifne          63
      33: aload_3
      34: arraylength
      35: iload_2
      36: iconst_1
      37: iadd
      38: if_icmpne     63
      41: aload_3
      42: arraylength
      43: iconst_1
      44: isub
      45: newarray       byte
      47: astore        4
      49: aload_3
      50: iconst_1
      51: aload         4
      53: iconst_0
      54: aload         4
      56: arraylength
      57: invokestatic  #343                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      60: aload         4
      62: areturn
      63: iload_2
      64: newarray       byte
      66: astore        4
      68: aload_3
      69: iconst_0
      70: aload         4
      72: aload         4
      74: arraylength
      75: aload_3
      76: arraylength
      77: isub
      78: aload_3
      79: arraylength
      80: invokestatic  #343                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      83: aload         4
      85: areturn

  protected java.security.Key engineDoPhase(java.security.Key, boolean) throws java.security.InvalidKeyException, java.lang.IllegalStateException;
    Code:
       0: aload_0
       1: getfield      #335                // Field x:Ljava/math/BigInteger;
       4: ifnonnull     17
       7: new           #176                // class java/lang/IllegalStateException
      10: dup
      11: ldc           #7                  // String Diffie-Hellman not initialised.
      13: invokespecial #341                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_1
      18: instanceof    #186                // class javax/crypto/interfaces/DHPublicKey
      21: ifne          34
      24: new           #181                // class java/security/InvalidKeyException
      27: dup
      28: ldc           #1                  // String DHKeyAgreement doPhase requires DHPublicKey
      30: invokespecial #352                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      33: athrow
      34: aload_1
      35: checkcast     #186                // class javax/crypto/interfaces/DHPublicKey
      38: astore_3
      39: aload_3
      40: invokeinterface #393,  1          // InterfaceMethod javax/crypto/interfaces/DHPublicKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
      45: invokevirtual #354                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
      48: aload_0
      49: getfield      #333                // Field g:Ljava/math/BigInteger;
      52: invokevirtual #346                // Method java/math/BigInteger.equals:(Ljava/lang/Object;)Z
      55: ifeq          77
      58: aload_3
      59: invokeinterface #393,  1          // InterfaceMethod javax/crypto/interfaces/DHPublicKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
      64: invokevirtual #355                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
      67: aload_0
      68: getfield      #334                // Field p:Ljava/math/BigInteger;
      71: invokevirtual #346                // Method java/math/BigInteger.equals:(Ljava/lang/Object;)Z
      74: ifne          87
      77: new           #181                // class java/security/InvalidKeyException
      80: dup
      81: ldc           #5                  // String DHPublicKey not for this KeyAgreement!
      83: invokespecial #352                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      86: athrow
      87: aload_1
      88: checkcast     #186                // class javax/crypto/interfaces/DHPublicKey
      91: invokeinterface #392,  1          // InterfaceMethod javax/crypto/interfaces/DHPublicKey.getY:()Ljava/math/BigInteger;
      96: astore        4
      98: aload         4
     100: ifnull        132
     103: aload         4
     105: getstatic     #332                // Field TWO:Ljava/math/BigInteger;
     108: invokevirtual #348                // Method java/math/BigInteger.compareTo:(Ljava/math/BigInteger;)I
     111: iflt          132
     114: aload         4
     116: aload_0
     117: getfield      #334                // Field p:Ljava/math/BigInteger;
     120: getstatic     #331                // Field ONE:Ljava/math/BigInteger;
     123: invokevirtual #349                // Method java/math/BigInteger.subtract:(Ljava/math/BigInteger;)Ljava/math/BigInteger;
     126: invokevirtual #348                // Method java/math/BigInteger.compareTo:(Ljava/math/BigInteger;)I
     129: iflt          142
     132: new           #181                // class java/security/InvalidKeyException
     135: dup
     136: ldc           #8                  // String Invalid DH PublicKey
     138: invokespecial #352                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     141: athrow
     142: aload_0
     143: getfield      #338                // Field unifiedAgreement:Lorg/bouncycastle/crypto/agreement/DHUnifiedAgreement;
     146: ifnull        214
     149: iload_2
     150: ifne          163
     153: new           #176                // class java/lang/IllegalStateException
     156: dup
     157: ldc           #17                 // String unified Diffie-Hellman can use only two key pairs
     159: invokespecial #341                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     162: athrow
     163: aload_0
     164: aload_1
     165: checkcast     #183                // class java/security/PublicKey
     168: invokespecial #375                // Method generatePublicKeyParameter:(Ljava/security/PublicKey;)Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
     171: astore        5
     173: aload_0
     174: aload_0
     175: getfield      #339                // Field dheParameters:Lorg/bouncycastle/jcajce/spec/DHUParameterSpec;
     178: invokevirtual #384                // Method org/bouncycastle/jcajce/spec/DHUParameterSpec.getOtherPartyEphemeralKey:()Ljava/security/PublicKey;
     181: invokespecial #375                // Method generatePublicKeyParameter:(Ljava/security/PublicKey;)Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
     184: astore        6
     186: new           #197                // class org/bouncycastle/crypto/params/DHUPublicParameters
     189: dup
     190: aload         5
     192: aload         6
     194: invokespecial #367                // Method org/bouncycastle/crypto/params/DHUPublicParameters."<init>":(Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;)V
     197: astore        7
     199: aload_0
     200: aload_0
     201: getfield      #338                // Field unifiedAgreement:Lorg/bouncycastle/crypto/agreement/DHUnifiedAgreement;
     204: aload         7
     206: invokevirtual #358                // Method org/bouncycastle/crypto/agreement/DHUnifiedAgreement.calculateAgreement:(Lorg/bouncycastle/crypto/CipherParameters;)[B
     209: putfield      #329                // Field result:[B
     212: aconst_null
     213: areturn
     214: aload_0
     215: getfield      #336                // Field mqvAgreement:Lorg/bouncycastle/crypto/BasicAgreement;
     218: ifnull        292
     221: iload_2
     222: ifne          235
     225: new           #176                // class java/lang/IllegalStateException
     228: dup
     229: ldc           #9                  // String MQV Diffie-Hellman can use only two key pairs
     231: invokespecial #341                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     234: athrow
     235: aload_0
     236: aload_1
     237: checkcast     #183                // class java/security/PublicKey
     240: invokespecial #375                // Method generatePublicKeyParameter:(Ljava/security/PublicKey;)Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
     243: astore        5
     245: aload_0
     246: aload_0
     247: getfield      #340                // Field mqvParameters:Lorg/bouncycastle/jcajce/spec/MQVParameterSpec;
     250: invokevirtual #388                // Method org/bouncycastle/jcajce/spec/MQVParameterSpec.getOtherPartyEphemeralKey:()Ljava/security/PublicKey;
     253: invokespecial #375                // Method generatePublicKeyParameter:(Ljava/security/PublicKey;)Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
     256: astore        6
     258: new           #192                // class org/bouncycastle/crypto/params/DHMQVPublicParameters
     261: dup
     262: aload         5
     264: aload         6
     266: invokespecial #361                // Method org/bouncycastle/crypto/params/DHMQVPublicParameters."<init>":(Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;)V
     269: astore        7
     271: aload_0
     272: aload_0
     273: aload_0
     274: getfield      #336                // Field mqvAgreement:Lorg/bouncycastle/crypto/BasicAgreement;
     277: aload         7
     279: invokeinterface #395,  2          // InterfaceMethod org/bouncycastle/crypto/BasicAgreement.calculateAgreement:(Lorg/bouncycastle/crypto/CipherParameters;)Ljava/math/BigInteger;
     284: invokevirtual #372                // Method bigIntToBytes:(Ljava/math/BigInteger;)[B
     287: putfield      #329                // Field result:[B
     290: aconst_null
     291: areturn
     292: aload         4
     294: aload_0
     295: getfield      #335                // Field x:Ljava/math/BigInteger;
     298: aload_0
     299: getfield      #334                // Field p:Ljava/math/BigInteger;
     302: invokevirtual #350                // Method java/math/BigInteger.modPow:(Ljava/math/BigInteger;Ljava/math/BigInteger;)Ljava/math/BigInteger;
     305: astore        5
     307: aload         5
     309: getstatic     #331                // Field ONE:Ljava/math/BigInteger;
     312: invokevirtual #348                // Method java/math/BigInteger.compareTo:(Ljava/math/BigInteger;)I
     315: ifne          328
     318: new           #181                // class java/security/InvalidKeyException
     321: dup
     322: ldc           #10                 // String Shared key can\'t be 1
     324: invokespecial #352                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     327: athrow
     328: aload_0
     329: aload_0
     330: aload         5
     332: invokevirtual #372                // Method bigIntToBytes:(Ljava/math/BigInteger;)[B
     335: putfield      #329                // Field result:[B
     338: iload_2
     339: ifeq          344
     342: aconst_null
     343: areturn
     344: new           #199                // class org/bouncycastle/jcajce/provider/asymmetric/dh/BCDHPublicKey
     347: dup
     348: aload         5
     350: aload_3
     351: invokeinterface #393,  1          // InterfaceMethod javax/crypto/interfaces/DHPublicKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
     356: invokespecial #370                // Method org/bouncycastle/jcajce/provider/asymmetric/dh/BCDHPublicKey."<init>":(Ljava/math/BigInteger;Ljavax/crypto/spec/DHParameterSpec;)V
     359: areturn

  protected byte[] engineGenerateSecret() throws java.lang.IllegalStateException;
    Code:
       0: aload_0
       1: getfield      #335                // Field x:Ljava/math/BigInteger;
       4: ifnonnull     17
       7: new           #176                // class java/lang/IllegalStateException
      10: dup
      11: ldc           #7                  // String Diffie-Hellman not initialised.
      13: invokespecial #341                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_0
      18: invokespecial #376                // Method org/bouncycastle/jcajce/provider/asymmetric/util/BaseAgreementSpi.engineGenerateSecret:()[B
      21: areturn

  protected int engineGenerateSecret(byte[], int) throws java.lang.IllegalStateException, javax.crypto.ShortBufferException;
    Code:
       0: aload_0
       1: getfield      #335                // Field x:Ljava/math/BigInteger;
       4: ifnonnull     17
       7: new           #176                // class java/lang/IllegalStateException
      10: dup
      11: ldc           #7                  // String Diffie-Hellman not initialised.
      13: invokespecial #341                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_0
      18: aload_1
      19: iload_2
      20: invokespecial #377                // Method org/bouncycastle/jcajce/provider/asymmetric/util/BaseAgreementSpi.engineGenerateSecret:([BI)I
      23: ireturn

  protected javax.crypto.SecretKey engineGenerateSecret(java.lang.String) throws java.security.NoSuchAlgorithmException;
    Code:
       0: aload_0
       1: getfield      #335                // Field x:Ljava/math/BigInteger;
       4: ifnonnull     17
       7: new           #176                // class java/lang/IllegalStateException
      10: dup
      11: ldc           #7                  // String Diffie-Hellman not initialised.
      13: invokespecial #341                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_1
      18: ldc           #11                 // String TlsPremasterSecret
      20: invokevirtual #342                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      23: ifeq          42
      26: new           #188                // class javax/crypto/spec/SecretKeySpec
      29: dup
      30: aload_0
      31: getfield      #329                // Field result:[B
      34: invokestatic  #371                // Method trimZeroes:([B)[B
      37: aload_1
      38: invokespecial #356                // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      41: areturn
      42: aload_0
      43: aload_1
      44: invokespecial #378                // Method org/bouncycastle/jcajce/provider/asymmetric/util/BaseAgreementSpi.engineGenerateSecret:(Ljava/lang/String;)Ljavax/crypto/SecretKey;
      47: areturn

  protected void engineInit(java.security.Key, java.security.spec.AlgorithmParameterSpec, java.security.SecureRandom) throws java.security.InvalidKeyException, java.security.InvalidAlgorithmParameterException;
    Code:
       0: aload_1
       1: instanceof    #185                // class javax/crypto/interfaces/DHPrivateKey
       4: ifne          17
       7: new           #181                // class java/security/InvalidKeyException
      10: dup
      11: ldc           #4                  // String DHKeyAgreement requires DHPrivateKey for initialisation
      13: invokespecial #352                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_1
      18: checkcast     #185                // class javax/crypto/interfaces/DHPrivateKey
      21: astore        4
      23: aload_2
      24: ifnull        476
      27: aload_2
      28: instanceof    #187                // class javax/crypto/spec/DHParameterSpec
      31: ifeq          71
      34: aload_2
      35: checkcast     #187                // class javax/crypto/spec/DHParameterSpec
      38: astore        5
      40: aload_0
      41: aload         5
      43: invokevirtual #355                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
      46: putfield      #334                // Field p:Ljava/math/BigInteger;
      49: aload_0
      50: aload         5
      52: invokevirtual #354                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
      55: putfield      #333                // Field g:Ljava/math/BigInteger;
      58: aload_0
      59: aconst_null
      60: putfield      #339                // Field dheParameters:Lorg/bouncycastle/jcajce/spec/DHUParameterSpec;
      63: aload_0
      64: aconst_null
      65: putfield      #330                // Field ukmParameters:[B
      68: goto          504
      71: aload_2
      72: instanceof    #234                // class org/bouncycastle/jcajce/spec/DHUParameterSpec
      75: ifeq          231
      78: aload_0
      79: getfield      #338                // Field unifiedAgreement:Lorg/bouncycastle/crypto/agreement/DHUnifiedAgreement;
      82: ifnonnull     95
      85: new           #180                // class java/security/InvalidAlgorithmParameterException
      88: dup
      89: ldc           #12                 // String agreement algorithm not DHU based
      91: invokespecial #351                // Method java/security/InvalidAlgorithmParameterException."<init>":(Ljava/lang/String;)V
      94: athrow
      95: aload_0
      96: aload         4
      98: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
     103: invokevirtual #355                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
     106: putfield      #334                // Field p:Ljava/math/BigInteger;
     109: aload_0
     110: aload         4
     112: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
     117: invokevirtual #354                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
     120: putfield      #333                // Field g:Ljava/math/BigInteger;
     123: aload_0
     124: aload_2
     125: checkcast     #234                // class org/bouncycastle/jcajce/spec/DHUParameterSpec
     128: putfield      #339                // Field dheParameters:Lorg/bouncycastle/jcajce/spec/DHUParameterSpec;
     131: aload_0
     132: aload_2
     133: checkcast     #234                // class org/bouncycastle/jcajce/spec/DHUParameterSpec
     136: invokevirtual #381                // Method org/bouncycastle/jcajce/spec/DHUParameterSpec.getUserKeyingMaterial:()[B
     139: putfield      #330                // Field ukmParameters:[B
     142: aload_0
     143: getfield      #339                // Field dheParameters:Lorg/bouncycastle/jcajce/spec/DHUParameterSpec;
     146: invokevirtual #383                // Method org/bouncycastle/jcajce/spec/DHUParameterSpec.getEphemeralPublicKey:()Ljava/security/PublicKey;
     149: ifnull        197
     152: aload_0
     153: getfield      #338                // Field unifiedAgreement:Lorg/bouncycastle/crypto/agreement/DHUnifiedAgreement;
     156: new           #196                // class org/bouncycastle/crypto/params/DHUPrivateParameters
     159: dup
     160: aload_0
     161: aload         4
     163: invokespecial #374                // Method generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
     166: aload_0
     167: aload_0
     168: getfield      #339                // Field dheParameters:Lorg/bouncycastle/jcajce/spec/DHUParameterSpec;
     171: invokevirtual #382                // Method org/bouncycastle/jcajce/spec/DHUParameterSpec.getEphemeralPrivateKey:()Ljava/security/PrivateKey;
     174: invokespecial #374                // Method generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
     177: aload_0
     178: aload_0
     179: getfield      #339                // Field dheParameters:Lorg/bouncycastle/jcajce/spec/DHUParameterSpec;
     182: invokevirtual #383                // Method org/bouncycastle/jcajce/spec/DHUParameterSpec.getEphemeralPublicKey:()Ljava/security/PublicKey;
     185: invokespecial #375                // Method generatePublicKeyParameter:(Ljava/security/PublicKey;)Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
     188: invokespecial #366                // Method org/bouncycastle/crypto/params/DHUPrivateParameters."<init>":(Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;)V
     191: invokevirtual #357                // Method org/bouncycastle/crypto/agreement/DHUnifiedAgreement.init:(Lorg/bouncycastle/crypto/CipherParameters;)V
     194: goto          504
     197: aload_0
     198: getfield      #338                // Field unifiedAgreement:Lorg/bouncycastle/crypto/agreement/DHUnifiedAgreement;
     201: new           #196                // class org/bouncycastle/crypto/params/DHUPrivateParameters
     204: dup
     205: aload_0
     206: aload         4
     208: invokespecial #374                // Method generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
     211: aload_0
     212: aload_0
     213: getfield      #339                // Field dheParameters:Lorg/bouncycastle/jcajce/spec/DHUParameterSpec;
     216: invokevirtual #382                // Method org/bouncycastle/jcajce/spec/DHUParameterSpec.getEphemeralPrivateKey:()Ljava/security/PrivateKey;
     219: invokespecial #374                // Method generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
     222: invokespecial #365                // Method org/bouncycastle/crypto/params/DHUPrivateParameters."<init>":(Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;)V
     225: invokevirtual #357                // Method org/bouncycastle/crypto/agreement/DHUnifiedAgreement.init:(Lorg/bouncycastle/crypto/CipherParameters;)V
     228: goto          504
     231: aload_2
     232: instanceof    #235                // class org/bouncycastle/jcajce/spec/MQVParameterSpec
     235: ifeq          395
     238: aload_0
     239: getfield      #336                // Field mqvAgreement:Lorg/bouncycastle/crypto/BasicAgreement;
     242: ifnonnull     255
     245: new           #180                // class java/security/InvalidAlgorithmParameterException
     248: dup
     249: ldc           #13                 // String agreement algorithm not MQV based
     251: invokespecial #351                // Method java/security/InvalidAlgorithmParameterException."<init>":(Ljava/lang/String;)V
     254: athrow
     255: aload_0
     256: aload         4
     258: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
     263: invokevirtual #355                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
     266: putfield      #334                // Field p:Ljava/math/BigInteger;
     269: aload_0
     270: aload         4
     272: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
     277: invokevirtual #354                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
     280: putfield      #333                // Field g:Ljava/math/BigInteger;
     283: aload_0
     284: aload_2
     285: checkcast     #235                // class org/bouncycastle/jcajce/spec/MQVParameterSpec
     288: putfield      #340                // Field mqvParameters:Lorg/bouncycastle/jcajce/spec/MQVParameterSpec;
     291: aload_0
     292: aload_2
     293: checkcast     #235                // class org/bouncycastle/jcajce/spec/MQVParameterSpec
     296: invokevirtual #385                // Method org/bouncycastle/jcajce/spec/MQVParameterSpec.getUserKeyingMaterial:()[B
     299: putfield      #330                // Field ukmParameters:[B
     302: aload_0
     303: getfield      #340                // Field mqvParameters:Lorg/bouncycastle/jcajce/spec/MQVParameterSpec;
     306: invokevirtual #387                // Method org/bouncycastle/jcajce/spec/MQVParameterSpec.getEphemeralPublicKey:()Ljava/security/PublicKey;
     309: ifnull        359
     312: aload_0
     313: getfield      #336                // Field mqvAgreement:Lorg/bouncycastle/crypto/BasicAgreement;
     316: new           #191                // class org/bouncycastle/crypto/params/DHMQVPrivateParameters
     319: dup
     320: aload_0
     321: aload         4
     323: invokespecial #374                // Method generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
     326: aload_0
     327: aload_0
     328: getfield      #340                // Field mqvParameters:Lorg/bouncycastle/jcajce/spec/MQVParameterSpec;
     331: invokevirtual #386                // Method org/bouncycastle/jcajce/spec/MQVParameterSpec.getEphemeralPrivateKey:()Ljava/security/PrivateKey;
     334: invokespecial #374                // Method generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
     337: aload_0
     338: aload_0
     339: getfield      #340                // Field mqvParameters:Lorg/bouncycastle/jcajce/spec/MQVParameterSpec;
     342: invokevirtual #387                // Method org/bouncycastle/jcajce/spec/MQVParameterSpec.getEphemeralPublicKey:()Ljava/security/PublicKey;
     345: invokespecial #375                // Method generatePublicKeyParameter:(Ljava/security/PublicKey;)Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
     348: invokespecial #360                // Method org/bouncycastle/crypto/params/DHMQVPrivateParameters."<init>":(Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;)V
     351: invokeinterface #394,  2          // InterfaceMethod org/bouncycastle/crypto/BasicAgreement.init:(Lorg/bouncycastle/crypto/CipherParameters;)V
     356: goto          504
     359: aload_0
     360: getfield      #336                // Field mqvAgreement:Lorg/bouncycastle/crypto/BasicAgreement;
     363: new           #191                // class org/bouncycastle/crypto/params/DHMQVPrivateParameters
     366: dup
     367: aload_0
     368: aload         4
     370: invokespecial #374                // Method generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
     373: aload_0
     374: aload_0
     375: getfield      #340                // Field mqvParameters:Lorg/bouncycastle/jcajce/spec/MQVParameterSpec;
     378: invokevirtual #386                // Method org/bouncycastle/jcajce/spec/MQVParameterSpec.getEphemeralPrivateKey:()Ljava/security/PrivateKey;
     381: invokespecial #374                // Method generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
     384: invokespecial #359                // Method org/bouncycastle/crypto/params/DHMQVPrivateParameters."<init>":(Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;)V
     387: invokeinterface #394,  2          // InterfaceMethod org/bouncycastle/crypto/BasicAgreement.init:(Lorg/bouncycastle/crypto/CipherParameters;)V
     392: goto          504
     395: aload_2
     396: instanceof    #236                // class org/bouncycastle/jcajce/spec/UserKeyingMaterialSpec
     399: ifeq          466
     402: aload_0
     403: getfield      #337                // Field kdf:Lorg/bouncycastle/crypto/DerivationFunction;
     406: ifnonnull     419
     409: new           #180                // class java/security/InvalidAlgorithmParameterException
     412: dup
     413: ldc           #14                 // String no KDF specified for UserKeyingMaterialSpec
     415: invokespecial #351                // Method java/security/InvalidAlgorithmParameterException."<init>":(Ljava/lang/String;)V
     418: athrow
     419: aload_0
     420: aload         4
     422: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
     427: invokevirtual #355                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
     430: putfield      #334                // Field p:Ljava/math/BigInteger;
     433: aload_0
     434: aload         4
     436: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
     441: invokevirtual #354                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
     444: putfield      #333                // Field g:Ljava/math/BigInteger;
     447: aload_0
     448: aconst_null
     449: putfield      #339                // Field dheParameters:Lorg/bouncycastle/jcajce/spec/DHUParameterSpec;
     452: aload_0
     453: aload_2
     454: checkcast     #236                // class org/bouncycastle/jcajce/spec/UserKeyingMaterialSpec
     457: invokevirtual #389                // Method org/bouncycastle/jcajce/spec/UserKeyingMaterialSpec.getUserKeyingMaterial:()[B
     460: putfield      #330                // Field ukmParameters:[B
     463: goto          504
     466: new           #180                // class java/security/InvalidAlgorithmParameterException
     469: dup
     470: ldc           #2                  // String DHKeyAgreement only accepts DHParameterSpec
     472: invokespecial #351                // Method java/security/InvalidAlgorithmParameterException."<init>":(Ljava/lang/String;)V
     475: athrow
     476: aload_0
     477: aload         4
     479: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
     484: invokevirtual #355                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
     487: putfield      #334                // Field p:Ljava/math/BigInteger;
     490: aload_0
     491: aload         4
     493: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
     498: invokevirtual #354                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
     501: putfield      #333                // Field g:Ljava/math/BigInteger;
     504: aload_0
     505: aload         4
     507: invokeinterface #390,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getX:()Ljava/math/BigInteger;
     512: putfield      #335                // Field x:Ljava/math/BigInteger;
     515: aload_0
     516: aload_0
     517: aload_0
     518: getfield      #335                // Field x:Ljava/math/BigInteger;
     521: invokevirtual #372                // Method bigIntToBytes:(Ljava/math/BigInteger;)[B
     524: putfield      #329                // Field result:[B
     527: return

  protected void engineInit(java.security.Key, java.security.SecureRandom) throws java.security.InvalidKeyException;
    Code:
       0: aload_1
       1: instanceof    #185                // class javax/crypto/interfaces/DHPrivateKey
       4: ifne          17
       7: new           #181                // class java/security/InvalidKeyException
      10: dup
      11: ldc           #3                  // String DHKeyAgreement requires DHPrivateKey
      13: invokespecial #352                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_1
      18: checkcast     #185                // class javax/crypto/interfaces/DHPrivateKey
      21: astore_3
      22: aload_0
      23: aload_3
      24: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
      29: invokevirtual #355                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
      32: putfield      #334                // Field p:Ljava/math/BigInteger;
      35: aload_0
      36: aload_3
      37: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
      42: invokevirtual #354                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
      45: putfield      #333                // Field g:Ljava/math/BigInteger;
      48: aload_0
      49: aload_3
      50: invokeinterface #390,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getX:()Ljava/math/BigInteger;
      55: putfield      #335                // Field x:Ljava/math/BigInteger;
      58: aload_0
      59: aload_0
      60: aload_0
      61: getfield      #335                // Field x:Ljava/math/BigInteger;
      64: invokevirtual #372                // Method bigIntToBytes:(Ljava/math/BigInteger;)[B
      67: putfield      #329                // Field result:[B
      70: return

  protected byte[] calcSecret();
    Code:
       0: aload_0
       1: getfield      #329                // Field result:[B
       4: areturn

  private org.bouncycastle.crypto.params.DHPrivateKeyParameters generatePrivateKeyParameter(java.security.PrivateKey) throws java.security.InvalidKeyException;
    Code:
       0: aload_1
       1: instanceof    #185                // class javax/crypto/interfaces/DHPrivateKey
       4: ifeq          68
       7: aload_1
       8: instanceof    #198                // class org/bouncycastle/jcajce/provider/asymmetric/dh/BCDHPrivateKey
      11: ifeq          22
      14: aload_1
      15: checkcast     #198                // class org/bouncycastle/jcajce/provider/asymmetric/dh/BCDHPrivateKey
      18: invokevirtual #368                // Method org/bouncycastle/jcajce/provider/asymmetric/dh/BCDHPrivateKey.engineGetKeyParameters:()Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
      21: areturn
      22: aload_1
      23: checkcast     #185                // class javax/crypto/interfaces/DHPrivateKey
      26: astore_2
      27: aload_2
      28: invokeinterface #391,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
      33: astore_3
      34: new           #194                // class org/bouncycastle/crypto/params/DHPrivateKeyParameters
      37: dup
      38: aload_2
      39: invokeinterface #390,  1          // InterfaceMethod javax/crypto/interfaces/DHPrivateKey.getX:()Ljava/math/BigInteger;
      44: new           #193                // class org/bouncycastle/crypto/params/DHParameters
      47: dup
      48: aload_3
      49: invokevirtual #355                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
      52: aload_3
      53: invokevirtual #354                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
      56: aconst_null
      57: aload_3
      58: invokevirtual #353                // Method javax/crypto/spec/DHParameterSpec.getL:()I
      61: invokespecial #362                // Method org/bouncycastle/crypto/params/DHParameters."<init>":(Ljava/math/BigInteger;Ljava/math/BigInteger;Ljava/math/BigInteger;I)V
      64: invokespecial #363                // Method org/bouncycastle/crypto/params/DHPrivateKeyParameters."<init>":(Ljava/math/BigInteger;Lorg/bouncycastle/crypto/params/DHParameters;)V
      67: areturn
      68: new           #181                // class java/security/InvalidKeyException
      71: dup
      72: ldc           #15                 // String private key not a DHPrivateKey
      74: invokespecial #352                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
      77: athrow

  private org.bouncycastle.crypto.params.DHPublicKeyParameters generatePublicKeyParameter(java.security.PublicKey) throws java.security.InvalidKeyException;
    Code:
       0: aload_1
       1: instanceof    #186                // class javax/crypto/interfaces/DHPublicKey
       4: ifeq          96
       7: aload_1
       8: instanceof    #199                // class org/bouncycastle/jcajce/provider/asymmetric/dh/BCDHPublicKey
      11: ifeq          22
      14: aload_1
      15: checkcast     #199                // class org/bouncycastle/jcajce/provider/asymmetric/dh/BCDHPublicKey
      18: invokevirtual #369                // Method org/bouncycastle/jcajce/provider/asymmetric/dh/BCDHPublicKey.engineGetKeyParameters:()Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
      21: areturn
      22: aload_1
      23: checkcast     #186                // class javax/crypto/interfaces/DHPublicKey
      26: astore_2
      27: aload_2
      28: invokeinterface #393,  1          // InterfaceMethod javax/crypto/interfaces/DHPublicKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
      33: astore_3
      34: aload_3
      35: instanceof    #233                // class org/bouncycastle/jcajce/spec/DHDomainParameterSpec
      38: ifeq          62
      41: new           #195                // class org/bouncycastle/crypto/params/DHPublicKeyParameters
      44: dup
      45: aload_2
      46: invokeinterface #392,  1          // InterfaceMethod javax/crypto/interfaces/DHPublicKey.getY:()Ljava/math/BigInteger;
      51: aload_3
      52: checkcast     #233                // class org/bouncycastle/jcajce/spec/DHDomainParameterSpec
      55: invokevirtual #380                // Method org/bouncycastle/jcajce/spec/DHDomainParameterSpec.getDomainParameters:()Lorg/bouncycastle/crypto/params/DHParameters;
      58: invokespecial #364                // Method org/bouncycastle/crypto/params/DHPublicKeyParameters."<init>":(Ljava/math/BigInteger;Lorg/bouncycastle/crypto/params/DHParameters;)V
      61: areturn
      62: new           #195                // class org/bouncycastle/crypto/params/DHPublicKeyParameters
      65: dup
      66: aload_2
      67: invokeinterface #392,  1          // InterfaceMethod javax/crypto/interfaces/DHPublicKey.getY:()Ljava/math/BigInteger;
      72: new           #193                // class org/bouncycastle/crypto/params/DHParameters
      75: dup
      76: aload_3
      77: invokevirtual #355                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
      80: aload_3
      81: invokevirtual #354                // Method javax/crypto/spec/DHParameterSpec.getG:()Ljava/math/BigInteger;
      84: aconst_null
      85: aload_3
      86: invokevirtual #353                // Method javax/crypto/spec/DHParameterSpec.getL:()I
      89: invokespecial #362                // Method org/bouncycastle/crypto/params/DHParameters."<init>":(Ljava/math/BigInteger;Ljava/math/BigInteger;Ljava/math/BigInteger;I)V
      92: invokespecial #364                // Method org/bouncycastle/crypto/params/DHPublicKeyParameters."<init>":(Ljava/math/BigInteger;Lorg/bouncycastle/crypto/params/DHParameters;)V
      95: areturn
      96: new           #181                // class java/security/InvalidKeyException
      99: dup
     100: ldc           #16                 // String public key not a DHPublicKey
     102: invokespecial #352                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     105: athrow

  static {};
    Code:
       0: lconst_1
       1: invokestatic  #347                // Method java/math/BigInteger.valueOf:(J)Ljava/math/BigInteger;
       4: putstatic     #331                // Field ONE:Ljava/math/BigInteger;
       7: ldc2_w        #174                // long 2l
      10: invokestatic  #347                // Method java/math/BigInteger.valueOf:(J)Ljava/math/BigInteger;
      13: putstatic     #332                // Field TWO:Ljava/math/BigInteger;
      16: return
}
