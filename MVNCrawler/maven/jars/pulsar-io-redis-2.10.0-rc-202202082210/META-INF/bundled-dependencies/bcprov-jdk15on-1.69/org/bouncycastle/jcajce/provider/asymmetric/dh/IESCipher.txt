public class org.bouncycastle.jcajce.provider.asymmetric.dh.IESCipher extends javax.crypto.CipherSpi {
  private final org.bouncycastle.jcajce.util.JcaJceHelper helper;

  private final int ivLength;

  private org.bouncycastle.crypto.engines.IESEngine engine;

  private int state;

  private java.io.ByteArrayOutputStream buffer;

  private java.security.AlgorithmParameters engineParam;

  private org.bouncycastle.jce.spec.IESParameterSpec engineSpec;

  private org.bouncycastle.crypto.params.AsymmetricKeyParameter key;

  private java.security.SecureRandom random;

  private boolean dhaesMode;

  private org.bouncycastle.crypto.params.AsymmetricKeyParameter otherKeyParameter;

  public org.bouncycastle.jcajce.provider.asymmetric.dh.IESCipher(org.bouncycastle.crypto.engines.IESEngine);
    Code:
       0: aload_0
       1: invokespecial #348                // Method javax/crypto/CipherSpi."<init>":()V
       4: aload_0
       5: new           #206                // class org/bouncycastle/jcajce/util/BCJcaJceHelper
       8: dup
       9: invokespecial #375                // Method org/bouncycastle/jcajce/util/BCJcaJceHelper."<init>":()V
      12: putfield      #324                // Field helper:Lorg/bouncycastle/jcajce/util/JcaJceHelper;
      15: aload_0
      16: iconst_m1
      17: putfield      #316                // Field state:I
      20: aload_0
      21: new           #160                // class java/io/ByteArrayOutputStream
      24: dup
      25: invokespecial #327                // Method java/io/ByteArrayOutputStream."<init>":()V
      28: putfield      #318                // Field buffer:Ljava/io/ByteArrayOutputStream;
      31: aload_0
      32: aconst_null
      33: putfield      #319                // Field engineParam:Ljava/security/AlgorithmParameters;
      36: aload_0
      37: aconst_null
      38: putfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      41: aload_0
      42: iconst_0
      43: putfield      #317                // Field dhaesMode:Z
      46: aload_0
      47: aconst_null
      48: putfield      #323                // Field otherKeyParameter:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      51: aload_0
      52: aload_1
      53: putfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
      56: aload_0
      57: iconst_0
      58: putfield      #315                // Field ivLength:I
      61: return

  public org.bouncycastle.jcajce.provider.asymmetric.dh.IESCipher(org.bouncycastle.crypto.engines.IESEngine, int);
    Code:
       0: aload_0
       1: invokespecial #348                // Method javax/crypto/CipherSpi."<init>":()V
       4: aload_0
       5: new           #206                // class org/bouncycastle/jcajce/util/BCJcaJceHelper
       8: dup
       9: invokespecial #375                // Method org/bouncycastle/jcajce/util/BCJcaJceHelper."<init>":()V
      12: putfield      #324                // Field helper:Lorg/bouncycastle/jcajce/util/JcaJceHelper;
      15: aload_0
      16: iconst_m1
      17: putfield      #316                // Field state:I
      20: aload_0
      21: new           #160                // class java/io/ByteArrayOutputStream
      24: dup
      25: invokespecial #327                // Method java/io/ByteArrayOutputStream."<init>":()V
      28: putfield      #318                // Field buffer:Ljava/io/ByteArrayOutputStream;
      31: aload_0
      32: aconst_null
      33: putfield      #319                // Field engineParam:Ljava/security/AlgorithmParameters;
      36: aload_0
      37: aconst_null
      38: putfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      41: aload_0
      42: iconst_0
      43: putfield      #317                // Field dhaesMode:Z
      46: aload_0
      47: aconst_null
      48: putfield      #323                // Field otherKeyParameter:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      51: aload_0
      52: aload_1
      53: putfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
      56: aload_0
      57: iload_2
      58: putfield      #315                // Field ivLength:I
      61: return

  public int engineGetBlockSize();
    Code:
       0: aload_0
       1: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
       4: invokevirtual #354                // Method org/bouncycastle/crypto/engines/IESEngine.getCipher:()Lorg/bouncycastle/crypto/BufferedBlockCipher;
       7: ifnull        21
      10: aload_0
      11: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
      14: invokevirtual #354                // Method org/bouncycastle/crypto/engines/IESEngine.getCipher:()Lorg/bouncycastle/crypto/BufferedBlockCipher;
      17: invokevirtual #351                // Method org/bouncycastle/crypto/BufferedBlockCipher.getBlockSize:()I
      20: ireturn
      21: iconst_0
      22: ireturn

  public int engineGetKeySize(java.security.Key);
    Code:
       0: aload_1
       1: instanceof    #182                // class javax/crypto/interfaces/DHKey
       4: ifeq          23
       7: aload_1
       8: checkcast     #182                // class javax/crypto/interfaces/DHKey
      11: invokeinterface #382,  1          // InterfaceMethod javax/crypto/interfaces/DHKey.getParams:()Ljavax/crypto/spec/DHParameterSpec;
      16: invokevirtual #350                // Method javax/crypto/spec/DHParameterSpec.getP:()Ljava/math/BigInteger;
      19: invokevirtual #341                // Method java/math/BigInteger.bitLength:()I
      22: ireturn
      23: new           #162                // class java/lang/IllegalArgumentException
      26: dup
      27: ldc           #18                 // String not a DH key
      29: invokespecial #332                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      32: athrow

  public byte[] engineGetIV();
    Code:
       0: aload_0
       1: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
       4: ifnull        15
       7: aload_0
       8: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      11: invokevirtual #380                // Method org/bouncycastle/jce/spec/IESParameterSpec.getNonce:()[B
      14: areturn
      15: aconst_null
      16: areturn

  public java.security.AlgorithmParameters engineGetParameters();
    Code:
       0: aload_0
       1: getfield      #319                // Field engineParam:Ljava/security/AlgorithmParameters;
       4: ifnonnull     56
       7: aload_0
       8: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      11: ifnull        56
      14: aload_0
      15: aload_0
      16: getfield      #324                // Field helper:Lorg/bouncycastle/jcajce/util/JcaJceHelper;
      19: ldc           #3                  // String IES
      21: invokeinterface #384,  2          // InterfaceMethod org/bouncycastle/jcajce/util/JcaJceHelper.createAlgorithmParameters:(Ljava/lang/String;)Ljava/security/AlgorithmParameters;
      26: putfield      #319                // Field engineParam:Ljava/security/AlgorithmParameters;
      29: aload_0
      30: getfield      #319                // Field engineParam:Ljava/security/AlgorithmParameters;
      33: aload_0
      34: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      37: invokevirtual #342                // Method java/security/AlgorithmParameters.init:(Ljava/security/spec/AlgorithmParameterSpec;)V
      40: goto          56
      43: astore_1
      44: new           #164                // class java/lang/RuntimeException
      47: dup
      48: aload_1
      49: invokevirtual #331                // Method java/lang/Exception.toString:()Ljava/lang/String;
      52: invokespecial #334                // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
      55: athrow
      56: aload_0
      57: getfield      #319                // Field engineParam:Ljava/security/AlgorithmParameters;
      60: areturn
    Exception table:
       from    to  target type
          14    40    43   Class java/lang/Exception

  public void engineSetMode(java.lang.String) throws java.security.NoSuchAlgorithmException;
    Code:
       0: aload_1
       1: invokestatic  #381                // Method org/bouncycastle/util/Strings.toUpperCase:(Ljava/lang/String;)Ljava/lang/String;
       4: astore_2
       5: aload_2
       6: ldc           #6                  // String NONE
       8: invokevirtual #335                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      11: ifeq          22
      14: aload_0
      15: iconst_0
      16: putfield      #317                // Field dhaesMode:Z
      19: goto          66
      22: aload_2
      23: ldc           #2                  // String DHAES
      25: invokevirtual #335                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      28: ifeq          39
      31: aload_0
      32: iconst_1
      33: putfield      #317                // Field dhaesMode:Z
      36: goto          66
      39: new           #162                // class java/lang/IllegalArgumentException
      42: dup
      43: new           #166                // class java/lang/StringBuilder
      46: dup
      47: invokespecial #336                // Method java/lang/StringBuilder."<init>":()V
      50: ldc           #10                 // String can\'t support mode
      52: invokevirtual #339                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      55: aload_1
      56: invokevirtual #339                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      59: invokevirtual #337                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      62: invokespecial #332                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      65: athrow
      66: return

  public int engineGetOutputSize(int);
    Code:
       0: aload_0
       1: getfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
       4: ifnonnull     17
       7: new           #163                // class java/lang/IllegalStateException
      10: dup
      11: ldc           #13                 // String cipher not initialised
      13: invokespecial #333                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_0
      18: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
      21: invokevirtual #355                // Method org/bouncycastle/crypto/engines/IESEngine.getMac:()Lorg/bouncycastle/crypto/Mac;
      24: invokeinterface #383,  1          // InterfaceMethod org/bouncycastle/crypto/Mac.getMacSize:()I
      29: istore_2
      30: aload_0
      31: getfield      #323                // Field otherKeyParameter:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      34: ifnonnull     67
      37: iconst_1
      38: iconst_2
      39: aload_0
      40: getfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      43: checkcast     #193                // class org/bouncycastle/crypto/params/DHKeyParameters
      46: invokevirtual #363                // Method org/bouncycastle/crypto/params/DHKeyParameters.getParameters:()Lorg/bouncycastle/crypto/params/DHParameters;
      49: invokevirtual #364                // Method org/bouncycastle/crypto/params/DHParameters.getP:()Ljava/math/BigInteger;
      52: invokevirtual #341                // Method java/math/BigInteger.bitLength:()I
      55: bipush        7
      57: iadd
      58: imul
      59: bipush        8
      61: idiv
      62: iadd
      63: istore_3
      64: goto          69
      67: iconst_0
      68: istore_3
      69: aload_0
      70: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
      73: invokevirtual #354                // Method org/bouncycastle/crypto/engines/IESEngine.getCipher:()Lorg/bouncycastle/crypto/BufferedBlockCipher;
      76: ifnonnull     85
      79: iload_1
      80: istore        4
      82: goto          163
      85: aload_0
      86: getfield      #316                // Field state:I
      89: iconst_1
      90: if_icmpeq     101
      93: aload_0
      94: getfield      #316                // Field state:I
      97: iconst_3
      98: if_icmpne     117
     101: aload_0
     102: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
     105: invokevirtual #354                // Method org/bouncycastle/crypto/engines/IESEngine.getCipher:()Lorg/bouncycastle/crypto/BufferedBlockCipher;
     108: iload_1
     109: invokevirtual #352                // Method org/bouncycastle/crypto/BufferedBlockCipher.getOutputSize:(I)I
     112: istore        4
     114: goto          163
     117: aload_0
     118: getfield      #316                // Field state:I
     121: iconst_2
     122: if_icmpeq     133
     125: aload_0
     126: getfield      #316                // Field state:I
     129: iconst_4
     130: if_icmpne     153
     133: aload_0
     134: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
     137: invokevirtual #354                // Method org/bouncycastle/crypto/engines/IESEngine.getCipher:()Lorg/bouncycastle/crypto/BufferedBlockCipher;
     140: iload_1
     141: iload_2
     142: isub
     143: iload_3
     144: isub
     145: invokevirtual #352                // Method org/bouncycastle/crypto/BufferedBlockCipher.getOutputSize:(I)I
     148: istore        4
     150: goto          163
     153: new           #163                // class java/lang/IllegalStateException
     156: dup
     157: ldc           #13                 // String cipher not initialised
     159: invokespecial #333                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     162: athrow
     163: aload_0
     164: getfield      #316                // Field state:I
     167: iconst_1
     168: if_icmpeq     179
     171: aload_0
     172: getfield      #316                // Field state:I
     175: iconst_3
     176: if_icmpne     194
     179: aload_0
     180: getfield      #318                // Field buffer:Ljava/io/ByteArrayOutputStream;
     183: invokevirtual #326                // Method java/io/ByteArrayOutputStream.size:()I
     186: iload_2
     187: iadd
     188: iload_3
     189: iadd
     190: iload         4
     192: iadd
     193: ireturn
     194: aload_0
     195: getfield      #316                // Field state:I
     198: iconst_2
     199: if_icmpeq     210
     202: aload_0
     203: getfield      #316                // Field state:I
     206: iconst_4
     207: if_icmpne     225
     210: aload_0
     211: getfield      #318                // Field buffer:Ljava/io/ByteArrayOutputStream;
     214: invokevirtual #326                // Method java/io/ByteArrayOutputStream.size:()I
     217: iload_2
     218: isub
     219: iload_3
     220: isub
     221: iload         4
     223: iadd
     224: ireturn
     225: new           #163                // class java/lang/IllegalStateException
     228: dup
     229: ldc           #4                  // String IESCipher not initialised
     231: invokespecial #333                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     234: athrow

  public void engineSetPadding(java.lang.String) throws javax.crypto.NoSuchPaddingException;
    Code:
       0: aload_1
       1: invokestatic  #381                // Method org/bouncycastle/util/Strings.toUpperCase:(Ljava/lang/String;)Ljava/lang/String;
       4: astore_2
       5: aload_2
       6: ldc           #7                  // String NOPADDING
       8: invokevirtual #335                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      11: ifeq          17
      14: goto          48
      17: aload_2
      18: ldc           #8                  // String PKCS5PADDING
      20: invokevirtual #335                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      23: ifne          48
      26: aload_2
      27: ldc           #9                  // String PKCS7PADDING
      29: invokevirtual #335                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      32: ifeq          38
      35: goto          48
      38: new           #180                // class javax/crypto/NoSuchPaddingException
      41: dup
      42: ldc           #19                 // String padding not available with IESCipher
      44: invokespecial #349                // Method javax/crypto/NoSuchPaddingException."<init>":(Ljava/lang/String;)V
      47: athrow
      48: return

  public void engineInit(int, java.security.Key, java.security.AlgorithmParameters, java.security.SecureRandom) throws java.security.InvalidKeyException, java.security.InvalidAlgorithmParameterException;
    Code:
       0: aconst_null
       1: astore        5
       3: aload_3
       4: ifnull        51
       7: aload_3
       8: ldc           #21                 // class org/bouncycastle/jce/spec/IESParameterSpec
      10: invokevirtual #343                // Method java/security/AlgorithmParameters.getParameterSpec:(Ljava/lang/Class;)Ljava/security/spec/AlgorithmParameterSpec;
      13: astore        5
      15: goto          51
      18: astore        6
      20: new           #170                // class java/security/InvalidAlgorithmParameterException
      23: dup
      24: new           #166                // class java/lang/StringBuilder
      27: dup
      28: invokespecial #336                // Method java/lang/StringBuilder."<init>":()V
      31: ldc           #12                 // String cannot recognise parameters:
      33: invokevirtual #339                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      36: aload         6
      38: invokevirtual #331                // Method java/lang/Exception.toString:()Ljava/lang/String;
      41: invokevirtual #339                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      44: invokevirtual #337                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      47: invokespecial #345                // Method java/security/InvalidAlgorithmParameterException."<init>":(Ljava/lang/String;)V
      50: athrow
      51: aload_0
      52: aload_3
      53: putfield      #319                // Field engineParam:Ljava/security/AlgorithmParameters;
      56: aload_0
      57: iload_1
      58: aload_2
      59: aload         5
      61: aload         4
      63: invokevirtual #369                // Method engineInit:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;Ljava/security/SecureRandom;)V
      66: return
    Exception table:
       from    to  target type
           7    15    18   Class java/lang/Exception

  public void engineInit(int, java.security.Key, java.security.spec.AlgorithmParameterSpec, java.security.SecureRandom) throws java.security.InvalidAlgorithmParameterException, java.security.InvalidKeyException;
    Code:
       0: aload_3
       1: ifnonnull     53
       4: aconst_null
       5: astore        5
       7: aload_0
       8: getfield      #315                // Field ivLength:I
      11: ifeq          34
      14: iload_1
      15: iconst_1
      16: if_icmpne     34
      19: aload_0
      20: getfield      #315                // Field ivLength:I
      23: newarray       byte
      25: astore        5
      27: aload         4
      29: aload         5
      31: invokevirtual #347                // Method java/security/SecureRandom.nextBytes:([B)V
      34: aload_0
      35: aload_0
      36: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
      39: invokevirtual #354                // Method org/bouncycastle/crypto/engines/IESEngine.getCipher:()Lorg/bouncycastle/crypto/BufferedBlockCipher;
      42: aload         5
      44: invokestatic  #373                // Method org/bouncycastle/jcajce/provider/asymmetric/util/IESUtil.guessParameterSpec:(Lorg/bouncycastle/crypto/BufferedBlockCipher;[B)Lorg/bouncycastle/jce/spec/IESParameterSpec;
      47: putfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      50: goto          81
      53: aload_3
      54: instanceof    #21                 // class org/bouncycastle/jce/spec/IESParameterSpec
      57: ifeq          71
      60: aload_0
      61: aload_3
      62: checkcast     #21                 // class org/bouncycastle/jce/spec/IESParameterSpec
      65: putfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      68: goto          81
      71: new           #170                // class java/security/InvalidAlgorithmParameterException
      74: dup
      75: ldc           #15                 // String must be passed IES parameters
      77: invokespecial #345                // Method java/security/InvalidAlgorithmParameterException."<init>":(Ljava/lang/String;)V
      80: athrow
      81: aload_0
      82: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      85: invokevirtual #380                // Method org/bouncycastle/jce/spec/IESParameterSpec.getNonce:()[B
      88: astore        5
      90: aload_0
      91: getfield      #315                // Field ivLength:I
      94: ifeq          147
      97: aload         5
      99: ifnull        112
     102: aload         5
     104: arraylength
     105: aload_0
     106: getfield      #315                // Field ivLength:I
     109: if_icmpeq     147
     112: new           #170                // class java/security/InvalidAlgorithmParameterException
     115: dup
     116: new           #166                // class java/lang/StringBuilder
     119: dup
     120: invokespecial #336                // Method java/lang/StringBuilder."<init>":()V
     123: ldc           #5                  // String NONCE in IES Parameters needs to be
     125: invokevirtual #339                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     128: aload_0
     129: getfield      #315                // Field ivLength:I
     132: invokevirtual #338                // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     135: ldc           #1                  // String  bytes long
     137: invokevirtual #339                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     140: invokevirtual #337                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     143: invokespecial #345                // Method java/security/InvalidAlgorithmParameterException."<init>":(Ljava/lang/String;)V
     146: athrow
     147: iload_1
     148: iconst_1
     149: if_icmpeq     157
     152: iload_1
     153: iconst_3
     154: if_icmpne     232
     157: aload_2
     158: instanceof    #184                // class javax/crypto/interfaces/DHPublicKey
     161: ifeq          178
     164: aload_0
     165: aload_2
     166: checkcast     #174                // class java/security/PublicKey
     169: invokestatic  #372                // Method org/bouncycastle/jcajce/provider/asymmetric/util/DHUtil.generatePublicKeyParameter:(Ljava/security/PublicKey;)Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     172: putfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     175: goto          327
     178: aload_2
     179: instanceof    #208                // class org/bouncycastle/jce/interfaces/IESKey
     182: ifeq          222
     185: aload_2
     186: checkcast     #208                // class org/bouncycastle/jce/interfaces/IESKey
     189: astore        6
     191: aload_0
     192: aload         6
     194: invokeinterface #386,  1          // InterfaceMethod org/bouncycastle/jce/interfaces/IESKey.getPublic:()Ljava/security/PublicKey;
     199: invokestatic  #372                // Method org/bouncycastle/jcajce/provider/asymmetric/util/DHUtil.generatePublicKeyParameter:(Ljava/security/PublicKey;)Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     202: putfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     205: aload_0
     206: aload         6
     208: invokeinterface #385,  1          // InterfaceMethod org/bouncycastle/jce/interfaces/IESKey.getPrivate:()Ljava/security/PrivateKey;
     213: invokestatic  #371                // Method org/bouncycastle/jcajce/provider/asymmetric/util/DHUtil.generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     216: putfield      #323                // Field otherKeyParameter:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     219: goto          327
     222: new           #171                // class java/security/InvalidKeyException
     225: dup
     226: ldc           #17                 // String must be passed recipient\'s public DH key for encryption
     228: invokespecial #346                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     231: athrow
     232: iload_1
     233: iconst_2
     234: if_icmpeq     242
     237: iload_1
     238: iconst_4
     239: if_icmpne     317
     242: aload_2
     243: instanceof    #183                // class javax/crypto/interfaces/DHPrivateKey
     246: ifeq          263
     249: aload_0
     250: aload_2
     251: checkcast     #173                // class java/security/PrivateKey
     254: invokestatic  #371                // Method org/bouncycastle/jcajce/provider/asymmetric/util/DHUtil.generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     257: putfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     260: goto          327
     263: aload_2
     264: instanceof    #208                // class org/bouncycastle/jce/interfaces/IESKey
     267: ifeq          307
     270: aload_2
     271: checkcast     #208                // class org/bouncycastle/jce/interfaces/IESKey
     274: astore        6
     276: aload_0
     277: aload         6
     279: invokeinterface #386,  1          // InterfaceMethod org/bouncycastle/jce/interfaces/IESKey.getPublic:()Ljava/security/PublicKey;
     284: invokestatic  #372                // Method org/bouncycastle/jcajce/provider/asymmetric/util/DHUtil.generatePublicKeyParameter:(Ljava/security/PublicKey;)Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     287: putfield      #323                // Field otherKeyParameter:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     290: aload_0
     291: aload         6
     293: invokeinterface #385,  1          // InterfaceMethod org/bouncycastle/jce/interfaces/IESKey.getPrivate:()Ljava/security/PrivateKey;
     298: invokestatic  #371                // Method org/bouncycastle/jcajce/provider/asymmetric/util/DHUtil.generatePrivateKeyParameter:(Ljava/security/PrivateKey;)Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     301: putfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     304: goto          327
     307: new           #171                // class java/security/InvalidKeyException
     310: dup
     311: ldc           #16                 // String must be passed recipient\'s private DH key for decryption
     313: invokespecial #346                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     316: athrow
     317: new           #171                // class java/security/InvalidKeyException
     320: dup
     321: ldc           #14                 // String must be passed EC key
     323: invokespecial #346                // Method java/security/InvalidKeyException."<init>":(Ljava/lang/String;)V
     326: athrow
     327: aload_0
     328: aload         4
     330: putfield      #320                // Field random:Ljava/security/SecureRandom;
     333: aload_0
     334: iload_1
     335: putfield      #316                // Field state:I
     338: aload_0
     339: getfield      #318                // Field buffer:Ljava/io/ByteArrayOutputStream;
     342: invokevirtual #328                // Method java/io/ByteArrayOutputStream.reset:()V
     345: return

  public void engineInit(int, java.security.Key, java.security.SecureRandom) throws java.security.InvalidKeyException;
    Code:
       0: aload_0
       1: iload_1
       2: aload_2
       3: aconst_null
       4: checkcast     #176                // class java/security/spec/AlgorithmParameterSpec
       7: aload_3
       8: invokevirtual #369                // Method engineInit:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;Ljava/security/SecureRandom;)V
      11: goto          47
      14: astore        4
      16: new           #162                // class java/lang/IllegalArgumentException
      19: dup
      20: new           #166                // class java/lang/StringBuilder
      23: dup
      24: invokespecial #336                // Method java/lang/StringBuilder."<init>":()V
      27: ldc           #11                 // String cannot handle supplied parameter spec:
      29: invokevirtual #339                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      32: aload         4
      34: invokevirtual #344                // Method java/security/InvalidAlgorithmParameterException.getMessage:()Ljava/lang/String;
      37: invokevirtual #339                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      40: invokevirtual #337                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      43: invokespecial #332                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      46: athrow
      47: return
    Exception table:
       from    to  target type
           0    11    14   Class java/security/InvalidAlgorithmParameterException

  public byte[] engineUpdate(byte[], int, int);
    Code:
       0: aload_0
       1: getfield      #318                // Field buffer:Ljava/io/ByteArrayOutputStream;
       4: aload_1
       5: iload_2
       6: iload_3
       7: invokevirtual #330                // Method java/io/ByteArrayOutputStream.write:([BII)V
      10: aconst_null
      11: areturn

  public int engineUpdate(byte[], int, int, byte[], int);
    Code:
       0: aload_0
       1: getfield      #318                // Field buffer:Ljava/io/ByteArrayOutputStream;
       4: aload_1
       5: iload_2
       6: iload_3
       7: invokevirtual #330                // Method java/io/ByteArrayOutputStream.write:([BII)V
      10: iconst_0
      11: ireturn

  public byte[] engineDoFinal(byte[], int, int) throws javax.crypto.IllegalBlockSizeException, javax.crypto.BadPaddingException;
    Code:
       0: iload_3
       1: ifeq          14
       4: aload_0
       5: getfield      #318                // Field buffer:Ljava/io/ByteArrayOutputStream;
       8: aload_1
       9: iload_2
      10: iload_3
      11: invokevirtual #330                // Method java/io/ByteArrayOutputStream.write:([BII)V
      14: aload_0
      15: getfield      #318                // Field buffer:Ljava/io/ByteArrayOutputStream;
      18: invokevirtual #329                // Method java/io/ByteArrayOutputStream.toByteArray:()[B
      21: astore        4
      23: aload_0
      24: getfield      #318                // Field buffer:Ljava/io/ByteArrayOutputStream;
      27: invokevirtual #328                // Method java/io/ByteArrayOutputStream.reset:()V
      30: new           #195                // class org/bouncycastle/crypto/params/IESWithCipherParameters
      33: dup
      34: aload_0
      35: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      38: invokevirtual #378                // Method org/bouncycastle/jce/spec/IESParameterSpec.getDerivationV:()[B
      41: aload_0
      42: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      45: invokevirtual #379                // Method org/bouncycastle/jce/spec/IESParameterSpec.getEncodingV:()[B
      48: aload_0
      49: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      52: invokevirtual #377                // Method org/bouncycastle/jce/spec/IESParameterSpec.getMacKeySize:()I
      55: aload_0
      56: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      59: invokevirtual #376                // Method org/bouncycastle/jce/spec/IESParameterSpec.getCipherKeySize:()I
      62: invokespecial #365                // Method org/bouncycastle/crypto/params/IESWithCipherParameters."<init>":([B[BII)V
      65: astore        5
      67: aload_0
      68: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      71: invokevirtual #380                // Method org/bouncycastle/jce/spec/IESParameterSpec.getNonce:()[B
      74: ifnull        95
      77: new           #196                // class org/bouncycastle/crypto/params/ParametersWithIV
      80: dup
      81: aload         5
      83: aload_0
      84: getfield      #325                // Field engineSpec:Lorg/bouncycastle/jce/spec/IESParameterSpec;
      87: invokevirtual #380                // Method org/bouncycastle/jce/spec/IESParameterSpec.getNonce:()[B
      90: invokespecial #366                // Method org/bouncycastle/crypto/params/ParametersWithIV."<init>":(Lorg/bouncycastle/crypto/CipherParameters;[B)V
      93: astore        5
      95: aload_0
      96: getfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      99: checkcast     #193                // class org/bouncycastle/crypto/params/DHKeyParameters
     102: invokevirtual #363                // Method org/bouncycastle/crypto/params/DHKeyParameters.getParameters:()Lorg/bouncycastle/crypto/params/DHParameters;
     105: astore        6
     107: aload_0
     108: getfield      #323                // Field otherKeyParameter:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     111: ifnull        197
     114: aload_0
     115: getfield      #316                // Field state:I
     118: iconst_1
     119: if_icmpeq     130
     122: aload_0
     123: getfield      #316                // Field state:I
     126: iconst_3
     127: if_icmpne     151
     130: aload_0
     131: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
     134: iconst_1
     135: aload_0
     136: getfield      #323                // Field otherKeyParameter:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     139: aload_0
     140: getfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     143: aload         5
     145: invokevirtual #356                // Method org/bouncycastle/crypto/engines/IESEngine.init:(ZLorg/bouncycastle/crypto/CipherParameters;Lorg/bouncycastle/crypto/CipherParameters;Lorg/bouncycastle/crypto/CipherParameters;)V
     148: goto          169
     151: aload_0
     152: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
     155: iconst_0
     156: aload_0
     157: getfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     160: aload_0
     161: getfield      #323                // Field otherKeyParameter:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     164: aload         5
     166: invokevirtual #356                // Method org/bouncycastle/crypto/engines/IESEngine.init:(ZLorg/bouncycastle/crypto/CipherParameters;Lorg/bouncycastle/crypto/CipherParameters;Lorg/bouncycastle/crypto/CipherParameters;)V
     169: aload_0
     170: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
     173: aload         4
     175: iconst_0
     176: aload         4
     178: arraylength
     179: invokevirtual #353                // Method org/bouncycastle/crypto/engines/IESEngine.processBlock:([BII)[B
     182: areturn
     183: astore        8
     185: new           #205                // class org/bouncycastle/jcajce/provider/util/BadBlockException
     188: dup
     189: ldc           #20                 // String unable to process block
     191: aload         8
     193: invokespecial #374                // Method org/bouncycastle/jcajce/provider/util/BadBlockException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     196: athrow
     197: aload_0
     198: getfield      #316                // Field state:I
     201: iconst_1
     202: if_icmpeq     213
     205: aload_0
     206: getfield      #316                // Field state:I
     209: iconst_3
     210: if_icmpne     302
     213: new           #190                // class org/bouncycastle/crypto/generators/DHKeyPairGenerator
     216: dup
     217: invokespecial #359                // Method org/bouncycastle/crypto/generators/DHKeyPairGenerator."<init>":()V
     220: astore        8
     222: aload         8
     224: new           #192                // class org/bouncycastle/crypto/params/DHKeyGenerationParameters
     227: dup
     228: aload_0
     229: getfield      #320                // Field random:Ljava/security/SecureRandom;
     232: aload         6
     234: invokespecial #362                // Method org/bouncycastle/crypto/params/DHKeyGenerationParameters."<init>":(Ljava/security/SecureRandom;Lorg/bouncycastle/crypto/params/DHParameters;)V
     237: invokevirtual #360                // Method org/bouncycastle/crypto/generators/DHKeyPairGenerator.init:(Lorg/bouncycastle/crypto/KeyGenerationParameters;)V
     240: new           #191                // class org/bouncycastle/crypto/generators/EphemeralKeyPairGenerator
     243: dup
     244: aload         8
     246: new           #199                // class org/bouncycastle/jcajce/provider/asymmetric/dh/IESCipher$1
     249: dup
     250: aload_0
     251: invokespecial #370                // Method org/bouncycastle/jcajce/provider/asymmetric/dh/IESCipher$1."<init>":(Lorg/bouncycastle/jcajce/provider/asymmetric/dh/IESCipher;)V
     254: invokespecial #361                // Method org/bouncycastle/crypto/generators/EphemeralKeyPairGenerator."<init>":(Lorg/bouncycastle/crypto/AsymmetricCipherKeyPairGenerator;Lorg/bouncycastle/crypto/KeyEncoder;)V
     257: astore        9
     259: aload_0
     260: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
     263: aload_0
     264: getfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     267: aload         5
     269: aload         9
     271: invokevirtual #358                // Method org/bouncycastle/crypto/engines/IESEngine.init:(Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;Lorg/bouncycastle/crypto/CipherParameters;Lorg/bouncycastle/crypto/generators/EphemeralKeyPairGenerator;)V
     274: aload_0
     275: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
     278: aload         4
     280: iconst_0
     281: aload         4
     283: arraylength
     284: invokevirtual #353                // Method org/bouncycastle/crypto/engines/IESEngine.processBlock:([BII)[B
     287: areturn
     288: astore        10
     290: new           #205                // class org/bouncycastle/jcajce/provider/util/BadBlockException
     293: dup
     294: ldc           #20                 // String unable to process block
     296: aload         10
     298: invokespecial #374                // Method org/bouncycastle/jcajce/provider/util/BadBlockException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     301: athrow
     302: aload_0
     303: getfield      #316                // Field state:I
     306: iconst_2
     307: if_icmpeq     318
     310: aload_0
     311: getfield      #316                // Field state:I
     314: iconst_4
     315: if_icmpne     376
     318: aload_0
     319: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
     322: aload_0
     323: getfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     326: aload         5
     328: new           #197                // class org/bouncycastle/crypto/parsers/DHIESPublicKeyParser
     331: dup
     332: aload_0
     333: getfield      #322                // Field key:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
     336: checkcast     #193                // class org/bouncycastle/crypto/params/DHKeyParameters
     339: invokevirtual #363                // Method org/bouncycastle/crypto/params/DHKeyParameters.getParameters:()Lorg/bouncycastle/crypto/params/DHParameters;
     342: invokespecial #367                // Method org/bouncycastle/crypto/parsers/DHIESPublicKeyParser."<init>":(Lorg/bouncycastle/crypto/params/DHParameters;)V
     345: invokevirtual #357                // Method org/bouncycastle/crypto/engines/IESEngine.init:(Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;Lorg/bouncycastle/crypto/CipherParameters;Lorg/bouncycastle/crypto/KeyParser;)V
     348: aload_0
     349: getfield      #321                // Field engine:Lorg/bouncycastle/crypto/engines/IESEngine;
     352: aload         4
     354: iconst_0
     355: aload         4
     357: arraylength
     358: invokevirtual #353                // Method org/bouncycastle/crypto/engines/IESEngine.processBlock:([BII)[B
     361: areturn
     362: astore        8
     364: new           #205                // class org/bouncycastle/jcajce/provider/util/BadBlockException
     367: dup
     368: ldc           #20                 // String unable to process block
     370: aload         8
     372: invokespecial #374                // Method org/bouncycastle/jcajce/provider/util/BadBlockException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     375: athrow
     376: new           #163                // class java/lang/IllegalStateException
     379: dup
     380: ldc           #4                  // String IESCipher not initialised
     382: invokespecial #333                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     385: athrow
    Exception table:
       from    to  target type
         114   182   183   Class java/lang/Exception
         259   287   288   Class java/lang/Exception
         318   361   362   Class org/bouncycastle/crypto/InvalidCipherTextException

  public int engineDoFinal(byte[], int, int, byte[], int) throws javax.crypto.ShortBufferException, javax.crypto.IllegalBlockSizeException, javax.crypto.BadPaddingException;
    Code:
       0: aload_0
       1: aload_1
       2: iload_2
       3: iload_3
       4: invokevirtual #368                // Method engineDoFinal:([BII)[B
       7: astore        6
       9: aload         6
      11: iconst_0
      12: aload         4
      14: iload         5
      16: aload         6
      18: arraylength
      19: invokestatic  #340                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      22: aload         6
      24: arraylength
      25: ireturn
}
