Compiled from "X509CredentialsAuthenticationHandler.java"
public class org.apereo.cas.adaptors.x509.authentication.handler.support.X509CredentialsAuthenticationHandler extends org.apereo.cas.authentication.handler.support.AbstractPreAndPostProcessingAuthenticationHandler {
  private static final org.slf4j.Logger LOGGER;

  private static final java.lang.String KEY_USAGE_OID;

  private final java.util.regex.Pattern regExTrustedIssuerDnPattern;

  private final int maxPathLength;

  private final boolean maxPathLengthAllowUnspecified;

  private final boolean checkKeyUsage;

  private final boolean requireKeyUsage;

  private final java.util.regex.Pattern regExSubjectDnPattern;

  private final org.apereo.cas.adaptors.x509.authentication.revocation.checker.RevocationChecker revocationChecker;

  public org.apereo.cas.adaptors.x509.authentication.handler.support.X509CredentialsAuthenticationHandler(java.lang.String, org.apereo.cas.services.ServicesManager, org.apereo.cas.authentication.principal.PrincipalFactory, java.util.regex.Pattern, int, boolean, boolean, boolean, java.util.regex.Pattern, org.apereo.cas.adaptors.x509.authentication.revocation.checker.RevocationChecker, java.lang.Integer);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         11
       6: invokespecial #1                  // Method org/apereo/cas/authentication/handler/support/AbstractPreAndPostProcessingAuthenticationHandler."<init>":(Ljava/lang/String;Lorg/apereo/cas/services/ServicesManager;Lorg/apereo/cas/authentication/principal/PrincipalFactory;Ljava/lang/Integer;)V
       9: aload_0
      10: aload         4
      12: putfield      #2                  // Field regExTrustedIssuerDnPattern:Ljava/util/regex/Pattern;
      15: aload_0
      16: iload         5
      18: putfield      #3                  // Field maxPathLength:I
      21: aload_0
      22: iload         6
      24: putfield      #4                  // Field maxPathLengthAllowUnspecified:Z
      27: aload_0
      28: iload         7
      30: putfield      #5                  // Field checkKeyUsage:Z
      33: aload_0
      34: iload         8
      36: putfield      #6                  // Field requireKeyUsage:Z
      39: aload_0
      40: aload         9
      42: putfield      #7                  // Field regExSubjectDnPattern:Ljava/util/regex/Pattern;
      45: aload_0
      46: aload         10
      48: putfield      #8                  // Field revocationChecker:Lorg/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker;
      51: return

  public org.apereo.cas.adaptors.x509.authentication.handler.support.X509CredentialsAuthenticationHandler(java.util.regex.Pattern);
    Code:
       0: aload_0
       1: aload_1
       2: new           #9                  // class org/apereo/cas/adaptors/x509/authentication/revocation/checker/NoOpRevocationChecker
       5: dup
       6: invokespecial #10                 // Method org/apereo/cas/adaptors/x509/authentication/revocation/checker/NoOpRevocationChecker."<init>":()V
       9: invokespecial #11                 // Method "<init>":(Ljava/util/regex/Pattern;Lorg/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker;)V
      12: return

  public org.apereo.cas.adaptors.x509.authentication.handler.support.X509CredentialsAuthenticationHandler(java.util.regex.Pattern, boolean, java.util.regex.Pattern);
    Code:
       0: aload_0
       1: ldc           #13                 // String
       3: aconst_null
       4: aconst_null
       5: aload_1
       6: ldc           #15                 // int 2147483647
       8: iload_2
       9: iconst_0
      10: iconst_0
      11: aload_3
      12: new           #9                  // class org/apereo/cas/adaptors/x509/authentication/revocation/checker/NoOpRevocationChecker
      15: dup
      16: invokespecial #10                 // Method org/apereo/cas/adaptors/x509/authentication/revocation/checker/NoOpRevocationChecker."<init>":()V
      19: aconst_null
      20: invokespecial #16                 // Method "<init>":(Ljava/lang/String;Lorg/apereo/cas/services/ServicesManager;Lorg/apereo/cas/authentication/principal/PrincipalFactory;Ljava/util/regex/Pattern;IZZZLjava/util/regex/Pattern;Lorg/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker;Ljava/lang/Integer;)V
      23: return

  public org.apereo.cas.adaptors.x509.authentication.handler.support.X509CredentialsAuthenticationHandler(java.util.regex.Pattern, boolean, boolean, boolean);
    Code:
       0: aload_0
       1: ldc           #13                 // String
       3: aconst_null
       4: aconst_null
       5: aload_1
       6: ldc           #15                 // int 2147483647
       8: iload_2
       9: iload_3
      10: iload         4
      12: aconst_null
      13: new           #9                  // class org/apereo/cas/adaptors/x509/authentication/revocation/checker/NoOpRevocationChecker
      16: dup
      17: invokespecial #10                 // Method org/apereo/cas/adaptors/x509/authentication/revocation/checker/NoOpRevocationChecker."<init>":()V
      20: aconst_null
      21: invokespecial #16                 // Method "<init>":(Ljava/lang/String;Lorg/apereo/cas/services/ServicesManager;Lorg/apereo/cas/authentication/principal/PrincipalFactory;Ljava/util/regex/Pattern;IZZZLjava/util/regex/Pattern;Lorg/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker;Ljava/lang/Integer;)V
      24: return

  public org.apereo.cas.adaptors.x509.authentication.handler.support.X509CredentialsAuthenticationHandler(java.util.regex.Pattern, org.apereo.cas.adaptors.x509.authentication.revocation.checker.RevocationChecker);
    Code:
       0: aload_0
       1: ldc           #13                 // String
       3: aconst_null
       4: aconst_null
       5: aload_1
       6: ldc           #15                 // int 2147483647
       8: iconst_0
       9: iconst_0
      10: iconst_0
      11: aconst_null
      12: aload_2
      13: aconst_null
      14: invokespecial #16                 // Method "<init>":(Ljava/lang/String;Lorg/apereo/cas/services/ServicesManager;Lorg/apereo/cas/authentication/principal/PrincipalFactory;Ljava/util/regex/Pattern;IZZZLjava/util/regex/Pattern;Lorg/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker;Ljava/lang/Integer;)V
      17: return

  private static boolean isCritical(java.security.cert.X509Certificate, java.lang.String);
    Code:
       0: aload_0
       1: invokevirtual #17                 // Method java/security/cert/X509Certificate.getCriticalExtensionOIDs:()Ljava/util/Set;
       4: astore_2
       5: aload_2
       6: ifnull        18
       9: aload_2
      10: invokeinterface #18,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
      15: ifeq          20
      18: iconst_0
      19: ireturn
      20: aload_2
      21: aload_1
      22: invokeinterface #19,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      27: ireturn

  private static boolean doesNameMatchPattern(java.security.Principal, java.util.regex.Pattern);
    Code:
       0: aload_1
       1: ifnull        54
       4: aload_0
       5: invokeinterface #20,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      10: astore_2
      11: aload_1
      12: aload_2
      13: invokevirtual #21                 // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
      16: invokevirtual #22                 // Method java/util/regex/Matcher.matches:()Z
      19: istore_3
      20: getstatic     #23                 // Field LOGGER:Lorg/slf4j/Logger;
      23: ldc           #24                 // String [{}] matches [{}] == [{}]
      25: iconst_3
      26: anewarray     #25                 // class java/lang/Object
      29: dup
      30: iconst_0
      31: aload_1
      32: invokevirtual #26                 // Method java/util/regex/Pattern.pattern:()Ljava/lang/String;
      35: aastore
      36: dup
      37: iconst_1
      38: aload_2
      39: aastore
      40: dup
      41: iconst_2
      42: iload_3
      43: invokestatic  #27                 // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
      46: aastore
      47: invokeinterface #28,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
      52: iload_3
      53: ireturn
      54: iconst_1
      55: ireturn

  public boolean supports(org.apereo.cas.authentication.Credential);
    Code:
       0: aload_1
       1: ifnull        20
       4: ldc           #29                 // class org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential
       6: aload_1
       7: invokevirtual #30                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      10: invokevirtual #31                 // Method java/lang/Class.isAssignableFrom:(Ljava/lang/Class;)Z
      13: ifeq          20
      16: iconst_1
      17: goto          21
      20: iconst_0
      21: ireturn

  public boolean supports(java.lang.Class<? extends org.apereo.cas.authentication.Credential>);
    Code:
       0: ldc           #29                 // class org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential
       2: aload_1
       3: invokevirtual #31                 // Method java/lang/Class.isAssignableFrom:(Ljava/lang/Class;)Z
       6: ireturn

  protected org.apereo.cas.authentication.AuthenticationHandlerExecutionResult doAuthentication(org.apereo.cas.authentication.Credential) throws java.security.GeneralSecurityException;
    Code:
       0: aload_1
       1: checkcast     #29                 // class org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential
       4: astore_2
       5: aload_2
       6: invokevirtual #32                 // Method org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential.getCertificates:()[Ljava/security/cert/X509Certificate;
       9: astore_3
      10: aconst_null
      11: checkcast     #33                 // class java/security/cert/X509Certificate
      14: astore        4
      16: iconst_0
      17: istore        5
      19: aload_3
      20: arraylength
      21: iconst_1
      22: isub
      23: istore        6
      25: iload         6
      27: iflt          115
      30: aload_3
      31: iload         6
      33: aaload
      34: astore        7
      36: getstatic     #23                 // Field LOGGER:Lorg/slf4j/Logger;
      39: ldc           #34                 // String Evaluating [{}]
      41: aload         7
      43: invokestatic  #35                 // Method org/apereo/cas/util/crypto/CertUtils.toString:(Ljava/security/cert/X509Certificate;)Ljava/lang/String;
      46: invokeinterface #36,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      51: aload_0
      52: aload         7
      54: invokevirtual #37                 // Method validate:(Ljava/security/cert/X509Certificate;)V
      57: iload         5
      59: ifne          70
      62: aload_0
      63: aload         7
      65: invokevirtual #38                 // Method isCertificateFromTrustedIssuer:(Ljava/security/cert/X509Certificate;)Z
      68: istore        5
      70: aload         7
      72: invokevirtual #39                 // Method java/security/cert/X509Certificate.getBasicConstraints:()I
      75: istore        8
      77: iload         8
      79: ifge          99
      82: getstatic     #23                 // Field LOGGER:Lorg/slf4j/Logger;
      85: ldc           #40                 // String Found valid client certificate
      87: invokeinterface #41,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      92: aload         7
      94: astore        4
      96: goto          109
      99: getstatic     #23                 // Field LOGGER:Lorg/slf4j/Logger;
     102: ldc           #42                 // String Found valid CA certificate
     104: invokeinterface #41,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     109: iinc          6, -1
     112: goto          25
     115: iload         5
     117: ifeq          154
     120: aload         4
     122: ifnull        154
     125: aload_2
     126: aload         4
     128: invokevirtual #43                 // Method org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential.setCertificate:(Ljava/security/cert/X509Certificate;)V
     131: new           #44                 // class org/apereo/cas/authentication/DefaultAuthenticationHandlerExecutionResult
     134: dup
     135: aload_0
     136: aload_2
     137: aload_0
     138: getfield      #45                 // Field principalFactory:Lorg/apereo/cas/authentication/principal/PrincipalFactory;
     141: aload_2
     142: invokevirtual #46                 // Method org/apereo/cas/adaptors/x509/authentication/principal/X509CertificateCredential.getId:()Ljava/lang/String;
     145: invokeinterface #47,  2           // InterfaceMethod org/apereo/cas/authentication/principal/PrincipalFactory.createPrincipal:(Ljava/lang/String;)Lorg/apereo/cas/authentication/principal/Principal;
     150: invokespecial #48                 // Method org/apereo/cas/authentication/DefaultAuthenticationHandlerExecutionResult."<init>":(Lorg/apereo/cas/authentication/AuthenticationHandler;Lorg/apereo/cas/authentication/CredentialMetaData;Lorg/apereo/cas/authentication/principal/Principal;)V
     153: areturn
     154: getstatic     #23                 // Field LOGGER:Lorg/slf4j/Logger;
     157: ldc           #49                 // String Either client certificate could not be determined, or a trusted issuer could not be located
     159: invokeinterface #50,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     164: new           #51                 // class javax/security/auth/login/FailedLoginException
     167: dup
     168: invokespecial #52                 // Method javax/security/auth/login/FailedLoginException."<init>":()V
     171: athrow

  private void validate(java.security.cert.X509Certificate) throws java.security.GeneralSecurityException;
    Code:
       0: aload_1
       1: invokevirtual #53                 // Method java/security/cert/X509Certificate.checkValidity:()V
       4: aload_0
       5: getfield      #8                  // Field revocationChecker:Lorg/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker;
       8: aload_1
       9: invokeinterface #54,  2           // InterfaceMethod org/apereo/cas/adaptors/x509/authentication/revocation/checker/RevocationChecker.check:(Ljava/security/cert/X509Certificate;)V
      14: aload_1
      15: invokevirtual #39                 // Method java/security/cert/X509Certificate.getBasicConstraints:()I
      18: istore_2
      19: iload_2
      20: ifge          76
      23: aload_0
      24: aload_1
      25: invokevirtual #55                 // Method isCertificateAllowed:(Ljava/security/cert/X509Certificate;)Z
      28: ifne          51
      31: new           #51                 // class javax/security/auth/login/FailedLoginException
      34: dup
      35: aload_0
      36: getfield      #7                  // Field regExSubjectDnPattern:Ljava/util/regex/Pattern;
      39: invokevirtual #26                 // Method java/util/regex/Pattern.pattern:()Ljava/lang/String;
      42: invokedynamic #56,  0             // InvokeDynamic #0:makeConcatWithConstants:(Ljava/lang/String;)Ljava/lang/String;
      47: invokespecial #57                 // Method javax/security/auth/login/FailedLoginException."<init>":(Ljava/lang/String;)V
      50: athrow
      51: aload_0
      52: getfield      #5                  // Field checkKeyUsage:Z
      55: ifeq          147
      58: aload_0
      59: aload_1
      60: invokevirtual #58                 // Method isValidKeyUsage:(Ljava/security/cert/X509Certificate;)Z
      63: ifne          147
      66: new           #51                 // class javax/security/auth/login/FailedLoginException
      69: dup
      70: ldc           #59                 // String Certificate keyUsage constraint forbids SSL client authentication.
      72: invokespecial #57                 // Method javax/security/auth/login/FailedLoginException."<init>":(Ljava/lang/String;)V
      75: athrow
      76: iload_2
      77: ldc           #15                 // int 2147483647
      79: if_icmpne     99
      82: aload_0
      83: getfield      #4                  // Field maxPathLengthAllowUnspecified:Z
      86: ifne          99
      89: new           #51                 // class javax/security/auth/login/FailedLoginException
      92: dup
      93: ldc           #60                 // String Unlimited certificate path length not allowed by configuration.
      95: invokespecial #57                 // Method javax/security/auth/login/FailedLoginException."<init>":(Ljava/lang/String;)V
      98: athrow
      99: iload_2
     100: aload_0
     101: getfield      #3                  // Field maxPathLength:I
     104: if_icmple     147
     107: iload_2
     108: ldc           #15                 // int 2147483647
     110: if_icmpge     147
     113: new           #51                 // class javax/security/auth/login/FailedLoginException
     116: dup
     117: ldc           #61                 // String Certificate path length %s exceeds maximum value %s.
     119: iconst_2
     120: anewarray     #25                 // class java/lang/Object
     123: dup
     124: iconst_0
     125: iload_2
     126: invokestatic  #62                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     129: aastore
     130: dup
     131: iconst_1
     132: aload_0
     133: getfield      #3                  // Field maxPathLength:I
     136: invokestatic  #62                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     139: aastore
     140: invokestatic  #63                 // Method java/lang/String.format:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     143: invokespecial #57                 // Method javax/security/auth/login/FailedLoginException."<init>":(Ljava/lang/String;)V
     146: athrow
     147: return

  private boolean isValidKeyUsage(java.security.cert.X509Certificate);
    Code:
       0: getstatic     #23                 // Field LOGGER:Lorg/slf4j/Logger;
       3: ldc           #64                 // String Checking certificate keyUsage extension
       5: invokeinterface #41,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      10: aload_1
      11: invokevirtual #65                 // Method java/security/cert/X509Certificate.getKeyUsage:()[Z
      14: astore_2
      15: aload_2
      16: ifnonnull     42
      19: getstatic     #23                 // Field LOGGER:Lorg/slf4j/Logger;
      22: ldc           #66                 // String Configuration specifies checkKeyUsage but keyUsage extension not found in certificate.
      24: invokeinterface #50,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      29: aload_0
      30: getfield      #6                  // Field requireKeyUsage:Z
      33: ifne          40
      36: iconst_1
      37: goto          41
      40: iconst_0
      41: ireturn
      42: aload_0
      43: aload_1
      44: invokedynamic #67,  0             // InvokeDynamic #1:test:(Lorg/apereo/cas/adaptors/x509/authentication/handler/support/X509CredentialsAuthenticationHandler;Ljava/security/cert/X509Certificate;)Ljava/util/function/Predicate;
      49: aload_2
      50: invokedynamic #68,  0             // InvokeDynamic #2:apply:([Z)Lorg/jooq/lambda/fi/util/function/CheckedFunction;
      55: invokedynamic #69,  0             // InvokeDynamic #3:apply:()Lorg/jooq/lambda/fi/util/function/CheckedFunction;
      60: invokestatic  #70                 // Method org/apereo/cas/util/function/FunctionUtils.doIf:(Ljava/util/function/Predicate;Lorg/jooq/lambda/fi/util/function/CheckedFunction;Lorg/jooq/lambda/fi/util/function/CheckedFunction;)Ljava/util/function/Function;
      63: astore_3
      64: aload_3
      65: aload_1
      66: invokeinterface #71,  2           // InterfaceMethod java/util/function/Function.apply:(Ljava/lang/Object;)Ljava/lang/Object;
      71: checkcast     #72                 // class java/lang/Boolean
      74: invokevirtual #73                 // Method java/lang/Boolean.booleanValue:()Z
      77: ireturn

  private boolean isCertificateAllowed(java.security.cert.X509Certificate);
    Code:
       0: aload_1
       1: invokevirtual #74                 // Method java/security/cert/X509Certificate.getSubjectDN:()Ljava/security/Principal;
       4: aload_0
       5: getfield      #7                  // Field regExSubjectDnPattern:Ljava/util/regex/Pattern;
       8: invokestatic  #75                 // Method doesNameMatchPattern:(Ljava/security/Principal;Ljava/util/regex/Pattern;)Z
      11: ireturn

  private boolean isCertificateFromTrustedIssuer(java.security.cert.X509Certificate);
    Code:
       0: aload_1
       1: invokevirtual #76                 // Method java/security/cert/X509Certificate.getIssuerDN:()Ljava/security/Principal;
       4: aload_0
       5: getfield      #2                  // Field regExTrustedIssuerDnPattern:Ljava/util/regex/Pattern;
       8: invokestatic  #75                 // Method doesNameMatchPattern:(Ljava/security/Principal;Ljava/util/regex/Pattern;)Z
      11: ireturn

  private static java.lang.Boolean lambda$isValidKeyUsage$2(java.lang.Object) throws java.lang.Throwable;
    Code:
       0: getstatic     #23                 // Field LOGGER:Lorg/slf4j/Logger;
       3: ldc           #77                 // String KeyUsage digitalSignature=%s, Returning true since keyUsage validation not required by configuration.
       5: invokeinterface #41,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      10: getstatic     #78                 // Field java/lang/Boolean.TRUE:Ljava/lang/Boolean;
      13: areturn

  private static java.lang.Boolean lambda$isValidKeyUsage$1(boolean[], java.lang.Object) throws java.lang.Throwable;
    Code:
       0: getstatic     #23                 // Field LOGGER:Lorg/slf4j/Logger;
       3: ldc           #79                 // String KeyUsage extension is marked critical or required by configuration.
       5: invokeinterface #41,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      10: aload_0
      11: iconst_0
      12: baload
      13: invokestatic  #27                 // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
      16: areturn

  private boolean lambda$isValidKeyUsage$0(java.security.cert.X509Certificate, java.lang.Object);
    Code:
       0: aload_1
       1: ldc           #81                 // String 2.5.29.15
       3: invokestatic  #82                 // Method isCritical:(Ljava/security/cert/X509Certificate;Ljava/lang/String;)Z
       6: ifne          16
       9: aload_0
      10: getfield      #6                  // Field requireKeyUsage:Z
      13: ifeq          20
      16: iconst_1
      17: goto          21
      20: iconst_0
      21: ireturn

  static {};
    Code:
       0: ldc           #80                 // class org/apereo/cas/adaptors/x509/authentication/handler/support/X509CredentialsAuthenticationHandler
       2: invokestatic  #83                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #23                 // Field LOGGER:Lorg/slf4j/Logger;
       8: return
}
