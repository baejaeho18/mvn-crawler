Compiled from "SecureTheWorldValve.java"
public class org.wso2.carbon.tomcat.ext.valves.SecureTheWorldValve extends org.apache.catalina.valves.ValveBase {
  private static final org.apache.commons.logging.Log log;

  public org.wso2.carbon.tomcat.ext.valves.SecureTheWorldValve();
    Code:
       0: aload_0
       1: iconst_1
       2: invokespecial #1                  // Method org/apache/catalina/valves/ValveBase."<init>":(Z)V
       5: return

  public void invoke(org.apache.catalina.connector.Request, org.apache.catalina.connector.Response) throws java.io.IOException, javax.servlet.ServletException;
    Code:
       0: invokestatic  #2                  // Method org/wso2/carbon/base/ServerConfiguration.getInstance:()Lorg/wso2/carbon/base/ServerConfiguration;
       3: ldc           #3                  // String WebContextRoot
       5: invokevirtual #4                  // Method org/wso2/carbon/base/ServerConfiguration.getFirstProperty:(Ljava/lang/String;)Ljava/lang/String;
       8: astore_3
       9: aload_1
      10: invokevirtual #5                  // Method org/apache/catalina/connector/Request.getContextPath:()Ljava/lang/String;
      13: astore        4
      15: aload_1
      16: invokevirtual #6                  // Method org/apache/catalina/connector/Request.getCoyoteRequest:()Lorg/apache/coyote/Request;
      19: invokevirtual #7                  // Method org/apache/coyote/Request.toString:()Ljava/lang/String;
      22: astore        5
      24: aload         5
      26: ldc           #8                  // String /services/t/
      28: invokevirtual #9                  // Method java/lang/String.contains:(Ljava/lang/CharSequence;)Z
      31: ifne          74
      34: aload_3
      35: ldc           #10                 // String /
      37: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      40: ifeq          53
      43: aload         4
      45: ldc           #12                 // String
      47: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      50: ifne          62
      53: aload_3
      54: aload         4
      56: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      59: ifeq          74
      62: aload_0
      63: invokevirtual #13                 // Method getNext:()Lorg/apache/catalina/Valve;
      66: aload_1
      67: aload_2
      68: invokeinterface #14,  3           // InterfaceMethod org/apache/catalina/Valve.invoke:(Lorg/apache/catalina/connector/Request;Lorg/apache/catalina/connector/Response;)V
      73: return
      74: aload_0
      75: aload_1
      76: invokespecial #15                 // Method authenticate:(Ljavax/servlet/http/HttpServletRequest;)Z
      79: ifeq          96
      82: aload_0
      83: invokevirtual #13                 // Method getNext:()Lorg/apache/catalina/Valve;
      86: aload_1
      87: aload_2
      88: invokeinterface #14,  3           // InterfaceMethod org/apache/catalina/Valve.invoke:(Lorg/apache/catalina/connector/Request;Lorg/apache/catalina/connector/Response;)V
      93: goto          113
      96: aload_2
      97: ldc           #16                 // String WWW-Authenticate
      99: ldc           #17                 // String Basic realm=\"WSO2 Carbon Authentication\"
     101: invokevirtual #18                 // Method org/apache/catalina/connector/Response.setHeader:(Ljava/lang/String;Ljava/lang/String;)V
     104: aload_2
     105: sipush        401
     108: ldc           #12                 // String
     110: invokevirtual #20                 // Method org/apache/catalina/connector/Response.sendError:(ILjava/lang/String;)V
     113: return

  private boolean authenticate(javax.servlet.http.HttpServletRequest);
    Code:
       0: aload_1
       1: ldc           #21                 // String Authorization
       3: invokeinterface #22,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getHeader:(Ljava/lang/String;)Ljava/lang/String;
       8: astore_2
       9: aload_2
      10: ifnull        317
      13: aload_2
      14: bipush        6
      16: invokevirtual #23                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      19: invokestatic  #24                 // Method decode:(Ljava/lang/String;)Ljava/lang/String;
      22: astore_3
      23: aload_3
      24: iconst_0
      25: aload_3
      26: ldc           #25                 // String :
      28: invokevirtual #26                 // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      31: invokevirtual #27                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      34: astore        4
      36: aload_3
      37: aload_3
      38: ldc           #25                 // String :
      40: invokevirtual #26                 // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      43: iconst_1
      44: iadd
      45: invokevirtual #23                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      48: astore        5
      50: aload         4
      52: bipush        64
      54: invokevirtual #28                 // Method java/lang/String.lastIndexOf:(I)I
      57: iconst_m1
      58: if_icmple     79
      61: aload         4
      63: iconst_0
      64: aload         4
      66: bipush        64
      68: invokevirtual #28                 // Method java/lang/String.lastIndexOf:(I)I
      71: invokevirtual #27                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      74: astore        6
      76: goto          83
      79: aload         4
      81: astore        6
      83: aconst_null
      84: astore        7
      86: aload         4
      88: bipush        64
      90: invokevirtual #28                 // Method java/lang/String.lastIndexOf:(I)I
      93: iconst_m1
      94: if_icmple     113
      97: aload         4
      99: aload         4
     101: bipush        64
     103: invokevirtual #29                 // Method java/lang/String.indexOf:(I)I
     106: iconst_1
     107: iadd
     108: invokevirtual #23                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     111: astore        7
     113: invokestatic  #30                 // Method org/wso2/carbon/context/CarbonContext.getThreadLocalCarbonContext:()Lorg/wso2/carbon/context/CarbonContext;
     116: invokevirtual #31                 // Method org/wso2/carbon/context/CarbonContext.getTenantDomain:()Ljava/lang/String;
     119: astore        8
     121: aload_1
     122: invokestatic  #32                 // Method org/wso2/carbon/tomcat/ext/internal/Utils.getTenantDomain:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
     125: astore        9
     127: aload         9
     129: ifnull        142
     132: aload         9
     134: aload         8
     136: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     139: ifeq          167
     142: ldc           #12                 // String
     144: aload         7
     146: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     149: ifeq          157
     152: aload         9
     154: ifnull        232
     157: aload         7
     159: aload         8
     161: invokevirtual #11                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     164: ifne          232
     167: aload         8
     169: ifnull        183
     172: aload         8
     174: invokevirtual #33                 // Method java/lang/String.trim:()Ljava/lang/String;
     177: invokevirtual #34                 // Method java/lang/String.length:()I
     180: ifne          187
     183: ldc           #35                 // String super-tenant
     185: astore        8
     187: getstatic     #36                 // Field log:Lorg/apache/commons/logging/Log;
     190: new           #37                 // class java/lang/StringBuilder
     193: dup
     194: invokespecial #38                 // Method java/lang/StringBuilder."<init>":()V
     197: ldc           #39                 // String Illegal access attempt by
     199: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     202: aload         4
     204: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     207: ldc           #41                 // String  to secured resource hosted by tenant [
     209: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     212: aload         8
     214: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     217: ldc           #42                 // String ]
     219: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     222: invokevirtual #43                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     225: invokeinterface #44,  2           // InterfaceMethod org/apache/commons/logging/Log.warn:(Ljava/lang/Object;)V
     230: iconst_0
     231: ireturn
     232: invokestatic  #45                 // Method org/wso2/carbon/tomcat/ext/internal/CarbonRealmServiceHolder.getRealmService:()Lorg/wso2/carbon/user/core/service/RealmService;
     235: astore        10
     237: aload         10
     239: invokeinterface #46,  1           // InterfaceMethod org/wso2/carbon/user/core/service/RealmService.getTenantManager:()Lorg/wso2/carbon/user/core/tenant/TenantManager;
     244: aload         7
     246: invokeinterface #47,  2           // InterfaceMethod org/wso2/carbon/user/core/tenant/TenantManager.getTenantId:(Ljava/lang/String;)I
     251: istore        11
     253: iload         11
     255: iconst_m1
     256: if_icmpne     261
     259: iconst_0
     260: ireturn
     261: aload         10
     263: iload         11
     265: invokeinterface #48,  2           // InterfaceMethod org/wso2/carbon/user/core/service/RealmService.getTenantUserRealm:(I)Lorg/wso2/carbon/user/api/UserRealm;
     270: astore        12
     272: aload         10
     274: iload         11
     276: invokeinterface #48,  2           // InterfaceMethod org/wso2/carbon/user/core/service/RealmService.getTenantUserRealm:(I)Lorg/wso2/carbon/user/api/UserRealm;
     281: invokeinterface #49,  1           // InterfaceMethod org/wso2/carbon/user/api/UserRealm.getUserStoreManager:()Lorg/wso2/carbon/user/api/UserStoreManager;
     286: aload         6
     288: aload         5
     290: invokeinterface #50,  3           // InterfaceMethod org/wso2/carbon/user/api/UserStoreManager.authenticate:(Ljava/lang/String;Ljava/lang/Object;)Z
     295: ifeq          300
     298: iconst_1
     299: ireturn
     300: goto          317
     303: astore        11
     305: getstatic     #36                 // Field log:Lorg/apache/commons/logging/Log;
     308: ldc           #52                 // String Error occurred while authenticating
     310: aload         11
     312: invokeinterface #53,  3           // InterfaceMethod org/apache/commons/logging/Log.error:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     317: iconst_0
     318: ireturn
    Exception table:
       from    to  target type
         237   260   303   Class org/wso2/carbon/user/api/UserStoreException
         261   299   303   Class org/wso2/carbon/user/api/UserStoreException

  public static java.lang.String decode(java.lang.String);
    Code:
       0: new           #37                 // class java/lang/StringBuilder
       3: dup
       4: invokespecial #38                 // Method java/lang/StringBuilder."<init>":()V
       7: astore_1
       8: aload_0
       9: invokevirtual #34                 // Method java/lang/String.length:()I
      12: iconst_3
      13: irem
      14: ifne          25
      17: aload_0
      18: invokevirtual #34                 // Method java/lang/String.length:()I
      21: istore_2
      22: goto          39
      25: aload_0
      26: invokevirtual #34                 // Method java/lang/String.length:()I
      29: iconst_3
      30: aload_0
      31: invokevirtual #34                 // Method java/lang/String.length:()I
      34: iconst_3
      35: irem
      36: isub
      37: iadd
      38: istore_2
      39: iconst_4
      40: newarray       byte
      42: astore        4
      44: iconst_0
      45: istore        6
      47: iconst_0
      48: istore        7
      50: iload         6
      52: iload_2
      53: if_icmpge     358
      56: iconst_0
      57: istore_3
      58: iload         6
      60: aload_0
      61: invokevirtual #34                 // Method java/lang/String.length:()I
      64: if_icmpge     79
      67: aload_0
      68: iload         6
      70: invokevirtual #54                 // Method java/lang/String.charAt:(I)C
      73: i2b
      74: istore        5
      76: goto          82
      79: iconst_0
      80: istore        5
      82: iload         5
      84: bipush        65
      86: if_icmplt     110
      89: iload         5
      91: bipush        91
      93: if_icmpge     110
      96: aload         4
      98: iload         7
     100: iload         5
     102: bipush        65
     104: isub
     105: i2b
     106: bastore
     107: goto          250
     110: iload         5
     112: bipush        97
     114: if_icmplt     138
     117: iload         5
     119: bipush        123
     121: if_icmpge     138
     124: aload         4
     126: iload         7
     128: iload         5
     130: bipush        71
     132: isub
     133: i2b
     134: bastore
     135: goto          250
     138: iload         5
     140: bipush        48
     142: if_icmplt     165
     145: iload         5
     147: bipush        58
     149: if_icmpge     165
     152: aload         4
     154: iload         7
     156: iload         5
     158: iconst_4
     159: iadd
     160: i2b
     161: bastore
     162: goto          250
     165: iload         5
     167: bipush        43
     169: if_icmpne     182
     172: aload         4
     174: iload         7
     176: bipush        62
     178: bastore
     179: goto          250
     182: iload         5
     184: bipush        47
     186: if_icmpne     199
     189: aload         4
     191: iload         7
     193: bipush        63
     195: bastore
     196: goto          250
     199: iload         5
     201: bipush        61
     203: if_icmpne     215
     206: aload         4
     208: iload         7
     210: iconst_0
     211: bastore
     212: goto          250
     215: iload         5
     217: i2c
     218: istore        8
     220: iload         8
     222: bipush        10
     224: if_icmpeq     248
     227: iload         8
     229: bipush        13
     231: if_icmpeq     248
     234: iload         8
     236: bipush        32
     238: if_icmpeq     248
     241: iload         8
     243: bipush        9
     245: if_icmpne     250
     248: iconst_1
     249: istore_3
     250: iload_3
     251: ifne          352
     254: iinc          7, 1
     257: iload         7
     259: iconst_4
     260: if_icmpne     352
     263: aload         4
     265: iconst_0
     266: baload
     267: bipush        18
     269: ishl
     270: aload         4
     272: iconst_1
     273: baload
     274: bipush        12
     276: ishl
     277: iadd
     278: aload         4
     280: iconst_2
     281: baload
     282: bipush        6
     284: ishl
     285: iadd
     286: aload         4
     288: iconst_3
     289: baload
     290: iadd
     291: istore        8
     293: bipush        16
     295: istore        10
     297: iload         10
     299: iflt          329
     302: iload         8
     304: iload         10
     306: ishr
     307: i2b
     308: istore        9
     310: iload         9
     312: ifle          323
     315: aload_1
     316: iload         9
     318: i2c
     319: invokevirtual #55                 // Method java/lang/StringBuilder.append:(C)Ljava/lang/StringBuilder;
     322: pop
     323: iinc          10, -8
     326: goto          297
     329: iconst_0
     330: istore        7
     332: aload         4
     334: iconst_0
     335: iconst_0
     336: bastore
     337: aload         4
     339: iconst_1
     340: iconst_0
     341: bastore
     342: aload         4
     344: iconst_2
     345: iconst_0
     346: bastore
     347: aload         4
     349: iconst_3
     350: iconst_0
     351: bastore
     352: iinc          6, 1
     355: goto          50
     358: aload_1
     359: invokevirtual #43                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     362: areturn

  static {};
    Code:
       0: ldc           #56                 // class org/wso2/carbon/tomcat/ext/valves/SecureTheWorldValve
       2: invokestatic  #57                 // Method org/apache/commons/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/commons/logging/Log;
       5: putstatic     #36                 // Field log:Lorg/apache/commons/logging/Log;
       8: return
}
