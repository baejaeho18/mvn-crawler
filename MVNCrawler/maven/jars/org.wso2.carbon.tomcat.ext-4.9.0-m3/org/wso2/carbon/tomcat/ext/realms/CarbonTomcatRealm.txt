Compiled from "CarbonTomcatRealm.java"
public class org.wso2.carbon.tomcat.ext.realms.CarbonTomcatRealm extends org.apache.catalina.realm.RealmBase {
  private static org.apache.commons.logging.Log log;

  private java.util.Map<java.lang.String, org.wso2.carbon.tomcat.ext.saas.TenantSaaSRules> tenantSaaSRulesMap;

  private boolean isSaaSEnabled;

  public boolean getEnableSaaS();
    Code:
       0: aload_0
       1: getfield      #3                  // Field isSaaSEnabled:Z
       4: ireturn

  public void setEnableSaaS(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #3                  // Field isSaaSEnabled:Z
       5: return

  public org.wso2.carbon.tomcat.ext.realms.CarbonTomcatRealm() throws java.lang.Exception;
    Code:
       0: aload_0
       1: invokespecial #4                  // Method org/apache/catalina/realm/RealmBase."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #5                  // Field tenantSaaSRulesMap:Ljava/util/Map;
       9: aload_0
      10: iconst_0
      11: putfield      #3                  // Field isSaaSEnabled:Z
      14: return

  public java.util.Map getSaasRules();
    Code:
       0: aload_0
       1: getfield      #5                  // Field tenantSaaSRulesMap:Ljava/util/Map;
       4: areturn

  public void setSaasRules(java.lang.String);
    Code:
       0: aload_0
       1: aload_0
       2: aload_1
       3: invokespecial #6                  // Method getProcessedSaaSRules:(Ljava/lang/String;)Ljava/util/Map;
       6: putfield      #5                  // Field tenantSaaSRulesMap:Ljava/util/Map;
       9: return

  protected java.lang.String getName();
    Code:
       0: aload_0
       1: invokevirtual #7                  // Method java/lang/Object.getClass:()Ljava/lang/Class;
       4: invokevirtual #8                  // Method java/lang/Class.getSimpleName:()Ljava/lang/String;
       7: areturn

  protected java.lang.String getPassword(java.lang.String);
    Code:
       0: new           #9                  // class java/lang/IllegalStateException
       3: dup
       4: ldc           #10                 // String When CarbonTomcatRealm is in operation this method getPassword(String) should never be called
       6: invokespecial #11                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
       9: athrow

  public java.security.Principal authenticate(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String);
    Code:
       0: new           #9                  // class java/lang/IllegalStateException
       3: dup
       4: ldc           #12                 // String Carbon doesn\'t use MD5 hashes. Can\'t do digest authentication
       6: invokespecial #11                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
       9: athrow

  public java.security.Principal authenticate(java.lang.String, java.lang.String);
    Code:
       0: aload_1
       1: invokestatic  #13                 // Method org/wso2/carbon/utils/multitenancy/MultitenantUtils.getTenantDomain:(Ljava/lang/String;)Ljava/lang/String;
       4: astore_3
       5: aload_1
       6: invokestatic  #2                  // Method getTenantLessUserName:(Ljava/lang/String;)Ljava/lang/String;
       9: astore        4
      11: ldc           #15                 // String carbon.super
      13: aload_3
      14: invokevirtual #16                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      17: ifeq          45
      20: new           #17                 // class java/lang/StringBuilder
      23: dup
      24: invokespecial #18                 // Method java/lang/StringBuilder."<init>":()V
      27: aload_1
      28: invokevirtual #19                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      31: ldc           #20                 // String @
      33: invokevirtual #19                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      36: ldc           #15                 // String carbon.super
      38: invokevirtual #19                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      41: invokevirtual #21                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      44: astore_1
      45: invokestatic  #22                 // Method org/wso2/carbon/tomcat/ext/internal/CarbonRealmServiceHolder.getRealmService:()Lorg/wso2/carbon/user/core/service/RealmService;
      48: astore        5
      50: aload         5
      52: invokeinterface #23,  1           // InterfaceMethod org/wso2/carbon/user/api/UserRealmService.getTenantManager:()Lorg/wso2/carbon/user/api/TenantManager;
      57: aload_3
      58: invokeinterface #24,  2           // InterfaceMethod org/wso2/carbon/user/api/TenantManager.getTenantId:(Ljava/lang/String;)I
      63: istore        6
      65: iload         6
      67: iconst_m1
      68: if_icmpne     73
      71: aconst_null
      72: areturn
      73: aload         5
      75: iload         6
      77: invokeinterface #25,  2           // InterfaceMethod org/wso2/carbon/user/api/UserRealmService.getTenantUserRealm:(I)Lorg/wso2/carbon/user/api/UserRealm;
      82: invokeinterface #26,  1           // InterfaceMethod org/wso2/carbon/user/api/UserRealm.getUserStoreManager:()Lorg/wso2/carbon/user/api/UserStoreManager;
      87: aload         4
      89: invokeinterface #27,  2           // InterfaceMethod org/wso2/carbon/user/api/UserStoreManager.getRoleListOfUser:(Ljava/lang/String;)[Ljava/lang/String;
      94: astore        7
      96: aload_0
      97: aload_3
      98: aload         4
     100: aload         7
     102: invokespecial #28                 // Method checkSaasAccess:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Z
     105: ifne          183
     108: invokestatic  #29                 // Method org/wso2/carbon/context/CarbonContext.getThreadLocalCarbonContext:()Lorg/wso2/carbon/context/CarbonContext;
     111: invokevirtual #30                 // Method org/wso2/carbon/context/CarbonContext.getTenantDomain:()Ljava/lang/String;
     114: astore        8
     116: aload_3
     117: ifnull        183
     120: aload_3
     121: aload         8
     123: invokevirtual #16                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     126: ifne          183
     129: aload         8
     131: invokevirtual #31                 // Method java/lang/String.trim:()Ljava/lang/String;
     134: invokevirtual #32                 // Method java/lang/String.length:()I
     137: ifne          144
     140: ldc           #33                 // String 0
     142: astore        8
     144: getstatic     #1                  // Field log:Lorg/apache/commons/logging/Log;
     147: new           #17                 // class java/lang/StringBuilder
     150: dup
     151: invokespecial #18                 // Method java/lang/StringBuilder."<init>":()V
     154: ldc           #34                 // String Illegal access attempt by
     156: invokevirtual #19                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     159: aload_1
     160: invokevirtual #19                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     163: ldc           #35                 // String  to secured resource hosted by tenant
     165: invokevirtual #19                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     168: aload         8
     170: invokevirtual #19                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     173: invokevirtual #21                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     176: invokeinterface #36,  2           // InterfaceMethod org/apache/commons/logging/Log.warn:(Ljava/lang/Object;)V
     181: aconst_null
     182: areturn
     183: aload         5
     185: iload         6
     187: invokeinterface #25,  2           // InterfaceMethod org/wso2/carbon/user/api/UserRealmService.getTenantUserRealm:(I)Lorg/wso2/carbon/user/api/UserRealm;
     192: invokeinterface #26,  1           // InterfaceMethod org/wso2/carbon/user/api/UserRealm.getUserStoreManager:()Lorg/wso2/carbon/user/api/UserStoreManager;
     197: aload         4
     199: aload_2
     200: invokeinterface #37,  3           // InterfaceMethod org/wso2/carbon/user/api/UserStoreManager.authenticate:(Ljava/lang/String;Ljava/lang/Object;)Z
     205: ifne          210
     208: aconst_null
     209: areturn
     210: invokestatic  #38                 // Method org/wso2/carbon/context/PrivilegedCarbonContext.getThreadLocalCarbonContext:()Lorg/wso2/carbon/context/PrivilegedCarbonContext;
     213: astore        8
     215: aload         8
     217: aload         4
     219: invokevirtual #39                 // Method org/wso2/carbon/context/PrivilegedCarbonContext.setUsername:(Ljava/lang/String;)V
     222: aload_0
     223: aload_1
     224: invokevirtual #40                 // Method getPrincipal:(Ljava/lang/String;)Ljava/security/Principal;
     227: areturn
     228: astore        5
     230: new           #42                 // class java/lang/RuntimeException
     233: dup
     234: aload         5
     236: invokevirtual #43                 // Method org/wso2/carbon/user/api/UserStoreException.getMessage:()Ljava/lang/String;
     239: aload         5
     241: invokespecial #44                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     244: athrow
    Exception table:
       from    to  target type
          45    72   228   Class org/wso2/carbon/user/api/UserStoreException
          73   182   228   Class org/wso2/carbon/user/api/UserStoreException
         183   209   228   Class org/wso2/carbon/user/api/UserStoreException
         210   227   228   Class org/wso2/carbon/user/api/UserStoreException

  private static java.lang.String getTenantLessUserName(java.lang.String);
    Code:
       0: aload_0
       1: bipush        64
       3: invokevirtual #45                 // Method java/lang/String.lastIndexOf:(I)I
       6: iconst_m1
       7: if_icmple     25
      10: aload_0
      11: iconst_0
      12: aload_0
      13: bipush        64
      15: invokevirtual #45                 // Method java/lang/String.lastIndexOf:(I)I
      18: invokevirtual #46                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      21: astore_1
      22: goto          27
      25: aload_0
      26: astore_1
      27: aload_1
      28: areturn

  private java.util.Map<java.lang.String, org.wso2.carbon.tomcat.ext.saas.TenantSaaSRules> getProcessedSaaSRules(java.lang.String);
    Code:
       0: aload_1
       1: ldc           #47                 // String \\s
       3: ldc           #48                 // String
       5: invokevirtual #49                 // Method java/lang/String.replaceAll:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
       8: ldc           #50                 // String ;
      10: invokevirtual #51                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
      13: astore_2
      14: new           #52                 // class java/util/HashMap
      17: dup
      18: invokespecial #53                 // Method java/util/HashMap."<init>":()V
      21: astore_3
      22: aload_2
      23: astore        4
      25: aload         4
      27: arraylength
      28: istore        5
      30: iconst_0
      31: istore        6
      33: iload         6
      35: iload         5
      37: if_icmpge     256
      40: aload         4
      42: iload         6
      44: aaload
      45: astore        7
      47: aload         7
      49: ldc           #54                 // String :
      51: invokevirtual #51                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
      54: astore        8
      56: aload         8
      58: iconst_0
      59: aaload
      60: astore        9
      62: new           #55                 // class org/wso2/carbon/tomcat/ext/saas/TenantSaaSRules
      65: dup
      66: invokespecial #56                 // Method org/wso2/carbon/tomcat/ext/saas/TenantSaaSRules."<init>":()V
      69: astore        10
      71: aconst_null
      72: astore        11
      74: aconst_null
      75: astore        12
      77: aload         8
      79: arraylength
      80: iconst_1
      81: if_icmple     215
      84: aload         10
      86: aload         9
      88: invokevirtual #57                 // Method org/wso2/carbon/tomcat/ext/saas/TenantSaaSRules.setTenant:(Ljava/lang/String;)V
      91: iconst_1
      92: istore        13
      94: iload         13
      96: aload         8
      98: arraylength
      99: if_icmpge     215
     102: aload         8
     104: iload         13
     106: aaload
     107: ldc           #58                 // String =
     109: invokevirtual #51                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     112: astore        14
     114: ldc           #59                 // String users
     116: aload         14
     118: iconst_0
     119: aaload
     120: invokevirtual #16                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     123: ifeq          163
     126: aload         14
     128: arraylength
     129: iconst_2
     130: if_icmpne     163
     133: new           #60                 // class java/util/ArrayList
     136: dup
     137: invokespecial #61                 // Method java/util/ArrayList."<init>":()V
     140: astore        11
     142: aload         11
     144: aload         14
     146: iconst_1
     147: aaload
     148: ldc           #62                 // String ,
     150: invokevirtual #51                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     153: invokestatic  #63                 // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
     156: invokevirtual #64                 // Method java/util/ArrayList.addAll:(Ljava/util/Collection;)Z
     159: pop
     160: goto          209
     163: ldc           #65                 // String roles
     165: aload         14
     167: iconst_0
     168: aaload
     169: invokevirtual #16                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     172: ifeq          209
     175: aload         14
     177: arraylength
     178: iconst_2
     179: if_icmpne     209
     182: new           #60                 // class java/util/ArrayList
     185: dup
     186: invokespecial #61                 // Method java/util/ArrayList."<init>":()V
     189: astore        12
     191: aload         12
     193: aload         14
     195: iconst_1
     196: aaload
     197: ldc           #62                 // String ,
     199: invokevirtual #51                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     202: invokestatic  #63                 // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
     205: invokevirtual #64                 // Method java/util/ArrayList.addAll:(Ljava/util/Collection;)Z
     208: pop
     209: iinc          13, 1
     212: goto          94
     215: aload         11
     217: ifnull        227
     220: aload         10
     222: aload         11
     224: invokevirtual #66                 // Method org/wso2/carbon/tomcat/ext/saas/TenantSaaSRules.setUsers:(Ljava/util/ArrayList;)V
     227: aload         12
     229: ifnull        239
     232: aload         10
     234: aload         12
     236: invokevirtual #67                 // Method org/wso2/carbon/tomcat/ext/saas/TenantSaaSRules.setRoles:(Ljava/util/ArrayList;)V
     239: aload_3
     240: aload         9
     242: aload         10
     244: invokeinterface #68,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     249: pop
     250: iinc          6, 1
     253: goto          33
     256: aload_3
     257: areturn

  private boolean checkSaasAccess(java.lang.String, java.lang.String, java.lang.String[]);
    Code:
       0: aload_0
       1: getfield      #3                  // Field isSaaSEnabled:Z
       4: ifne          9
       7: iconst_0
       8: ireturn
       9: aload_0
      10: getfield      #5                  // Field tenantSaaSRulesMap:Ljava/util/Map;
      13: invokeinterface #69,  1           // InterfaceMethod java/util/Map.keySet:()Ljava/util/Set;
      18: astore        4
      20: aload_3
      21: invokestatic  #63                 // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
      24: astore        5
      26: iconst_0
      27: istore        6
      29: iconst_0
      30: istore        7
      32: iconst_0
      33: istore        8
      35: aload_2
      36: ifnull        43
      39: aload_1
      40: ifnonnull     45
      43: iconst_0
      44: ireturn
      45: aload         4
      47: ldc           #70                 // String !
      49: aload_1
      50: invokevirtual #71                 // Method java/lang/String.concat:(Ljava/lang/String;)Ljava/lang/String;
      53: invokeinterface #72,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      58: ifeq          63
      61: iconst_0
      62: ireturn
      63: aload         4
      65: aload_1
      66: invokeinterface #72,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      71: ifeq          247
      74: aload_0
      75: getfield      #5                  // Field tenantSaaSRulesMap:Ljava/util/Map;
      78: aload_1
      79: invokeinterface #73,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      84: checkcast     #55                 // class org/wso2/carbon/tomcat/ext/saas/TenantSaaSRules
      87: astore        9
      89: aload         9
      91: invokevirtual #74                 // Method org/wso2/carbon/tomcat/ext/saas/TenantSaaSRules.getUsers:()Ljava/util/ArrayList;
      94: astore        10
      96: aload         9
      98: invokevirtual #75                 // Method org/wso2/carbon/tomcat/ext/saas/TenantSaaSRules.getRoles:()Ljava/util/ArrayList;
     101: astore        11
     103: aload         10
     105: ifnull        124
     108: aload         10
     110: ldc           #70                 // String !
     112: aload_2
     113: invokevirtual #71                 // Method java/lang/String.concat:(Ljava/lang/String;)Ljava/lang/String;
     116: invokevirtual #76                 // Method java/util/ArrayList.contains:(Ljava/lang/Object;)Z
     119: ifeq          124
     122: iconst_0
     123: ireturn
     124: aload         11
     126: ifnull        217
     129: iconst_0
     130: istore        12
     132: aload         5
     134: invokeinterface #77,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     139: astore        13
     141: aload         13
     143: invokeinterface #78,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     148: ifeq          196
     151: aload         13
     153: invokeinterface #79,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     158: checkcast     #80                 // class java/lang/String
     161: astore        14
     163: aload         11
     165: ldc           #70                 // String !
     167: aload         14
     169: invokevirtual #71                 // Method java/lang/String.concat:(Ljava/lang/String;)Ljava/lang/String;
     172: invokevirtual #76                 // Method java/util/ArrayList.contains:(Ljava/lang/Object;)Z
     175: ifeq          180
     178: iconst_0
     179: ireturn
     180: aload         11
     182: aload         14
     184: invokevirtual #76                 // Method java/util/ArrayList.contains:(Ljava/lang/Object;)Z
     187: ifeq          193
     190: iconst_1
     191: istore        12
     193: goto          141
     196: iload         12
     198: ifne          211
     201: aload         11
     203: ldc           #81                 // String *
     205: invokevirtual #76                 // Method java/util/ArrayList.contains:(Ljava/lang/Object;)Z
     208: ifeq          214
     211: iconst_1
     212: istore        7
     214: goto          244
     217: aload         10
     219: ifnull        244
     222: aload         10
     224: aload_2
     225: invokevirtual #76                 // Method java/util/ArrayList.contains:(Ljava/lang/Object;)Z
     228: ifne          241
     231: aload         10
     233: ldc           #81                 // String *
     235: invokevirtual #76                 // Method java/util/ArrayList.contains:(Ljava/lang/Object;)Z
     238: ifeq          244
     241: iconst_1
     242: istore        6
     244: goto          292
     247: aload         4
     249: aload_1
     250: invokeinterface #72,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
     255: ifeq          277
     258: aload_0
     259: getfield      #5                  // Field tenantSaaSRulesMap:Ljava/util/Map;
     262: aload_1
     263: invokeinterface #73,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     268: checkcast     #55                 // class org/wso2/carbon/tomcat/ext/saas/TenantSaaSRules
     271: invokevirtual #82                 // Method org/wso2/carbon/tomcat/ext/saas/TenantSaaSRules.isTenantRulesDefined:()Z
     274: ifeq          289
     277: aload         4
     279: ldc           #81                 // String *
     281: invokeinterface #72,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
     286: ifeq          292
     289: iconst_1
     290: istore        8
     292: iload         6
     294: ifne          307
     297: iload         8
     299: ifne          307
     302: iload         7
     304: ifeq          311
     307: iconst_1
     308: goto          312
     311: iconst_0
     312: ireturn

  protected java.security.Principal getPrincipal(java.lang.String);
    Code:
       0: new           #83                 // class org/wso2/carbon/tomcat/ext/realms/CarbonTomcatRealm$GenericCarbonPrincipal
       3: dup
       4: aload_1
       5: invokespecial #84                 // Method org/wso2/carbon/tomcat/ext/realms/CarbonTomcatRealm$GenericCarbonPrincipal."<init>":(Ljava/lang/String;)V
       8: areturn

  static java.lang.String access$000(java.lang.String);
    Code:
       0: aload_0
       1: invokestatic  #2                  // Method getTenantLessUserName:(Ljava/lang/String;)Ljava/lang/String;
       4: areturn

  static org.apache.commons.logging.Log access$100();
    Code:
       0: getstatic     #1                  // Field log:Lorg/apache/commons/logging/Log;
       3: areturn

  static {};
    Code:
       0: ldc           #85                 // class org/wso2/carbon/tomcat/ext/realms/CarbonTomcatRealm
       2: invokestatic  #86                 // Method org/apache/commons/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/commons/logging/Log;
       5: putstatic     #1                  // Field log:Lorg/apache/commons/logging/Log;
       8: return
}
