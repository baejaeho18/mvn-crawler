Compiled from "VaultTumbler.java"
public class org.smallmind.ansible.VaultTumbler {
  private static final java.lang.String AES_ALGORITHM;

  private final javax.crypto.Mac mac;

  private final javax.crypto.spec.SecretKeySpec aesKey;

  private final byte[] iv;

  private final byte[] salt;

  public org.smallmind.ansible.VaultTumbler(java.lang.String) throws java.security.NoSuchAlgorithmException, java.security.spec.InvalidKeySpecException, java.security.InvalidKeyException;
    Code:
       0: aload_0
       1: aload_1
       2: invokestatic  #1                  // Method generateSalt:()[B
       5: invokespecial #2                  // Method "<init>":(Ljava/lang/String;[B)V
       8: return

  public org.smallmind.ansible.VaultTumbler(java.lang.String, byte[]) throws java.security.NoSuchAlgorithmException, java.security.spec.InvalidKeySpecException, java.security.InvalidKeyException;
    Code:
       0: aload_0
       1: invokespecial #3                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc           #4                  // String HmacSHA256
       7: invokestatic  #5                  // Method javax/crypto/Mac.getInstance:(Ljava/lang/String;)Ljavax/crypto/Mac;
      10: putfield      #6                  // Field mac:Ljavax/crypto/Mac;
      13: aload_0
      14: bipush        16
      16: newarray       byte
      18: putfield      #7                  // Field iv:[B
      21: ldc           #8                  // String PBKDF2WithHmacSHA256
      23: invokestatic  #9                  // Method javax/crypto/SecretKeyFactory.getInstance:(Ljava/lang/String;)Ljavax/crypto/SecretKeyFactory;
      26: astore        4
      28: bipush        32
      30: newarray       byte
      32: astore        7
      34: bipush        32
      36: newarray       byte
      38: astore        8
      40: aload_0
      41: aload_2
      42: putfield      #10                 // Field salt:[B
      45: aload         4
      47: new           #11                 // class javax/crypto/spec/PBEKeySpec
      50: dup
      51: aload_1
      52: invokevirtual #12                 // Method java/lang/String.toCharArray:()[C
      55: aload_2
      56: sipush        10000
      59: sipush        640
      62: invokespecial #13                 // Method javax/crypto/spec/PBEKeySpec."<init>":([C[BII)V
      65: invokevirtual #14                 // Method javax/crypto/SecretKeyFactory.generateSecret:(Ljava/security/spec/KeySpec;)Ljavax/crypto/SecretKey;
      68: astore_3
      69: aload_3
      70: invokeinterface #15,  1           // InterfaceMethod javax/crypto/SecretKey.getEncoded:()[B
      75: astore        6
      77: aload         6
      79: iconst_0
      80: aload         7
      82: iconst_0
      83: bipush        32
      85: invokestatic  #16                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      88: aload         6
      90: bipush        32
      92: aload         8
      94: iconst_0
      95: bipush        32
      97: invokestatic  #16                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     100: aload         6
     102: bipush        64
     104: aload_0
     105: getfield      #7                  // Field iv:[B
     108: iconst_0
     109: bipush        16
     111: invokestatic  #16                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     114: aload_0
     115: new           #17                 // class javax/crypto/spec/SecretKeySpec
     118: dup
     119: aload         7
     121: ldc           #18                 // String AES
     123: invokespecial #19                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
     126: putfield      #20                 // Field aesKey:Ljavax/crypto/spec/SecretKeySpec;
     129: new           #17                 // class javax/crypto/spec/SecretKeySpec
     132: dup
     133: aload         8
     135: ldc           #4                  // String HmacSHA256
     137: invokespecial #19                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
     140: astore        5
     142: aload_0
     143: getfield      #6                  // Field mac:Ljavax/crypto/Mac;
     146: aload         5
     148: invokevirtual #21                 // Method javax/crypto/Mac.init:(Ljava/security/Key;)V
     151: return

  private static byte[] generateSalt();
    Code:
       0: bipush        32
       2: newarray       byte
       4: astore_0
       5: invokestatic  #22                 // Method java/util/concurrent/ThreadLocalRandom.current:()Ljava/util/concurrent/ThreadLocalRandom;
       8: aload_0
       9: invokevirtual #23                 // Method java/util/concurrent/ThreadLocalRandom.nextBytes:([B)V
      12: aload_0
      13: areturn

  public org.smallmind.ansible.VaultCake encrypt(byte[]) throws java.security.NoSuchAlgorithmException, java.security.InvalidAlgorithmParameterException, javax.crypto.NoSuchPaddingException, java.security.InvalidKeyException, javax.crypto.IllegalBlockSizeException, javax.crypto.BadPaddingException;
    Code:
       0: aload_0
       1: getfield      #20                 // Field aesKey:Ljavax/crypto/spec/SecretKeySpec;
       4: ldc           #25                 // String AES/CTR/PKCS7Padding
       6: aload_1
       7: new           #26                 // class javax/crypto/spec/IvParameterSpec
      10: dup
      11: aload_0
      12: getfield      #7                  // Field iv:[B
      15: invokespecial #27                 // Method javax/crypto/spec/IvParameterSpec."<init>":([B)V
      18: invokestatic  #28                 // Method org/smallmind/nutsnbolts/security/EncryptionUtility.encrypt:(Ljava/security/Key;Ljava/lang/String;[BLjava/security/spec/AlgorithmParameterSpec;)[B
      21: astore_2
      22: new           #29                 // class org/smallmind/ansible/VaultCake
      25: dup
      26: aload_0
      27: getfield      #10                 // Field salt:[B
      30: aload_0
      31: getfield      #6                  // Field mac:Ljavax/crypto/Mac;
      34: aload_2
      35: invokevirtual #30                 // Method javax/crypto/Mac.doFinal:([B)[B
      38: aload_2
      39: invokespecial #31                 // Method org/smallmind/ansible/VaultCake."<init>":([B[B[B)V
      42: areturn

  public byte[] decrypt(byte[], byte[]) throws java.security.NoSuchAlgorithmException, java.security.InvalidAlgorithmParameterException, javax.crypto.NoSuchPaddingException, java.security.InvalidKeyException, javax.crypto.IllegalBlockSizeException, javax.crypto.BadPaddingException, org.smallmind.ansible.VaultPasswordException;
    Code:
       0: aload_1
       1: aload_0
       2: getfield      #6                  // Field mac:Ljavax/crypto/Mac;
       5: aload_2
       6: invokevirtual #30                 // Method javax/crypto/Mac.doFinal:([B)[B
       9: invokestatic  #32                 // Method java/util/Arrays.equals:([B[B)Z
      12: ifne          29
      15: new           #33                 // class org/smallmind/ansible/VaultPasswordException
      18: dup
      19: ldc           #34                 // String Wrong password
      21: iconst_0
      22: anewarray     #35                 // class java/lang/Object
      25: invokespecial #36                 // Method org/smallmind/ansible/VaultPasswordException."<init>":(Ljava/lang/String;[Ljava/lang/Object;)V
      28: athrow
      29: aload_0
      30: getfield      #20                 // Field aesKey:Ljavax/crypto/spec/SecretKeySpec;
      33: ldc           #25                 // String AES/CTR/PKCS7Padding
      35: aload_2
      36: new           #26                 // class javax/crypto/spec/IvParameterSpec
      39: dup
      40: aload_0
      41: getfield      #7                  // Field iv:[B
      44: invokespecial #27                 // Method javax/crypto/spec/IvParameterSpec."<init>":([B)V
      47: invokestatic  #37                 // Method org/smallmind/nutsnbolts/security/EncryptionUtility.decrypt:(Ljava/security/Key;Ljava/lang/String;[BLjava/security/spec/AlgorithmParameterSpec;)[B
      50: areturn
}
