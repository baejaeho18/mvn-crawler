Compiled from "JdbcIdSegmentDistributor.java"
public class me.ahoo.cosid.jdbc.JdbcIdSegmentDistributor implements me.ahoo.cosid.segment.IdSegmentDistributor {
  private static final org.slf4j.Logger log;

  public static final java.lang.String INCREMENT_MAX_ID_SQL;

  public static final java.lang.String FETCH_MAX_ID_SQL;

  private final java.lang.String namespace;

  private final java.lang.String name;

  private final long step;

  private final javax.sql.DataSource dataSource;

  private final java.lang.String incrementMaxIdSql;

  private final java.lang.String fetchMaxIdSql;

  public me.ahoo.cosid.jdbc.JdbcIdSegmentDistributor(java.lang.String, java.lang.String, long, javax.sql.DataSource);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: lload_3
       4: ldc           #2                  // String update cosid set last_max_id=(last_max_id + ?),last_fetch_time=unix_timestamp() where name = ?;
       6: ldc           #3                  // String select last_max_id from cosid where name = ?;
       8: aload         5
      10: invokespecial #4                  // Method "<init>":(Ljava/lang/String;Ljava/lang/String;JLjava/lang/String;Ljava/lang/String;Ljavax/sql/DataSource;)V
      13: return

  public me.ahoo.cosid.jdbc.JdbcIdSegmentDistributor(java.lang.String, java.lang.String, long, java.lang.String, java.lang.String, javax.sql.DataSource);
    Code:
       0: aload_0
       1: invokespecial #5                  // Method java/lang/Object."<init>":()V
       4: aload_1
       5: invokestatic  #6                  // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
       8: ifne          15
      11: iconst_1
      12: goto          16
      15: iconst_0
      16: ldc           #7                  // String namespace can not be empty!
      18: invokestatic  #8                  // Method com/google/common/base/Preconditions.checkArgument:(ZLjava/lang/Object;)V
      21: aload_2
      22: invokestatic  #6                  // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      25: ifne          32
      28: iconst_1
      29: goto          33
      32: iconst_0
      33: ldc           #9                  // String name can not be empty!
      35: invokestatic  #8                  // Method com/google/common/base/Preconditions.checkArgument:(ZLjava/lang/Object;)V
      38: lload_3
      39: lconst_0
      40: lcmp
      41: ifle          48
      44: iconst_1
      45: goto          49
      48: iconst_0
      49: ldc           #10                 // String step:[%s] must be greater than 0!
      51: lload_3
      52: invokestatic  #11                 // Method com/google/common/base/Preconditions.checkArgument:(ZLjava/lang/String;J)V
      55: aload         5
      57: invokestatic  #6                  // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      60: ifne          67
      63: iconst_1
      64: goto          68
      67: iconst_0
      68: ldc           #12                 // String incrementMaxIdSql can not be empty!
      70: invokestatic  #8                  // Method com/google/common/base/Preconditions.checkArgument:(ZLjava/lang/Object;)V
      73: aload         6
      75: invokestatic  #6                  // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      78: ifne          85
      81: iconst_1
      82: goto          86
      85: iconst_0
      86: ldc           #13                 // String fetchMaxIdSql can not be empty!
      88: invokestatic  #8                  // Method com/google/common/base/Preconditions.checkArgument:(ZLjava/lang/Object;)V
      91: aload         7
      93: ldc           #14                 // String dataSource can not be null!
      95: invokestatic  #15                 // Method com/google/common/base/Preconditions.checkNotNull:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      98: pop
      99: aload_0
     100: aload_1
     101: putfield      #16                 // Field namespace:Ljava/lang/String;
     104: aload_0
     105: aload_2
     106: putfield      #17                 // Field name:Ljava/lang/String;
     109: aload_0
     110: lload_3
     111: putfield      #18                 // Field step:J
     114: aload_0
     115: aload         5
     117: putfield      #19                 // Field incrementMaxIdSql:Ljava/lang/String;
     120: aload_0
     121: aload         6
     123: putfield      #20                 // Field fetchMaxIdSql:Ljava/lang/String;
     126: aload_0
     127: aload         7
     129: putfield      #21                 // Field dataSource:Ljavax/sql/DataSource;
     132: return

  public java.lang.String getNamespace();
    Code:
       0: aload_0
       1: getfield      #16                 // Field namespace:Ljava/lang/String;
       4: areturn

  public java.lang.String getName();
    Code:
       0: aload_0
       1: getfield      #17                 // Field name:Ljava/lang/String;
       4: areturn

  public long getStep();
    Code:
       0: aload_0
       1: getfield      #18                 // Field step:J
       4: lreturn

  public long nextMaxId(long);
    Code:
       0: lload_1
       1: invokestatic  #22                 // InterfaceMethod me/ahoo/cosid/segment/IdSegmentDistributor.ensureStep:(J)V
       4: aload_0
       5: getfield      #21                 // Field dataSource:Ljavax/sql/DataSource;
       8: invokeinterface #23,  1           // InterfaceMethod javax/sql/DataSource.getConnection:()Ljava/sql/Connection;
      13: astore_3
      14: aconst_null
      15: astore        4
      17: aload_3
      18: iconst_0
      19: invokeinterface #24,  2           // InterfaceMethod java/sql/Connection.setAutoCommit:(Z)V
      24: aload_3
      25: aload_0
      26: getfield      #19                 // Field incrementMaxIdSql:Ljava/lang/String;
      29: invokeinterface #25,  2           // InterfaceMethod java/sql/Connection.prepareStatement:(Ljava/lang/String;)Ljava/sql/PreparedStatement;
      34: astore        5
      36: aconst_null
      37: astore        6
      39: aload         5
      41: iconst_1
      42: lload_1
      43: invokeinterface #26,  4           // InterfaceMethod java/sql/PreparedStatement.setLong:(IJ)V
      48: aload         5
      50: iconst_2
      51: aload_0
      52: invokevirtual #27                 // Method getNamespacedName:()Ljava/lang/String;
      55: invokeinterface #28,  3           // InterfaceMethod java/sql/PreparedStatement.setString:(ILjava/lang/String;)V
      60: aload         5
      62: invokeinterface #29,  1           // InterfaceMethod java/sql/PreparedStatement.executeUpdate:()I
      67: istore        7
      69: iload         7
      71: ifne          86
      74: new           #30                 // class me/ahoo/cosid/jdbc/exception/SegmentNameMissingException
      77: dup
      78: aload_0
      79: invokevirtual #27                 // Method getNamespacedName:()Ljava/lang/String;
      82: invokespecial #31                 // Method me/ahoo/cosid/jdbc/exception/SegmentNameMissingException."<init>":(Ljava/lang/String;)V
      85: athrow
      86: aload         5
      88: ifnull        181
      91: aload         6
      93: ifnull        118
      96: aload         5
      98: invokeinterface #32,  1           // InterfaceMethod java/sql/PreparedStatement.close:()V
     103: goto          181
     106: astore        7
     108: aload         6
     110: aload         7
     112: invokevirtual #34                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     115: goto          181
     118: aload         5
     120: invokeinterface #32,  1           // InterfaceMethod java/sql/PreparedStatement.close:()V
     125: goto          181
     128: astore        7
     130: aload         7
     132: astore        6
     134: aload         7
     136: athrow
     137: astore        8
     139: aload         5
     141: ifnull        178
     144: aload         6
     146: ifnull        171
     149: aload         5
     151: invokeinterface #32,  1           // InterfaceMethod java/sql/PreparedStatement.close:()V
     156: goto          178
     159: astore        9
     161: aload         6
     163: aload         9
     165: invokevirtual #34                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     168: goto          178
     171: aload         5
     173: invokeinterface #32,  1           // InterfaceMethod java/sql/PreparedStatement.close:()V
     178: aload         8
     180: athrow
     181: aload_3
     182: aload_0
     183: getfield      #20                 // Field fetchMaxIdSql:Ljava/lang/String;
     186: invokeinterface #25,  2           // InterfaceMethod java/sql/Connection.prepareStatement:(Ljava/lang/String;)Ljava/sql/PreparedStatement;
     191: astore        7
     193: aconst_null
     194: astore        8
     196: aload         7
     198: iconst_1
     199: aload_0
     200: invokevirtual #27                 // Method getNamespacedName:()Ljava/lang/String;
     203: invokeinterface #28,  3           // InterfaceMethod java/sql/PreparedStatement.setString:(ILjava/lang/String;)V
     208: aload         7
     210: invokeinterface #35,  1           // InterfaceMethod java/sql/PreparedStatement.executeQuery:()Ljava/sql/ResultSet;
     215: astore        9
     217: aconst_null
     218: astore        10
     220: aload         9
     222: invokeinterface #36,  1           // InterfaceMethod java/sql/ResultSet.next:()Z
     227: ifne          242
     230: new           #37                 // class me/ahoo/cosid/jdbc/exception/NotFoundMaxIdException
     233: dup
     234: aload_0
     235: invokevirtual #27                 // Method getNamespacedName:()Ljava/lang/String;
     238: invokespecial #38                 // Method me/ahoo/cosid/jdbc/exception/NotFoundMaxIdException."<init>":(Ljava/lang/String;)V
     241: athrow
     242: aload         9
     244: iconst_1
     245: invokeinterface #39,  2           // InterfaceMethod java/sql/ResultSet.getLong:(I)J
     250: lstore        5
     252: aload         9
     254: ifnull        347
     257: aload         10
     259: ifnull        284
     262: aload         9
     264: invokeinterface #40,  1           // InterfaceMethod java/sql/ResultSet.close:()V
     269: goto          347
     272: astore        11
     274: aload         10
     276: aload         11
     278: invokevirtual #34                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     281: goto          347
     284: aload         9
     286: invokeinterface #40,  1           // InterfaceMethod java/sql/ResultSet.close:()V
     291: goto          347
     294: astore        11
     296: aload         11
     298: astore        10
     300: aload         11
     302: athrow
     303: astore        12
     305: aload         9
     307: ifnull        344
     310: aload         10
     312: ifnull        337
     315: aload         9
     317: invokeinterface #40,  1           // InterfaceMethod java/sql/ResultSet.close:()V
     322: goto          344
     325: astore        13
     327: aload         10
     329: aload         13
     331: invokevirtual #34                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     334: goto          344
     337: aload         9
     339: invokeinterface #40,  1           // InterfaceMethod java/sql/ResultSet.close:()V
     344: aload         12
     346: athrow
     347: aload         7
     349: ifnull        442
     352: aload         8
     354: ifnull        379
     357: aload         7
     359: invokeinterface #32,  1           // InterfaceMethod java/sql/PreparedStatement.close:()V
     364: goto          442
     367: astore        9
     369: aload         8
     371: aload         9
     373: invokevirtual #34                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     376: goto          442
     379: aload         7
     381: invokeinterface #32,  1           // InterfaceMethod java/sql/PreparedStatement.close:()V
     386: goto          442
     389: astore        9
     391: aload         9
     393: astore        8
     395: aload         9
     397: athrow
     398: astore        14
     400: aload         7
     402: ifnull        439
     405: aload         8
     407: ifnull        432
     410: aload         7
     412: invokeinterface #32,  1           // InterfaceMethod java/sql/PreparedStatement.close:()V
     417: goto          439
     420: astore        15
     422: aload         8
     424: aload         15
     426: invokevirtual #34                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     429: goto          439
     432: aload         7
     434: invokeinterface #32,  1           // InterfaceMethod java/sql/PreparedStatement.close:()V
     439: aload         14
     441: athrow
     442: aload_3
     443: invokeinterface #41,  1           // InterfaceMethod java/sql/Connection.commit:()V
     448: lload         5
     450: lstore        7
     452: aload_3
     453: ifnull        488
     456: aload         4
     458: ifnull        482
     461: aload_3
     462: invokeinterface #42,  1           // InterfaceMethod java/sql/Connection.close:()V
     467: goto          488
     470: astore        9
     472: aload         4
     474: aload         9
     476: invokevirtual #34                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     479: goto          488
     482: aload_3
     483: invokeinterface #42,  1           // InterfaceMethod java/sql/Connection.close:()V
     488: lload         7
     490: lreturn
     491: astore        5
     493: aload         5
     495: astore        4
     497: aload         5
     499: athrow
     500: astore        16
     502: aload_3
     503: ifnull        538
     506: aload         4
     508: ifnull        532
     511: aload_3
     512: invokeinterface #42,  1           // InterfaceMethod java/sql/Connection.close:()V
     517: goto          538
     520: astore        17
     522: aload         4
     524: aload         17
     526: invokevirtual #34                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     529: goto          538
     532: aload_3
     533: invokeinterface #42,  1           // InterfaceMethod java/sql/Connection.close:()V
     538: aload         16
     540: athrow
     541: astore_3
     542: getstatic     #44                 // Field log:Lorg/slf4j/Logger;
     545: invokeinterface #45,  1           // InterfaceMethod org/slf4j/Logger.isErrorEnabled:()Z
     550: ifeq          566
     553: getstatic     #44                 // Field log:Lorg/slf4j/Logger;
     556: aload_3
     557: invokevirtual #46                 // Method java/sql/SQLException.getMessage:()Ljava/lang/String;
     560: aload_3
     561: invokeinterface #47,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     566: new           #48                 // class me/ahoo/cosid/CosIdException
     569: dup
     570: aload_3
     571: invokevirtual #46                 // Method java/sql/SQLException.getMessage:()Ljava/lang/String;
     574: aload_3
     575: invokespecial #49                 // Method me/ahoo/cosid/CosIdException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     578: athrow
    Exception table:
       from    to  target type
          96   103   106   Class java/lang/Throwable
          39    86   128   Class java/lang/Throwable
          39    86   137   any
         149   156   159   Class java/lang/Throwable
         128   139   137   any
         262   269   272   Class java/lang/Throwable
         220   252   294   Class java/lang/Throwable
         220   252   303   any
         315   322   325   Class java/lang/Throwable
         294   305   303   any
         357   364   367   Class java/lang/Throwable
         196   347   389   Class java/lang/Throwable
         196   347   398   any
         410   417   420   Class java/lang/Throwable
         389   400   398   any
         461   467   470   Class java/lang/Throwable
          17   452   491   Class java/lang/Throwable
          17   452   500   any
         511   517   520   Class java/lang/Throwable
         491   502   500   any
           4   488   541   Class java/sql/SQLException
         491   541   541   Class java/sql/SQLException

  static {};
    Code:
       0: ldc           #1                  // class me/ahoo/cosid/jdbc/JdbcIdSegmentDistributor
       2: invokestatic  #50                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #44                 // Field log:Lorg/slf4j/Logger;
       8: return
}
