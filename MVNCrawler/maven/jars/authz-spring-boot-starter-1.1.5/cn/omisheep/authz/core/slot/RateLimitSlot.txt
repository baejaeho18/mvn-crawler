Compiled from "RateLimitSlot.java"
public class cn.omisheep.authz.core.slot.RateLimitSlot implements cn.omisheep.authz.core.slot.Slot {
  private final cn.omisheep.authz.core.auth.ipf.Httpd httpd;

  public cn.omisheep.authz.core.slot.RateLimitSlot(cn.omisheep.authz.core.auth.ipf.Httpd);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field httpd:Lcn/omisheep/authz/core/auth/ipf/Httpd;
       9: return

  public void chain(cn.omisheep.authz.core.auth.ipf.HttpMeta, org.springframework.web.method.HandlerMethod, cn.omisheep.authz.core.slot.Error);
    Code:
       0: aload_1
       1: invokevirtual #3                  // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.getIp:()Ljava/lang/String;
       4: astore        4
       6: aload_1
       7: invokevirtual #4                  // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.getNow:()Ljava/util/Date;
      10: invokevirtual #5                  // Method java/util/Date.getTime:()J
      13: lstore        5
      15: aload_1
      16: invokevirtual #6                  // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.getMethod:()Ljava/lang/String;
      19: astore        7
      21: aload_1
      22: invokevirtual #7                  // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.getServletPath:()Ljava/lang/String;
      25: astore        8
      27: aload_1
      28: invokevirtual #8                  // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.getApi:()Ljava/lang/String;
      31: astore        9
      33: aload_0
      34: getfield      #2                  // Field httpd:Lcn/omisheep/authz/core/auth/ipf/Httpd;
      37: aload         7
      39: aload         9
      41: invokevirtual #9                  // Method cn/omisheep/authz/core/auth/ipf/Httpd.getLimitMetadata:(Ljava/lang/String;Ljava/lang/String;)Lcn/omisheep/authz/core/auth/ipf/LimitMeta;
      44: astore        10
      46: aconst_null
      47: astore        11
      49: aload_1
      50: invokevirtual #10                 // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.isHasToken:()Z
      53: ifeq          65
      56: aload_1
      57: invokevirtual #11                 // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.getToken:()Lcn/omisheep/authz/core/tk/Token;
      60: invokevirtual #12                 // Method cn/omisheep/authz/core/tk/Token.getUserId:()Ljava/lang/Object;
      63: astore        11
      65: aload         10
      67: ifnonnull     106
      70: aload_1
      71: ldc           #13                 // String 「普通访问」 \t api: [{}] ,  method: [{}] , ip : [{}] , userId : [{}] , path: [{}]
      73: iconst_5
      74: anewarray     #14                 // class java/lang/Object
      77: dup
      78: iconst_0
      79: aload         9
      81: aastore
      82: dup
      83: iconst_1
      84: aload         7
      86: aastore
      87: dup
      88: iconst_2
      89: aload         4
      91: aastore
      92: dup
      93: iconst_3
      94: aload         11
      96: aastore
      97: dup
      98: iconst_4
      99: aload         8
     101: aastore
     102: invokevirtual #15                 // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.log:(Ljava/lang/String;[Ljava/lang/Object;)V
     105: return
     106: new           #16                 // class cn/omisheep/authz/core/msg/RequestMessage
     109: dup
     110: aload         7
     112: aload         9
     114: aload         4
     116: aload         11
     118: lload         5
     120: invokespecial #17                 // Method cn/omisheep/authz/core/msg/RequestMessage."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/Object;J)V
     123: astore        12
     125: aload         12
     127: invokedynamic #18,  0             // InvokeDynamic #0:run:(Lcn/omisheep/authz/core/msg/RequestMessage;)Ljava/lang/Runnable;
     132: invokestatic  #19                 // Method cn/omisheep/commons/util/Async.run:(Ljava/lang/Runnable;)Ljava/util/concurrent/CompletableFuture;
     135: pop
     136: aload         10
     138: invokevirtual #20                 // Method cn/omisheep/authz/core/auth/ipf/LimitMeta.getCheckType:()Lcn/omisheep/authz/annotation/RateLimit$CheckType;
     141: astore        13
     143: aload_0
     144: getfield      #2                  // Field httpd:Lcn/omisheep/authz/core/auth/ipf/Httpd;
     147: invokevirtual #21                 // Method cn/omisheep/authz/core/auth/ipf/Httpd.getIpRequestPools:()Lcn/omisheep/authz/core/auth/ipf/Httpd$RequestPools;
     150: aload         7
     152: invokevirtual #22                 // Method cn/omisheep/authz/core/auth/ipf/Httpd$RequestPools.get:(Ljava/lang/Object;)Ljava/lang/Object;
     155: checkcast     #23                 // class java/util/concurrent/ConcurrentHashMap
     158: aload         9
     160: invokevirtual #24                 // Method java/util/concurrent/ConcurrentHashMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
     163: checkcast     #25                 // class cn/omisheep/authz/core/auth/ipf/Httpd$RequestPool
     166: astore        14
     168: aload_0
     169: getfield      #2                  // Field httpd:Lcn/omisheep/authz/core/auth/ipf/Httpd;
     172: invokevirtual #26                 // Method cn/omisheep/authz/core/auth/ipf/Httpd.getUserIdRequestPools:()Lcn/omisheep/authz/core/auth/ipf/Httpd$RequestPools;
     175: aload         7
     177: invokevirtual #22                 // Method cn/omisheep/authz/core/auth/ipf/Httpd$RequestPools.get:(Ljava/lang/Object;)Ljava/lang/Object;
     180: checkcast     #23                 // class java/util/concurrent/ConcurrentHashMap
     183: aload         9
     185: invokevirtual #24                 // Method java/util/concurrent/ConcurrentHashMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
     188: checkcast     #25                 // class cn/omisheep/authz/core/auth/ipf/Httpd$RequestPool
     191: astore        15
     193: aload         13
     195: getstatic     #27                 // Field cn/omisheep/authz/annotation/RateLimit$CheckType.USER_ID:Lcn/omisheep/authz/annotation/RateLimit$CheckType;
     198: invokevirtual #28                 // Method cn/omisheep/authz/annotation/RateLimit$CheckType.equals:(Ljava/lang/Object;)Z
     201: ifeq          210
     204: aload         11
     206: ifnonnull     210
     209: return
     210: aload         13
     212: getstatic     #29                 // Field cn/omisheep/authz/annotation/RateLimit$CheckType.IP:Lcn/omisheep/authz/annotation/RateLimit$CheckType;
     215: invokevirtual #28                 // Method cn/omisheep/authz/annotation/RateLimit$CheckType.equals:(Ljava/lang/Object;)Z
     218: ifeq          234
     221: aload         14
     223: aload         4
     225: invokevirtual #30                 // Method cn/omisheep/authz/core/auth/ipf/Httpd$RequestPool.get:(Ljava/lang/Object;)Ljava/lang/Object;
     228: checkcast     #31                 // class cn/omisheep/authz/core/auth/ipf/RequestMeta
     231: goto          247
     234: aload         15
     236: aload         11
     238: invokevirtual #32                 // Method java/lang/Object.toString:()Ljava/lang/String;
     241: invokevirtual #30                 // Method cn/omisheep/authz/core/auth/ipf/Httpd$RequestPool.get:(Ljava/lang/Object;)Ljava/lang/Object;
     244: checkcast     #31                 // class cn/omisheep/authz/core/auth/ipf/RequestMeta
     247: astore        16
     249: aload         16
     251: ifnull        407
     254: aload         16
     256: invokevirtual #33                 // Method cn/omisheep/authz/core/auth/ipf/RequestMeta.isBan:()Z
     259: ifeq          407
     262: aload         16
     264: lload         5
     266: invokevirtual #34                 // Method cn/omisheep/authz/core/auth/ipf/RequestMeta.enableRelive:(J)Z
     269: ifne          342
     272: aload_1
     273: getstatic     #35                 // Field org/springframework/boot/logging/LogLevel.WARN:Lorg/springframework/boot/logging/LogLevel;
     276: ldc           #36                 // String 「请求频繁、{}封锁(拒绝)」 \t api: [{}] , 距上次访问: [{}] , method: [{}] , ip : [{}] , userId : [{}] , path: [{}]
     278: bipush        7
     280: anewarray     #14                 // class java/lang/Object
     283: dup
     284: iconst_0
     285: aload         13
     287: aastore
     288: dup
     289: iconst_1
     290: aload         9
     292: aastore
     293: dup
     294: iconst_2
     295: aload         16
     297: invokevirtual #37                 // Method cn/omisheep/authz/core/auth/ipf/RequestMeta.sinceLastTime:()Ljava/lang/String;
     300: aastore
     301: dup
     302: iconst_3
     303: aload         7
     305: aastore
     306: dup
     307: iconst_4
     308: aload         4
     310: aastore
     311: dup
     312: iconst_5
     313: aload         11
     315: aastore
     316: dup
     317: bipush        6
     319: aload         8
     321: aastore
     322: invokevirtual #38                 // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.log:(Lorg/springframework/boot/logging/LogLevel;Ljava/lang/String;[Ljava/lang/Object;)V
     325: aload_3
     326: getstatic     #39                 // Field cn/omisheep/authz/core/ExceptionStatus.REQUEST_REPEAT:Lcn/omisheep/authz/core/ExceptionStatus;
     329: invokeinterface #40,  2           // InterfaceMethod cn/omisheep/authz/core/slot/Error.error:(Ljava/lang/Object;)V
     334: aload         16
     336: lload         5
     338: invokevirtual #41                 // Method cn/omisheep/authz/core/auth/ipf/RequestMeta.setLastRequestTime:(J)V
     341: return
     342: aload_1
     343: ldc           #42                 // String 「解除{}封禁(解封)」 \t api: [{}] , 距上次访问: [{}] , method: [{}] , ip : [{}] , userId : [{}] , path: [{}]
     345: bipush        7
     347: anewarray     #14                 // class java/lang/Object
     350: dup
     351: iconst_0
     352: aload         13
     354: aastore
     355: dup
     356: iconst_1
     357: aload         9
     359: aastore
     360: dup
     361: iconst_2
     362: aload         16
     364: invokevirtual #37                 // Method cn/omisheep/authz/core/auth/ipf/RequestMeta.sinceLastTime:()Ljava/lang/String;
     367: aastore
     368: dup
     369: iconst_3
     370: aload         7
     372: aastore
     373: dup
     374: iconst_4
     375: aload         4
     377: aastore
     378: dup
     379: iconst_5
     380: aload         11
     382: aastore
     383: dup
     384: bipush        6
     386: aload         8
     388: aastore
     389: invokevirtual #15                 // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.log:(Ljava/lang/String;[Ljava/lang/Object;)V
     392: aload_0
     393: getfield      #2                  // Field httpd:Lcn/omisheep/authz/core/auth/ipf/Httpd;
     396: aload         16
     398: aload         10
     400: aload         7
     402: aload         9
     404: invokevirtual #43                 // Method cn/omisheep/authz/core/auth/ipf/Httpd.relive:(Lcn/omisheep/authz/core/auth/ipf/RequestMeta;Lcn/omisheep/authz/core/auth/ipf/LimitMeta;Ljava/lang/String;Ljava/lang/String;)V
     407: aload         16
     409: ifnonnull     507
     412: aload         13
     414: getstatic     #29                 // Field cn/omisheep/authz/annotation/RateLimit$CheckType.IP:Lcn/omisheep/authz/annotation/RateLimit$CheckType;
     417: invokevirtual #28                 // Method cn/omisheep/authz/annotation/RateLimit$CheckType.equals:(Ljava/lang/Object;)Z
     420: ifeq          446
     423: aload         14
     425: aload         4
     427: new           #31                 // class cn/omisheep/authz/core/auth/ipf/RequestMeta
     430: dup
     431: lload         5
     433: aload         4
     435: aconst_null
     436: invokespecial #44                 // Method cn/omisheep/authz/core/auth/ipf/RequestMeta."<init>":(JLjava/lang/String;Ljava/lang/Object;)V
     439: invokevirtual #45                 // Method cn/omisheep/authz/core/auth/ipf/Httpd$RequestPool.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     442: pop
     443: goto          469
     446: aload         15
     448: aload         11
     450: invokevirtual #32                 // Method java/lang/Object.toString:()Ljava/lang/String;
     453: new           #31                 // class cn/omisheep/authz/core/auth/ipf/RequestMeta
     456: dup
     457: lload         5
     459: aconst_null
     460: aload         11
     462: invokespecial #44                 // Method cn/omisheep/authz/core/auth/ipf/RequestMeta."<init>":(JLjava/lang/String;Ljava/lang/Object;)V
     465: invokevirtual #45                 // Method cn/omisheep/authz/core/auth/ipf/Httpd$RequestPool.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     468: pop
     469: aload_1
     470: ldc           #46                 // String 「普通访问(首次)」 \t method: [{}] , api: [{}] , ip : [{}] , userId: [{}] , path: [{}]
     472: iconst_5
     473: anewarray     #14                 // class java/lang/Object
     476: dup
     477: iconst_0
     478: aload         7
     480: aastore
     481: dup
     482: iconst_1
     483: aload         9
     485: aastore
     486: dup
     487: iconst_2
     488: aload         4
     490: aastore
     491: dup
     492: iconst_3
     493: aload         11
     495: aastore
     496: dup
     497: iconst_4
     498: aload         8
     500: aastore
     501: invokevirtual #15                 // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.log:(Ljava/lang/String;[Ljava/lang/Object;)V
     504: goto          658
     507: aload         16
     509: lload         5
     511: aload         10
     513: invokevirtual #47                 // Method cn/omisheep/authz/core/auth/ipf/LimitMeta.getMaxRequests:()I
     516: aload         10
     518: invokevirtual #48                 // Method cn/omisheep/authz/core/auth/ipf/LimitMeta.getWindow:()J
     521: aload         10
     523: invokevirtual #49                 // Method cn/omisheep/authz/core/auth/ipf/LimitMeta.getMinInterval:()J
     526: invokevirtual #50                 // Method cn/omisheep/authz/core/auth/ipf/RequestMeta.request:(JIJJ)Z
     529: ifeq          579
     532: aload_1
     533: ldc           #51                 // String 「普通访问(正常)」 \t 距上次访问: [{}]  api: [{}] ,  method: [{}] , ip : [{}] , userId : [{}] , path: [{}]
     535: bipush        6
     537: anewarray     #14                 // class java/lang/Object
     540: dup
     541: iconst_0
     542: aload         16
     544: invokevirtual #37                 // Method cn/omisheep/authz/core/auth/ipf/RequestMeta.sinceLastTime:()Ljava/lang/String;
     547: aastore
     548: dup
     549: iconst_1
     550: aload         9
     552: aastore
     553: dup
     554: iconst_2
     555: aload         7
     557: aastore
     558: dup
     559: iconst_3
     560: aload         4
     562: aastore
     563: dup
     564: iconst_4
     565: aload         11
     567: aastore
     568: dup
     569: iconst_5
     570: aload         8
     572: aastore
     573: invokevirtual #15                 // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.log:(Ljava/lang/String;[Ljava/lang/Object;)V
     576: goto          658
     579: aload_0
     580: getfield      #2                  // Field httpd:Lcn/omisheep/authz/core/auth/ipf/Httpd;
     583: lload         5
     585: aload         16
     587: aload         10
     589: aload         7
     591: aload         9
     593: invokevirtual #52                 // Method cn/omisheep/authz/core/auth/ipf/Httpd.forbid:(JLcn/omisheep/authz/core/auth/ipf/RequestMeta;Lcn/omisheep/authz/core/auth/ipf/LimitMeta;Ljava/lang/String;Ljava/lang/String;)V
     596: aload_1
     597: getstatic     #35                 // Field org/springframework/boot/logging/LogLevel.WARN:Lorg/springframework/boot/logging/LogLevel;
     600: ldc           #53                 // String 「请求频繁、{}封锁(封禁)」 \t api: [{}] , 距上次访问: [{}] , method: [{}] , ip : [{}] , userId : [{}] , path: [{}]
     602: bipush        7
     604: anewarray     #14                 // class java/lang/Object
     607: dup
     608: iconst_0
     609: aload         13
     611: aastore
     612: dup
     613: iconst_1
     614: aload         9
     616: aastore
     617: dup
     618: iconst_2
     619: aload         16
     621: invokevirtual #37                 // Method cn/omisheep/authz/core/auth/ipf/RequestMeta.sinceLastTime:()Ljava/lang/String;
     624: aastore
     625: dup
     626: iconst_3
     627: aload         7
     629: aastore
     630: dup
     631: iconst_4
     632: aload         4
     634: aastore
     635: dup
     636: iconst_5
     637: aload         11
     639: aastore
     640: dup
     641: bipush        6
     643: aload         8
     645: aastore
     646: invokevirtual #38                 // Method cn/omisheep/authz/core/auth/ipf/HttpMeta.log:(Lorg/springframework/boot/logging/LogLevel;Ljava/lang/String;[Ljava/lang/Object;)V
     649: aload_3
     650: getstatic     #39                 // Field cn/omisheep/authz/core/ExceptionStatus.REQUEST_REPEAT:Lcn/omisheep/authz/core/ExceptionStatus;
     653: invokeinterface #40,  2           // InterfaceMethod cn/omisheep/authz/core/slot/Error.error:(Ljava/lang/Object;)V
     658: return

  private static void lambda$chain$0(cn.omisheep.authz.core.msg.RequestMessage);
    Code:
       0: getstatic     #54                 // Field cn/omisheep/authz/core/msg/RequestMessage.CHANNEL:Ljava/lang/String;
       3: aload_0
       4: invokestatic  #55                 // Method cn/omisheep/authz/core/util/RedisUtils.publish:(Ljava/lang/String;Ljava/lang/Object;)V
       7: return
}
