Compiled from "BasicAuthenticationMechanism.java"
public class io.undertow.security.impl.BasicAuthenticationMechanism implements io.undertow.security.api.AuthenticationMechanism {
  public static final java.lang.String SILENT;

  public static final java.lang.String CHARSET;

  public static final java.lang.String USER_AGENT_CHARSETS;

  private final java.lang.String name;

  private final java.lang.String challenge;

  private static final java.lang.String BASIC_PREFIX;

  private static final java.lang.String LOWERCASE_BASIC_PREFIX;

  private static final int PREFIX_LENGTH;

  private static final java.lang.String COLON;

  private final boolean silent;

  private final io.undertow.security.idm.IdentityManager identityManager;

  private final java.nio.charset.Charset charset;

  private final java.util.Map<java.util.regex.Pattern, java.nio.charset.Charset> userAgentCharsets;

  public io.undertow.security.impl.BasicAuthenticationMechanism(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: ldc           #2                  // String BASIC
       4: invokespecial #3                  // Method "<init>":(Ljava/lang/String;Ljava/lang/String;)V
       7: return

  public io.undertow.security.impl.BasicAuthenticationMechanism(java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: iconst_0
       4: invokespecial #4                  // Method "<init>":(Ljava/lang/String;Ljava/lang/String;Z)V
       7: return

  public io.undertow.security.impl.BasicAuthenticationMechanism(java.lang.String, java.lang.String, boolean);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: iload_3
       4: aconst_null
       5: invokespecial #5                  // Method "<init>":(Ljava/lang/String;Ljava/lang/String;ZLio/undertow/security/idm/IdentityManager;)V
       8: return

  public io.undertow.security.impl.BasicAuthenticationMechanism(java.lang.String, java.lang.String, boolean, io.undertow.security.idm.IdentityManager);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: iload_3
       4: aload         4
       6: getstatic     #6                  // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
       9: invokestatic  #7                  // Method java/util/Collections.emptyMap:()Ljava/util/Map;
      12: invokespecial #8                  // Method "<init>":(Ljava/lang/String;Ljava/lang/String;ZLio/undertow/security/idm/IdentityManager;Ljava/nio/charset/Charset;Ljava/util/Map;)V
      15: return

  public io.undertow.security.impl.BasicAuthenticationMechanism(java.lang.String, java.lang.String, boolean, io.undertow.security.idm.IdentityManager, java.nio.charset.Charset, java.util.Map<java.util.regex.Pattern, java.nio.charset.Charset>);
    Code:
       0: aload_0
       1: invokespecial #9                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #10                 // class java/lang/StringBuilder
       8: dup
       9: invokespecial #11                 // Method java/lang/StringBuilder."<init>":()V
      12: getstatic     #12                 // Field BASIC_PREFIX:Ljava/lang/String;
      15: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      18: ldc           #14                 // String realm=\"
      20: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      23: aload_1
      24: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      27: ldc           #15                 // String \"
      29: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      32: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      35: putfield      #17                 // Field challenge:Ljava/lang/String;
      38: aload_0
      39: aload_2
      40: putfield      #18                 // Field name:Ljava/lang/String;
      43: aload_0
      44: iload_3
      45: putfield      #19                 // Field silent:Z
      48: aload_0
      49: aload         4
      51: putfield      #20                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
      54: aload_0
      55: aload         5
      57: putfield      #21                 // Field charset:Ljava/nio/charset/Charset;
      60: aload_0
      61: new           #22                 // class java/util/LinkedHashMap
      64: dup
      65: aload         6
      67: invokespecial #23                 // Method java/util/LinkedHashMap."<init>":(Ljava/util/Map;)V
      70: invokestatic  #24                 // Method java/util/Collections.unmodifiableMap:(Ljava/util/Map;)Ljava/util/Map;
      73: putfield      #25                 // Field userAgentCharsets:Ljava/util/Map;
      76: return

  private io.undertow.security.idm.IdentityManager getIdentityManager(io.undertow.security.api.SecurityContext);
    Code:
       0: aload_0
       1: getfield      #20                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
       4: ifnull        14
       7: aload_0
       8: getfield      #20                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
      11: goto          20
      14: aload_1
      15: invokeinterface #26,  1           // InterfaceMethod io/undertow/security/api/SecurityContext.getIdentityManager:()Lio/undertow/security/idm/IdentityManager;
      20: areturn

  public io.undertow.security.api.AuthenticationMechanism$AuthenticationMechanismOutcome authenticate(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_1
       1: invokevirtual #27                 // Method io/undertow/server/HttpServerExchange.getRequestHeaders:()Lio/undertow/util/HeaderMap;
       4: getstatic     #28                 // Field io/undertow/util/Headers.AUTHORIZATION:Lio/undertow/util/HttpString;
       7: invokevirtual #29                 // Method io/undertow/util/HeaderMap.get:(Lio/undertow/util/HttpString;)Lio/undertow/util/HeaderValues;
      10: astore_3
      11: aload_3
      12: ifnull        379
      15: aload_3
      16: invokeinterface #30,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      21: astore        4
      23: aload         4
      25: invokeinterface #31,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      30: ifeq          379
      33: aload         4
      35: invokeinterface #32,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      40: checkcast     #33                 // class java/lang/String
      43: astore        5
      45: aload         5
      47: getstatic     #34                 // Field java/util/Locale.ENGLISH:Ljava/util/Locale;
      50: invokevirtual #35                 // Method java/lang/String.toLowerCase:(Ljava/util/Locale;)Ljava/lang/String;
      53: getstatic     #36                 // Field LOWERCASE_BASIC_PREFIX:Ljava/lang/String;
      56: invokevirtual #37                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      59: ifeq          376
      62: aload         5
      64: getstatic     #38                 // Field PREFIX_LENGTH:I
      67: invokevirtual #39                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      70: astore        6
      72: aconst_null
      73: astore        7
      75: aload         6
      77: invokestatic  #40                 // Method io/undertow/util/FlexBase64.decode:(Ljava/lang/String;)Ljava/nio/ByteBuffer;
      80: astore        8
      82: aload_0
      83: getfield      #21                 // Field charset:Ljava/nio/charset/Charset;
      86: astore        9
      88: aload_0
      89: getfield      #25                 // Field userAgentCharsets:Ljava/util/Map;
      92: invokeinterface #41,  1           // InterfaceMethod java/util/Map.isEmpty:()Z
      97: ifne          194
     100: aload_1
     101: invokevirtual #27                 // Method io/undertow/server/HttpServerExchange.getRequestHeaders:()Lio/undertow/util/HeaderMap;
     104: getstatic     #42                 // Field io/undertow/util/Headers.USER_AGENT:Lio/undertow/util/HttpString;
     107: invokevirtual #43                 // Method io/undertow/util/HeaderMap.getFirst:(Lio/undertow/util/HttpString;)Ljava/lang/String;
     110: astore        10
     112: aload         10
     114: ifnull        194
     117: aload_0
     118: getfield      #25                 // Field userAgentCharsets:Ljava/util/Map;
     121: invokeinterface #44,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
     126: invokeinterface #45,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     131: astore        11
     133: aload         11
     135: invokeinterface #31,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     140: ifeq          194
     143: aload         11
     145: invokeinterface #32,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     150: checkcast     #46                 // class java/util/Map$Entry
     153: astore        12
     155: aload         12
     157: invokeinterface #47,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
     162: checkcast     #48                 // class java/util/regex/Pattern
     165: aload         10
     167: invokevirtual #49                 // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
     170: invokevirtual #50                 // Method java/util/regex/Matcher.find:()Z
     173: ifeq          191
     176: aload         12
     178: invokeinterface #51,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     183: checkcast     #52                 // class java/nio/charset/Charset
     186: astore        9
     188: goto          194
     191: goto          133
     194: new           #33                 // class java/lang/String
     197: dup
     198: aload         8
     200: invokevirtual #53                 // Method java/nio/ByteBuffer.array:()[B
     203: aload         8
     205: invokevirtual #54                 // Method java/nio/ByteBuffer.arrayOffset:()I
     208: aload         8
     210: invokevirtual #55                 // Method java/nio/ByteBuffer.limit:()I
     213: aload         9
     215: invokespecial #56                 // Method java/lang/String."<init>":([BIILjava/nio/charset/Charset;)V
     218: astore        7
     220: goto          225
     223: astore        8
     225: aload         7
     227: ifnull        372
     230: aload         7
     232: ldc           #59                 // String :
     234: invokevirtual #60                 // Method java/lang/String.indexOf:(Ljava/lang/String;)I
     237: dup
     238: istore        8
     240: iconst_m1
     241: if_icmple     372
     244: aload         7
     246: iconst_0
     247: iload         8
     249: invokevirtual #61                 // Method java/lang/String.substring:(II)Ljava/lang/String;
     252: astore        9
     254: aload         7
     256: iload         8
     258: iconst_1
     259: iadd
     260: invokevirtual #39                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     263: invokevirtual #62                 // Method java/lang/String.toCharArray:()[C
     266: astore        10
     268: aload_0
     269: aload_2
     270: invokespecial #63                 // Method getIdentityManager:(Lio/undertow/security/api/SecurityContext;)Lio/undertow/security/idm/IdentityManager;
     273: astore        11
     275: new           #64                 // class io/undertow/security/idm/PasswordCredential
     278: dup
     279: aload         10
     281: invokespecial #65                 // Method io/undertow/security/idm/PasswordCredential."<init>":([C)V
     284: astore        12
     286: aload         11
     288: aload         9
     290: aload         12
     292: invokeinterface #66,  3           // InterfaceMethod io/undertow/security/idm/IdentityManager.verify:(Ljava/lang/String;Lio/undertow/security/idm/Credential;)Lio/undertow/security/idm/Account;
     297: astore        14
     299: aload         14
     301: ifnull        325
     304: aload_2
     305: aload         14
     307: aload_0
     308: getfield      #18                 // Field name:Ljava/lang/String;
     311: iconst_0
     312: invokeinterface #67,  4           // InterfaceMethod io/undertow/security/api/SecurityContext.authenticationComplete:(Lio/undertow/security/idm/Account;Ljava/lang/String;Z)V
     317: getstatic     #68                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     320: astore        13
     322: goto          350
     325: aload_2
     326: getstatic     #69                 // Field io/undertow/UndertowMessages.MESSAGES:Lio/undertow/UndertowMessages;
     329: aload         9
     331: invokeinterface #70,  2           // InterfaceMethod io/undertow/UndertowMessages.authenticationFailed:(Ljava/lang/String;)Ljava/lang/String;
     336: aload_0
     337: getfield      #18                 // Field name:Ljava/lang/String;
     340: invokeinterface #71,  3           // InterfaceMethod io/undertow/security/api/SecurityContext.authenticationFailed:(Ljava/lang/String;Ljava/lang/String;)V
     345: getstatic     #72                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     348: astore        13
     350: aload         13
     352: astore        15
     354: aload         10
     356: invokestatic  #73                 // Method clear:([C)V
     359: aload         15
     361: areturn
     362: astore        16
     364: aload         10
     366: invokestatic  #73                 // Method clear:([C)V
     369: aload         16
     371: athrow
     372: getstatic     #72                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_AUTHENTICATED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     375: areturn
     376: goto          23
     379: getstatic     #74                 // Field io/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome.NOT_ATTEMPTED:Lio/undertow/security/api/AuthenticationMechanism$AuthenticationMechanismOutcome;
     382: areturn
    Exception table:
       from    to  target type
          75   220   223   Class java/io/IOException
         286   354   362   any
         362   364   362   any

  public io.undertow.security.api.AuthenticationMechanism$ChallengeResult sendChallenge(io.undertow.server.HttpServerExchange, io.undertow.security.api.SecurityContext);
    Code:
       0: aload_0
       1: getfield      #19                 // Field silent:Z
       4: ifeq          31
       7: aload_1
       8: invokevirtual #27                 // Method io/undertow/server/HttpServerExchange.getRequestHeaders:()Lio/undertow/util/HeaderMap;
      11: getstatic     #28                 // Field io/undertow/util/Headers.AUTHORIZATION:Lio/undertow/util/HttpString;
      14: invokevirtual #43                 // Method io/undertow/util/HeaderMap.getFirst:(Lio/undertow/util/HttpString;)Ljava/lang/String;
      17: astore_3
      18: aload_3
      19: ifnonnull     31
      22: new           #75                 // class io/undertow/security/api/AuthenticationMechanism$ChallengeResult
      25: dup
      26: iconst_0
      27: invokespecial #76                 // Method io/undertow/security/api/AuthenticationMechanism$ChallengeResult."<init>":(Z)V
      30: areturn
      31: aload_1
      32: invokevirtual #77                 // Method io/undertow/server/HttpServerExchange.getResponseHeaders:()Lio/undertow/util/HeaderMap;
      35: getstatic     #78                 // Field io/undertow/util/Headers.WWW_AUTHENTICATE:Lio/undertow/util/HttpString;
      38: aload_0
      39: getfield      #17                 // Field challenge:Ljava/lang/String;
      42: invokevirtual #79                 // Method io/undertow/util/HeaderMap.add:(Lio/undertow/util/HttpString;Ljava/lang/String;)Lio/undertow/util/HeaderMap;
      45: pop
      46: new           #75                 // class io/undertow/security/api/AuthenticationMechanism$ChallengeResult
      49: dup
      50: iconst_1
      51: sipush        401
      54: invokestatic  #80                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      57: invokespecial #81                 // Method io/undertow/security/api/AuthenticationMechanism$ChallengeResult."<init>":(ZLjava/lang/Integer;)V
      60: areturn

  private static void clear(char[]);
    Code:
       0: iconst_0
       1: istore_1
       2: iload_1
       3: aload_0
       4: arraylength
       5: if_icmpge     18
       8: aload_0
       9: iload_1
      10: iconst_0
      11: castore
      12: iinc          1, 1
      15: goto          2
      18: return

  static {};
    Code:
       0: new           #10                 // class java/lang/StringBuilder
       3: dup
       4: invokespecial #11                 // Method java/lang/StringBuilder."<init>":()V
       7: getstatic     #82                 // Field io/undertow/util/Headers.BASIC:Lio/undertow/util/HttpString;
      10: invokevirtual #83                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      13: ldc           #84                 // String
      15: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      18: invokevirtual #16                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      21: putstatic     #12                 // Field BASIC_PREFIX:Ljava/lang/String;
      24: getstatic     #12                 // Field BASIC_PREFIX:Ljava/lang/String;
      27: getstatic     #34                 // Field java/util/Locale.ENGLISH:Ljava/util/Locale;
      30: invokevirtual #35                 // Method java/lang/String.toLowerCase:(Ljava/util/Locale;)Ljava/lang/String;
      33: putstatic     #36                 // Field LOWERCASE_BASIC_PREFIX:Ljava/lang/String;
      36: getstatic     #12                 // Field BASIC_PREFIX:Ljava/lang/String;
      39: invokevirtual #85                 // Method java/lang/String.length:()I
      42: putstatic     #38                 // Field PREFIX_LENGTH:I
      45: return
}
