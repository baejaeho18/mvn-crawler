Compiled from "ConsumerLocalIndexStore.java"
public class org.joyqueue.client.internal.consumer.support.ConsumerLocalIndexStore extends org.joyqueue.toolkit.service.Service {
  protected static final org.slf4j.Logger logger;

  private java.lang.String persistPath;

  private int persistInterval;

  private java.io.File persistFile;

  private volatile boolean isNeedPersist;

  private java.util.concurrent.ScheduledExecutorService persistTimer;

  private com.google.common.collect.Table<java.lang.String, java.lang.String, java.util.Map<java.lang.Short, org.joyqueue.client.internal.consumer.domain.LocalIndexData>> indexTable;

  public org.joyqueue.client.internal.consumer.support.ConsumerLocalIndexStore(java.lang.String, int);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/joyqueue/toolkit/service/Service."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field persistPath:Ljava/lang/String;
       9: aload_0
      10: iload_2
      11: putfield      #3                  // Field persistInterval:I
      14: return

  protected void validate() throws java.lang.Exception;
    Code:
       0: aload_0
       1: aload_0
       2: aload_0
       3: getfield      #2                  // Field persistPath:Ljava/lang/String;
       6: invokevirtual #4                  // Method initPersistPathFile:(Ljava/lang/String;)Ljava/io/File;
       9: putfield      #5                  // Field persistFile:Ljava/io/File;
      12: aload_0
      13: aload_0
      14: aload_0
      15: getfield      #5                  // Field persistFile:Ljava/io/File;
      18: invokevirtual #6                  // Method doRead:(Ljava/io/File;)Lcom/google/common/collect/Table;
      21: putfield      #7                  // Field indexTable:Lcom/google/common/collect/Table;
      24: aload_0
      25: new           #8                  // class org/joyqueue/toolkit/concurrent/NamedThreadFactory
      28: dup
      29: ldc           #9                  // String joyqueue-consumer-local-index-persist
      31: invokespecial #10                 // Method org/joyqueue/toolkit/concurrent/NamedThreadFactory."<init>":(Ljava/lang/String;)V
      34: invokestatic  #11                 // Method java/util/concurrent/Executors.newSingleThreadScheduledExecutor:(Ljava/util/concurrent/ThreadFactory;)Ljava/util/concurrent/ScheduledExecutorService;
      37: putfield      #12                 // Field persistTimer:Ljava/util/concurrent/ScheduledExecutorService;
      40: return

  protected void doStart() throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #12                 // Field persistTimer:Ljava/util/concurrent/ScheduledExecutorService;
       4: new           #13                 // class org/joyqueue/client/internal/consumer/support/ConsumerLocalIndexStore$1
       7: dup
       8: aload_0
       9: invokespecial #14                 // Method org/joyqueue/client/internal/consumer/support/ConsumerLocalIndexStore$1."<init>":(Lorg/joyqueue/client/internal/consumer/support/ConsumerLocalIndexStore;)V
      12: aload_0
      13: getfield      #3                  // Field persistInterval:I
      16: i2l
      17: aload_0
      18: getfield      #3                  // Field persistInterval:I
      21: i2l
      22: getstatic     #15                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
      25: invokeinterface #16,  7           // InterfaceMethod java/util/concurrent/ScheduledExecutorService.scheduleWithFixedDelay:(Ljava/lang/Runnable;JJLjava/util/concurrent/TimeUnit;)Ljava/util/concurrent/ScheduledFuture;
      30: pop
      31: return

  protected void doStop();
    Code:
       0: aload_0
       1: getfield      #12                 // Field persistTimer:Ljava/util/concurrent/ScheduledExecutorService;
       4: ifnull        16
       7: aload_0
       8: getfield      #12                 // Field persistTimer:Ljava/util/concurrent/ScheduledExecutorService;
      11: invokeinterface #17,  1           // InterfaceMethod java/util/concurrent/ScheduledExecutorService.shutdown:()V
      16: return

  public org.joyqueue.client.internal.consumer.domain.LocalIndexData fetchIndex(java.lang.String, java.lang.String, short);
    Code:
       0: aload_0
       1: getfield      #7                  // Field indexTable:Lcom/google/common/collect/Table;
       4: aload_2
       5: aload_1
       6: invokeinterface #18,  3           // InterfaceMethod com/google/common/collect/Table.get:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      11: checkcast     #19                 // class java/util/Map
      14: astore        4
      16: aload         4
      18: ifnonnull     23
      21: aconst_null
      22: areturn
      23: aload         4
      25: iload_3
      26: invokestatic  #20                 // Method java/lang/Short.valueOf:(S)Ljava/lang/Short;
      29: invokeinterface #21,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      34: checkcast     #22                 // class org/joyqueue/client/internal/consumer/domain/LocalIndexData
      37: areturn

  public boolean saveIndex(java.lang.String, java.lang.String, short, long);
    Code:
       0: invokestatic  #23                 // Method org/joyqueue/toolkit/time/SystemClock.now:()J
       3: lstore        6
       5: aload_0
       6: getfield      #7                  // Field indexTable:Lcom/google/common/collect/Table;
       9: aload_2
      10: aload_1
      11: invokeinterface #18,  3           // InterfaceMethod com/google/common/collect/Table.get:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      16: checkcast     #19                 // class java/util/Map
      19: astore        8
      21: aload         8
      23: ifnonnull     45
      26: invokestatic  #24                 // Method com/google/common/collect/Maps.newHashMap:()Ljava/util/HashMap;
      29: astore        8
      31: aload_0
      32: getfield      #7                  // Field indexTable:Lcom/google/common/collect/Table;
      35: aload_2
      36: aload_1
      37: aload         8
      39: invokeinterface #25,  4           // InterfaceMethod com/google/common/collect/Table.put:(Ljava/lang/Object;Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      44: pop
      45: aload         8
      47: iload_3
      48: invokestatic  #20                 // Method java/lang/Short.valueOf:(S)Ljava/lang/Short;
      51: invokeinterface #21,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      56: checkcast     #22                 // class org/joyqueue/client/internal/consumer/domain/LocalIndexData
      59: astore        9
      61: aload         9
      63: ifnonnull     96
      66: new           #22                 // class org/joyqueue/client/internal/consumer/domain/LocalIndexData
      69: dup
      70: invokespecial #26                 // Method org/joyqueue/client/internal/consumer/domain/LocalIndexData."<init>":()V
      73: astore        9
      75: aload         9
      77: lload         6
      79: invokevirtual #27                 // Method org/joyqueue/client/internal/consumer/domain/LocalIndexData.setCreateTime:(J)V
      82: aload         8
      84: iload_3
      85: invokestatic  #20                 // Method java/lang/Short.valueOf:(S)Ljava/lang/Short;
      88: aload         9
      90: invokeinterface #28,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      95: pop
      96: aload         9
      98: lload         4
     100: invokevirtual #29                 // Method org/joyqueue/client/internal/consumer/domain/LocalIndexData.setIndex:(J)V
     103: aload         9
     105: lload         6
     107: invokevirtual #30                 // Method org/joyqueue/client/internal/consumer/domain/LocalIndexData.setUpdateTime:(J)V
     110: aload_0
     111: iconst_1
     112: putfield      #31                 // Field isNeedPersist:Z
     115: iconst_1
     116: ireturn

  protected java.io.File initPersistPathFile(java.lang.String) throws java.lang.Exception;
    Code:
       0: new           #32                 // class java/io/File
       3: dup
       4: aload_1
       5: invokespecial #33                 // Method java/io/File."<init>":(Ljava/lang/String;)V
       8: astore_2
       9: aload_2
      10: invokevirtual #34                 // Method java/io/File.isDirectory:()Z
      13: ifeq          26
      16: new           #35                 // class java/lang/IllegalArgumentException
      19: dup
      20: ldc           #36                 // String local index store path is not directory
      22: invokespecial #37                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      25: athrow
      26: aload_2
      27: invokevirtual #38                 // Method java/io/File.exists:()Z
      30: ifne          46
      33: aload_2
      34: invokevirtual #39                 // Method java/io/File.getParentFile:()Ljava/io/File;
      37: invokevirtual #40                 // Method java/io/File.mkdirs:()Z
      40: pop
      41: aload_2
      42: invokevirtual #41                 // Method java/io/File.createNewFile:()Z
      45: pop
      46: aload_2
      47: areturn

  protected com.google.common.collect.Table<java.lang.String, java.lang.String, java.util.Map<java.lang.Short, org.joyqueue.client.internal.consumer.domain.LocalIndexData>> doRead(java.io.File) throws java.lang.Exception;
    Code:
       0: aload_1
       1: invokestatic  #42                 // Method org/apache/commons/io/FileUtils.readFileToString:(Ljava/io/File;)Ljava/lang/String;
       4: astore_2
       5: invokestatic  #43                 // Method com/google/common/collect/HashBasedTable.create:()Lcom/google/common/collect/HashBasedTable;
       8: astore_3
       9: aload_2
      10: invokestatic  #44                 // Method org/apache/commons/lang3/StringUtils.isBlank:(Ljava/lang/CharSequence;)Z
      13: ifeq          18
      16: aload_3
      17: areturn
      18: new           #45                 // class com/google/gson/GsonBuilder
      21: dup
      22: invokespecial #46                 // Method com/google/gson/GsonBuilder."<init>":()V
      25: invokevirtual #47                 // Method com/google/gson/GsonBuilder.create:()Lcom/google/gson/Gson;
      28: astore        4
      30: aload         4
      32: aload_2
      33: ldc           #19                 // class java/util/Map
      35: invokevirtual #48                 // Method com/google/gson/Gson.fromJson:(Ljava/lang/String;Ljava/lang/Class;)Ljava/lang/Object;
      38: checkcast     #19                 // class java/util/Map
      41: astore        5
      43: aload         5
      45: invokeinterface #49,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
      50: invokeinterface #50,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      55: astore        6
      57: aload         6
      59: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      64: ifeq          334
      67: aload         6
      69: invokeinterface #52,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      74: checkcast     #53                 // class java/util/Map$Entry
      77: astore        7
      79: aload         7
      81: invokeinterface #54,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
      86: checkcast     #55                 // class java/lang/String
      89: astore        8
      91: aload         7
      93: invokeinterface #56,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
      98: checkcast     #19                 // class java/util/Map
     101: invokeinterface #49,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
     106: invokeinterface #50,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     111: astore        9
     113: aload         9
     115: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     120: ifeq          331
     123: aload         9
     125: invokeinterface #52,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     130: checkcast     #53                 // class java/util/Map$Entry
     133: astore        10
     135: aload         10
     137: invokeinterface #54,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
     142: checkcast     #55                 // class java/lang/String
     145: astore        11
     147: invokestatic  #24                 // Method com/google/common/collect/Maps.newHashMap:()Ljava/util/HashMap;
     150: astore        12
     152: aload         10
     154: invokeinterface #56,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     159: checkcast     #19                 // class java/util/Map
     162: invokeinterface #49,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
     167: invokeinterface #50,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     172: astore        13
     174: aload         13
     176: invokeinterface #51,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     181: ifeq          315
     184: aload         13
     186: invokeinterface #52,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     191: checkcast     #53                 // class java/util/Map$Entry
     194: astore        14
     196: aload         14
     198: invokeinterface #54,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
     203: checkcast     #55                 // class java/lang/String
     206: invokestatic  #57                 // Method java/lang/Short.valueOf:(Ljava/lang/String;)Ljava/lang/Short;
     209: invokevirtual #58                 // Method java/lang/Short.shortValue:()S
     212: istore        15
     214: aload         14
     216: invokeinterface #56,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     221: checkcast     #19                 // class java/util/Map
     224: astore        16
     226: aload         16
     228: ldc           #59                 // String index
     230: invokeinterface #21,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     235: invokestatic  #60                 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;
     238: invokestatic  #61                 // Method java/lang/Double.valueOf:(Ljava/lang/String;)Ljava/lang/Double;
     241: invokevirtual #62                 // Method java/lang/Double.longValue:()J
     244: lstore        17
     246: aload         16
     248: ldc           #63                 // String updateTime
     250: invokeinterface #21,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     255: invokestatic  #60                 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;
     258: invokestatic  #61                 // Method java/lang/Double.valueOf:(Ljava/lang/String;)Ljava/lang/Double;
     261: invokevirtual #62                 // Method java/lang/Double.longValue:()J
     264: lstore        19
     266: aload         16
     268: ldc           #64                 // String createTime
     270: invokeinterface #21,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     275: invokestatic  #60                 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;
     278: invokestatic  #61                 // Method java/lang/Double.valueOf:(Ljava/lang/String;)Ljava/lang/Double;
     281: invokevirtual #62                 // Method java/lang/Double.longValue:()J
     284: lstore        21
     286: aload         12
     288: iload         15
     290: invokestatic  #20                 // Method java/lang/Short.valueOf:(S)Ljava/lang/Short;
     293: new           #22                 // class org/joyqueue/client/internal/consumer/domain/LocalIndexData
     296: dup
     297: lload         17
     299: lload         19
     301: lload         21
     303: invokespecial #65                 // Method org/joyqueue/client/internal/consumer/domain/LocalIndexData."<init>":(JJJ)V
     306: invokeinterface #28,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     311: pop
     312: goto          174
     315: aload_3
     316: aload         8
     318: aload         11
     320: aload         12
     322: invokeinterface #25,  4           // InterfaceMethod com/google/common/collect/Table.put:(Ljava/lang/Object;Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     327: pop
     328: goto          113
     331: goto          57
     334: aload_3
     335: areturn

  protected void persist();
    Code:
       0: aload_0
       1: getfield      #31                 // Field isNeedPersist:Z
       4: ifne          8
       7: return
       8: aload_0
       9: aload_0
      10: getfield      #5                  // Field persistFile:Ljava/io/File;
      13: invokevirtual #66                 // Method doPersist:(Ljava/io/File;)V
      16: aload_0
      17: iconst_0
      18: putfield      #31                 // Field isNeedPersist:Z
      21: return

  protected void doPersist(java.io.File);
    Code:
       0: new           #45                 // class com/google/gson/GsonBuilder
       3: dup
       4: invokespecial #46                 // Method com/google/gson/GsonBuilder."<init>":()V
       7: invokevirtual #47                 // Method com/google/gson/GsonBuilder.create:()Lcom/google/gson/Gson;
      10: aload_0
      11: getfield      #7                  // Field indexTable:Lcom/google/common/collect/Table;
      14: invokeinterface #67,  1           // InterfaceMethod com/google/common/collect/Table.rowMap:()Ljava/util/Map;
      19: invokevirtual #68                 // Method com/google/gson/Gson.toJson:(Ljava/lang/Object;)Ljava/lang/String;
      22: astore_2
      23: aload_1
      24: aload_2
      25: invokestatic  #69                 // Method org/apache/commons/io/FileUtils.writeStringToFile:(Ljava/io/File;Ljava/lang/String;)V
      28: goto          44
      31: astore_3
      32: getstatic     #71                 // Field logger:Lorg/slf4j/Logger;
      35: ldc           #72                 // String write local index error, file: {}
      37: aload_1
      38: aload_3
      39: invokeinterface #73,  4           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      44: return
    Exception table:
       from    to  target type
          23    28    31   Class java/lang/Exception

  static {};
    Code:
       0: ldc           #74                 // class org/joyqueue/client/internal/consumer/support/ConsumerLocalIndexStore
       2: invokestatic  #75                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #71                 // Field logger:Lorg/slf4j/Logger;
       8: return
}
