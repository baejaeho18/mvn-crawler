Compiled from "SaslServerCallbackHandler.java"
public class org.apache.zookeeper.server.auth.SaslServerCallbackHandler implements javax.security.auth.callback.CallbackHandler {
  private static final java.lang.String USER_PREFIX;

  private static final org.slf4j.Logger LOG;

  private static final java.lang.String SYSPROP_SUPER_PASSWORD;

  private static final java.lang.String SYSPROP_REMOVE_HOST;

  private static final java.lang.String SYSPROP_REMOVE_REALM;

  private java.lang.String userName;

  private final java.util.Map<java.lang.String, java.lang.String> credentials;

  public org.apache.zookeeper.server.auth.SaslServerCallbackHandler(javax.security.auth.login.Configuration) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/HashMap
       8: dup
       9: invokespecial #3                  // Method java/util/HashMap."<init>":()V
      12: putfield      #4                  // Field credentials:Ljava/util/Map;
      15: ldc           #5                  // String zookeeper.sasl.serverconfig
      17: ldc           #6                  // String Server
      19: invokestatic  #7                  // Method java/lang/System.getProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      22: astore_2
      23: aload_1
      24: aload_2
      25: invokevirtual #8                  // Method javax/security/auth/login/Configuration.getAppConfigurationEntry:(Ljava/lang/String;)[Ljavax/security/auth/login/AppConfigurationEntry;
      28: astore_3
      29: aload_3
      30: ifnonnull     57
      33: ldc           #9                  // String Could not find a \'Server\' entry in this configuration: Server cannot start.
      35: astore        4
      37: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
      40: aload         4
      42: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      47: new           #12                 // class java/io/IOException
      50: dup
      51: aload         4
      53: invokespecial #13                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      56: athrow
      57: aload_0
      58: getfield      #4                  // Field credentials:Ljava/util/Map;
      61: invokeinterface #14,  1           // InterfaceMethod java/util/Map.clear:()V
      66: aload_3
      67: astore        4
      69: aload         4
      71: arraylength
      72: istore        5
      74: iconst_0
      75: istore        6
      77: iload         6
      79: iload         5
      81: if_icmpge     199
      84: aload         4
      86: iload         6
      88: aaload
      89: astore        7
      91: aload         7
      93: invokevirtual #15                 // Method javax/security/auth/login/AppConfigurationEntry.getOptions:()Ljava/util/Map;
      96: astore        8
      98: aload         8
     100: invokeinterface #16,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
     105: invokeinterface #17,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     110: astore        9
     112: aload         9
     114: invokeinterface #18,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     119: ifeq          193
     122: aload         9
     124: invokeinterface #19,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     129: checkcast     #20                 // class java/util/Map$Entry
     132: astore        10
     134: aload         10
     136: invokeinterface #21,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
     141: checkcast     #22                 // class java/lang/String
     144: astore        11
     146: aload         11
     148: ldc           #23                 // String user_
     150: invokevirtual #24                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     153: ifeq          190
     156: aload         11
     158: ldc           #23                 // String user_
     160: invokevirtual #25                 // Method java/lang/String.length:()I
     163: invokevirtual #26                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     166: astore        12
     168: aload_0
     169: getfield      #4                  // Field credentials:Ljava/util/Map;
     172: aload         12
     174: aload         10
     176: invokeinterface #27,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     181: checkcast     #22                 // class java/lang/String
     184: invokeinterface #28,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     189: pop
     190: goto          112
     193: iinc          6, 1
     196: goto          77
     199: return

  public void handle(javax.security.auth.callback.Callback[]) throws javax.security.auth.callback.UnsupportedCallbackException;
    Code:
       0: aload_1
       1: astore_2
       2: aload_2
       3: arraylength
       4: istore_3
       5: iconst_0
       6: istore        4
       8: iload         4
      10: iload_3
      11: if_icmpge     103
      14: aload_2
      15: iload         4
      17: aaload
      18: astore        5
      20: aload         5
      22: instanceof    #29                 // class javax/security/auth/callback/NameCallback
      25: ifeq          40
      28: aload_0
      29: aload         5
      31: checkcast     #29                 // class javax/security/auth/callback/NameCallback
      34: invokespecial #30                 // Method handleNameCallback:(Ljavax/security/auth/callback/NameCallback;)V
      37: goto          97
      40: aload         5
      42: instanceof    #31                 // class javax/security/auth/callback/PasswordCallback
      45: ifeq          60
      48: aload_0
      49: aload         5
      51: checkcast     #31                 // class javax/security/auth/callback/PasswordCallback
      54: invokespecial #32                 // Method handlePasswordCallback:(Ljavax/security/auth/callback/PasswordCallback;)V
      57: goto          97
      60: aload         5
      62: instanceof    #33                 // class javax/security/sasl/RealmCallback
      65: ifeq          80
      68: aload_0
      69: aload         5
      71: checkcast     #33                 // class javax/security/sasl/RealmCallback
      74: invokespecial #34                 // Method handleRealmCallback:(Ljavax/security/sasl/RealmCallback;)V
      77: goto          97
      80: aload         5
      82: instanceof    #35                 // class javax/security/sasl/AuthorizeCallback
      85: ifeq          97
      88: aload_0
      89: aload         5
      91: checkcast     #35                 // class javax/security/sasl/AuthorizeCallback
      94: invokespecial #36                 // Method handleAuthorizeCallback:(Ljavax/security/sasl/AuthorizeCallback;)V
      97: iinc          4, 1
     100: goto          8
     103: return

  private void handleNameCallback(javax.security.auth.callback.NameCallback);
    Code:
       0: aload_0
       1: getfield      #4                  // Field credentials:Ljava/util/Map;
       4: aload_1
       5: invokevirtual #37                 // Method javax/security/auth/callback/NameCallback.getDefaultName:()Ljava/lang/String;
       8: invokeinterface #38,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      13: ifnonnull     52
      16: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
      19: new           #39                 // class java/lang/StringBuilder
      22: dup
      23: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
      26: ldc           #41                 // String User \'
      28: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      31: aload_1
      32: invokevirtual #37                 // Method javax/security/auth/callback/NameCallback.getDefaultName:()Ljava/lang/String;
      35: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      38: ldc           #43                 // String \' not found in list of DIGEST-MD5 authenticateable users.
      40: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      43: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      46: invokeinterface #45,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      51: return
      52: aload_1
      53: aload_1
      54: invokevirtual #37                 // Method javax/security/auth/callback/NameCallback.getDefaultName:()Ljava/lang/String;
      57: invokevirtual #46                 // Method javax/security/auth/callback/NameCallback.setName:(Ljava/lang/String;)V
      60: aload_0
      61: aload_1
      62: invokevirtual #37                 // Method javax/security/auth/callback/NameCallback.getDefaultName:()Ljava/lang/String;
      65: putfield      #47                 // Field userName:Ljava/lang/String;
      68: return

  private void handlePasswordCallback(javax.security.auth.callback.PasswordCallback);
    Code:
       0: ldc           #48                 // String super
       2: aload_0
       3: getfield      #47                 // Field userName:Ljava/lang/String;
       6: invokevirtual #49                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       9: ifeq          35
      12: ldc           #50                 // String zookeeper.SASLAuthenticationProvider.superPassword
      14: invokestatic  #51                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      17: ifnull        35
      20: aload_1
      21: ldc           #50                 // String zookeeper.SASLAuthenticationProvider.superPassword
      23: invokestatic  #51                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      26: invokevirtual #52                 // Method java/lang/String.toCharArray:()[C
      29: invokevirtual #53                 // Method javax/security/auth/callback/PasswordCallback.setPassword:([C)V
      32: goto          107
      35: aload_0
      36: getfield      #4                  // Field credentials:Ljava/util/Map;
      39: aload_0
      40: getfield      #47                 // Field userName:Ljava/lang/String;
      43: invokeinterface #54,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
      48: ifeq          77
      51: aload_1
      52: aload_0
      53: getfield      #4                  // Field credentials:Ljava/util/Map;
      56: aload_0
      57: getfield      #47                 // Field userName:Ljava/lang/String;
      60: invokeinterface #38,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      65: checkcast     #22                 // class java/lang/String
      68: invokevirtual #52                 // Method java/lang/String.toCharArray:()[C
      71: invokevirtual #53                 // Method javax/security/auth/callback/PasswordCallback.setPassword:([C)V
      74: goto          107
      77: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
      80: new           #39                 // class java/lang/StringBuilder
      83: dup
      84: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
      87: ldc           #55                 // String No password found for user:
      89: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      92: aload_0
      93: getfield      #47                 // Field userName:Ljava/lang/String;
      96: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      99: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     102: invokeinterface #45,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     107: return

  private void handleRealmCallback(javax.security.sasl.RealmCallback);
    Code:
       0: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
       3: new           #39                 // class java/lang/StringBuilder
       6: dup
       7: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
      10: ldc           #56                 // String client supplied realm:
      12: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      15: aload_1
      16: invokevirtual #57                 // Method javax/security/sasl/RealmCallback.getDefaultText:()Ljava/lang/String;
      19: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      22: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      25: invokeinterface #58,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      30: aload_1
      31: aload_1
      32: invokevirtual #57                 // Method javax/security/sasl/RealmCallback.getDefaultText:()Ljava/lang/String;
      35: invokevirtual #59                 // Method javax/security/sasl/RealmCallback.setText:(Ljava/lang/String;)V
      38: return

  private void handleAuthorizeCallback(javax.security.sasl.AuthorizeCallback);
    Code:
       0: aload_1
       1: invokevirtual #60                 // Method javax/security/sasl/AuthorizeCallback.getAuthenticationID:()Ljava/lang/String;
       4: astore_2
       5: aload_1
       6: invokevirtual #61                 // Method javax/security/sasl/AuthorizeCallback.getAuthorizationID:()Ljava/lang/String;
       9: astore_3
      10: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
      13: new           #39                 // class java/lang/StringBuilder
      16: dup
      17: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
      20: ldc           #62                 // String Successfully authenticated client: authenticationID=
      22: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      25: aload_2
      26: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      29: ldc           #63                 // String ;  authorizationID=
      31: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      34: aload_3
      35: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      38: ldc           #64                 // String .
      40: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      43: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      46: invokeinterface #65,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      51: aload_1
      52: iconst_1
      53: invokevirtual #66                 // Method javax/security/sasl/AuthorizeCallback.setAuthorized:(Z)V
      56: new           #67                 // class org/apache/zookeeper/server/auth/KerberosName
      59: dup
      60: aload_2
      61: invokespecial #68                 // Method org/apache/zookeeper/server/auth/KerberosName."<init>":(Ljava/lang/String;)V
      64: astore        4
      66: new           #39                 // class java/lang/StringBuilder
      69: dup
      70: aload         4
      72: invokevirtual #69                 // Method org/apache/zookeeper/server/auth/KerberosName.getShortName:()Ljava/lang/String;
      75: invokespecial #70                 // Method java/lang/StringBuilder."<init>":(Ljava/lang/String;)V
      78: astore        5
      80: aload_0
      81: aload         4
      83: invokespecial #71                 // Method shouldAppendHost:(Lorg/apache/zookeeper/server/auth/KerberosName;)Z
      86: ifeq          105
      89: aload         5
      91: ldc           #72                 // String /
      93: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      96: aload         4
      98: invokevirtual #73                 // Method org/apache/zookeeper/server/auth/KerberosName.getHostName:()Ljava/lang/String;
     101: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     104: pop
     105: aload_0
     106: aload         4
     108: invokespecial #74                 // Method shouldAppendRealm:(Lorg/apache/zookeeper/server/auth/KerberosName;)Z
     111: ifeq          130
     114: aload         5
     116: ldc           #75                 // String @
     118: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     121: aload         4
     123: invokevirtual #76                 // Method org/apache/zookeeper/server/auth/KerberosName.getRealm:()Ljava/lang/String;
     126: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     129: pop
     130: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
     133: new           #39                 // class java/lang/StringBuilder
     136: dup
     137: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
     140: ldc           #77                 // String Setting authorizedID:
     142: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     145: aload         5
     147: invokevirtual #78                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     150: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     153: invokeinterface #65,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     158: aload_1
     159: aload         5
     161: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     164: invokevirtual #79                 // Method javax/security/sasl/AuthorizeCallback.setAuthorizedID:(Ljava/lang/String;)V
     167: goto          182
     170: astore        5
     172: getstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
     175: ldc           #80                 // String Failed to set name based on Kerberos authentication rules.
     177: invokeinterface #11,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     182: return
    Exception table:
       from    to  target type
          66   167   170   Class java/io/IOException

  private boolean shouldAppendRealm(org.apache.zookeeper.server.auth.KerberosName);
    Code:
       0: aload_0
       1: ldc           #81                 // String zookeeper.kerberos.removeRealmFromPrincipal
       3: invokespecial #82                 // Method isSystemPropertyTrue:(Ljava/lang/String;)Z
       6: ifne          20
       9: aload_1
      10: invokevirtual #76                 // Method org/apache/zookeeper/server/auth/KerberosName.getRealm:()Ljava/lang/String;
      13: ifnull        20
      16: iconst_1
      17: goto          21
      20: iconst_0
      21: ireturn

  private boolean shouldAppendHost(org.apache.zookeeper.server.auth.KerberosName);
    Code:
       0: aload_0
       1: ldc           #83                 // String zookeeper.kerberos.removeHostFromPrincipal
       3: invokespecial #82                 // Method isSystemPropertyTrue:(Ljava/lang/String;)Z
       6: ifne          20
       9: aload_1
      10: invokevirtual #73                 // Method org/apache/zookeeper/server/auth/KerberosName.getHostName:()Ljava/lang/String;
      13: ifnull        20
      16: iconst_1
      17: goto          21
      20: iconst_0
      21: ireturn

  private boolean isSystemPropertyTrue(java.lang.String);
    Code:
       0: ldc           #84                 // String true
       2: aload_1
       3: invokestatic  #51                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       6: invokevirtual #49                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       9: ireturn

  static {};
    Code:
       0: ldc_w         #85                 // class org/apache/zookeeper/server/auth/SaslServerCallbackHandler
       3: invokestatic  #86                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #10                 // Field LOG:Lorg/slf4j/Logger;
       9: return
}
