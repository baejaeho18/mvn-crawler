Compiled from "LeaderElection.java"
public class org.apache.zookeeper.server.quorum.LeaderElection implements org.apache.zookeeper.server.quorum.Election {
  private static final org.slf4j.Logger LOG;

  protected static final java.util.Random epochGen;

  protected org.apache.zookeeper.server.quorum.QuorumPeer self;

  public org.apache.zookeeper.server.quorum.LeaderElection(org.apache.zookeeper.server.quorum.QuorumPeer);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
       9: return

  protected org.apache.zookeeper.server.quorum.LeaderElection$ElectionResult countVotes(java.util.HashMap<java.net.InetSocketAddress, org.apache.zookeeper.server.quorum.Vote>, java.util.HashSet<java.lang.Long>);
    Code:
       0: new           #3                  // class org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult
       3: dup
       4: invokespecial #4                  // Method org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult."<init>":()V
       7: astore_3
       8: aload_3
       9: new           #5                  // class org/apache/zookeeper/server/quorum/Vote
      12: dup
      13: ldc2_w        #6                  // long -9223372036854775808l
      16: ldc2_w        #6                  // long -9223372036854775808l
      19: invokespecial #8                  // Method org/apache/zookeeper/server/quorum/Vote."<init>":(JJ)V
      22: putfield      #9                  // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.vote:Lorg/apache/zookeeper/server/quorum/Vote;
      25: aload_3
      26: new           #5                  // class org/apache/zookeeper/server/quorum/Vote
      29: dup
      30: ldc2_w        #6                  // long -9223372036854775808l
      33: ldc2_w        #6                  // long -9223372036854775808l
      36: invokespecial #8                  // Method org/apache/zookeeper/server/quorum/Vote."<init>":(JJ)V
      39: putfield      #10                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.winner:Lorg/apache/zookeeper/server/quorum/Vote;
      42: new           #11                 // class java/util/HashMap
      45: dup
      46: invokespecial #12                 // Method java/util/HashMap."<init>":()V
      49: astore        4
      51: new           #11                 // class java/util/HashMap
      54: dup
      55: invokespecial #12                 // Method java/util/HashMap."<init>":()V
      58: astore        5
      60: aload_1
      61: invokevirtual #13                 // Method java/util/HashMap.entrySet:()Ljava/util/Set;
      64: invokeinterface #14,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      69: astore        6
      71: aload         6
      73: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      78: ifeq          201
      81: aload         6
      83: invokeinterface #16,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      88: checkcast     #17                 // class java/util/Map$Entry
      91: astore        7
      93: aload         7
      95: invokeinterface #18,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     100: checkcast     #5                  // class org/apache/zookeeper/server/quorum/Vote
     103: astore        8
     105: aload_2
     106: aload         8
     108: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     111: invokestatic  #20                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     114: invokevirtual #21                 // Method java/util/HashSet.contains:(Ljava/lang/Object;)Z
     117: ifeq          198
     120: aload         4
     122: aload         7
     124: invokeinterface #22,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
     129: aload         8
     131: invokevirtual #23                 // Method java/util/HashMap.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     134: pop
     135: aload         5
     137: aload         8
     139: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     142: invokestatic  #20                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     145: invokeinterface #24,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     150: checkcast     #25                 // class java/lang/Long
     153: astore        9
     155: aload         9
     157: ifnull        174
     160: aload         9
     162: invokevirtual #26                 // Method java/lang/Long.longValue:()J
     165: aload         8
     167: invokevirtual #27                 // Method org/apache/zookeeper/server/quorum/Vote.getZxid:()J
     170: lcmp
     171: ifge          198
     174: aload         5
     176: aload         8
     178: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     181: invokestatic  #20                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     184: aload         8
     186: invokevirtual #27                 // Method org/apache/zookeeper/server/quorum/Vote.getZxid:()J
     189: invokestatic  #20                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     192: invokeinterface #28,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     197: pop
     198: goto          71
     201: aload         4
     203: invokevirtual #13                 // Method java/util/HashMap.entrySet:()Ljava/util/Set;
     206: invokeinterface #14,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     211: astore        6
     213: aload         6
     215: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     220: ifeq          324
     223: aload         6
     225: invokeinterface #16,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     230: checkcast     #17                 // class java/util/Map$Entry
     233: astore        7
     235: aload         7
     237: invokeinterface #18,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     242: checkcast     #5                  // class org/apache/zookeeper/server/quorum/Vote
     245: astore        8
     247: aload         5
     249: aload         8
     251: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     254: invokestatic  #20                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     257: invokeinterface #24,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     262: checkcast     #25                 // class java/lang/Long
     265: astore        9
     267: aload         8
     269: invokevirtual #27                 // Method org/apache/zookeeper/server/quorum/Vote.getZxid:()J
     272: aload         9
     274: invokevirtual #26                 // Method java/lang/Long.longValue:()J
     277: lcmp
     278: ifge          321
     281: aload         7
     283: new           #5                  // class org/apache/zookeeper/server/quorum/Vote
     286: dup
     287: aload         8
     289: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     292: aload         9
     294: invokevirtual #26                 // Method java/lang/Long.longValue:()J
     297: aload         8
     299: invokevirtual #29                 // Method org/apache/zookeeper/server/quorum/Vote.getElectionEpoch:()J
     302: aload         8
     304: invokevirtual #30                 // Method org/apache/zookeeper/server/quorum/Vote.getPeerEpoch:()J
     307: aload         8
     309: invokevirtual #31                 // Method org/apache/zookeeper/server/quorum/Vote.getState:()Lorg/apache/zookeeper/server/quorum/QuorumPeer$ServerState;
     312: invokespecial #32                 // Method org/apache/zookeeper/server/quorum/Vote."<init>":(JJJJLorg/apache/zookeeper/server/quorum/QuorumPeer$ServerState;)V
     315: invokeinterface #33,  2           // InterfaceMethod java/util/Map$Entry.setValue:(Ljava/lang/Object;)Ljava/lang/Object;
     320: pop
     321: goto          213
     324: aload_3
     325: aload         4
     327: invokevirtual #34                 // Method java/util/HashMap.size:()I
     330: putfield      #35                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.numValidVotes:I
     333: new           #11                 // class java/util/HashMap
     336: dup
     337: invokespecial #12                 // Method java/util/HashMap."<init>":()V
     340: astore        6
     342: aload         4
     344: invokevirtual #36                 // Method java/util/HashMap.values:()Ljava/util/Collection;
     347: invokeinterface #37,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     352: astore        7
     354: aload         7
     356: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     361: ifeq          508
     364: aload         7
     366: invokeinterface #16,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     371: checkcast     #5                  // class org/apache/zookeeper/server/quorum/Vote
     374: astore        8
     376: aload         6
     378: aload         8
     380: invokevirtual #38                 // Method java/util/HashMap.get:(Ljava/lang/Object;)Ljava/lang/Object;
     383: checkcast     #39                 // class java/lang/Integer
     386: astore        9
     388: aload         9
     390: ifnonnull     399
     393: iconst_0
     394: invokestatic  #40                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     397: astore        9
     399: aload         6
     401: aload         8
     403: aload         9
     405: invokevirtual #41                 // Method java/lang/Integer.intValue:()I
     408: iconst_1
     409: iadd
     410: invokestatic  #40                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     413: invokevirtual #23                 // Method java/util/HashMap.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     416: pop
     417: aload         8
     419: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     422: aload_3
     423: getfield      #9                  // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.vote:Lorg/apache/zookeeper/server/quorum/Vote;
     426: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     429: lcmp
     430: ifne          446
     433: aload_3
     434: dup
     435: getfield      #42                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.count:I
     438: iconst_1
     439: iadd
     440: putfield      #42                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.count:I
     443: goto          505
     446: aload         8
     448: invokevirtual #27                 // Method org/apache/zookeeper/server/quorum/Vote.getZxid:()J
     451: aload_3
     452: getfield      #9                  // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.vote:Lorg/apache/zookeeper/server/quorum/Vote;
     455: invokevirtual #27                 // Method org/apache/zookeeper/server/quorum/Vote.getZxid:()J
     458: lcmp
     459: ifgt          494
     462: aload         8
     464: invokevirtual #27                 // Method org/apache/zookeeper/server/quorum/Vote.getZxid:()J
     467: aload_3
     468: getfield      #9                  // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.vote:Lorg/apache/zookeeper/server/quorum/Vote;
     471: invokevirtual #27                 // Method org/apache/zookeeper/server/quorum/Vote.getZxid:()J
     474: lcmp
     475: ifne          505
     478: aload         8
     480: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     483: aload_3
     484: getfield      #9                  // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.vote:Lorg/apache/zookeeper/server/quorum/Vote;
     487: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     490: lcmp
     491: ifle          505
     494: aload_3
     495: aload         8
     497: putfield      #9                  // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.vote:Lorg/apache/zookeeper/server/quorum/Vote;
     500: aload_3
     501: iconst_1
     502: putfield      #42                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.count:I
     505: goto          354
     508: aload_3
     509: iconst_0
     510: putfield      #43                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.winningCount:I
     513: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
     516: ldc           #45                 // String Election tally:
     518: invokeinterface #46,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     523: aload         6
     525: invokevirtual #13                 // Method java/util/HashMap.entrySet:()Ljava/util/Set;
     528: invokeinterface #14,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     533: astore        7
     535: aload         7
     537: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     542: ifeq          660
     545: aload         7
     547: invokeinterface #16,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     552: checkcast     #17                 // class java/util/Map$Entry
     555: astore        8
     557: aload         8
     559: invokeinterface #18,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     564: checkcast     #39                 // class java/lang/Integer
     567: invokevirtual #41                 // Method java/lang/Integer.intValue:()I
     570: aload_3
     571: getfield      #43                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.winningCount:I
     574: if_icmple     608
     577: aload_3
     578: aload         8
     580: invokeinterface #18,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     585: checkcast     #39                 // class java/lang/Integer
     588: invokevirtual #41                 // Method java/lang/Integer.intValue:()I
     591: putfield      #43                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.winningCount:I
     594: aload_3
     595: aload         8
     597: invokeinterface #22,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
     602: checkcast     #5                  // class org/apache/zookeeper/server/quorum/Vote
     605: putfield      #10                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.winner:Lorg/apache/zookeeper/server/quorum/Vote;
     608: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
     611: new           #47                 // class java/lang/StringBuilder
     614: dup
     615: invokespecial #48                 // Method java/lang/StringBuilder."<init>":()V
     618: aload         8
     620: invokeinterface #22,  1           // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
     625: checkcast     #5                  // class org/apache/zookeeper/server/quorum/Vote
     628: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     631: invokevirtual #49                 // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
     634: ldc           #50                 // String \t->
     636: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     639: aload         8
     641: invokeinterface #18,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     646: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     649: invokevirtual #53                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     652: invokeinterface #46,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     657: goto          535
     660: aload_3
     661: areturn

  public void shutdown();
    Code:
       0: return

  public org.apache.zookeeper.server.quorum.Vote lookForLeader() throws java.lang.InterruptedException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
       4: new           #54                 // class org/apache/zookeeper/server/quorum/LeaderElectionBean
       7: dup
       8: invokespecial #55                 // Method org/apache/zookeeper/server/quorum/LeaderElectionBean."<init>":()V
      11: putfield      #56                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.jmxLeaderElectionBean:Lorg/apache/zookeeper/server/quorum/LeaderElectionBean;
      14: invokestatic  #57                 // Method org/apache/zookeeper/jmx/MBeanRegistry.getInstance:()Lorg/apache/zookeeper/jmx/MBeanRegistry;
      17: aload_0
      18: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      21: getfield      #56                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.jmxLeaderElectionBean:Lorg/apache/zookeeper/server/quorum/LeaderElectionBean;
      24: aload_0
      25: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      28: getfield      #58                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.jmxLocalPeerBean:Lorg/apache/zookeeper/server/quorum/LocalPeerBean;
      31: invokevirtual #59                 // Method org/apache/zookeeper/jmx/MBeanRegistry.register:(Lorg/apache/zookeeper/jmx/ZKMBeanInfo;Lorg/apache/zookeeper/jmx/ZKMBeanInfo;)V
      34: goto          57
      37: astore_1
      38: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
      41: ldc           #61                 // String Failed to register with JMX
      43: aload_1
      44: invokeinterface #62,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
      49: aload_0
      50: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      53: aconst_null
      54: putfield      #56                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.jmxLeaderElectionBean:Lorg/apache/zookeeper/server/quorum/LeaderElectionBean;
      57: aload_0
      58: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      61: new           #5                  // class org/apache/zookeeper/server/quorum/Vote
      64: dup
      65: aload_0
      66: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      69: invokevirtual #63                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.getId:()J
      72: aload_0
      73: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
      76: invokevirtual #64                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.getLastLoggedZxid:()J
      79: invokespecial #8                  // Method org/apache/zookeeper/server/quorum/Vote."<init>":(JJ)V
      82: invokevirtual #65                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.setCurrentVote:(Lorg/apache/zookeeper/server/quorum/Vote;)V
      85: iconst_4
      86: newarray       byte
      88: astore_1
      89: aload_1
      90: invokestatic  #66                 // Method java/nio/ByteBuffer.wrap:([B)Ljava/nio/ByteBuffer;
      93: astore_2
      94: bipush        28
      96: newarray       byte
      98: astore_3
      99: aload_3
     100: invokestatic  #66                 // Method java/nio/ByteBuffer.wrap:([B)Ljava/nio/ByteBuffer;
     103: astore        4
     105: aconst_null
     106: astore        5
     108: new           #67                 // class java/net/DatagramSocket
     111: dup
     112: invokespecial #68                 // Method java/net/DatagramSocket."<init>":()V
     115: astore        5
     117: aload         5
     119: sipush        200
     122: invokevirtual #69                 // Method java/net/DatagramSocket.setSoTimeout:(I)V
     125: goto          146
     128: astore        6
     130: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
     133: ldc           #71                 // String Socket exception when creating socket for leader election
     135: aload         6
     137: invokeinterface #72,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     142: iconst_4
     143: invokestatic  #73                 // Method java/lang/System.exit:(I)V
     146: new           #74                 // class java/net/DatagramPacket
     149: dup
     150: aload_1
     151: aload_1
     152: arraylength
     153: invokespecial #75                 // Method java/net/DatagramPacket."<init>":([BI)V
     156: astore        6
     158: new           #74                 // class java/net/DatagramPacket
     161: dup
     162: aload_3
     163: aload_3
     164: arraylength
     165: invokespecial #75                 // Method java/net/DatagramPacket."<init>":([BI)V
     168: astore        7
     170: getstatic     #76                 // Field epochGen:Ljava/util/Random;
     173: invokevirtual #77                 // Method java/util/Random.nextInt:()I
     176: istore        8
     178: aload_0
     179: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     182: invokevirtual #78                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.isRunning:()Z
     185: ifeq          871
     188: new           #11                 // class java/util/HashMap
     191: dup
     192: aload_0
     193: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     196: invokevirtual #79                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.getVotingView:()Ljava/util/Map;
     199: invokeinterface #80,  1           // InterfaceMethod java/util/Map.size:()I
     204: invokespecial #81                 // Method java/util/HashMap."<init>":(I)V
     207: astore        9
     209: aload_2
     210: invokevirtual #82                 // Method java/nio/ByteBuffer.clear:()Ljava/nio/Buffer;
     213: pop
     214: aload_2
     215: iload         8
     217: invokevirtual #83                 // Method java/nio/ByteBuffer.putInt:(I)Ljava/nio/ByteBuffer;
     220: pop
     221: aload         6
     223: iconst_4
     224: invokevirtual #84                 // Method java/net/DatagramPacket.setLength:(I)V
     227: new           #85                 // class java/util/HashSet
     230: dup
     231: invokespecial #86                 // Method java/util/HashSet."<init>":()V
     234: astore        10
     236: aload_0
     237: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     240: invokevirtual #79                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.getVotingView:()Ljava/util/Map;
     243: invokeinterface #87,  1           // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
     248: invokeinterface #37,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     253: astore        11
     255: aload         11
     257: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     262: ifeq          572
     265: aload         11
     267: invokeinterface #16,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     272: checkcast     #88                 // class org/apache/zookeeper/server/quorum/QuorumPeer$QuorumServer
     275: astore        12
     277: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
     280: new           #47                 // class java/lang/StringBuilder
     283: dup
     284: invokespecial #48                 // Method java/lang/StringBuilder."<init>":()V
     287: ldc           #89                 // String Server address:
     289: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     292: aload         12
     294: getfield      #90                 // Field org/apache/zookeeper/server/quorum/QuorumPeer$QuorumServer.addr:Ljava/net/InetSocketAddress;
     297: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     300: invokevirtual #53                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     303: invokeinterface #46,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     308: aload         6
     310: aload         12
     312: getfield      #90                 // Field org/apache/zookeeper/server/quorum/QuorumPeer$QuorumServer.addr:Ljava/net/InetSocketAddress;
     315: invokevirtual #91                 // Method java/net/DatagramPacket.setSocketAddress:(Ljava/net/SocketAddress;)V
     318: goto          369
     321: astore        13
     323: new           #92                 // class java/lang/IllegalArgumentException
     326: dup
     327: new           #47                 // class java/lang/StringBuilder
     330: dup
     331: invokespecial #48                 // Method java/lang/StringBuilder."<init>":()V
     334: ldc           #93                 // String Unable to set socket address on packet, msg:
     336: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     339: aload         13
     341: invokevirtual #94                 // Method java/lang/IllegalArgumentException.getMessage:()Ljava/lang/String;
     344: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     347: ldc           #95                 // String  with addr:
     349: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     352: aload         12
     354: getfield      #90                 // Field org/apache/zookeeper/server/quorum/QuorumPeer$QuorumServer.addr:Ljava/net/InetSocketAddress;
     357: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     360: invokevirtual #53                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     363: aload         13
     365: invokespecial #96                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     368: athrow
     369: aload         5
     371: aload         6
     373: invokevirtual #97                 // Method java/net/DatagramSocket.send:(Ljava/net/DatagramPacket;)V
     376: aload         7
     378: aload_3
     379: arraylength
     380: invokevirtual #84                 // Method java/net/DatagramPacket.setLength:(I)V
     383: aload         5
     385: aload         7
     387: invokevirtual #98                 // Method java/net/DatagramSocket.receive:(Ljava/net/DatagramPacket;)V
     390: aload         7
     392: invokevirtual #99                 // Method java/net/DatagramPacket.getLength:()I
     395: aload_3
     396: arraylength
     397: if_icmpeq     434
     400: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
     403: new           #47                 // class java/lang/StringBuilder
     406: dup
     407: invokespecial #48                 // Method java/lang/StringBuilder."<init>":()V
     410: ldc           #100                // String Got a short response:
     412: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     415: aload         7
     417: invokevirtual #99                 // Method java/net/DatagramPacket.getLength:()I
     420: invokevirtual #101                // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     423: invokevirtual #53                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     426: invokeinterface #102,  2          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     431: goto          255
     434: aload         4
     436: invokevirtual #82                 // Method java/nio/ByteBuffer.clear:()Ljava/nio/Buffer;
     439: pop
     440: aload         4
     442: invokevirtual #103                // Method java/nio/ByteBuffer.getInt:()I
     445: istore        13
     447: iload         13
     449: iload         8
     451: if_icmpeq     495
     454: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
     457: new           #47                 // class java/lang/StringBuilder
     460: dup
     461: invokespecial #48                 // Method java/lang/StringBuilder."<init>":()V
     464: ldc           #104                // String Got bad xid: expected
     466: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     469: iload         8
     471: invokevirtual #101                // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     474: ldc           #105                // String  got
     476: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     479: iload         13
     481: invokevirtual #101                // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     484: invokevirtual #53                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     487: invokeinterface #102,  2          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     492: goto          255
     495: aload         4
     497: invokevirtual #106                // Method java/nio/ByteBuffer.getLong:()J
     500: lstore        14
     502: aload         10
     504: lload         14
     506: invokestatic  #20                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     509: invokevirtual #107                // Method java/util/HashSet.add:(Ljava/lang/Object;)Z
     512: pop
     513: new           #5                  // class org/apache/zookeeper/server/quorum/Vote
     516: dup
     517: aload         4
     519: invokevirtual #106                // Method java/nio/ByteBuffer.getLong:()J
     522: aload         4
     524: invokevirtual #106                // Method java/nio/ByteBuffer.getLong:()J
     527: invokespecial #8                  // Method org/apache/zookeeper/server/quorum/Vote."<init>":(JJ)V
     530: astore        16
     532: aload         7
     534: invokevirtual #108                // Method java/net/DatagramPacket.getSocketAddress:()Ljava/net/SocketAddress;
     537: checkcast     #109                // class java/net/InetSocketAddress
     540: astore        17
     542: aload         9
     544: aload         17
     546: aload         16
     548: invokevirtual #23                 // Method java/util/HashMap.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     551: pop
     552: goto          569
     555: astore        13
     557: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
     560: ldc           #111                // String Ignoring exception while looking for leader
     562: aload         13
     564: invokeinterface #62,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     569: goto          255
     572: aload_0
     573: aload         9
     575: aload         10
     577: invokevirtual #112                // Method countVotes:(Ljava/util/HashMap;Ljava/util/HashSet;)Lorg/apache/zookeeper/server/quorum/LeaderElection$ElectionResult;
     580: astore        11
     582: aload         11
     584: getfield      #35                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.numValidVotes:I
     587: ifne          621
     590: aload_0
     591: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     594: new           #5                  // class org/apache/zookeeper/server/quorum/Vote
     597: dup
     598: aload_0
     599: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     602: invokevirtual #63                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.getId:()J
     605: aload_0
     606: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     609: invokevirtual #64                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.getLastLoggedZxid:()J
     612: invokespecial #8                  // Method org/apache/zookeeper/server/quorum/Vote."<init>":(JJ)V
     615: invokevirtual #65                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.setCurrentVote:(Lorg/apache/zookeeper/server/quorum/Vote;)V
     618: goto          862
     621: aload         11
     623: getfield      #10                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.winner:Lorg/apache/zookeeper/server/quorum/Vote;
     626: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     629: lconst_0
     630: lcmp
     631: iflt          862
     634: aload_0
     635: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     638: aload         11
     640: getfield      #9                  // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.vote:Lorg/apache/zookeeper/server/quorum/Vote;
     643: invokevirtual #65                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.setCurrentVote:(Lorg/apache/zookeeper/server/quorum/Vote;)V
     646: aload         11
     648: getfield      #43                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.winningCount:I
     651: aload_0
     652: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     655: invokevirtual #79                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.getVotingView:()Ljava/util/Map;
     658: invokeinterface #80,  1           // InterfaceMethod java/util/Map.size:()I
     663: iconst_2
     664: idiv
     665: if_icmple     862
     668: aload_0
     669: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     672: aload         11
     674: getfield      #10                 // Field org/apache/zookeeper/server/quorum/LeaderElection$ElectionResult.winner:Lorg/apache/zookeeper/server/quorum/Vote;
     677: invokevirtual #65                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.setCurrentVote:(Lorg/apache/zookeeper/server/quorum/Vote;)V
     680: aload         5
     682: invokevirtual #113                // Method java/net/DatagramSocket.close:()V
     685: aload_0
     686: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     689: invokevirtual #114                // Method org/apache/zookeeper/server/quorum/QuorumPeer.getCurrentVote:()Lorg/apache/zookeeper/server/quorum/Vote;
     692: astore        12
     694: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
     697: new           #47                 // class java/lang/StringBuilder
     700: dup
     701: invokespecial #48                 // Method java/lang/StringBuilder."<init>":()V
     704: ldc           #115                // String Found leader: my type is:
     706: invokevirtual #51                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     709: aload_0
     710: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     713: invokevirtual #116                // Method org/apache/zookeeper/server/quorum/QuorumPeer.getLearnerType:()Lorg/apache/zookeeper/server/quorum/QuorumPeer$LearnerType;
     716: invokevirtual #52                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     719: invokevirtual #53                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     722: invokeinterface #46,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     727: aload_0
     728: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     731: invokevirtual #116                // Method org/apache/zookeeper/server/quorum/QuorumPeer.getLearnerType:()Lorg/apache/zookeeper/server/quorum/QuorumPeer$LearnerType;
     734: getstatic     #117                // Field org/apache/zookeeper/server/quorum/QuorumPeer$LearnerType.OBSERVER:Lorg/apache/zookeeper/server/quorum/QuorumPeer$LearnerType;
     737: if_acmpne     801
     740: aload         12
     742: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     745: aload_0
     746: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     749: invokevirtual #63                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.getId:()J
     752: lcmp
     753: ifne          775
     756: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
     759: ldc           #118                // String OBSERVER elected as leader!
     761: invokeinterface #102,  2          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     766: ldc2_w        #119                // long 100l
     769: invokestatic  #121                // Method java/lang/Thread.sleep:(J)V
     772: goto          862
     775: aload_0
     776: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     779: getstatic     #122                // Field org/apache/zookeeper/server/quorum/QuorumPeer$ServerState.OBSERVING:Lorg/apache/zookeeper/server/quorum/QuorumPeer$ServerState;
     782: invokevirtual #123                // Method org/apache/zookeeper/server/quorum/QuorumPeer.setPeerState:(Lorg/apache/zookeeper/server/quorum/QuorumPeer$ServerState;)V
     785: ldc2_w        #119                // long 100l
     788: invokestatic  #121                // Method java/lang/Thread.sleep:(J)V
     791: aload         12
     793: astore        13
     795: jsr           888
     798: aload         13
     800: areturn
     801: aload_0
     802: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     805: aload         12
     807: invokevirtual #19                 // Method org/apache/zookeeper/server/quorum/Vote.getId:()J
     810: aload_0
     811: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     814: invokevirtual #63                 // Method org/apache/zookeeper/server/quorum/QuorumPeer.getId:()J
     817: lcmp
     818: ifne          827
     821: getstatic     #124                // Field org/apache/zookeeper/server/quorum/QuorumPeer$ServerState.LEADING:Lorg/apache/zookeeper/server/quorum/QuorumPeer$ServerState;
     824: goto          830
     827: getstatic     #125                // Field org/apache/zookeeper/server/quorum/QuorumPeer$ServerState.FOLLOWING:Lorg/apache/zookeeper/server/quorum/QuorumPeer$ServerState;
     830: invokevirtual #123                // Method org/apache/zookeeper/server/quorum/QuorumPeer.setPeerState:(Lorg/apache/zookeeper/server/quorum/QuorumPeer$ServerState;)V
     833: aload_0
     834: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     837: invokevirtual #126                // Method org/apache/zookeeper/server/quorum/QuorumPeer.getPeerState:()Lorg/apache/zookeeper/server/quorum/QuorumPeer$ServerState;
     840: getstatic     #125                // Field org/apache/zookeeper/server/quorum/QuorumPeer$ServerState.FOLLOWING:Lorg/apache/zookeeper/server/quorum/QuorumPeer$ServerState;
     843: if_acmpne     852
     846: ldc2_w        #119                // long 100l
     849: invokestatic  #121                // Method java/lang/Thread.sleep:(J)V
     852: aload         12
     854: astore        13
     856: jsr           888
     859: aload         13
     861: areturn
     862: ldc2_w        #127                // long 1000l
     865: invokestatic  #121                // Method java/lang/Thread.sleep:(J)V
     868: goto          178
     871: aconst_null
     872: astore        9
     874: jsr           888
     877: aload         9
     879: areturn
     880: astore        18
     882: jsr           888
     885: aload         18
     887: athrow
     888: astore        19
     890: aload_0
     891: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     894: getfield      #56                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.jmxLeaderElectionBean:Lorg/apache/zookeeper/server/quorum/LeaderElectionBean;
     897: ifnull        913
     900: invokestatic  #57                 // Method org/apache/zookeeper/jmx/MBeanRegistry.getInstance:()Lorg/apache/zookeeper/jmx/MBeanRegistry;
     903: aload_0
     904: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     907: getfield      #56                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.jmxLeaderElectionBean:Lorg/apache/zookeeper/server/quorum/LeaderElectionBean;
     910: invokevirtual #129                // Method org/apache/zookeeper/jmx/MBeanRegistry.unregister:(Lorg/apache/zookeeper/jmx/ZKMBeanInfo;)V
     913: goto          930
     916: astore        20
     918: getstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
     921: ldc           #130                // String Failed to unregister with JMX
     923: aload         20
     925: invokeinterface #62,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     930: aload_0
     931: getfield      #2                  // Field self:Lorg/apache/zookeeper/server/quorum/QuorumPeer;
     934: aconst_null
     935: putfield      #56                 // Field org/apache/zookeeper/server/quorum/QuorumPeer.jmxLeaderElectionBean:Lorg/apache/zookeeper/server/quorum/LeaderElectionBean;
     938: ret           19
    Exception table:
       from    to  target type
           0    34    37   Class java/lang/Exception
         108   125   128   Class java/net/SocketException
         308   318   321   Class java/lang/IllegalArgumentException
         369   431   555   Class java/io/IOException
         434   492   555   Class java/io/IOException
         495   552   555   Class java/io/IOException
          57   798   880   any
         801   859   880   any
         862   877   880   any
         880   885   880   any
         890   913   916   Class java/lang/Exception

  static {};
    Code:
       0: ldc_w         #131                // class org/apache/zookeeper/server/quorum/LeaderElection
       3: invokestatic  #132                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       6: putstatic     #44                 // Field LOG:Lorg/slf4j/Logger;
       9: new           #133                // class java/util/Random
      12: dup
      13: invokespecial #134                // Method java/util/Random."<init>":()V
      16: putstatic     #76                 // Field epochGen:Ljava/util/Random;
      19: return
}
