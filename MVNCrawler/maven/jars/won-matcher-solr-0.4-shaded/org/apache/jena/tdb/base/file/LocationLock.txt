Compiled from "LocationLock.java"
public class org.apache.jena.tdb.base.file.LocationLock {
  private static final int NO_OWNER;

  private static final java.lang.String LOCK_FILENAME;

  private org.apache.jena.tdb.base.file.Location location;

  public org.apache.jena.tdb.base.file.LocationLock(org.apache.jena.tdb.base.file.Location);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_1
       5: ifnonnull     18
       8: new           #2                  // class java/lang/NullPointerException
      11: dup
      12: ldc           #3                  // String Location cannot be null
      14: invokespecial #4                  // Method java/lang/NullPointerException."<init>":(Ljava/lang/String;)V
      17: athrow
      18: aload_0
      19: aload_1
      20: putfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
      23: return

  public boolean canLock();
    Code:
       0: aload_0
       1: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
       4: invokevirtual #6                  // Method org/apache/jena/tdb/base/file/Location.isMem:()Z
       7: ifne          14
      10: iconst_1
      11: goto          15
      14: iconst_0
      15: ireturn

  public boolean isLocked();
    Code:
       0: aload_0
       1: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
       4: invokevirtual #6                  // Method org/apache/jena/tdb/base/file/Location.isMem:()Z
       7: ifeq          12
      10: iconst_0
      11: ireturn
      12: aload_0
      13: invokevirtual #7                  // Method getOwner:()I
      16: ifeq          23
      19: iconst_1
      20: goto          24
      23: iconst_0
      24: ireturn

  public boolean isOwned();
    Code:
       0: aload_0
       1: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
       4: invokevirtual #6                  // Method org/apache/jena/tdb/base/file/Location.isMem:()Z
       7: ifeq          12
      10: iconst_0
      11: ireturn
      12: aload_0
      13: invokevirtual #7                  // Method getOwner:()I
      16: istore_1
      17: iload_1
      18: ifne          23
      21: iconst_0
      22: ireturn
      23: iload_1
      24: iconst_0
      25: invokestatic  #9                  // Method org/apache/jena/tdb/sys/ProcessUtils.getPid:(I)I
      28: if_icmpne     35
      31: iconst_1
      32: goto          36
      35: iconst_0
      36: ireturn

  public int getOwner();
    Code:
       0: aload_0
       1: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
       4: invokevirtual #6                  // Method org/apache/jena/tdb/base/file/Location.isMem:()Z
       7: ifeq          12
      10: iconst_0
      11: ireturn
      12: aload_0
      13: invokespecial #10                 // Method getLockFile:()Ljava/io/File;
      16: astore_1
      17: aload_1
      18: invokevirtual #11                 // Method java/io/File.exists:()Z
      21: ifeq          68
      24: aload_0
      25: aload_1
      26: invokespecial #12                 // Method checkLockFileForRead:(Ljava/io/File;)V
      29: aload_1
      30: invokevirtual #13                 // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
      33: invokestatic  #14                 // Method org/apache/jena/atlas/io/IO.readWholeFileAsUTF8:(Ljava/lang/String;)Ljava/lang/String;
      36: astore_2
      37: aload_2
      38: invokestatic  #15                 // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
      41: istore_3
      42: iload_3
      43: ireturn
      44: astore_2
      45: new           #17                 // class org/apache/jena/tdb/base/file/FileException
      48: dup
      49: ldc           #18                 // String Unable to check TDB lock owner due to an IO error reading the lock file
      51: aload_2
      52: invokespecial #19                 // Method org/apache/jena/tdb/base/file/FileException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      55: athrow
      56: astore_2
      57: new           #17                 // class org/apache/jena/tdb/base/file/FileException
      60: dup
      61: ldc           #21                 // String Unable to check TDB lock owner as the lock file contains invalid data
      63: aload_2
      64: invokespecial #19                 // Method org/apache/jena/tdb/base/file/FileException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      67: athrow
      68: iconst_0
      69: ireturn
    Exception table:
       from    to  target type
          29    43    44   Class java/io/IOException
          29    43    56   Class java/lang/NumberFormatException

  public boolean canObtain();
    Code:
       0: aload_0
       1: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
       4: invokevirtual #6                  // Method org/apache/jena/tdb/base/file/Location.isMem:()Z
       7: ifeq          12
      10: iconst_0
      11: ireturn
      12: aload_0
      13: invokevirtual #7                  // Method getOwner:()I
      16: istore_1
      17: iconst_0
      18: invokestatic  #9                  // Method org/apache/jena/tdb/sys/ProcessUtils.getPid:(I)I
      21: istore_2
      22: iload_1
      23: ifne          32
      26: iload_2
      27: ifeq          39
      30: iconst_1
      31: ireturn
      32: iload_1
      33: iload_2
      34: if_icmpne     39
      37: iconst_1
      38: ireturn
      39: iload_1
      40: invokestatic  #22                 // Method org/apache/jena/tdb/sys/ProcessUtils.isAlive:(I)Z
      43: ifne          48
      46: iconst_1
      47: ireturn
      48: iconst_0
      49: ireturn

  public void obtain();
    Code:
       0: aload_0
       1: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
       4: invokevirtual #6                  // Method org/apache/jena/tdb/base/file/Location.isMem:()Z
       7: ifeq          11
      10: return
      11: aload_0
      12: invokevirtual #7                  // Method getOwner:()I
      15: istore_1
      16: iconst_0
      17: invokestatic  #9                  // Method org/apache/jena/tdb/sys/ProcessUtils.getPid:(I)I
      20: istore_2
      21: iload_1
      22: ifne          76
      25: iload_2
      26: ifne          68
      29: getstatic     #23                 // Field org/apache/jena/tdb/sys/SystemTDB.errlog:Lorg/slf4j/Logger;
      32: new           #24                 // class java/lang/StringBuilder
      35: dup
      36: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      39: ldc           #26                 // String Location
      41: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      44: aload_0
      45: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
      48: invokevirtual #28                 // Method org/apache/jena/tdb/base/file/Location.getDirectoryPath:()Ljava/lang/String;
      51: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      54: ldc           #29                 // String  cannot be locked as unable to obtain PID of current process, if another JVM accessed this location while this process is accessing it then data corruption may occur
      56: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      59: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      62: invokeinterface #31,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      67: return
      68: aload_0
      69: iload_2
      70: invokespecial #32                 // Method takeLock:(I)V
      73: goto          158
      76: iload_1
      77: iconst_0
      78: invokestatic  #9                  // Method org/apache/jena/tdb/sys/ProcessUtils.getPid:(I)I
      81: if_icmpne     87
      84: goto          158
      87: iload_1
      88: invokestatic  #22                 // Method org/apache/jena/tdb/sys/ProcessUtils.isAlive:(I)Z
      91: ifeq          150
      94: new           #33                 // class org/apache/jena/tdb/TDBException
      97: dup
      98: new           #24                 // class java/lang/StringBuilder
     101: dup
     102: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
     105: ldc           #26                 // String Location
     107: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     110: aload_0
     111: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
     114: invokevirtual #28                 // Method org/apache/jena/tdb/base/file/Location.getDirectoryPath:()Ljava/lang/String;
     117: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     120: ldc           #34                 // String  is currently locked by PID
     122: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     125: iload_1
     126: invokevirtual #35                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     129: ldc           #36                 // String (this process is PID
     131: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     134: iload_2
     135: invokevirtual #35                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     138: ldc           #37                 // String ).  TDB databases do not permit concurrent usage across JVMs so in order to prevent possible data corruption you cannot open this location from the JVM that does not own the lock for the dataset
     140: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     143: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     146: invokespecial #38                 // Method org/apache/jena/tdb/TDBException."<init>":(Ljava/lang/String;)V
     149: athrow
     150: aload_0
     151: iconst_0
     152: invokestatic  #9                  // Method org/apache/jena/tdb/sys/ProcessUtils.getPid:(I)I
     155: invokespecial #32                 // Method takeLock:(I)V
     158: return

  private void takeLock(int);
    Code:
       0: aload_0
       1: invokespecial #10                 // Method getLockFile:()Ljava/io/File;
       4: astore_2
       5: aload_0
       6: aload_2
       7: invokespecial #39                 // Method checkLockFileForWrite:(Ljava/io/File;)V
      10: new           #40                 // class java/io/BufferedWriter
      13: dup
      14: new           #41                 // class java/io/FileWriter
      17: dup
      18: aload_2
      19: invokespecial #42                 // Method java/io/FileWriter."<init>":(Ljava/io/File;)V
      22: invokespecial #43                 // Method java/io/BufferedWriter."<init>":(Ljava/io/Writer;)V
      25: astore_3
      26: aconst_null
      27: astore        4
      29: aload_3
      30: iload_1
      31: invokestatic  #44                 // Method java/lang/Integer.toString:(I)Ljava/lang/String;
      34: invokevirtual #45                 // Method java/io/BufferedWriter.write:(Ljava/lang/String;)V
      37: aload_3
      38: invokevirtual #46                 // Method java/io/BufferedWriter.close:()V
      41: aload_3
      42: ifnull        122
      45: aload         4
      47: ifnull        69
      50: aload_3
      51: invokevirtual #46                 // Method java/io/BufferedWriter.close:()V
      54: goto          122
      57: astore        5
      59: aload         4
      61: aload         5
      63: invokevirtual #48                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
      66: goto          122
      69: aload_3
      70: invokevirtual #46                 // Method java/io/BufferedWriter.close:()V
      73: goto          122
      76: astore        5
      78: aload         5
      80: astore        4
      82: aload         5
      84: athrow
      85: astore        6
      87: aload_3
      88: ifnull        119
      91: aload         4
      93: ifnull        115
      96: aload_3
      97: invokevirtual #46                 // Method java/io/BufferedWriter.close:()V
     100: goto          119
     103: astore        7
     105: aload         4
     107: aload         7
     109: invokevirtual #48                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     112: goto          119
     115: aload_3
     116: invokevirtual #46                 // Method java/io/BufferedWriter.close:()V
     119: aload         6
     121: athrow
     122: goto          160
     125: astore_3
     126: new           #33                 // class org/apache/jena/tdb/TDBException
     129: dup
     130: new           #24                 // class java/lang/StringBuilder
     133: dup
     134: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
     137: ldc           #49                 // String Failed to obtain a lock on the location
     139: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     142: aload_0
     143: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
     146: invokevirtual #28                 // Method org/apache/jena/tdb/base/file/Location.getDirectoryPath:()Ljava/lang/String;
     149: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     152: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     155: aload_3
     156: invokespecial #50                 // Method org/apache/jena/tdb/TDBException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     159: athrow
     160: aload_2
     161: invokevirtual #51                 // Method java/io/File.deleteOnExit:()V
     164: return
    Exception table:
       from    to  target type
          50    54    57   Class java/lang/Throwable
          29    41    76   Class java/lang/Throwable
          29    41    85   any
          96   100   103   Class java/lang/Throwable
          76    87    85   any
          10   122   125   Class java/io/IOException

  public void release();
    Code:
       0: aload_0
       1: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
       4: invokevirtual #6                  // Method org/apache/jena/tdb/base/file/Location.isMem:()Z
       7: ifeq          11
      10: return
      11: aload_0
      12: invokevirtual #7                  // Method getOwner:()I
      15: istore_1
      16: iload_1
      17: ifne          21
      20: return
      21: iload_1
      22: iconst_0
      23: invokestatic  #9                  // Method org/apache/jena/tdb/sys/ProcessUtils.getPid:(I)I
      26: if_icmpeq     67
      29: new           #33                 // class org/apache/jena/tdb/TDBException
      32: dup
      33: new           #24                 // class java/lang/StringBuilder
      36: dup
      37: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      40: ldc           #52                 // String Cannot release the lock on location
      42: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      45: aload_0
      46: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
      49: invokevirtual #28                 // Method org/apache/jena/tdb/base/file/Location.getDirectoryPath:()Ljava/lang/String;
      52: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      55: ldc           #53                 // String  since this process does not own the lock
      57: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      60: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      63: invokespecial #38                 // Method org/apache/jena/tdb/TDBException."<init>":(Ljava/lang/String;)V
      66: athrow
      67: aload_0
      68: invokespecial #10                 // Method getLockFile:()Ljava/io/File;
      71: astore_2
      72: aload_2
      73: invokevirtual #11                 // Method java/io/File.exists:()Z
      76: ifne          80
      79: return
      80: aload_2
      81: invokevirtual #54                 // Method java/io/File.delete:()Z
      84: ifne          125
      87: new           #33                 // class org/apache/jena/tdb/TDBException
      90: dup
      91: new           #24                 // class java/lang/StringBuilder
      94: dup
      95: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      98: ldc           #55                 // String Failed to release the lock on location
     100: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     103: aload_0
     104: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
     107: invokevirtual #28                 // Method org/apache/jena/tdb/base/file/Location.getDirectoryPath:()Ljava/lang/String;
     110: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     113: ldc           #56                 // String , it may be necessary to manually remove the lock file
     115: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     118: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     121: invokespecial #38                 // Method org/apache/jena/tdb/TDBException."<init>":(Ljava/lang/String;)V
     124: athrow
     125: return

  private java.io.File getLockFile();
    Code:
       0: new           #57                 // class java/io/File
       3: dup
       4: aload_0
       5: getfield      #5                  // Field location:Lorg/apache/jena/tdb/base/file/Location;
       8: ldc           #58                 // String tdb.lock
      10: invokevirtual #59                 // Method org/apache/jena/tdb/base/file/Location.getPath:(Ljava/lang/String;)Ljava/lang/String;
      13: invokespecial #60                 // Method java/io/File."<init>":(Ljava/lang/String;)V
      16: areturn

  private void checkLockFileForRead(java.io.File);
    Code:
       0: aload_1
       1: invokevirtual #11                 // Method java/io/File.exists:()Z
       4: ifne          8
       7: return
       8: aload_1
       9: invokevirtual #61                 // Method java/io/File.isFile:()Z
      12: ifeq          22
      15: aload_1
      16: invokevirtual #62                 // Method java/io/File.canRead:()Z
      19: ifne          32
      22: new           #17                 // class org/apache/jena/tdb/base/file/FileException
      25: dup
      26: ldc           #63                 // String Unable to check TDB lock owner for this location since the expected lock file is not a file/not readable
      28: invokespecial #64                 // Method org/apache/jena/tdb/base/file/FileException."<init>":(Ljava/lang/String;)V
      31: athrow
      32: return

  private void checkLockFileForWrite(java.io.File);
    Code:
       0: aload_1
       1: invokevirtual #11                 // Method java/io/File.exists:()Z
       4: ifne          8
       7: return
       8: aload_1
       9: invokevirtual #61                 // Method java/io/File.isFile:()Z
      12: ifeq          22
      15: aload_1
      16: invokevirtual #65                 // Method java/io/File.canWrite:()Z
      19: ifne          32
      22: new           #17                 // class org/apache/jena/tdb/base/file/FileException
      25: dup
      26: ldc           #66                 // String Unable to check TDB lock owner for this location since the expected lock file is not a file/not writable
      28: invokespecial #64                 // Method org/apache/jena/tdb/base/file/FileException."<init>":(Ljava/lang/String;)V
      31: athrow
      32: return
}
