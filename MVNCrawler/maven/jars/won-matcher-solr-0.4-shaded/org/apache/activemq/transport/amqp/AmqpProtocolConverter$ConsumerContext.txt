Compiled from "AmqpProtocolConverter.java"
class org.apache.activemq.transport.amqp.AmqpProtocolConverter$ConsumerContext extends org.apache.activemq.transport.amqp.AmqpProtocolConverter$AmqpDeliveryListener {
  private final org.apache.activemq.command.ConsumerId consumerId;

  private final org.apache.qpid.proton.engine.Sender sender;

  private final boolean presettle;

  private boolean closed;

  public org.apache.activemq.command.ConsumerInfo info;

  private boolean endOfBrowse;

  protected java.util.LinkedList<org.apache.activemq.command.MessageDispatch> dispatchedInTx;

  long nextTagId;

  java.util.HashSet<byte[]> tagCache;

  java.util.LinkedList<org.apache.activemq.command.MessageDispatch> outbound;

  org.fusesource.hawtbuf.Buffer currentBuffer;

  org.apache.qpid.proton.engine.Delivery currentDelivery;

  final java.lang.String MESSAGE_FORMAT_KEY;

  final org.apache.activemq.transport.amqp.AmqpProtocolConverter this$0;

  public org.apache.activemq.transport.amqp.AmqpProtocolConverter$ConsumerContext(org.apache.activemq.transport.amqp.AmqpProtocolConverter, org.apache.activemq.command.ConsumerId, org.apache.qpid.proton.engine.Sender);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #3                  // Field this$0:Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;
       5: aload_0
       6: invokespecial #4                  // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter$AmqpDeliveryListener."<init>":()V
       9: aload_0
      10: iconst_0
      11: putfield      #5                  // Field endOfBrowse:Z
      14: aload_0
      15: new           #6                  // class java/util/LinkedList
      18: dup
      19: invokespecial #7                  // Method java/util/LinkedList."<init>":()V
      22: putfield      #8                  // Field dispatchedInTx:Ljava/util/LinkedList;
      25: aload_0
      26: lconst_0
      27: putfield      #9                  // Field nextTagId:J
      30: aload_0
      31: new           #10                 // class java/util/HashSet
      34: dup
      35: invokespecial #11                 // Method java/util/HashSet."<init>":()V
      38: putfield      #12                 // Field tagCache:Ljava/util/HashSet;
      41: aload_0
      42: new           #6                  // class java/util/LinkedList
      45: dup
      46: invokespecial #7                  // Method java/util/LinkedList."<init>":()V
      49: putfield      #13                 // Field outbound:Ljava/util/LinkedList;
      52: aload_0
      53: new           #14                 // class java/lang/StringBuilder
      56: dup
      57: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
      60: aload_0
      61: getfield      #3                  // Field this$0:Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;
      64: getfield      #16                 // Field org/apache/activemq/transport/amqp/AmqpProtocolConverter.outboundTransformer:Lorg/apache/qpid/proton/jms/OutboundTransformer;
      67: invokevirtual #17                 // Method org/apache/qpid/proton/jms/OutboundTransformer.getPrefixVendor:()Ljava/lang/String;
      70: invokevirtual #18                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      73: ldc           #19                 // String MESSAGE_FORMAT
      75: invokevirtual #18                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      78: invokevirtual #20                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      81: putfield      #21                 // Field MESSAGE_FORMAT_KEY:Ljava/lang/String;
      84: aload_0
      85: aload_2
      86: putfield      #22                 // Field consumerId:Lorg/apache/activemq/command/ConsumerId;
      89: aload_0
      90: aload_3
      91: putfield      #2                  // Field sender:Lorg/apache/qpid/proton/engine/Sender;
      94: aload_0
      95: aload_3
      96: invokeinterface #23,  1           // InterfaceMethod org/apache/qpid/proton/engine/Sender.getRemoteSenderSettleMode:()Lorg/apache/qpid/proton/amqp/transport/SenderSettleMode;
     101: getstatic     #24                 // Field org/apache/qpid/proton/amqp/transport/SenderSettleMode.SETTLED:Lorg/apache/qpid/proton/amqp/transport/SenderSettleMode;
     104: if_acmpne     111
     107: iconst_1
     108: goto          112
     111: iconst_0
     112: putfield      #25                 // Field presettle:Z
     115: return

  byte[] nextTag();
    Code:
       0: aload_0
       1: getfield      #12                 // Field tagCache:Ljava/util/HashSet;
       4: ifnull        44
       7: aload_0
       8: getfield      #12                 // Field tagCache:Ljava/util/HashSet;
      11: invokevirtual #26                 // Method java/util/HashSet.isEmpty:()Z
      14: ifne          44
      17: aload_0
      18: getfield      #12                 // Field tagCache:Ljava/util/HashSet;
      21: invokevirtual #27                 // Method java/util/HashSet.iterator:()Ljava/util/Iterator;
      24: astore_2
      25: aload_2
      26: invokeinterface #28,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      31: checkcast     #29                 // class "[B"
      34: astore_1
      35: aload_2
      36: invokeinterface #30,  1           // InterfaceMethod java/util/Iterator.remove:()V
      41: goto          77
      44: aload_0
      45: dup
      46: getfield      #9                  // Field nextTagId:J
      49: dup2_x1
      50: lconst_1
      51: ladd
      52: putfield      #9                  // Field nextTagId:J
      55: invokestatic  #31                 // Method java/lang/Long.toHexString:(J)Ljava/lang/String;
      58: ldc           #32                 // String UTF-8
      60: invokevirtual #33                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      63: astore_1
      64: goto          77
      67: astore_2
      68: new           #35                 // class java/lang/RuntimeException
      71: dup
      72: aload_2
      73: invokespecial #36                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
      76: athrow
      77: aload_1
      78: areturn
    Exception table:
       from    to  target type
          44    64    67   Class java/io/UnsupportedEncodingException

  void checkinTag(byte[]);
    Code:
       0: aload_0
       1: getfield      #12                 // Field tagCache:Ljava/util/HashSet;
       4: invokevirtual #37                 // Method java/util/HashSet.size:()I
       7: sipush        1024
      10: if_icmpge     22
      13: aload_0
      14: getfield      #12                 // Field tagCache:Ljava/util/HashSet;
      17: aload_1
      18: invokevirtual #38                 // Method java/util/HashSet.add:(Ljava/lang/Object;)Z
      21: pop
      22: return

  public void onClose() throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #1                  // Field closed:Z
       4: ifne          70
       7: aload_0
       8: iconst_1
       9: putfield      #1                  // Field closed:Z
      12: aload_0
      13: getfield      #2                  // Field sender:Lorg/apache/qpid/proton/engine/Sender;
      16: invokeinterface #39,  1           // InterfaceMethod org/apache/qpid/proton/engine/Sender.getSession:()Lorg/apache/qpid/proton/engine/Session;
      21: invokeinterface #40,  1           // InterfaceMethod org/apache/qpid/proton/engine/Session.getContext:()Ljava/lang/Object;
      26: checkcast     #41                 // class org/apache/activemq/transport/amqp/AmqpProtocolConverter$AmqpSessionContext
      29: astore_1
      30: aload_1
      31: ifnull        51
      34: aload_1
      35: getfield      #42                 // Field org/apache/activemq/transport/amqp/AmqpProtocolConverter$AmqpSessionContext.consumers:Ljava/util/Map;
      38: aload_0
      39: getfield      #43                 // Field info:Lorg/apache/activemq/command/ConsumerInfo;
      42: invokevirtual #44                 // Method org/apache/activemq/command/ConsumerInfo.getConsumerId:()Lorg/apache/activemq/command/ConsumerId;
      45: invokeinterface #45,  2           // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      50: pop
      51: aload_0
      52: getfield      #3                  // Field this$0:Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;
      55: new           #46                 // class org/apache/activemq/command/RemoveInfo
      58: dup
      59: aload_0
      60: getfield      #22                 // Field consumerId:Lorg/apache/activemq/command/ConsumerId;
      63: invokespecial #47                 // Method org/apache/activemq/command/RemoveInfo."<init>":(Lorg/apache/activemq/command/DataStructure;)V
      66: aconst_null
      67: invokevirtual #48                 // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.sendToActiveMQ:(Lorg/apache/activemq/command/Command;Lorg/apache/activemq/transport/amqp/ResponseHandler;)V
      70: return

  public void onMessageDispatch(org.apache.activemq.command.MessageDispatch) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #1                  // Field closed:Z
       4: ifne          43
       7: aload_0
       8: getfield      #13                 // Field outbound:Ljava/util/LinkedList;
      11: dup
      12: astore_2
      13: monitorenter
      14: aload_0
      15: getfield      #13                 // Field outbound:Ljava/util/LinkedList;
      18: aload_1
      19: invokevirtual #49                 // Method java/util/LinkedList.addLast:(Ljava/lang/Object;)V
      22: aload_2
      23: monitorexit
      24: goto          32
      27: astore_3
      28: aload_2
      29: monitorexit
      30: aload_3
      31: athrow
      32: aload_0
      33: invokevirtual #50                 // Method pumpOutbound:()V
      36: aload_0
      37: getfield      #3                  // Field this$0:Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;
      40: invokevirtual #51                 // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.pumpProtonToSocket:()V
      43: return
    Exception table:
       from    to  target type
          14    24    27   any
          27    30    27   any

  public void pumpOutbound() throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #1                  // Field closed:Z
       4: ifne          381
       7: aload_0
       8: getfield      #52                 // Field currentBuffer:Lorg/fusesource/hawtbuf/Buffer;
      11: ifnull        114
      14: aload_0
      15: getfield      #2                  // Field sender:Lorg/apache/qpid/proton/engine/Sender;
      18: aload_0
      19: getfield      #52                 // Field currentBuffer:Lorg/fusesource/hawtbuf/Buffer;
      22: getfield      #53                 // Field org/fusesource/hawtbuf/Buffer.data:[B
      25: aload_0
      26: getfield      #52                 // Field currentBuffer:Lorg/fusesource/hawtbuf/Buffer;
      29: getfield      #54                 // Field org/fusesource/hawtbuf/Buffer.offset:I
      32: aload_0
      33: getfield      #52                 // Field currentBuffer:Lorg/fusesource/hawtbuf/Buffer;
      36: getfield      #55                 // Field org/fusesource/hawtbuf/Buffer.length:I
      39: invokeinterface #56,  4           // InterfaceMethod org/apache/qpid/proton/engine/Sender.send:([BII)I
      44: istore_1
      45: iload_1
      46: ifle          110
      49: aload_0
      50: getfield      #52                 // Field currentBuffer:Lorg/fusesource/hawtbuf/Buffer;
      53: iload_1
      54: invokevirtual #57                 // Method org/fusesource/hawtbuf/Buffer.moveHead:(I)Lorg/fusesource/hawtbuf/Buffer;
      57: pop
      58: aload_0
      59: getfield      #52                 // Field currentBuffer:Lorg/fusesource/hawtbuf/Buffer;
      62: getfield      #55                 // Field org/fusesource/hawtbuf/Buffer.length:I
      65: ifne          111
      68: aload_0
      69: getfield      #25                 // Field presettle:Z
      72: ifeq          87
      75: aload_0
      76: aload_0
      77: getfield      #58                 // Field currentDelivery:Lorg/apache/qpid/proton/engine/Delivery;
      80: iconst_4
      81: invokespecial #59                 // Method settle:(Lorg/apache/qpid/proton/engine/Delivery;I)V
      84: goto          97
      87: aload_0
      88: getfield      #2                  // Field sender:Lorg/apache/qpid/proton/engine/Sender;
      91: invokeinterface #60,  1           // InterfaceMethod org/apache/qpid/proton/engine/Sender.advance:()Z
      96: pop
      97: aload_0
      98: aconst_null
      99: putfield      #52                 // Field currentBuffer:Lorg/fusesource/hawtbuf/Buffer;
     102: aload_0
     103: aconst_null
     104: putfield      #58                 // Field currentDelivery:Lorg/apache/qpid/proton/engine/Delivery;
     107: goto          111
     110: return
     111: goto          7
     114: aload_0
     115: getfield      #13                 // Field outbound:Ljava/util/LinkedList;
     118: invokevirtual #61                 // Method java/util/LinkedList.isEmpty:()Z
     121: ifeq          125
     124: return
     125: aload_0
     126: getfield      #13                 // Field outbound:Ljava/util/LinkedList;
     129: invokevirtual #62                 // Method java/util/LinkedList.removeFirst:()Ljava/lang/Object;
     132: checkcast     #63                 // class org/apache/activemq/command/MessageDispatch
     135: astore_1
     136: aconst_null
     137: astore_2
     138: aload_1
     139: invokevirtual #64                 // Method org/apache/activemq/command/MessageDispatch.getMessage:()Lorg/apache/activemq/command/Message;
     142: ifnull        224
     145: aload_1
     146: invokevirtual #65                 // Method org/apache/activemq/command/MessageDispatch.getDestination:()Lorg/apache/activemq/command/ActiveMQDestination;
     149: invokevirtual #66                 // Method org/apache/activemq/command/ActiveMQDestination.isTopic:()Z
     152: ifeq          188
     155: aload_1
     156: invokevirtual #64                 // Method org/apache/activemq/command/MessageDispatch.getMessage:()Lorg/apache/activemq/command/Message;
     159: dup
     160: astore_3
     161: monitorenter
     162: aload_1
     163: invokevirtual #64                 // Method org/apache/activemq/command/MessageDispatch.getMessage:()Lorg/apache/activemq/command/Message;
     166: invokevirtual #67                 // Method org/apache/activemq/command/Message.copy:()Lorg/apache/activemq/command/Message;
     169: checkcast     #68                 // class org/apache/activemq/command/ActiveMQMessage
     172: astore_2
     173: aload_3
     174: monitorexit
     175: goto          185
     178: astore        4
     180: aload_3
     181: monitorexit
     182: aload         4
     184: athrow
     185: goto          196
     188: aload_1
     189: invokevirtual #64                 // Method org/apache/activemq/command/MessageDispatch.getMessage:()Lorg/apache/activemq/command/Message;
     192: checkcast     #68                 // class org/apache/activemq/command/ActiveMQMessage
     195: astore_2
     196: aload_2
     197: invokevirtual #69                 // Method org/apache/activemq/command/ActiveMQMessage.getProperties:()Ljava/util/Map;
     200: aload_0
     201: getfield      #21                 // Field MESSAGE_FORMAT_KEY:Ljava/lang/String;
     204: invokeinterface #70,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     209: ifne          224
     212: aload_2
     213: aload_0
     214: getfield      #21                 // Field MESSAGE_FORMAT_KEY:Ljava/lang/String;
     217: iconst_0
     218: invokestatic  #71                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     221: invokevirtual #72                 // Method org/apache/activemq/command/ActiveMQMessage.setProperty:(Ljava/lang/String;Ljava/lang/Object;)V
     224: aload_2
     225: astore_3
     226: aload_3
     227: ifnonnull     242
     230: aload_0
     231: iconst_1
     232: putfield      #5                  // Field endOfBrowse:Z
     235: aload_0
     236: invokevirtual #73                 // Method drainCheck:()V
     239: goto          370
     242: aload_3
     243: aload_1
     244: invokevirtual #74                 // Method org/apache/activemq/command/MessageDispatch.getRedeliveryCounter:()I
     247: invokevirtual #75                 // Method org/apache/activemq/command/ActiveMQMessage.setRedeliveryCounter:(I)V
     250: aload_3
     251: iconst_1
     252: invokevirtual #76                 // Method org/apache/activemq/command/ActiveMQMessage.setReadOnlyBody:(Z)V
     255: aload_0
     256: getfield      #3                  // Field this$0:Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;
     259: getfield      #16                 // Field org/apache/activemq/transport/amqp/AmqpProtocolConverter.outboundTransformer:Lorg/apache/qpid/proton/jms/OutboundTransformer;
     262: aload_3
     263: invokevirtual #77                 // Method org/apache/qpid/proton/jms/OutboundTransformer.transform:(Ljavax/jms/Message;)Lorg/apache/qpid/proton/jms/EncodedMessage;
     266: astore        4
     268: aload         4
     270: ifnull        370
     273: aload         4
     275: invokevirtual #78                 // Method org/apache/qpid/proton/jms/EncodedMessage.getLength:()I
     278: ifle          370
     281: aload_0
     282: new           #79                 // class org/fusesource/hawtbuf/Buffer
     285: dup
     286: aload         4
     288: invokevirtual #80                 // Method org/apache/qpid/proton/jms/EncodedMessage.getArray:()[B
     291: aload         4
     293: invokevirtual #81                 // Method org/apache/qpid/proton/jms/EncodedMessage.getArrayOffset:()I
     296: aload         4
     298: invokevirtual #78                 // Method org/apache/qpid/proton/jms/EncodedMessage.getLength:()I
     301: invokespecial #82                 // Method org/fusesource/hawtbuf/Buffer."<init>":([BII)V
     304: putfield      #52                 // Field currentBuffer:Lorg/fusesource/hawtbuf/Buffer;
     307: aload_0
     308: getfield      #25                 // Field presettle:Z
     311: ifeq          335
     314: aload_0
     315: aload_0
     316: getfield      #2                  // Field sender:Lorg/apache/qpid/proton/engine/Sender;
     319: invokestatic  #83                 // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$700:()[B
     322: iconst_0
     323: iconst_0
     324: invokeinterface #84,  4           // InterfaceMethod org/apache/qpid/proton/engine/Sender.delivery:([BII)Lorg/apache/qpid/proton/engine/Delivery;
     329: putfield      #58                 // Field currentDelivery:Lorg/apache/qpid/proton/engine/Delivery;
     332: goto          360
     335: aload_0
     336: invokevirtual #85                 // Method nextTag:()[B
     339: astore        5
     341: aload_0
     342: aload_0
     343: getfield      #2                  // Field sender:Lorg/apache/qpid/proton/engine/Sender;
     346: aload         5
     348: iconst_0
     349: aload         5
     351: arraylength
     352: invokeinterface #84,  4           // InterfaceMethod org/apache/qpid/proton/engine/Sender.delivery:([BII)Lorg/apache/qpid/proton/engine/Delivery;
     357: putfield      #58                 // Field currentDelivery:Lorg/apache/qpid/proton/engine/Delivery;
     360: aload_0
     361: getfield      #58                 // Field currentDelivery:Lorg/apache/qpid/proton/engine/Delivery;
     364: aload_1
     365: invokeinterface #86,  2           // InterfaceMethod org/apache/qpid/proton/engine/Delivery.setContext:(Ljava/lang/Object;)V
     370: goto          378
     373: astore_2
     374: aload_2
     375: invokevirtual #88                 // Method java/lang/Exception.printStackTrace:()V
     378: goto          0
     381: return
    Exception table:
       from    to  target type
         162   175   178   any
         178   182   178   any
         136   370   373   Class java/lang/Exception

  private void settle(org.apache.qpid.proton.engine.Delivery, int) throws java.lang.Exception;
    Code:
       0: aload_1
       1: invokeinterface #89,  1           // InterfaceMethod org/apache/qpid/proton/engine/Delivery.getTag:()[B
       6: astore_3
       7: aload_3
       8: ifnull        30
      11: aload_3
      12: arraylength
      13: ifle          30
      16: aload_1
      17: invokeinterface #90,  1           // InterfaceMethod org/apache/qpid/proton/engine/Delivery.remotelySettled:()Z
      22: ifeq          30
      25: aload_0
      26: aload_3
      27: invokevirtual #91                 // Method checkinTag:([B)V
      30: iload_2
      31: iconst_m1
      32: if_icmpne     57
      35: aload_1
      36: invokeinterface #92,  1           // InterfaceMethod org/apache/qpid/proton/engine/Delivery.settle:()V
      41: aload_0
      42: aload_1
      43: invokeinterface #93,  1           // InterfaceMethod org/apache/qpid/proton/engine/Delivery.getContext:()Ljava/lang/Object;
      48: checkcast     #63                 // class org/apache/activemq/command/MessageDispatch
      51: invokevirtual #94                 // Method onMessageDispatch:(Lorg/apache/activemq/command/MessageDispatch;)V
      54: goto          251
      57: aload_1
      58: invokeinterface #93,  1           // InterfaceMethod org/apache/qpid/proton/engine/Delivery.getContext:()Ljava/lang/Object;
      63: checkcast     #63                 // class org/apache/activemq/command/MessageDispatch
      66: astore        4
      68: new           #95                 // class org/apache/activemq/command/MessageAck
      71: dup
      72: invokespecial #96                 // Method org/apache/activemq/command/MessageAck."<init>":()V
      75: astore        5
      77: aload         5
      79: aload_0
      80: getfield      #22                 // Field consumerId:Lorg/apache/activemq/command/ConsumerId;
      83: invokevirtual #97                 // Method org/apache/activemq/command/MessageAck.setConsumerId:(Lorg/apache/activemq/command/ConsumerId;)V
      86: aload         5
      88: aload         4
      90: invokevirtual #64                 // Method org/apache/activemq/command/MessageDispatch.getMessage:()Lorg/apache/activemq/command/Message;
      93: invokevirtual #98                 // Method org/apache/activemq/command/Message.getMessageId:()Lorg/apache/activemq/command/MessageId;
      96: invokevirtual #99                 // Method org/apache/activemq/command/MessageAck.setFirstMessageId:(Lorg/apache/activemq/command/MessageId;)V
      99: aload         5
     101: aload         4
     103: invokevirtual #64                 // Method org/apache/activemq/command/MessageDispatch.getMessage:()Lorg/apache/activemq/command/Message;
     106: invokevirtual #98                 // Method org/apache/activemq/command/Message.getMessageId:()Lorg/apache/activemq/command/MessageId;
     109: invokevirtual #100                // Method org/apache/activemq/command/MessageAck.setLastMessageId:(Lorg/apache/activemq/command/MessageId;)V
     112: aload         5
     114: iconst_1
     115: invokevirtual #101                // Method org/apache/activemq/command/MessageAck.setMessageCount:(I)V
     118: aload         5
     120: iload_2
     121: i2b
     122: invokevirtual #102                // Method org/apache/activemq/command/MessageAck.setAckType:(B)V
     125: aload         5
     127: aload         4
     129: invokevirtual #65                 // Method org/apache/activemq/command/MessageDispatch.getDestination:()Lorg/apache/activemq/command/ActiveMQDestination;
     132: invokevirtual #103                // Method org/apache/activemq/command/MessageAck.setDestination:(Lorg/apache/activemq/command/ActiveMQDestination;)V
     135: aload_1
     136: invokeinterface #104,  1          // InterfaceMethod org/apache/qpid/proton/engine/Delivery.getRemoteState:()Lorg/apache/qpid/proton/amqp/transport/DeliveryState;
     141: astore        6
     143: aload         6
     145: ifnull        221
     148: aload         6
     150: instanceof    #105                // class org/apache/qpid/proton/amqp/transaction/TransactionalState
     153: ifeq          221
     156: aload         6
     158: checkcast     #105                // class org/apache/qpid/proton/amqp/transaction/TransactionalState
     161: astore        7
     163: aload_0
     164: getfield      #3                  // Field this$0:Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;
     167: aload         7
     169: invokevirtual #106                // Method org/apache/qpid/proton/amqp/transaction/TransactionalState.getTxnId:()Lorg/apache/qpid/proton/amqp/Binary;
     172: invokestatic  #107                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$400:(Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;Lorg/apache/qpid/proton/amqp/Binary;)J
     175: lstore        8
     177: new           #108                // class org/apache/activemq/command/LocalTransactionId
     180: dup
     181: aload_0
     182: getfield      #3                  // Field this$0:Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;
     185: invokestatic  #109                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$500:(Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;)Lorg/apache/activemq/command/ConnectionId;
     188: lload         8
     190: invokespecial #110                // Method org/apache/activemq/command/LocalTransactionId."<init>":(Lorg/apache/activemq/command/ConnectionId;J)V
     193: astore        10
     195: aload         5
     197: aload         10
     199: invokevirtual #111                // Method org/apache/activemq/command/MessageAck.setTransactionId:(Lorg/apache/activemq/command/TransactionId;)V
     202: aload         4
     204: invokevirtual #64                 // Method org/apache/activemq/command/MessageDispatch.getMessage:()Lorg/apache/activemq/command/Message;
     207: aload         10
     209: invokevirtual #112                // Method org/apache/activemq/command/Message.setTransactionId:(Lorg/apache/activemq/command/TransactionId;)V
     212: aload_0
     213: getfield      #8                  // Field dispatchedInTx:Ljava/util/LinkedList;
     216: aload         4
     218: invokevirtual #113                // Method java/util/LinkedList.addFirst:(Ljava/lang/Object;)V
     221: invokestatic  #114                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$300:()Lorg/slf4j/Logger;
     224: ldc           #115                // String Sending Ack to ActiveMQ: {}
     226: aload         5
     228: invokeinterface #116,  3          // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
     233: aload_0
     234: getfield      #3                  // Field this$0:Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;
     237: aload         5
     239: new           #117                // class org/apache/activemq/transport/amqp/AmqpProtocolConverter$ConsumerContext$1
     242: dup
     243: aload_0
     244: aload_1
     245: invokespecial #118                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter$ConsumerContext$1."<init>":(Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter$ConsumerContext;Lorg/apache/qpid/proton/engine/Delivery;)V
     248: invokevirtual #48                 // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.sendToActiveMQ:(Lorg/apache/activemq/command/Command;Lorg/apache/activemq/transport/amqp/ResponseHandler;)V
     251: return

  public void drainCheck();
    Code:
       0: aload_0
       1: getfield      #43                 // Field info:Lorg/apache/activemq/command/ConsumerInfo;
       4: invokevirtual #119                // Method org/apache/activemq/command/ConsumerInfo.isBrowser:()Z
       7: ifeq          18
      10: aload_0
      11: getfield      #5                  // Field endOfBrowse:Z
      14: ifne          18
      17: return
      18: aload_0
      19: getfield      #13                 // Field outbound:Ljava/util/LinkedList;
      22: invokevirtual #61                 // Method java/util/LinkedList.isEmpty:()Z
      25: ifeq          38
      28: aload_0
      29: getfield      #2                  // Field sender:Lorg/apache/qpid/proton/engine/Sender;
      32: invokeinterface #120,  1          // InterfaceMethod org/apache/qpid/proton/engine/Sender.drained:()I
      37: pop
      38: return

  public void onDelivery(org.apache.qpid.proton.engine.Delivery) throws java.lang.Exception;
    Code:
       0: aload_1
       1: invokeinterface #93,  1           // InterfaceMethod org/apache/qpid/proton/engine/Delivery.getContext:()Ljava/lang/Object;
       6: checkcast     #63                 // class org/apache/activemq/command/MessageDispatch
       9: astore_2
      10: aload_1
      11: invokeinterface #104,  1          // InterfaceMethod org/apache/qpid/proton/engine/Delivery.getRemoteState:()Lorg/apache/qpid/proton/amqp/transport/DeliveryState;
      16: astore_3
      17: aload_3
      18: instanceof    #105                // class org/apache/qpid/proton/amqp/transaction/TransactionalState
      21: ifeq          99
      24: aload_3
      25: checkcast     #105                // class org/apache/qpid/proton/amqp/transaction/TransactionalState
      28: astore        4
      30: aload         4
      32: invokevirtual #121                // Method org/apache/qpid/proton/amqp/transaction/TransactionalState.getOutcome:()Lorg/apache/qpid/proton/amqp/messaging/Outcome;
      35: instanceof    #122                // class org/apache/qpid/proton/amqp/transport/DeliveryState
      38: ifeq          96
      41: invokestatic  #114                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$300:()Lorg/slf4j/Logger;
      44: ldc           #123                // String onDelivery: TX delivery state = {}
      46: aload_3
      47: invokeinterface #116,  3          // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
      52: aload         4
      54: invokevirtual #121                // Method org/apache/qpid/proton/amqp/transaction/TransactionalState.getOutcome:()Lorg/apache/qpid/proton/amqp/messaging/Outcome;
      57: checkcast     #122                // class org/apache/qpid/proton/amqp/transport/DeliveryState
      60: astore_3
      61: aload_3
      62: instanceof    #124                // class org/apache/qpid/proton/amqp/messaging/Accepted
      65: ifeq          96
      68: aload_1
      69: invokeinterface #90,  1           // InterfaceMethod org/apache/qpid/proton/engine/Delivery.remotelySettled:()Z
      74: ifne          90
      77: aload_1
      78: new           #124                // class org/apache/qpid/proton/amqp/messaging/Accepted
      81: dup
      82: invokespecial #125                // Method org/apache/qpid/proton/amqp/messaging/Accepted."<init>":()V
      85: invokeinterface #126,  2          // InterfaceMethod org/apache/qpid/proton/engine/Delivery.disposition:(Lorg/apache/qpid/proton/amqp/transport/DeliveryState;)V
      90: aload_0
      91: aload_1
      92: iconst_0
      93: invokespecial #59                 // Method settle:(Lorg/apache/qpid/proton/engine/Delivery;I)V
      96: goto          304
      99: aload_3
     100: instanceof    #124                // class org/apache/qpid/proton/amqp/messaging/Accepted
     103: ifeq          148
     106: invokestatic  #114                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$300:()Lorg/slf4j/Logger;
     109: ldc           #127                // String onDelivery: accepted state = {}
     111: aload_3
     112: invokeinterface #116,  3          // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
     117: aload_1
     118: invokeinterface #90,  1           // InterfaceMethod org/apache/qpid/proton/engine/Delivery.remotelySettled:()Z
     123: ifne          139
     126: aload_1
     127: new           #124                // class org/apache/qpid/proton/amqp/messaging/Accepted
     130: dup
     131: invokespecial #125                // Method org/apache/qpid/proton/amqp/messaging/Accepted."<init>":()V
     134: invokeinterface #126,  2          // InterfaceMethod org/apache/qpid/proton/engine/Delivery.disposition:(Lorg/apache/qpid/proton/amqp/transport/DeliveryState;)V
     139: aload_0
     140: aload_1
     141: iconst_4
     142: invokespecial #59                 // Method settle:(Lorg/apache/qpid/proton/engine/Delivery;I)V
     145: goto          304
     148: aload_3
     149: instanceof    #128                // class org/apache/qpid/proton/amqp/messaging/Rejected
     152: ifeq          192
     155: aload_2
     156: aload_2
     157: invokevirtual #74                 // Method org/apache/activemq/command/MessageDispatch.getRedeliveryCounter:()I
     160: iconst_1
     161: iadd
     162: invokevirtual #129                // Method org/apache/activemq/command/MessageDispatch.setRedeliveryCounter:(I)V
     165: invokestatic  #114                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$300:()Lorg/slf4j/Logger;
     168: ldc           #130                // String onDelivery: Rejected state = {}, delivery count now {}
     170: aload_3
     171: aload_2
     172: invokevirtual #74                 // Method org/apache/activemq/command/MessageDispatch.getRedeliveryCounter:()I
     175: invokestatic  #71                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     178: invokeinterface #131,  4          // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     183: aload_0
     184: aload_1
     185: iconst_m1
     186: invokespecial #59                 // Method settle:(Lorg/apache/qpid/proton/engine/Delivery;I)V
     189: goto          304
     192: aload_3
     193: instanceof    #132                // class org/apache/qpid/proton/amqp/messaging/Released
     196: ifeq          219
     199: invokestatic  #114                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$300:()Lorg/slf4j/Logger;
     202: ldc           #133                // String onDelivery: Released state = {}
     204: aload_3
     205: invokeinterface #116,  3          // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
     210: aload_0
     211: aload_1
     212: iconst_m1
     213: invokespecial #59                 // Method settle:(Lorg/apache/qpid/proton/engine/Delivery;I)V
     216: goto          304
     219: aload_3
     220: instanceof    #134                // class org/apache/qpid/proton/amqp/messaging/Modified
     223: ifeq          304
     226: aload_3
     227: checkcast     #134                // class org/apache/qpid/proton/amqp/messaging/Modified
     230: astore        4
     232: aload         4
     234: invokevirtual #135                // Method org/apache/qpid/proton/amqp/messaging/Modified.getDeliveryFailed:()Ljava/lang/Boolean;
     237: invokevirtual #136                // Method java/lang/Boolean.booleanValue:()Z
     240: ifeq          253
     243: aload_2
     244: aload_2
     245: invokevirtual #74                 // Method org/apache/activemq/command/MessageDispatch.getRedeliveryCounter:()I
     248: iconst_1
     249: iadd
     250: invokevirtual #129                // Method org/apache/activemq/command/MessageDispatch.setRedeliveryCounter:(I)V
     253: invokestatic  #114                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$300:()Lorg/slf4j/Logger;
     256: ldc           #137                // String onDelivery: Modified state = {}, delivery count now {}
     258: aload_3
     259: aload_2
     260: invokevirtual #74                 // Method org/apache/activemq/command/MessageDispatch.getRedeliveryCounter:()I
     263: invokestatic  #71                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     266: invokeinterface #131,  4          // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     271: iconst_m1
     272: istore        5
     274: aload         4
     276: invokevirtual #138                // Method org/apache/qpid/proton/amqp/messaging/Modified.getUndeliverableHere:()Ljava/lang/Boolean;
     279: astore        6
     281: aload         6
     283: ifnull        297
     286: aload         6
     288: invokevirtual #136                // Method java/lang/Boolean.booleanValue:()Z
     291: ifeq          297
     294: iconst_1
     295: istore        5
     297: aload_0
     298: aload_1
     299: iload         5
     301: invokespecial #59                 // Method settle:(Lorg/apache/qpid/proton/engine/Delivery;I)V
     304: aload_0
     305: invokevirtual #50                 // Method pumpOutbound:()V
     308: return

  void doCommit() throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #8                  // Field dispatchedInTx:Ljava/util/LinkedList;
       4: invokevirtual #61                 // Method java/util/LinkedList.isEmpty:()Z
       7: ifne          103
      10: aload_0
      11: getfield      #8                  // Field dispatchedInTx:Ljava/util/LinkedList;
      14: invokevirtual #139                // Method java/util/LinkedList.getFirst:()Ljava/lang/Object;
      17: checkcast     #63                 // class org/apache/activemq/command/MessageDispatch
      20: astore_1
      21: new           #95                 // class org/apache/activemq/command/MessageAck
      24: dup
      25: aload_1
      26: iconst_2
      27: aload_0
      28: getfield      #8                  // Field dispatchedInTx:Ljava/util/LinkedList;
      31: invokevirtual #140                // Method java/util/LinkedList.size:()I
      34: invokespecial #141                // Method org/apache/activemq/command/MessageAck."<init>":(Lorg/apache/activemq/command/MessageDispatch;BI)V
      37: astore_2
      38: aload_2
      39: aload_1
      40: invokevirtual #64                 // Method org/apache/activemq/command/MessageDispatch.getMessage:()Lorg/apache/activemq/command/Message;
      43: invokevirtual #142                // Method org/apache/activemq/command/Message.getTransactionId:()Lorg/apache/activemq/command/TransactionId;
      46: invokevirtual #111                // Method org/apache/activemq/command/MessageAck.setTransactionId:(Lorg/apache/activemq/command/TransactionId;)V
      49: aload_2
      50: aload_0
      51: getfield      #8                  // Field dispatchedInTx:Ljava/util/LinkedList;
      54: invokevirtual #143                // Method java/util/LinkedList.getLast:()Ljava/lang/Object;
      57: checkcast     #63                 // class org/apache/activemq/command/MessageDispatch
      60: invokevirtual #64                 // Method org/apache/activemq/command/MessageDispatch.getMessage:()Lorg/apache/activemq/command/Message;
      63: invokevirtual #98                 // Method org/apache/activemq/command/Message.getMessageId:()Lorg/apache/activemq/command/MessageId;
      66: invokevirtual #99                 // Method org/apache/activemq/command/MessageAck.setFirstMessageId:(Lorg/apache/activemq/command/MessageId;)V
      69: invokestatic  #114                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$300:()Lorg/slf4j/Logger;
      72: ldc           #144                // String Sending commit Ack to ActiveMQ: {}
      74: aload_2
      75: invokeinterface #116,  3          // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
      80: aload_0
      81: getfield      #8                  // Field dispatchedInTx:Ljava/util/LinkedList;
      84: invokevirtual #145                // Method java/util/LinkedList.clear:()V
      87: aload_0
      88: getfield      #3                  // Field this$0:Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter;
      91: aload_2
      92: new           #146                // class org/apache/activemq/transport/amqp/AmqpProtocolConverter$ConsumerContext$2
      95: dup
      96: aload_0
      97: invokespecial #147                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter$ConsumerContext$2."<init>":(Lorg/apache/activemq/transport/amqp/AmqpProtocolConverter$ConsumerContext;)V
     100: invokevirtual #48                 // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.sendToActiveMQ:(Lorg/apache/activemq/command/Command;Lorg/apache/activemq/transport/amqp/ResponseHandler;)V
     103: return

  void doRollback() throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #13                 // Field outbound:Ljava/util/LinkedList;
       4: dup
       5: astore_1
       6: monitorenter
       7: invokestatic  #114                // Method org/apache/activemq/transport/amqp/AmqpProtocolConverter.access$300:()Lorg/slf4j/Logger;
      10: ldc           #148                // String Rolling back {} messages for redelivery.
      12: aload_0
      13: getfield      #8                  // Field dispatchedInTx:Ljava/util/LinkedList;
      16: invokevirtual #140                // Method java/util/LinkedList.size:()I
      19: invokestatic  #71                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      22: invokeinterface #116,  3          // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
      27: aload_0
      28: getfield      #8                  // Field dispatchedInTx:Ljava/util/LinkedList;
      31: invokevirtual #149                // Method java/util/LinkedList.iterator:()Ljava/util/Iterator;
      34: astore_2
      35: aload_2
      36: invokeinterface #150,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      41: ifeq          83
      44: aload_2
      45: invokeinterface #28,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      50: checkcast     #63                 // class org/apache/activemq/command/MessageDispatch
      53: astore_3
      54: aload_3
      55: aload_3
      56: invokevirtual #74                 // Method org/apache/activemq/command/MessageDispatch.getRedeliveryCounter:()I
      59: iconst_1
      60: iadd
      61: invokevirtual #129                // Method org/apache/activemq/command/MessageDispatch.setRedeliveryCounter:(I)V
      64: aload_3
      65: invokevirtual #64                 // Method org/apache/activemq/command/MessageDispatch.getMessage:()Lorg/apache/activemq/command/Message;
      68: aconst_null
      69: invokevirtual #112                // Method org/apache/activemq/command/Message.setTransactionId:(Lorg/apache/activemq/command/TransactionId;)V
      72: aload_0
      73: getfield      #13                 // Field outbound:Ljava/util/LinkedList;
      76: aload_3
      77: invokevirtual #113                // Method java/util/LinkedList.addFirst:(Ljava/lang/Object;)V
      80: goto          35
      83: aload_0
      84: getfield      #8                  // Field dispatchedInTx:Ljava/util/LinkedList;
      87: invokevirtual #145                // Method java/util/LinkedList.clear:()V
      90: aload_1
      91: monitorexit
      92: goto          102
      95: astore        4
      97: aload_1
      98: monitorexit
      99: aload         4
     101: athrow
     102: return
    Exception table:
       from    to  target type
           7    92    95   any
          95    99    95   any

  static org.apache.qpid.proton.engine.Sender access$800(org.apache.activemq.transport.amqp.AmqpProtocolConverter$ConsumerContext);
    Code:
       0: aload_0
       1: getfield      #2                  // Field sender:Lorg/apache/qpid/proton/engine/Sender;
       4: areturn

  static boolean access$902(org.apache.activemq.transport.amqp.AmqpProtocolConverter$ConsumerContext, boolean);
    Code:
       0: aload_0
       1: iload_1
       2: dup_x1
       3: putfield      #1                  // Field closed:Z
       6: ireturn
}
