Compiled from "NTLMEngineImpl.java"
class org.apache.hc.client5.http.impl.auth.NTLMEngineImpl$Handle {
  private final byte[] signingKey;

  private byte[] sealingKey;

  private final javax.crypto.Cipher rc4;

  final org.apache.hc.client5.http.impl.auth.NTLMEngineImpl$Mode mode;

  private final boolean isConnection;

  int sequenceNumber;

  org.apache.hc.client5.http.impl.auth.NTLMEngineImpl$Handle(byte[], org.apache.hc.client5.http.impl.auth.NTLMEngineImpl$Mode, boolean) throws org.apache.hc.client5.http.impl.auth.NTLMEngineException;
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iload_3
       6: putfield      #2                  // Field isConnection:Z
       9: aload_0
      10: aload_2
      11: putfield      #3                  // Field mode:Lorg/apache/hc/client5/http/impl/auth/NTLMEngineImpl$Mode;
      14: invokestatic  #4                  // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl.getMD5:()Ljava/security/MessageDigest;
      17: astore        4
      19: invokestatic  #4                  // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl.getMD5:()Ljava/security/MessageDigest;
      22: astore        5
      24: aload         4
      26: aload_1
      27: invokevirtual #5                  // Method java/security/MessageDigest.update:([B)V
      30: aload         5
      32: aload_1
      33: invokevirtual #5                  // Method java/security/MessageDigest.update:([B)V
      36: aload_2
      37: getstatic     #6                  // Field org/apache/hc/client5/http/impl/auth/NTLMEngineImpl$Mode.CLIENT:Lorg/apache/hc/client5/http/impl/auth/NTLMEngineImpl$Mode;
      40: if_acmpne     62
      43: aload         4
      45: invokestatic  #7                  // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl.access$1000:()[B
      48: invokevirtual #5                  // Method java/security/MessageDigest.update:([B)V
      51: aload         5
      53: invokestatic  #8                  // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl.access$1100:()[B
      56: invokevirtual #5                  // Method java/security/MessageDigest.update:([B)V
      59: goto          78
      62: aload         4
      64: invokestatic  #9                  // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl.access$1200:()[B
      67: invokevirtual #5                  // Method java/security/MessageDigest.update:([B)V
      70: aload         5
      72: invokestatic  #10                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl.access$1300:()[B
      75: invokevirtual #5                  // Method java/security/MessageDigest.update:([B)V
      78: aload_0
      79: aload         4
      81: invokevirtual #11                 // Method java/security/MessageDigest.digest:()[B
      84: putfield      #12                 // Field signingKey:[B
      87: aload_0
      88: aload         5
      90: invokevirtual #11                 // Method java/security/MessageDigest.digest:()[B
      93: putfield      #13                 // Field sealingKey:[B
      96: goto          116
      99: astore        4
     101: new           #15                 // class org/apache/hc/client5/http/impl/auth/NTLMEngineException
     104: dup
     105: aload         4
     107: invokevirtual #16                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     110: aload         4
     112: invokespecial #17                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     115: athrow
     116: aload_0
     117: aload_0
     118: invokespecial #18                 // Method initCipher:()Ljavax/crypto/Cipher;
     121: putfield      #19                 // Field rc4:Ljavax/crypto/Cipher;
     124: return
    Exception table:
       from    to  target type
          14    96    99   Class java/lang/Exception

  public byte[] getSigningKey();
    Code:
       0: aload_0
       1: getfield      #12                 // Field signingKey:[B
       4: areturn

  public byte[] getSealingKey();
    Code:
       0: aload_0
       1: getfield      #13                 // Field sealingKey:[B
       4: areturn

  private javax.crypto.Cipher initCipher() throws org.apache.hc.client5.http.impl.auth.NTLMEngineException;
    Code:
       0: ldc           #20                 // String RC4
       2: invokestatic  #21                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
       5: astore_1
       6: aload_0
       7: getfield      #3                  // Field mode:Lorg/apache/hc/client5/http/impl/auth/NTLMEngineImpl$Mode;
      10: getstatic     #6                  // Field org/apache/hc/client5/http/impl/auth/NTLMEngineImpl$Mode.CLIENT:Lorg/apache/hc/client5/http/impl/auth/NTLMEngineImpl$Mode;
      13: if_acmpne     37
      16: aload_1
      17: iconst_1
      18: new           #22                 // class javax/crypto/spec/SecretKeySpec
      21: dup
      22: aload_0
      23: getfield      #13                 // Field sealingKey:[B
      26: ldc           #20                 // String RC4
      28: invokespecial #23                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      31: invokevirtual #24                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;)V
      34: goto          55
      37: aload_1
      38: iconst_2
      39: new           #22                 // class javax/crypto/spec/SecretKeySpec
      42: dup
      43: aload_0
      44: getfield      #13                 // Field sealingKey:[B
      47: ldc           #20                 // String RC4
      49: invokespecial #23                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      52: invokevirtual #24                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;)V
      55: goto          72
      58: astore_2
      59: new           #15                 // class org/apache/hc/client5/http/impl/auth/NTLMEngineException
      62: dup
      63: aload_2
      64: invokevirtual #16                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
      67: aload_2
      68: invokespecial #17                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      71: athrow
      72: aload_1
      73: areturn
    Exception table:
       from    to  target type
           0    55    58   Class java/lang/Exception

  private void advanceMessageSequence() throws org.apache.hc.client5.http.impl.auth.NTLMEngineException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field isConnection:Z
       4: ifne          50
       7: invokestatic  #4                  // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl.getMD5:()Ljava/security/MessageDigest;
      10: astore_1
      11: aload_1
      12: aload_0
      13: getfield      #13                 // Field sealingKey:[B
      16: invokevirtual #5                  // Method java/security/MessageDigest.update:([B)V
      19: iconst_4
      20: newarray       byte
      22: astore_2
      23: aload_2
      24: aload_0
      25: getfield      #25                 // Field sequenceNumber:I
      28: iconst_0
      29: invokestatic  #26                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl.writeULong:([BII)V
      32: aload_1
      33: aload_2
      34: invokevirtual #5                  // Method java/security/MessageDigest.update:([B)V
      37: aload_0
      38: aload_1
      39: invokevirtual #11                 // Method java/security/MessageDigest.digest:()[B
      42: putfield      #13                 // Field sealingKey:[B
      45: aload_0
      46: invokespecial #18                 // Method initCipher:()Ljavax/crypto/Cipher;
      49: pop
      50: aload_0
      51: dup
      52: getfield      #25                 // Field sequenceNumber:I
      55: iconst_1
      56: iadd
      57: putfield      #25                 // Field sequenceNumber:I
      60: return

  private byte[] encrypt(byte[]);
    Code:
       0: aload_0
       1: getfield      #19                 // Field rc4:Ljavax/crypto/Cipher;
       4: aload_1
       5: invokevirtual #27                 // Method javax/crypto/Cipher.update:([B)[B
       8: areturn

  private byte[] decrypt(byte[]);
    Code:
       0: aload_0
       1: getfield      #19                 // Field rc4:Ljavax/crypto/Cipher;
       4: aload_1
       5: invokevirtual #27                 // Method javax/crypto/Cipher.update:([B)[B
       8: areturn

  private byte[] computeSignature(byte[]);
    Code:
       0: bipush        16
       2: newarray       byte
       4: astore_2
       5: aload_2
       6: iconst_0
       7: iconst_1
       8: bastore
       9: aload_2
      10: iconst_1
      11: iconst_0
      12: bastore
      13: aload_2
      14: iconst_2
      15: iconst_0
      16: bastore
      17: aload_2
      18: iconst_3
      19: iconst_0
      20: bastore
      21: new           #28                 // class org/apache/hc/client5/http/impl/auth/NTLMEngineImpl$HMACMD5
      24: dup
      25: aload_0
      26: getfield      #12                 // Field signingKey:[B
      29: invokespecial #29                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl$HMACMD5."<init>":([B)V
      32: astore_3
      33: aload_3
      34: aload_0
      35: getfield      #25                 // Field sequenceNumber:I
      38: invokestatic  #30                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl.access$1400:(I)[B
      41: invokevirtual #31                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl$HMACMD5.update:([B)V
      44: aload_3
      45: aload_1
      46: invokevirtual #31                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl$HMACMD5.update:([B)V
      49: aload_3
      50: invokevirtual #32                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl$HMACMD5.getOutput:()[B
      53: astore        4
      55: bipush        8
      57: newarray       byte
      59: astore        5
      61: aload         4
      63: iconst_0
      64: aload         5
      66: iconst_0
      67: bipush        8
      69: invokestatic  #33                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      72: aload_0
      73: aload         5
      75: invokespecial #34                 // Method encrypt:([B)[B
      78: astore        6
      80: aload         6
      82: iconst_0
      83: aload_2
      84: iconst_4
      85: bipush        8
      87: invokestatic  #33                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      90: aload_2
      91: bipush        12
      93: aload_0
      94: getfield      #25                 // Field sequenceNumber:I
      97: invokestatic  #35                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineImpl.access$1500:([BII)V
     100: aload_2
     101: areturn

  private boolean validateSignature(byte[], byte[]);
    Code:
       0: aload_0
       1: aload_2
       2: invokespecial #36                 // Method computeSignature:([B)[B
       5: astore_3
       6: aload_1
       7: aload_3
       8: invokestatic  #37                 // Method java/util/Arrays.equals:([B[B)Z
      11: ireturn

  public byte[] signAndEncryptMessage(byte[]) throws org.apache.hc.client5.http.impl.auth.NTLMEngineException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #34                 // Method encrypt:([B)[B
       5: astore_2
       6: aload_0
       7: aload_1
       8: invokespecial #36                 // Method computeSignature:([B)[B
      11: astore_3
      12: aload_3
      13: arraylength
      14: aload_2
      15: arraylength
      16: iadd
      17: newarray       byte
      19: astore        4
      21: aload_3
      22: iconst_0
      23: aload         4
      25: iconst_0
      26: aload_3
      27: arraylength
      28: invokestatic  #33                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      31: aload_2
      32: iconst_0
      33: aload         4
      35: aload_3
      36: arraylength
      37: aload_2
      38: arraylength
      39: invokestatic  #33                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      42: aload_0
      43: invokespecial #38                 // Method advanceMessageSequence:()V
      46: aload         4
      48: areturn

  public byte[] decryptAndVerifySignedMessage(byte[]) throws org.apache.hc.client5.http.impl.auth.NTLMEngineException;
    Code:
       0: bipush        16
       2: newarray       byte
       4: astore_2
       5: aload_1
       6: iconst_0
       7: aload_2
       8: iconst_0
       9: aload_2
      10: arraylength
      11: invokestatic  #33                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      14: aload_1
      15: arraylength
      16: bipush        16
      18: isub
      19: newarray       byte
      21: astore_3
      22: aload_1
      23: bipush        16
      25: aload_3
      26: iconst_0
      27: aload_3
      28: arraylength
      29: invokestatic  #33                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      32: aload_0
      33: aload_3
      34: invokespecial #39                 // Method decrypt:([B)[B
      37: astore        4
      39: aload_0
      40: aload_2
      41: aload         4
      43: invokespecial #40                 // Method validateSignature:([B[B)Z
      46: ifne          59
      49: new           #15                 // class org/apache/hc/client5/http/impl/auth/NTLMEngineException
      52: dup
      53: ldc           #41                 // String Wrong signature
      55: invokespecial #42                 // Method org/apache/hc/client5/http/impl/auth/NTLMEngineException."<init>":(Ljava/lang/String;)V
      58: athrow
      59: aload_0
      60: invokespecial #38                 // Method advanceMessageSequence:()V
      63: aload         4
      65: areturn
}
