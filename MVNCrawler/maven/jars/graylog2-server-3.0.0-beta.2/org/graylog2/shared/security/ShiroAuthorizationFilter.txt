Compiled from "ShiroAuthorizationFilter.java"
public class org.graylog2.shared.security.ShiroAuthorizationFilter implements javax.ws.rs.container.ContainerRequestFilter {
  private static final org.slf4j.Logger LOG;

  private final org.apache.shiro.authz.annotation.RequiresPermissions annotation;

  public org.graylog2.shared.security.ShiroAuthorizationFilter(org.apache.shiro.authz.annotation.RequiresPermissions);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field annotation:Lorg/apache/shiro/authz/annotation/RequiresPermissions;
       9: return

  public void filter(javax.ws.rs.container.ContainerRequestContext) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokeinterface #3,  1            // InterfaceMethod javax/ws/rs/container/ContainerRequestContext.getSecurityContext:()Ljavax/ws/rs/core/SecurityContext;
       6: astore_2
       7: aload_2
       8: instanceof    #4                  // class org/graylog2/shared/security/ShiroSecurityContext
      11: ifeq          137
      14: aload_2
      15: checkcast     #4                  // class org/graylog2/shared/security/ShiroSecurityContext
      18: astore_3
      19: aload_1
      20: invokestatic  #5                  // Method org/graylog2/rest/RestTools.getUserNameFromRequest:(Ljavax/ws/rs/container/ContainerRequestContext;)Ljava/lang/String;
      23: astore        4
      25: new           #6                  // class org/graylog2/shared/security/ContextAwarePermissionAnnotationHandler
      28: dup
      29: aload_3
      30: invokespecial #7                  // Method org/graylog2/shared/security/ContextAwarePermissionAnnotationHandler."<init>":(Lorg/graylog2/shared/security/ShiroSecurityContext;)V
      33: astore        5
      35: aload_0
      36: getfield      #2                  // Field annotation:Lorg/apache/shiro/authz/annotation/RequiresPermissions;
      39: invokeinterface #8,  1            // InterfaceMethod org/apache/shiro/authz/annotation/RequiresPermissions.value:()[Ljava/lang/String;
      44: astore        6
      46: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      49: ldc           #10                 // String Checking authorization for user [{}], needs permissions: {}
      51: aload         4
      53: aload         6
      55: invokeinterface #11,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      60: aload         5
      62: aload_0
      63: getfield      #2                  // Field annotation:Lorg/apache/shiro/authz/annotation/RequiresPermissions;
      66: invokevirtual #12                 // Method org/graylog2/shared/security/ContextAwarePermissionAnnotationHandler.assertAuthorized:(Ljava/lang/annotation/Annotation;)V
      69: goto          134
      72: astore        7
      74: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      77: ldc           #14                 // String Not authorized. User <{}> is missing permissions {} to perform <{} {}>
      79: iconst_4
      80: anewarray     #15                 // class java/lang/Object
      83: dup
      84: iconst_0
      85: aload         4
      87: aastore
      88: dup
      89: iconst_1
      90: aload         6
      92: invokestatic  #16                 // Method java/util/Arrays.toString:([Ljava/lang/Object;)Ljava/lang/String;
      95: aastore
      96: dup
      97: iconst_2
      98: aload_1
      99: invokeinterface #17,  1           // InterfaceMethod javax/ws/rs/container/ContainerRequestContext.getMethod:()Ljava/lang/String;
     104: aastore
     105: dup
     106: iconst_3
     107: aload_1
     108: invokeinterface #18,  1           // InterfaceMethod javax/ws/rs/container/ContainerRequestContext.getUriInfo:()Ljavax/ws/rs/core/UriInfo;
     113: invokeinterface #19,  1           // InterfaceMethod javax/ws/rs/core/UriInfo.getPath:()Ljava/lang/String;
     118: aastore
     119: invokeinterface #20,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;[Ljava/lang/Object;)V
     124: new           #21                 // class javax/ws/rs/ForbiddenException
     127: dup
     128: ldc           #22                 // String Not authorized
     130: invokespecial #23                 // Method javax/ws/rs/ForbiddenException."<init>":(Ljava/lang/String;)V
     133: athrow
     134: goto          145
     137: new           #21                 // class javax/ws/rs/ForbiddenException
     140: dup
     141: invokespecial #24                 // Method javax/ws/rs/ForbiddenException."<init>":()V
     144: athrow
     145: return
    Exception table:
       from    to  target type
          46    69    72   Class org/apache/shiro/authz/AuthorizationException

  static {};
    Code:
       0: ldc           #25                 // class org/graylog2/shared/security/ShiroAuthorizationFilter
       2: invokestatic  #26                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
       8: return
}
