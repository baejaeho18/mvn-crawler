Compiled from "ShiroSecurityContextFilter.java"
public class org.graylog2.shared.security.ShiroSecurityContextFilter implements javax.ws.rs.container.ContainerRequestFilter {
  public static final java.lang.String REQUEST_HEADERS;

  private final org.apache.shiro.mgt.DefaultSecurityManager securityManager;

  private javax.inject.Provider<org.glassfish.grizzly.http.server.Request> grizzlyRequestProvider;

  private final java.util.Set<org.graylog2.utilities.IpSubnet> trustedProxies;

  public org.graylog2.shared.security.ShiroSecurityContextFilter(org.apache.shiro.mgt.DefaultSecurityManager, javax.inject.Provider<org.glassfish.grizzly.http.server.Request>, java.util.Set<org.graylog2.utilities.IpSubnet>);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: invokestatic  #2                  // Method java/util/Objects.requireNonNull:(Ljava/lang/Object;)Ljava/lang/Object;
       9: checkcast     #3                  // class org/apache/shiro/mgt/DefaultSecurityManager
      12: putfield      #4                  // Field securityManager:Lorg/apache/shiro/mgt/DefaultSecurityManager;
      15: aload_0
      16: aload_2
      17: putfield      #5                  // Field grizzlyRequestProvider:Ljavax/inject/Provider;
      20: aload_0
      21: aload_3
      22: putfield      #6                  // Field trustedProxies:Ljava/util/Set;
      25: return

  public void filter(javax.ws.rs.container.ContainerRequestContext) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokeinterface #7,  1            // InterfaceMethod javax/ws/rs/container/ContainerRequestContext.getSecurityContext:()Ljavax/ws/rs/core/SecurityContext;
       6: invokeinterface #8,  1            // InterfaceMethod javax/ws/rs/core/SecurityContext.isSecure:()Z
      11: istore_2
      12: aload_1
      13: invokeinterface #9,  1            // InterfaceMethod javax/ws/rs/container/ContainerRequestContext.getHeaders:()Ljavax/ws/rs/core/MultivaluedMap;
      18: astore_3
      19: aload_0
      20: getfield      #5                  // Field grizzlyRequestProvider:Ljavax/inject/Provider;
      23: invokeinterface #10,  1           // InterfaceMethod javax/inject/Provider.get:()Ljava/lang/Object;
      28: checkcast     #11                 // class org/glassfish/grizzly/http/server/Request
      31: astore        4
      33: aload         4
      35: aload_0
      36: getfield      #6                  // Field trustedProxies:Ljava/util/Set;
      39: invokestatic  #12                 // Method org/graylog2/rest/RestTools.getRemoteAddrFromRequest:(Lorg/glassfish/grizzly/http/server/Request;Ljava/util/Set;)Ljava/lang/String;
      42: astore        5
      44: aload_3
      45: ldc           #14                 // String Authorization
      47: invokeinterface #15,  2           // InterfaceMethod javax/ws/rs/core/MultivaluedMap.getFirst:(Ljava/lang/Object;)Ljava/lang/Object;
      52: checkcast     #16                 // class java/lang/String
      55: astore        6
      57: ldc           #18                 // String REQUEST_HEADERS
      59: aload_3
      60: invokestatic  #19                 // Method org/apache/shiro/util/ThreadContext.put:(Ljava/lang/Object;Ljava/lang/Object;)V
      63: aload         6
      65: ifnull        157
      68: aload         6
      70: ldc           #20                 // String Basic
      72: invokevirtual #21                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      75: ifeq          157
      78: aload         6
      80: aload         6
      82: bipush        32
      84: invokevirtual #22                 // Method java/lang/String.indexOf:(I)I
      87: iconst_1
      88: iadd
      89: invokevirtual #23                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      92: astore        8
      94: aload_0
      95: aload         8
      97: invokespecial #24                 // Method decodeBase64:(Ljava/lang/String;)Ljava/lang/String;
     100: astore        9
     102: aload         9
     104: ldc           #25                 // String :
     106: iconst_2
     107: invokevirtual #26                 // Method java/lang/String.split:(Ljava/lang/String;I)[Ljava/lang/String;
     110: astore        10
     112: aload         10
     114: arraylength
     115: iconst_2
     116: if_icmpeq     129
     119: new           #27                 // class javax/ws/rs/BadRequestException
     122: dup
     123: ldc           #28                 // String Invalid credentials in Authorization header
     125: invokespecial #29                 // Method javax/ws/rs/BadRequestException."<init>":(Ljava/lang/String;)V
     128: athrow
     129: aload_0
     130: aload         10
     132: iconst_0
     133: aaload
     134: aload         10
     136: iconst_1
     137: aaload
     138: iload_2
     139: ldc           #31                 // String BASIC
     141: aload         5
     143: aload         4
     145: invokevirtual #32                 // Method org/glassfish/grizzly/http/server/Request.getRemoteAddr:()Ljava/lang/String;
     148: aload_3
     149: invokespecial #33                 // Method createSecurityContext:(Ljava/lang/String;Ljava/lang/String;ZLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljavax/ws/rs/core/MultivaluedMap;)Ljavax/ws/rs/core/SecurityContext;
     152: astore        7
     154: goto          175
     157: aload_0
     158: aconst_null
     159: aconst_null
     160: iload_2
     161: aconst_null
     162: aload         5
     164: aload         4
     166: invokevirtual #32                 // Method org/glassfish/grizzly/http/server/Request.getRemoteAddr:()Ljava/lang/String;
     169: aload_3
     170: invokespecial #33                 // Method createSecurityContext:(Ljava/lang/String;Ljava/lang/String;ZLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljavax/ws/rs/core/MultivaluedMap;)Ljavax/ws/rs/core/SecurityContext;
     173: astore        7
     175: aload_1
     176: aload         7
     178: invokeinterface #34,  2           // InterfaceMethod javax/ws/rs/container/ContainerRequestContext.setSecurityContext:(Ljavax/ws/rs/core/SecurityContext;)V
     183: return

  private java.lang.String decodeBase64(java.lang.String);
    Code:
       0: new           #16                 // class java/lang/String
       3: dup
       4: invokestatic  #35                 // Method java/util/Base64.getDecoder:()Ljava/util/Base64$Decoder;
       7: aload_1
       8: invokevirtual #36                 // Method java/util/Base64$Decoder.decode:(Ljava/lang/String;)[B
      11: getstatic     #37                 // Field java/nio/charset/StandardCharsets.US_ASCII:Ljava/nio/charset/Charset;
      14: invokespecial #38                 // Method java/lang/String."<init>":([BLjava/nio/charset/Charset;)V
      17: areturn
      18: astore_2
      19: ldc           #40                 // String
      21: areturn
    Exception table:
       from    to  target type
           0    17    18   Class java/lang/IllegalArgumentException

  private javax.ws.rs.core.SecurityContext createSecurityContext(java.lang.String, java.lang.String, boolean, java.lang.String, java.lang.String, java.lang.String, javax.ws.rs.core.MultivaluedMap<java.lang.String, java.lang.String>);
    Code:
       0: ldc           #41                 // String session
       2: aload_2
       3: invokevirtual #42                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
       6: ifeq          51
       9: ldc           #43                 // String undefined
      11: aload_1
      12: invokevirtual #42                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
      15: ifeq          36
      18: new           #44                 // class org/graylog2/shared/security/HttpHeadersToken
      21: dup
      22: aload         7
      24: aload         5
      26: aload         6
      28: invokespecial #45                 // Method org/graylog2/shared/security/HttpHeadersToken."<init>":(Ljavax/ws/rs/core/MultivaluedMap;Ljava/lang/String;Ljava/lang/String;)V
      31: astore        8
      33: goto          110
      36: new           #46                 // class org/graylog2/shared/security/SessionIdToken
      39: dup
      40: aload_1
      41: aload         5
      43: invokespecial #47                 // Method org/graylog2/shared/security/SessionIdToken."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      46: astore        8
      48: goto          110
      51: ldc           #48                 // String token
      53: aload_2
      54: invokevirtual #42                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
      57: ifeq          75
      60: new           #49                 // class org/graylog2/shared/security/AccessTokenAuthToken
      63: dup
      64: aload_1
      65: aload         5
      67: invokespecial #50                 // Method org/graylog2/shared/security/AccessTokenAuthToken."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      70: astore        8
      72: goto          110
      75: aload_1
      76: ifnonnull     97
      79: new           #44                 // class org/graylog2/shared/security/HttpHeadersToken
      82: dup
      83: aload         7
      85: aload         5
      87: aload         6
      89: invokespecial #45                 // Method org/graylog2/shared/security/HttpHeadersToken."<init>":(Ljavax/ws/rs/core/MultivaluedMap;Ljava/lang/String;Ljava/lang/String;)V
      92: astore        8
      94: goto          110
      97: new           #51                 // class org/apache/shiro/authc/UsernamePasswordToken
     100: dup
     101: aload_1
     102: aload_2
     103: aload         5
     105: invokespecial #52                 // Method org/apache/shiro/authc/UsernamePasswordToken."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
     108: astore        8
     110: new           #53                 // class org/apache/shiro/subject/Subject$Builder
     113: dup
     114: aload_0
     115: getfield      #4                  // Field securityManager:Lorg/apache/shiro/mgt/DefaultSecurityManager;
     118: invokespecial #54                 // Method org/apache/shiro/subject/Subject$Builder."<init>":(Lorg/apache/shiro/mgt/SecurityManager;)V
     121: aload         5
     123: invokevirtual #55                 // Method org/apache/shiro/subject/Subject$Builder.host:(Ljava/lang/String;)Lorg/apache/shiro/subject/Subject$Builder;
     126: iconst_1
     127: invokevirtual #56                 // Method org/apache/shiro/subject/Subject$Builder.sessionCreationEnabled:(Z)Lorg/apache/shiro/subject/Subject$Builder;
     130: invokevirtual #57                 // Method org/apache/shiro/subject/Subject$Builder.buildSubject:()Lorg/apache/shiro/subject/Subject;
     133: astore        9
     135: new           #58                 // class org/graylog2/shared/security/ShiroSecurityContext
     138: dup
     139: aload         9
     141: aload         8
     143: iload_3
     144: aload         4
     146: aload         7
     148: invokespecial #59                 // Method org/graylog2/shared/security/ShiroSecurityContext."<init>":(Lorg/apache/shiro/subject/Subject;Lorg/apache/shiro/authc/AuthenticationToken;ZLjava/lang/String;Ljavax/ws/rs/core/MultivaluedMap;)V
     151: areturn
}
