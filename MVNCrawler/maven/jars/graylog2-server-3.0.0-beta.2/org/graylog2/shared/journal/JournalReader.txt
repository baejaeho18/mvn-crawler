Compiled from "JournalReader.java"
public class org.graylog2.shared.journal.JournalReader extends com.google.common.util.concurrent.AbstractExecutionThreadService {
  private static final org.slf4j.Logger log;

  private final org.graylog2.shared.journal.Journal journal;

  private final org.graylog2.shared.buffers.ProcessBuffer processBuffer;

  private final java.util.concurrent.Semaphore journalFilled;

  private final com.codahale.metrics.MetricRegistry metricRegistry;

  private final com.google.common.eventbus.EventBus eventBus;

  private final com.codahale.metrics.Meter readMessages;

  private volatile boolean shouldBeReading;

  private com.codahale.metrics.Histogram requestedReadCount;

  private final com.codahale.metrics.Counter readBlocked;

  private java.lang.Thread executionThread;

  public org.graylog2.shared.journal.JournalReader(org.graylog2.shared.journal.Journal, org.graylog2.shared.buffers.ProcessBuffer, java.util.concurrent.Semaphore, com.codahale.metrics.MetricRegistry, com.google.common.eventbus.EventBus);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method com/google/common/util/concurrent/AbstractExecutionThreadService."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field journal:Lorg/graylog2/shared/journal/Journal;
       9: aload_0
      10: aload_2
      11: putfield      #3                  // Field processBuffer:Lorg/graylog2/shared/buffers/ProcessBuffer;
      14: aload_0
      15: aload_3
      16: putfield      #4                  // Field journalFilled:Ljava/util/concurrent/Semaphore;
      19: aload_0
      20: aload         4
      22: putfield      #5                  // Field metricRegistry:Lcom/codahale/metrics/MetricRegistry;
      25: aload_0
      26: aload         5
      28: putfield      #6                  // Field eventBus:Lcom/google/common/eventbus/EventBus;
      31: aload_0
      32: iconst_0
      33: putfield      #7                  // Field shouldBeReading:Z
      36: aload_0
      37: aload         4
      39: aload_0
      40: invokevirtual #8                  // Method java/lang/Object.getClass:()Ljava/lang/Class;
      43: iconst_1
      44: anewarray     #9                  // class java/lang/String
      47: dup
      48: iconst_0
      49: ldc           #10                 // String readBlocked
      51: aastore
      52: invokestatic  #11                 // Method com/codahale/metrics/MetricRegistry.name:(Ljava/lang/Class;[Ljava/lang/String;)Ljava/lang/String;
      55: invokevirtual #12                 // Method com/codahale/metrics/MetricRegistry.counter:(Ljava/lang/String;)Lcom/codahale/metrics/Counter;
      58: putfield      #13                 // Field readBlocked:Lcom/codahale/metrics/Counter;
      61: aload_0
      62: aload         4
      64: aload_0
      65: invokevirtual #8                  // Method java/lang/Object.getClass:()Ljava/lang/Class;
      68: iconst_1
      69: anewarray     #9                  // class java/lang/String
      72: dup
      73: iconst_0
      74: ldc           #14                 // String readMessages
      76: aastore
      77: invokestatic  #11                 // Method com/codahale/metrics/MetricRegistry.name:(Ljava/lang/Class;[Ljava/lang/String;)Ljava/lang/String;
      80: invokevirtual #15                 // Method com/codahale/metrics/MetricRegistry.meter:(Ljava/lang/String;)Lcom/codahale/metrics/Meter;
      83: putfield      #16                 // Field readMessages:Lcom/codahale/metrics/Meter;
      86: return

  protected void startUp() throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #6                  // Field eventBus:Lcom/google/common/eventbus/EventBus;
       4: aload_0
       5: invokevirtual #17                 // Method com/google/common/eventbus/EventBus.register:(Ljava/lang/Object;)V
       8: aload_0
       9: invokestatic  #18                 // Method java/lang/Thread.currentThread:()Ljava/lang/Thread;
      12: putfield      #19                 // Field executionThread:Ljava/lang/Thread;
      15: return

  protected void shutDown() throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #6                  // Field eventBus:Lcom/google/common/eventbus/EventBus;
       4: aload_0
       5: invokevirtual #20                 // Method com/google/common/eventbus/EventBus.unregister:(Ljava/lang/Object;)V
       8: return

  protected void triggerShutdown();
    Code:
       0: aload_0
       1: getfield      #19                 // Field executionThread:Ljava/lang/Thread;
       4: invokevirtual #21                 // Method java/lang/Thread.interrupt:()V
       7: return

  public void listenForLifecycleChanges(org.graylog2.plugin.lifecycles.Lifecycle);
    Code:
       0: getstatic     #22                 // Field org/graylog2/shared/journal/JournalReader$1.$SwitchMap$org$graylog2$plugin$lifecycles$Lifecycle:[I
       3: aload_1
       4: invokevirtual #23                 // Method org/graylog2/plugin/lifecycles/Lifecycle.ordinal:()I
       7: iaload
       8: tableswitch   { // 1 to 10
                     1: 64
                     2: 72
                     3: 80
                     4: 88
                     5: 96
                     6: 104
                     7: 112
                     8: 119
                     9: 119
                    10: 119
               default: 119
          }
      64: aload_0
      65: iconst_0
      66: putfield      #7                  // Field shouldBeReading:Z
      69: goto          119
      72: aload_0
      73: iconst_0
      74: putfield      #7                  // Field shouldBeReading:Z
      77: goto          119
      80: aload_0
      81: iconst_1
      82: putfield      #7                  // Field shouldBeReading:Z
      85: goto          119
      88: aload_0
      89: iconst_1
      90: putfield      #7                  // Field shouldBeReading:Z
      93: goto          119
      96: aload_0
      97: iconst_0
      98: putfield      #7                  // Field shouldBeReading:Z
     101: goto          119
     104: aload_0
     105: iconst_0
     106: putfield      #7                  // Field shouldBeReading:Z
     109: goto          119
     112: aload_0
     113: invokevirtual #24                 // Method triggerShutdown:()V
     116: goto          119
     119: return

  protected void run() throws java.lang.Exception;
    Code:
       0: aload_0
       1: aload_0
       2: getfield      #5                  // Field metricRegistry:Lcom/codahale/metrics/MetricRegistry;
       5: aload_0
       6: invokevirtual #8                  // Method java/lang/Object.getClass:()Ljava/lang/Class;
       9: iconst_1
      10: anewarray     #9                  // class java/lang/String
      13: dup
      14: iconst_0
      15: ldc           #25                 // String requestedReadCount
      17: aastore
      18: invokestatic  #11                 // Method com/codahale/metrics/MetricRegistry.name:(Ljava/lang/Class;[Ljava/lang/String;)Ljava/lang/String;
      21: new           #26                 // class org/graylog2/shared/metrics/HdrHistogram
      24: dup
      25: aload_0
      26: getfield      #3                  // Field processBuffer:Lorg/graylog2/shared/buffers/ProcessBuffer;
      29: invokevirtual #27                 // Method org/graylog2/shared/buffers/ProcessBuffer.getRingBufferSize:()I
      32: iconst_1
      33: iadd
      34: i2l
      35: iconst_3
      36: invokespecial #28                 // Method org/graylog2/shared/metrics/HdrHistogram."<init>":(JI)V
      39: invokevirtual #29                 // Method com/codahale/metrics/MetricRegistry.register:(Ljava/lang/String;Lcom/codahale/metrics/Metric;)Lcom/codahale/metrics/Metric;
      42: checkcast     #30                 // class com/codahale/metrics/Histogram
      45: putfield      #31                 // Field requestedReadCount:Lcom/codahale/metrics/Histogram;
      48: goto          65
      51: astore_1
      52: getstatic     #33                 // Field log:Lorg/slf4j/Logger;
      55: ldc           #34                 // String Metric already exists
      57: aload_1
      58: invokeinterface #35,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
      63: aload_1
      64: athrow
      65: aload_0
      66: invokevirtual #36                 // Method isRunning:()Z
      69: ifeq          305
      72: aload_0
      73: getfield      #7                  // Field shouldBeReading:Z
      76: ifne          91
      79: ldc2_w        #37                 // long 100l
      82: getstatic     #39                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
      85: invokestatic  #40                 // Method com/google/common/util/concurrent/Uninterruptibles.sleepUninterruptibly:(JLjava/util/concurrent/TimeUnit;)V
      88: goto          65
      91: aload_0
      92: getfield      #3                  // Field processBuffer:Lorg/graylog2/shared/buffers/ProcessBuffer;
      95: invokevirtual #41                 // Method org/graylog2/shared/buffers/ProcessBuffer.getRemainingCapacity:()J
      98: lstore_1
      99: aload_0
     100: getfield      #31                 // Field requestedReadCount:Lcom/codahale/metrics/Histogram;
     103: lload_1
     104: invokevirtual #42                 // Method com/codahale/metrics/Histogram.update:(J)V
     107: aload_0
     108: getfield      #2                  // Field journal:Lorg/graylog2/shared/journal/Journal;
     111: lload_1
     112: invokeinterface #43,  3           // InterfaceMethod org/graylog2/shared/journal/Journal.read:(J)Ljava/util/List;
     117: astore_3
     118: aload_3
     119: invokeinterface #44,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     124: ifeq          180
     127: getstatic     #33                 // Field log:Lorg/slf4j/Logger;
     130: ldc           #45                 // String No messages to read from Journal, waiting until the writer adds more messages.
     132: invokeinterface #46,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     137: aload_0
     138: getfield      #13                 // Field readBlocked:Lcom/codahale/metrics/Counter;
     141: invokevirtual #47                 // Method com/codahale/metrics/Counter.inc:()V
     144: aload_0
     145: getfield      #4                  // Field journalFilled:Ljava/util/concurrent/Semaphore;
     148: invokevirtual #48                 // Method java/util/concurrent/Semaphore.acquire:()V
     151: goto          159
     154: astore        4
     156: goto          65
     159: getstatic     #33                 // Field log:Lorg/slf4j/Logger;
     162: ldc           #50                 // String Messages have been written to Journal, continuing to read.
     164: invokeinterface #46,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     169: aload_0
     170: getfield      #4                  // Field journalFilled:Ljava/util/concurrent/Semaphore;
     173: invokevirtual #51                 // Method java/util/concurrent/Semaphore.drainPermits:()I
     176: pop
     177: goto          302
     180: aload_0
     181: getfield      #16                 // Field readMessages:Lcom/codahale/metrics/Meter;
     184: aload_3
     185: invokeinterface #52,  1           // InterfaceMethod java/util/List.size:()I
     190: i2l
     191: invokevirtual #53                 // Method com/codahale/metrics/Meter.mark:(J)V
     194: getstatic     #33                 // Field log:Lorg/slf4j/Logger;
     197: ldc           #54                 // String Processing {} messages from journal.
     199: aload_3
     200: invokeinterface #52,  1           // InterfaceMethod java/util/List.size:()I
     205: invokestatic  #55                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
     208: invokeinterface #56,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
     213: aload_3
     214: invokeinterface #57,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     219: astore        4
     221: aload         4
     223: invokeinterface #58,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     228: ifeq          302
     231: aload         4
     233: invokeinterface #59,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     238: checkcast     #60                 // class org/graylog2/shared/journal/Journal$JournalReadEntry
     241: astore        5
     243: aload         5
     245: invokevirtual #61                 // Method org/graylog2/shared/journal/Journal$JournalReadEntry.getPayload:()[B
     248: aload         5
     250: invokevirtual #62                 // Method org/graylog2/shared/journal/Journal$JournalReadEntry.getOffset:()J
     253: invokestatic  #63                 // Method org/graylog2/plugin/journal/RawMessage.decode:([BJ)Lorg/graylog2/plugin/journal/RawMessage;
     256: astore        6
     258: aload         6
     260: ifnonnull     290
     263: getstatic     #33                 // Field log:Lorg/slf4j/Logger;
     266: ldc           #64                 // String Found null raw message!
     268: invokeinterface #65,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     273: aload_0
     274: getfield      #2                  // Field journal:Lorg/graylog2/shared/journal/Journal;
     277: aload         5
     279: invokevirtual #62                 // Method org/graylog2/shared/journal/Journal$JournalReadEntry.getOffset:()J
     282: invokeinterface #66,  3           // InterfaceMethod org/graylog2/shared/journal/Journal.markJournalOffsetCommitted:(J)V
     287: goto          221
     290: aload_0
     291: getfield      #3                  // Field processBuffer:Lorg/graylog2/shared/buffers/ProcessBuffer;
     294: aload         6
     296: invokevirtual #67                 // Method org/graylog2/shared/buffers/ProcessBuffer.insertBlocking:(Lorg/graylog2/plugin/journal/RawMessage;)V
     299: goto          221
     302: goto          65
     305: getstatic     #33                 // Field log:Lorg/slf4j/Logger;
     308: ldc           #68                 // String Stopping.
     310: invokeinterface #69,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     315: return
    Exception table:
       from    to  target type
           0    48    51   Class java/lang/IllegalArgumentException
         137   151   154   Class java/lang/InterruptedException

  static {};
    Code:
       0: ldc           #70                 // class org/graylog2/shared/journal/JournalReader
       2: invokestatic  #71                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #33                 // Field log:Lorg/slf4j/Logger;
       8: return
}
