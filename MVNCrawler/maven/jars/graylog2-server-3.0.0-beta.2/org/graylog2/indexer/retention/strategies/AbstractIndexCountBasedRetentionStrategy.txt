Compiled from "AbstractIndexCountBasedRetentionStrategy.java"
public abstract class org.graylog2.indexer.retention.strategies.AbstractIndexCountBasedRetentionStrategy implements org.graylog2.plugin.indexer.retention.RetentionStrategy {
  private static final org.slf4j.Logger LOG;

  private final org.graylog2.indexer.indices.Indices indices;

  private final org.graylog2.shared.system.activities.ActivityWriter activityWriter;

  public org.graylog2.indexer.retention.strategies.AbstractIndexCountBasedRetentionStrategy(org.graylog2.indexer.indices.Indices, org.graylog2.shared.system.activities.ActivityWriter);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: invokestatic  #2                  // Method java/util/Objects.requireNonNull:(Ljava/lang/Object;)Ljava/lang/Object;
       9: checkcast     #3                  // class org/graylog2/indexer/indices/Indices
      12: putfield      #4                  // Field indices:Lorg/graylog2/indexer/indices/Indices;
      15: aload_0
      16: aload_2
      17: invokestatic  #2                  // Method java/util/Objects.requireNonNull:(Ljava/lang/Object;)Ljava/lang/Object;
      20: checkcast     #5                  // class org/graylog2/shared/system/activities/ActivityWriter
      23: putfield      #6                  // Field activityWriter:Lorg/graylog2/shared/system/activities/ActivityWriter;
      26: return

  protected abstract java.util.Optional<java.lang.Integer> getMaxNumberOfIndices(org.graylog2.indexer.IndexSet);

  protected abstract void retain(java.lang.String, org.graylog2.indexer.IndexSet);

  public void retain(org.graylog2.indexer.IndexSet);
    Code:
       0: aload_1
       1: invokeinterface #7,  1            // InterfaceMethod org/graylog2/indexer/IndexSet.getAllIndexAliases:()Ljava/util/Map;
       6: astore_2
       7: aload_2
       8: invokeinterface #8,  1            // InterfaceMethod java/util/Map.keySet:()Ljava/util/Set;
      13: invokeinterface #9,  1            // InterfaceMethod java/util/Set.stream:()Ljava/util/stream/Stream;
      18: aload_0
      19: invokedynamic #10,  0             // InvokeDynamic #0:test:(Lorg/graylog2/indexer/retention/strategies/AbstractIndexCountBasedRetentionStrategy;)Ljava/util/function/Predicate;
      24: invokeinterface #11,  2           // InterfaceMethod java/util/stream/Stream.filter:(Ljava/util/function/Predicate;)Ljava/util/stream/Stream;
      29: invokeinterface #12,  1           // InterfaceMethod java/util/stream/Stream.count:()J
      34: l2i
      35: istore_3
      36: aload_0
      37: aload_1
      38: invokevirtual #13                 // Method getMaxNumberOfIndices:(Lorg/graylog2/indexer/IndexSet;)Ljava/util/Optional;
      41: astore        4
      43: aload         4
      45: invokevirtual #14                 // Method java/util/Optional.isPresent:()Z
      48: ifne          62
      51: getstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
      54: ldc           #16                 // String No retention strategy configuration found, not running index retention!
      56: invokeinterface #17,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      61: return
      62: iload_3
      63: aload         4
      65: invokevirtual #18                 // Method java/util/Optional.get:()Ljava/lang/Object;
      68: checkcast     #19                 // class java/lang/Integer
      71: invokevirtual #20                 // Method java/lang/Integer.intValue:()I
      74: if_icmpgt     97
      77: getstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
      80: ldc           #21                 // String Number of indices ({}) lower than limit ({}). Not performing any retention actions.
      82: iload_3
      83: invokestatic  #22                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      86: aload         4
      88: invokevirtual #18                 // Method java/util/Optional.get:()Ljava/lang/Object;
      91: invokeinterface #23,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      96: return
      97: iload_3
      98: aload         4
     100: invokevirtual #18                 // Method java/util/Optional.get:()Ljava/lang/Object;
     103: checkcast     #19                 // class java/lang/Integer
     106: invokevirtual #20                 // Method java/lang/Integer.intValue:()I
     109: isub
     110: istore        5
     112: new           #24                 // class java/lang/StringBuilder
     115: dup
     116: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
     119: ldc           #26                 // String Number of indices (
     121: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     124: iload_3
     125: invokevirtual #28                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     128: ldc           #29                 // String ) higher than limit (
     130: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     133: aload         4
     135: invokevirtual #18                 // Method java/util/Optional.get:()Ljava/lang/Object;
     138: invokevirtual #30                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     141: ldc           #31                 // String ). Running retention for
     143: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     146: iload         5
     148: invokevirtual #28                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     151: ldc           #32                 // String  indices.
     153: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     156: invokevirtual #33                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     159: astore        6
     161: getstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
     164: aload         6
     166: invokeinterface #34,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     171: aload_0
     172: getfield      #6                  // Field activityWriter:Lorg/graylog2/shared/system/activities/ActivityWriter;
     175: new           #35                 // class org/graylog2/shared/system/activities/Activity
     178: dup
     179: aload         6
     181: ldc           #36                 // class org/graylog2/periodical/IndexRetentionThread
     183: invokespecial #37                 // Method org/graylog2/shared/system/activities/Activity."<init>":(Ljava/lang/String;Ljava/lang/Class;)V
     186: invokeinterface #38,  2           // InterfaceMethod org/graylog2/shared/system/activities/ActivityWriter.write:(Lorg/graylog2/shared/system/activities/Activity;)V
     191: aload_0
     192: aload_1
     193: aload_2
     194: iload         5
     196: invokespecial #39                 // Method runRetention:(Lorg/graylog2/indexer/IndexSet;Ljava/util/Map;I)V
     199: return

  private void runRetention(org.graylog2.indexer.IndexSet, java.util.Map<java.lang.String, java.util.Set<java.lang.String>>, int);
    Code:
       0: aload_1
       1: invokeinterface #40,  1           // InterfaceMethod org/graylog2/indexer/IndexSet.getManagedIndices:()[Ljava/lang/String;
       6: invokestatic  #41                 // Method java/util/Arrays.stream:([Ljava/lang/Object;)Ljava/util/stream/Stream;
       9: aload_0
      10: invokedynamic #42,  0             // InvokeDynamic #1:test:(Lorg/graylog2/indexer/retention/strategies/AbstractIndexCountBasedRetentionStrategy;)Ljava/util/function/Predicate;
      15: invokeinterface #11,  2           // InterfaceMethod java/util/stream/Stream.filter:(Ljava/util/function/Predicate;)Ljava/util/stream/Stream;
      20: aload_2
      21: aload_1
      22: invokedynamic #43,  0             // InvokeDynamic #2:test:(Ljava/util/Map;Lorg/graylog2/indexer/IndexSet;)Ljava/util/function/Predicate;
      27: invokeinterface #11,  2           // InterfaceMethod java/util/stream/Stream.filter:(Ljava/util/function/Predicate;)Ljava/util/stream/Stream;
      32: aload_1
      33: invokedynamic #44,  0             // InvokeDynamic #3:compare:(Lorg/graylog2/indexer/IndexSet;)Ljava/util/Comparator;
      38: invokeinterface #45,  2           // InterfaceMethod java/util/stream/Stream.sorted:(Ljava/util/Comparator;)Ljava/util/stream/Stream;
      43: invokedynamic #46,  0             // InvokeDynamic #4:get:()Ljava/util/function/Supplier;
      48: invokestatic  #47                 // Method java/util/stream/Collectors.toCollection:(Ljava/util/function/Supplier;)Ljava/util/stream/Collector;
      51: invokeinterface #48,  2           // InterfaceMethod java/util/stream/Stream.collect:(Ljava/util/stream/Collector;)Ljava/lang/Object;
      56: checkcast     #49                 // class java/util/Set
      59: astore        4
      61: aload         4
      63: invokeinterface #9,  1            // InterfaceMethod java/util/Set.stream:()Ljava/util/stream/Stream;
      68: aload         4
      70: invokeinterface #50,  1           // InterfaceMethod java/util/Set.size:()I
      75: iload_3
      76: isub
      77: i2l
      78: invokeinterface #51,  3           // InterfaceMethod java/util/stream/Stream.skip:(J)Ljava/util/stream/Stream;
      83: aload_0
      84: aload_1
      85: invokedynamic #52,  0             // InvokeDynamic #5:accept:(Lorg/graylog2/indexer/retention/strategies/AbstractIndexCountBasedRetentionStrategy;Lorg/graylog2/indexer/IndexSet;)Ljava/util/function/Consumer;
      90: invokeinterface #53,  2           // InterfaceMethod java/util/stream/Stream.forEach:(Ljava/util/function/Consumer;)V
      95: return

  private void lambda$runRetention$4(org.graylog2.indexer.IndexSet, java.lang.String);
    Code:
       0: aload_0
       1: invokevirtual #54                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
       4: invokevirtual #55                 // Method java/lang/Class.getCanonicalName:()Ljava/lang/String;
       7: astore_3
       8: new           #24                 // class java/lang/StringBuilder
      11: dup
      12: invokespecial #25                 // Method java/lang/StringBuilder."<init>":()V
      15: ldc           #56                 // String Running retention strategy [
      17: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      20: aload_3
      21: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      24: ldc           #57                 // String ] for index <
      26: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      29: aload_2
      30: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      33: ldc           #58                 // String >
      35: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      38: invokevirtual #33                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      41: astore        4
      43: getstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
      46: aload         4
      48: invokeinterface #34,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      53: aload_0
      54: getfield      #6                  // Field activityWriter:Lorg/graylog2/shared/system/activities/ActivityWriter;
      57: new           #35                 // class org/graylog2/shared/system/activities/Activity
      60: dup
      61: aload         4
      63: ldc           #36                 // class org/graylog2/periodical/IndexRetentionThread
      65: invokespecial #37                 // Method org/graylog2/shared/system/activities/Activity."<init>":(Ljava/lang/String;Ljava/lang/Class;)V
      68: invokeinterface #38,  2           // InterfaceMethod org/graylog2/shared/system/activities/ActivityWriter.write:(Lorg/graylog2/shared/system/activities/Activity;)V
      73: aload_0
      74: aload_2
      75: aload_1
      76: invokevirtual #59                 // Method retain:(Ljava/lang/String;Lorg/graylog2/indexer/IndexSet;)V
      79: return

  private static int lambda$runRetention$3(org.graylog2.indexer.IndexSet, java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_2
       2: invokeinterface #60,  2           // InterfaceMethod org/graylog2/indexer/IndexSet.extractIndexNumber:(Ljava/lang/String;)Ljava/util/Optional;
       7: iconst_0
       8: invokestatic  #22                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      11: invokevirtual #61                 // Method java/util/Optional.orElse:(Ljava/lang/Object;)Ljava/lang/Object;
      14: checkcast     #19                 // class java/lang/Integer
      17: aload_0
      18: aload_1
      19: invokeinterface #60,  2           // InterfaceMethod org/graylog2/indexer/IndexSet.extractIndexNumber:(Ljava/lang/String;)Ljava/util/Optional;
      24: iconst_0
      25: invokestatic  #22                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      28: invokevirtual #61                 // Method java/util/Optional.orElse:(Ljava/lang/Object;)Ljava/lang/Object;
      31: checkcast     #19                 // class java/lang/Integer
      34: invokevirtual #62                 // Method java/lang/Integer.compareTo:(Ljava/lang/Integer;)I
      37: ireturn

  private static boolean lambda$runRetention$2(java.util.Map, org.graylog2.indexer.IndexSet, java.lang.String);
    Code:
       0: aload_0
       1: aload_2
       2: invokestatic  #63                 // Method java/util/Collections.emptySet:()Ljava/util/Set;
       5: invokeinterface #64,  3           // InterfaceMethod java/util/Map.getOrDefault:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      10: checkcast     #49                 // class java/util/Set
      13: aload_1
      14: invokeinterface #65,  1           // InterfaceMethod org/graylog2/indexer/IndexSet.getWriteIndexAlias:()Ljava/lang/String;
      19: invokeinterface #66,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      24: ifne          31
      27: iconst_1
      28: goto          32
      31: iconst_0
      32: ireturn

  private boolean lambda$runRetention$1(java.lang.String);
    Code:
       0: aload_0
       1: getfield      #4                  // Field indices:Lorg/graylog2/indexer/indices/Indices;
       4: aload_1
       5: invokevirtual #67                 // Method org/graylog2/indexer/indices/Indices.isReopened:(Ljava/lang/String;)Z
       8: ifne          15
      11: iconst_1
      12: goto          16
      15: iconst_0
      16: ireturn

  private boolean lambda$retain$0(java.lang.String);
    Code:
       0: aload_0
       1: getfield      #4                  // Field indices:Lorg/graylog2/indexer/indices/Indices;
       4: aload_1
       5: invokevirtual #67                 // Method org/graylog2/indexer/indices/Indices.isReopened:(Ljava/lang/String;)Z
       8: ifne          15
      11: iconst_1
      12: goto          16
      15: iconst_0
      16: ireturn

  static {};
    Code:
       0: ldc           #68                 // class org/graylog2/indexer/retention/strategies/AbstractIndexCountBasedRetentionStrategy
       2: invokestatic  #69                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
       8: return
}
