Compiled from "LdapResource.java"
public class org.graylog2.rest.resources.system.ldap.LdapResource extends org.graylog2.shared.rest.resources.RestResource {
  private static final org.slf4j.Logger LOG;

  private org.graylog2.security.ldap.LdapSettingsService ldapSettingsService;

  private org.graylog2.security.ldap.LdapSettingsImpl$Factory ldapSettingsFactory;

  private org.graylog2.security.ldap.LdapConnector ldapConnector;

  public org.graylog2.rest.resources.system.ldap.LdapResource();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/graylog2/shared/rest/resources/RestResource."<init>":()V
       4: return

  public org.graylog2.rest.models.system.ldap.responses.LdapSettingsResponse getLdapSettings();
    Code:
       0: aload_0
       1: getfield      #2                  // Field ldapSettingsService:Lorg/graylog2/security/ldap/LdapSettingsService;
       4: invokeinterface #3,  1            // InterfaceMethod org/graylog2/security/ldap/LdapSettingsService.load:()Lorg/graylog2/shared/security/ldap/LdapSettings;
       9: astore_1
      10: aload_1
      11: ifnonnull     18
      14: invokestatic  #4                  // Method org/graylog2/rest/models/system/ldap/responses/LdapSettingsResponse.emptyDisabled:()Lorg/graylog2/rest/models/system/ldap/responses/LdapSettingsResponse;
      17: areturn
      18: aload_1
      19: invokeinterface #5,  1            // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.isEnabled:()Z
      24: aload_1
      25: invokeinterface #6,  1            // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getSystemUserName:()Ljava/lang/String;
      30: aload_1
      31: invokeinterface #7,  1            // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.isSystemPasswordSet:()Z
      36: aload_1
      37: invokeinterface #8,  1            // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getUri:()Ljava/net/URI;
      42: aload_1
      43: invokeinterface #9,  1            // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.isUseStartTls:()Z
      48: aload_1
      49: invokeinterface #10,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.isTrustAllCertificates:()Z
      54: aload_1
      55: invokeinterface #11,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.isActiveDirectory:()Z
      60: aload_1
      61: invokeinterface #12,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getSearchBase:()Ljava/lang/String;
      66: aload_1
      67: invokeinterface #13,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getSearchPattern:()Ljava/lang/String;
      72: aload_1
      73: invokeinterface #14,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getDisplayNameAttribute:()Ljava/lang/String;
      78: aload_1
      79: invokeinterface #15,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getDefaultGroup:()Ljava/lang/String;
      84: aload_1
      85: invokeinterface #16,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getGroupMapping:()Ljava/util/Map;
      90: aload_1
      91: invokeinterface #17,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getGroupSearchBase:()Ljava/lang/String;
      96: aload_1
      97: invokeinterface #18,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getGroupIdAttribute:()Ljava/lang/String;
     102: aload_1
     103: invokeinterface #19,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getAdditionalDefaultGroups:()Ljava/util/Set;
     108: aload_1
     109: invokeinterface #20,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getGroupSearchPattern:()Ljava/lang/String;
     114: invokestatic  #21                 // Method org/graylog2/rest/models/system/ldap/responses/LdapSettingsResponse.create:(ZLjava/lang/String;ZLjava/net/URI;ZZZLjava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/util/Map;Ljava/lang/String;Ljava/lang/String;Ljava/util/Set;Ljava/lang/String;)Lorg/graylog2/rest/models/system/ldap/responses/LdapSettingsResponse;
     117: areturn

  public org.graylog2.rest.models.system.ldap.responses.LdapTestConfigResponse testLdapConfiguration(org.graylog2.rest.models.system.ldap.requests.LdapTestConfigRequest);
    Code:
       0: new           #22                 // class org/apache/directory/ldap/client/api/LdapConnectionConfig
       3: dup
       4: invokespecial #23                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig."<init>":()V
       7: astore_2
       8: aload_1
       9: invokevirtual #24                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.ldapUri:()Ljava/net/URI;
      12: astore_3
      13: aload_2
      14: aload_3
      15: invokevirtual #25                 // Method java/net/URI.getHost:()Ljava/lang/String;
      18: invokevirtual #26                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setLdapHost:(Ljava/lang/String;)V
      21: aload_2
      22: aload_3
      23: invokevirtual #27                 // Method java/net/URI.getPort:()I
      26: invokevirtual #28                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setLdapPort:(I)V
      29: aload_2
      30: aload_3
      31: invokevirtual #29                 // Method java/net/URI.getScheme:()Ljava/lang/String;
      34: ldc           #30                 // String ldaps
      36: invokevirtual #31                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      39: invokevirtual #32                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setUseSsl:(Z)V
      42: aload_2
      43: aload_1
      44: invokevirtual #33                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.useStartTls:()Z
      47: invokevirtual #34                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setUseTls:(Z)V
      50: aload_1
      51: invokevirtual #35                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.trustAllCertificates:()Z
      54: ifeq          75
      57: aload_2
      58: iconst_1
      59: anewarray     #36                 // class javax/net/ssl/TrustManager
      62: dup
      63: iconst_0
      64: new           #37                 // class org/graylog2/security/TrustAllX509TrustManager
      67: dup
      68: invokespecial #38                 // Method org/graylog2/security/TrustAllX509TrustManager."<init>":()V
      71: aastore
      72: invokevirtual #39                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setTrustManagers:([Ljavax/net/ssl/TrustManager;)V
      75: aload_1
      76: invokevirtual #40                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.systemUsername:()Ljava/lang/String;
      79: invokestatic  #41                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      82: ifne          154
      85: aload_2
      86: aload_1
      87: invokevirtual #40                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.systemUsername:()Ljava/lang/String;
      90: invokevirtual #42                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setName:(Ljava/lang/String;)V
      93: aload_1
      94: invokevirtual #43                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.systemPassword:()Ljava/lang/String;
      97: invokestatic  #41                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     100: ifne          114
     103: aload_2
     104: aload_1
     105: invokevirtual #43                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.systemPassword:()Ljava/lang/String;
     108: invokevirtual #44                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setCredentials:(Ljava/lang/String;)V
     111: goto          154
     114: aload_0
     115: getfield      #2                  // Field ldapSettingsService:Lorg/graylog2/security/ldap/LdapSettingsService;
     118: invokeinterface #3,  1            // InterfaceMethod org/graylog2/security/ldap/LdapSettingsService.load:()Lorg/graylog2/shared/security/ldap/LdapSettings;
     123: astore        4
     125: aload         4
     127: ifnull        154
     130: aload         4
     132: invokeinterface #45,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getSystemPassword:()Ljava/lang/String;
     137: invokestatic  #41                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     140: ifne          154
     143: aload_2
     144: aload         4
     146: invokeinterface #45,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getSystemPassword:()Ljava/lang/String;
     151: invokevirtual #44                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setCredentials:(Ljava/lang/String;)V
     154: aconst_null
     155: astore        4
     157: aload_0
     158: getfield      #46                 // Field ldapConnector:Lorg/graylog2/security/ldap/LdapConnector;
     161: aload_2
     162: invokevirtual #47                 // Method org/graylog2/security/ldap/LdapConnector.connect:(Lorg/apache/directory/ldap/client/api/LdapConnectionConfig;)Lorg/apache/directory/ldap/client/api/LdapNetworkConnection;
     165: astore        4
     167: goto          221
     170: astore        5
     172: iconst_0
     173: iconst_0
     174: iconst_0
     175: invokestatic  #49                 // Method java/util/Collections.emptyMap:()Ljava/util/Map;
     178: invokestatic  #50                 // Method java/util/Collections.emptySet:()Ljava/util/Set;
     181: aload         5
     183: invokevirtual #51                 // Method org/apache/directory/api/ldap/model/exception/LdapException.getMessage:()Ljava/lang/String;
     186: invokestatic  #52                 // Method org/graylog2/rest/models/system/ldap/responses/LdapTestConfigResponse.create:(ZZZLjava/util/Map;Ljava/util/Set;Ljava/lang/String;)Lorg/graylog2/rest/models/system/ldap/responses/LdapTestConfigResponse;
     189: astore        6
     191: aload         4
     193: ifnull        218
     196: aload         4
     198: invokevirtual #53                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.close:()V
     201: goto          218
     204: astore        7
     206: getstatic     #55                 // Field LOG:Lorg/slf4j/Logger;
     209: ldc           #56                 // String Unable to close LDAP connection.
     211: aload         7
     213: invokeinterface #57,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     218: aload         6
     220: areturn
     221: aconst_null
     222: aload         4
     224: if_acmpne     273
     227: iconst_0
     228: iconst_0
     229: iconst_0
     230: invokestatic  #49                 // Method java/util/Collections.emptyMap:()Ljava/util/Map;
     233: invokestatic  #50                 // Method java/util/Collections.emptySet:()Ljava/util/Set;
     236: ldc           #58                 // String Could not connect to LDAP server
     238: invokestatic  #52                 // Method org/graylog2/rest/models/system/ldap/responses/LdapTestConfigResponse.create:(ZZZLjava/util/Map;Ljava/util/Set;Ljava/lang/String;)Lorg/graylog2/rest/models/system/ldap/responses/LdapTestConfigResponse;
     241: astore        5
     243: aload         4
     245: ifnull        270
     248: aload         4
     250: invokevirtual #53                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.close:()V
     253: goto          270
     256: astore        6
     258: getstatic     #55                 // Field LOG:Lorg/slf4j/Logger;
     261: ldc           #56                 // String Unable to close LDAP connection.
     263: aload         6
     265: invokeinterface #57,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     270: aload         5
     272: areturn
     273: aload         4
     275: invokevirtual #59                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.isConnected:()Z
     278: istore        5
     280: aload         4
     282: invokevirtual #60                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.isAuthenticated:()Z
     285: istore        6
     287: aload_1
     288: invokevirtual #61                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.testConnectOnly:()Z
     291: ifeq          340
     294: iload         5
     296: iload         6
     298: iconst_0
     299: invokestatic  #49                 // Method java/util/Collections.emptyMap:()Ljava/util/Map;
     302: invokestatic  #50                 // Method java/util/Collections.emptySet:()Ljava/util/Set;
     305: invokestatic  #62                 // Method org/graylog2/rest/models/system/ldap/responses/LdapTestConfigResponse.create:(ZZZLjava/util/Map;Ljava/util/Set;)Lorg/graylog2/rest/models/system/ldap/responses/LdapTestConfigResponse;
     308: astore        7
     310: aload         4
     312: ifnull        337
     315: aload         4
     317: invokevirtual #53                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.close:()V
     320: goto          337
     323: astore        8
     325: getstatic     #55                 // Field LOG:Lorg/slf4j/Logger;
     328: ldc           #56                 // String Unable to close LDAP connection.
     330: aload         8
     332: invokeinterface #57,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     337: aload         7
     339: areturn
     340: aconst_null
     341: astore        7
     343: iconst_0
     344: istore        8
     346: invokestatic  #49                 // Method java/util/Collections.emptyMap:()Ljava/util/Map;
     349: astore        9
     351: aconst_null
     352: astore        10
     354: invokestatic  #50                 // Method java/util/Collections.emptySet:()Ljava/util/Set;
     357: astore        11
     359: aload_0
     360: getfield      #46                 // Field ldapConnector:Lorg/graylog2/security/ldap/LdapConnector;
     363: aload         4
     365: aload_1
     366: invokevirtual #63                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.searchBase:()Ljava/lang/String;
     369: aload_1
     370: invokevirtual #64                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.searchPattern:()Ljava/lang/String;
     373: ldc           #65                 // String *
     375: aload_1
     376: invokevirtual #66                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.principal:()Ljava/lang/String;
     379: aload_1
     380: invokevirtual #67                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.activeDirectory:()Z
     383: aload_1
     384: invokevirtual #68                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.groupSearchBase:()Ljava/lang/String;
     387: aload_1
     388: invokevirtual #69                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.groupIdAttribute:()Ljava/lang/String;
     391: aload_1
     392: invokevirtual #70                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.groupSearchPattern:()Ljava/lang/String;
     395: invokevirtual #71                 // Method org/graylog2/security/ldap/LdapConnector.search:(Lorg/apache/directory/ldap/client/api/LdapNetworkConnection;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;ZLjava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/graylog2/shared/security/ldap/LdapEntry;
     398: astore        12
     400: aload         12
     402: ifnull        426
     405: aload         12
     407: invokevirtual #72                 // Method org/graylog2/shared/security/ldap/LdapEntry.getBindPrincipal:()Ljava/lang/String;
     410: astore        7
     412: aload         12
     414: invokevirtual #73                 // Method org/graylog2/shared/security/ldap/LdapEntry.getAttributes:()Ljava/util/Map;
     417: astore        9
     419: aload         12
     421: invokevirtual #74                 // Method org/graylog2/shared/security/ldap/LdapEntry.getGroups:()Ljava/util/Set;
     424: astore        11
     426: goto          438
     429: astore        12
     431: aload         12
     433: invokevirtual #76                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     436: astore        10
     438: aload_0
     439: getfield      #46                 // Field ldapConnector:Lorg/graylog2/security/ldap/LdapConnector;
     442: aload         4
     444: aload         7
     446: aload_1
     447: invokevirtual #77                 // Method org/graylog2/rest/models/system/ldap/requests/LdapTestConfigRequest.password:()Ljava/lang/String;
     450: invokevirtual #78                 // Method org/graylog2/security/ldap/LdapConnector.authenticate:(Lorg/apache/directory/ldap/client/api/LdapNetworkConnection;Ljava/lang/String;Ljava/lang/String;)Z
     453: istore        8
     455: goto          467
     458: astore        12
     460: aload         12
     462: invokevirtual #76                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     465: astore        10
     467: iload         5
     469: iload         6
     471: iload         8
     473: aload         9
     475: aload         11
     477: aload         10
     479: invokestatic  #52                 // Method org/graylog2/rest/models/system/ldap/responses/LdapTestConfigResponse.create:(ZZZLjava/util/Map;Ljava/util/Set;Ljava/lang/String;)Lorg/graylog2/rest/models/system/ldap/responses/LdapTestConfigResponse;
     482: astore        12
     484: aload         4
     486: ifnull        511
     489: aload         4
     491: invokevirtual #53                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.close:()V
     494: goto          511
     497: astore        13
     499: getstatic     #55                 // Field LOG:Lorg/slf4j/Logger;
     502: ldc           #56                 // String Unable to close LDAP connection.
     504: aload         13
     506: invokeinterface #57,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     511: aload         12
     513: areturn
     514: astore        14
     516: aload         4
     518: ifnull        543
     521: aload         4
     523: invokevirtual #53                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.close:()V
     526: goto          543
     529: astore        15
     531: getstatic     #55                 // Field LOG:Lorg/slf4j/Logger;
     534: ldc           #56                 // String Unable to close LDAP connection.
     536: aload         15
     538: invokeinterface #57,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     543: aload         14
     545: athrow
    Exception table:
       from    to  target type
         157   167   170   Class org/apache/directory/api/ldap/model/exception/LdapException
         196   201   204   Class java/io/IOException
         248   253   256   Class java/io/IOException
         315   320   323   Class java/io/IOException
         359   426   429   Class org/apache/directory/api/ldap/model/cursor/CursorException
         359   426   429   Class org/apache/directory/api/ldap/model/exception/LdapException
         438   455   458   Class java/lang/Exception
         489   494   497   Class java/io/IOException
         157   191   514   any
         221   243   514   any
         273   310   514   any
         340   484   514   any
         521   526   529   Class java/io/IOException
         514   516   514   any

  public void updateLdapSettings(org.graylog2.rest.models.system.ldap.requests.LdapSettingsRequest) throws org.graylog2.plugin.database.ValidationException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field ldapSettingsService:Lorg/graylog2/security/ldap/LdapSettingsService;
       4: invokeinterface #3,  1            // InterfaceMethod org/graylog2/security/ldap/LdapSettingsService.load:()Lorg/graylog2/shared/security/ldap/LdapSettings;
       9: aload_0
      10: getfield      #80                 // Field ldapSettingsFactory:Lorg/graylog2/security/ldap/LdapSettingsImpl$Factory;
      13: invokeinterface #81,  1           // InterfaceMethod org/graylog2/security/ldap/LdapSettingsImpl$Factory.createEmpty:()Lorg/graylog2/security/ldap/LdapSettingsImpl;
      18: invokestatic  #82                 // Method com/google/common/base/MoreObjects.firstNonNull:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      21: checkcast     #83                 // class org/graylog2/shared/security/ldap/LdapSettings
      24: astore_2
      25: aload_2
      26: aload_1
      27: invokevirtual #84                 // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.systemUsername:()Ljava/lang/String;
      30: invokeinterface #85,  2           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setSystemUsername:(Ljava/lang/String;)V
      35: aload_2
      36: aload_1
      37: invokevirtual #86                 // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.systemPassword:()Ljava/lang/String;
      40: invokeinterface #87,  2           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setSystemPassword:(Ljava/lang/String;)V
      45: aload_2
      46: aload_1
      47: invokevirtual #88                 // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.ldapUri:()Ljava/net/URI;
      50: invokeinterface #89,  2           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setUri:(Ljava/net/URI;)V
      55: aload_2
      56: aload_1
      57: invokevirtual #90                 // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.useStartTls:()Z
      60: invokeinterface #91,  2           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setUseStartTls:(Z)V
      65: aload_2
      66: aload_1
      67: invokevirtual #92                 // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.trustAllCertificates:()Z
      70: invokeinterface #93,  2           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setTrustAllCertificates:(Z)V
      75: aload_2
      76: aload_1
      77: invokevirtual #94                 // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.activeDirectory:()Z
      80: invokeinterface #95,  2           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setActiveDirectory:(Z)V
      85: aload_2
      86: aload_1
      87: invokevirtual #96                 // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.searchPattern:()Ljava/lang/String;
      90: invokeinterface #97,  2           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setSearchPattern:(Ljava/lang/String;)V
      95: aload_2
      96: aload_1
      97: invokevirtual #98                 // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.searchBase:()Ljava/lang/String;
     100: invokeinterface #99,  2           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setSearchBase:(Ljava/lang/String;)V
     105: aload_2
     106: aload_1
     107: invokevirtual #100                // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.enabled:()Z
     110: invokeinterface #101,  2          // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setEnabled:(Z)V
     115: aload_2
     116: aload_1
     117: invokevirtual #102                // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.displayNameAttribute:()Ljava/lang/String;
     120: invokeinterface #103,  2          // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setDisplayNameAttribute:(Ljava/lang/String;)V
     125: aload_2
     126: aload_1
     127: invokevirtual #104                // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.defaultGroup:()Ljava/lang/String;
     130: invokeinterface #105,  2          // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setDefaultGroup:(Ljava/lang/String;)V
     135: aload_2
     136: aload_1
     137: invokevirtual #106                // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.groupMapping:()Ljava/util/Map;
     140: invokeinterface #107,  2          // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setGroupMapping:(Ljava/util/Map;)V
     145: aload_2
     146: aload_1
     147: invokevirtual #108                // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.groupSearchBase:()Ljava/lang/String;
     150: invokeinterface #109,  2          // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setGroupSearchBase:(Ljava/lang/String;)V
     155: aload_2
     156: aload_1
     157: invokevirtual #110                // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.groupIdAttribute:()Ljava/lang/String;
     160: invokeinterface #111,  2          // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setGroupIdAttribute:(Ljava/lang/String;)V
     165: aload_2
     166: aload_1
     167: invokevirtual #112                // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.groupSearchPattern:()Ljava/lang/String;
     170: invokeinterface #113,  2          // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setGroupSearchPattern:(Ljava/lang/String;)V
     175: aload_2
     176: aload_1
     177: invokevirtual #114                // Method org/graylog2/rest/models/system/ldap/requests/LdapSettingsRequest.additionalDefaultGroups:()Ljava/util/Set;
     180: invokeinterface #115,  2          // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setAdditionalDefaultGroups:(Ljava/util/Set;)V
     185: aload_0
     186: getfield      #2                  // Field ldapSettingsService:Lorg/graylog2/security/ldap/LdapSettingsService;
     189: aload_2
     190: invokeinterface #116,  2          // InterfaceMethod org/graylog2/security/ldap/LdapSettingsService.save:(Lorg/graylog2/plugin/database/Persisted;)Ljava/lang/String;
     195: pop
     196: return

  public void deleteLdapSettings();
    Code:
       0: aload_0
       1: getfield      #2                  // Field ldapSettingsService:Lorg/graylog2/security/ldap/LdapSettingsService;
       4: invokeinterface #117,  1          // InterfaceMethod org/graylog2/security/ldap/LdapSettingsService.delete:()V
       9: return

  public java.util.Map<java.lang.String, java.lang.String> readGroupMapping();
    Code:
       0: aload_0
       1: getfield      #2                  // Field ldapSettingsService:Lorg/graylog2/security/ldap/LdapSettingsService;
       4: invokeinterface #3,  1            // InterfaceMethod org/graylog2/security/ldap/LdapSettingsService.load:()Lorg/graylog2/shared/security/ldap/LdapSettings;
       9: aload_0
      10: getfield      #80                 // Field ldapSettingsFactory:Lorg/graylog2/security/ldap/LdapSettingsImpl$Factory;
      13: invokeinterface #81,  1           // InterfaceMethod org/graylog2/security/ldap/LdapSettingsImpl$Factory.createEmpty:()Lorg/graylog2/security/ldap/LdapSettingsImpl;
      18: invokestatic  #82                 // Method com/google/common/base/MoreObjects.firstNonNull:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      21: checkcast     #83                 // class org/graylog2/shared/security/ldap/LdapSettings
      24: astore_1
      25: aload_1
      26: invokeinterface #16,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getGroupMapping:()Ljava/util/Map;
      31: areturn

  public javax.ws.rs.core.Response updateGroupMappingSettings(java.util.Map<java.lang.String, java.lang.String>) throws org.graylog2.plugin.database.ValidationException;
    Code:
       0: aload_0
       1: getfield      #2                  // Field ldapSettingsService:Lorg/graylog2/security/ldap/LdapSettingsService;
       4: invokeinterface #3,  1            // InterfaceMethod org/graylog2/security/ldap/LdapSettingsService.load:()Lorg/graylog2/shared/security/ldap/LdapSettings;
       9: aload_0
      10: getfield      #80                 // Field ldapSettingsFactory:Lorg/graylog2/security/ldap/LdapSettingsImpl$Factory;
      13: invokeinterface #81,  1           // InterfaceMethod org/graylog2/security/ldap/LdapSettingsImpl$Factory.createEmpty:()Lorg/graylog2/security/ldap/LdapSettingsImpl;
      18: invokestatic  #82                 // Method com/google/common/base/MoreObjects.firstNonNull:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      21: checkcast     #83                 // class org/graylog2/shared/security/ldap/LdapSettings
      24: astore_2
      25: aload_2
      26: aload_1
      27: invokeinterface #107,  2          // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.setGroupMapping:(Ljava/util/Map;)V
      32: aload_0
      33: getfield      #2                  // Field ldapSettingsService:Lorg/graylog2/security/ldap/LdapSettingsService;
      36: aload_2
      37: invokeinterface #116,  2          // InterfaceMethod org/graylog2/security/ldap/LdapSettingsService.save:(Lorg/graylog2/plugin/database/Persisted;)Ljava/lang/String;
      42: pop
      43: invokestatic  #118                // Method javax/ws/rs/core/Response.noContent:()Ljavax/ws/rs/core/Response$ResponseBuilder;
      46: invokevirtual #119                // Method javax/ws/rs/core/Response$ResponseBuilder.build:()Ljavax/ws/rs/core/Response;
      49: areturn

  public java.util.Set<java.lang.String> readGroups();
    Code:
       0: aload_0
       1: getfield      #2                  // Field ldapSettingsService:Lorg/graylog2/security/ldap/LdapSettingsService;
       4: invokeinterface #3,  1            // InterfaceMethod org/graylog2/security/ldap/LdapSettingsService.load:()Lorg/graylog2/shared/security/ldap/LdapSettings;
       9: aload_0
      10: getfield      #80                 // Field ldapSettingsFactory:Lorg/graylog2/security/ldap/LdapSettingsImpl$Factory;
      13: invokeinterface #81,  1           // InterfaceMethod org/graylog2/security/ldap/LdapSettingsImpl$Factory.createEmpty:()Lorg/graylog2/security/ldap/LdapSettingsImpl;
      18: invokestatic  #82                 // Method com/google/common/base/MoreObjects.firstNonNull:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      21: checkcast     #83                 // class org/graylog2/shared/security/ldap/LdapSettings
      24: astore_1
      25: aload_1
      26: invokeinterface #5,  1            // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.isEnabled:()Z
      31: ifne          44
      34: new           #120                // class javax/ws/rs/BadRequestException
      37: dup
      38: ldc           #121                // String LDAP is disabled.
      40: invokespecial #122                // Method javax/ws/rs/BadRequestException."<init>":(Ljava/lang/String;)V
      43: athrow
      44: aload_1
      45: invokeinterface #17,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getGroupSearchBase:()Ljava/lang/String;
      50: invokestatic  #41                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      53: ifne          68
      56: aload_1
      57: invokeinterface #18,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getGroupIdAttribute:()Ljava/lang/String;
      62: invokestatic  #41                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      65: ifeq          78
      68: new           #120                // class javax/ws/rs/BadRequestException
      71: dup
      72: ldc           #123                // String LDAP group configuration settings are not set.
      74: invokespecial #122                // Method javax/ws/rs/BadRequestException."<init>":(Ljava/lang/String;)V
      77: athrow
      78: new           #22                 // class org/apache/directory/ldap/client/api/LdapConnectionConfig
      81: dup
      82: invokespecial #23                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig."<init>":()V
      85: astore_2
      86: aload_1
      87: invokeinterface #8,  1            // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getUri:()Ljava/net/URI;
      92: astore_3
      93: aload_2
      94: aload_3
      95: invokevirtual #25                 // Method java/net/URI.getHost:()Ljava/lang/String;
      98: invokevirtual #26                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setLdapHost:(Ljava/lang/String;)V
     101: aload_2
     102: aload_3
     103: invokevirtual #27                 // Method java/net/URI.getPort:()I
     106: invokevirtual #28                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setLdapPort:(I)V
     109: aload_2
     110: aload_3
     111: invokevirtual #29                 // Method java/net/URI.getScheme:()Ljava/lang/String;
     114: ldc           #30                 // String ldaps
     116: invokevirtual #31                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     119: invokevirtual #32                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setUseSsl:(Z)V
     122: aload_2
     123: aload_1
     124: invokeinterface #9,  1            // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.isUseStartTls:()Z
     129: invokevirtual #34                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setUseTls:(Z)V
     132: aload_1
     133: invokeinterface #10,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.isTrustAllCertificates:()Z
     138: ifeq          159
     141: aload_2
     142: iconst_1
     143: anewarray     #36                 // class javax/net/ssl/TrustManager
     146: dup
     147: iconst_0
     148: new           #37                 // class org/graylog2/security/TrustAllX509TrustManager
     151: dup
     152: invokespecial #38                 // Method org/graylog2/security/TrustAllX509TrustManager."<init>":()V
     155: aastore
     156: invokevirtual #39                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setTrustManagers:([Ljavax/net/ssl/TrustManager;)V
     159: aload_1
     160: invokeinterface #6,  1            // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getSystemUserName:()Ljava/lang/String;
     165: invokestatic  #41                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     168: ifne          203
     171: aload_1
     172: invokeinterface #45,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getSystemPassword:()Ljava/lang/String;
     177: invokestatic  #41                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     180: ifne          203
     183: aload_2
     184: aload_1
     185: invokeinterface #6,  1            // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getSystemUserName:()Ljava/lang/String;
     190: invokevirtual #42                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setName:(Ljava/lang/String;)V
     193: aload_2
     194: aload_1
     195: invokeinterface #45,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getSystemPassword:()Ljava/lang/String;
     200: invokevirtual #44                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.setCredentials:(Ljava/lang/String;)V
     203: aload_0
     204: getfield      #46                 // Field ldapConnector:Lorg/graylog2/security/ldap/LdapConnector;
     207: aload_2
     208: invokevirtual #47                 // Method org/graylog2/security/ldap/LdapConnector.connect:(Lorg/apache/directory/ldap/client/api/LdapConnectionConfig;)Lorg/apache/directory/ldap/client/api/LdapNetworkConnection;
     211: astore        4
     213: aconst_null
     214: astore        5
     216: aload_0
     217: getfield      #46                 // Field ldapConnector:Lorg/graylog2/security/ldap/LdapConnector;
     220: aload         4
     222: aload_1
     223: invokeinterface #17,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getGroupSearchBase:()Ljava/lang/String;
     228: aload_1
     229: invokeinterface #20,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getGroupSearchPattern:()Ljava/lang/String;
     234: aload_1
     235: invokeinterface #18,  1           // InterfaceMethod org/graylog2/shared/security/ldap/LdapSettings.getGroupIdAttribute:()Ljava/lang/String;
     240: invokevirtual #124                // Method org/graylog2/security/ldap/LdapConnector.listGroups:(Lorg/apache/directory/ldap/client/api/LdapNetworkConnection;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/util/Set;
     243: astore        6
     245: aload         4
     247: ifnull        280
     250: aload         5
     252: ifnull        275
     255: aload         4
     257: invokevirtual #53                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.close:()V
     260: goto          280
     263: astore        7
     265: aload         5
     267: aload         7
     269: invokevirtual #126                // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     272: goto          280
     275: aload         4
     277: invokevirtual #53                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.close:()V
     280: aload         6
     282: areturn
     283: astore        6
     285: aload         6
     287: astore        5
     289: aload         6
     291: athrow
     292: astore        8
     294: aload         4
     296: ifnull        329
     299: aload         5
     301: ifnull        324
     304: aload         4
     306: invokevirtual #53                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.close:()V
     309: goto          329
     312: astore        9
     314: aload         5
     316: aload         9
     318: invokevirtual #126                // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     321: goto          329
     324: aload         4
     326: invokevirtual #53                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.close:()V
     329: aload         8
     331: athrow
     332: astore        4
     334: getstatic     #55                 // Field LOG:Lorg/slf4j/Logger;
     337: ldc           #127                // String Unable to retrieve available LDAP groups
     339: aload         4
     341: invokeinterface #128,  3          // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     346: new           #129                // class javax/ws/rs/InternalServerErrorException
     349: dup
     350: ldc           #127                // String Unable to retrieve available LDAP groups
     352: aload         4
     354: invokespecial #130                // Method javax/ws/rs/InternalServerErrorException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     357: athrow
    Exception table:
       from    to  target type
         255   260   263   Class java/lang/Throwable
         216   245   283   Class java/lang/Throwable
         216   245   292   any
         304   309   312   Class java/lang/Throwable
         283   294   292   any
         203   280   332   Class java/io/IOException
         203   280   332   Class org/apache/directory/api/ldap/model/exception/LdapException
         283   332   332   Class java/io/IOException
         283   332   332   Class org/apache/directory/api/ldap/model/exception/LdapException

  static {};
    Code:
       0: ldc           #131                // class org/graylog2/rest/resources/system/ldap/LdapResource
       2: invokestatic  #132                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #55                 // Field LOG:Lorg/slf4j/Logger;
       8: return
}
