Compiled from "ThrottleStateUpdaterThread.java"
public class org.graylog2.periodical.ThrottleStateUpdaterThread extends org.graylog2.plugin.periodical.Periodical {
  private static final org.slf4j.Logger log;

  private final org.graylog2.shared.journal.KafkaJournal journal;

  private final org.graylog2.shared.buffers.ProcessBuffer processBuffer;

  private final com.google.common.eventbus.EventBus eventBus;

  private final com.github.joschi.jadconfig.util.Size retentionSize;

  private final org.graylog2.notifications.NotificationService notificationService;

  private final org.graylog2.plugin.ServerStatus serverStatus;

  private boolean firstRun;

  private long logEndOffset;

  private long currentReadOffset;

  private long currentTs;

  private org.graylog2.plugin.ThrottleState throttleState;

  public org.graylog2.periodical.ThrottleStateUpdaterThread(org.graylog2.shared.journal.Journal, org.graylog2.shared.buffers.ProcessBuffer, com.google.common.eventbus.EventBus, org.graylog2.notifications.NotificationService, org.graylog2.plugin.ServerStatus, com.codahale.metrics.MetricRegistry, com.github.joschi.jadconfig.util.Size);
    Code:
       0: aload_0
       1: invokespecial #3                  // Method org/graylog2/plugin/periodical/Periodical."<init>":()V
       4: aload_0
       5: iconst_1
       6: putfield      #4                  // Field firstRun:Z
       9: aload_0
      10: aload_2
      11: putfield      #5                  // Field processBuffer:Lorg/graylog2/shared/buffers/ProcessBuffer;
      14: aload_0
      15: aload_3
      16: putfield      #6                  // Field eventBus:Lcom/google/common/eventbus/EventBus;
      19: aload_0
      20: aload         7
      22: putfield      #7                  // Field retentionSize:Lcom/github/joschi/jadconfig/util/Size;
      25: aload_0
      26: aload         4
      28: putfield      #8                  // Field notificationService:Lorg/graylog2/notifications/NotificationService;
      31: aload_0
      32: aload         5
      34: putfield      #9                  // Field serverStatus:Lorg/graylog2/plugin/ServerStatus;
      37: aload_1
      38: instanceof    #10                 // class org/graylog2/shared/journal/KafkaJournal
      41: ifeq          55
      44: aload_0
      45: aload_1
      46: checkcast     #10                 // class org/graylog2/shared/journal/KafkaJournal
      49: putfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
      52: goto          60
      55: aload_0
      56: aconst_null
      57: putfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
      60: aload_0
      61: new           #11                 // class org/graylog2/plugin/ThrottleState
      64: dup
      65: invokespecial #12                 // Method org/graylog2/plugin/ThrottleState."<init>":()V
      68: putfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
      71: aload         6
      73: getstatic     #13                 // Field org/graylog2/plugin/GlobalMetricNames.JOURNAL_APPEND_RATE:Ljava/lang/String;
      76: new           #14                 // class org/graylog2/periodical/ThrottleStateUpdaterThread$1
      79: dup
      80: aload_0
      81: invokespecial #15                 // Method org/graylog2/periodical/ThrottleStateUpdaterThread$1."<init>":(Lorg/graylog2/periodical/ThrottleStateUpdaterThread;)V
      84: invokestatic  #16                 // Method org/graylog2/shared/metrics/MetricUtils.safelyRegister:(Lcom/codahale/metrics/MetricRegistry;Ljava/lang/String;Lcom/codahale/metrics/Metric;)Lcom/codahale/metrics/Metric;
      87: pop
      88: aload         6
      90: getstatic     #17                 // Field org/graylog2/plugin/GlobalMetricNames.JOURNAL_READ_RATE:Ljava/lang/String;
      93: new           #18                 // class org/graylog2/periodical/ThrottleStateUpdaterThread$2
      96: dup
      97: aload_0
      98: invokespecial #19                 // Method org/graylog2/periodical/ThrottleStateUpdaterThread$2."<init>":(Lorg/graylog2/periodical/ThrottleStateUpdaterThread;)V
     101: invokestatic  #16                 // Method org/graylog2/shared/metrics/MetricUtils.safelyRegister:(Lcom/codahale/metrics/MetricRegistry;Ljava/lang/String;Lcom/codahale/metrics/Metric;)Lcom/codahale/metrics/Metric;
     104: pop
     105: aload         6
     107: ldc           #21                 // String org.graylog2.journal.segments
     109: new           #22                 // class org/graylog2/periodical/ThrottleStateUpdaterThread$3
     112: dup
     113: aload_0
     114: invokespecial #23                 // Method org/graylog2/periodical/ThrottleStateUpdaterThread$3."<init>":(Lorg/graylog2/periodical/ThrottleStateUpdaterThread;)V
     117: invokestatic  #16                 // Method org/graylog2/shared/metrics/MetricUtils.safelyRegister:(Lcom/codahale/metrics/MetricRegistry;Ljava/lang/String;Lcom/codahale/metrics/Metric;)Lcom/codahale/metrics/Metric;
     120: pop
     121: aload         6
     123: ldc           #24                 // String org.graylog2.journal.entries-uncommitted
     125: new           #25                 // class org/graylog2/periodical/ThrottleStateUpdaterThread$4
     128: dup
     129: aload_0
     130: invokespecial #26                 // Method org/graylog2/periodical/ThrottleStateUpdaterThread$4."<init>":(Lorg/graylog2/periodical/ThrottleStateUpdaterThread;)V
     133: invokestatic  #16                 // Method org/graylog2/shared/metrics/MetricUtils.safelyRegister:(Lcom/codahale/metrics/MetricRegistry;Ljava/lang/String;Lcom/codahale/metrics/Metric;)Lcom/codahale/metrics/Metric;
     136: pop
     137: aload         6
     139: ldc           #27                 // String org.graylog2.journal.size
     141: new           #28                 // class org/graylog2/periodical/ThrottleStateUpdaterThread$5
     144: dup
     145: aload_0
     146: invokespecial #29                 // Method org/graylog2/periodical/ThrottleStateUpdaterThread$5."<init>":(Lorg/graylog2/periodical/ThrottleStateUpdaterThread;)V
     149: invokestatic  #16                 // Method org/graylog2/shared/metrics/MetricUtils.safelyRegister:(Lcom/codahale/metrics/MetricRegistry;Ljava/lang/String;Lcom/codahale/metrics/Metric;)Lcom/codahale/metrics/Metric;
     152: checkcast     #30                 // class com/codahale/metrics/Gauge
     155: astore        8
     157: aload         6
     159: ldc           #31                 // String org.graylog2.journal.size-limit
     161: new           #32                 // class org/graylog2/periodical/ThrottleStateUpdaterThread$6
     164: dup
     165: aload_0
     166: invokespecial #33                 // Method org/graylog2/periodical/ThrottleStateUpdaterThread$6."<init>":(Lorg/graylog2/periodical/ThrottleStateUpdaterThread;)V
     169: invokestatic  #16                 // Method org/graylog2/shared/metrics/MetricUtils.safelyRegister:(Lcom/codahale/metrics/MetricRegistry;Ljava/lang/String;Lcom/codahale/metrics/Metric;)Lcom/codahale/metrics/Metric;
     172: checkcast     #30                 // class com/codahale/metrics/Gauge
     175: astore        9
     177: aload         6
     179: ldc           #34                 // String org.graylog2.journal.utilization-ratio
     181: new           #35                 // class org/graylog2/periodical/ThrottleStateUpdaterThread$7
     184: dup
     185: aload_0
     186: aload         8
     188: aload         9
     190: invokespecial #36                 // Method org/graylog2/periodical/ThrottleStateUpdaterThread$7."<init>":(Lorg/graylog2/periodical/ThrottleStateUpdaterThread;Lcom/codahale/metrics/Gauge;Lcom/codahale/metrics/Gauge;)V
     193: invokestatic  #16                 // Method org/graylog2/shared/metrics/MetricUtils.safelyRegister:(Lcom/codahale/metrics/MetricRegistry;Ljava/lang/String;Lcom/codahale/metrics/Metric;)Lcom/codahale/metrics/Metric;
     196: pop
     197: return

  public boolean runsForever();
    Code:
       0: iconst_0
       1: ireturn

  public boolean stopOnGracefulShutdown();
    Code:
       0: iconst_1
       1: ireturn

  public boolean masterOnly();
    Code:
       0: iconst_0
       1: ireturn

  public boolean startOnThisNode();
    Code:
       0: aload_0
       1: getfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
       4: ifnull        11
       7: iconst_1
       8: goto          12
      11: iconst_0
      12: ireturn

  public boolean isDaemon();
    Code:
       0: iconst_1
       1: ireturn

  public int getInitialDelaySeconds();
    Code:
       0: iconst_1
       1: ireturn

  public int getPeriodSeconds();
    Code:
       0: iconst_1
       1: ireturn

  protected org.slf4j.Logger getLogger();
    Code:
       0: getstatic     #37                 // Field log:Lorg/slf4j/Logger;
       3: areturn

  public void doRun();
    Code:
       0: aload_0
       1: new           #11                 // class org/graylog2/plugin/ThrottleState
       4: dup
       5: aload_0
       6: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
       9: invokespecial #38                 // Method org/graylog2/plugin/ThrottleState."<init>":(Lorg/graylog2/plugin/ThrottleState;)V
      12: putfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
      15: aload_0
      16: getfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
      19: invokevirtual #39                 // Method org/graylog2/shared/journal/KafkaJournal.getCommittedOffset:()J
      22: lstore_1
      23: aload_0
      24: getfield      #40                 // Field currentTs:J
      27: lstore_3
      28: aload_0
      29: invokestatic  #41                 // Method java/lang/System.nanoTime:()J
      32: putfield      #40                 // Field currentTs:J
      35: aload_0
      36: getfield      #42                 // Field logEndOffset:J
      39: lstore        5
      41: aload_0
      42: getfield      #43                 // Field currentReadOffset:J
      45: lstore        7
      47: aload_0
      48: getfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
      51: invokevirtual #44                 // Method org/graylog2/shared/journal/KafkaJournal.getLogStartOffset:()J
      54: lstore        9
      56: aload_0
      57: aload_0
      58: getfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
      61: invokevirtual #45                 // Method org/graylog2/shared/journal/KafkaJournal.getLogEndOffset:()J
      64: lconst_1
      65: lsub
      66: putfield      #42                 // Field logEndOffset:J
      69: aload_0
      70: aload_0
      71: getfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
      74: invokevirtual #46                 // Method org/graylog2/shared/journal/KafkaJournal.getNextReadOffset:()J
      77: lconst_1
      78: lsub
      79: putfield      #43                 // Field currentReadOffset:J
      82: aload_0
      83: getfield      #4                  // Field firstRun:Z
      86: ifeq          95
      89: aload_0
      90: iconst_0
      91: putfield      #4                  // Field firstRun:Z
      94: return
      95: aload_0
      96: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
      99: aload_0
     100: getfield      #42                 // Field logEndOffset:J
     103: lload         5
     105: lsub
     106: l2d
     107: aload_0
     108: getfield      #40                 // Field currentTs:J
     111: lload_3
     112: lsub
     113: l2d
     114: ldc2_w        #47                 // double 1.0E9d
     117: ddiv
     118: ddiv
     119: invokestatic  #49                 // Method java/lang/Math.floor:(D)D
     122: d2l
     123: putfield      #50                 // Field org/graylog2/plugin/ThrottleState.appendEventsPerSec:J
     126: aload_0
     127: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     130: aload_0
     131: getfield      #43                 // Field currentReadOffset:J
     134: lload         7
     136: lsub
     137: l2d
     138: aload_0
     139: getfield      #40                 // Field currentTs:J
     142: lload_3
     143: lsub
     144: l2d
     145: ldc2_w        #47                 // double 1.0E9d
     148: ddiv
     149: ddiv
     150: invokestatic  #49                 // Method java/lang/Math.floor:(D)D
     153: d2l
     154: putfield      #51                 // Field org/graylog2/plugin/ThrottleState.readEventsPerSec:J
     157: aload_0
     158: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     161: aload_0
     162: getfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
     165: invokevirtual #52                 // Method org/graylog2/shared/journal/KafkaJournal.size:()J
     168: putfield      #53                 // Field org/graylog2/plugin/ThrottleState.journalSize:J
     171: aload_0
     172: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     175: aload_0
     176: getfield      #7                  // Field retentionSize:Lcom/github/joschi/jadconfig/util/Size;
     179: invokevirtual #54                 // Method com/github/joschi/jadconfig/util/Size.toBytes:()J
     182: putfield      #55                 // Field org/graylog2/plugin/ThrottleState.journalSizeLimit:J
     185: aload_0
     186: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     189: aload_0
     190: getfield      #5                  // Field processBuffer:Lorg/graylog2/shared/buffers/ProcessBuffer;
     193: invokevirtual #56                 // Method org/graylog2/shared/buffers/ProcessBuffer.getRemainingCapacity:()J
     196: putfield      #57                 // Field org/graylog2/plugin/ThrottleState.processBufferCapacity:J
     199: lload_1
     200: ldc2_w        #58                 // long -9223372036854775808l
     203: lcmp
     204: ifne          240
     207: aload_0
     208: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     211: aload_0
     212: getfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
     215: invokevirtual #52                 // Method org/graylog2/shared/journal/KafkaJournal.size:()J
     218: lconst_0
     219: lcmp
     220: ifne          227
     223: lconst_0
     224: goto          234
     227: aload_0
     228: getfield      #42                 // Field logEndOffset:J
     231: lload         9
     233: lsub
     234: putfield      #60                 // Field org/graylog2/plugin/ThrottleState.uncommittedJournalEntries:J
     237: goto          253
     240: aload_0
     241: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     244: aload_0
     245: getfield      #42                 // Field logEndOffset:J
     248: lload_1
     249: lsub
     250: putfield      #60                 // Field org/graylog2/plugin/ThrottleState.uncommittedJournalEntries:J
     253: getstatic     #37                 // Field log:Lorg/slf4j/Logger;
     256: ldc           #61                 // String ThrottleState: {}
     258: aload_0
     259: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     262: invokeinterface #62,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
     267: aload_0
     268: getfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
     271: aload_0
     272: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     275: invokevirtual #63                 // Method org/graylog2/shared/journal/KafkaJournal.setThrottleState:(Lorg/graylog2/plugin/ThrottleState;)V
     278: aload_0
     279: getfield      #6                  // Field eventBus:Lcom/google/common/eventbus/EventBus;
     282: aload_0
     283: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     286: invokevirtual #64                 // Method com/google/common/eventbus/EventBus.post:(Ljava/lang/Object;)V
     289: aload_0
     290: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     293: getfield      #55                 // Field org/graylog2/plugin/ThrottleState.journalSizeLimit:J
     296: lconst_0
     297: lcmp
     298: ifle          324
     301: aload_0
     302: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     305: getfield      #53                 // Field org/graylog2/plugin/ThrottleState.journalSize:J
     308: ldc2_w        #65                 // long 100l
     311: lmul
     312: aload_0
     313: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
     316: getfield      #55                 // Field org/graylog2/plugin/ThrottleState.journalSizeLimit:J
     319: ldiv
     320: l2d
     321: goto          325
     324: dconst_0
     325: dstore        11
     327: dload         11
     329: ldc2_w        #67                 // double 95.0d
     332: dcmpl
     333: ifle          402
     336: aload_0
     337: getfield      #8                  // Field notificationService:Lorg/graylog2/notifications/NotificationService;
     340: invokeinterface #69,  1           // InterfaceMethod org/graylog2/notifications/NotificationService.buildNow:()Lorg/graylog2/notifications/Notification;
     345: aload_0
     346: getfield      #9                  // Field serverStatus:Lorg/graylog2/plugin/ServerStatus;
     349: invokevirtual #70                 // Method org/graylog2/plugin/ServerStatus.getNodeId:()Lorg/graylog2/plugin/system/NodeId;
     352: invokevirtual #71                 // Method org/graylog2/plugin/system/NodeId.toString:()Ljava/lang/String;
     355: invokeinterface #72,  2           // InterfaceMethod org/graylog2/notifications/Notification.addNode:(Ljava/lang/String;)Lorg/graylog2/notifications/Notification;
     360: getstatic     #73                 // Field org/graylog2/notifications/Notification$Type.JOURNAL_UTILIZATION_TOO_HIGH:Lorg/graylog2/notifications/Notification$Type;
     363: invokeinterface #74,  2           // InterfaceMethod org/graylog2/notifications/Notification.addType:(Lorg/graylog2/notifications/Notification$Type;)Lorg/graylog2/notifications/Notification;
     368: getstatic     #75                 // Field org/graylog2/notifications/Notification$Severity.URGENT:Lorg/graylog2/notifications/Notification$Severity;
     371: invokeinterface #76,  2           // InterfaceMethod org/graylog2/notifications/Notification.addSeverity:(Lorg/graylog2/notifications/Notification$Severity;)Lorg/graylog2/notifications/Notification;
     376: ldc           #77                 // String journal_utilization_percentage
     378: dload         11
     380: invokestatic  #78                 // Method java/lang/Double.valueOf:(D)Ljava/lang/Double;
     383: invokeinterface #79,  3           // InterfaceMethod org/graylog2/notifications/Notification.addDetail:(Ljava/lang/String;Ljava/lang/Object;)Lorg/graylog2/notifications/Notification;
     388: astore        13
     390: aload_0
     391: getfield      #8                  // Field notificationService:Lorg/graylog2/notifications/NotificationService;
     394: aload         13
     396: invokeinterface #80,  2           // InterfaceMethod org/graylog2/notifications/NotificationService.publishIfFirst:(Lorg/graylog2/notifications/Notification;)Z
     401: pop
     402: aload_0
     403: getfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
     406: invokevirtual #81                 // Method org/graylog2/shared/journal/KafkaJournal.getPurgedSegmentsInLastRetention:()I
     409: ifle          466
     412: aload_0
     413: getfield      #8                  // Field notificationService:Lorg/graylog2/notifications/NotificationService;
     416: invokeinterface #69,  1           // InterfaceMethod org/graylog2/notifications/NotificationService.buildNow:()Lorg/graylog2/notifications/Notification;
     421: aload_0
     422: getfield      #9                  // Field serverStatus:Lorg/graylog2/plugin/ServerStatus;
     425: invokevirtual #70                 // Method org/graylog2/plugin/ServerStatus.getNodeId:()Lorg/graylog2/plugin/system/NodeId;
     428: invokevirtual #71                 // Method org/graylog2/plugin/system/NodeId.toString:()Ljava/lang/String;
     431: invokeinterface #72,  2           // InterfaceMethod org/graylog2/notifications/Notification.addNode:(Ljava/lang/String;)Lorg/graylog2/notifications/Notification;
     436: getstatic     #82                 // Field org/graylog2/notifications/Notification$Type.JOURNAL_UNCOMMITTED_MESSAGES_DELETED:Lorg/graylog2/notifications/Notification$Type;
     439: invokeinterface #74,  2           // InterfaceMethod org/graylog2/notifications/Notification.addType:(Lorg/graylog2/notifications/Notification$Type;)Lorg/graylog2/notifications/Notification;
     444: getstatic     #75                 // Field org/graylog2/notifications/Notification$Severity.URGENT:Lorg/graylog2/notifications/Notification$Severity;
     447: invokeinterface #76,  2           // InterfaceMethod org/graylog2/notifications/Notification.addSeverity:(Lorg/graylog2/notifications/Notification$Severity;)Lorg/graylog2/notifications/Notification;
     452: astore        13
     454: aload_0
     455: getfield      #8                  // Field notificationService:Lorg/graylog2/notifications/NotificationService;
     458: aload         13
     460: invokeinterface #80,  2           // InterfaceMethod org/graylog2/notifications/NotificationService.publishIfFirst:(Lorg/graylog2/notifications/Notification;)Z
     465: pop
     466: return

  static org.graylog2.plugin.ThrottleState access$000(org.graylog2.periodical.ThrottleStateUpdaterThread);
    Code:
       0: aload_0
       1: getfield      #2                  // Field throttleState:Lorg/graylog2/plugin/ThrottleState;
       4: areturn

  static org.graylog2.shared.journal.KafkaJournal access$100(org.graylog2.periodical.ThrottleStateUpdaterThread);
    Code:
       0: aload_0
       1: getfield      #1                  // Field journal:Lorg/graylog2/shared/journal/KafkaJournal;
       4: areturn

  static {};
    Code:
       0: ldc           #83                 // class org/graylog2/periodical/ThrottleStateUpdaterThread
       2: invokestatic  #84                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #37                 // Field log:Lorg/slf4j/Logger;
       8: return
}
