Compiled from "V20161125142400_EmailAlarmCallbackMigration.java"
public class org.graylog2.migrations.V20161125142400_EmailAlarmCallbackMigration extends org.graylog2.migrations.Migration {
  private static final org.slf4j.Logger LOG;

  private final org.graylog2.plugin.cluster.ClusterConfigService clusterConfigService;

  private final org.graylog2.streams.StreamService streamService;

  private final org.graylog2.alarmcallbacks.AlarmCallbackConfigurationService alarmCallbackService;

  private final org.graylog2.alarmcallbacks.EmailAlarmCallback emailAlarmCallback;

  private final org.graylog2.plugin.database.users.User localAdminUser;

  public org.graylog2.migrations.V20161125142400_EmailAlarmCallbackMigration(org.graylog2.plugin.cluster.ClusterConfigService, org.graylog2.streams.StreamService, org.graylog2.alarmcallbacks.AlarmCallbackConfigurationService, org.graylog2.alarmcallbacks.EmailAlarmCallback, org.graylog2.shared.users.UserService);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/graylog2/migrations/Migration."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field clusterConfigService:Lorg/graylog2/plugin/cluster/ClusterConfigService;
       9: aload_0
      10: aload_2
      11: putfield      #3                  // Field streamService:Lorg/graylog2/streams/StreamService;
      14: aload_0
      15: aload_3
      16: putfield      #4                  // Field alarmCallbackService:Lorg/graylog2/alarmcallbacks/AlarmCallbackConfigurationService;
      19: aload_0
      20: aload         4
      22: putfield      #5                  // Field emailAlarmCallback:Lorg/graylog2/alarmcallbacks/EmailAlarmCallback;
      25: aload_0
      26: aload         5
      28: invokeinterface #6,  1            // InterfaceMethod org/graylog2/shared/users/UserService.getAdminUser:()Lorg/graylog2/plugin/database/users/User;
      33: putfield      #7                  // Field localAdminUser:Lorg/graylog2/plugin/database/users/User;
      36: return

  public java.time.ZonedDateTime createdAt();
    Code:
       0: ldc           #8                  // String 2016-11-25T14:24:00Z
       2: invokestatic  #9                  // Method java/time/ZonedDateTime.parse:(Ljava/lang/CharSequence;)Ljava/time/ZonedDateTime;
       5: areturn

  private boolean hasAlertReceivers(org.graylog2.plugin.streams.Stream);
    Code:
       0: aload_1
       1: invokeinterface #10,  1           // InterfaceMethod org/graylog2/plugin/streams/Stream.getAlertReceivers:()Ljava/util/Map;
       6: astore_2
       7: aload_2
       8: ifnull        20
      11: aload_2
      12: invokeinterface #11,  1           // InterfaceMethod java/util/Map.isEmpty:()Z
      17: ifeq          22
      20: iconst_0
      21: ireturn
      22: aload_2
      23: ldc           #12                 // String users
      25: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      30: checkcast     #14                 // class java/util/List
      33: astore_3
      34: aload_2
      35: ldc           #15                 // String emails
      37: invokeinterface #13,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      42: checkcast     #14                 // class java/util/List
      45: astore        4
      47: aload_3
      48: ifnull        60
      51: aload_3
      52: invokeinterface #16,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      57: ifeq          75
      60: aload         4
      62: ifnull        79
      65: aload         4
      67: invokeinterface #16,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      72: ifne          79
      75: iconst_1
      76: goto          80
      79: iconst_0
      80: ireturn

  public void upgrade();
    Code:
       0: aload_0
       1: getfield      #2                  // Field clusterConfigService:Lorg/graylog2/plugin/cluster/ClusterConfigService;
       4: ldc           #17                 // class org/graylog2/migrations/V20161125142400_EmailAlarmCallbackMigration$MigrationCompleted
       6: invokeinterface #18,  2           // InterfaceMethod org/graylog2/plugin/cluster/ClusterConfigService.get:(Ljava/lang/Class;)Ljava/lang/Object;
      11: ifnull        15
      14: return
      15: aload_0
      16: getfield      #3                  // Field streamService:Lorg/graylog2/streams/StreamService;
      19: invokeinterface #19,  1           // InterfaceMethod org/graylog2/streams/StreamService.loadAll:()Ljava/util/List;
      24: invokeinterface #20,  1           // InterfaceMethod java/util/List.stream:()Ljava/util/stream/Stream;
      29: aload_0
      30: invokedynamic #21,  0             // InvokeDynamic #0:test:(Lorg/graylog2/migrations/V20161125142400_EmailAlarmCallbackMigration;)Ljava/util/function/Predicate;
      35: invokeinterface #22,  2           // InterfaceMethod java/util/stream/Stream.filter:(Ljava/util/function/Predicate;)Ljava/util/stream/Stream;
      40: invokedynamic #23,  0             // InvokeDynamic #1:apply:()Ljava/util/function/Function;
      45: aload_0
      46: invokedynamic #24,  0             // InvokeDynamic #2:apply:(Lorg/graylog2/migrations/V20161125142400_EmailAlarmCallbackMigration;)Ljava/util/function/Function;
      51: invokestatic  #25                 // Method java/util/stream/Collectors.toMap:(Ljava/util/function/Function;Ljava/util/function/Function;)Ljava/util/stream/Collector;
      54: invokeinterface #26,  2           // InterfaceMethod java/util/stream/Stream.collect:(Ljava/util/stream/Collector;)Ljava/lang/Object;
      59: checkcast     #27                 // class java/util/Map
      62: astore_1
      63: aload_1
      64: invokeinterface #28,  1           // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
      69: invokeinterface #29,  1           // InterfaceMethod java/util/Collection.stream:()Ljava/util/stream/Stream;
      74: invokedynamic #30,  0             // InvokeDynamic #3:test:()Ljava/util/function/Predicate;
      79: invokeinterface #31,  2           // InterfaceMethod java/util/stream/Stream.allMatch:(Ljava/util/function/Predicate;)Z
      84: istore_2
      85: aload_1
      86: invokeinterface #32,  1           // InterfaceMethod java/util/Map.size:()I
      91: i2l
      92: lstore_3
      93: iload_2
      94: ifeq          164
      97: lload_3
      98: lconst_0
      99: lcmp
     100: ifle          138
     103: getstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
     106: new           #34                 // class java/lang/StringBuilder
     109: dup
     110: invokespecial #35                 // Method java/lang/StringBuilder."<init>":()V
     113: ldc           #36                 // String Successfully migrated
     115: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     118: lload_3
     119: invokevirtual #38                 // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
     122: ldc           #39                 // String  streams to include explicit email alarm callback.
     124: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     127: invokevirtual #40                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     130: invokeinterface #41,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     135: goto          148
     138: getstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
     141: ldc           #42                 // String No streams needed to be migrated.
     143: invokeinterface #41,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     148: aload_0
     149: getfield      #2                  // Field clusterConfigService:Lorg/graylog2/plugin/cluster/ClusterConfigService;
     152: aload_1
     153: invokestatic  #43                 // Method org/graylog2/migrations/V20161125142400_EmailAlarmCallbackMigration$MigrationCompleted.create:(Ljava/util/Map;)Lorg/graylog2/migrations/V20161125142400_EmailAlarmCallbackMigration$MigrationCompleted;
     156: invokeinterface #44,  2           // InterfaceMethod org/graylog2/plugin/cluster/ClusterConfigService.write:(Ljava/lang/Object;)V
     161: goto          234
     164: aload_1
     165: invokeinterface #28,  1           // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
     170: invokeinterface #29,  1           // InterfaceMethod java/util/Collection.stream:()Ljava/util/stream/Stream;
     175: invokedynamic #45,  0             // InvokeDynamic #4:test:()Ljava/util/function/Predicate;
     180: invokeinterface #22,  2           // InterfaceMethod java/util/stream/Stream.filter:(Ljava/util/function/Predicate;)Ljava/util/stream/Stream;
     185: invokeinterface #46,  1           // InterfaceMethod java/util/stream/Stream.count:()J
     190: lstore        5
     192: getstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
     195: new           #34                 // class java/lang/StringBuilder
     198: dup
     199: invokespecial #35                 // Method java/lang/StringBuilder."<init>":()V
     202: ldc           #47                 // String Failed migrating
     204: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     207: lload         5
     209: invokevirtual #38                 // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
     212: ldc           #48                 // String /
     214: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     217: lload_3
     218: invokevirtual #38                 // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
     221: ldc           #39                 // String  streams to include explicit email alarm callback.
     223: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     226: invokevirtual #40                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     229: invokeinterface #49,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     234: return

  private java.util.Optional<java.lang.String> migrateStream(org.graylog2.plugin.streams.Stream);
    Code:
       0: aload_0
       1: invokevirtual #50                 // Method getDefaultEmailAlarmCallbackConfig:()Ljava/util/Map;
       4: astore_2
       5: getstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
       8: new           #34                 // class java/lang/StringBuilder
      11: dup
      12: invokespecial #35                 // Method java/lang/StringBuilder."<init>":()V
      15: ldc           #51                 // String Creating email alarm callback for stream <
      17: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      20: aload_1
      21: invokeinterface #52,  1           // InterfaceMethod org/graylog2/plugin/streams/Stream.getId:()Ljava/lang/String;
      26: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      29: ldc           #53                 // String >
      31: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      34: invokevirtual #40                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      37: invokeinterface #54,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      42: aload_0
      43: getfield      #4                  // Field alarmCallbackService:Lorg/graylog2/alarmcallbacks/AlarmCallbackConfigurationService;
      46: aload_1
      47: invokeinterface #52,  1           // InterfaceMethod org/graylog2/plugin/streams/Stream.getId:()Ljava/lang/String;
      52: ldc           #55                 // class org/graylog2/alarmcallbacks/EmailAlarmCallback
      54: invokevirtual #56                 // Method java/lang/Class.getCanonicalName:()Ljava/lang/String;
      57: ldc           #57                 // String Email Alert Notification
      59: aload_2
      60: invokestatic  #58                 // Method org/graylog2/rest/models/alarmcallbacks/requests/CreateAlarmCallbackRequest.create:(Ljava/lang/String;Ljava/lang/String;Ljava/util/Map;)Lorg/graylog2/rest/models/alarmcallbacks/requests/CreateAlarmCallbackRequest;
      63: aload_0
      64: getfield      #7                  // Field localAdminUser:Lorg/graylog2/plugin/database/users/User;
      67: invokeinterface #59,  1           // InterfaceMethod org/graylog2/plugin/database/users/User.getId:()Ljava/lang/String;
      72: invokeinterface #60,  4           // InterfaceMethod org/graylog2/alarmcallbacks/AlarmCallbackConfigurationService.create:(Ljava/lang/String;Lorg/graylog2/rest/models/alarmcallbacks/requests/CreateAlarmCallbackRequest;Ljava/lang/String;)Lorg/graylog2/alarmcallbacks/AlarmCallbackConfiguration;
      77: astore_3
      78: aload_0
      79: getfield      #4                  // Field alarmCallbackService:Lorg/graylog2/alarmcallbacks/AlarmCallbackConfigurationService;
      82: aload_3
      83: invokeinterface #61,  2           // InterfaceMethod org/graylog2/alarmcallbacks/AlarmCallbackConfigurationService.save:(Lorg/graylog2/alarmcallbacks/AlarmCallbackConfiguration;)Ljava/lang/String;
      88: astore        4
      90: getstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
      93: new           #34                 // class java/lang/StringBuilder
      96: dup
      97: invokespecial #35                 // Method java/lang/StringBuilder."<init>":()V
     100: ldc           #62                 // String Successfully created email alarm callback <
     102: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     105: aload         4
     107: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     110: ldc           #63                 // String > for stream <
     112: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     115: aload_1
     116: invokeinterface #52,  1           // InterfaceMethod org/graylog2/plugin/streams/Stream.getId:()Ljava/lang/String;
     121: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     124: ldc           #64                 // String >.
     126: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     129: invokevirtual #40                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     132: invokeinterface #54,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     137: aload         4
     139: invokestatic  #65                 // Method java/util/Optional.of:(Ljava/lang/Object;)Ljava/util/Optional;
     142: areturn
     143: astore        4
     145: getstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
     148: new           #34                 // class java/lang/StringBuilder
     151: dup
     152: invokespecial #35                 // Method java/lang/StringBuilder."<init>":()V
     155: ldc           #67                 // String Unable to create email alarm callback for stream <
     157: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     160: aload_1
     161: invokeinterface #52,  1           // InterfaceMethod org/graylog2/plugin/streams/Stream.getId:()Ljava/lang/String;
     166: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     169: ldc           #68                 // String >:
     171: invokevirtual #37                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     174: invokevirtual #40                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     177: aload         4
     179: invokeinterface #69,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     184: invokestatic  #70                 // Method java/util/Optional.empty:()Ljava/util/Optional;
     187: areturn
    Exception table:
       from    to  target type
          78   142   143   Class org/graylog2/plugin/database/ValidationException

  java.util.Map<java.lang.String, java.lang.Object> getDefaultEmailAlarmCallbackConfig();
    Code:
       0: aload_0
       1: getfield      #5                  // Field emailAlarmCallback:Lorg/graylog2/alarmcallbacks/EmailAlarmCallback;
       4: invokevirtual #71                 // Method org/graylog2/alarmcallbacks/EmailAlarmCallback.getRequestedConfiguration:()Lorg/graylog2/plugin/configuration/ConfigurationRequest;
       7: astore_1
       8: aload_1
       9: invokevirtual #72                 // Method org/graylog2/plugin/configuration/ConfigurationRequest.getFields:()Ljava/util/Map;
      12: invokeinterface #73,  1           // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
      17: invokeinterface #74,  1           // InterfaceMethod java/util/Set.stream:()Ljava/util/stream/Stream;
      22: invokedynamic #75,  0             // InvokeDynamic #5:apply:()Ljava/util/function/Function;
      27: invokedynamic #76,  0             // InvokeDynamic #6:apply:()Ljava/util/function/Function;
      32: invokestatic  #25                 // Method java/util/stream/Collectors.toMap:(Ljava/util/function/Function;Ljava/util/function/Function;)Ljava/util/stream/Collector;
      35: invokeinterface #26,  2           // InterfaceMethod java/util/stream/Stream.collect:(Ljava/util/stream/Collector;)Ljava/lang/Object;
      40: checkcast     #27                 // class java/util/Map
      43: areturn

  private static java.lang.Object lambda$getDefaultEmailAlarmCallbackConfig$2(java.util.Map$Entry);
    Code:
       0: aload_0
       1: invokeinterface #77,  1           // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
       6: checkcast     #78                 // class org/graylog2/plugin/configuration/fields/ConfigurationField
       9: invokeinterface #79,  1           // InterfaceMethod org/graylog2/plugin/configuration/fields/ConfigurationField.getDefaultValue:()Ljava/lang/Object;
      14: areturn

  private static boolean lambda$upgrade$1(java.util.Optional);
    Code:
       0: aload_0
       1: invokevirtual #80                 // Method java/util/Optional.isPresent:()Z
       4: ifne          11
       7: iconst_1
       8: goto          12
      11: iconst_0
      12: ireturn

  private boolean lambda$upgrade$0(org.graylog2.plugin.streams.Stream);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #81                 // Method hasAlertReceivers:(Lorg/graylog2/plugin/streams/Stream;)Z
       5: ifeq          48
       8: aload_0
       9: getfield      #3                  // Field streamService:Lorg/graylog2/streams/StreamService;
      12: aload_1
      13: invokeinterface #82,  2           // InterfaceMethod org/graylog2/streams/StreamService.getAlertConditions:(Lorg/graylog2/plugin/streams/Stream;)Ljava/util/List;
      18: invokeinterface #16,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      23: ifne          48
      26: aload_0
      27: getfield      #4                  // Field alarmCallbackService:Lorg/graylog2/alarmcallbacks/AlarmCallbackConfigurationService;
      30: aload_1
      31: invokeinterface #83,  2           // InterfaceMethod org/graylog2/alarmcallbacks/AlarmCallbackConfigurationService.getForStream:(Lorg/graylog2/plugin/streams/Stream;)Ljava/util/List;
      36: invokeinterface #16,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      41: ifeq          48
      44: iconst_1
      45: goto          49
      48: iconst_0
      49: ireturn

  static {};
    Code:
       0: ldc           #84                 // class org/graylog2/migrations/V20161125142400_EmailAlarmCallbackMigration
       2: invokestatic  #85                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #33                 // Field LOG:Lorg/slf4j/Logger;
       8: return
}
