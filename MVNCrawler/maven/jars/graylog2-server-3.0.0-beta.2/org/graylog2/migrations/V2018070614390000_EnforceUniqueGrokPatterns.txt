Compiled from "V2018070614390000_EnforceUniqueGrokPatterns.java"
public class org.graylog2.migrations.V2018070614390000_EnforceUniqueGrokPatterns extends org.graylog2.migrations.Migration {
  private static final org.slf4j.Logger LOG;

  private final com.mongodb.client.MongoCollection<org.bson.Document> collection;

  private final org.graylog2.events.ClusterEventBus clusterEventBus;

  private boolean indexCreated;

  public org.graylog2.migrations.V2018070614390000_EnforceUniqueGrokPatterns(org.graylog2.database.MongoConnection, org.graylog2.events.ClusterEventBus);
    Code:
       0: aload_0
       1: aload_1
       2: invokeinterface #1,  1            // InterfaceMethod org/graylog2/database/MongoConnection.getMongoDatabase:()Lcom/mongodb/client/MongoDatabase;
       7: ldc           #3                  // String grok_patterns
       9: invokeinterface #4,  2            // InterfaceMethod com/mongodb/client/MongoDatabase.getCollection:(Ljava/lang/String;)Lcom/mongodb/client/MongoCollection;
      14: aload_2
      15: invokespecial #5                  // Method "<init>":(Lcom/mongodb/client/MongoCollection;Lorg/graylog2/events/ClusterEventBus;)V
      18: return

  org.graylog2.migrations.V2018070614390000_EnforceUniqueGrokPatterns(com.mongodb.client.MongoCollection<org.bson.Document>, org.graylog2.events.ClusterEventBus);
    Code:
       0: aload_0
       1: invokespecial #6                  // Method org/graylog2/migrations/Migration."<init>":()V
       4: aload_0
       5: iconst_0
       6: putfield      #7                  // Field indexCreated:Z
       9: aload_0
      10: aload_1
      11: putfield      #8                  // Field collection:Lcom/mongodb/client/MongoCollection;
      14: aload_0
      15: aload_2
      16: putfield      #9                  // Field clusterEventBus:Lorg/graylog2/events/ClusterEventBus;
      19: return

  public java.time.ZonedDateTime createdAt();
    Code:
       0: ldc           #10                 // String 2018-07-06T14:39:00Z
       2: invokestatic  #11                 // Method java/time/ZonedDateTime.parse:(Ljava/lang/CharSequence;)Ljava/time/ZonedDateTime;
       5: areturn

  public void upgrade();
    Code:
       0: iconst_0
       1: istore_1
       2: aload_0
       3: getfield      #8                  // Field collection:Lcom/mongodb/client/MongoCollection;
       6: invokeinterface #12,  1           // InterfaceMethod com/mongodb/client/MongoCollection.listIndexes:()Lcom/mongodb/client/ListIndexesIterable;
      11: invokeinterface #13,  1           // InterfaceMethod com/mongodb/client/ListIndexesIterable.iterator:()Lcom/mongodb/client/MongoCursor;
      16: astore_2
      17: aload_2
      18: invokeinterface #14,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      23: ifeq          70
      26: aload_2
      27: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      32: checkcast     #16                 // class org/bson/Document
      35: astore_3
      36: ldc           #17                 // String idx_name_asc_unique
      38: aload_3
      39: ldc           #18                 // String name
      41: invokevirtual #19                 // Method org/bson/Document.getString:(Ljava/lang/Object;)Ljava/lang/String;
      44: invokevirtual #20                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      47: ifeq          67
      50: aload_3
      51: ldc           #21                 // String unique
      53: invokevirtual #22                 // Method org/bson/Document.getBoolean:(Ljava/lang/Object;)Ljava/lang/Boolean;
      56: invokevirtual #23                 // Method java/lang/Boolean.booleanValue:()Z
      59: ifeq          67
      62: iconst_1
      63: istore_1
      64: goto          70
      67: goto          17
      70: iload_1
      71: ifeq          85
      74: getstatic     #24                 // Field LOG:Lorg/slf4j/Logger;
      77: ldc           #25                 // String Unique index for Grok patterns already exists, skipping migration.
      79: invokeinterface #26,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      84: return
      85: new           #27                 // class java/util/HashSet
      88: dup
      89: invokespecial #28                 // Method java/util/HashSet."<init>":()V
      92: astore_2
      93: new           #29                 // class java/util/HashMap
      96: dup
      97: invokespecial #30                 // Method java/util/HashMap."<init>":()V
     100: astore_3
     101: aload_0
     102: getfield      #8                  // Field collection:Lcom/mongodb/client/MongoCollection;
     105: invokeinterface #31,  1           // InterfaceMethod com/mongodb/client/MongoCollection.find:()Lcom/mongodb/client/FindIterable;
     110: invokeinterface #32,  1           // InterfaceMethod com/mongodb/client/FindIterable.iterator:()Lcom/mongodb/client/MongoCursor;
     115: astore        4
     117: aload         4
     119: invokeinterface #14,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     124: ifeq          261
     127: aload         4
     129: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     134: checkcast     #16                 // class org/bson/Document
     137: astore        5
     139: aload         5
     141: ldc           #33                 // String _id
     143: invokevirtual #34                 // Method org/bson/Document.getObjectId:(Ljava/lang/Object;)Lorg/bson/types/ObjectId;
     146: astore        6
     148: aload         5
     150: ldc           #18                 // String name
     152: invokevirtual #19                 // Method org/bson/Document.getString:(Ljava/lang/Object;)Ljava/lang/String;
     155: astore        7
     157: aload         5
     159: ldc           #35                 // String pattern
     161: invokevirtual #19                 // Method org/bson/Document.getString:(Ljava/lang/Object;)Ljava/lang/String;
     164: astore        8
     166: aload_2
     167: aload         7
     169: invokeinterface #36,  2           // InterfaceMethod java/util/Collection.contains:(Ljava/lang/Object;)Z
     174: ifeq          220
     177: getstatic     #24                 // Field LOG:Lorg/slf4j/Logger;
     180: ldc           #37                 // String Marking duplicate Grok pattern <{}> for removal: {}\t{}
     182: iconst_3
     183: anewarray     #38                 // class java/lang/Object
     186: dup
     187: iconst_0
     188: aload         6
     190: aastore
     191: dup
     192: iconst_1
     193: aload         7
     195: aastore
     196: dup
     197: iconst_2
     198: aload         8
     200: aastore
     201: invokeinterface #39,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;[Ljava/lang/Object;)V
     206: aload_3
     207: aload         6
     209: aload         7
     211: invokeinterface #40,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     216: pop
     217: goto          258
     220: getstatic     #24                 // Field LOG:Lorg/slf4j/Logger;
     223: ldc           #41                 // String Recording Grok pattern <{}>: {}\t{}
     225: iconst_3
     226: anewarray     #38                 // class java/lang/Object
     229: dup
     230: iconst_0
     231: aload         6
     233: aastore
     234: dup
     235: iconst_1
     236: aload         7
     238: aastore
     239: dup
     240: iconst_2
     241: aload         8
     243: aastore
     244: invokeinterface #42,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;[Ljava/lang/Object;)V
     249: aload_2
     250: aload         7
     252: invokeinterface #43,  2           // InterfaceMethod java/util/Collection.add:(Ljava/lang/Object;)Z
     257: pop
     258: goto          117
     261: aload_3
     262: invokeinterface #44,  1           // InterfaceMethod java/util/Map.keySet:()Ljava/util/Set;
     267: invokeinterface #45,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     272: astore        4
     274: aload         4
     276: invokeinterface #14,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     281: ifeq          328
     284: aload         4
     286: invokeinterface #15,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     291: checkcast     #46                 // class org/bson/types/ObjectId
     294: astore        5
     296: getstatic     #24                 // Field LOG:Lorg/slf4j/Logger;
     299: ldc           #47                 // String Deleting duplicate Grok pattern with ID <{}>
     301: aload         5
     303: invokeinterface #48,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     308: aload_0
     309: getfield      #8                  // Field collection:Lcom/mongodb/client/MongoCollection;
     312: ldc           #33                 // String _id
     314: aload         5
     316: invokestatic  #49                 // Method com/mongodb/client/model/Filters.eq:(Ljava/lang/String;Ljava/lang/Object;)Lorg/bson/conversions/Bson;
     319: invokeinterface #50,  2           // InterfaceMethod com/mongodb/client/MongoCollection.deleteOne:(Lorg/bson/conversions/Bson;)Lcom/mongodb/client/result/DeleteResult;
     324: pop
     325: goto          274
     328: new           #51                 // class com/mongodb/client/model/IndexOptions
     331: dup
     332: invokespecial #52                 // Method com/mongodb/client/model/IndexOptions."<init>":()V
     335: ldc           #17                 // String idx_name_asc_unique
     337: invokevirtual #53                 // Method com/mongodb/client/model/IndexOptions.name:(Ljava/lang/String;)Lcom/mongodb/client/model/IndexOptions;
     340: iconst_1
     341: invokevirtual #54                 // Method com/mongodb/client/model/IndexOptions.unique:(Z)Lcom/mongodb/client/model/IndexOptions;
     344: astore        4
     346: aload_0
     347: getfield      #8                  // Field collection:Lcom/mongodb/client/MongoCollection;
     350: iconst_1
     351: anewarray     #55                 // class java/lang/String
     354: dup
     355: iconst_0
     356: ldc           #18                 // String name
     358: aastore
     359: invokestatic  #56                 // Method com/mongodb/client/model/Indexes.ascending:([Ljava/lang/String;)Lorg/bson/conversions/Bson;
     362: aload         4
     364: invokeinterface #57,  3           // InterfaceMethod com/mongodb/client/MongoCollection.createIndex:(Lorg/bson/conversions/Bson;Lcom/mongodb/client/model/IndexOptions;)Ljava/lang/String;
     369: pop
     370: aload_3
     371: invokeinterface #58,  1           // InterfaceMethod java/util/Map.isEmpty:()Z
     376: ifne          398
     379: aload_0
     380: getfield      #9                  // Field clusterEventBus:Lorg/graylog2/events/ClusterEventBus;
     383: aload_3
     384: invokeinterface #59,  1           // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
     389: invokestatic  #60                 // Method com/google/common/collect/ImmutableSet.copyOf:(Ljava/util/Collection;)Lcom/google/common/collect/ImmutableSet;
     392: invokestatic  #61                 // Method org/graylog2/grok/GrokPatternsDeletedEvent.create:(Ljava/util/Set;)Lorg/graylog2/grok/GrokPatternsDeletedEvent;
     395: invokevirtual #62                 // Method org/graylog2/events/ClusterEventBus.post:(Ljava/lang/Object;)V
     398: aload_0
     399: iconst_1
     400: putfield      #7                  // Field indexCreated:Z
     403: return

  boolean isIndexCreated();
    Code:
       0: aload_0
       1: getfield      #7                  // Field indexCreated:Z
       4: ireturn

  static {};
    Code:
       0: ldc           #63                 // class org/graylog2/migrations/V2018070614390000_EnforceUniqueGrokPatterns
       2: invokestatic  #64                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #24                 // Field LOG:Lorg/slf4j/Logger;
       8: return
}
