Compiled from "SessionAuthenticator.java"
public class org.graylog2.security.realm.SessionAuthenticator extends org.apache.shiro.realm.AuthenticatingRealm {
  private static final org.slf4j.Logger LOG;

  public static final java.lang.String NAME;

  public static final java.lang.String X_GRAYLOG_NO_SESSION_EXTENSION;

  private final org.graylog2.shared.users.UserService userService;

  org.graylog2.security.realm.SessionAuthenticator(org.graylog2.shared.users.UserService);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/shiro/realm/AuthenticatingRealm."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field userService:Lorg/graylog2/shared/users/UserService;
       9: aload_0
      10: new           #3                  // class org/apache/shiro/authc/credential/AllowAllCredentialsMatcher
      13: dup
      14: invokespecial #4                  // Method org/apache/shiro/authc/credential/AllowAllCredentialsMatcher."<init>":()V
      17: invokevirtual #5                  // Method setCredentialsMatcher:(Lorg/apache/shiro/authc/credential/CredentialsMatcher;)V
      20: aload_0
      21: ldc           #6                  // class org/graylog2/shared/security/SessionIdToken
      23: invokevirtual #7                  // Method setAuthenticationTokenClass:(Ljava/lang/Class;)V
      26: aload_0
      27: iconst_0
      28: invokevirtual #8                  // Method setCachingEnabled:(Z)V
      31: return

  protected org.apache.shiro.authc.AuthenticationInfo doGetAuthenticationInfo(org.apache.shiro.authc.AuthenticationToken) throws org.apache.shiro.authc.AuthenticationException;
    Code:
       0: aload_1
       1: checkcast     #6                  // class org/graylog2/shared/security/SessionIdToken
       4: astore_2
       5: new           #9                  // class org/apache/shiro/subject/Subject$Builder
       8: dup
       9: invokespecial #10                 // Method org/apache/shiro/subject/Subject$Builder."<init>":()V
      12: aload_2
      13: invokevirtual #11                 // Method org/graylog2/shared/security/SessionIdToken.getSessionId:()Ljava/lang/String;
      16: invokevirtual #12                 // Method org/apache/shiro/subject/Subject$Builder.sessionId:(Ljava/io/Serializable;)Lorg/apache/shiro/subject/Subject$Builder;
      19: invokevirtual #13                 // Method org/apache/shiro/subject/Subject$Builder.buildSubject:()Lorg/apache/shiro/subject/Subject;
      22: astore_3
      23: aload_3
      24: iconst_0
      25: invokeinterface #14,  2           // InterfaceMethod org/apache/shiro/subject/Subject.getSession:(Z)Lorg/apache/shiro/session/Session;
      30: astore        4
      32: aload         4
      34: ifnonnull     53
      37: getstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
      40: ldc           #16                 // String Invalid session {}. Either it has expired or did not exist.
      42: aload_2
      43: invokevirtual #11                 // Method org/graylog2/shared/security/SessionIdToken.getSessionId:()Ljava/lang/String;
      46: invokeinterface #17,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      51: aconst_null
      52: areturn
      53: aload_3
      54: invokeinterface #18,  1           // InterfaceMethod org/apache/shiro/subject/Subject.getPrincipal:()Ljava/lang/Object;
      59: astore        5
      61: aload_0
      62: getfield      #2                  // Field userService:Lorg/graylog2/shared/users/UserService;
      65: aload         5
      67: invokestatic  #19                 // Method java/lang/String.valueOf:(Ljava/lang/Object;)Ljava/lang/String;
      70: invokeinterface #20,  2           // InterfaceMethod org/graylog2/shared/users/UserService.load:(Ljava/lang/String;)Lorg/graylog2/plugin/database/users/User;
      75: astore        6
      77: aload         6
      79: ifnonnull     100
      82: getstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
      85: ldc           #21                 // String No user named {} found for session {}
      87: aload         5
      89: aload_2
      90: invokevirtual #11                 // Method org/graylog2/shared/security/SessionIdToken.getSessionId:()Ljava/lang/String;
      93: invokeinterface #22,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      98: aconst_null
      99: areturn
     100: getstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
     103: invokeinterface #23,  1           // InterfaceMethod org/slf4j/Logger.isDebugEnabled:()Z
     108: ifeq          130
     111: getstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
     114: ldc           #24                 // String Found session {} for user name {}
     116: aload         4
     118: invokeinterface #25,  1           // InterfaceMethod org/apache/shiro/session/Session.getId:()Ljava/io/Serializable;
     123: aload         5
     125: invokeinterface #22,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     130: ldc           #27                 // String REQUEST_HEADERS
     132: invokestatic  #28                 // Method org/apache/shiro/util/ThreadContext.get:(Ljava/lang/Object;)Ljava/lang/Object;
     135: checkcast     #29                 // class javax/ws/rs/core/MultivaluedMap
     138: astore        7
     140: aload         7
     142: ifnull        175
     145: ldc           #30                 // String true
     147: aload         7
     149: ldc           #32                 // String X-Graylog-No-Session-Extension
     151: invokeinterface #33,  2           // InterfaceMethod javax/ws/rs/core/MultivaluedMap.getFirst:(Ljava/lang/Object;)Ljava/lang/Object;
     156: checkcast     #34                 // class java/lang/String
     159: invokevirtual #35                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     162: ifne          175
     165: aload         4
     167: invokeinterface #36,  1           // InterfaceMethod org/apache/shiro/session/Session.touch:()V
     172: goto          185
     175: getstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
     178: ldc           #37                 // String Not extending session because the request indicated not to.
     180: invokeinterface #38,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     185: aload_3
     186: invokestatic  #39                 // Method org/apache/shiro/util/ThreadContext.bind:(Lorg/apache/shiro/subject/Subject;)V
     189: new           #40                 // class org/apache/shiro/authc/SimpleAccount
     192: dup
     193: aload         6
     195: invokeinterface #41,  1           // InterfaceMethod org/graylog2/plugin/database/users/User.getName:()Ljava/lang/String;
     200: aconst_null
     201: ldc           #42                 // String session authenticator
     203: invokespecial #43                 // Method org/apache/shiro/authc/SimpleAccount."<init>":(Ljava/lang/Object;Ljava/lang/Object;Ljava/lang/String;)V
     206: areturn

  static {};
    Code:
       0: ldc           #31                 // class org/graylog2/security/realm/SessionAuthenticator
       2: invokestatic  #44                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #15                 // Field LOG:Lorg/slf4j/Logger;
       8: return
}
