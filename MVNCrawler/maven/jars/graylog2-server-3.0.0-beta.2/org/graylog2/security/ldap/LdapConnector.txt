Compiled from "LdapConnector.java"
public class org.graylog2.security.ldap.LdapConnector {
  private static final org.slf4j.Logger LOG;

  private static final java.lang.String ATTRIBUTE_UNIQUE_MEMBER;

  private static final java.lang.String ATTRIBUTE_MEMBER;

  private static final java.lang.String ATTRIBUTE_MEMBER_UID;

  private final int connectionTimeout;

  public org.graylog2.security.ldap.LdapConnector(int);
    Code:
       0: aload_0
       1: invokespecial #4                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iload_1
       6: putfield      #5                  // Field connectionTimeout:I
       9: return

  public org.apache.directory.ldap.client.api.LdapNetworkConnection connect(org.apache.directory.ldap.client.api.LdapConnectionConfig) throws org.apache.directory.api.ldap.model.exception.LdapException;
    Code:
       0: new           #6                  // class org/apache/directory/ldap/client/api/LdapNetworkConnection
       3: dup
       4: aload_1
       5: invokespecial #7                  // Method org/apache/directory/ldap/client/api/LdapNetworkConnection."<init>":(Lorg/apache/directory/ldap/client/api/LdapConnectionConfig;)V
       8: astore_2
       9: aload_2
      10: aload_0
      11: getfield      #5                  // Field connectionTimeout:I
      14: i2l
      15: invokevirtual #8                  // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.setTimeOut:(J)V
      18: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      21: invokeinterface #10,  1           // InterfaceMethod org/slf4j/Logger.isTraceEnabled:()Z
      26: ifeq          67
      29: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      32: ldc           #11                 // String Connecting to LDAP server {}:{}, binding with user {}
      34: iconst_3
      35: anewarray     #12                 // class java/lang/Object
      38: dup
      39: iconst_0
      40: aload_1
      41: invokevirtual #13                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.getLdapHost:()Ljava/lang/String;
      44: aastore
      45: dup
      46: iconst_1
      47: aload_1
      48: invokevirtual #14                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.getLdapPort:()I
      51: invokestatic  #15                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      54: aastore
      55: dup
      56: iconst_2
      57: aload_1
      58: invokevirtual #16                 // Method org/apache/directory/ldap/client/api/LdapConnectionConfig.getName:()Ljava/lang/String;
      61: aastore
      62: invokeinterface #17,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;[Ljava/lang/Object;)V
      67: new           #18                 // class com/google/common/util/concurrent/ThreadFactoryBuilder
      70: dup
      71: invokespecial #19                 // Method com/google/common/util/concurrent/ThreadFactoryBuilder."<init>":()V
      74: ldc           #20                 // String ldap-connector-%d
      76: invokevirtual #21                 // Method com/google/common/util/concurrent/ThreadFactoryBuilder.setNameFormat:(Ljava/lang/String;)Lcom/google/common/util/concurrent/ThreadFactoryBuilder;
      79: invokevirtual #22                 // Method com/google/common/util/concurrent/ThreadFactoryBuilder.build:()Ljava/util/concurrent/ThreadFactory;
      82: astore_3
      83: aload_3
      84: invokestatic  #23                 // Method java/util/concurrent/Executors.newSingleThreadExecutor:(Ljava/util/concurrent/ThreadFactory;)Ljava/util/concurrent/ExecutorService;
      87: invokestatic  #24                 // Method com/google/common/util/concurrent/SimpleTimeLimiter.create:(Ljava/util/concurrent/ExecutorService;)Lcom/google/common/util/concurrent/SimpleTimeLimiter;
      90: astore        4
      92: aload         4
      94: new           #25                 // class org/graylog2/security/ldap/LdapConnector$1
      97: dup
      98: aload_0
      99: aload_2
     100: invokespecial #26                 // Method org/graylog2/security/ldap/LdapConnector$1."<init>":(Lorg/graylog2/security/ldap/LdapConnector;Lorg/apache/directory/ldap/client/api/LdapNetworkConnection;)V
     103: ldc           #27                 // class java/util/concurrent/Callable
     105: aload_0
     106: getfield      #5                  // Field connectionTimeout:I
     109: i2l
     110: getstatic     #28                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
     113: invokevirtual #29                 // Method com/google/common/util/concurrent/SimpleTimeLimiter.newProxy:(Ljava/lang/Object;Ljava/lang/Class;JLjava/util/concurrent/TimeUnit;)Ljava/lang/Object;
     116: checkcast     #27                 // class java/util/concurrent/Callable
     119: astore        5
     121: aload         5
     123: invokeinterface #30,  1           // InterfaceMethod java/util/concurrent/Callable.call:()Ljava/lang/Object;
     128: checkcast     #31                 // class java/lang/Boolean
     131: astore        6
     133: aload         6
     135: invokevirtual #32                 // Method java/lang/Boolean.booleanValue:()Z
     138: ifne          143
     141: aconst_null
     142: areturn
     143: goto          194
     146: astore        6
     148: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     151: ldc           #34                 // String Timed out connecting to LDAP server
     153: aload         6
     155: invokeinterface #35,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     160: new           #36                 // class org/apache/directory/api/ldap/model/exception/LdapException
     163: dup
     164: ldc           #37                 // String Could not connect to LDAP server
     166: aload         6
     168: invokevirtual #38                 // Method com/google/common/util/concurrent/UncheckedTimeoutException.getCause:()Ljava/lang/Throwable;
     171: invokespecial #39                 // Method org/apache/directory/api/ldap/model/exception/LdapException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     174: athrow
     175: astore        6
     177: aload         6
     179: athrow
     180: astore        6
     182: new           #36                 // class org/apache/directory/api/ldap/model/exception/LdapException
     185: dup
     186: ldc           #41                 // String Unexpected error connecting to LDAP
     188: aload         6
     190: invokespecial #39                 // Method org/apache/directory/api/ldap/model/exception/LdapException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     193: athrow
     194: aload_2
     195: invokevirtual #42                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.bind:()V
     198: aload_2
     199: areturn
    Exception table:
       from    to  target type
         121   142   146   Class com/google/common/util/concurrent/UncheckedTimeoutException
         121   142   175   Class org/apache/directory/api/ldap/model/exception/LdapException
         121   142   180   Class java/lang/Exception

  public org.graylog2.shared.security.ldap.LdapEntry search(org.apache.directory.ldap.client.api.LdapNetworkConnection, java.lang.String, java.lang.String, java.lang.String, java.lang.String, boolean, java.lang.String, java.lang.String, java.lang.String) throws org.apache.directory.api.ldap.model.exception.LdapException, org.apache.directory.api.ldap.model.cursor.CursorException;
    Code:
       0: new           #43                 // class org/graylog2/shared/security/ldap/LdapEntry
       3: dup
       4: invokespecial #44                 // Method org/graylog2/shared/security/ldap/LdapEntry."<init>":()V
       7: astore        10
       9: invokestatic  #45                 // Method com/google/common/collect/Sets.newHashSet:()Ljava/util/HashSet;
      12: astore        11
      14: new           #46                 // class java/text/MessageFormat
      17: dup
      18: aload_3
      19: getstatic     #47                 // Field java/util/Locale.ENGLISH:Ljava/util/Locale;
      22: invokespecial #48                 // Method java/text/MessageFormat."<init>":(Ljava/lang/String;Ljava/util/Locale;)V
      25: iconst_1
      26: anewarray     #12                 // class java/lang/Object
      29: dup
      30: iconst_0
      31: aload_0
      32: aload         5
      34: invokespecial #49                 // Method sanitizePrincipal:(Ljava/lang/String;)Ljava/lang/String;
      37: aastore
      38: invokevirtual #50                 // Method java/text/MessageFormat.format:(Ljava/lang/Object;)Ljava/lang/String;
      41: astore        12
      43: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      46: invokeinterface #10,  1           // InterfaceMethod org/slf4j/Logger.isTraceEnabled:()Z
      51: ifeq          92
      54: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      57: ldc           #51                 // String Search {} for {}, starting at {}
      59: iconst_3
      60: anewarray     #12                 // class java/lang/Object
      63: dup
      64: iconst_0
      65: iload         6
      67: ifeq          75
      70: ldc           #52                 // String ActiveDirectory
      72: goto          77
      75: ldc           #53                 // String LDAP
      77: aastore
      78: dup
      79: iconst_1
      80: aload         12
      82: aastore
      83: dup
      84: iconst_2
      85: aload_2
      86: aastore
      87: invokeinterface #17,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;[Ljava/lang/Object;)V
      92: aload_1
      93: aload_2
      94: aload         12
      96: getstatic     #54                 // Field org/apache/directory/api/ldap/model/message/SearchScope.SUBTREE:Lorg/apache/directory/api/ldap/model/message/SearchScope;
      99: bipush        9
     101: anewarray     #55                 // class java/lang/String
     104: dup
     105: iconst_0
     106: aload         8
     108: aastore
     109: dup
     110: iconst_1
     111: aload         4
     113: aastore
     114: dup
     115: iconst_2
     116: ldc           #56                 // String dn
     118: aastore
     119: dup
     120: iconst_3
     121: ldc           #57                 // String uid
     123: aastore
     124: dup
     125: iconst_4
     126: ldc           #58                 // String userPrincipalName
     128: aastore
     129: dup
     130: iconst_5
     131: ldc           #59                 // String mail
     133: aastore
     134: dup
     135: bipush        6
     137: ldc           #60                 // String rfc822Mailbox
     139: aastore
     140: dup
     141: bipush        7
     143: ldc           #61                 // String memberOf
     145: aastore
     146: dup
     147: bipush        8
     149: ldc           #62                 // String isMemberOf
     151: aastore
     152: invokevirtual #63                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.search:(Ljava/lang/String;Ljava/lang/String;Lorg/apache/directory/api/ldap/model/message/SearchScope;[Ljava/lang/String;)Lorg/apache/directory/api/ldap/model/cursor/EntryCursor;
     155: astore        13
     157: aconst_null
     158: astore        14
     160: aload         13
     162: invokeinterface #64,  1           // InterfaceMethod org/apache/directory/api/ldap/model/cursor/EntryCursor.iterator:()Ljava/util/Iterator;
     167: astore        15
     169: aload         15
     171: invokeinterface #65,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     176: ifeq          417
     179: aload         15
     181: invokeinterface #66,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     186: checkcast     #67                 // class org/apache/directory/api/ldap/model/entry/Entry
     189: astore        16
     191: aload         10
     193: aload         16
     195: invokeinterface #68,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.getDn:()Lorg/apache/directory/api/ldap/model/name/Dn;
     200: invokevirtual #69                 // Method org/apache/directory/api/ldap/model/name/Dn.getName:()Ljava/lang/String;
     203: invokevirtual #70                 // Method org/graylog2/shared/security/ldap/LdapEntry.setDn:(Ljava/lang/String;)V
     206: iload         6
     208: ifne          226
     211: aload         10
     213: aload         16
     215: invokeinterface #68,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.getDn:()Lorg/apache/directory/api/ldap/model/name/Dn;
     220: invokevirtual #69                 // Method org/apache/directory/api/ldap/model/name/Dn.getName:()Ljava/lang/String;
     223: invokevirtual #71                 // Method org/graylog2/shared/security/ldap/LdapEntry.setBindPrincipal:(Ljava/lang/String;)V
     226: aload         16
     228: invokeinterface #72,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.getAttributes:()Ljava/util/Collection;
     233: invokeinterface #73,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     238: astore        17
     240: aload         17
     242: invokeinterface #65,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     247: ifeq          414
     250: aload         17
     252: invokeinterface #66,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     257: checkcast     #74                 // class org/apache/directory/api/ldap/model/entry/Attribute
     260: astore        18
     262: iload         6
     264: ifeq          294
     267: ldc           #58                 // String userPrincipalName
     269: aload         18
     271: invokeinterface #75,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.getId:()Ljava/lang/String;
     276: invokevirtual #76                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     279: ifeq          294
     282: aload         10
     284: aload         18
     286: invokeinterface #77,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.getString:()Ljava/lang/String;
     291: invokevirtual #71                 // Method org/graylog2/shared/security/ldap/LdapEntry.setBindPrincipal:(Ljava/lang/String;)V
     294: aload         18
     296: invokeinterface #78,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.isHumanReadable:()Z
     301: ifeq          332
     304: aload         10
     306: aload         18
     308: invokeinterface #75,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.getId:()Ljava/lang/String;
     313: ldc           #79                 // String ,
     315: invokestatic  #80                 // Method com/google/common/base/Joiner.on:(Ljava/lang/String;)Lcom/google/common/base/Joiner;
     318: aload         18
     320: invokeinterface #81,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.iterator:()Ljava/util/Iterator;
     325: invokevirtual #82                 // Method com/google/common/base/Joiner.join:(Ljava/util/Iterator;)Ljava/lang/String;
     328: invokevirtual #83                 // Method org/graylog2/shared/security/ldap/LdapEntry.put:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     331: pop
     332: ldc           #61                 // String memberOf
     334: aload         18
     336: invokeinterface #75,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.getId:()Ljava/lang/String;
     341: invokevirtual #76                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     344: ifne          362
     347: ldc           #62                 // String isMemberOf
     349: aload         18
     351: invokeinterface #75,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.getId:()Ljava/lang/String;
     356: invokevirtual #76                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     359: ifeq          411
     362: aload         18
     364: invokeinterface #81,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.iterator:()Ljava/util/Iterator;
     369: astore        19
     371: aload         19
     373: invokeinterface #65,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     378: ifeq          411
     381: aload         19
     383: invokeinterface #66,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     388: checkcast     #84                 // class org/apache/directory/api/ldap/model/entry/Value
     391: astore        20
     393: aload         11
     395: aload         20
     397: invokeinterface #85,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Value.getString:()Ljava/lang/String;
     402: invokeinterface #86,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     407: pop
     408: goto          371
     411: goto          240
     414: goto          447
     417: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     420: ldc           #87                 // String No LDAP entry found for filter {}
     422: aload         12
     424: invokeinterface #88,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
     429: aconst_null
     430: astore        16
     432: aload         13
     434: ifnull        444
     437: aload         14
     439: aload         13
     441: invokestatic  #89                 // Method $closeResource:(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V
     444: aload         16
     446: areturn
     447: aload         11
     449: invokeinterface #90,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
     454: ifne          657
     457: aload         7
     459: invokestatic  #91                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     462: ifne          657
     465: aload         8
     467: invokestatic  #91                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     470: ifne          657
     473: aload         11
     475: invokeinterface #92,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     480: astore        16
     482: aload         16
     484: invokeinterface #65,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     489: ifeq          640
     492: aload         16
     494: invokeinterface #66,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     499: checkcast     #55                 // class java/lang/String
     502: astore        17
     504: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     507: ldc           #93                 // String Looking up group {}
     509: aload         17
     511: invokeinterface #88,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
     516: aload_1
     517: aload         17
     519: iconst_1
     520: anewarray     #55                 // class java/lang/String
     523: dup
     524: iconst_0
     525: aload         8
     527: aastore
     528: invokevirtual #94                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.lookup:(Ljava/lang/String;[Ljava/lang/String;)Lorg/apache/directory/api/ldap/model/entry/Entry;
     531: astore        18
     533: aload         18
     535: ifnull        590
     538: aload         18
     540: aload         8
     542: invokeinterface #95,  2           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.get:(Ljava/lang/String;)Lorg/apache/directory/api/ldap/model/entry/Attribute;
     547: astore        19
     549: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     552: ldc           #96                 // String Resolved {} to group {}
     554: aload         17
     556: aload         19
     558: invokeinterface #97,  4           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     563: aload         19
     565: ifnull        587
     568: aload         19
     570: invokeinterface #77,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.getString:()Ljava/lang/String;
     575: astore        20
     577: aload         10
     579: aload         20
     581: invokestatic  #98                 // Method java/util/Collections.singleton:(Ljava/lang/Object;)Ljava/util/Set;
     584: invokevirtual #99                 // Method org/graylog2/shared/security/ldap/LdapEntry.addGroups:(Ljava/util/Collection;)V
     587: goto          602
     590: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     593: ldc           #100                // String Unable to lookup group: {}
     595: aload         17
     597: invokeinterface #101,  3          // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
     602: goto          637
     605: astore        18
     607: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     610: new           #102                // class java/lang/StringBuilder
     613: dup
     614: invokespecial #103                // Method java/lang/StringBuilder."<init>":()V
     617: ldc           #104                // String Error while looking up group
     619: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     622: aload         17
     624: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     627: invokevirtual #106                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     630: aload         18
     632: invokeinterface #107,  3          // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     637: goto          482
     640: goto          657
     643: astore        16
     645: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     648: ldc           #108                // String Unexpected error during LDAP group resolution
     650: aload         16
     652: invokeinterface #35,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     657: aload         10
     659: invokevirtual #109                // Method org/graylog2/shared/security/ldap/LdapEntry.getGroups:()Ljava/util/Set;
     662: invokeinterface #90,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
     667: ifeq          747
     670: aload         7
     672: invokestatic  #91                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     675: ifne          747
     678: aload         8
     680: invokestatic  #91                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     683: ifne          747
     686: aload         9
     688: invokestatic  #91                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     691: ifne          747
     694: aload         10
     696: aload_0
     697: aload_1
     698: aload         7
     700: aload         9
     702: aload         8
     704: aload         10
     706: invokevirtual #110                // Method findGroups:(Lorg/apache/directory/ldap/client/api/LdapNetworkConnection;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Lorg/graylog2/shared/security/ldap/LdapEntry;)Ljava/util/Set;
     709: invokevirtual #99                 // Method org/graylog2/shared/security/ldap/LdapEntry.addGroups:(Ljava/util/Collection;)V
     712: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     715: ldc           #111                // String LDAP search found entry for DN {} with search filter {}: {}
     717: iconst_3
     718: anewarray     #12                 // class java/lang/Object
     721: dup
     722: iconst_0
     723: aload         10
     725: invokevirtual #112                // Method org/graylog2/shared/security/ldap/LdapEntry.getDn:()Ljava/lang/String;
     728: aastore
     729: dup
     730: iconst_1
     731: aload         12
     733: aastore
     734: dup
     735: iconst_2
     736: aload         10
     738: aastore
     739: invokeinterface #17,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;[Ljava/lang/Object;)V
     744: goto          767
     747: aload         11
     749: invokeinterface #90,  1           // InterfaceMethod java/util/Set.isEmpty:()Z
     754: ifeq          767
     757: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     760: ldc           #113                // String LDAP group search base, id attribute or object class missing, not iterating over LDAP groups.
     762: invokeinterface #114,  2          // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     767: aload         10
     769: astore        16
     771: aload         13
     773: ifnull        783
     776: aload         14
     778: aload         13
     780: invokestatic  #89                 // Method $closeResource:(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V
     783: aload         16
     785: areturn
     786: astore        15
     788: aload         15
     790: astore        14
     792: aload         15
     794: athrow
     795: astore        21
     797: aload         13
     799: ifnull        809
     802: aload         14
     804: aload         13
     806: invokestatic  #89                 // Method $closeResource:(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V
     809: aload         21
     811: athrow
     812: astore        13
     814: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     817: ldc           #116                // String Error while closing cursor
     819: aload         13
     821: invokeinterface #117,  3          // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
     826: aconst_null
     827: areturn
    Exception table:
       from    to  target type
         516   602   605   Class org/apache/directory/api/ldap/model/exception/LdapException
         473   640   643   Class java/lang/Exception
         160   432   786   Class java/lang/Throwable
         447   771   786   Class java/lang/Throwable
         160   432   795   any
         447   771   795   any
         786   797   795   any
          92   444   812   Class java/io/IOException
         447   783   812   Class java/io/IOException
         786   812   812   Class java/io/IOException

  public java.util.Set<java.lang.String> findGroups(org.apache.directory.ldap.client.api.LdapNetworkConnection, java.lang.String, java.lang.String, java.lang.String, org.graylog2.shared.security.ldap.LdapEntry);
    Code:
       0: invokestatic  #45                 // Method com/google/common/collect/Sets.newHashSet:()Ljava/util/HashSet;
       3: astore        6
       5: aload_1
       6: aload_2
       7: aload_3
       8: getstatic     #54                 // Field org/apache/directory/api/ldap/model/message/SearchScope.SUBTREE:Lorg/apache/directory/api/ldap/model/message/SearchScope;
      11: iconst_5
      12: anewarray     #55                 // class java/lang/String
      15: dup
      16: iconst_0
      17: ldc           #118                // String objectClass
      19: aastore
      20: dup
      21: iconst_1
      22: ldc           #120                // String uniqueMember
      24: aastore
      25: dup
      26: iconst_2
      27: ldc           #121                // String member
      29: aastore
      30: dup
      31: iconst_3
      32: ldc           #122                // String memberUid
      34: aastore
      35: dup
      36: iconst_4
      37: aload         4
      39: aastore
      40: invokevirtual #63                 // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.search:(Ljava/lang/String;Ljava/lang/String;Lorg/apache/directory/api/ldap/model/message/SearchScope;[Ljava/lang/String;)Lorg/apache/directory/api/ldap/model/cursor/EntryCursor;
      43: astore        7
      45: aconst_null
      46: astore        8
      48: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      51: ldc           #123                // String LDAP search for groups: {} starting at {}
      53: aload_3
      54: aload_2
      55: invokeinterface #97,  4           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      60: aload         7
      62: invokeinterface #64,  1           // InterfaceMethod org/apache/directory/api/ldap/model/cursor/EntryCursor.iterator:()Ljava/util/Iterator;
      67: astore        9
      69: aload         9
      71: invokeinterface #65,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      76: ifeq          537
      79: aload         9
      81: invokeinterface #66,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      86: checkcast     #67                 // class org/apache/directory/api/ldap/model/entry/Entry
      89: astore        10
      91: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      94: invokeinterface #10,  1           // InterfaceMethod org/slf4j/Logger.isTraceEnabled:()Z
      99: ifeq          121
     102: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     105: ldc           #124                // String Group Entry: {}
     107: aload         10
     109: ldc           #125                // String
     111: invokeinterface #126,  2          // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.toString:(Ljava/lang/String;)Ljava/lang/String;
     116: invokeinterface #88,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
     121: aload         10
     123: iconst_1
     124: anewarray     #55                 // class java/lang/String
     127: dup
     128: iconst_0
     129: aload         4
     131: aastore
     132: invokeinterface #127,  2          // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.containsAttribute:([Ljava/lang/String;)Z
     137: ifne          157
     140: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     143: ldc           #128                // String Unknown group id attribute {}, skipping group entry {}
     145: aload         4
     147: aload         10
     149: invokeinterface #129,  4          // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     154: goto          69
     157: aload         10
     159: aload         4
     161: invokeinterface #95,  2           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.get:(Ljava/lang/String;)Lorg/apache/directory/api/ldap/model/entry/Attribute;
     166: invokeinterface #77,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.getString:()Ljava/lang/String;
     171: astore        11
     173: aload         5
     175: ifnonnull     191
     178: aload         6
     180: aload         11
     182: invokeinterface #86,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     187: pop
     188: goto          534
     191: aload         10
     193: iconst_1
     194: anewarray     #55                 // class java/lang/String
     197: dup
     198: iconst_0
     199: ldc           #130                // String groupOfUniqueNames
     201: aastore
     202: invokeinterface #131,  2          // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.hasObjectClass:([Ljava/lang/String;)Z
     207: ifeq          217
     210: ldc           #120                // String uniqueMember
     212: astore        12
     214: goto          356
     217: aload         10
     219: iconst_1
     220: anewarray     #55                 // class java/lang/String
     223: dup
     224: iconst_0
     225: ldc           #132                // String groupOfNames
     227: aastore
     228: invokeinterface #131,  2          // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.hasObjectClass:([Ljava/lang/String;)Z
     233: ifne          255
     236: aload         10
     238: iconst_1
     239: anewarray     #55                 // class java/lang/String
     242: dup
     243: iconst_0
     244: ldc           #133                // String group
     246: aastore
     247: invokeinterface #131,  2          // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.hasObjectClass:([Ljava/lang/String;)Z
     252: ifeq          262
     255: ldc           #121                // String member
     257: astore        12
     259: goto          356
     262: aload         10
     264: iconst_1
     265: anewarray     #55                 // class java/lang/String
     268: dup
     269: iconst_0
     270: ldc           #134                // String posixGroup
     272: aastore
     273: invokeinterface #131,  2          // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.hasObjectClass:([Ljava/lang/String;)Z
     278: ifeq          288
     281: ldc           #122                // String memberUid
     283: astore        12
     285: goto          356
     288: aload         10
     290: iconst_1
     291: anewarray     #55                 // class java/lang/String
     294: dup
     295: iconst_0
     296: ldc           #120                // String uniqueMember
     298: aastore
     299: invokeinterface #127,  2          // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.containsAttribute:([Ljava/lang/String;)Z
     304: ifeq          314
     307: ldc           #120                // String uniqueMember
     309: astore        12
     311: goto          344
     314: aload         10
     316: iconst_1
     317: anewarray     #55                 // class java/lang/String
     320: dup
     321: iconst_0
     322: ldc           #122                // String memberUid
     324: aastore
     325: invokeinterface #127,  2          // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.containsAttribute:([Ljava/lang/String;)Z
     330: ifeq          340
     333: ldc           #122                // String memberUid
     335: astore        12
     337: goto          344
     340: ldc           #121                // String member
     342: astore        12
     344: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     347: ldc           #135                // String Unable to auto-detect the LDAP group object class, assuming \'{}\' is the correct attribute.
     349: aload         12
     351: invokeinterface #136,  3          // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
     356: aload         10
     358: aload         12
     360: invokeinterface #95,  2           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Entry.get:(Ljava/lang/String;)Lorg/apache/directory/api/ldap/model/entry/Attribute;
     365: astore        13
     367: aload         13
     369: ifnull        534
     372: aload_0
     373: aload         5
     375: invokevirtual #112                // Method org/graylog2/shared/security/ldap/LdapEntry.getDn:()Ljava/lang/String;
     378: invokespecial #137                // Method normalizedDn:(Ljava/lang/String;)Ljava/lang/String;
     381: astore        14
     383: aload         5
     385: ldc           #57                 // String uid
     387: invokevirtual #138                // Method org/graylog2/shared/security/ldap/LdapEntry.get:(Ljava/lang/String;)Ljava/lang/String;
     390: astore        15
     392: aload         13
     394: invokeinterface #81,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Attribute.iterator:()Ljava/util/Iterator;
     399: astore        16
     401: aload         16
     403: invokeinterface #65,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     408: ifeq          534
     411: aload         16
     413: invokeinterface #66,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     418: checkcast     #84                 // class org/apache/directory/api/ldap/model/entry/Value
     421: astore        17
     423: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     426: ldc           #139                // String DN {} == {} member?
     428: aload         14
     430: aload         17
     432: invokeinterface #85,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Value.getString:()Ljava/lang/String;
     437: invokeinterface #97,  4           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     442: aload         14
     444: ifnull        479
     447: aload         14
     449: aload_0
     450: aload         17
     452: invokeinterface #85,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Value.getString:()Ljava/lang/String;
     457: invokespecial #137                // Method normalizedDn:(Ljava/lang/String;)Ljava/lang/String;
     460: invokevirtual #76                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     463: ifeq          479
     466: aload         6
     468: aload         11
     470: invokeinterface #86,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     475: pop
     476: goto          531
     479: aload         15
     481: invokestatic  #91                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
     484: ifne          531
     487: aload         15
     489: aload         17
     491: invokeinterface #85,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Value.getString:()Ljava/lang/String;
     496: invokevirtual #76                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     499: ifeq          531
     502: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     505: ldc           #140                // String UID {} == {} member?
     507: aload         15
     509: aload         17
     511: invokeinterface #85,  1           // InterfaceMethod org/apache/directory/api/ldap/model/entry/Value.getString:()Ljava/lang/String;
     516: invokeinterface #97,  4           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     521: aload         6
     523: aload         11
     525: invokeinterface #86,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     530: pop
     531: goto          401
     534: goto          69
     537: aload         7
     539: ifnull        578
     542: aload         8
     544: aload         7
     546: invokestatic  #89                 // Method $closeResource:(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V
     549: goto          578
     552: astore        9
     554: aload         9
     556: astore        8
     558: aload         9
     560: athrow
     561: astore        18
     563: aload         7
     565: ifnull        575
     568: aload         8
     570: aload         7
     572: invokestatic  #89                 // Method $closeResource:(Ljava/lang/Throwable;Ljava/lang/AutoCloseable;)V
     575: aload         18
     577: athrow
     578: goto          625
     581: astore        7
     583: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     586: new           #102                // class java/lang/StringBuilder
     589: dup
     590: invokespecial #103                // Method java/lang/StringBuilder."<init>":()V
     593: ldc           #141                // String Unable to iterate over user\'s groups, unable to perform group mapping. Graylog does not support LDAP referrals at the moment. Please see
     595: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     598: getstatic     #142                // Field org/graylog2/plugin/DocsHelper.PAGE_LDAP_TROUBLESHOOTING:Lorg/graylog2/plugin/DocsHelper;
     601: invokevirtual #143                // Method org/graylog2/plugin/DocsHelper.toString:()Ljava/lang/String;
     604: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     607: ldc           #144                // String  for more information.
     609: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     612: invokevirtual #106                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     615: aload         7
     617: invokestatic  #145                // Method org/graylog2/shared/utilities/ExceptionUtils.getRootCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
     620: invokeinterface #107,  3          // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     625: aload         6
     627: areturn
    Exception table:
       from    to  target type
          48   537   552   Class java/lang/Throwable
          48   537   561   any
         552   563   561   any
           5   578   581   Class java/lang/Exception

  private java.lang.String normalizedDn(java.lang.String);
    Code:
       0: aload_1
       1: invokestatic  #91                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
       4: ifeq          9
       7: aload_1
       8: areturn
       9: new           #146                // class org/apache/directory/api/ldap/model/name/Dn
      12: dup
      13: iconst_1
      14: anewarray     #55                 // class java/lang/String
      17: dup
      18: iconst_0
      19: aload_1
      20: aastore
      21: invokespecial #147                // Method org/apache/directory/api/ldap/model/name/Dn."<init>":([Ljava/lang/String;)V
      24: invokevirtual #148                // Method org/apache/directory/api/ldap/model/name/Dn.getNormName:()Ljava/lang/String;
      27: areturn
      28: astore_2
      29: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      32: ldc           #150                // String Invalid DN
      34: aload_2
      35: invokeinterface #117,  3          // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
      40: aload_1
      41: areturn
    Exception table:
       from    to  target type
           9    27    28   Class org/apache/directory/api/ldap/model/exception/LdapInvalidDnException

  public java.util.Set<java.lang.String> listGroups(org.apache.directory.ldap.client.api.LdapNetworkConnection, java.lang.String, java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aload         4
       6: aconst_null
       7: invokevirtual #110                // Method findGroups:(Lorg/apache/directory/ldap/client/api/LdapNetworkConnection;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Lorg/graylog2/shared/security/ldap/LdapEntry;)Ljava/util/Set;
      10: areturn

  private java.lang.String sanitizePrincipal(java.lang.String);
    Code:
       0: ldc           #151                // String
       2: astore_2
       3: iconst_0
       4: istore_3
       5: iload_3
       6: aload_1
       7: invokevirtual #152                // Method java/lang/String.length:()I
      10: if_icmpge     298
      13: aload_1
      14: iload_3
      15: invokevirtual #153                // Method java/lang/String.charAt:(I)C
      18: istore        4
      20: iload         4
      22: bipush        42
      24: if_icmpne     50
      27: new           #102                // class java/lang/StringBuilder
      30: dup
      31: invokespecial #103                // Method java/lang/StringBuilder."<init>":()V
      34: aload_2
      35: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      38: ldc           #154                // String \\2a
      40: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      43: invokevirtual #106                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      46: astore_2
      47: goto          292
      50: iload         4
      52: bipush        40
      54: if_icmpne     80
      57: new           #102                // class java/lang/StringBuilder
      60: dup
      61: invokespecial #103                // Method java/lang/StringBuilder."<init>":()V
      64: aload_2
      65: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      68: ldc           #155                // String \\28
      70: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      73: invokevirtual #106                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      76: astore_2
      77: goto          292
      80: iload         4
      82: bipush        41
      84: if_icmpne     110
      87: new           #102                // class java/lang/StringBuilder
      90: dup
      91: invokespecial #103                // Method java/lang/StringBuilder."<init>":()V
      94: aload_2
      95: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      98: ldc           #156                // String \\29
     100: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     103: invokevirtual #106                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     106: astore_2
     107: goto          292
     110: iload         4
     112: bipush        92
     114: if_icmpne     140
     117: new           #102                // class java/lang/StringBuilder
     120: dup
     121: invokespecial #103                // Method java/lang/StringBuilder."<init>":()V
     124: aload_2
     125: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     128: ldc           #157                // String \\5c
     130: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     133: invokevirtual #106                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     136: astore_2
     137: goto          292
     140: iload         4
     142: ifne          168
     145: new           #102                // class java/lang/StringBuilder
     148: dup
     149: invokespecial #103                // Method java/lang/StringBuilder."<init>":()V
     152: aload_2
     153: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     156: ldc           #158                // String \\00
     158: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     161: invokevirtual #106                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     164: astore_2
     165: goto          292
     168: iload         4
     170: bipush        127
     172: if_icmpgt     201
     175: new           #102                // class java/lang/StringBuilder
     178: dup
     179: invokespecial #103                // Method java/lang/StringBuilder."<init>":()V
     182: aload_2
     183: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     186: iload         4
     188: invokestatic  #159                // Method java/lang/String.valueOf:(C)Ljava/lang/String;
     191: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     194: invokevirtual #106                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     197: astore_2
     198: goto          292
     201: iload         4
     203: sipush        128
     206: if_icmplt     292
     209: iload         4
     211: invokestatic  #159                // Method java/lang/String.valueOf:(C)Ljava/lang/String;
     214: getstatic     #160                // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     217: invokevirtual #161                // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     220: astore        5
     222: aload         5
     224: astore        6
     226: aload         6
     228: arraylength
     229: istore        7
     231: iconst_0
     232: istore        8
     234: iload         8
     236: iload         7
     238: if_icmpge     292
     241: aload         6
     243: iload         8
     245: baload
     246: istore        9
     248: new           #102                // class java/lang/StringBuilder
     251: dup
     252: invokespecial #103                // Method java/lang/StringBuilder."<init>":()V
     255: aload_2
     256: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     259: getstatic     #47                 // Field java/util/Locale.ENGLISH:Ljava/util/Locale;
     262: ldc           #162                // String \\%02x
     264: iconst_1
     265: anewarray     #12                 // class java/lang/Object
     268: dup
     269: iconst_0
     270: iload         9
     272: invokestatic  #163                // Method java/lang/Byte.valueOf:(B)Ljava/lang/Byte;
     275: aastore
     276: invokestatic  #164                // Method java/lang/String.format:(Ljava/util/Locale;Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     279: invokevirtual #105                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     282: invokevirtual #106                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     285: astore_2
     286: iinc          8, 1
     289: goto          234
     292: iinc          3, 1
     295: goto          5
     298: aload_2
     299: areturn

  public boolean authenticate(org.apache.directory.ldap.client.api.LdapNetworkConnection, java.lang.String, java.lang.String) throws org.apache.directory.api.ldap.model.exception.LdapException;
    Code:
       0: aload_2
       1: invokestatic  #91                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
       4: ifne          11
       7: iconst_1
       8: goto          12
      11: iconst_0
      12: ldc           #165                // String Binding with empty principal is forbidden.
      14: invokestatic  #166                // Method com/google/common/base/Preconditions.checkArgument:(ZLjava/lang/Object;)V
      17: aload_3
      18: invokestatic  #91                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      21: ifne          28
      24: iconst_1
      25: goto          29
      28: iconst_0
      29: ldc           #167                // String Binding with empty credentials is forbidden.
      31: invokestatic  #166                // Method com/google/common/base/Preconditions.checkArgument:(ZLjava/lang/Object;)V
      34: new           #168                // class org/apache/directory/api/ldap/model/message/BindRequestImpl
      37: dup
      38: invokespecial #169                // Method org/apache/directory/api/ldap/model/message/BindRequestImpl."<init>":()V
      41: astore        4
      43: aload         4
      45: aload_2
      46: invokevirtual #170                // Method org/apache/directory/api/ldap/model/message/BindRequestImpl.setName:(Ljava/lang/String;)Lorg/apache/directory/api/ldap/model/message/BindRequest;
      49: pop
      50: aload         4
      52: aload_3
      53: invokevirtual #171                // Method org/apache/directory/api/ldap/model/message/BindRequestImpl.setCredentials:(Ljava/lang/String;)Lorg/apache/directory/api/ldap/model/message/BindRequest;
      56: pop
      57: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
      60: ldc           #172                // String Re-binding with DN {} using password
      62: aload_2
      63: invokeinterface #88,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
      68: aload_1
      69: aload         4
      71: invokevirtual #173                // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.bind:(Lorg/apache/directory/api/ldap/model/message/BindRequest;)Lorg/apache/directory/api/ldap/model/message/BindResponse;
      74: astore        5
      76: aload         5
      78: invokeinterface #174,  1          // InterfaceMethod org/apache/directory/api/ldap/model/message/BindResponse.getLdapResult:()Lorg/apache/directory/api/ldap/model/message/LdapResult;
      83: invokeinterface #175,  1          // InterfaceMethod org/apache/directory/api/ldap/model/message/LdapResult.getResultCode:()Lorg/apache/directory/api/ldap/model/message/ResultCodeEnum;
      88: getstatic     #176                // Field org/apache/directory/api/ldap/model/message/ResultCodeEnum.SUCCESS:Lorg/apache/directory/api/ldap/model/message/ResultCodeEnum;
      91: invokevirtual #177                // Method org/apache/directory/api/ldap/model/message/ResultCodeEnum.equals:(Ljava/lang/Object;)Z
      94: ifne          121
      97: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     100: ldc           #178                // String Re-binding DN {} failed
     102: aload_2
     103: invokeinterface #88,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
     108: new           #179                // class java/lang/RuntimeException
     111: dup
     112: aload         5
     114: invokevirtual #180                // Method java/lang/Object.toString:()Ljava/lang/String;
     117: invokespecial #181                // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
     120: athrow
     121: getstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
     124: ldc           #182                // String Binding DN {} did not throw, connection authenticated: {}
     126: aload_2
     127: aload_1
     128: invokevirtual #183                // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.isAuthenticated:()Z
     131: invokestatic  #184                // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
     134: invokeinterface #97,  4           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     139: aload_1
     140: invokevirtual #183                // Method org/apache/directory/ldap/client/api/LdapNetworkConnection.isAuthenticated:()Z
     143: ireturn

  private static void $closeResource(java.lang.Throwable, java.lang.AutoCloseable);
    Code:
       0: aload_0
       1: ifnull        22
       4: aload_1
       5: invokeinterface #1,  1            // InterfaceMethod java/lang/AutoCloseable.close:()V
      10: goto          28
      13: astore_2
      14: aload_0
      15: aload_2
      16: invokevirtual #3                  // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
      19: goto          28
      22: aload_1
      23: invokeinterface #1,  1            // InterfaceMethod java/lang/AutoCloseable.close:()V
      28: return
    Exception table:
       from    to  target type
           4    10    13   Class java/lang/Throwable

  static {};
    Code:
       0: ldc           #119                // class org/graylog2/security/ldap/LdapConnector
       2: invokestatic  #185                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #9                  // Field LOG:Lorg/slf4j/Logger;
       8: return
}
