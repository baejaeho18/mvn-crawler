Compiled from "MongoDbSessionDAO.java"
public class org.graylog2.security.MongoDbSessionDAO extends org.apache.shiro.session.mgt.eis.CachingSessionDAO {
  private static final org.slf4j.Logger LOG;

  private final org.graylog2.security.MongoDBSessionService mongoDBSessionService;

  public org.graylog2.security.MongoDbSessionDAO(org.graylog2.security.MongoDBSessionService);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/shiro/session/mgt/eis/CachingSessionDAO."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field mongoDBSessionService:Lorg/graylog2/security/MongoDBSessionService;
       9: return

  protected java.io.Serializable doCreate(org.apache.shiro.session.Session);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #3                  // Method generateSessionId:(Lorg/apache/shiro/session/Session;)Ljava/io/Serializable;
       5: astore_2
       6: aload_0
       7: aload_1
       8: aload_2
       9: invokevirtual #4                  // Method assignSessionId:(Lorg/apache/shiro/session/Session;Ljava/io/Serializable;)V
      12: invokestatic  #5                  // Method com/google/common/collect/Maps.newHashMap:()Ljava/util/HashMap;
      15: astore_3
      16: aload_3
      17: ldc           #6                  // String session_id
      19: aload_2
      20: invokeinterface #7,  3            // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      25: pop
      26: aload_3
      27: ldc           #8                  // String host
      29: aload_1
      30: invokeinterface #9,  1            // InterfaceMethod org/apache/shiro/session/Session.getHost:()Ljava/lang/String;
      35: invokeinterface #7,  3            // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      40: pop
      41: aload_3
      42: ldc           #10                 // String start_timestamp
      44: aload_1
      45: invokeinterface #11,  1           // InterfaceMethod org/apache/shiro/session/Session.getStartTimestamp:()Ljava/util/Date;
      50: invokeinterface #7,  3            // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      55: pop
      56: aload_3
      57: ldc           #12                 // String last_access_time
      59: aload_1
      60: invokeinterface #13,  1           // InterfaceMethod org/apache/shiro/session/Session.getLastAccessTime:()Ljava/util/Date;
      65: invokeinterface #7,  3            // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      70: pop
      71: aload_3
      72: ldc           #14                 // String timeout
      74: aload_1
      75: invokeinterface #15,  1           // InterfaceMethod org/apache/shiro/session/Session.getTimeout:()J
      80: invokestatic  #16                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      83: invokeinterface #7,  3            // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      88: pop
      89: invokestatic  #5                  // Method com/google/common/collect/Maps.newHashMap:()Ljava/util/HashMap;
      92: astore        4
      94: aload_1
      95: invokeinterface #17,  1           // InterfaceMethod org/apache/shiro/session/Session.getAttributeKeys:()Ljava/util/Collection;
     100: invokeinterface #18,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
     105: astore        5
     107: aload         5
     109: invokeinterface #19,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     114: ifeq          150
     117: aload         5
     119: invokeinterface #20,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     124: astore        6
     126: aload         4
     128: aload         6
     130: invokevirtual #21                 // Method java/lang/Object.toString:()Ljava/lang/String;
     133: aload_1
     134: aload         6
     136: invokeinterface #22,  2           // InterfaceMethod org/apache/shiro/session/Session.getAttribute:(Ljava/lang/Object;)Ljava/lang/Object;
     141: invokeinterface #7,  3            // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     146: pop
     147: goto          107
     150: aload_3
     151: ldc           #23                 // String attributes
     153: aload         4
     155: invokeinterface #7,  3            // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     160: pop
     161: new           #24                 // class org/graylog2/security/MongoDbSession
     164: dup
     165: aload_3
     166: invokespecial #25                 // Method org/graylog2/security/MongoDbSession."<init>":(Ljava/util/Map;)V
     169: astore        5
     171: aload_0
     172: getfield      #2                  // Field mongoDBSessionService:Lorg/graylog2/security/MongoDBSessionService;
     175: aload         5
     177: invokeinterface #26,  2           // InterfaceMethod org/graylog2/security/MongoDBSessionService.saveWithoutValidation:(Lorg/graylog2/plugin/database/Persisted;)Ljava/lang/String;
     182: astore        6
     184: getstatic     #27                 // Field LOG:Lorg/slf4j/Logger;
     187: ldc           #28                 // String Created session {}
     189: aload         6
     191: invokeinterface #29,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
     196: aload_2
     197: areturn

  protected org.apache.shiro.session.Session doReadSession(java.io.Serializable);
    Code:
       0: aload_0
       1: getfield      #2                  // Field mongoDBSessionService:Lorg/graylog2/security/MongoDBSessionService;
       4: aload_1
       5: invokevirtual #21                 // Method java/lang/Object.toString:()Ljava/lang/String;
       8: invokeinterface #30,  2           // InterfaceMethod org/graylog2/security/MongoDBSessionService.load:(Ljava/lang/String;)Lorg/graylog2/security/MongoDbSession;
      13: astore_2
      14: getstatic     #27                 // Field LOG:Lorg/slf4j/Logger;
      17: ldc           #31                 // String Reading session for id {} from MongoDB: {}
      19: aload_1
      20: aload_2
      21: invokeinterface #32,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      26: aload_2
      27: ifnonnull     32
      30: aconst_null
      31: areturn
      32: aload_0
      33: aload_1
      34: aload_2
      35: invokespecial #33                 // Method getSimpleSession:(Ljava/io/Serializable;Lorg/graylog2/security/MongoDbSession;)Lorg/apache/shiro/session/mgt/SimpleSession;
      38: areturn

  private org.apache.shiro.session.mgt.SimpleSession getSimpleSession(java.io.Serializable, org.graylog2.security.MongoDbSession);
    Code:
       0: new           #34                 // class org/apache/shiro/session/mgt/SimpleSession
       3: dup
       4: invokespecial #35                 // Method org/apache/shiro/session/mgt/SimpleSession."<init>":()V
       7: astore_3
       8: aload_0
       9: aload_3
      10: aload_1
      11: invokevirtual #4                  // Method assignSessionId:(Lorg/apache/shiro/session/Session;Ljava/io/Serializable;)V
      14: aload_3
      15: aload_2
      16: invokevirtual #36                 // Method org/graylog2/security/MongoDbSession.getHost:()Ljava/lang/String;
      19: invokevirtual #37                 // Method org/apache/shiro/session/mgt/SimpleSession.setHost:(Ljava/lang/String;)V
      22: aload_3
      23: aload_2
      24: invokevirtual #38                 // Method org/graylog2/security/MongoDbSession.getTimeout:()J
      27: invokevirtual #39                 // Method org/apache/shiro/session/mgt/SimpleSession.setTimeout:(J)V
      30: aload_3
      31: aload_2
      32: invokevirtual #40                 // Method org/graylog2/security/MongoDbSession.getStartTimestamp:()Ljava/util/Date;
      35: invokevirtual #41                 // Method org/apache/shiro/session/mgt/SimpleSession.setStartTimestamp:(Ljava/util/Date;)V
      38: aload_3
      39: aload_2
      40: invokevirtual #42                 // Method org/graylog2/security/MongoDbSession.getLastAccessTime:()Ljava/util/Date;
      43: invokevirtual #43                 // Method org/apache/shiro/session/mgt/SimpleSession.setLastAccessTime:(Ljava/util/Date;)V
      46: aload_3
      47: aload_2
      48: invokevirtual #44                 // Method org/graylog2/security/MongoDbSession.isExpired:()Z
      51: invokevirtual #45                 // Method org/apache/shiro/session/mgt/SimpleSession.setExpired:(Z)V
      54: aload_3
      55: aload_2
      56: invokevirtual #46                 // Method org/graylog2/security/MongoDbSession.getAttributes:()Ljava/util/Map;
      59: invokevirtual #47                 // Method org/apache/shiro/session/mgt/SimpleSession.setAttributes:(Ljava/util/Map;)V
      62: aload_3
      63: areturn

  protected void doUpdate(org.apache.shiro.session.Session);
    Code:
       0: aload_0
       1: getfield      #2                  // Field mongoDBSessionService:Lorg/graylog2/security/MongoDBSessionService;
       4: aload_1
       5: invokeinterface #48,  1           // InterfaceMethod org/apache/shiro/session/Session.getId:()Ljava/io/Serializable;
      10: invokevirtual #21                 // Method java/lang/Object.toString:()Ljava/lang/String;
      13: invokeinterface #30,  2           // InterfaceMethod org/graylog2/security/MongoDBSessionService.load:(Ljava/lang/String;)Lorg/graylog2/security/MongoDbSession;
      18: astore_2
      19: aconst_null
      20: aload_2
      21: if_acmpne     61
      24: new           #49                 // class java/lang/RuntimeException
      27: dup
      28: new           #50                 // class java/lang/StringBuilder
      31: dup
      32: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
      35: ldc           #52                 // String Couldn\'t load session <
      37: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      40: aload_1
      41: invokeinterface #48,  1           // InterfaceMethod org/apache/shiro/session/Session.getId:()Ljava/io/Serializable;
      46: invokevirtual #54                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      49: ldc           #55                 // String >
      51: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      54: invokevirtual #56                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      57: invokespecial #57                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
      60: athrow
      61: getstatic     #27                 // Field LOG:Lorg/slf4j/Logger;
      64: ldc           #58                 // String Updating session {}
      66: aload_1
      67: invokeinterface #29,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      72: aload_2
      73: aload_1
      74: invokeinterface #9,  1            // InterfaceMethod org/apache/shiro/session/Session.getHost:()Ljava/lang/String;
      79: invokevirtual #59                 // Method org/graylog2/security/MongoDbSession.setHost:(Ljava/lang/String;)V
      82: aload_2
      83: aload_1
      84: invokeinterface #15,  1           // InterfaceMethod org/apache/shiro/session/Session.getTimeout:()J
      89: invokevirtual #60                 // Method org/graylog2/security/MongoDbSession.setTimeout:(J)V
      92: aload_2
      93: aload_1
      94: invokeinterface #11,  1           // InterfaceMethod org/apache/shiro/session/Session.getStartTimestamp:()Ljava/util/Date;
      99: invokevirtual #61                 // Method org/graylog2/security/MongoDbSession.setStartTimestamp:(Ljava/util/Date;)V
     102: aload_2
     103: aload_1
     104: invokeinterface #13,  1           // InterfaceMethod org/apache/shiro/session/Session.getLastAccessTime:()Ljava/util/Date;
     109: invokevirtual #62                 // Method org/graylog2/security/MongoDbSession.setLastAccessTime:(Ljava/util/Date;)V
     112: aload_1
     113: instanceof    #34                 // class org/apache/shiro/session/mgt/SimpleSession
     116: ifeq          143
     119: aload_1
     120: checkcast     #34                 // class org/apache/shiro/session/mgt/SimpleSession
     123: astore_3
     124: aload_2
     125: aload_3
     126: invokevirtual #63                 // Method org/apache/shiro/session/mgt/SimpleSession.getAttributes:()Ljava/util/Map;
     129: invokevirtual #64                 // Method org/graylog2/security/MongoDbSession.setAttributes:(Ljava/util/Map;)V
     132: aload_2
     133: aload_3
     134: invokevirtual #65                 // Method org/apache/shiro/session/mgt/SimpleSession.isExpired:()Z
     137: invokevirtual #66                 // Method org/graylog2/security/MongoDbSession.setExpired:(Z)V
     140: goto          176
     143: new           #49                 // class java/lang/RuntimeException
     146: dup
     147: new           #50                 // class java/lang/StringBuilder
     150: dup
     151: invokespecial #51                 // Method java/lang/StringBuilder."<init>":()V
     154: ldc           #67                 // String Unsupported session type:
     156: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     159: aload_1
     160: invokevirtual #68                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
     163: invokevirtual #69                 // Method java/lang/Class.getCanonicalName:()Ljava/lang/String;
     166: invokevirtual #53                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     169: invokevirtual #56                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     172: invokespecial #57                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
     175: athrow
     176: invokestatic  #70                 // Method com/github/rholder/retry/RetryerBuilder.newBuilder:()Lcom/github/rholder/retry/RetryerBuilder;
     179: ldc           #71                 // class com/mongodb/DuplicateKeyException
     181: invokevirtual #72                 // Method com/github/rholder/retry/RetryerBuilder.retryIfExceptionOfType:(Ljava/lang/Class;)Lcom/github/rholder/retry/RetryerBuilder;
     184: ldc2_w        #73                 // long 5l
     187: getstatic     #75                 // Field java/util/concurrent/TimeUnit.MILLISECONDS:Ljava/util/concurrent/TimeUnit;
     190: invokestatic  #76                 // Method com/github/rholder/retry/WaitStrategies.randomWait:(JLjava/util/concurrent/TimeUnit;)Lcom/github/rholder/retry/WaitStrategy;
     193: invokevirtual #77                 // Method com/github/rholder/retry/RetryerBuilder.withWaitStrategy:(Lcom/github/rholder/retry/WaitStrategy;)Lcom/github/rholder/retry/RetryerBuilder;
     196: bipush        10
     198: invokestatic  #78                 // Method com/github/rholder/retry/StopStrategies.stopAfterAttempt:(I)Lcom/github/rholder/retry/StopStrategy;
     201: invokevirtual #79                 // Method com/github/rholder/retry/RetryerBuilder.withStopStrategy:(Lcom/github/rholder/retry/StopStrategy;)Lcom/github/rholder/retry/RetryerBuilder;
     204: invokevirtual #80                 // Method com/github/rholder/retry/RetryerBuilder.build:()Lcom/github/rholder/retry/Retryer;
     207: astore_3
     208: aload_3
     209: aload_0
     210: aload_2
     211: invokedynamic #81,  0             // InvokeDynamic #0:call:(Lorg/graylog2/security/MongoDbSessionDAO;Lorg/graylog2/security/MongoDbSession;)Ljava/util/concurrent/Callable;
     216: invokevirtual #82                 // Method com/github/rholder/retry/Retryer.call:(Ljava/util/concurrent/Callable;)Ljava/lang/Object;
     219: pop
     220: goto          277
     223: astore        4
     225: getstatic     #27                 // Field LOG:Lorg/slf4j/Logger;
     228: ldc           #84                 // String Unexpected exception when saving session to MongoDB. Failed to update session.
     230: aload         4
     232: invokeinterface #85,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     237: new           #49                 // class java/lang/RuntimeException
     240: dup
     241: aload         4
     243: invokevirtual #86                 // Method java/util/concurrent/ExecutionException.getCause:()Ljava/lang/Throwable;
     246: invokespecial #87                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
     249: athrow
     250: astore        4
     252: getstatic     #27                 // Field LOG:Lorg/slf4j/Logger;
     255: ldc           #89                 // String Tried to update session 10 times, but still failed. This is likely because of https://jira.mongodb.org/browse/SERVER-14322
     257: aload         4
     259: invokeinterface #85,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     264: new           #49                 // class java/lang/RuntimeException
     267: dup
     268: aload         4
     270: invokevirtual #90                 // Method com/github/rholder/retry/RetryException.getCause:()Ljava/lang/Throwable;
     273: invokespecial #87                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
     276: athrow
     277: return
    Exception table:
       from    to  target type
         208   220   223   Class java/util/concurrent/ExecutionException
         208   220   250   Class com/github/rholder/retry/RetryException

  protected void doDelete(org.apache.shiro.session.Session);
    Code:
       0: getstatic     #27                 // Field LOG:Lorg/slf4j/Logger;
       3: ldc           #91                 // String Deleting session {}
       5: aload_1
       6: invokeinterface #29,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      11: aload_1
      12: invokeinterface #48,  1           // InterfaceMethod org/apache/shiro/session/Session.getId:()Ljava/io/Serializable;
      17: astore_2
      18: aload_0
      19: getfield      #2                  // Field mongoDBSessionService:Lorg/graylog2/security/MongoDBSessionService;
      22: aload_2
      23: invokevirtual #21                 // Method java/lang/Object.toString:()Ljava/lang/String;
      26: invokeinterface #30,  2           // InterfaceMethod org/graylog2/security/MongoDBSessionService.load:(Ljava/lang/String;)Lorg/graylog2/security/MongoDbSession;
      31: astore_3
      32: aload_3
      33: ifnull        67
      36: aload_0
      37: getfield      #2                  // Field mongoDBSessionService:Lorg/graylog2/security/MongoDBSessionService;
      40: aload_3
      41: invokeinterface #92,  2           // InterfaceMethod org/graylog2/security/MongoDBSessionService.destroy:(Lorg/graylog2/plugin/database/Persisted;)I
      46: istore        4
      48: getstatic     #27                 // Field LOG:Lorg/slf4j/Logger;
      51: ldc           #93                 // String Deleted {} sessions with ID {} from database
      53: iload         4
      55: invokestatic  #94                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      58: aload_2
      59: invokeinterface #32,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      64: goto          78
      67: getstatic     #27                 // Field LOG:Lorg/slf4j/Logger;
      70: ldc           #95                 // String Session {} not found in database
      72: aload_2
      73: invokeinterface #29,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      78: return

  public java.util.Collection<org.apache.shiro.session.Session> getActiveSessions();
    Code:
       0: getstatic     #27                 // Field LOG:Lorg/slf4j/Logger;
       3: ldc           #96                 // String Retrieving all active sessions.
       5: invokeinterface #97,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      10: aload_0
      11: getfield      #2                  // Field mongoDBSessionService:Lorg/graylog2/security/MongoDBSessionService;
      14: invokeinterface #98,  1           // InterfaceMethod org/graylog2/security/MongoDBSessionService.loadAll:()Ljava/util/Collection;
      19: astore_1
      20: invokestatic  #99                 // Method com/google/common/collect/Lists.newArrayList:()Ljava/util/ArrayList;
      23: astore_2
      24: aload_1
      25: invokeinterface #18,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      30: astore_3
      31: aload_3
      32: invokeinterface #19,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      37: ifeq          72
      40: aload_3
      41: invokeinterface #20,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      46: checkcast     #24                 // class org/graylog2/security/MongoDbSession
      49: astore        4
      51: aload_2
      52: aload_0
      53: aload         4
      55: invokevirtual #100                // Method org/graylog2/security/MongoDbSession.getSessionId:()Ljava/lang/String;
      58: aload         4
      60: invokespecial #33                 // Method getSimpleSession:(Ljava/io/Serializable;Lorg/graylog2/security/MongoDbSession;)Lorg/apache/shiro/session/mgt/SimpleSession;
      63: invokeinterface #101,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      68: pop
      69: goto          31
      72: aload_2
      73: areturn

  private java.lang.Object lambda$doUpdate$0(org.graylog2.security.MongoDbSession) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #2                  // Field mongoDBSessionService:Lorg/graylog2/security/MongoDBSessionService;
       4: aload_1
       5: invokeinterface #26,  2           // InterfaceMethod org/graylog2/security/MongoDBSessionService.saveWithoutValidation:(Lorg/graylog2/plugin/database/Persisted;)Ljava/lang/String;
      10: areturn

  static {};
    Code:
       0: ldc           #102                // class org/graylog2/security/MongoDbSessionDAO
       2: invokestatic  #103                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #27                 // Field LOG:Lorg/slf4j/Logger;
       8: return
}
