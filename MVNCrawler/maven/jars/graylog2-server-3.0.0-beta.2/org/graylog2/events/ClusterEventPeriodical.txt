Compiled from "ClusterEventPeriodical.java"
public class org.graylog2.events.ClusterEventPeriodical extends org.graylog2.plugin.periodical.Periodical {
  private static final org.slf4j.Logger LOG;

  static final java.lang.String COLLECTION_NAME;

  private final org.mongojack.JacksonDBCollection<org.graylog2.events.ClusterEvent, java.lang.String> dbCollection;

  private final org.graylog2.plugin.system.NodeId nodeId;

  private final com.fasterxml.jackson.databind.ObjectMapper objectMapper;

  private final com.google.common.eventbus.EventBus serverEventBus;

  private final org.graylog2.shared.plugins.ChainingClassLoader chainingClassLoader;

  public org.graylog2.events.ClusterEventPeriodical(org.graylog2.bindings.providers.MongoJackObjectMapperProvider, org.graylog2.database.MongoConnection, org.graylog2.plugin.system.NodeId, org.graylog2.shared.plugins.ChainingClassLoader, com.google.common.eventbus.EventBus, org.graylog2.events.ClusterEventBus);
    Code:
       0: aload_0
       1: aload_2
       2: invokestatic  #1                  // Method prepareCollection:(Lorg/graylog2/database/MongoConnection;)Lcom/mongodb/DBCollection;
       5: ldc           #2                  // class org/graylog2/events/ClusterEvent
       7: ldc           #3                  // class java/lang/String
       9: aload_1
      10: invokevirtual #4                  // Method org/graylog2/bindings/providers/MongoJackObjectMapperProvider.get:()Lcom/fasterxml/jackson/databind/ObjectMapper;
      13: invokestatic  #5                  // Method org/mongojack/JacksonDBCollection.wrap:(Lcom/mongodb/DBCollection;Ljava/lang/Class;Ljava/lang/Class;Lcom/fasterxml/jackson/databind/ObjectMapper;)Lorg/mongojack/JacksonDBCollection;
      16: aload_3
      17: aload_1
      18: invokevirtual #4                  // Method org/graylog2/bindings/providers/MongoJackObjectMapperProvider.get:()Lcom/fasterxml/jackson/databind/ObjectMapper;
      21: aload         4
      23: aload         5
      25: aload         6
      27: invokespecial #6                  // Method "<init>":(Lorg/mongojack/JacksonDBCollection;Lorg/graylog2/plugin/system/NodeId;Lcom/fasterxml/jackson/databind/ObjectMapper;Lorg/graylog2/shared/plugins/ChainingClassLoader;Lcom/google/common/eventbus/EventBus;Lorg/graylog2/events/ClusterEventBus;)V
      30: return

  private org.graylog2.events.ClusterEventPeriodical(org.mongojack.JacksonDBCollection<org.graylog2.events.ClusterEvent, java.lang.String>, org.graylog2.plugin.system.NodeId, com.fasterxml.jackson.databind.ObjectMapper, org.graylog2.shared.plugins.ChainingClassLoader, com.google.common.eventbus.EventBus, org.graylog2.events.ClusterEventBus);
    Code:
       0: aload_0
       1: invokespecial #7                  // Method org/graylog2/plugin/periodical/Periodical."<init>":()V
       4: aload_0
       5: aload_2
       6: invokestatic  #8                  // Method com/google/common/base/Preconditions.checkNotNull:(Ljava/lang/Object;)Ljava/lang/Object;
       9: checkcast     #9                  // class org/graylog2/plugin/system/NodeId
      12: putfield      #10                 // Field nodeId:Lorg/graylog2/plugin/system/NodeId;
      15: aload_0
      16: aload_1
      17: invokestatic  #8                  // Method com/google/common/base/Preconditions.checkNotNull:(Ljava/lang/Object;)Ljava/lang/Object;
      20: checkcast     #11                 // class org/mongojack/JacksonDBCollection
      23: putfield      #12                 // Field dbCollection:Lorg/mongojack/JacksonDBCollection;
      26: aload_0
      27: aload_3
      28: invokestatic  #8                  // Method com/google/common/base/Preconditions.checkNotNull:(Ljava/lang/Object;)Ljava/lang/Object;
      31: checkcast     #13                 // class com/fasterxml/jackson/databind/ObjectMapper
      34: putfield      #14                 // Field objectMapper:Lcom/fasterxml/jackson/databind/ObjectMapper;
      37: aload_0
      38: aload         4
      40: putfield      #15                 // Field chainingClassLoader:Lorg/graylog2/shared/plugins/ChainingClassLoader;
      43: aload_0
      44: aload         5
      46: invokestatic  #8                  // Method com/google/common/base/Preconditions.checkNotNull:(Ljava/lang/Object;)Ljava/lang/Object;
      49: checkcast     #16                 // class com/google/common/eventbus/EventBus
      52: putfield      #17                 // Field serverEventBus:Lcom/google/common/eventbus/EventBus;
      55: aload         6
      57: invokestatic  #8                  // Method com/google/common/base/Preconditions.checkNotNull:(Ljava/lang/Object;)Ljava/lang/Object;
      60: checkcast     #18                 // class org/graylog2/events/ClusterEventBus
      63: aload_0
      64: invokevirtual #19                 // Method org/graylog2/events/ClusterEventBus.registerClusterEventSubscriber:(Ljava/lang/Object;)V
      67: return

  static com.mongodb.DBCollection prepareCollection(org.graylog2.database.MongoConnection);
    Code:
       0: aload_0
       1: invokeinterface #20,  1           // InterfaceMethod org/graylog2/database/MongoConnection.getDatabase:()Lcom/mongodb/DB;
       6: astore_1
       7: aload_1
       8: ldc           #22                 // String cluster_events
      10: invokevirtual #23                 // Method com/mongodb/DB.getCollection:(Ljava/lang/String;)Lcom/mongodb/DBCollection;
      13: astore_2
      14: aload_2
      15: ldc           #24                 // String timestamp
      17: invokestatic  #25                 // Method org/mongojack/DBSort.asc:(Ljava/lang/String;)Lorg/mongojack/DBSort$SortBuilder;
      20: ldc           #26                 // String producer
      22: invokevirtual #27                 // Method org/mongojack/DBSort$SortBuilder.asc:(Ljava/lang/String;)Lorg/mongojack/DBSort$SortBuilder;
      25: ldc           #28                 // String consumers
      27: invokevirtual #27                 // Method org/mongojack/DBSort$SortBuilder.asc:(Ljava/lang/String;)Lorg/mongojack/DBSort$SortBuilder;
      30: invokevirtual #29                 // Method com/mongodb/DBCollection.createIndex:(Lcom/mongodb/DBObject;)V
      33: aload_2
      34: getstatic     #30                 // Field com/mongodb/WriteConcern.JOURNALED:Lcom/mongodb/WriteConcern;
      37: invokevirtual #31                 // Method com/mongodb/DBCollection.setWriteConcern:(Lcom/mongodb/WriteConcern;)V
      40: aload_2
      41: areturn

  public boolean runsForever();
    Code:
       0: iconst_0
       1: ireturn

  public boolean stopOnGracefulShutdown();
    Code:
       0: iconst_1
       1: ireturn

  public boolean masterOnly();
    Code:
       0: iconst_0
       1: ireturn

  public boolean startOnThisNode();
    Code:
       0: iconst_1
       1: ireturn

  public boolean isDaemon();
    Code:
       0: iconst_1
       1: ireturn

  public int getInitialDelaySeconds();
    Code:
       0: iconst_0
       1: ireturn

  public int getPeriodSeconds();
    Code:
       0: iconst_1
       1: ireturn

  protected org.slf4j.Logger getLogger();
    Code:
       0: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
       3: areturn

  public void doRun();
    Code:
       0: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
       3: ldc           #33                 // String Opening MongoDB cursor on \"{}\"
       5: ldc           #22                 // String cluster_events
       7: invokeinterface #34,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      12: aload_0
      13: aload_0
      14: getfield      #10                 // Field nodeId:Lorg/graylog2/plugin/system/NodeId;
      17: invokespecial #35                 // Method eventCursor:(Lorg/graylog2/plugin/system/NodeId;)Lorg/mongojack/DBCursor;
      20: astore_1
      21: aconst_null
      22: astore_2
      23: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
      26: invokeinterface #36,  1           // InterfaceMethod org/slf4j/Logger.isTraceEnabled:()Z
      31: ifeq          48
      34: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
      37: ldc           #37                 // String MongoDB query plan: {}
      39: aload_1
      40: invokevirtual #38                 // Method org/mongojack/DBCursor.explain:()Lcom/mongodb/DBObject;
      43: invokeinterface #39,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
      48: aload_1
      49: invokevirtual #40                 // Method org/mongojack/DBCursor.hasNext:()Z
      52: ifeq          145
      55: aload_1
      56: invokevirtual #41                 // Method org/mongojack/DBCursor.next:()Ljava/lang/Object;
      59: checkcast     #2                  // class org/graylog2/events/ClusterEvent
      62: astore_3
      63: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
      66: ldc           #42                 // String Processing cluster event: {}
      68: aload_3
      69: invokeinterface #39,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
      74: aload_0
      75: aload_3
      76: invokevirtual #43                 // Method org/graylog2/events/ClusterEvent.payload:()Ljava/lang/Object;
      79: aload_3
      80: invokevirtual #44                 // Method org/graylog2/events/ClusterEvent.eventClass:()Ljava/lang/String;
      83: invokespecial #45                 // Method extractPayload:(Ljava/lang/Object;Ljava/lang/String;)Ljava/lang/Object;
      86: astore        4
      88: aload         4
      90: ifnull        105
      93: aload_0
      94: getfield      #17                 // Field serverEventBus:Lcom/google/common/eventbus/EventBus;
      97: aload         4
      99: invokevirtual #46                 // Method com/google/common/eventbus/EventBus.post:(Ljava/lang/Object;)V
     102: goto          130
     105: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
     108: ldc           #47                 // String Couldn\'t extract payload of cluster event with ID <{}>
     110: aload_3
     111: invokevirtual #48                 // Method org/graylog2/events/ClusterEvent.id:()Ljava/lang/String;
     114: invokeinterface #49,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
     119: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
     122: ldc           #50                 // String Invalid payload in cluster event: {}
     124: aload_3
     125: invokeinterface #34,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
     130: aload_0
     131: aload_3
     132: invokevirtual #48                 // Method org/graylog2/events/ClusterEvent.id:()Ljava/lang/String;
     135: aload_0
     136: getfield      #10                 // Field nodeId:Lorg/graylog2/plugin/system/NodeId;
     139: invokespecial #51                 // Method updateConsumers:(Ljava/lang/String;Lorg/graylog2/plugin/system/NodeId;)V
     142: goto          48
     145: aload_1
     146: ifnull        216
     149: aload_2
     150: ifnull        169
     153: aload_1
     154: invokevirtual #52                 // Method org/mongojack/DBCursor.close:()V
     157: goto          216
     160: astore_3
     161: aload_2
     162: aload_3
     163: invokevirtual #54                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     166: goto          216
     169: aload_1
     170: invokevirtual #52                 // Method org/mongojack/DBCursor.close:()V
     173: goto          216
     176: astore_3
     177: aload_3
     178: astore_2
     179: aload_3
     180: athrow
     181: astore        5
     183: aload_1
     184: ifnull        213
     187: aload_2
     188: ifnull        209
     191: aload_1
     192: invokevirtual #52                 // Method org/mongojack/DBCursor.close:()V
     195: goto          213
     198: astore        6
     200: aload_2
     201: aload         6
     203: invokevirtual #54                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     206: goto          213
     209: aload_1
     210: invokevirtual #52                 // Method org/mongojack/DBCursor.close:()V
     213: aload         5
     215: athrow
     216: goto          231
     219: astore_1
     220: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
     223: ldc           #56                 // String Error while reading cluster events from MongoDB, retrying.
     225: aload_1
     226: invokeinterface #57,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     231: return
    Exception table:
       from    to  target type
         153   157   160   Class java/lang/Throwable
          23   145   176   Class java/lang/Throwable
          23   145   181   any
         191   195   198   Class java/lang/Throwable
         176   183   181   any
          12   216   219   Class java/lang/Exception

  public void publishClusterEvent(java.lang.Object);
    Code:
       0: aload_1
       1: instanceof    #58                 // class com/google/common/eventbus/DeadEvent
       4: ifeq          18
       7: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
      10: ldc           #59                 // String Skipping DeadEvent on cluster event bus
      12: invokeinterface #60,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      17: return
      18: aload_1
      19: invokevirtual #61                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      22: invokestatic  #62                 // Method org/graylog2/shared/utilities/AutoValueUtils.getCanonicalName:(Ljava/lang/Class;)Ljava/lang/String;
      25: astore_2
      26: aload_0
      27: getfield      #10                 // Field nodeId:Lorg/graylog2/plugin/system/NodeId;
      30: invokevirtual #63                 // Method org/graylog2/plugin/system/NodeId.toString:()Ljava/lang/String;
      33: aload_2
      34: aload_1
      35: invokestatic  #64                 // Method org/graylog2/events/ClusterEvent.create:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Object;)Lorg/graylog2/events/ClusterEvent;
      38: astore_3
      39: aload_0
      40: getfield      #12                 // Field dbCollection:Lorg/mongojack/JacksonDBCollection;
      43: aload_3
      44: getstatic     #30                 // Field com/mongodb/WriteConcern.JOURNALED:Lcom/mongodb/WriteConcern;
      47: invokevirtual #65                 // Method org/mongojack/JacksonDBCollection.save:(Ljava/lang/Object;Lcom/mongodb/WriteConcern;)Lorg/mongojack/WriteResult;
      50: invokevirtual #66                 // Method org/mongojack/WriteResult.getSavedId:()Ljava/lang/Object;
      53: checkcast     #3                  // class java/lang/String
      56: astore        4
      58: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
      61: ldc           #67                 // String Published cluster event with ID <{}> and type <{}>
      63: aload         4
      65: aload_2
      66: invokeinterface #68,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      71: goto          110
      74: astore        4
      76: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
      79: new           #70                 // class java/lang/StringBuilder
      82: dup
      83: invokespecial #71                 // Method java/lang/StringBuilder."<init>":()V
      86: ldc           #72                 // String Couldn\'t publish cluster event of type <
      88: invokevirtual #73                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      91: aload_2
      92: invokevirtual #73                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      95: ldc           #74                 // String >
      97: invokevirtual #73                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     100: invokevirtual #75                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     103: aload         4
     105: invokeinterface #76,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     110: return
    Exception table:
       from    to  target type
          39    71    74   Class com/mongodb/MongoException

  private org.mongojack.DBCursor<org.graylog2.events.ClusterEvent> eventCursor(org.graylog2.plugin.system.NodeId);
    Code:
       0: new           #77                 // class com/mongodb/BasicDBList
       3: dup
       4: invokespecial #78                 // Method com/mongodb/BasicDBList."<init>":()V
       7: astore_2
       8: aload_2
       9: aload_1
      10: invokevirtual #63                 // Method org/graylog2/plugin/system/NodeId.toString:()Ljava/lang/String;
      13: invokevirtual #79                 // Method com/mongodb/BasicDBList.add:(Ljava/lang/Object;)Z
      16: pop
      17: new           #80                 // class com/mongodb/BasicDBObject
      20: dup
      21: ldc           #28                 // String consumers
      23: new           #80                 // class com/mongodb/BasicDBObject
      26: dup
      27: ldc           #81                 // String $nin
      29: aload_2
      30: invokespecial #82                 // Method com/mongodb/BasicDBObject."<init>":(Ljava/lang/String;Ljava/lang/Object;)V
      33: invokespecial #82                 // Method com/mongodb/BasicDBObject."<init>":(Ljava/lang/String;Ljava/lang/Object;)V
      36: astore_3
      37: aload_0
      38: getfield      #12                 // Field dbCollection:Lorg/mongojack/JacksonDBCollection;
      41: aload_3
      42: invokevirtual #83                 // Method org/mongojack/JacksonDBCollection.find:(Lcom/mongodb/DBObject;)Lorg/mongojack/DBCursor;
      45: ldc           #24                 // String timestamp
      47: invokestatic  #25                 // Method org/mongojack/DBSort.asc:(Ljava/lang/String;)Lorg/mongojack/DBSort$SortBuilder;
      50: invokevirtual #84                 // Method org/mongojack/DBCursor.sort:(Lcom/mongodb/DBObject;)Lorg/mongojack/DBCursor;
      53: areturn

  private void updateConsumers(java.lang.String, org.graylog2.plugin.system.NodeId);
    Code:
       0: aload_0
       1: getfield      #12                 // Field dbCollection:Lorg/mongojack/JacksonDBCollection;
       4: aload_1
       5: ldc           #28                 // String consumers
       7: aload_2
       8: invokevirtual #63                 // Method org/graylog2/plugin/system/NodeId.toString:()Ljava/lang/String;
      11: invokestatic  #85                 // Method org/mongojack/DBUpdate.addToSet:(Ljava/lang/String;Ljava/lang/Object;)Lorg/mongojack/DBUpdate$Builder;
      14: invokevirtual #86                 // Method org/mongojack/JacksonDBCollection.updateById:(Ljava/lang/Object;Lorg/mongojack/DBUpdate$Builder;)Lorg/mongojack/WriteResult;
      17: pop
      18: return

  private java.lang.Object extractPayload(java.lang.Object, java.lang.String);
    Code:
       0: aload_0
       1: getfield      #15                 // Field chainingClassLoader:Lorg/graylog2/shared/plugins/ChainingClassLoader;
       4: aload_2
       5: invokevirtual #87                 // Method org/graylog2/shared/plugins/ChainingClassLoader.loadClass:(Ljava/lang/String;)Ljava/lang/Class;
       8: astore_3
       9: aload_0
      10: getfield      #14                 // Field objectMapper:Lcom/fasterxml/jackson/databind/ObjectMapper;
      13: aload_1
      14: aload_3
      15: invokevirtual #88                 // Method com/fasterxml/jackson/databind/ObjectMapper.convertValue:(Ljava/lang/Object;Ljava/lang/Class;)Ljava/lang/Object;
      18: areturn
      19: astore_3
      20: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
      23: new           #70                 // class java/lang/StringBuilder
      26: dup
      27: invokespecial #71                 // Method java/lang/StringBuilder."<init>":()V
      30: ldc           #90                 // String Couldn\'t load class <
      32: invokevirtual #73                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      35: aload_2
      36: invokevirtual #73                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      39: ldc           #91                 // String > for event
      41: invokevirtual #73                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      44: invokevirtual #75                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      47: aload_3
      48: invokeinterface #92,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
      53: aconst_null
      54: areturn
      55: astore_3
      56: getstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
      59: ldc           #94                 // String Error while deserializing payload
      61: aload_3
      62: invokeinterface #92,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
      67: aconst_null
      68: areturn
    Exception table:
       from    to  target type
           0    18    19   Class java/lang/ClassNotFoundException
           0    18    55   Class java/lang/IllegalArgumentException

  static {};
    Code:
       0: ldc           #21                 // class org/graylog2/events/ClusterEventPeriodical
       2: invokestatic  #95                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #32                 // Field LOG:Lorg/slf4j/Logger;
       8: return
}
