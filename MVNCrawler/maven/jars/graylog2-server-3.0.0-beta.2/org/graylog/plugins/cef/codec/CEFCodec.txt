Compiled from "CEFCodec.java"
public class org.graylog.plugins.cef.codec.CEFCodec implements org.graylog2.plugin.inputs.codecs.Codec {
  public static final java.lang.String NAME;

  private static final org.slf4j.Logger LOG;

  private static final java.util.regex.Pattern SYSLOG_PREFIX;

  private static final java.lang.String CK_TIMEZONE;

  private static final java.lang.String CK_LOCALE;

  private static final java.lang.String CK_USE_FULL_NAMES;

  private static final org.joda.time.DateTimeZone DEFAULT_TIMEZONE;

  private final org.graylog2.plugin.configuration.Configuration configuration;

  private final org.joda.time.DateTimeZone timezone;

  private final java.util.Locale locale;

  private final boolean useFullNames;

  private final com.github.jcustenborder.cef.CEFParser parser;

  public org.graylog.plugins.cef.codec.CEFCodec(org.graylog2.plugin.configuration.Configuration);
    Code:
       0: aload_0
       1: invokespecial #2                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #3                  // Field configuration:Lorg/graylog2/plugin/configuration/Configuration;
       9: aload_0
      10: invokestatic  #4                  // Method com/github/jcustenborder/cef/CEFParserFactory.create:()Lcom/github/jcustenborder/cef/CEFParser;
      13: putfield      #5                  // Field parser:Lcom/github/jcustenborder/cef/CEFParser;
      16: aload_1
      17: ldc           #7                  // String timezone
      19: invokevirtual #8                  // Method org/graylog2/plugin/configuration/Configuration.getString:(Ljava/lang/String;)Ljava/lang/String;
      22: invokestatic  #9                  // Method org/joda/time/DateTimeZone.forID:(Ljava/lang/String;)Lorg/joda/time/DateTimeZone;
      25: astore_2
      26: goto          45
      29: astore_3
      30: getstatic     #11                 // Field LOG:Lorg/slf4j/Logger;
      33: ldc           #12                 // String Could not configure CEF input timezone. Falling back to local default. Please check the error message:
      35: aload_3
      36: invokeinterface #13,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
      41: getstatic     #1                  // Field DEFAULT_TIMEZONE:Lorg/joda/time/DateTimeZone;
      44: astore_2
      45: aload_0
      46: aload_2
      47: putfield      #14                 // Field timezone:Lorg/joda/time/DateTimeZone;
      50: aload_0
      51: aload_1
      52: ldc           #15                 // String locale
      54: ldc           #16                 // String
      56: invokevirtual #17                 // Method org/graylog2/plugin/configuration/Configuration.getString:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      59: invokestatic  #18                 // Method java/util/Locale.forLanguageTag:(Ljava/lang/String;)Ljava/util/Locale;
      62: putfield      #19                 // Field locale:Ljava/util/Locale;
      65: aload_0
      66: aload_1
      67: ldc           #20                 // String use_full_names
      69: invokevirtual #21                 // Method org/graylog2/plugin/configuration/Configuration.getBoolean:(Ljava/lang/String;)Z
      72: putfield      #22                 // Field useFullNames:Z
      75: return
    Exception table:
       from    to  target type
          16    26    29   Class java/lang/Exception

  public org.graylog2.plugin.Message decode(org.graylog2.plugin.journal.RawMessage);
    Code:
       0: new           #23                 // class java/lang/String
       3: dup
       4: aload_1
       5: invokevirtual #24                 // Method org/graylog2/plugin/journal/RawMessage.getPayload:()[B
       8: getstatic     #25                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
      11: invokespecial #26                 // Method java/lang/String."<init>":([BLjava/nio/charset/Charset;)V
      14: astore_2
      15: getstatic     #27                 // Field SYSLOG_PREFIX:Ljava/util/regex/Pattern;
      18: aload_2
      19: invokevirtual #28                 // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
      22: astore_3
      23: aload_3
      24: invokevirtual #29                 // Method java/util/regex/Matcher.find:()Z
      27: ifeq          132
      30: aload_3
      31: ldc           #30                 // String pri
      33: invokevirtual #31                 // Method java/util/regex/Matcher.group:(Ljava/lang/String;)Ljava/lang/String;
      36: astore        4
      38: aload         4
      40: invokestatic  #32                 // Method com/google/common/primitives/Ints.tryParse:(Ljava/lang/String;)Ljava/lang/Integer;
      43: astore        5
      45: new           #33                 // class java/util/HashMap
      48: dup
      49: invokespecial #34                 // Method java/util/HashMap."<init>":()V
      52: astore        6
      54: aload         5
      56: ifnull        105
      59: aload         5
      61: invokevirtual #35                 // Method java/lang/Integer.intValue:()I
      64: invokestatic  #36                 // Method org/graylog/plugins/pipelineprocessor/functions/syslog/SyslogUtils.facilityFromPriority:(I)I
      67: istore        7
      69: aload         6
      71: ldc           #37                 // String level
      73: aload         5
      75: invokevirtual #35                 // Method java/lang/Integer.intValue:()I
      78: invokestatic  #38                 // Method org/graylog/plugins/pipelineprocessor/functions/syslog/SyslogUtils.levelFromPriority:(I)I
      81: invokestatic  #39                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;
      84: invokeinterface #40,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      89: pop
      90: aload         6
      92: ldc           #41                 // String facility
      94: iload         7
      96: invokestatic  #42                 // Method org/graylog/plugins/pipelineprocessor/functions/syslog/SyslogUtils.facilityToString:(I)Ljava/lang/String;
      99: invokeinterface #40,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     104: pop
     105: aload_3
     106: ldc           #43                 // String msg
     108: invokevirtual #31                 // Method java/util/regex/Matcher.group:(Ljava/lang/String;)Ljava/lang/String;
     111: astore        7
     113: aload_0
     114: aload_1
     115: aload         7
     117: invokevirtual #44                 // Method decodeCEF:(Lorg/graylog2/plugin/journal/RawMessage;Ljava/lang/String;)Lorg/graylog2/plugin/Message;
     120: astore        8
     122: aload         8
     124: aload         6
     126: invokevirtual #45                 // Method org/graylog2/plugin/Message.addFields:(Ljava/util/Map;)V
     129: aload         8
     131: areturn
     132: aload_0
     133: aload_1
     134: aload_2
     135: invokevirtual #44                 // Method decodeCEF:(Lorg/graylog2/plugin/journal/RawMessage;Ljava/lang/String;)Lorg/graylog2/plugin/Message;
     138: areturn

  public java.lang.String getName();
    Code:
       0: ldc           #46                 // String CEF
       2: areturn

  protected org.graylog2.plugin.Message decodeCEF(org.graylog2.plugin.journal.RawMessage, java.lang.String);
    Code:
       0: new           #47                 // class org/graylog/plugins/cef/parser/MappedMessage
       3: dup
       4: aload_0
       5: getfield      #5                  // Field parser:Lcom/github/jcustenborder/cef/CEFParser;
       8: aload_2
       9: aload_0
      10: getfield      #14                 // Field timezone:Lorg/joda/time/DateTimeZone;
      13: invokevirtual #48                 // Method org/joda/time/DateTimeZone.toTimeZone:()Ljava/util/TimeZone;
      16: aload_0
      17: getfield      #19                 // Field locale:Ljava/util/Locale;
      20: invokeinterface #49,  4           // InterfaceMethod com/github/jcustenborder/cef/CEFParser.parse:(Ljava/lang/String;Ljava/util/TimeZone;Ljava/util/Locale;)Lcom/github/jcustenborder/cef/Message;
      25: aload_0
      26: getfield      #22                 // Field useFullNames:Z
      29: invokespecial #50                 // Method org/graylog/plugins/cef/parser/MappedMessage."<init>":(Lcom/github/jcustenborder/cef/Message;Z)V
      32: astore_3
      33: new           #51                 // class org/graylog2/plugin/Message
      36: dup
      37: aload_0
      38: aload_3
      39: invokevirtual #52                 // Method buildMessageSummary:(Lcom/github/jcustenborder/cef/Message;)Ljava/lang/String;
      42: aload_0
      43: aload_3
      44: aload_1
      45: invokevirtual #53                 // Method decideSource:(Lorg/graylog/plugins/cef/parser/MappedMessage;Lorg/graylog2/plugin/journal/RawMessage;)Ljava/lang/String;
      48: new           #54                 // class org/joda/time/DateTime
      51: dup
      52: aload_3
      53: invokevirtual #55                 // Method org/graylog/plugins/cef/parser/MappedMessage.timestamp:()Ljava/util/Date;
      56: invokespecial #56                 // Method org/joda/time/DateTime."<init>":(Ljava/lang/Object;)V
      59: invokespecial #57                 // Method org/graylog2/plugin/Message."<init>":(Ljava/lang/String;Ljava/lang/String;Lorg/joda/time/DateTime;)V
      62: astore        4
      64: aload         4
      66: aload_3
      67: invokevirtual #58                 // Method org/graylog/plugins/cef/parser/MappedMessage.mappedExtensions:()Ljava/util/Map;
      70: invokevirtual #45                 // Method org/graylog2/plugin/Message.addFields:(Ljava/util/Map;)V
      73: aload         4
      75: ldc           #59                 // String device_vendor
      77: aload_3
      78: invokevirtual #60                 // Method org/graylog/plugins/cef/parser/MappedMessage.deviceVendor:()Ljava/lang/String;
      81: invokevirtual #61                 // Method org/graylog2/plugin/Message.addField:(Ljava/lang/String;Ljava/lang/Object;)V
      84: aload         4
      86: ldc           #62                 // String device_product
      88: aload_3
      89: invokevirtual #63                 // Method org/graylog/plugins/cef/parser/MappedMessage.deviceProduct:()Ljava/lang/String;
      92: invokevirtual #61                 // Method org/graylog2/plugin/Message.addField:(Ljava/lang/String;Ljava/lang/Object;)V
      95: aload         4
      97: ldc           #64                 // String device_version
      99: aload_3
     100: invokevirtual #65                 // Method org/graylog/plugins/cef/parser/MappedMessage.deviceVersion:()Ljava/lang/String;
     103: invokevirtual #61                 // Method org/graylog2/plugin/Message.addField:(Ljava/lang/String;Ljava/lang/Object;)V
     106: aload         4
     108: ldc           #66                 // String event_class_id
     110: aload_3
     111: invokevirtual #67                 // Method org/graylog/plugins/cef/parser/MappedMessage.deviceEventClassId:()Ljava/lang/String;
     114: invokevirtual #61                 // Method org/graylog2/plugin/Message.addField:(Ljava/lang/String;Ljava/lang/Object;)V
     117: aload         4
     119: ldc           #68                 // String name
     121: aload_3
     122: invokevirtual #69                 // Method org/graylog/plugins/cef/parser/MappedMessage.name:()Ljava/lang/String;
     125: invokevirtual #61                 // Method org/graylog2/plugin/Message.addField:(Ljava/lang/String;Ljava/lang/Object;)V
     128: aload         4
     130: ldc           #70                 // String severity
     132: aload_3
     133: invokevirtual #71                 // Method org/graylog/plugins/cef/parser/MappedMessage.severity:()Ljava/lang/String;
     136: invokevirtual #61                 // Method org/graylog2/plugin/Message.addField:(Ljava/lang/String;Ljava/lang/Object;)V
     139: aload         4
     141: areturn
     142: astore_3
     143: new           #72                 // class java/lang/RuntimeException
     146: dup
     147: ldc           #73                 // String Could not decode CEF message.
     149: aload_3
     150: invokespecial #74                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     153: athrow
    Exception table:
       from    to  target type
           0   141   142   Class java/lang/Exception

  protected java.lang.String buildMessageSummary(com.github.jcustenborder.cef.Message);
    Code:
       0: new           #75                 // class java/lang/StringBuilder
       3: dup
       4: invokespecial #76                 // Method java/lang/StringBuilder."<init>":()V
       7: aload_1
       8: invokeinterface #77,  1           // InterfaceMethod com/github/jcustenborder/cef/Message.deviceProduct:()Ljava/lang/String;
      13: invokevirtual #78                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      16: ldc           #79                 // String : [
      18: invokevirtual #78                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      21: aload_1
      22: invokeinterface #80,  1           // InterfaceMethod com/github/jcustenborder/cef/Message.deviceEventClassId:()Ljava/lang/String;
      27: invokevirtual #78                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      30: ldc           #81                 // String ,
      32: invokevirtual #78                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      35: aload_1
      36: invokeinterface #82,  1           // InterfaceMethod com/github/jcustenborder/cef/Message.severity:()Ljava/lang/String;
      41: invokevirtual #78                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      44: ldc           #83                 // String ]
      46: invokevirtual #78                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      49: aload_1
      50: invokeinterface #84,  1           // InterfaceMethod com/github/jcustenborder/cef/Message.name:()Ljava/lang/String;
      55: invokevirtual #78                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      58: invokevirtual #85                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      61: areturn

  protected java.lang.String decideSource(org.graylog.plugins.cef.parser.MappedMessage, org.graylog2.plugin.journal.RawMessage);
    Code:
       0: aload_1
       1: invokevirtual #58                 // Method org/graylog/plugins/cef/parser/MappedMessage.mappedExtensions:()Ljava/util/Map;
       4: astore_3
       5: aload_3
       6: ifnull        58
       9: aload_3
      10: invokeinterface #86,  1           // InterfaceMethod java/util/Map.isEmpty:()Z
      15: ifne          58
      18: aload_3
      19: getstatic     #87                 // Field org/graylog/plugins/cef/parser/CEFMapping.dvc:Lorg/graylog/plugins/cef/parser/CEFMapping;
      22: invokevirtual #88                 // Method org/graylog/plugins/cef/parser/CEFMapping.getFullName:()Ljava/lang/String;
      25: aload_3
      26: getstatic     #87                 // Field org/graylog/plugins/cef/parser/CEFMapping.dvc:Lorg/graylog/plugins/cef/parser/CEFMapping;
      29: invokevirtual #89                 // Method org/graylog/plugins/cef/parser/CEFMapping.getKeyName:()Ljava/lang/String;
      32: invokeinterface #90,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      37: invokeinterface #91,  3           // InterfaceMethod java/util/Map.getOrDefault:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      42: checkcast     #23                 // class java/lang/String
      45: astore        4
      47: aload         4
      49: invokestatic  #92                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      52: ifne          58
      55: aload         4
      57: areturn
      58: aload_1
      59: invokevirtual #93                 // Method org/graylog/plugins/cef/parser/MappedMessage.host:()Ljava/lang/String;
      62: invokestatic  #92                 // Method com/google/common/base/Strings.isNullOrEmpty:(Ljava/lang/String;)Z
      65: ifne          73
      68: aload_1
      69: invokevirtual #93                 // Method org/graylog/plugins/cef/parser/MappedMessage.host:()Ljava/lang/String;
      72: areturn
      73: aload_2
      74: invokevirtual #94                 // Method org/graylog2/plugin/journal/RawMessage.getRemoteAddress:()Lorg/graylog2/plugin/ResolvableInetSocketAddress;
      77: astore        4
      79: aload         4
      81: ifnonnull     90
      84: aconst_null
      85: astore        5
      87: goto          97
      90: aload         4
      92: invokevirtual #95                 // Method org/graylog2/plugin/ResolvableInetSocketAddress.getInetSocketAddress:()Ljava/net/InetSocketAddress;
      95: astore        5
      97: aload         5
      99: ifnonnull     107
     102: ldc           #96                 // String unknown
     104: goto          115
     107: aload         5
     109: invokevirtual #97                 // Method java/net/InetSocketAddress.getAddress:()Ljava/net/InetAddress;
     112: invokevirtual #98                 // Method java/net/InetAddress.toString:()Ljava/lang/String;
     115: areturn

  public org.graylog2.plugin.inputs.codecs.CodecAggregator getAggregator();
    Code:
       0: aconst_null
       1: areturn

  public org.graylog2.plugin.configuration.Configuration getConfiguration();
    Code:
       0: aload_0
       1: getfield      #3                  // Field configuration:Lorg/graylog2/plugin/configuration/Configuration;
       4: areturn

  static org.joda.time.DateTimeZone access$000();
    Code:
       0: getstatic     #1                  // Field DEFAULT_TIMEZONE:Lorg/joda/time/DateTimeZone;
       3: areturn

  static {};
    Code:
       0: ldc           #6                  // class org/graylog/plugins/cef/codec/CEFCodec
       2: invokestatic  #99                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #11                 // Field LOG:Lorg/slf4j/Logger;
       8: ldc           #100                // String ^<(?<pri>\\d+)>(?<msg>.*)$
      10: invokestatic  #101                // Method java/util/regex/Pattern.compile:(Ljava/lang/String;)Ljava/util/regex/Pattern;
      13: putstatic     #27                 // Field SYSLOG_PREFIX:Ljava/util/regex/Pattern;
      16: invokestatic  #102                // Method org/joda/time/DateTimeZone.getDefault:()Lorg/joda/time/DateTimeZone;
      19: putstatic     #1                  // Field DEFAULT_TIMEZONE:Lorg/joda/time/DateTimeZone;
      22: return
}
