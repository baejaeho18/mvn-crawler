Compiled from "V20180212165000_AddDefaultCollectors.java"
public class org.graylog.plugins.sidecar.migrations.V20180212165000_AddDefaultCollectors extends org.graylog2.migrations.Migration {
  private static final org.slf4j.Logger LOG;

  private final org.graylog.plugins.sidecar.services.CollectorService collectorService;

  private final com.mongodb.client.MongoCollection<org.bson.Document> collection;

  public org.graylog.plugins.sidecar.migrations.V20180212165000_AddDefaultCollectors(org.graylog.plugins.sidecar.services.CollectorService, org.graylog2.database.MongoConnection);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/graylog2/migrations/Migration."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #2                  // Field collectorService:Lorg/graylog/plugins/sidecar/services/CollectorService;
       9: aload_0
      10: aload_2
      11: invokeinterface #3,  1            // InterfaceMethod org/graylog2/database/MongoConnection.getMongoDatabase:()Lcom/mongodb/client/MongoDatabase;
      16: ldc           #5                  // String sidecar_collectors
      18: invokeinterface #6,  2            // InterfaceMethod com/mongodb/client/MongoDatabase.getCollection:(Ljava/lang/String;)Lcom/mongodb/client/MongoCollection;
      23: putfield      #7                  // Field collection:Lcom/mongodb/client/MongoCollection;
      26: return

  public java.time.ZonedDateTime createdAt();
    Code:
       0: ldc           #8                  // String 2018-02-12T16:50:00Z
       2: invokestatic  #9                  // Method java/time/ZonedDateTime.parse:(Ljava/lang/CharSequence;)Ljava/time/ZonedDateTime;
       5: areturn

  public void upgrade();
    Code:
       0: aload_0
       1: invokespecial #10                 // Method removeConfigPath:()V
       4: ldc           #11                 // String # Needed for Graylog\nfields_under_root: true\nfields.collector_node_id: ${sidecar.nodeName}\nfields.gl2_source_collector: ${sidecar.nodeId}\n\n
       6: astore_1
       7: aload_0
       8: ldc           #12                 // String filebeat
      10: ldc           #13                 // String exec
      12: ldc           #14                 // String linux
      14: ldc           #15                 // String /usr/lib/graylog-sidecar/filebeat
      16: ldc           #16                 // String -c  %s
      18: ldc           #17                 // String test config -c %s
      20: ldc           #18                 // String # Needed for Graylog\nfields_under_root: true\nfields.collector_node_id: ${sidecar.nodeName}\nfields.gl2_source_collector: ${sidecar.nodeId}\n\nfilebeat.inputs:\n- input_type: log\n  paths:\n    - /var/log/*.log\n  type: log\noutput.logstash:\n   hosts: [\"192.168.1.1:5044\"]\npath:\n  data: /var/cache/graylog-sidecar/filebeat/data\n  logs: /var/log/graylog-sidecar
      22: invokespecial #19                 // Method ensureCollector:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      25: pop
      26: aload_0
      27: ldc           #20                 // String winlogbeat
      29: ldc           #21                 // String svc
      31: ldc           #22                 // String windows
      33: ldc           #23                 // String C:\\Program Files\\Graylog\\sidecar\\winlogbeat.exe
      35: ldc           #24                 // String -c \"%s\"
      37: ldc           #25                 // String test config -c \"%s\"
      39: ldc           #26                 // String # Needed for Graylog\nfields_under_root: true\nfields.collector_node_id: ${sidecar.nodeName}\nfields.gl2_source_collector: ${sidecar.nodeId}\n\noutput.logstash:\n   hosts: [\"192.168.1.1:5044\"]\npath:\n  data: C:\\Program Files\\Graylog\\sidecar\\cache\\winlogbeat\\data\n  logs: C:\\Program Files\\Graylog\\sidecar\\logs\ntags:\n - windows\nwinlogbeat:\n  event_logs:\n   - name: Application\n   - name: System\n   - name: Security
      41: invokespecial #19                 // Method ensureCollector:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      44: pop
      45: aload_0
      46: ldc           #27                 // String nxlog
      48: ldc           #13                 // String exec
      50: ldc           #14                 // String linux
      52: ldc           #28                 // String /usr/bin/nxlog
      54: ldc           #29                 // String -f -c %s
      56: ldc           #30                 // String -v -c %s
      58: ldc           #31                 // String define ROOT /usr/bin\n\n<Extension gelfExt>\n  Module xm_gelf\n  # Avoid truncation of the short_message field to 64 characters.\n  ShortMessageLength 65536\n</Extension>\n\n<Extension syslogExt>\n  Module xm_syslog\n</Extension>\n\nUser nxlog\nGroup nxlog\n\nModuledir /usr/lib/nxlog/modules\nCacheDir /var/spool/collector-sidecar/nxlog\nPidFile /var/run/graylog-sidecar/nxlog.pid\nLogFile /var/log/graylog-sidecar/nxlog.log\nLogLevel INFO\n\n\n<Input file>\n\tModule im_file\n\tFile \'/var/log/*.log\'\n\tPollInterval 1\n\tSavePos\tTrue\n\tReadFromLast True\n\tRecursive False\n\tRenameCheck False\n\tExec $FileName = file_name(); # Send file name with each message\n</Input>\n\n#<Input syslog-udp>\n#\tModule im_udp\n#\tHost 127.0.0.1\n#\tPort 514\n#\tExec parse_syslog_bsd();\n#</Input>\n\n<Output gelf>\n\tModule om_tcp\n\tHost 192.168.1.1\n\tPort 12201\n\tOutputType  GELF_TCP\n\t<Exec>\n\t  # These fields are needed for Graylog\n\t  $gl2_source_collector = \'${sidecar.nodeId}\';\n\t  $collector_node_id = \'${sidecar.nodeName}\';\n\t</Exec>\n</Output>\n\n\n<Route route-1>\n  Path file => gelf\n</Route>\n#<Route route-2>\n#  Path syslog-udp => gelf\n#</Route>\n\n\n
      60: invokespecial #19                 // Method ensureCollector:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      63: pop
      64: aload_0
      65: ldc           #27                 // String nxlog
      67: ldc           #21                 // String svc
      69: ldc           #22                 // String windows
      71: ldc           #32                 // String C:\\Program Files (x86)\\nxlog\\nxlog.exe
      73: ldc           #24                 // String -c \"%s\"
      75: ldc           #33                 // String -v -f -c \"%s\"
      77: ldc           #34                 // String define ROOT C:\\Program Files (x86)\\nxlog\n\nModuledir %ROOT%\\modules\nCacheDir %ROOT%\\data\nPidfile %ROOT%\\data\\nxlog.pid\nSpoolDir %ROOT%\\data\nLogFile %ROOT%\\data\\nxlog.log\nLogLevel INFO\n\n<Extension logrotate>\n    Module  xm_fileop\n    <Schedule>\n        When    @daily\n        Exec    file_cycle(\'%ROOT%\\data\\nxlog.log\', 7);\n     </Schedule>\n</Extension>\n\n\n<Extension gelfExt>\n  Module xm_gelf\n  # Avoid truncation of the short_message field to 64 characters.\n  ShortMessageLength 65536\n</Extension>\n\n<Input eventlog>\n        Module im_msvistalog\n        PollInterval 1\n        SavePos True\n        ReadFromLast True\n        \n        #Channel System\n        #<QueryXML>\n        #  <QueryList>\n        #   <Query Id=\'1\'>\n        #    <Select Path=\'Security\'>*[System/Level=4]</Select>\n        #    </Query>\n        #  </QueryList>\n        #</QueryXML>\n</Input>\n\n\n<Input file>\n\tModule im_file\n\tFile \'C:\\Windows\\MyLogDir\\\\*.log\'\n\tPollInterval 1\n\tSavePos\tTrue\n\tReadFromLast True\n\tRecursive False\n\tRenameCheck False\n\tExec $FileName = file_name(); # Send file name with each message\n</Input>\n\n\n<Output gelf>\n\tModule om_tcp\n\tHost 192.168.1.1\n\tPort 12201\n\tOutputType  GELF_TCP\n\t<Exec>\n\t  # These fields are needed for Graylog\n\t  $gl2_source_collector = \'${sidecar.nodeId}\';\n\t  $collector_node_id = \'${sidecar.nodeName}\';\n\t</Exec>\n</Output>\n\n\n<Route route-1>\n  Path eventlog => gelf\n</Route>\n<Route route-2>\n  Path file => gelf\n</Route>\n\n
      79: invokespecial #19                 // Method ensureCollector:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      82: pop
      83: return

  private void removeConfigPath();
    Code:
       0: aload_0
       1: getfield      #7                  // Field collection:Lcom/mongodb/client/MongoCollection;
       4: ldc           #35                 // String configuration_path
       6: invokestatic  #36                 // Method com/mongodb/client/model/Filters.exists:(Ljava/lang/String;)Lorg/bson/conversions/Bson;
       9: invokeinterface #37,  2           // InterfaceMethod com/mongodb/client/MongoCollection.find:(Lorg/bson/conversions/Bson;)Lcom/mongodb/client/FindIterable;
      14: astore_1
      15: aload_1
      16: invokeinterface #38,  1           // InterfaceMethod com/mongodb/client/FindIterable.iterator:()Lcom/mongodb/client/MongoCursor;
      21: astore_2
      22: aload_2
      23: invokeinterface #39,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      28: ifeq          113
      31: aload_2
      32: invokeinterface #40,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      37: checkcast     #41                 // class org/bson/Document
      40: astore_3
      41: aload_3
      42: ldc           #42                 // String _id
      44: invokevirtual #43                 // Method org/bson/Document.getObjectId:(Ljava/lang/Object;)Lorg/bson/types/ObjectId;
      47: astore        4
      49: aload_3
      50: ldc           #35                 // String configuration_path
      52: invokevirtual #44                 // Method org/bson/Document.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      55: pop
      56: aload_0
      57: getfield      #7                  // Field collection:Lcom/mongodb/client/MongoCollection;
      60: ldc           #42                 // String _id
      62: aload         4
      64: invokestatic  #45                 // Method com/mongodb/client/model/Filters.eq:(Ljava/lang/String;Ljava/lang/Object;)Lorg/bson/conversions/Bson;
      67: aload_3
      68: invokeinterface #46,  3           // InterfaceMethod com/mongodb/client/MongoCollection.replaceOne:(Lorg/bson/conversions/Bson;Ljava/lang/Object;)Lcom/mongodb/client/result/UpdateResult;
      73: astore        5
      75: aload         5
      77: invokevirtual #47                 // Method com/mongodb/client/result/UpdateResult.wasAcknowledged:()Z
      80: ifeq          98
      83: getstatic     #48                 // Field LOG:Lorg/slf4j/Logger;
      86: ldc           #49                 // String Successfully updated document with ID <{}>
      88: aload         4
      90: invokeinterface #50,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      95: goto          110
      98: getstatic     #48                 // Field LOG:Lorg/slf4j/Logger;
     101: ldc           #51                 // String Failed to update document with ID <{}>
     103: aload         4
     105: invokeinterface #52,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;)V
     110: goto          22
     113: return

  private java.lang.String ensureCollector(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String);
    Code:
       0: aconst_null
       1: astore        8
       3: aload_0
       4: getfield      #2                  // Field collectorService:Lorg/graylog/plugins/sidecar/services/CollectorService;
       7: aload_1
       8: invokevirtual #53                 // Method org/graylog/plugins/sidecar/services/CollectorService.findByName:(Ljava/lang/String;)Lorg/graylog/plugins/sidecar/rest/models/Collector;
      11: astore        8
      13: aload         8
      15: ifnonnull     64
      18: new           #54                 // class java/lang/StringBuilder
      21: dup
      22: invokespecial #55                 // Method java/lang/StringBuilder."<init>":()V
      25: ldc           #56                 // String Couldn\'t find collector \'
      27: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      30: aload_1
      31: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      34: ldc           #58                 // String \' fixing it.
      36: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      39: invokevirtual #59                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      42: astore        9
      44: getstatic     #48                 // Field LOG:Lorg/slf4j/Logger;
      47: aload         9
      49: invokeinterface #60,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
      54: new           #61                 // class java/lang/IllegalArgumentException
      57: dup
      58: aload         9
      60: invokespecial #62                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      63: athrow
      64: goto          149
      67: astore        9
      69: getstatic     #48                 // Field LOG:Lorg/slf4j/Logger;
      72: ldc           #63                 // String {} collector is missing, adding it.
      74: aload_1
      75: invokeinterface #64,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      80: aconst_null
      81: aload_1
      82: aload_2
      83: aload_3
      84: aload         4
      86: aload         5
      88: aload         6
      90: aload         7
      92: invokestatic  #65                 // Method org/graylog/plugins/sidecar/rest/models/Collector.create:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/graylog/plugins/sidecar/rest/models/Collector;
      95: astore        10
      97: aload_0
      98: getfield      #2                  // Field collectorService:Lorg/graylog/plugins/sidecar/services/CollectorService;
     101: aload         10
     103: invokevirtual #66                 // Method org/graylog/plugins/sidecar/services/CollectorService.save:(Ljava/lang/Object;)Ljava/lang/Object;
     106: checkcast     #67                 // class org/graylog/plugins/sidecar/rest/models/Collector
     109: invokevirtual #68                 // Method org/graylog/plugins/sidecar/rest/models/Collector.id:()Ljava/lang/String;
     112: areturn
     113: astore        11
     115: getstatic     #48                 // Field LOG:Lorg/slf4j/Logger;
     118: new           #54                 // class java/lang/StringBuilder
     121: dup
     122: invokespecial #55                 // Method java/lang/StringBuilder."<init>":()V
     125: ldc           #70                 // String Can\'t save collector
     127: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     130: aload_1
     131: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     134: ldc           #71                 // String , please restart Graylog to fix this.
     136: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     139: invokevirtual #59                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     142: aload         11
     144: invokeinterface #72,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     149: aload         8
     151: ifnonnull     188
     154: getstatic     #48                 // Field LOG:Lorg/slf4j/Logger;
     157: new           #54                 // class java/lang/StringBuilder
     160: dup
     161: invokespecial #55                 // Method java/lang/StringBuilder."<init>":()V
     164: ldc           #73                 // String Unable to access fixed
     166: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     169: aload_1
     170: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     173: ldc           #74                 // String  collector, please restart Graylog to fix this.
     175: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     178: invokevirtual #59                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     181: invokeinterface #60,  2           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;)V
     186: aconst_null
     187: areturn
     188: aload         8
     190: invokevirtual #68                 // Method org/graylog/plugins/sidecar/rest/models/Collector.id:()Ljava/lang/String;
     193: areturn
    Exception table:
       from    to  target type
           3    64    67   Class java/lang/IllegalArgumentException
          97   112   113   Class java/lang/Exception

  static {};
    Code:
       0: ldc           #75                 // class org/graylog/plugins/sidecar/migrations/V20180212165000_AddDefaultCollectors
       2: invokestatic  #76                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #48                 // Field LOG:Lorg/slf4j/Logger;
       8: return
}
