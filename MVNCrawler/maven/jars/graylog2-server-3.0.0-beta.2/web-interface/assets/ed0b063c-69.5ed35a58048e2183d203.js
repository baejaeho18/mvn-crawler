(window.webpackJsonp=window.webpackJsonp||[]).push([["ed0b063c-69"],{DrcY3WOm:function(t,exports,e){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=g(e("ivGQtwpr")),a=g(e("ii0bleBb")),i=g(e("4KF7VOU5")),s=g(e("PcYM+wZ7")),c=e("nHcjWeCO"),o=g(e("W+sNG9T1")),r=e("wMSvutaJ"),l=e("wkvtUUMm"),d=g(e("+CppQpVm")),u=g(e("8GJ6oOEd")),p=e("oBIKikY9"),f=g(e("21p8kIWv")),m=g(e("F6dBIxHb")),h=g(e("w982HK6j")),k=g(e("OI/ji6gQ"));function g(t){return t&&t.__esModule?t:{default:t}}var P=f.default.get("Catalog"),E=P.CatalogActions,y=P.CatalogStore,S=f.default.get("ContentPacks"),v=S.ContentPacksActions,C=S.ContentPacksStore,b=(0,s.default)({displayName:"EditContentPackPage",propTypes:{params:a.default.object.isRequired},mixins:[i.default.connect(y),i.default.connect(C)],getInitialState:function(){return{selectedEntities:{},selectedStep:void 0,contentPackEntities:void 0,appliedParameter:{},entityCatalog:{}}},componentDidMount:function(){var n=this;v.get(this.props.params.contentPackId).then(function(){var t=n.props.params.contentPackRev,e=n.state.contentPackRevisions.createNewVersionFromRev(t);n.setState({contentPack:e,contentPackEntities:(0,c.cloneDeep)(e.entities)}),E.showEntityIndex().then(function(){n._createEntityCatalog(),n._getSelectedEntities(),n._getAppliedParameter()})})},_createEntityCatalog:function(){var n=this;if(this.state.contentPack&&this.state.entityIndex){var a=(0,c.groupBy)(this.state.contentPackEntities,"type.name"),t=Object.keys(this.state.entityIndex).reduce(function(t,e){return t[e]=n.state.entityIndex[e].concat(a[e]||[]),t},{});this.setState({entityCatalog:t})}},_getSelectedEntities:function(){var a=this;if(this.state.contentPack&&this.state.entityIndex){var t=this.state.contentPack.entities.reduce(function(t,e){if(a.state.entityCatalog[e.type.name]&&0<=a.state.entityCatalog[e.type.name].findIndex(function(t){return t.id===e.id})){var n=t;return n[e.type.name]=t[e.type.name]||[],n[e.type.name].push(e),n}return t},{});this.setState({selectedEntities:t})}},_getAppliedParameter:function(){var t=this.state.contentPack.entities.reduce(function(t,e){var n=new m.default(e.data).getPaths(),a=Object.keys(n).filter(function(t){return n[t].isValueParameter()}).map(function(t){return{configKey:t,paramName:n[t].getValue(),readOnly:!0}}),i=t;return 0<a.length&&(i[e.id]=a),i},{});this.setState({appliedParameter:t})},_onStateChanged:function(t){var e=t.contentPack||this.state.contentPack,n=t.selectedEntities||this.state.selectedEntities,a=t.appliedParameter||this.state.appliedParameter;this.setState({contentPack:e,selectedEntities:n,appliedParameter:a})},_onSave:function(){v.create.triggerPromise(this.state.contentPack.toJSON()).then(function(){u.default.success("Content pack imported successfully","Success!"),d.default.push(o.default.SYSTEM.CONTENTPACKS.LIST)},function(t){var e="";t.additional&&t.additional.body&&t.additional.body.message&&(e="<br /><small>".concat(t.additional.body.message,"</small>")),u.default.error("Error importing content pack, please ensure it is a valid JSON file. Check your Graylog logs for more information."+e,"Could not import content pack")})},_getEntities:function(a){var i=this;E.getSelectedEntities(a).then(function(t){var e=Object.keys(a).reduce(function(t,e){return t.concat(a[e])},[]).filter(function(t){return t.constructor.name===k.default.name}).concat(t.entities.map(function(t){return k.default.fromJSON(t,!0)})),n=i.state.contentPack.toBuilder().entities(e).build();i.setState({contentPack:n,fetchedEntities:n.entities})})},render:function(){return n.default.createElement(p.DocumentTitle,{title:"Content packs"},n.default.createElement("span",null,n.default.createElement(p.PageHeader,{title:"Edit content pack"},n.default.createElement("span",null,"Content packs accelerate the set up process for a specific data source. A content pack can include inputs/extractors, streams, and dashboards."),n.default.createElement("span",null,"Find more content packs in "," ",n.default.createElement("a",{href:"https://marketplace.graylog.org/",target:"_blank",rel:"noopener noreferrer"},"the Graylog Marketplace"),"."),n.default.createElement("div",null,n.default.createElement(l.LinkContainer,{to:o.default.SYSTEM.CONTENTPACKS.LIST},n.default.createElement(r.Button,{bsStyle:"info"},"Content Packs")))),n.default.createElement(h.default,{contentPack:this.state.contentPack,onGetEntities:this._getEntities,onStateChange:this._onStateChanged,fetchedEntities:this.state.fetchedEntities,selectedEntities:this.state.selectedEntities,entityIndex:this.state.entityCatalog,appliedParameter:this.state.appliedParameter,edit:!0,onSave:this._onSave})))}});exports.default=b,t.exports=exports.default}}]);