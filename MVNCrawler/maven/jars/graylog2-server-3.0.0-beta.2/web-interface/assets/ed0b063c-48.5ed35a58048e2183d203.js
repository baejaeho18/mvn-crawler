(window.webpackJsonp=window.webpackJsonp||[]).push([["ed0b063c-48"],{"UrhdzM4+":function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=o(t("ii0bleBb")),i=o(t("ivGQtwpr")),s=o(t("VPaD/Np4")),u=t("wMSvutaJ"),a=t("oBIKikY9");function o(e){return e&&e.__esModule?e:{default:e}}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var r=function(e){function r(){var e,i,t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return t=this,n=(e=c(r)).call.apply(e,[this].concat(a)),p(m(m(i=!n||"object"!==d(n)&&"function"!=typeof n?m(t):n)),"_toggleStreamReadPermissions",function(e){i._toggleReadPermissions("streams",s.default.Set.of(e.id))}),p(m(m(i)),"_toggleStreamEditPermissions",function(e){i._toggleEditPermissions("streams",s.default.Set.of(e.id))}),p(m(m(i)),"_toggleDashboardReadPermissions",function(e){i._toggleReadPermissions("dashboards",s.default.Set.of(e.id))}),p(m(m(i)),"_toggleDashboardEditPermissions",function(e){i._toggleEditPermissions("dashboards",s.default.Set.of(e.id))}),p(m(m(i)),"_toggleAllStreamsRead",function(e,t){i._toggleReadPermissions("streams",e,t)}),p(m(m(i)),"_toggleAllStreamsEdit",function(e,t){i._toggleEditPermissions("streams",e,t)}),p(m(m(i)),"_toggleAllDashboardsRead",function(e,t){i._toggleReadPermissions("dashboards",e,t)}),p(m(m(i)),"_toggleAllDashboardsEdit",function(e,t){i._toggleEditPermissions("dashboards",e,t)}),p(m(m(i)),"_toggleReadPermissions",function(o,e){var a=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],l=s.default.Set.of(),r=s.default.Set.of();e.forEach(function(e){var t="".concat(o,":read:").concat(e),n="".concat(o,":edit:").concat(e);i.props.permissions.contains(t)&&a?r=r.add(t).add(n):l=l.add(t)},m(m(i))),i.props.onChange(l,r)}),p(m(m(i)),"_toggleEditPermissions",function(o,e){var a=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],l=s.default.Set.of(),r=s.default.Set.of();e.forEach(function(e){var t="".concat(o,":read:").concat(e),n="".concat(o,":edit:").concat(e);i.props.permissions.contains(n)&&a?r=r.add(n):l=l.add(t).add(n)},m(m(i))),i.props.onChange(l,r)}),i}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(r,i.default.Component),t=r,(n=[{key:"render",value:function(){var r=this;return i.default.createElement("div",null,i.default.createElement(u.Tabs,{id:"permissionSelectorTabs",defaultActiveKey:1,animation:!1},i.default.createElement(u.Tab,{eventKey:1,title:"Streams"},i.default.createElement("div",{style:{marginTop:10}},i.default.createElement(a.TableList,{items:s.default.List(this.props.streams),filterLabel:"Filter Streams",filterKeys:["title"],itemActionsFactory:function(e){var t=r.props.permissions.contains("streams:read:".concat(e.id)),n=r.props.permissions.contains("streams:edit:".concat(e.id));return i.default.createElement(u.ButtonGroup,{bsSize:"small"},i.default.createElement(u.Button,{bsStyle:t?"info":"default",onClick:function(){return r._toggleStreamReadPermissions(e)},active:t},"Allow reading"),i.default.createElement(u.Button,{bsStyle:n?"info":"default",onClick:function(){return r._toggleStreamEditPermissions(e)},active:n},"Allow editing"))},bulkActionsFactory:function(t){var e=r.props.streams.filter(function(e){return t.contains(e.id)}),n=e.every(function(e){return r.props.permissions.contains("streams:read:".concat(e.id))}),o=e.every(function(e){return r.props.permissions.contains("streams:edit:".concat(e.id))}),a=n?"Clear":"Set",l=o?"Clear":"Set";return i.default.createElement(u.ButtonToolbar,null,i.default.createElement(u.Button,{bsSize:"xsmall",bsStyle:"info",onClick:function(){return r._toggleAllStreamsRead(t,n)}},a," read permissions"),i.default.createElement(u.Button,{bsSize:"xsmall",bsStyle:"info",onClick:function(){return r._toggleAllStreamsEdit(t,o)}},l," edit permissions"))}}))),i.default.createElement(u.Tab,{eventKey:2,title:"Dashboards"},i.default.createElement("div",{style:{marginTop:10}},i.default.createElement(a.TableList,{items:s.default.List(this.props.dashboards),filterLabel:"Filter Dashboards",filterKeys:["title"],itemActionsFactory:function(e){var t=r.props.permissions.contains("dashboards:read:".concat(e.id)),n=r.props.permissions.contains("dashboards:edit:".concat(e.id));return i.default.createElement(u.ButtonGroup,{bsSize:"small"},i.default.createElement(u.Button,{bsStyle:t?"info":"default",onClick:function(){return r._toggleDashboardReadPermissions(e)},active:t},"Allow reading"),i.default.createElement(u.Button,{bsStyle:n?"info":"default",onClick:function(){return r._toggleDashboardEditPermissions(e)},active:n},"Allow editing"))},bulkActionsFactory:function(t){var e=r.props.dashboards.filter(function(e){return t.contains(e.id)}),n=e.every(function(e){return r.props.permissions.contains("dashboards:read:".concat(e.id))}),o=e.every(function(e){return r.props.permissions.contains("dashboards:edit:".concat(e.id))}),a=n?"Clear":"Set",l=o?"Clear":"Set";return i.default.createElement("div",{className:"pull-right",style:{marginTop:10,marginBottom:10}},i.default.createElement(u.Button,{bsSize:"xsmall",bsStyle:"info",onClick:function(){return r._toggleAllDashboardsRead(t,n)}},a," read permissions")," ",i.default.createElement(u.Button,{bsSize:"xsmall",bsStyle:"info",onClick:function(){return r._toggleAllDashboardsEdit(t,o)}},l," edit permissions"))}})))))}}])&&l(t.prototype,n),o&&l(t,o),r}();p(r,"propTypes",{onChange:n.default.func,streams:n.default.object,dashboards:n.default.object,permissions:n.default.object});var h=r;exports.default=h,e.exports=exports.default},"ftef+NlM":function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=f(t("ivGQtwpr")),o=f(t("PcYM+wZ7")),a=f(t("4KF7VOU5")),l=f(t("VPaD/Np4")),r=t("wMSvutaJ"),i=f(t("8GJ6oOEd")),s=f(t("o7wa7hNA")),u=f(t("wSD4Q4lX")),d=f(t("BpTi3BgK")),c=f(t("21p8kIWv"));function f(e){return e&&e.__esModule?e:{default:e}}var m=c.default.get("Streams").StreamsStore,p=c.default.get("Dashboards"),h=p.DashboardsActions,b=p.DashboardsStore,y=c.default.get("Roles").RolesStore,v=(0,o.default)({displayName:"RolesComponent",mixins:[a.default.connect(b,"dashboards")],getInitialState:function(){return{roles:l.default.Set(),rolesLoaded:!1,editRole:null,streams:l.default.List()}},componentDidMount:function(){var t=this;this.loadRoles(),m.load(function(e){return t.setState({streams:l.default.List(e)})}),h.list()},loadRoles:function(){var t=this;y.loadRoles().then(function(e){t.setState({roles:l.default.Set(e),rolesLoaded:!0})})},_showCreateRole:function(){this.setState({showEditRole:!0})},_showEditRole:function(e){this.setState({showEditRole:!0,editRole:e})},_deleteRole:function(t){var n=this;window.confirm("Do you really want to delete role ".concat(t.name,"?"))&&y.getMembers(t.name).then(function(e){0!==e.users.length?i.default.error("Cannot delete role ".concat(t.name,". It is still assigned to ").concat(e.users.length," users.")):y.deleteRole(t.name).then(n.loadRoles)})},_saveRole:function(e,t){null===e?y.createRole(t).then(this._clearEditRole).then(this.loadRoles):y.updateRole(e,t).then(this._clearEditRole).then(this.loadRoles)},_clearEditRole:function(){this.setState({showEditRole:!1,editRole:null})},render:function(){var e,t=null;return t=this.state.rolesLoaded?this.state.showEditRole?n.default.createElement(u.default,{initialRole:this.state.editRole,streams:this.state.streams,dashboards:this.state.dashboards.dashboards,onSave:this._saveRole,cancelEdit:this._clearEditRole}):n.default.createElement(s.default,{roles:this.state.roles,showEditRole:this._showEditRole,deleteRole:this._deleteRole}):n.default.createElement("span",null,"Loading roles..."),this.state.showEditRole||(e=n.default.createElement(r.Button,{bsStyle:"success",onClick:this._showCreateRole},"Add new role")),n.default.createElement(r.Row,null,n.default.createElement(r.Col,{md:12},n.default.createElement(d.default,{title:"Roles",subpage:!0},n.default.createElement("span",null,"Roles bundle permissions which can be assigned to multiple users at once"),null,n.default.createElement("span",null,e)),t))}});exports.default=v,e.exports=exports.default},o7wa7hNA:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=c(t("ii0bleBb")),o=c(t("ivGQtwpr")),a=c(t("PcYM+wZ7")),l=c(t("4KF7VOU5")),r=c(t("GaFHk8Qk")),i=t("wMSvutaJ"),s=c(t("1VnJesae")),u=c(t("dOmQZ9N/")),d=t("oBIKikY9");function c(e){return e&&e.__esModule?e:{default:e}}var f=s.default.getStore("CurrentUser"),m=(0,a.default)({displayName:"RoleList",mixins:[l.default.connect(f),u.default],propTypes:{roles:r.default.set.isRequired,showEditRole:n.default.func.isRequired,deleteRole:n.default.func.isRequired},_headerCellFormatter:function(e){var t="Actions"===e?"actions":"";return o.default.createElement("th",{className:t},e)},_editButton:function(e){var t=this;return!1===this.isPermitted(this.state.currentUser.permissions,["roles:edit:"+e.name])||e.read_only?null:o.default.createElement(i.Button,{key:"edit",bsSize:"xsmall",bsStyle:"info",onClick:function(){return t.props.showEditRole(e)},title:"Edit role"},"Edit")},_deleteButton:function(e){var t=this;return!1===this.isPermitted(this.state.currentUser.permissions,["roles:delete:"+e.name])||e.read_only?null:o.default.createElement(i.Button,{key:"delete",bsSize:"xsmall",bsStyle:"primary",onClick:function(){return t.props.deleteRole(e)},title:"Delete role"},"Delete")},_roleInfoFormatter:function(e){return o.default.createElement("tr",{key:e.name},o.default.createElement("td",null,e.name),o.default.createElement("td",{className:"limited"},e.description),o.default.createElement("td",null,this._editButton(e),o.default.createElement("span",{key:"space"}," "),this._deleteButton(e)))},render:function(){return o.default.createElement("div",null,o.default.createElement(d.DataTable,{id:"role-list",className:"table-hover",headers:["Name","Description","Actions"],headerCellFormatter:this._headerCellFormatter,sortByKey:"name",rows:this.props.roles.toJS(),filterBy:"Name",dataRowFormatter:this._roleInfoFormatter,filterLabel:"Filter Roles",filterKeys:["name","description"]}))}});exports.default=m,e.exports=exports.default},t89qc4Et:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var l=n(t("ivGQtwpr")),r=t("wMSvutaJ"),i=n(t("ftef+NlM")),s=t("oBIKikY9");function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),d(this,c(t).apply(this,arguments))}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,l.default.Component),n=t,(o=[{key:"render",value:function(){return l.default.createElement(s.DocumentTitle,{title:"Roles"},l.default.createElement(r.Row,null,l.default.createElement(r.Col,{md:12},l.default.createElement(i.default,null))))}}])&&u(n.prototype,o),a&&u(n,a),t}();exports.default=a,e.exports=exports.default},wSD4Q4lX:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=d(t("ii0bleBb")),o=d(t("ivGQtwpr")),a=d(t("PcYM+wZ7")),l=d(t("VPaD/Np4")),r=t("wMSvutaJ"),i=t("B4BR5PLd"),s=d(t("UrhdzM4+")),u=d(t("dOmQZ9N/"));function d(e){return e&&e.__esModule?e:{default:e}}var c=(0,a.default)({displayName:"EditRole",propTypes:{initialRole:n.default.object,onSave:n.default.func.isRequired,cancelEdit:n.default.func.isRequired,streams:n.default.object,dashboards:n.default.object},mixins:[u.default],getInitialState:function(){var e=this.props.initialRole;return null===e&&(e={name:null,description:null,permissions:[]}),{role:e,initialName:this._safeRoleName(this.props.initialRole)}},componentWillReceiveProps:function(e){this.setState({role:e.initialRole,initialName:this._safeRoleName(e.initialRole)})},_safeRoleName:function(e){return null===e?null:e.name},_setName:function(e){this.state.role.name=e.target.value,this.setState({role:this.state.role})},_setDescription:function(e){this.state.role.description=e.target.value,this.setState({role:this.state.role})},_updatePermissions:function(e,t){var n=this.state.role;n.permissions=l.default.Set(n.permissions).subtract(t).union(e).toJS(),this.setState({role:n})},_saveDisabled:function(){return null===this.state.role||null===this.state.role.name||""===this.state.role.name||0===this.state.role.permissions.length},_onSave:function(){this.props.onSave(this.state.initialName,this.state.role)},render:function(){var e;e=null===this.state.initialName?"Create a new role":"Edit role ".concat(this.state.initialName);var t=this._saveDisabled(),n=null;return t&&(n=o.default.createElement(r.Alert,{bsStyle:"warning",style:{marginBottom:10}},"Please name the role and select at least one permission to save it.")),o.default.createElement(r.Row,null,o.default.createElement(r.Col,{md:12},o.default.createElement("h1",null,e),o.default.createElement("div",{style:{marginTop:10}},o.default.createElement(i.Input,{id:"role-name",type:"text",label:"Name",onChange:this._setName,value:this.state.role.name,required:!0}),o.default.createElement(i.Input,{id:"role-description",type:"text",label:"Description",onChange:this._setDescription,value:this.state.role.description}),o.default.createElement(r.FormGroup,null,o.default.createElement(r.ControlLabel,null,"Permissions"),o.default.createElement(r.HelpBlock,null,"Select the permissions for this role")),o.default.createElement(s.default,{streams:this.props.streams,dashboards:this.props.dashboards,permissions:l.default.Set(this.state.role.permissions),onChange:this._updatePermissions}),o.default.createElement("hr",null),n,o.default.createElement(r.Button,{onClick:this._onSave,style:{marginRight:5},bsStyle:"primary",disabled:t},"Save"),o.default.createElement(r.Button,{onClick:this.props.cancelEdit},"Cancel"))))}});exports.default=c,e.exports=exports.default}}]);