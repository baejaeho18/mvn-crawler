(window.webpackJsonp=window.webpackJsonp||[]).push([["ed0b063c-34"],{"BWw+xd8C":function(e,exports,t){var n=t("XUxbArCL");"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};t("HkU00dYq")(n,r);n.locals&&(e.exports=n.locals)},"Fw+JaZFf":function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=l(t("ii0bleBb")),a=l(t("ivGQtwpr")),o=t("wMSvutaJ"),r=l(t("1VnJesae")),s=t("oBIKikY9"),u=l(t("xuWExqBC")),i=l(t("mZFgrom6"));function l(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=r.default.getStore("Users"),y=r.default.getStore("Startpage"),v=function(e){function l(){var e,t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=this,r=(e=d(l)).call.apply(e,[this].concat(o)),h(m(m(t=!r||"object"!==c(r)&&"function"!=typeof r?m(n):r)),"state",{user:void 0}),h(m(m(t)),"_loadUser",function(e){b.load(e).then(function(e){t.setState({user:e})})}),h(m(m(t)),"_resetStartpage",function(){if(window.confirm("Are you sure you want to reset the start page?")){var e=t.props.params.username;y.set(e).then(function(){return t._loadUser(e)})}}),t}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(l,a.default.Component),t=l,(n=[{key:"componentDidMount",value:function(){this._loadUser(this.props.params.username)}},{key:"componentWillReceiveProps",value:function(e){this.props.params.username!==e.params.username&&this._loadUser(e.params.username)}},{key:"render",value:function(){if(!this.state.user)return a.default.createElement(s.Spinner,null);var e,t=this.state.user;!t.read_only&&null!==t.startpage&&0<Object.keys(t.startpage).length&&(e=a.default.createElement(o.Button,{bsStyle:"info",onClick:this._resetStartpage},"Reset custom startpage"));var n=t.read_only?null:a.default.createElement("span",{id:"react-user-preferences-button","data-user-name":this.props.params.username},a.default.createElement(i.default,{userName:t.username}));return a.default.createElement(s.DocumentTitle,{title:"Edit user ".concat(this.props.params.username)},a.default.createElement("span",null,a.default.createElement(s.PageHeader,{title:a.default.createElement("span",null,"Edit user ",a.default.createElement("em",null,this.props.params.username)),subpage:!0},a.default.createElement("span",null,"You can either change the details of a user here or set a new password."),null,a.default.createElement("div",null,e," ",n)),a.default.createElement(u.default,{user:this.state.user})))}}])&&f(t.prototype,n),r&&f(t,r),l}();h(v,"propTypes",{params:n.default.object.isRequired});var g=v;exports.default=g,e.exports=exports.default},XUxbArCL:function(e,exports,t){(exports=e.exports=t("wTjlWjHz")(!1)).push([e.i,"._1JCP9xI-zM9iz_soNhwBa_{margin-top:-15px;margin-bottom:20px}",""]),exports.locals={rolesMissingAlert:"_1JCP9xI-zM9iz_soNhwBa_"}},YrdwRziO:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n={setFieldValidity:function(e,t,n){"function"==typeof e.setCustomValidity&&e.setCustomValidity(t?n:"")}};exports.default=n,e.exports=exports.default},dMzYukQi:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=u(t("ii0bleBb")),r=u(t("ivGQtwpr")),a=u(t("PcYM+wZ7")),o=t("wMSvutaJ"),s=t("B4BR5PLd"),l=u(t("niSA6NTH"));function u(e){return e&&e.__esModule?e:{default:e}}var i=(0,a.default)({displayName:"TimeoutInput",propTypes:{controlSize:n.default.number,labelSize:n.default.number,value:n.default.number,onChange:n.default.func},getDefaultProps:function(){return{value:36e5,labelSize:2,controlSize:10}},getInitialState:function(){var e=this._estimateUnit(this.props.value);return{sessionTimeoutNever:!!this.props.value&&-1===this.props.value,value:this.props.value?Math.floor(this.props.value/e):0,unit:e}},getValue:function(){return this.state.sessionTimeoutNever?-1:this.timeout.value*this.session_timeout_unit.getValue()},MS_DAY:864e5,MS_HOUR:36e5,MS_MINUTE:6e4,MS_SECOND:1e3,_estimateUnit:function(e){return 0===e?this.MS_SECOND:e%this.MS_DAY==0?this.MS_DAY:e%this.MS_HOUR==0?this.MS_HOUR:e%this.MS_MINUTE==0?this.MS_MINUTE:this.MS_SECOND},_onClick:function(e){this.setState({sessionTimeoutNever:e.target.checked},this._notifyChange)},_onChangeValue:function(e){this.setState({value:e.target.value},this._notifyChange)},_onChangeUnit:function(e){this.setState({unit:e.target.value},this._notifyChange)},_notifyChange:function(){"function"==typeof this.props.onChange&&this.props.onChange(this.getValue())},render:function(){var t=this;return r.default.createElement("span",null,r.default.createElement(s.Input,{type:"checkbox",id:"session-timeout-never",name:"session_timeout_never",labelClassName:"col-sm-".concat(this.props.controlSize),wrapperClassName:"col-sm-offset-".concat(this.props.labelSize," col-sm-").concat(this.props.controlSize),label:"Sessions do not time out",help:"When checked sessions never time out due to inactivity.",onChange:this._onClick,checked:this.state.sessionTimeoutNever}),r.default.createElement(s.Input,{id:"timeout-controls",label:"Timeout",help:"Session automatically end after this amount of time, unless they are actively used.",labelClassName:"col-sm-".concat(this.props.labelSize),wrapperClassName:"col-sm-".concat(this.props.controlSize)},r.default.createElement(o.Row,null,r.default.createElement(o.Col,{sm:2},r.default.createElement("input",{ref:function(e){t.timeout=e},type:"number",id:"timeout",className:"session-timeout-fields validatable form-control",name:"timeout",min:1,"data-validate":"positive_number",disabled:this.state.sessionTimeoutNever,value:this.state.value,onChange:this._onChangeValue})),r.default.createElement(o.Col,{sm:3},r.default.createElement(l.default,{ref:function(e){t.session_timeout_unit=e},className:"form-control session-timeout-fields",disabled:this.state.sessionTimeoutNever,value:this.state.unit,onChange:this._onChangeUnit})))))}});exports.default=i,e.exports=exports.default},epYGURyS:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=a(t("ii0bleBb")),s=a(t("ivGQtwpr")),u=t("wMSvutaJ"),i=a(t("W+sNG9T1")),c=t("B4BR5PLd"),f=a(t("8GJ6oOEd")),d=a(t("s2hN4RJZ")),p=a(t("+CppQpVm")),r=a(t("1VnJesae")),m=a(t("uKl89mWU")),h=t("oBIKikY9"),b=a(t("BWw+xd8C"));function a(e){return e&&e.__esModule?e:{default:e}}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=r.default.getStore("Roles"),S=r.default.getStore("Users"),l=function(e){function l(){var e,r,t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return t=this,n=(e=v(l)).call.apply(e,[this].concat(o)),w(_(_(r=!n||"object"!==y(n)&&"function"!=typeof n?_(t):n)),"state",{newRoles:null}),w(_(_(r)),"_updateRoles",function(e){if(e.preventDefault(),confirm('Really update roles for "'.concat(r.props.user.username,'"?'))){var t=r.roles.getValue().filter(function(e){return""!==e}),n=d.default.clone(r.props.user);n.roles=t,S.update(r.props.user.username,n).then(function(){f.default.success("Roles updated successfully.","Success!"),p.default.replace(i.default.SYSTEM.AUTHENTICATION.USERS.LIST)},function(){f.default.error("Updating roles failed.","Error!")})}}),w(_(_(r)),"_onCancel",function(){p.default.push(i.default.SYSTEM.AUTHENTICATION.USERS.LIST)}),w(_(_(r)),"_onValueChange",function(e){var t=e.split(",");r.setState({newRoles:t})}),r}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(l,s.default.Component),t=l,(n=[{key:"componentDidMount",value:function(){var t=this;E.loadRoles().then(function(e){t.setState({roles:e.sort(function(e,t){return e.name.localeCompare(t.name)})})})}},{key:"render",value:function(){var t=this,e=this.props.user;if(!this.state.roles)return s.default.createElement(h.Spinner,null);var n=null,r=this.state.newRoles;null==r||r.includes("Reader")||r.includes("Admin")||(n=s.default.createElement(u.Alert,{bsStyle:"danger",role:"alert",className:b.default.rolesMissingAlert},"You need to select at least one of the ",s.default.createElement("em",null,"Reader")," or ",s.default.createElement("em",null,"Admin")," roles."));var a=e.external?s.default.createElement(u.Col,{smOffset:3,sm:9,style:{marginBottom:15}},s.default.createElement(u.Alert,{bsStyle:"warning",role:"alert"},"This user was created from an external LDAP system, please consider mapping LDAP groups instead of manually editing roles here. Please update the LDAP group mapping to make changes or contact an administrator for more information.")):null,o=e.read_only?s.default.createElement(u.Col,{smOffset:3,sm:9},s.default.createElement(u.Alert,{bsStyle:"warning",role:"alert"},"You cannot edit the admin's user role.")):s.default.createElement("span",null,a,s.default.createElement("form",{className:"form-horizontal",style:{marginTop:"10px"},onSubmit:this._updateRoles},s.default.createElement(c.Input,{id:"roles-select",label:"Roles",help:"Choose the roles the user should be a member of. All the granted permissions will be combined.",labelClassName:"col-sm-3",wrapperClassName:"col-sm-9"},s.default.createElement(m.default,{ref:function(e){t.roles=e},userRoles:e.roles,availableRoles:this.state.roles,onValueChange:this._onValueChange})),s.default.createElement("div",{className:"form-group"},s.default.createElement(u.Col,{smOffset:3,sm:9},n,s.default.createElement(u.Button,{bsStyle:"primary",type:"submit",className:"save-button-margin",disabled:!!n},"Update role"),s.default.createElement(u.Button,{onClick:this._onCancel},"Cancel")))));return s.default.createElement(u.Row,null,s.default.createElement(u.Col,{md:8},s.default.createElement("h2",null,"Change user role"),o))}}])&&o(t.prototype,n),r&&o(t,r),l}();w(l,"propTypes",{user:n.default.object.isRequired});var C=l;exports.default=C,e.exports=exports.default},hDgo9Y1A:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=a(t("ii0bleBb")),o=a(t("ivGQtwpr")),s=t("B4BR5PLd"),r=a(t("1VnJesae")),u=a(t("FOEh8xnd"));function a(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=r.default.getStore("Preferences"),l=function(e){function l(){var e,r,t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return t=this,n=(e=f(l)).call.apply(e,[this].concat(o)),m(p(p(r=!n||"object"!==i(n)&&"function"!=typeof n?p(t):n)),"state",{preferences:[]}),m(p(p(r)),"_onPreferenceChanged",function(e){var t=e.target.name,n=r.state.preferences.filter(function(e){return e.name===t})[0];n&&(n.value=e.target.value,r.setState({preferences:r.state.preferences}))}),m(p(p(r)),"_save",function(){h.saveUserPreferences(r.state.preferences,r.modal.close)}),m(p(p(r)),"openModal",function(){h.loadUserPreferences(r.props.userName,function(e){r.setState({preferences:e}),r.modal.open()})}),r}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(l,o.default.Component),t=l,(n=[{key:"render",value:function(){var r=this,a=!0,e=this.state.preferences.map(function(e,t){var n=o.default.createElement("div",{className:"form-group",key:"".concat(e.name,"-").concat(t)},o.default.createElement(s.Input,{type:"text",id:"".concat(e.name,"-").concat(t),name:e.name,label:e.name,onChange:r._onPreferenceChanged,value:e.value,required:!0,autoFocus:a}));return a&&(a=!1),n});return o.default.createElement(u.default,{ref:function(e){r.modal=e},title:"Preferences for user ".concat(this.props.userName),onSubmitForm:this._save,submitButtonText:"Save"},o.default.createElement("div",null,e))}}])&&c(t.prototype,n),r&&c(t,r),l}();m(l,"propTypes",{userName:n.default.string.isRequired});var b=l;exports.default=b,e.exports=exports.default},mZFgrom6:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=r(t("ii0bleBb")),a=r(t("ivGQtwpr")),o=t("wMSvutaJ"),s=r(t("hDgo9Y1A"));function r(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){function l(){var e,t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=this,r=(e=c(l)).call.apply(e,[this].concat(o)),p(d(d(t=!r||"object"!==u(r)&&"function"!=typeof r?d(n):r)),"onClick",function(){t.userPreferencesModal.openModal()}),t}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(l,a.default.Component),t=l,(n=[{key:"render",value:function(){var t=this;return a.default.createElement("span",null,a.default.createElement(o.Button,{onClick:this.onClick,bsStyle:"success"},"User preferences"),a.default.createElement(s.default,{ref:function(e){t.userPreferencesModal=e},userName:this.props.userName}))}}])&&i(t.prototype,n),r&&i(t,r),l}();p(l,"propTypes",{userName:n.default.string.isRequired});var m=l;exports.default=m,e.exports=exports.default},niSA6NTH:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n,a=(n=t("ivGQtwpr"))&&n.__esModule?n:{default:n};function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var r=function(e){function c(){var e,t,n,r,a,o,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var l=arguments.length,u=new Array(l),i=0;i<l;i++)u[i]=arguments[i];return n=this,r=(e=d(c)).call.apply(e,[this].concat(u)),t=!r||"object"!==f(r)&&"function"!=typeof r?p(n):r,a=p(p(t)),s=function(){return t.session_timeout_unit.value},(o="getValue")in a?Object.defineProperty(a,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[o]=s,t}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(c,a.default.Component),t=c,(n=[{key:"render",value:function(){var t=this;return a.default.createElement("select",o({className:"form-control",ref:function(e){t.session_timeout_unit=e}},this.props),a.default.createElement("option",{value:1e3},"Seconds"),a.default.createElement("option",{value:6e4},"Minutes"),a.default.createElement("option",{value:36e5},"Hours"),a.default.createElement("option",{value:864e5},"Days"))}}])&&s(t.prototype,n),r&&s(t,r),c}();exports.default=r,e.exports=exports.default},uKl89mWU:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=r(t("ii0bleBb")),a=r(t("ivGQtwpr")),o=r(t("f5bAsAu+"));function r(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){function l(){var e,t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=this,r=(e=i(l)).call.apply(e,[this].concat(o)),d(f(f(t=!r||"object"!==u(r)&&"function"!=typeof r?f(n):r)),"getValue",function(){return t.select.getValue().split(",")}),t}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(l,a.default.Component),t=l,(n=[{key:"render",value:function(){var t=this,e=this.props.userRoles.join(","),n=this.props.availableRoles.map(function(e){return{value:e.name,label:e.name}});return a.default.createElement(o.default,{ref:function(e){t.select=e},options:n,value:e,onChange:this.props.onValueChange,placeholder:"Choose roles..."})}}])&&s(t.prototype,n),r&&s(t,r),l}();d(l,"propTypes",{userRoles:n.default.arrayOf(n.default.string),availableRoles:n.default.array.isRequired,onValueChange:n.default.func}),d(l,"defaultProps",{userRoles:[]});var p=l;exports.default=p,e.exports=exports.default},xuWExqBC:function(e,exports,t){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=_(t("ii0bleBb")),i=_(t("ivGQtwpr")),r=_(t("PcYM+wZ7")),a=_(t("4KF7VOU5")),c=t("wMSvutaJ"),o=_(t("W+sNG9T1")),f=t("B4BR5PLd"),s=_(t("dOmQZ9N/")),l=_(t("8GJ6oOEd")),u=_(t("YrdwRziO")),d=_(t("L8npJDrf")),p=_(t("s2hN4RJZ")),m=_(t("+CppQpVm")),h=_(t("21p8kIWv")),b=_(t("1VnJesae")),y=_(t("dMzYukQi")),v=_(t("epYGURyS")),g=t("oBIKikY9");function _(e){return e&&e.__esModule?e:{default:e}}var w=b.default.getStore("Streams"),E=h.default.get("Dashboards").DashboardsStore,S=b.default.getStore("CurrentUser"),C=b.default.getStore("Users"),O=(0,r.default)({displayName:"UserForm",propTypes:{user:n.default.object.isRequired},mixins:[s.default,a.default.connect(S),a.default.connect(E)],getInitialState:function(){return{streams:void 0,user:this._getUserStateFromProps(this.props)}},componentDidMount:function(){var t=this;w.listStreams().then(function(e){t.setState({streams:e.sort(function(e,t){return e.title.localeCompare(t.title)})})})},componentWillReceiveProps:function(e){this.props.user.username!==e.user.username&&this.setState({user:this._getUserStateFromProps(e)})},inputs:{},_getUserStateFromProps:function(e){return{full_name:e.user.full_name,email:e.user.email,session_timeout_ms:e.user.session_timeout_ms,timezone:e.user.timezone,permissions:e.user.permissions,read_only:e.user.read_only,external:e.user.external,roles:e.user.roles}},formatMultiselectOptions:function(e){return e.map(function(e){return{value:e.id,label:e.title}})},formatSelectedOptions:function(t,n,e){var r=this;return e.filter(function(e){return r.isPermitted(t,["".concat(n,":").concat(e.id)])}).map(function(e){return e.id}).join(",")},_onPasswordChange:function(){var e=this.inputs.password.getInputDOMNode(),t=this.inputs.password_repeat.getInputDOMNode();""!==e.value&&""!==t.value&&u.default.setFieldValidity(t,e.value!==t.value,"Passwords do not match")},_changePassword:function(e){var t=this;e.preventDefault();var n={};this.inputs.old_password&&(n.old_password=this.inputs.old_password.getValue()),n.password=this.inputs.password.getValue(),C.changePassword(this.props.user.username,n).then(function(){l.default.success("Password updated successfully.","Success"),t.isPermitted(t.state.currentUser.permissions,["users:list"])&&m.default.replace(o.default.SYSTEM.AUTHENTICATION.USERS.LIST)},function(){l.default.error("Could not update password. Please verify that your current password is correct.","Updating password failed")})},_updateUser:function(e){var t=this;e.preventDefault(),C.update(this.props.user.username,this.state.user).then(function(){l.default.success("User updated successfully.","Success"),t.isPermitted(t.state.currentUser.permissions,["users:list"])&&m.default.replace(o.default.SYSTEM.AUTHENTICATION.USERS.LIST),t.props.user.username===t.state.currentUser.username&&S.reload()},function(){l.default.error("Could not update the user. Please check your logs for more information.","Updating user failed")})},_updateField:function(e,t){var n=p.default.clone(this.state.user);n[e]=t,this.setState({user:n})},_bindValue:function(e){this._updateField(e.target.name,d.default.getValueFromInput(e.target))},_onFieldChange:function(t){var n=this;return function(e){n._updateField(t,e)}},_onPermissionsChange:function(o,s){var l=this;return function(e){var t=l.state.user.permissions.slice(),r=t.filter(function(e){return 0!==e.indexOf("".concat(o,":").concat(s))}),a=""===e?[]:e.split(",").map(function(e){return"".concat(o,":").concat(s,":").concat(e)}),n=t.filter(function(e){return 0===e.indexOf("".concat(o,":").concat(s))});"read"===s&&n.forEach(function(t){if(!a.some(function(e){return e===t})){var n=t.split(":").pop();r=r.filter(function(e){return e!=="".concat(o,":edit:").concat(n)})}}),"edit"===s&&a.forEach(function(t){if(!n.some(function(e){return e===t})){var e=t.split(":").pop();r.push("".concat(o,":read:").concat(e))}}),l._updateField("permissions",r.concat(a))}},_onCancel:function(){m.default.goBack()},render:function(){var t=this;if(!this.state.streams||!this.state.dashboards)return i.default.createElement(g.Spinner,null);var e=this.state.user,n=this.state.currentUser.permissions,r=this.state.dashboards.toArray().sort(function(e,t){return e.title.localeCompare(t.title)}),a=!0;this.isPermitted(n,"users:passwordchange:*")&&(a=this.props.user.username===this.state.currentUser.username);var o=this.formatSelectedOptions(this.state.user.permissions,"streams:read",this.state.streams),s=this.formatSelectedOptions(this.state.user.permissions,"streams:edit",this.state.streams),l=this.formatSelectedOptions(this.state.user.permissions,"dashboards:read",r),u=this.formatSelectedOptions(this.state.user.permissions,"dashboards:edit",r);return i.default.createElement("div",null,i.default.createElement(c.Row,null,i.default.createElement(c.Col,{lg:8},i.default.createElement("h2",null,"User information"),i.default.createElement("form",{className:"form-horizontal user-form",id:"edit-user-form",onSubmit:this._updateUser},e.read_only&&i.default.createElement("span",null,i.default.createElement(c.Col,{smOffset:3,sm:9},i.default.createElement(c.Alert,{bsStyle:"warning",role:"alert"},"The admin user can only be modified in your Graylog server configuration file.")),i.default.createElement("div",{className:"clearfix"}),i.default.createElement("br",null)),i.default.createElement("fieldset",{disabled:e.read_only},i.default.createElement(f.Input,{name:"full_name",id:"full_name",type:"text",maxLength:200,value:e.full_name,onChange:this._bindValue,labelClassName:"col-sm-3",wrapperClassName:"col-sm-9",label:"Full Name",help:"Give a descriptive name for this account, e.g. the full name.",required:!0}),i.default.createElement(f.Input,{ref:function(e){t.inputs.email=e},name:"email",id:"email",type:"email",maxLength:254,value:e.email,onChange:this._bindValue,labelClassName:"col-sm-3",wrapperClassName:"col-sm-9",label:"Email Address",help:"Give the contact email address.",required:!0}),i.default.createElement(g.IfPermitted,{permissions:"users:edit"},i.default.createElement("span",null,i.default.createElement("div",{className:"form-group"},i.default.createElement(c.Col,{sm:9,smOffset:3},i.default.createElement(c.Panel,{bsStyle:"danger",header:"Setting individual permissions is deprecated, please consider migrating to roles instead."},"The permissions listed here are the result of combining all granted permissions by the roles assigned to a user, which you can edit at the bottom of this page, as well as legacy, individual permissions which were assigned to the user before.")),i.default.createElement("label",{className:"col-sm-3 control-label",htmlFor:"streampermissions"},"Streams Permissions"),i.default.createElement(c.Col,{sm:9},i.default.createElement(g.MultiSelect,{ref:function(e){t.inputs.streamReadOptions=e},placeholder:"Choose streams read permissions...",options:this.formatMultiselectOptions(this.state.streams),value:o,onChange:this._onPermissionsChange("streams","read")}),i.default.createElement("span",{className:"help-block"},"Choose streams the user can ",i.default.createElement("strong",null,"view"),". Removing read access will remove edit access, too."),i.default.createElement(g.MultiSelect,{ref:function(e){t.inputs.streamEditOptions=e},placeholder:"Choose streams edit permissions...",options:this.formatMultiselectOptions(this.state.streams),value:s,onChange:this._onPermissionsChange("streams","edit")}),i.default.createElement("span",{className:"help-block"},"Choose the streams the user can ",i.default.createElement("strong",null,"edit"),". Values chosen here will enable read access, too."))),i.default.createElement("div",{className:"form-group"},i.default.createElement("label",{className:"col-sm-3 control-label",htmlFor:"dashboardpermissions"},"Dashboard Permissions"),i.default.createElement(c.Col,{sm:9},i.default.createElement(g.MultiSelect,{ref:function(e){t.inputs.dashboardReadOptions=e},placeholder:"Choose dashboards read permissions...",options:this.formatMultiselectOptions(r),value:l,onChange:this._onPermissionsChange("dashboards","read")}),i.default.createElement("span",{className:"help-block"},"Choose dashboards the user can ",i.default.createElement("strong",null,"view"),". Removing read access will remove edit access, too."),i.default.createElement(g.MultiSelect,{ref:function(e){t.inputs.dashboardEditOptions=e},placeholder:"Choose dashboards edit permissions...",options:this.formatMultiselectOptions(r),value:u,onChange:this._onPermissionsChange("dashboards","edit")}),i.default.createElement("span",{className:"help-block"},"Choose dashboards the user can ",i.default.createElement("strong",null,"edit"),". Values chosen here will enable read access, too."))))),i.default.createElement(g.IfPermitted,{permissions:"*"},i.default.createElement(y.default,{ref:function(e){t.inputs.session_timeout_ms=e},value:e.session_timeout_ms,labelSize:3,controlSize:9,onChange:this._onFieldChange("session_timeout_ms")})),i.default.createElement(f.Input,{id:"timezone-select",label:"Time Zone",help:"Choose your local time zone or leave it as it is to use the system's default.",labelClassName:"col-sm-3",wrapperClassName:"col-sm-9"},i.default.createElement(g.TimezoneSelect,{ref:function(e){t.inputs.timezone=e},className:"timezone-select",value:e.timezone,onChange:this._onFieldChange("timezone")})),i.default.createElement("div",{className:"form-group"},i.default.createElement(c.Col,{smOffset:3,sm:9},i.default.createElement(c.Button,{type:"submit",bsStyle:"primary",className:"create-user save-button-margin"},"Update User"),i.default.createElement(c.Button,{onClick:this._onCancel},"Cancel"))))))),i.default.createElement(c.Row,null,i.default.createElement(c.Col,{lg:8},i.default.createElement("h2",null,"Change password"),e.read_only?i.default.createElement(c.Col,{smOffset:3,sm:9},i.default.createElement(c.Alert,{bsStyle:"warning",role:"alert"},"Please edit your Graylog server configuration file to change the admin password.")):e.external?i.default.createElement(c.Col,{smOffset:3,sm:9},i.default.createElement(c.Alert,{bsStyle:"warning",role:"alert"},"This user was created from an external system and you can't change the password here. Please contact an administrator for more information.")):i.default.createElement("form",{className:"form-horizontal",style:{marginTop:10},onSubmit:this._changePassword},a&&i.default.createElement(f.Input,{ref:function(e){t.inputs.old_password=e},name:"old_password",id:"old_password",type:"password",maxLength:100,labelClassName:"col-sm-3",wrapperClassName:"col-sm-9",label:"Old Password",required:!0}),i.default.createElement(f.Input,{ref:function(e){t.inputs.password=e},name:"password",id:"password",type:"password",maxLength:100,labelClassName:"col-sm-3",wrapperClassName:"col-sm-9",label:"New Password",required:!0,minLength:"6",help:"Passwords must be at least 6 characters long. We recommend using a strong password.",onChange:this._onPasswordChange}),i.default.createElement(f.Input,{ref:function(e){t.inputs.password_repeat=e},name:"password_repeat",id:"password_repeat",type:"password",maxLength:100,labelClassName:"col-sm-3",wrapperClassName:"col-sm-9",label:"Repeat Password",required:!0,minLength:"6",onChange:this._onPasswordChange}),i.default.createElement("div",{className:"form-group"},i.default.createElement(c.Col,{smOffset:3,sm:9},i.default.createElement(c.Button,{bsStyle:"primary",type:"submit",className:"save-button-margin"},"Update Password"),i.default.createElement(c.Button,{onClick:this._onCancel},"Cancel")))))),i.default.createElement(g.IfPermitted,{permissions:"users:rolesedit"},i.default.createElement(v.default,{user:this.props.user})))}});exports.default=O,e.exports=exports.default}}]);