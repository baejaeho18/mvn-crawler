Compiled from "AuthenticationTestBase.java"
public abstract class io.undertow.server.security.AuthenticationTestBase {
  private static final java.nio.charset.Charset UTF_8;

  protected static final io.undertow.security.idm.IdentityManager identityManager;

  protected static final io.undertow.server.security.AuthenticationTestBase$AuditReceiver auditReceiver;

  public io.undertow.server.security.AuthenticationTestBase();
    Code:
       0: aload_0
       1: invokespecial #2                  // Method java/lang/Object."<init>":()V
       4: return

  public void setAuthenticationChain();
    Code:
       0: aload_0
       1: invokevirtual #3                  // Method getTestMechanisms:()Ljava/util/List;
       4: astore_1
       5: aload_1
       6: ifnonnull     10
       9: return
      10: new           #4                  // class io/undertow/server/security/AuthenticationTestBase$ResponseHandler
      13: dup
      14: invokespecial #5                  // Method io/undertow/server/security/AuthenticationTestBase$ResponseHandler."<init>":()V
      17: astore_2
      18: new           #6                  // class io/undertow/security/handlers/AuthenticationCallHandler
      21: dup
      22: aload_2
      23: invokespecial #7                  // Method io/undertow/security/handlers/AuthenticationCallHandler."<init>":(Lio/undertow/server/HttpHandler;)V
      26: astore_2
      27: new           #8                  // class io/undertow/security/handlers/AuthenticationConstraintHandler
      30: dup
      31: aload_2
      32: invokespecial #9                  // Method io/undertow/security/handlers/AuthenticationConstraintHandler."<init>":(Lio/undertow/server/HttpHandler;)V
      35: astore_2
      36: new           #10                 // class io/undertow/security/handlers/AuthenticationMechanismsHandler
      39: dup
      40: aload_2
      41: aload_1
      42: invokespecial #11                 // Method io/undertow/security/handlers/AuthenticationMechanismsHandler."<init>":(Lio/undertow/server/HttpHandler;Ljava/util/List;)V
      45: astore_2
      46: getstatic     #12                 // Field auditReceiver:Lio/undertow/server/security/AuthenticationTestBase$AuditReceiver;
      49: invokevirtual #13                 // Method io/undertow/server/security/AuthenticationTestBase$AuditReceiver.takeNotifications:()Ljava/util/List;
      52: pop
      53: new           #14                 // class io/undertow/security/handlers/NotificationReceiverHandler
      56: dup
      57: aload_2
      58: getstatic     #12                 // Field auditReceiver:Lio/undertow/server/security/AuthenticationTestBase$AuditReceiver;
      61: invokestatic  #15                 // Method java/util/Collections.singleton:(Ljava/lang/Object;)Ljava/util/Set;
      64: invokespecial #16                 // Method io/undertow/security/handlers/NotificationReceiverHandler."<init>":(Lio/undertow/server/HttpHandler;Ljava/util/Collection;)V
      67: astore_2
      68: aload_0
      69: invokevirtual #17                 // Method cachingRequired:()Z
      72: ifeq          84
      75: new           #18                 // class io/undertow/security/handlers/CachedAuthenticatedSessionHandler
      78: dup
      79: aload_2
      80: invokespecial #19                 // Method io/undertow/security/handlers/CachedAuthenticatedSessionHandler."<init>":(Lio/undertow/server/HttpHandler;)V
      83: astore_2
      84: new           #20                 // class io/undertow/security/handlers/SecurityInitialHandler
      87: dup
      88: getstatic     #21                 // Field io/undertow/security/api/AuthenticationMode.PRO_ACTIVE:Lio/undertow/security/api/AuthenticationMode;
      91: getstatic     #22                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
      94: aload_2
      95: invokespecial #23                 // Method io/undertow/security/handlers/SecurityInitialHandler."<init>":(Lio/undertow/security/api/AuthenticationMode;Lio/undertow/security/idm/IdentityManager;Lio/undertow/server/HttpHandler;)V
      98: astore_2
      99: aload_0
     100: aload_2
     101: invokevirtual #24                 // Method setRootHandler:(Lio/undertow/server/HttpHandler;)V
     104: return

  protected boolean cachingRequired();
    Code:
       0: iconst_0
       1: ireturn

  protected void setRootHandler(io.undertow.server.HttpHandler);
    Code:
       0: aload_1
       1: invokestatic  #25                 // Method io/undertow/testutils/DefaultServer.setRootHandler:(Lio/undertow/server/HttpHandler;)V
       4: return

  protected abstract java.util.List<io.undertow.security.api.AuthenticationMechanism> getTestMechanisms();

  public void testNoMechanisms() throws java.lang.Exception;
    Code:
       0: new           #4                  // class io/undertow/server/security/AuthenticationTestBase$ResponseHandler
       3: dup
       4: invokespecial #5                  // Method io/undertow/server/security/AuthenticationTestBase$ResponseHandler."<init>":()V
       7: invokestatic  #25                 // Method io/undertow/testutils/DefaultServer.setRootHandler:(Lio/undertow/server/HttpHandler;)V
      10: new           #26                 // class io/undertow/testutils/TestHttpClient
      13: dup
      14: invokespecial #27                 // Method io/undertow/testutils/TestHttpClient."<init>":()V
      17: astore_1
      18: new           #28                 // class org/apache/http/client/methods/HttpGet
      21: dup
      22: invokestatic  #29                 // Method io/undertow/testutils/DefaultServer.getDefaultServerURL:()Ljava/lang/String;
      25: invokespecial #30                 // Method org/apache/http/client/methods/HttpGet."<init>":(Ljava/lang/String;)V
      28: astore_2
      29: aload_1
      30: aload_2
      31: invokevirtual #31                 // Method io/undertow/testutils/TestHttpClient.execute:(Lorg/apache/http/client/methods/HttpUriRequest;)Lorg/apache/http/HttpResponse;
      34: astore_3
      35: ldc2_w        #33                 // long 200l
      38: aload_3
      39: invokeinterface #35,  1           // InterfaceMethod org/apache/http/HttpResponse.getStatusLine:()Lorg/apache/http/StatusLine;
      44: invokeinterface #36,  1           // InterfaceMethod org/apache/http/StatusLine.getStatusCode:()I
      49: i2l
      50: invokestatic  #37                 // Method org/junit/Assert.assertEquals:(JJ)V
      53: aload_3
      54: ldc           #38                 // String ProcessedBy
      56: invokeinterface #39,  2           // InterfaceMethod org/apache/http/HttpResponse.getHeaders:(Ljava/lang/String;)[Lorg/apache/http/Header;
      61: astore        4
      63: lconst_1
      64: aload         4
      66: arraylength
      67: i2l
      68: invokestatic  #37                 // Method org/junit/Assert.assertEquals:(JJ)V
      71: ldc           #40                 // String ResponseHandler
      73: aload         4
      75: iconst_0
      76: aaload
      77: invokeinterface #41,  1           // InterfaceMethod org/apache/http/Header.getValue:()Ljava/lang/String;
      82: invokestatic  #42                 // Method org/junit/Assert.assertEquals:(Ljava/lang/Object;Ljava/lang/Object;)V
      85: return

  protected static void assertSingleNotificationType(io.undertow.security.api.SecurityNotification$EventType);
    Code:
       0: getstatic     #12                 // Field auditReceiver:Lio/undertow/server/security/AuthenticationTestBase$AuditReceiver;
       3: invokevirtual #13                 // Method io/undertow/server/security/AuthenticationTestBase$AuditReceiver.takeNotifications:()Ljava/util/List;
       6: astore_1
       7: ldc           #43                 // String A single notification is expected.
       9: lconst_1
      10: aload_1
      11: invokeinterface #44,  1           // InterfaceMethod java/util/List.size:()I
      16: i2l
      17: invokestatic  #45                 // Method org/junit/Assert.assertEquals:(Ljava/lang/String;JJ)V
      20: ldc           #46                 // String Expected EventType not matched.
      22: aload_0
      23: aload_1
      24: iconst_0
      25: invokeinterface #47,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      30: checkcast     #48                 // class io/undertow/security/api/SecurityNotification
      33: invokevirtual #49                 // Method io/undertow/security/api/SecurityNotification.getEventType:()Lio/undertow/security/api/SecurityNotification$EventType;
      36: invokestatic  #50                 // Method org/junit/Assert.assertEquals:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      39: return

  protected static void assertNotifiactions(io.undertow.security.api.SecurityNotification$EventType...);
    Code:
       0: getstatic     #12                 // Field auditReceiver:Lio/undertow/server/security/AuthenticationTestBase$AuditReceiver;
       3: invokevirtual #13                 // Method io/undertow/server/security/AuthenticationTestBase$AuditReceiver.takeNotifications:()Ljava/util/List;
       6: astore_1
       7: ldc           #43                 // String A single notification is expected.
       9: aload_0
      10: arraylength
      11: i2l
      12: aload_1
      13: invokeinterface #44,  1           // InterfaceMethod java/util/List.size:()I
      18: i2l
      19: invokestatic  #45                 // Method org/junit/Assert.assertEquals:(Ljava/lang/String;JJ)V
      22: new           #51                 // class java/util/ArrayList
      25: dup
      26: invokespecial #52                 // Method java/util/ArrayList."<init>":()V
      29: astore_2
      30: aload_1
      31: invokeinterface #53,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      36: astore_3
      37: aload_3
      38: invokeinterface #54,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      43: ifeq          72
      46: aload_3
      47: invokeinterface #55,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      52: checkcast     #48                 // class io/undertow/security/api/SecurityNotification
      55: astore        4
      57: aload_2
      58: aload         4
      60: invokevirtual #49                 // Method io/undertow/security/api/SecurityNotification.getEventType:()Lio/undertow/security/api/SecurityNotification$EventType;
      63: invokeinterface #56,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
      68: pop
      69: goto          37
      72: ldc           #46                 // String Expected EventType not matched.
      74: aload_0
      75: invokestatic  #57                 // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
      78: aload_2
      79: invokestatic  #50                 // Method org/junit/Assert.assertEquals:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      82: return

  protected static java.lang.String getAuthenticatedUser(io.undertow.server.HttpServerExchange);
    Code:
       0: aload_0
       1: invokevirtual #58                 // Method io/undertow/server/HttpServerExchange.getSecurityContext:()Lio/undertow/security/api/SecurityContext;
       4: astore_1
       5: aload_1
       6: ifnull        32
       9: aload_1
      10: invokeinterface #59,  1           // InterfaceMethod io/undertow/security/api/SecurityContext.getAuthenticatedAccount:()Lio/undertow/security/idm/Account;
      15: astore_2
      16: aload_2
      17: ifnull        32
      20: aload_2
      21: invokeinterface #60,  1           // InterfaceMethod io/undertow/security/idm/Account.getPrincipal:()Ljava/security/Principal;
      26: invokeinterface #61,  1           // InterfaceMethod java/security/Principal.getName:()Ljava/lang/String;
      31: areturn
      32: aconst_null
      33: areturn

  protected static java.lang.String getAuthHeader(io.undertow.util.HttpString, org.apache.http.Header[]);
    Code:
       0: aload_1
       1: astore_2
       2: aload_2
       3: arraylength
       4: istore_3
       5: iconst_0
       6: istore        4
       8: iload         4
      10: iload_3
      11: if_icmpge     50
      14: aload_2
      15: iload         4
      17: aaload
      18: astore        5
      20: aload         5
      22: invokeinterface #41,  1           // InterfaceMethod org/apache/http/Header.getValue:()Ljava/lang/String;
      27: astore        6
      29: aload         6
      31: aload_0
      32: invokevirtual #62                 // Method io/undertow/util/HttpString.toString:()Ljava/lang/String;
      35: invokevirtual #63                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      38: ifeq          44
      41: aload         6
      43: areturn
      44: iinc          4, 1
      47: goto          8
      50: ldc           #64                 // String Expected header not found.
      52: invokestatic  #65                 // Method org/junit/Assert.fail:(Ljava/lang/String;)V
      55: aconst_null
      56: areturn

  static java.nio.charset.Charset access$000();
    Code:
       0: getstatic     #1                  // Field UTF_8:Ljava/nio/charset/Charset;
       3: areturn

  static {};
    Code:
       0: getstatic     #66                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
       3: putstatic     #1                  // Field UTF_8:Ljava/nio/charset/Charset;
       6: new           #67                 // class io/undertow/server/security/AuthenticationTestBase$AuditReceiver
       9: dup
      10: invokespecial #68                 // Method io/undertow/server/security/AuthenticationTestBase$AuditReceiver."<init>":()V
      13: putstatic     #12                 // Field auditReceiver:Lio/undertow/server/security/AuthenticationTestBase$AuditReceiver;
      16: new           #69                 // class java/util/HashSet
      19: dup
      20: invokespecial #70                 // Method java/util/HashSet."<init>":()V
      23: astore_0
      24: aload_0
      25: ldc           #71                 // String CN=Test Client,OU=OU,O=Org,L=City,ST=State,C=GB
      27: invokeinterface #72,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      32: pop
      33: new           #69                 // class java/util/HashSet
      36: dup
      37: invokespecial #70                 // Method java/util/HashSet."<init>":()V
      40: astore_1
      41: aload_1
      42: ldc           #73                 // String jduke@UNDERTOW.IO
      44: invokeinterface #72,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
      49: pop
      50: new           #74                 // class java/util/HashMap
      53: dup
      54: iconst_2
      55: invokespecial #75                 // Method java/util/HashMap."<init>":(I)V
      58: astore_2
      59: aload_2
      60: ldc           #76                 // String userOne
      62: ldc           #77                 // String passwordOne
      64: invokevirtual #78                 // Method java/lang/String.toCharArray:()[C
      67: invokeinterface #79,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      72: pop
      73: aload_2
      74: ldc           #80                 // String userTwo
      76: ldc           #81                 // String passwordTwo
      78: invokevirtual #78                 // Method java/lang/String.toCharArray:()[C
      81: invokeinterface #79,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      86: pop
      87: aload_2
      88: ldc           #82                 // String encodingUser
      90: ldc           #83                 // String password-Ã¼
      92: invokevirtual #78                 // Method java/lang/String.toCharArray:()[C
      95: invokeinterface #79,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     100: pop
     101: new           #84                 // class io/undertow/server/security/AuthenticationTestBase$1
     104: dup
     105: aload_0
     106: aload_1
     107: aload_2
     108: invokespecial #85                 // Method io/undertow/server/security/AuthenticationTestBase$1."<init>":(Ljava/util/Set;Ljava/util/Set;Ljava/util/Map;)V
     111: putstatic     #22                 // Field identityManager:Lio/undertow/security/idm/IdentityManager;
     114: return
}
