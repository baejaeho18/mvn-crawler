Compiled from "OAuth2AuthorizationCodeAuthenticationProvider.java"
public final class cn.herodotus.engine.oauth2.authentication.provider.OAuth2AuthorizationCodeAuthenticationProvider extends cn.herodotus.engine.oauth2.authentication.provider.AbstractAuthenticationProvider {
  private static final org.slf4j.Logger log;

  private static final java.lang.String ERROR_URI;

  private static final org.springframework.security.oauth2.server.authorization.OAuth2TokenType AUTHORIZATION_CODE_TOKEN_TYPE;

  private final org.springframework.security.oauth2.server.authorization.OAuth2AuthorizationService authorizationService;

  private final org.springframework.security.oauth2.server.authorization.token.OAuth2TokenGenerator<? extends org.springframework.security.oauth2.core.OAuth2Token> tokenGenerator;

  private org.springframework.security.core.session.SessionRegistry sessionRegistry;

  public cn.herodotus.engine.oauth2.authentication.provider.OAuth2AuthorizationCodeAuthenticationProvider(org.springframework.security.oauth2.server.authorization.OAuth2AuthorizationService, org.springframework.security.oauth2.server.authorization.token.OAuth2TokenGenerator<? extends org.springframework.security.oauth2.core.OAuth2Token>);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method cn/herodotus/engine/oauth2/authentication/provider/AbstractAuthenticationProvider."<init>":()V
       4: aload_1
       5: ldc           #7                  // String authorizationService cannot be null
       7: invokestatic  #9                  // Method org/springframework/util/Assert.notNull:(Ljava/lang/Object;Ljava/lang/String;)V
      10: aload_2
      11: ldc           #15                 // String tokenGenerator cannot be null
      13: invokestatic  #9                  // Method org/springframework/util/Assert.notNull:(Ljava/lang/Object;Ljava/lang/String;)V
      16: aload_0
      17: aload_1
      18: putfield      #17                 // Field authorizationService:Lorg/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService;
      21: aload_0
      22: aload_2
      23: putfield      #23                 // Field tokenGenerator:Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;
      26: return

  public org.springframework.security.core.Authentication authenticate(org.springframework.security.core.Authentication) throws org.springframework.security.core.AuthenticationException;
    Code:
       0: aload_1
       1: checkcast     #27                 // class org/springframework/security/oauth2/server/authorization/authentication/OAuth2AuthorizationCodeAuthenticationToken
       4: astore_2
       5: aload_2
       6: invokestatic  #29                 // Method cn/herodotus/engine/oauth2/authentication/utils/OAuth2AuthenticationProviderUtils.getAuthenticatedClientElseThrowInvalidClient:(Lorg/springframework/security/core/Authentication;)Lorg/springframework/security/oauth2/server/authorization/authentication/OAuth2ClientAuthenticationToken;
       9: astore_3
      10: aload_3
      11: invokevirtual #35                 // Method org/springframework/security/oauth2/server/authorization/authentication/OAuth2ClientAuthenticationToken.getRegisteredClient:()Lorg/springframework/security/oauth2/server/authorization/client/RegisteredClient;
      14: astore        4
      16: getstatic     #41                 // Field log:Lorg/slf4j/Logger;
      19: ldc           #45                 // String Retrieved registered client
      21: invokeinterface #47,  2           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;)V
      26: aload_0
      27: getfield      #17                 // Field authorizationService:Lorg/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService;
      30: aload_2
      31: invokevirtual #53                 // Method org/springframework/security/oauth2/server/authorization/authentication/OAuth2AuthorizationCodeAuthenticationToken.getCode:()Ljava/lang/String;
      34: getstatic     #57                 // Field AUTHORIZATION_CODE_TOKEN_TYPE:Lorg/springframework/security/oauth2/server/authorization/OAuth2TokenType;
      37: invokeinterface #61,  3           // InterfaceMethod org/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService.findByToken:(Ljava/lang/String;Lorg/springframework/security/oauth2/server/authorization/OAuth2TokenType;)Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;
      42: astore        5
      44: aload         5
      46: ifnonnull     59
      49: new           #67                 // class org/springframework/security/oauth2/core/OAuth2AuthenticationException
      52: dup
      53: ldc           #71                 // String invalid_grant
      55: invokespecial #73                 // Method org/springframework/security/oauth2/core/OAuth2AuthenticationException."<init>":(Ljava/lang/String;)V
      58: athrow
      59: getstatic     #41                 // Field log:Lorg/slf4j/Logger;
      62: ldc           #75                 // String Retrieved authorization with authorization code
      64: invokeinterface #47,  2           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;)V
      69: aload         5
      71: ldc           #77                 // class org/springframework/security/oauth2/server/authorization/OAuth2AuthorizationCode
      73: invokevirtual #79                 // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization.getToken:(Ljava/lang/Class;)Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Token;
      76: astore        6
      78: aload         5
      80: ldc           #85                 // class org/springframework/security/oauth2/core/endpoint/OAuth2AuthorizationRequest
      82: invokevirtual #87                 // Method java/lang/Class.getName:()Ljava/lang/String;
      85: invokevirtual #92                 // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization.getAttribute:(Ljava/lang/String;)Ljava/lang/Object;
      88: checkcast     #85                 // class org/springframework/security/oauth2/core/endpoint/OAuth2AuthorizationRequest
      91: astore        7
      93: aload         4
      95: invokevirtual #96                 // Method org/springframework/security/oauth2/server/authorization/client/RegisteredClient.getClientId:()Ljava/lang/String;
      98: aload         7
     100: invokevirtual #101                // Method org/springframework/security/oauth2/core/endpoint/OAuth2AuthorizationRequest.getClientId:()Ljava/lang/String;
     103: invokevirtual #102                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     106: ifne          168
     109: aload         6
     111: invokevirtual #108                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization$Token.isInvalidated:()Z
     114: ifne          158
     117: aload         5
     119: aload         6
     121: invokevirtual #114                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization$Token.getToken:()Lorg/springframework/security/oauth2/core/OAuth2Token;
     124: checkcast     #77                 // class org/springframework/security/oauth2/server/authorization/OAuth2AuthorizationCode
     127: invokestatic  #117                // Method cn/herodotus/engine/oauth2/authentication/utils/OAuth2AuthenticationProviderUtils.invalidate:(Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;Lorg/springframework/security/oauth2/core/OAuth2Token;)Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;
     130: astore        5
     132: aload_0
     133: getfield      #17                 // Field authorizationService:Lorg/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService;
     136: aload         5
     138: invokeinterface #121,  2          // InterfaceMethod org/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService.save:(Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;)V
     143: getstatic     #41                 // Field log:Lorg/slf4j/Logger;
     146: ldc           #125                // String Invalidated authorization code used by registered client \'{}\'
     148: aload         4
     150: invokevirtual #127                // Method org/springframework/security/oauth2/server/authorization/client/RegisteredClient.getId:()Ljava/lang/String;
     153: invokeinterface #130,  3          // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
     158: new           #67                 // class org/springframework/security/oauth2/core/OAuth2AuthenticationException
     161: dup
     162: ldc           #71                 // String invalid_grant
     164: invokespecial #73                 // Method org/springframework/security/oauth2/core/OAuth2AuthenticationException."<init>":(Ljava/lang/String;)V
     167: athrow
     168: aload         7
     170: invokevirtual #134                // Method org/springframework/security/oauth2/core/endpoint/OAuth2AuthorizationRequest.getRedirectUri:()Ljava/lang/String;
     173: invokestatic  #137                // Method org/springframework/util/StringUtils.hasText:(Ljava/lang/String;)Z
     176: ifeq          204
     179: aload         7
     181: invokevirtual #134                // Method org/springframework/security/oauth2/core/endpoint/OAuth2AuthorizationRequest.getRedirectUri:()Ljava/lang/String;
     184: aload_2
     185: invokevirtual #143                // Method org/springframework/security/oauth2/server/authorization/authentication/OAuth2AuthorizationCodeAuthenticationToken.getRedirectUri:()Ljava/lang/String;
     188: invokevirtual #102                // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     191: ifne          204
     194: new           #67                 // class org/springframework/security/oauth2/core/OAuth2AuthenticationException
     197: dup
     198: ldc           #71                 // String invalid_grant
     200: invokespecial #73                 // Method org/springframework/security/oauth2/core/OAuth2AuthenticationException."<init>":(Ljava/lang/String;)V
     203: athrow
     204: aload         6
     206: invokevirtual #144                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization$Token.isActive:()Z
     209: ifne          222
     212: new           #67                 // class org/springframework/security/oauth2/core/OAuth2AuthenticationException
     215: dup
     216: ldc           #71                 // String invalid_grant
     218: invokespecial #73                 // Method org/springframework/security/oauth2/core/OAuth2AuthenticationException."<init>":(Ljava/lang/String;)V
     221: athrow
     222: getstatic     #41                 // Field log:Lorg/slf4j/Logger;
     225: ldc           #147                // String Validated token request parameters
     227: invokeinterface #47,  2           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;)V
     232: aload         5
     234: ldc           #149                // class java/security/Principal
     236: invokevirtual #87                 // Method java/lang/Class.getName:()Ljava/lang/String;
     239: invokevirtual #92                 // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization.getAttribute:(Ljava/lang/String;)Ljava/lang/Object;
     242: checkcast     #151                // class org/springframework/security/core/Authentication
     245: astore        8
     247: invokestatic  #153                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext.builder:()Lorg/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder;
     250: aload         4
     252: invokevirtual #159                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.registeredClient:(Lorg/springframework/security/oauth2/server/authorization/client/RegisteredClient;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     255: checkcast     #160                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     258: aload         8
     260: invokevirtual #165                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.principal:(Lorg/springframework/security/core/Authentication;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     263: checkcast     #160                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     266: invokestatic  #169                // Method org/springframework/security/oauth2/server/authorization/context/AuthorizationServerContextHolder.getContext:()Lorg/springframework/security/oauth2/server/authorization/context/AuthorizationServerContext;
     269: invokevirtual #175                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.authorizationServerContext:(Lorg/springframework/security/oauth2/server/authorization/context/AuthorizationServerContext;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     272: checkcast     #160                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     275: aload         5
     277: invokevirtual #179                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.authorization:(Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     280: checkcast     #160                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     283: aload         5
     285: invokevirtual #183                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization.getAuthorizedScopes:()Ljava/util/Set;
     288: invokevirtual #187                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.authorizedScopes:(Ljava/util/Set;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     291: checkcast     #160                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     294: getstatic     #191                // Field org/springframework/security/oauth2/core/AuthorizationGrantType.AUTHORIZATION_CODE:Lorg/springframework/security/oauth2/core/AuthorizationGrantType;
     297: invokevirtual #197                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.authorizationGrantType:(Lorg/springframework/security/oauth2/core/AuthorizationGrantType;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     300: checkcast     #160                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     303: aload_2
     304: invokevirtual #201                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.authorizationGrant:(Lorg/springframework/security/core/Authentication;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     307: checkcast     #160                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     310: astore        9
     312: aload         5
     314: invokestatic  #204                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization.from:(Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;)Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;
     317: astore        10
     319: aload_0
     320: aload         9
     322: aload         10
     324: aload_0
     325: getfield      #23                 // Field tokenGenerator:Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;
     328: ldc           #208                // String https://datatracker.ietf.org/doc/html/rfc6749#section-5.2
     330: invokevirtual #210                // Method createOAuth2AccessToken:(Lorg/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder;Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;Ljava/lang/String;)Lorg/springframework/security/oauth2/core/OAuth2AccessToken;
     333: astore        11
     335: aload_0
     336: aload         9
     338: aload         10
     340: aload_0
     341: getfield      #23                 // Field tokenGenerator:Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;
     344: ldc           #208                // String https://datatracker.ietf.org/doc/html/rfc6749#section-5.2
     346: aload_3
     347: aload         4
     349: invokevirtual #214                // Method creatOAuth2RefreshToken:(Lorg/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder;Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;Ljava/lang/String;Lorg/springframework/security/oauth2/server/authorization/authentication/OAuth2ClientAuthenticationToken;Lorg/springframework/security/oauth2/server/authorization/client/RegisteredClient;)Lorg/springframework/security/oauth2/core/OAuth2RefreshToken;
     352: astore        12
     354: aload_0
     355: aload         8
     357: aload_0
     358: getfield      #218                // Field sessionRegistry:Lorg/springframework/security/core/session/SessionRegistry;
     361: aload         9
     363: aload         10
     365: aload_0
     366: getfield      #23                 // Field tokenGenerator:Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;
     369: ldc           #208                // String https://datatracker.ietf.org/doc/html/rfc6749#section-5.2
     371: aload         7
     373: invokevirtual #222                // Method org/springframework/security/oauth2/core/endpoint/OAuth2AuthorizationRequest.getScopes:()Ljava/util/Set;
     376: invokevirtual #225                // Method createOidcIdToken:(Lorg/springframework/security/core/Authentication;Lorg/springframework/security/core/session/SessionRegistry;Lorg/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder;Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;Ljava/lang/String;Ljava/util/Set;)Lorg/springframework/security/oauth2/core/oidc/OidcIdToken;
     379: astore        13
     381: aload         10
     383: invokevirtual #229                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder.build:()Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;
     386: astore        5
     388: aload         5
     390: aload         6
     392: invokevirtual #114                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization$Token.getToken:()Lorg/springframework/security/oauth2/core/OAuth2Token;
     395: checkcast     #77                 // class org/springframework/security/oauth2/server/authorization/OAuth2AuthorizationCode
     398: invokestatic  #117                // Method cn/herodotus/engine/oauth2/authentication/utils/OAuth2AuthenticationProviderUtils.invalidate:(Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;Lorg/springframework/security/oauth2/core/OAuth2Token;)Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;
     401: astore        5
     403: aload_0
     404: getfield      #17                 // Field authorizationService:Lorg/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService;
     407: aload         5
     409: invokeinterface #121,  2          // InterfaceMethod org/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService.save:(Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;)V
     414: getstatic     #41                 // Field log:Lorg/slf4j/Logger;
     417: ldc           #235                // String [Herodotus] |- Authorization Code returning OAuth2AccessTokenAuthenticationToken.
     419: invokeinterface #237,  2          // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     424: aload_0
     425: aload         13
     427: invokevirtual #240                // Method idTokenAdditionalParameters:(Lorg/springframework/security/oauth2/core/oidc/OidcIdToken;)Ljava/util/Map;
     430: astore        14
     432: new           #244                // class org/springframework/security/oauth2/server/authorization/authentication/OAuth2AccessTokenAuthenticationToken
     435: dup
     436: aload         4
     438: aload_3
     439: aload         11
     441: aload         12
     443: aload         14
     445: invokespecial #246                // Method org/springframework/security/oauth2/server/authorization/authentication/OAuth2AccessTokenAuthenticationToken."<init>":(Lorg/springframework/security/oauth2/server/authorization/client/RegisteredClient;Lorg/springframework/security/core/Authentication;Lorg/springframework/security/oauth2/core/OAuth2AccessToken;Lorg/springframework/security/oauth2/core/OAuth2RefreshToken;Ljava/util/Map;)V
     448: astore        15
     450: aload_0
     451: aload         8
     453: aload         15
     455: invokevirtual #249                // Method createOAuth2AccessTokenAuthenticationToken:(Lorg/springframework/security/core/Authentication;Lorg/springframework/security/oauth2/server/authorization/authentication/OAuth2AccessTokenAuthenticationToken;)Lorg/springframework/security/oauth2/server/authorization/authentication/OAuth2AccessTokenAuthenticationToken;
     458: areturn

  public void setSessionRegistry(org.springframework.security.core.session.SessionRegistry);
    Code:
       0: aload_1
       1: ldc           #253                // String sessionRegistry cannot be null
       3: invokestatic  #9                  // Method org/springframework/util/Assert.notNull:(Ljava/lang/Object;Ljava/lang/String;)V
       6: aload_0
       7: aload_1
       8: putfield      #218                // Field sessionRegistry:Lorg/springframework/security/core/session/SessionRegistry;
      11: return

  public boolean supports(java.lang.Class<?>);
    Code:
       0: ldc           #27                 // class org/springframework/security/oauth2/server/authorization/authentication/OAuth2AuthorizationCodeAuthenticationToken
       2: aload_1
       3: invokevirtual #255                // Method java/lang/Class.isAssignableFrom:(Ljava/lang/Class;)Z
       6: ireturn

  static {};
    Code:
       0: ldc           #18                 // class cn/herodotus/engine/oauth2/authentication/provider/OAuth2AuthorizationCodeAuthenticationProvider
       2: invokestatic  #259                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #41                 // Field log:Lorg/slf4j/Logger;
       8: new           #265                // class org/springframework/security/oauth2/server/authorization/OAuth2TokenType
      11: dup
      12: ldc_w         #269                // String code
      15: invokespecial #271                // Method org/springframework/security/oauth2/server/authorization/OAuth2TokenType."<init>":(Ljava/lang/String;)V
      18: putstatic     #57                 // Field AUTHORIZATION_CODE_TOKEN_TYPE:Lorg/springframework/security/oauth2/server/authorization/OAuth2TokenType;
      21: return
}
