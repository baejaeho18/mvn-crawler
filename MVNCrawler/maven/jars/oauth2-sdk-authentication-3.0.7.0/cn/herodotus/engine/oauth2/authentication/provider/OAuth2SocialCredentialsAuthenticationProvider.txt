Compiled from "OAuth2SocialCredentialsAuthenticationProvider.java"
public class cn.herodotus.engine.oauth2.authentication.provider.OAuth2SocialCredentialsAuthenticationProvider extends cn.herodotus.engine.oauth2.authentication.provider.AbstractUserDetailsAuthenticationProvider {
  private static final org.slf4j.Logger log;

  private static final java.lang.String ERROR_URI;

  private final org.springframework.security.oauth2.server.authorization.OAuth2AuthorizationService authorizationService;

  private final org.springframework.security.oauth2.server.authorization.token.OAuth2TokenGenerator<? extends org.springframework.security.oauth2.core.OAuth2Token> tokenGenerator;

  private org.springframework.security.core.session.SessionRegistry sessionRegistry;

  public cn.herodotus.engine.oauth2.authentication.provider.OAuth2SocialCredentialsAuthenticationProvider(org.springframework.security.oauth2.server.authorization.OAuth2AuthorizationService, org.springframework.security.oauth2.server.authorization.token.OAuth2TokenGenerator<? extends org.springframework.security.oauth2.core.OAuth2Token>, org.springframework.security.core.userdetails.UserDetailsService, cn.herodotus.engine.oauth2.authentication.properties.OAuth2AuthenticationProperties);
    Code:
       0: aload_0
       1: aload_1
       2: aload_3
       3: aload         4
       5: invokespecial #1                  // Method cn/herodotus/engine/oauth2/authentication/provider/AbstractUserDetailsAuthenticationProvider."<init>":(Lorg/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService;Lorg/springframework/security/core/userdetails/UserDetailsService;Lcn/herodotus/engine/oauth2/authentication/properties/OAuth2AuthenticationProperties;)V
       8: aload_2
       9: ldc           #7                  // String tokenGenerator cannot be null
      11: invokestatic  #9                  // Method org/springframework/util/Assert.notNull:(Ljava/lang/Object;Ljava/lang/String;)V
      14: aload_0
      15: aload_1
      16: putfield      #15                 // Field authorizationService:Lorg/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService;
      19: aload_0
      20: aload_2
      21: putfield      #21                 // Field tokenGenerator:Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;
      24: return

  protected void additionalAuthenticationChecks(org.springframework.security.core.userdetails.UserDetails, java.util.Map<java.lang.String, java.lang.Object>) throws org.springframework.security.core.AuthenticationException;
    Code:
       0: return

  protected org.springframework.security.core.userdetails.UserDetails retrieveUser(java.util.Map<java.lang.String, java.lang.Object>) throws org.springframework.security.core.AuthenticationException;
    Code:
       0: aload_1
       1: ldc           #27                 // String source
       3: invokeinterface #29,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
       8: checkcast     #35                 // class java/lang/String
      11: astore_2
      12: aload_0
      13: aload_1
      14: invokevirtual #37                 // Method parameterBinder:(Ljava/util/Map;)Lcn/herodotus/engine/assistant/core/domain/AccessPrincipal;
      17: astore_3
      18: aload_0
      19: invokevirtual #41                 // Method getUserDetailsService:()Lcn/herodotus/engine/oauth2/core/definition/service/EnhanceUserDetailsService;
      22: astore        4
      24: aload         4
      26: aload_2
      27: aload_3
      28: invokeinterface #45,  3           // InterfaceMethod cn/herodotus/engine/oauth2/core/definition/service/EnhanceUserDetailsService.loadUserBySocial:(Ljava/lang/String;Lcn/herodotus/engine/assistant/core/domain/AccessPrincipal;)Lorg/springframework/security/core/userdetails/UserDetails;
      33: astore        5
      35: aload         5
      37: ifnonnull     50
      40: new           #51                 // class org/springframework/security/authentication/InternalAuthenticationServiceException
      43: dup
      44: ldc           #53                 // String UserDetailsService returned null, which is an interface contract violation
      46: invokespecial #55                 // Method org/springframework/security/authentication/InternalAuthenticationServiceException."<init>":(Ljava/lang/String;)V
      49: athrow
      50: aload         5
      52: areturn
      53: astore        4
      55: getstatic     #60                 // Field log:Lorg/slf4j/Logger;
      58: ldc           #64                 // String [Herodotus] |- User name can not found forï¼š[{}]
      60: aload_2
      61: invokeinterface #66,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Object;)V
      66: aload         4
      68: athrow
      69: astore        4
      71: aload         4
      73: athrow
      74: astore        4
      76: new           #51                 // class org/springframework/security/authentication/InternalAuthenticationServiceException
      79: dup
      80: aload         4
      82: invokevirtual #74                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
      85: aload         4
      87: invokespecial #78                 // Method org/springframework/security/authentication/InternalAuthenticationServiceException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      90: athrow
    Exception table:
       from    to  target type
          18    52    53   Class org/springframework/security/core/userdetails/UsernameNotFoundException
          18    52    69   Class org/springframework/security/authentication/InternalAuthenticationServiceException
          18    52    74   Class java/lang/Exception

  public org.springframework.security.core.Authentication authenticate(org.springframework.security.core.Authentication) throws org.springframework.security.core.AuthenticationException;
    Code:
       0: aload_1
       1: checkcast     #81                 // class cn/herodotus/engine/oauth2/authentication/provider/OAuth2SocialCredentialsAuthenticationToken
       4: astore_2
       5: aload_2
       6: invokestatic  #83                 // Method cn/herodotus/engine/oauth2/authentication/utils/OAuth2AuthenticationProviderUtils.getAuthenticatedClientElseThrowInvalidClient:(Lorg/springframework/security/core/Authentication;)Lorg/springframework/security/oauth2/server/authorization/authentication/OAuth2ClientAuthenticationToken;
       9: astore_3
      10: aload_3
      11: invokevirtual #89                 // Method org/springframework/security/oauth2/server/authorization/authentication/OAuth2ClientAuthenticationToken.getRegisteredClient:()Lorg/springframework/security/oauth2/server/authorization/client/RegisteredClient;
      14: astore        4
      16: aload         4
      18: invokevirtual #95                 // Method org/springframework/security/oauth2/server/authorization/client/RegisteredClient.getAuthorizationGrantTypes:()Ljava/util/Set;
      21: getstatic     #101                // Field cn/herodotus/engine/oauth2/core/definition/HerodotusGrantType.SOCIAL:Lorg/springframework/security/oauth2/core/AuthorizationGrantType;
      24: invokeinterface #107,  2          // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      29: ifne          42
      32: new           #113                // class org/springframework/security/oauth2/core/OAuth2AuthenticationException
      35: dup
      36: ldc           #117                // String unauthorized_client
      38: invokespecial #119                // Method org/springframework/security/oauth2/core/OAuth2AuthenticationException."<init>":(Ljava/lang/String;)V
      41: athrow
      42: aload_0
      43: aload_2
      44: invokevirtual #120                // Method cn/herodotus/engine/oauth2/authentication/provider/OAuth2SocialCredentialsAuthenticationToken.getAdditionalParameters:()Ljava/util/Map;
      47: aload         4
      49: invokevirtual #124                // Method org/springframework/security/oauth2/server/authorization/client/RegisteredClient.getId:()Ljava/lang/String;
      52: invokevirtual #127                // Method getUsernamePasswordAuthentication:(Ljava/util/Map;Ljava/lang/String;)Lorg/springframework/security/core/Authentication;
      55: astore        5
      57: aload_0
      58: aload_2
      59: invokevirtual #131                // Method cn/herodotus/engine/oauth2/authentication/provider/OAuth2SocialCredentialsAuthenticationToken.getScopes:()Ljava/util/Set;
      62: aload         4
      64: invokevirtual #134                // Method validateScopes:(Ljava/util/Set;Lorg/springframework/security/oauth2/server/authorization/client/RegisteredClient;)Ljava/util/Set;
      67: astore        6
      69: aload         4
      71: invokestatic  #138                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization.withRegisteredClient:(Lorg/springframework/security/oauth2/server/authorization/client/RegisteredClient;)Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;
      74: aload         5
      76: invokeinterface #144,  1          // InterfaceMethod org/springframework/security/core/Authentication.getName:()Ljava/lang/String;
      81: invokevirtual #149                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder.principalName:(Ljava/lang/String;)Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;
      84: getstatic     #101                // Field cn/herodotus/engine/oauth2/core/definition/HerodotusGrantType.SOCIAL:Lorg/springframework/security/oauth2/core/AuthorizationGrantType;
      87: invokevirtual #155                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder.authorizationGrantType:(Lorg/springframework/security/oauth2/core/AuthorizationGrantType;)Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;
      90: aload         6
      92: invokevirtual #159                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder.authorizedScopes:(Ljava/util/Set;)Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;
      95: ldc           #163                // class java/security/Principal
      97: invokevirtual #165                // Method java/lang/Class.getName:()Ljava/lang/String;
     100: aload         5
     102: invokevirtual #168                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder.attribute:(Ljava/lang/String;Ljava/lang/Object;)Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;
     105: astore        7
     107: invokestatic  #172                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext.builder:()Lorg/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder;
     110: aload         4
     112: invokevirtual #178                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.registeredClient:(Lorg/springframework/security/oauth2/server/authorization/client/RegisteredClient;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     115: checkcast     #179                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     118: aload         5
     120: invokevirtual #184                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.principal:(Lorg/springframework/security/core/Authentication;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     123: checkcast     #179                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     126: invokestatic  #188                // Method org/springframework/security/oauth2/server/authorization/context/AuthorizationServerContextHolder.getContext:()Lorg/springframework/security/oauth2/server/authorization/context/AuthorizationServerContext;
     129: invokevirtual #194                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.authorizationServerContext:(Lorg/springframework/security/oauth2/server/authorization/context/AuthorizationServerContext;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     132: checkcast     #179                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     135: aload         6
     137: invokevirtual #198                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.authorizedScopes:(Ljava/util/Set;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     140: checkcast     #179                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     143: getstatic     #201                // Field org/springframework/security/oauth2/server/authorization/OAuth2TokenType.ACCESS_TOKEN:Lorg/springframework/security/oauth2/server/authorization/OAuth2TokenType;
     146: invokevirtual #207                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.tokenType:(Lorg/springframework/security/oauth2/server/authorization/OAuth2TokenType;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     149: checkcast     #179                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     152: getstatic     #101                // Field cn/herodotus/engine/oauth2/core/definition/HerodotusGrantType.SOCIAL:Lorg/springframework/security/oauth2/core/AuthorizationGrantType;
     155: invokevirtual #211                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.authorizationGrantType:(Lorg/springframework/security/oauth2/core/AuthorizationGrantType;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     158: checkcast     #179                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     161: aload_2
     162: invokevirtual #214                // Method org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder.authorizationGrant:(Lorg/springframework/security/core/Authentication;)Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenContext$AbstractBuilder;
     165: checkcast     #179                // class org/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder
     168: astore        8
     170: aload_0
     171: aload         8
     173: aload         7
     175: aload_0
     176: getfield      #21                 // Field tokenGenerator:Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;
     179: ldc           #217                // String https://datatracker.ietf.org/doc/html/rfc6749#section-5.2
     181: invokevirtual #219                // Method createOAuth2AccessToken:(Lorg/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder;Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;Ljava/lang/String;)Lorg/springframework/security/oauth2/core/OAuth2AccessToken;
     184: astore        9
     186: aload_0
     187: aload         8
     189: aload         7
     191: aload_0
     192: getfield      #21                 // Field tokenGenerator:Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;
     195: ldc           #217                // String https://datatracker.ietf.org/doc/html/rfc6749#section-5.2
     197: aload_3
     198: aload         4
     200: invokevirtual #223                // Method creatOAuth2RefreshToken:(Lorg/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder;Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;Ljava/lang/String;Lorg/springframework/security/oauth2/server/authorization/authentication/OAuth2ClientAuthenticationToken;Lorg/springframework/security/oauth2/server/authorization/client/RegisteredClient;)Lorg/springframework/security/oauth2/core/OAuth2RefreshToken;
     203: astore        10
     205: aload_0
     206: aload         5
     208: aload_0
     209: getfield      #227                // Field sessionRegistry:Lorg/springframework/security/core/session/SessionRegistry;
     212: aload         8
     214: aload         7
     216: aload_0
     217: getfield      #21                 // Field tokenGenerator:Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;
     220: ldc           #217                // String https://datatracker.ietf.org/doc/html/rfc6749#section-5.2
     222: aload_2
     223: invokevirtual #131                // Method cn/herodotus/engine/oauth2/authentication/provider/OAuth2SocialCredentialsAuthenticationToken.getScopes:()Ljava/util/Set;
     226: invokevirtual #231                // Method createOidcIdToken:(Lorg/springframework/security/core/Authentication;Lorg/springframework/security/core/session/SessionRegistry;Lorg/springframework/security/oauth2/server/authorization/token/DefaultOAuth2TokenContext$Builder;Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder;Lorg/springframework/security/oauth2/server/authorization/token/OAuth2TokenGenerator;Ljava/lang/String;Ljava/util/Set;)Lorg/springframework/security/oauth2/core/oidc/OidcIdToken;
     229: astore        11
     231: aload         7
     233: invokevirtual #235                // Method org/springframework/security/oauth2/server/authorization/OAuth2Authorization$Builder.build:()Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;
     236: astore        12
     238: aload_0
     239: getfield      #15                 // Field authorizationService:Lorg/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService;
     242: aload         12
     244: invokeinterface #239,  2          // InterfaceMethod org/springframework/security/oauth2/server/authorization/OAuth2AuthorizationService.save:(Lorg/springframework/security/oauth2/server/authorization/OAuth2Authorization;)V
     249: getstatic     #60                 // Field log:Lorg/slf4j/Logger;
     252: ldc           #245                // String [Herodotus] |- Social Credential returning OAuth2AccessTokenAuthenticationToken.
     254: invokeinterface #247,  2          // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     259: aload_0
     260: aload         11
     262: invokevirtual #250                // Method idTokenAdditionalParameters:(Lorg/springframework/security/oauth2/core/oidc/OidcIdToken;)Ljava/util/Map;
     265: astore        13
     267: new           #254                // class org/springframework/security/oauth2/server/authorization/authentication/OAuth2AccessTokenAuthenticationToken
     270: dup
     271: aload         4
     273: aload_3
     274: aload         9
     276: aload         10
     278: aload         13
     280: invokespecial #256                // Method org/springframework/security/oauth2/server/authorization/authentication/OAuth2AccessTokenAuthenticationToken."<init>":(Lorg/springframework/security/oauth2/server/authorization/client/RegisteredClient;Lorg/springframework/security/core/Authentication;Lorg/springframework/security/oauth2/core/OAuth2AccessToken;Lorg/springframework/security/oauth2/core/OAuth2RefreshToken;Ljava/util/Map;)V
     283: astore        14
     285: aload_0
     286: aload         5
     288: aload         14
     290: invokevirtual #259                // Method createOAuth2AccessTokenAuthenticationToken:(Lorg/springframework/security/core/Authentication;Lorg/springframework/security/oauth2/server/authorization/authentication/OAuth2AccessTokenAuthenticationToken;)Lorg/springframework/security/oauth2/server/authorization/authentication/OAuth2AccessTokenAuthenticationToken;
     293: areturn

  public boolean supports(java.lang.Class<?>);
    Code:
       0: ldc           #81                 // class cn/herodotus/engine/oauth2/authentication/provider/OAuth2SocialCredentialsAuthenticationToken
       2: aload_1
       3: invokevirtual #263                // Method java/lang/Class.isAssignableFrom:(Ljava/lang/Class;)Z
       6: istore_2
       7: getstatic     #60                 // Field log:Lorg/slf4j/Logger;
      10: ldc_w         #267                // String [Herodotus] |- Resource Owner Password Authentication is supports! [{}]
      13: iload_2
      14: invokestatic  #269                // Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;
      17: invokeinterface #275,  3          // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Object;)V
      22: iload_2
      23: ireturn

  public void setSessionRegistry(org.springframework.security.core.session.SessionRegistry);
    Code:
       0: aload_1
       1: ldc_w         #278                // String sessionRegistry cannot be null
       4: invokestatic  #9                  // Method org/springframework/util/Assert.notNull:(Ljava/lang/Object;Ljava/lang/String;)V
       7: aload_0
       8: aload_1
       9: putfield      #227                // Field sessionRegistry:Lorg/springframework/security/core/session/SessionRegistry;
      12: return

  private cn.herodotus.engine.assistant.core.domain.AccessPrincipal parameterBinder(java.util.Map<java.lang.String, java.lang.Object>) throws cn.herodotus.engine.oauth2.core.exception.SocialCredentialsParameterBindingFailedException;
    Code:
       0: new           #280                // class cn/herodotus/engine/assistant/core/domain/AccessPrincipal
       3: dup
       4: invokespecial #282                // Method cn/herodotus/engine/assistant/core/domain/AccessPrincipal."<init>":()V
       7: astore_2
       8: new           #285                // class org/springframework/beans/MutablePropertyValues
      11: dup
      12: aload_1
      13: invokespecial #287                // Method org/springframework/beans/MutablePropertyValues."<init>":(Ljava/util/Map;)V
      16: astore_3
      17: new           #290                // class org/springframework/web/bind/support/WebRequestDataBinder
      20: dup
      21: aload_2
      22: invokespecial #292                // Method org/springframework/web/bind/support/WebRequestDataBinder."<init>":(Ljava/lang/Object;)V
      25: astore        4
      27: aload         4
      29: aload_3
      30: invokevirtual #295                // Method org/springframework/web/bind/support/WebRequestDataBinder.bind:(Lorg/springframework/beans/PropertyValues;)V
      33: aload_2
      34: iconst_0
      35: anewarray     #35                 // class java/lang/String
      38: invokestatic  #299                // Method cn/hutool/core/bean/BeanUtil.isNotEmpty:(Ljava/lang/Object;[Ljava/lang/String;)Z
      41: ifeq          46
      44: aload_2
      45: areturn
      46: new           #305                // class cn/herodotus/engine/oauth2/core/exception/SocialCredentialsParameterBindingFailedException
      49: dup
      50: ldc_w         #307                // String Internet authentication parameter bindng is not correct!
      53: invokespecial #309                // Method cn/herodotus/engine/oauth2/core/exception/SocialCredentialsParameterBindingFailedException."<init>":(Ljava/lang/String;)V
      56: athrow

  static {};
    Code:
       0: ldc           #16                 // class cn/herodotus/engine/oauth2/authentication/provider/OAuth2SocialCredentialsAuthenticationProvider
       2: invokestatic  #310                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #60                 // Field log:Lorg/slf4j/Logger;
       8: return
}
