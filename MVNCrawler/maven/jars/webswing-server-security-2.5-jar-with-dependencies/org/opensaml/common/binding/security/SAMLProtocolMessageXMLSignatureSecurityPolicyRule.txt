Compiled from "SAMLProtocolMessageXMLSignatureSecurityPolicyRule.java"
public class org.opensaml.common.binding.security.SAMLProtocolMessageXMLSignatureSecurityPolicyRule extends org.opensaml.common.binding.security.BaseSAMLXMLSignatureSecurityPolicyRule {
  private final org.slf4j.Logger log;

  private org.opensaml.xml.validation.Validator<org.opensaml.xml.signature.Signature> sigValidator;

  public org.opensaml.common.binding.security.SAMLProtocolMessageXMLSignatureSecurityPolicyRule(org.opensaml.xml.security.trust.TrustEngine<org.opensaml.xml.signature.Signature>);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #1                  // Method org/opensaml/common/binding/security/BaseSAMLXMLSignatureSecurityPolicyRule."<init>":(Lorg/opensaml/xml/security/trust/TrustEngine;)V
       5: aload_0
       6: ldc_w         #2                  // class org/opensaml/common/binding/security/SAMLProtocolMessageXMLSignatureSecurityPolicyRule
       9: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      12: putfield      #4                  // Field log:Lorg/slf4j/Logger;
      15: aload_0
      16: new           #5                  // class org/opensaml/security/SAMLSignatureProfileValidator
      19: dup
      20: invokespecial #6                  // Method org/opensaml/security/SAMLSignatureProfileValidator."<init>":()V
      23: putfield      #7                  // Field sigValidator:Lorg/opensaml/xml/validation/Validator;
      26: return

  public org.opensaml.common.binding.security.SAMLProtocolMessageXMLSignatureSecurityPolicyRule(org.opensaml.xml.security.trust.TrustEngine<org.opensaml.xml.signature.Signature>, org.opensaml.xml.validation.Validator<org.opensaml.xml.signature.Signature>);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #1                  // Method org/opensaml/common/binding/security/BaseSAMLXMLSignatureSecurityPolicyRule."<init>":(Lorg/opensaml/xml/security/trust/TrustEngine;)V
       5: aload_0
       6: ldc_w         #2                  // class org/opensaml/common/binding/security/SAMLProtocolMessageXMLSignatureSecurityPolicyRule
       9: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      12: putfield      #4                  // Field log:Lorg/slf4j/Logger;
      15: aload_0
      16: aload_2
      17: putfield      #7                  // Field sigValidator:Lorg/opensaml/xml/validation/Validator;
      20: return

  public void evaluate(org.opensaml.ws.message.MessageContext) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aload_1
       1: instanceof    #8                  // class org/opensaml/common/binding/SAMLMessageContext
       4: ifne          19
       7: aload_0
       8: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      11: ldc           #9                  // String Invalid message context type, this policy rule only supports SAMLMessageContext
      13: invokeinterface #10,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      18: return
      19: aload_1
      20: checkcast     #8                  // class org/opensaml/common/binding/SAMLMessageContext
      23: astore_2
      24: aload_2
      25: invokeinterface #11,  1           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.getInboundSAMLMessage:()Lorg/opensaml/common/SAMLObject;
      30: astore_3
      31: aload_3
      32: instanceof    #12                 // class org/opensaml/common/SignableSAMLObject
      35: ifne          50
      38: aload_0
      39: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      42: ldc           #13                 // String Extracted SAML message was not a SignableSAMLObject, can not process signature
      44: invokeinterface #10,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      49: return
      50: aload_3
      51: checkcast     #12                 // class org/opensaml/common/SignableSAMLObject
      54: astore        4
      56: aload         4
      58: invokeinterface #14,  1           // InterfaceMethod org/opensaml/common/SignableSAMLObject.isSigned:()Z
      63: ifne          78
      66: aload_0
      67: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      70: ldc           #15                 // String SAML protocol message was not signed, skipping XML signature processing
      72: invokeinterface #16,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      77: return
      78: aload         4
      80: invokeinterface #17,  1           // InterfaceMethod org/opensaml/common/SignableSAMLObject.getSignature:()Lorg/opensaml/xml/signature/Signature;
      85: astore        5
      87: aload_0
      88: aload         5
      90: invokevirtual #18                 // Method performPreValidation:(Lorg/opensaml/xml/signature/Signature;)V
      93: aload_0
      94: aload         5
      96: aload         4
      98: aload_2
      99: invokevirtual #19                 // Method doEvaluate:(Lorg/opensaml/xml/signature/Signature;Lorg/opensaml/common/SignableSAMLObject;Lorg/opensaml/common/binding/SAMLMessageContext;)V
     102: return

  protected void doEvaluate(org.opensaml.xml.signature.Signature, org.opensaml.common.SignableSAMLObject, org.opensaml.common.binding.SAMLMessageContext) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aload_3
       1: invokeinterface #20,  1           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.getInboundMessageIssuer:()Ljava/lang/String;
       6: astore        4
       8: aload         4
      10: ifnull        145
      13: aload_2
      14: invokeinterface #21,  1           // InterfaceMethod org/opensaml/common/SignableSAMLObject.getElementQName:()Ljavax/xml/namespace/QName;
      19: invokevirtual #22                 // Method javax/xml/namespace/QName.toString:()Ljava/lang/String;
      22: astore        5
      24: aload_0
      25: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      28: ldc           #23                 // String Attempting to verify signature on signed SAML protocol message using context issuer message type: {}
      30: aload         5
      32: invokeinterface #24,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      37: aload_0
      38: aload_1
      39: aload         4
      41: aload_3
      42: invokevirtual #25                 // Method evaluate:(Ljava/lang/Object;Ljava/lang/String;Lorg/opensaml/ws/message/MessageContext;)Z
      45: ifeq          93
      48: aload_0
      49: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      52: ldc           #26                 // String Validation of protocol message signature succeeded, message type: {}
      54: aload         5
      56: invokeinterface #27,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      61: aload_3
      62: invokeinterface #28,  1           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.isInboundSAMLMessageAuthenticated:()Z
      67: ifne          142
      70: aload_0
      71: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      74: ldc           #29                 // String Authentication via protocol message signature succeeded for context issuer entity ID {}
      76: aload         4
      78: invokeinterface #24,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      83: aload_3
      84: iconst_1
      85: invokeinterface #30,  2           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.setInboundSAMLMessageAuthenticated:(Z)V
      90: goto          142
      93: aload_0
      94: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      97: new           #31                 // class java/lang/StringBuilder
     100: dup
     101: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     104: ldc           #33                 // String Validation of protocol message signature failed for context issuer \'
     106: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     109: aload         4
     111: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     114: ldc           #35                 // String \', message type:
     116: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     119: aload         5
     121: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     124: invokevirtual #36                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     127: invokeinterface #10,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     132: new           #37                 // class org/opensaml/ws/security/SecurityPolicyException
     135: dup
     136: ldc           #38                 // String Validation of protocol message signature failed
     138: invokespecial #39                 // Method org/opensaml/ws/security/SecurityPolicyException."<init>":(Ljava/lang/String;)V
     141: athrow
     142: goto          166
     145: aload_0
     146: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     149: ldc           #40                 // String Context issuer unavailable, can not attempt SAML protocol message signature validation
     151: invokeinterface #10,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     156: new           #37                 // class org/opensaml/ws/security/SecurityPolicyException
     159: dup
     160: ldc           #41                 // String Context issuer unavailable, can not validate signature
     162: invokespecial #39                 // Method org/opensaml/ws/security/SecurityPolicyException."<init>":(Ljava/lang/String;)V
     165: athrow
     166: return

  protected org.opensaml.xml.validation.Validator<org.opensaml.xml.signature.Signature> getSignaturePrevalidator();
    Code:
       0: aload_0
       1: getfield      #7                  // Field sigValidator:Lorg/opensaml/xml/validation/Validator;
       4: areturn

  protected void performPreValidation(org.opensaml.xml.signature.Signature) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aload_0
       1: invokevirtual #42                 // Method getSignaturePrevalidator:()Lorg/opensaml/xml/validation/Validator;
       4: ifnull        44
       7: aload_0
       8: invokevirtual #42                 // Method getSignaturePrevalidator:()Lorg/opensaml/xml/validation/Validator;
      11: aload_1
      12: invokeinterface #43,  2           // InterfaceMethod org/opensaml/xml/validation/Validator.validate:(Lorg/opensaml/xml/XMLObject;)V
      17: goto          44
      20: astore_2
      21: aload_0
      22: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      25: ldc           #45                 // String Protocol message signature failed signature pre-validation
      27: aload_2
      28: invokeinterface #46,  3           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Throwable;)V
      33: new           #37                 // class org/opensaml/ws/security/SecurityPolicyException
      36: dup
      37: ldc           #45                 // String Protocol message signature failed signature pre-validation
      39: aload_2
      40: invokespecial #47                 // Method org/opensaml/ws/security/SecurityPolicyException."<init>":(Ljava/lang/String;Ljava/lang/Exception;)V
      43: athrow
      44: return
    Exception table:
       from    to  target type
           7    17    20   Class org/opensaml/xml/validation/ValidationException
}
