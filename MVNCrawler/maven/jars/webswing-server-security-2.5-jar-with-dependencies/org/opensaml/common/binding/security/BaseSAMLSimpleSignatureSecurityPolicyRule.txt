Compiled from "BaseSAMLSimpleSignatureSecurityPolicyRule.java"
public abstract class org.opensaml.common.binding.security.BaseSAMLSimpleSignatureSecurityPolicyRule implements org.opensaml.ws.security.SecurityPolicyRule {
  private final org.slf4j.Logger log;

  private org.opensaml.xml.signature.SignatureTrustEngine trustEngine;

  protected org.opensaml.common.binding.security.BaseSAMLSimpleSignatureSecurityPolicyRule(org.opensaml.xml.signature.SignatureTrustEngine);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc_w         #2                  // class org/opensaml/common/binding/security/BaseSAMLSimpleSignatureSecurityPolicyRule
       8: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      11: putfield      #4                  // Field log:Lorg/slf4j/Logger;
      14: aload_0
      15: aload_1
      16: putfield      #5                  // Field trustEngine:Lorg/opensaml/xml/signature/SignatureTrustEngine;
      19: return

  public void evaluate(org.opensaml.ws.message.MessageContext) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aload_0
       1: getfield      #4                  // Field log:Lorg/slf4j/Logger;
       4: ldc           #6                  // String Evaluating simple signature rule of type: {}
       6: aload_0
       7: invokevirtual #7                  // Method java/lang/Object.getClass:()Ljava/lang/Class;
      10: invokevirtual #8                  // Method java/lang/Class.getName:()Ljava/lang/String;
      13: invokeinterface #9,  3            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      18: aload_1
      19: instanceof    #10                 // class org/opensaml/common/binding/SAMLMessageContext
      22: ifne          37
      25: aload_0
      26: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      29: ldc           #11                 // String Invalid message context type, this policy rule only supports SAMLMessageContext
      31: invokeinterface #12,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      36: return
      37: aload_1
      38: invokeinterface #13,  1           // InterfaceMethod org/opensaml/ws/message/MessageContext.getInboundMessageTransport:()Lorg/opensaml/ws/transport/InTransport;
      43: instanceof    #14                 // class org/opensaml/ws/transport/http/HttpServletRequestAdapter
      46: ifne          61
      49: aload_0
      50: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      53: ldc           #15                 // String Invalid inbound message transport type, this rule only supports HttpServletRequestAdapter
      55: invokeinterface #12,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      60: return
      61: aload_1
      62: checkcast     #10                 // class org/opensaml/common/binding/SAMLMessageContext
      65: astore_2
      66: aload_1
      67: invokeinterface #13,  1           // InterfaceMethod org/opensaml/ws/message/MessageContext.getInboundMessageTransport:()Lorg/opensaml/ws/transport/InTransport;
      72: checkcast     #14                 // class org/opensaml/ws/transport/http/HttpServletRequestAdapter
      75: astore_3
      76: aload_3
      77: invokevirtual #16                 // Method org/opensaml/ws/transport/http/HttpServletRequestAdapter.getWrappedRequest:()Ljavax/servlet/http/HttpServletRequest;
      80: astore        4
      82: aload_0
      83: aload         4
      85: aload_2
      86: invokevirtual #17                 // Method ruleHandles:(Ljavax/servlet/http/HttpServletRequest;Lorg/opensaml/common/binding/SAMLMessageContext;)Z
      89: ifne          104
      92: aload_0
      93: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      96: ldc           #18                 // String Rule can not handle this request, skipping processing
      98: invokeinterface #12,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     103: return
     104: aload_0
     105: aload         4
     107: invokevirtual #19                 // Method getSignature:(Ljavax/servlet/http/HttpServletRequest;)[B
     110: astore        5
     112: aload         5
     114: ifnull        123
     117: aload         5
     119: arraylength
     120: ifne          135
     123: aload_0
     124: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     127: ldc           #20                 // String HTTP request was not signed via simple signature mechanism, skipping
     129: invokeinterface #12,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     134: return
     135: aload_0
     136: aload         4
     138: invokevirtual #21                 // Method getSignatureAlgorithm:(Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
     141: astore        6
     143: aload         6
     145: invokestatic  #22                 // Method org/opensaml/xml/util/DatatypeHelper.isEmpty:(Ljava/lang/String;)Z
     148: ifeq          163
     151: aload_0
     152: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     155: ldc           #23                 // String Signature algorithm could not be extracted from request, can not validate simple signature
     157: invokeinterface #24,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     162: return
     163: aload_0
     164: aload         4
     166: invokevirtual #25                 // Method getSignedContent:(Ljavax/servlet/http/HttpServletRequest;)[B
     169: astore        7
     171: aload         7
     173: ifnull        182
     176: aload         7
     178: arraylength
     179: ifne          194
     182: aload_0
     183: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     186: ldc           #26                 // String Signed content could not be extracted from HTTP request, can not validate
     188: invokeinterface #24,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     193: return
     194: aload_0
     195: aload         5
     197: aload         7
     199: aload         6
     201: aload         4
     203: aload_2
     204: invokespecial #27                 // Method doEvaluate:([B[BLjava/lang/String;Ljavax/servlet/http/HttpServletRequest;Lorg/opensaml/common/binding/SAMLMessageContext;)V
     207: return

  private void doEvaluate(byte[], byte[], java.lang.String, javax.servlet.http.HttpServletRequest, org.opensaml.common.binding.SAMLMessageContext) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aload_0
       1: aload         4
       3: aload         5
       5: invokevirtual #28                 // Method getRequestCredentials:(Ljavax/servlet/http/HttpServletRequest;Lorg/opensaml/common/binding/SAMLMessageContext;)Ljava/util/List;
       8: astore        6
      10: aload         5
      12: invokeinterface #29,  1           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.getInboundMessageIssuer:()Ljava/lang/String;
      17: astore        7
      19: aload         7
      21: ifnull        127
      24: aload_0
      25: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      28: ldc           #30                 // String Attempting to validate SAML protocol message simple signature using context issuer: {}
      30: aload         7
      32: invokeinterface #9,  3            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
      37: aload_0
      38: aload         7
      40: aload         5
      42: invokevirtual #31                 // Method buildCriteriaSet:(Ljava/lang/String;Lorg/opensaml/common/binding/SAMLMessageContext;)Lorg/opensaml/xml/security/CriteriaSet;
      45: astore        8
      47: aload_0
      48: aload_1
      49: aload_2
      50: aload_3
      51: aload         8
      53: aload         6
      55: invokevirtual #32                 // Method validateSignature:([B[BLjava/lang/String;Lorg/opensaml/xml/security/CriteriaSet;Ljava/util/List;)Z
      58: ifeq          104
      61: aload_0
      62: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      65: ldc           #33                 // String Validation of request simple signature succeeded
      67: invokeinterface #34,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      72: aload         5
      74: invokeinterface #35,  1           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.isInboundSAMLMessageAuthenticated:()Z
      79: ifne          103
      82: aload_0
      83: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      86: ldc           #36                 // String Authentication via request simple signature succeeded for context issuer entity ID {}
      88: aload         7
      90: invokeinterface #37,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
      95: aload         5
      97: iconst_1
      98: invokeinterface #38,  2           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.setInboundSAMLMessageAuthenticated:(Z)V
     103: return
     104: aload_0
     105: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     108: ldc           #39                 // String Validation of request simple signature failed for context issuer: {}
     110: aload         7
     112: invokeinterface #40,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
     117: new           #41                 // class org/opensaml/ws/security/SecurityPolicyException
     120: dup
     121: ldc           #42                 // String Validation of request simple signature failed for context issuer
     123: invokespecial #43                 // Method org/opensaml/ws/security/SecurityPolicyException."<init>":(Ljava/lang/String;)V
     126: athrow
     127: aload_0
     128: aload         5
     130: invokevirtual #44                 // Method deriveSignerEntityID:(Lorg/opensaml/common/binding/SAMLMessageContext;)Ljava/lang/String;
     133: astore        8
     135: aload         8
     137: ifnull        252
     140: aload_0
     141: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     144: ldc           #45                 // String Attempting to validate SAML protocol message simple signature using derived issuer: {}
     146: aload         8
     148: invokeinterface #9,  3            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;)V
     153: aload_0
     154: aload         8
     156: aload         5
     158: invokevirtual #31                 // Method buildCriteriaSet:(Ljava/lang/String;Lorg/opensaml/common/binding/SAMLMessageContext;)Lorg/opensaml/xml/security/CriteriaSet;
     161: astore        9
     163: aload_0
     164: aload_1
     165: aload_2
     166: aload_3
     167: aload         9
     169: aload         6
     171: invokevirtual #32                 // Method validateSignature:([B[BLjava/lang/String;Lorg/opensaml/xml/security/CriteriaSet;Ljava/util/List;)Z
     174: ifeq          229
     177: aload_0
     178: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     181: ldc           #33                 // String Validation of request simple signature succeeded
     183: invokeinterface #34,  2           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
     188: aload         5
     190: invokeinterface #35,  1           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.isInboundSAMLMessageAuthenticated:()Z
     195: ifne          228
     198: aload_0
     199: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     202: ldc           #46                 // String Authentication via request simple signature succeeded for derived issuer {}
     204: aload         8
     206: invokeinterface #37,  3           // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;Ljava/lang/Object;)V
     211: aload         5
     213: aload         8
     215: invokeinterface #47,  2           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.setInboundMessageIssuer:(Ljava/lang/String;)V
     220: aload         5
     222: iconst_1
     223: invokeinterface #38,  2           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.setInboundSAMLMessageAuthenticated:(Z)V
     228: return
     229: aload_0
     230: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     233: ldc           #48                 // String Validation of request simple signature failed for derived issuer: {}
     235: aload         8
     237: invokeinterface #40,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Object;)V
     242: new           #41                 // class org/opensaml/ws/security/SecurityPolicyException
     245: dup
     246: ldc           #49                 // String Validation of request simple signature failed for derived issuer
     248: invokespecial #43                 // Method org/opensaml/ws/security/SecurityPolicyException."<init>":(Ljava/lang/String;)V
     251: athrow
     252: aload_0
     253: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     256: ldc           #50                 // String Neither context nor derived issuer available, can not attempt SAML simple signature validation
     258: invokeinterface #24,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     263: new           #41                 // class org/opensaml/ws/security/SecurityPolicyException
     266: dup
     267: ldc           #51                 // String No message issuer available, can not attempt simple signature validation
     269: invokespecial #43                 // Method org/opensaml/ws/security/SecurityPolicyException."<init>":(Ljava/lang/String;)V
     272: athrow

  protected boolean validateSignature(byte[], byte[], java.lang.String, org.opensaml.xml.security.CriteriaSet, java.util.List<org.opensaml.xml.security.credential.Credential>) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aload_0
       1: invokevirtual #52                 // Method getTrustEngine:()Lorg/opensaml/xml/signature/SignatureTrustEngine;
       4: astore        6
       6: aload         5
       8: ifnull        21
      11: aload         5
      13: invokeinterface #53,  1           // InterfaceMethod java/util/List.isEmpty:()Z
      18: ifeq          63
      21: aload         6
      23: aload_1
      24: aload_2
      25: aload_3
      26: aload         4
      28: aconst_null
      29: invokeinterface #54,  6           // InterfaceMethod org/opensaml/xml/signature/SignatureTrustEngine.validate:([B[BLjava/lang/String;Lorg/opensaml/xml/security/CriteriaSet;Lorg/opensaml/xml/security/credential/Credential;)Z
      34: ifeq          50
      37: aload_0
      38: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      41: ldc           #55                 // String Simple signature validation (with no request-derived credentials) was successful
      43: invokeinterface #12,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      48: iconst_1
      49: ireturn
      50: aload_0
      51: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      54: ldc           #56                 // String Simple signature validation (with no request-derived credentials) failed
      56: invokeinterface #24,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      61: iconst_0
      62: ireturn
      63: aload         5
      65: invokeinterface #57,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      70: astore        7
      72: aload         7
      74: invokeinterface #58,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      79: ifeq          127
      82: aload         7
      84: invokeinterface #59,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      89: checkcast     #60                 // class org/opensaml/xml/security/credential/Credential
      92: astore        8
      94: aload         6
      96: aload_1
      97: aload_2
      98: aload_3
      99: aload         4
     101: aload         8
     103: invokeinterface #54,  6           // InterfaceMethod org/opensaml/xml/signature/SignatureTrustEngine.validate:([B[BLjava/lang/String;Lorg/opensaml/xml/security/CriteriaSet;Lorg/opensaml/xml/security/credential/Credential;)Z
     108: ifeq          124
     111: aload_0
     112: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     115: ldc           #61                 // String Simple signature validation succeeded with a request-derived credential
     117: invokeinterface #12,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     122: iconst_1
     123: ireturn
     124: goto          72
     127: aload_0
     128: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     131: ldc           #62                 // String Signature validation using request-derived credentials failed
     133: invokeinterface #24,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     138: iconst_0
     139: ireturn
     140: astore        7
     142: aload_0
     143: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     146: ldc           #64                 // String There was an error evaluating the request\'s simple signature using the trust engine
     148: aload         7
     150: invokeinterface #65,  3           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;Ljava/lang/Throwable;)V
     155: new           #41                 // class org/opensaml/ws/security/SecurityPolicyException
     158: dup
     159: ldc           #66                 // String Error during trust engine evaluation of the simple signature
     161: aload         7
     163: invokespecial #67                 // Method org/opensaml/ws/security/SecurityPolicyException."<init>":(Ljava/lang/String;Ljava/lang/Exception;)V
     166: athrow
    Exception table:
       from    to  target type
           6    49   140   Class org/opensaml/xml/security/SecurityException
          50    62   140   Class org/opensaml/xml/security/SecurityException
          63   123   140   Class org/opensaml/xml/security/SecurityException
         124   139   140   Class org/opensaml/xml/security/SecurityException

  protected java.util.List<org.opensaml.xml.security.credential.Credential> getRequestCredentials(javax.servlet.http.HttpServletRequest, org.opensaml.common.binding.SAMLMessageContext) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aconst_null
       1: areturn

  protected org.opensaml.xml.signature.SignatureTrustEngine getTrustEngine();
    Code:
       0: aload_0
       1: getfield      #5                  // Field trustEngine:Lorg/opensaml/xml/signature/SignatureTrustEngine;
       4: areturn

  protected byte[] getSignature(javax.servlet.http.HttpServletRequest) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aload_1
       1: ldc           #68                 // String Signature
       3: invokeinterface #69,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameter:(Ljava/lang/String;)Ljava/lang/String;
       8: astore_2
       9: aload_2
      10: invokestatic  #22                 // Method org/opensaml/xml/util/DatatypeHelper.isEmpty:(Ljava/lang/String;)Z
      13: ifeq          18
      16: aconst_null
      17: areturn
      18: aload_2
      19: invokestatic  #70                 // Method org/opensaml/xml/util/Base64.decode:(Ljava/lang/String;)[B
      22: areturn

  protected java.lang.String getSignatureAlgorithm(javax.servlet.http.HttpServletRequest) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aload_1
       1: ldc           #71                 // String SigAlg
       3: invokeinterface #69,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameter:(Ljava/lang/String;)Ljava/lang/String;
       8: areturn

  protected java.lang.String deriveSignerEntityID(org.opensaml.common.binding.SAMLMessageContext) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aconst_null
       1: areturn

  protected org.opensaml.xml.security.CriteriaSet buildCriteriaSet(java.lang.String, org.opensaml.common.binding.SAMLMessageContext) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: new           #72                 // class org/opensaml/xml/security/CriteriaSet
       3: dup
       4: invokespecial #73                 // Method org/opensaml/xml/security/CriteriaSet."<init>":()V
       7: astore_3
       8: aload_1
       9: invokestatic  #22                 // Method org/opensaml/xml/util/DatatypeHelper.isEmpty:(Ljava/lang/String;)Z
      12: ifne          28
      15: aload_3
      16: new           #74                 // class org/opensaml/xml/security/criteria/EntityIDCriteria
      19: dup
      20: aload_1
      21: invokespecial #75                 // Method org/opensaml/xml/security/criteria/EntityIDCriteria."<init>":(Ljava/lang/String;)V
      24: invokevirtual #76                 // Method org/opensaml/xml/security/CriteriaSet.add:(Ljava/lang/Object;)Z
      27: pop
      28: new           #77                 // class org/opensaml/security/MetadataCriteria
      31: dup
      32: aload_2
      33: invokeinterface #78,  1           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.getPeerEntityRole:()Ljavax/xml/namespace/QName;
      38: aload_2
      39: invokeinterface #79,  1           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.getInboundSAMLProtocol:()Ljava/lang/String;
      44: invokespecial #80                 // Method org/opensaml/security/MetadataCriteria."<init>":(Ljavax/xml/namespace/QName;Ljava/lang/String;)V
      47: astore        4
      49: aload_3
      50: aload         4
      52: invokevirtual #76                 // Method org/opensaml/xml/security/CriteriaSet.add:(Ljava/lang/Object;)Z
      55: pop
      56: aload_3
      57: new           #81                 // class org/opensaml/xml/security/criteria/UsageCriteria
      60: dup
      61: getstatic     #82                 // Field org/opensaml/xml/security/credential/UsageType.SIGNING:Lorg/opensaml/xml/security/credential/UsageType;
      64: invokespecial #83                 // Method org/opensaml/xml/security/criteria/UsageCriteria."<init>":(Lorg/opensaml/xml/security/credential/UsageType;)V
      67: invokevirtual #76                 // Method org/opensaml/xml/security/CriteriaSet.add:(Ljava/lang/Object;)Z
      70: pop
      71: aload_3
      72: areturn

  protected abstract byte[] getSignedContent(javax.servlet.http.HttpServletRequest) throws org.opensaml.ws.security.SecurityPolicyException;

  protected abstract boolean ruleHandles(javax.servlet.http.HttpServletRequest, org.opensaml.common.binding.SAMLMessageContext) throws org.opensaml.ws.security.SecurityPolicyException;
}
