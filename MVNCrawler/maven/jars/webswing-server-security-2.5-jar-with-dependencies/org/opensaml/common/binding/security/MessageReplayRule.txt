Compiled from "MessageReplayRule.java"
public class org.opensaml.common.binding.security.MessageReplayRule implements org.opensaml.ws.security.SecurityPolicyRule {
  private final org.slf4j.Logger log;

  private org.opensaml.util.storage.ReplayCache replayCache;

  private boolean requiredRule;

  public org.opensaml.common.binding.security.MessageReplayRule(org.opensaml.util.storage.ReplayCache);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc_w         #2                  // class org/opensaml/common/binding/security/MessageReplayRule
       8: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      11: putfield      #4                  // Field log:Lorg/slf4j/Logger;
      14: aload_0
      15: aload_1
      16: putfield      #5                  // Field replayCache:Lorg/opensaml/util/storage/ReplayCache;
      19: aload_0
      20: iconst_1
      21: putfield      #6                  // Field requiredRule:Z
      24: return

  public boolean isRequiredRule();
    Code:
       0: aload_0
       1: getfield      #6                  // Field requiredRule:Z
       4: ireturn

  public void setRequiredRule(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #6                  // Field requiredRule:Z
       5: return

  public void evaluate(org.opensaml.ws.message.MessageContext) throws org.opensaml.ws.security.SecurityPolicyException;
    Code:
       0: aload_1
       1: instanceof    #7                  // class org/opensaml/common/binding/SAMLMessageContext
       4: ifne          19
       7: aload_0
       8: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      11: ldc           #8                  // String Invalid message context type, this policy rule only supports SAMLMessageContext
      13: invokeinterface #9,  2            // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      18: return
      19: aload_1
      20: checkcast     #7                  // class org/opensaml/common/binding/SAMLMessageContext
      23: astore_2
      24: aload_2
      25: invokeinterface #10,  1           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.getInboundMessageIssuer:()Ljava/lang/String;
      30: invokestatic  #11                 // Method org/opensaml/xml/util/DatatypeHelper.safeTrimOrNullString:(Ljava/lang/String;)Ljava/lang/String;
      33: astore_3
      34: aload_3
      35: ifnonnull     67
      38: aload_0
      39: getfield      #6                  // Field requiredRule:Z
      42: ifeq          66
      45: aload_0
      46: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      49: ldc           #12                 // String Message contained no Issuer ID, replay check not possible
      51: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
      56: new           #14                 // class org/opensaml/ws/security/SecurityPolicyException
      59: dup
      60: ldc           #12                 // String Message contained no Issuer ID, replay check not possible
      62: invokespecial #15                 // Method org/opensaml/ws/security/SecurityPolicyException."<init>":(Ljava/lang/String;)V
      65: athrow
      66: return
      67: aload_2
      68: invokeinterface #16,  1           // InterfaceMethod org/opensaml/common/binding/SAMLMessageContext.getInboundSAMLMessageId:()Ljava/lang/String;
      73: invokestatic  #11                 // Method org/opensaml/xml/util/DatatypeHelper.safeTrimOrNullString:(Ljava/lang/String;)Ljava/lang/String;
      76: astore        4
      78: aload         4
      80: ifnonnull     134
      83: aload_0
      84: getfield      #6                  // Field requiredRule:Z
      87: ifeq          133
      90: aload_0
      91: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      94: ldc           #17                 // String Message contained no ID, replay check not possible
      96: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     101: new           #14                 // class org/opensaml/ws/security/SecurityPolicyException
     104: dup
     105: new           #18                 // class java/lang/StringBuilder
     108: dup
     109: invokespecial #19                 // Method java/lang/StringBuilder."<init>":()V
     112: ldc           #20                 // String SAML message from issuer
     114: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     117: aload_3
     118: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     121: ldc           #22                 // String  did not contain an ID
     123: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     126: invokevirtual #23                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     129: invokespecial #15                 // Method org/opensaml/ws/security/SecurityPolicyException."<init>":(Ljava/lang/String;)V
     132: athrow
     133: return
     134: aload_0
     135: getfield      #5                  // Field replayCache:Lorg/opensaml/util/storage/ReplayCache;
     138: aload_3
     139: aload         4
     141: invokevirtual #24                 // Method org/opensaml/util/storage/ReplayCache.isReplay:(Ljava/lang/String;Ljava/lang/String;)Z
     144: ifeq          222
     147: aload_0
     148: getfield      #4                  // Field log:Lorg/slf4j/Logger;
     151: new           #18                 // class java/lang/StringBuilder
     154: dup
     155: invokespecial #19                 // Method java/lang/StringBuilder."<init>":()V
     158: ldc           #25                 // String Replay detected of message \'
     160: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     163: aload         4
     165: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     168: ldc           #26                 // String \' from issuer
     170: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     173: aload_3
     174: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     177: invokevirtual #23                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     180: invokeinterface #13,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     185: new           #14                 // class org/opensaml/ws/security/SecurityPolicyException
     188: dup
     189: new           #18                 // class java/lang/StringBuilder
     192: dup
     193: invokespecial #19                 // Method java/lang/StringBuilder."<init>":()V
     196: ldc           #27                 // String Rejecting replayed message ID \'
     198: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     201: aload         4
     203: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     206: ldc           #26                 // String \' from issuer
     208: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     211: aload_3
     212: invokevirtual #21                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     215: invokevirtual #23                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     218: invokespecial #15                 // Method org/opensaml/ws/security/SecurityPolicyException."<init>":(Ljava/lang/String;)V
     221: athrow
     222: return
}
