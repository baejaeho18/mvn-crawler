Compiled from "DetectOutboundContentRule.java"
public class org.owasp.esapi.waf.rules.DetectOutboundContentRule extends org.owasp.esapi.waf.rules.Rule {
  private java.util.regex.Pattern contentType;

  private java.util.regex.Pattern pattern;

  private java.util.regex.Pattern uri;

  public org.owasp.esapi.waf.rules.DetectOutboundContentRule(java.lang.String, java.util.regex.Pattern, java.util.regex.Pattern, java.util.regex.Pattern);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/owasp/esapi/waf/rules/Rule."<init>":()V
       4: aload_0
       5: aload_2
       6: putfield      #2                  // Field contentType:Ljava/util/regex/Pattern;
       9: aload_0
      10: aload_3
      11: putfield      #3                  // Field pattern:Ljava/util/regex/Pattern;
      14: aload_0
      15: aload         4
      17: putfield      #4                  // Field uri:Ljava/util/regex/Pattern;
      20: aload_0
      21: aload_1
      22: invokevirtual #5                  // Method setId:(Ljava/lang/String;)V
      25: return

  public org.owasp.esapi.waf.actions.Action check(javax.servlet.http.HttpServletRequest, org.owasp.esapi.waf.internal.InterceptingHTTPServletResponse, javax.servlet.http.HttpServletResponse);
    Code:
       0: aload_0
       1: getfield      #4                  // Field uri:Ljava/util/regex/Pattern;
       4: ifnull        34
       7: aload_0
       8: getfield      #4                  // Field uri:Ljava/util/regex/Pattern;
      11: aload_1
      12: invokeinterface #6,  1            // InterfaceMethod javax/servlet/http/HttpServletRequest.getRequestURI:()Ljava/lang/String;
      17: invokevirtual #7                  // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
      20: invokevirtual #8                  // Method java/util/regex/Matcher.matches:()Z
      23: ifne          34
      26: new           #9                  // class org/owasp/esapi/waf/actions/DoNothingAction
      29: dup
      30: invokespecial #10                 // Method org/owasp/esapi/waf/actions/DoNothingAction."<init>":()V
      33: areturn
      34: aload_2
      35: ifnull        67
      38: aload_2
      39: invokevirtual #11                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.getContentType:()Ljava/lang/String;
      42: ifnonnull     52
      45: aload_2
      46: getstatic     #12                 // Field org/owasp/esapi/waf/configuration/AppGuardianConfiguration.DEFAULT_CONTENT_TYPE:Ljava/lang/String;
      49: invokevirtual #13                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.setContentType:(Ljava/lang/String;)V
      52: aload_2
      53: invokevirtual #11                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.getContentType:()Ljava/lang/String;
      56: astore        4
      58: aload_2
      59: invokevirtual #14                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.getCharacterEncoding:()Ljava/lang/String;
      62: astore        5
      64: goto          101
      67: aload_3
      68: invokeinterface #15,  1           // InterfaceMethod javax/servlet/http/HttpServletResponse.getContentType:()Ljava/lang/String;
      73: ifnonnull     85
      76: aload_3
      77: getstatic     #12                 // Field org/owasp/esapi/waf/configuration/AppGuardianConfiguration.DEFAULT_CONTENT_TYPE:Ljava/lang/String;
      80: invokeinterface #16,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setContentType:(Ljava/lang/String;)V
      85: aload_3
      86: invokeinterface #15,  1           // InterfaceMethod javax/servlet/http/HttpServletResponse.getContentType:()Ljava/lang/String;
      91: astore        4
      93: aload_3
      94: invokeinterface #17,  1           // InterfaceMethod javax/servlet/http/HttpServletResponse.getCharacterEncoding:()Ljava/lang/String;
      99: astore        5
     101: aload_0
     102: getfield      #2                  // Field contentType:Ljava/util/regex/Pattern;
     105: aload         4
     107: invokevirtual #7                  // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
     110: invokevirtual #8                  // Method java/util/regex/Matcher.matches:()Z
     113: ifeq          336
     116: aconst_null
     117: astore        6
     119: aload_2
     120: invokevirtual #18                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.getInterceptingServletOutputStream:()Lorg/owasp/esapi/waf/internal/InterceptingServletOutputStream;
     123: invokevirtual #19                 // Method org/owasp/esapi/waf/internal/InterceptingServletOutputStream.getResponseBytes:()[B
     126: astore        6
     128: goto          203
     131: astore        7
     133: aload_0
     134: aload_1
     135: new           #21                 // class java/lang/StringBuilder
     138: dup
     139: invokespecial #22                 // Method java/lang/StringBuilder."<init>":()V
     142: ldc           #23                 // String Error matching pattern \'
     144: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     147: aload_0
     148: getfield      #3                  // Field pattern:Ljava/util/regex/Pattern;
     151: invokevirtual #25                 // Method java/util/regex/Pattern.pattern:()Ljava/lang/String;
     154: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     157: ldc           #26                 // String \', IOException encountered (possibly too large?):
     159: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     162: aload         7
     164: invokevirtual #27                 // Method java/io/IOException.getMessage:()Ljava/lang/String;
     167: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     170: ldc           #28                 // String  (in response to URL: \'
     172: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     175: aload_1
     176: invokeinterface #29,  1           // InterfaceMethod javax/servlet/http/HttpServletRequest.getRequestURL:()Ljava/lang/StringBuffer;
     181: invokevirtual #30                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     184: ldc           #31                 // String \')
     186: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     189: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     192: invokevirtual #33                 // Method log:(Ljavax/servlet/http/HttpServletRequest;Ljava/lang/String;)V
     195: new           #9                  // class org/owasp/esapi/waf/actions/DoNothingAction
     198: dup
     199: invokespecial #10                 // Method org/owasp/esapi/waf/actions/DoNothingAction."<init>":()V
     202: areturn
     203: new           #34                 // class java/lang/String
     206: dup
     207: aload         6
     209: aload         5
     211: invokespecial #35                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
     214: astore        7
     216: aload_0
     217: getfield      #3                  // Field pattern:Ljava/util/regex/Pattern;
     220: aload         7
     222: invokevirtual #7                  // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
     225: invokevirtual #8                  // Method java/util/regex/Matcher.matches:()Z
     228: ifeq          288
     231: aload_0
     232: aload_1
     233: new           #21                 // class java/lang/StringBuilder
     236: dup
     237: invokespecial #22                 // Method java/lang/StringBuilder."<init>":()V
     240: ldc           #36                 // String Content pattern \'
     242: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     245: aload_0
     246: getfield      #3                  // Field pattern:Ljava/util/regex/Pattern;
     249: invokevirtual #25                 // Method java/util/regex/Pattern.pattern:()Ljava/lang/String;
     252: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     255: ldc           #37                 // String \' was found in response to URL: \'
     257: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     260: aload_1
     261: invokeinterface #29,  1           // InterfaceMethod javax/servlet/http/HttpServletRequest.getRequestURL:()Ljava/lang/StringBuffer;
     266: invokevirtual #30                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     269: ldc           #38                 // String \'
     271: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     274: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     277: invokevirtual #33                 // Method log:(Ljavax/servlet/http/HttpServletRequest;Ljava/lang/String;)V
     280: new           #39                 // class org/owasp/esapi/waf/actions/DefaultAction
     283: dup
     284: invokespecial #40                 // Method org/owasp/esapi/waf/actions/DefaultAction."<init>":()V
     287: areturn
     288: goto          336
     291: astore        6
     293: aload_0
     294: aload_1
     295: new           #21                 // class java/lang/StringBuilder
     298: dup
     299: invokespecial #22                 // Method java/lang/StringBuilder."<init>":()V
     302: ldc           #36                 // String Content pattern \'
     304: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     307: aload_0
     308: getfield      #3                  // Field pattern:Ljava/util/regex/Pattern;
     311: invokevirtual #25                 // Method java/util/regex/Pattern.pattern:()Ljava/lang/String;
     314: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     317: ldc           #42                 // String \' could not be found due to encoding error:
     319: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     322: aload         6
     324: invokevirtual #43                 // Method java/io/UnsupportedEncodingException.getMessage:()Ljava/lang/String;
     327: invokevirtual #24                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     330: invokevirtual #32                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     333: invokevirtual #33                 // Method log:(Ljavax/servlet/http/HttpServletRequest;Ljava/lang/String;)V
     336: new           #9                  // class org/owasp/esapi/waf/actions/DoNothingAction
     339: dup
     340: invokespecial #10                 // Method org/owasp/esapi/waf/actions/DoNothingAction."<init>":()V
     343: areturn
    Exception table:
       from    to  target type
         119   128   131   Class java/io/IOException
         116   202   291   Class java/io/UnsupportedEncodingException
         203   287   291   Class java/io/UnsupportedEncodingException
}
