Compiled from "ESAPIWebApplicationFirewallFilter.java"
public class org.owasp.esapi.waf.ESAPIWebApplicationFirewallFilter implements javax.servlet.Filter {
  private org.owasp.esapi.waf.configuration.AppGuardianConfiguration appGuardConfig;

  private static final java.lang.String CONFIGURATION_FILE_PARAM;

  private static final java.lang.String LOGGING_FILE_PARAM;

  private static final java.lang.String POLLING_TIME_PARAM;

  private static final int DEFAULT_POLLING_TIME;

  private java.lang.String configurationFilename;

  private long pollingTime;

  private long lastConfigReadTime;

  private javax.servlet.FilterConfig fc;

  private final org.owasp.esapi.Logger logger;

  public org.owasp.esapi.waf.ESAPIWebApplicationFirewallFilter();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #2                  // Field configurationFilename:Ljava/lang/String;
       9: aload_0
      10: ldc_w         #3                  // class org/owasp/esapi/waf/ESAPIWebApplicationFirewallFilter
      13: invokestatic  #4                  // Method org/owasp/esapi/ESAPI.getLogger:(Ljava/lang/Class;)Lorg/owasp/esapi/Logger;
      16: putfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
      19: return

  public void setConfiguration(java.lang.String, java.lang.String) throws java.io.FileNotFoundException;
    Code:
       0: aload_0
       1: new           #6                  // class java/io/FileInputStream
       4: dup
       5: new           #7                  // class java/io/File
       8: dup
       9: aload_1
      10: invokespecial #8                  // Method java/io/File."<init>":(Ljava/lang/String;)V
      13: invokespecial #9                  // Method java/io/FileInputStream."<init>":(Ljava/io/File;)V
      16: aload_2
      17: invokestatic  #10                 // Method org/owasp/esapi/waf/configuration/ConfigurationParser.readConfigurationFile:(Ljava/io/InputStream;Ljava/lang/String;)Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
      20: putfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
      23: aload_0
      24: invokestatic  #12                 // Method java/lang/System.currentTimeMillis:()J
      27: putfield      #13                 // Field lastConfigReadTime:J
      30: aload_0
      31: aload_1
      32: putfield      #2                  // Field configurationFilename:Ljava/lang/String;
      35: goto          43
      38: astore_3
      39: aload_3
      40: invokevirtual #15                 // Method org/owasp/esapi/waf/ConfigurationException.printStackTrace:()V
      43: return
    Exception table:
       from    to  target type
           0    35    38   Class org/owasp/esapi/waf/ConfigurationException

  public org.owasp.esapi.waf.configuration.AppGuardianConfiguration getConfiguration();
    Code:
       0: aload_0
       1: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
       4: areturn

  public void init(javax.servlet.FilterConfig) throws javax.servlet.ServletException;
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #16                 // Field fc:Ljavax/servlet/FilterConfig;
       5: aload_0
       6: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
       9: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      12: ldc           #18                 // String >> Initializing WAF
      14: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      19: aload_1
      20: ldc           #20                 // String log_settings
      22: invokeinterface #21,  2           // InterfaceMethod javax/servlet/FilterConfig.getInitParameter:(Ljava/lang/String;)Ljava/lang/String;
      27: astore_2
      28: aload_1
      29: invokeinterface #22,  1           // InterfaceMethod javax/servlet/FilterConfig.getServletContext:()Ljavax/servlet/ServletContext;
      34: aload_2
      35: invokeinterface #23,  2           // InterfaceMethod javax/servlet/ServletContext.getRealPath:(Ljava/lang/String;)Ljava/lang/String;
      40: astore_3
      41: aload_3
      42: ifnull        59
      45: new           #7                  // class java/io/File
      48: dup
      49: aload_3
      50: invokespecial #8                  // Method java/io/File."<init>":(Ljava/lang/String;)V
      53: invokevirtual #24                 // Method java/io/File.exists:()Z
      56: ifne          86
      59: new           #25                 // class javax/servlet/ServletException
      62: dup
      63: new           #26                 // class java/lang/StringBuilder
      66: dup
      67: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      70: ldc           #28                 // String [ESAPI WAF] Could not find log file at resolved path:
      72: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      75: aload_3
      76: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      79: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      82: invokespecial #31                 // Method javax/servlet/ServletException."<init>":(Ljava/lang/String;)V
      85: athrow
      86: aload_0
      87: aload_1
      88: ldc           #32                 // String configuration
      90: invokeinterface #21,  2           // InterfaceMethod javax/servlet/FilterConfig.getInitParameter:(Ljava/lang/String;)Ljava/lang/String;
      95: putfield      #2                  // Field configurationFilename:Ljava/lang/String;
      98: aload_0
      99: aload_1
     100: invokeinterface #22,  1           // InterfaceMethod javax/servlet/FilterConfig.getServletContext:()Ljavax/servlet/ServletContext;
     105: aload_0
     106: getfield      #2                  // Field configurationFilename:Ljava/lang/String;
     109: invokeinterface #23,  2           // InterfaceMethod javax/servlet/ServletContext.getRealPath:(Ljava/lang/String;)Ljava/lang/String;
     114: putfield      #2                  // Field configurationFilename:Ljava/lang/String;
     117: aload_0
     118: getfield      #2                  // Field configurationFilename:Ljava/lang/String;
     121: ifnull        141
     124: new           #7                  // class java/io/File
     127: dup
     128: aload_0
     129: getfield      #2                  // Field configurationFilename:Ljava/lang/String;
     132: invokespecial #8                  // Method java/io/File."<init>":(Ljava/lang/String;)V
     135: invokevirtual #24                 // Method java/io/File.exists:()Z
     138: ifne          171
     141: new           #25                 // class javax/servlet/ServletException
     144: dup
     145: new           #26                 // class java/lang/StringBuilder
     148: dup
     149: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     152: ldc           #33                 // String [ESAPI WAF] Could not find configuration file at resolved path:
     154: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     157: aload_0
     158: getfield      #2                  // Field configurationFilename:Ljava/lang/String;
     161: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     164: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     167: invokespecial #31                 // Method javax/servlet/ServletException."<init>":(Ljava/lang/String;)V
     170: athrow
     171: aload_1
     172: ldc           #34                 // String polling_time
     174: invokeinterface #21,  2           // InterfaceMethod javax/servlet/FilterConfig.getInitParameter:(Ljava/lang/String;)Ljava/lang/String;
     179: astore        4
     181: aload         4
     183: ifnull        198
     186: aload_0
     187: aload         4
     189: invokestatic  #35                 // Method java/lang/Long.parseLong:(Ljava/lang/String;)J
     192: putfield      #36                 // Field pollingTime:J
     195: goto          205
     198: aload_0
     199: ldc2_w        #37                 // long 30000l
     202: putfield      #36                 // Field pollingTime:J
     205: aload_1
     206: invokeinterface #22,  1           // InterfaceMethod javax/servlet/FilterConfig.getServletContext:()Ljavax/servlet/ServletContext;
     211: ldc           #39                 // String /
     213: invokeinterface #23,  2           // InterfaceMethod javax/servlet/ServletContext.getRealPath:(Ljava/lang/String;)Ljava/lang/String;
     218: astore        5
     220: aload_0
     221: new           #6                  // class java/io/FileInputStream
     224: dup
     225: aload_0
     226: getfield      #2                  // Field configurationFilename:Ljava/lang/String;
     229: invokespecial #40                 // Method java/io/FileInputStream."<init>":(Ljava/lang/String;)V
     232: aload         5
     234: invokestatic  #10                 // Method org/owasp/esapi/waf/configuration/ConfigurationParser.readConfigurationFile:(Ljava/io/InputStream;Ljava/lang/String;)Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     237: putfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     240: aload_3
     241: invokestatic  #41                 // Method org/apache/log4j/xml/DOMConfigurator.configure:(Ljava/lang/String;)V
     244: aload_0
     245: invokestatic  #12                 // Method java/lang/System.currentTimeMillis:()J
     248: putfield      #13                 // Field lastConfigReadTime:J
     251: goto          278
     254: astore        5
     256: new           #25                 // class javax/servlet/ServletException
     259: dup
     260: aload         5
     262: invokespecial #43                 // Method javax/servlet/ServletException."<init>":(Ljava/lang/Throwable;)V
     265: athrow
     266: astore        5
     268: new           #25                 // class javax/servlet/ServletException
     271: dup
     272: aload         5
     274: invokespecial #43                 // Method javax/servlet/ServletException."<init>":(Ljava/lang/Throwable;)V
     277: athrow
     278: return
    Exception table:
       from    to  target type
         205   251   254   Class java/io/FileNotFoundException
         205   251   266   Class org/owasp/esapi/waf/ConfigurationException

  public void doFilter(javax.servlet.ServletRequest, javax.servlet.ServletResponse, javax.servlet.FilterChain) throws java.io.IOException, javax.servlet.ServletException;
    Code:
       0: invokestatic  #12                 // Method java/lang/System.currentTimeMillis:()J
       3: aload_0
       4: getfield      #13                 // Field lastConfigReadTime:J
       7: lsub
       8: aload_0
       9: getfield      #36                 // Field pollingTime:J
      12: lcmp
      13: ifle          68
      16: new           #7                  // class java/io/File
      19: dup
      20: aload_0
      21: getfield      #2                  // Field configurationFilename:Ljava/lang/String;
      24: invokespecial #8                  // Method java/io/File."<init>":(Ljava/lang/String;)V
      27: astore        4
      29: aload         4
      31: invokevirtual #44                 // Method java/io/File.lastModified:()J
      34: lstore        5
      36: lload         5
      38: aload_0
      39: getfield      #13                 // Field lastConfigReadTime:J
      42: lcmp
      43: ifle          68
      46: aload_0
      47: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
      50: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      53: ldc           #45                 // String >> Re-reading WAF policy
      55: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      60: aload_0
      61: aload_0
      62: getfield      #16                 // Field fc:Ljavax/servlet/FilterConfig;
      65: invokevirtual #46                 // Method init:(Ljavax/servlet/FilterConfig;)V
      68: aload_0
      69: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
      72: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      75: ldc           #47                 // String >>In WAF doFilter
      77: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      82: aload_1
      83: checkcast     #48                 // class javax/servlet/http/HttpServletRequest
      86: astore        4
      88: aload_2
      89: checkcast     #49                 // class javax/servlet/http/HttpServletResponse
      92: astore        5
      94: aconst_null
      95: astore        6
      97: aconst_null
      98: astore        7
     100: aload_0
     101: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     104: invokevirtual #50                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getCookieRules:()Ljava/util/List;
     107: invokeinterface #51,  1           // InterfaceMethod java/util/List.size:()I
     112: aload_0
     113: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     116: invokevirtual #52                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getBeforeResponseRules:()Ljava/util/List;
     119: invokeinterface #51,  1           // InterfaceMethod java/util/List.size:()I
     124: iadd
     125: ifle          147
     128: new           #53                 // class org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse
     131: dup
     132: aload         5
     134: iconst_1
     135: aload_0
     136: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     139: invokevirtual #50                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getCookieRules:()Ljava/util/List;
     142: invokespecial #54                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse."<init>":(Ljavax/servlet/http/HttpServletResponse;ZLjava/util/List;)V
     145: astore        7
     147: aload_0
     148: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
     151: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     154: ldc           #55                 // String >> Starting stage 1
     156: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     161: aload_0
     162: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     165: invokevirtual #56                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getBeforeBodyRules:()Ljava/util/List;
     168: astore        8
     170: iconst_0
     171: istore        9
     173: iload         9
     175: aload         8
     177: invokeinterface #51,  1           // InterfaceMethod java/util/List.size:()I
     182: if_icmpge     414
     185: aload         8
     187: iload         9
     189: invokeinterface #57,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     194: checkcast     #58                 // class org/owasp/esapi/waf/rules/Rule
     197: astore        10
     199: aload_0
     200: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
     203: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     206: new           #26                 // class java/lang/StringBuilder
     209: dup
     210: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     213: ldc           #59                 // String   Applying BEFORE rule:
     215: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     218: aload         10
     220: invokevirtual #60                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
     223: invokevirtual #61                 // Method java/lang/Class.getName:()Ljava/lang/String;
     226: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     229: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     232: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     237: aload         10
     239: aload         4
     241: aload         7
     243: aload         5
     245: invokevirtual #62                 // Method org/owasp/esapi/waf/rules/Rule.check:(Ljavax/servlet/http/HttpServletRequest;Lorg/owasp/esapi/waf/internal/InterceptingHTTPServletResponse;Ljavax/servlet/http/HttpServletResponse;)Lorg/owasp/esapi/waf/actions/Action;
     248: astore        11
     250: aload         11
     252: invokevirtual #63                 // Method org/owasp/esapi/waf/actions/Action.isActionNecessary:()Z
     255: ifeq          408
     258: aload         11
     260: instanceof    #64                 // class org/owasp/esapi/waf/actions/BlockAction
     263: ifeq          301
     266: aload         7
     268: ifnull        286
     271: aload         7
     273: aload_0
     274: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     277: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     280: invokevirtual #66                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.setStatus:(I)V
     283: goto          300
     286: aload         5
     288: aload_0
     289: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     292: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     295: invokeinterface #67,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setStatus:(I)V
     300: return
     301: aload         11
     303: instanceof    #68                 // class org/owasp/esapi/waf/actions/RedirectAction
     306: ifeq          326
     309: aload_0
     310: aload         7
     312: aload         5
     314: aload         11
     316: checkcast     #68                 // class org/owasp/esapi/waf/actions/RedirectAction
     319: invokevirtual #69                 // Method org/owasp/esapi/waf/actions/RedirectAction.getRedirectURL:()Ljava/lang/String;
     322: invokespecial #70                 // Method sendRedirect:(Lorg/owasp/esapi/waf/internal/InterceptingHTTPServletResponse;Ljavax/servlet/http/HttpServletResponse;Ljava/lang/String;)V
     325: return
     326: aload         11
     328: instanceof    #71                 // class org/owasp/esapi/waf/actions/DefaultAction
     331: ifeq          408
     334: getstatic     #72                 // Field org/owasp/esapi/waf/configuration/AppGuardianConfiguration.DEFAULT_FAIL_ACTION:I
     337: lookupswitch  { // 2
                     1: 399
                     2: 364
               default: 408
          }
     364: aload         7
     366: ifnull        384
     369: aload         7
     371: aload_0
     372: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     375: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     378: invokevirtual #66                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.setStatus:(I)V
     381: goto          398
     384: aload         5
     386: aload_0
     387: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     390: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     393: invokeinterface #67,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setStatus:(I)V
     398: return
     399: aload_0
     400: aload         7
     402: aload         5
     404: invokespecial #73                 // Method sendRedirect:(Lorg/owasp/esapi/waf/internal/InterceptingHTTPServletResponse;Ljavax/servlet/http/HttpServletResponse;)V
     407: return
     408: iinc          9, 1
     411: goto          173
     414: new           #74                 // class org/owasp/esapi/waf/internal/InterceptingHTTPServletRequest
     417: dup
     418: aload_1
     419: checkcast     #48                 // class javax/servlet/http/HttpServletRequest
     422: invokespecial #75                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletRequest."<init>":(Ljavax/servlet/http/HttpServletRequest;)V
     425: astore        6
     427: goto          448
     430: astore        9
     432: aload_0
     433: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
     436: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     439: ldc           #77                 // String Error Wrapping Request
     441: aload         9
     443: invokeinterface #78,  4           // InterfaceMethod org/owasp/esapi/Logger.error:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     448: aload_0
     449: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
     452: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     455: ldc           #79                 // String >> Starting Stage 2
     457: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     462: aload_0
     463: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     466: invokevirtual #80                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getAfterBodyRules:()Ljava/util/List;
     469: astore        8
     471: iconst_0
     472: istore        9
     474: iload         9
     476: aload         8
     478: invokeinterface #51,  1           // InterfaceMethod java/util/List.size:()I
     483: if_icmpge     714
     486: aload         8
     488: iload         9
     490: invokeinterface #57,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     495: checkcast     #58                 // class org/owasp/esapi/waf/rules/Rule
     498: astore        10
     500: aload_0
     501: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
     504: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     507: new           #26                 // class java/lang/StringBuilder
     510: dup
     511: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     514: ldc           #81                 // String   Applying BEFORE CHAIN rule:
     516: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     519: aload         10
     521: invokevirtual #60                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
     524: invokevirtual #61                 // Method java/lang/Class.getName:()Ljava/lang/String;
     527: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     530: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     533: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     538: aload         10
     540: aload         6
     542: aload         7
     544: aload         5
     546: invokevirtual #62                 // Method org/owasp/esapi/waf/rules/Rule.check:(Ljavax/servlet/http/HttpServletRequest;Lorg/owasp/esapi/waf/internal/InterceptingHTTPServletResponse;Ljavax/servlet/http/HttpServletResponse;)Lorg/owasp/esapi/waf/actions/Action;
     549: astore        11
     551: aload         11
     553: invokevirtual #63                 // Method org/owasp/esapi/waf/actions/Action.isActionNecessary:()Z
     556: ifeq          708
     559: aload         11
     561: instanceof    #64                 // class org/owasp/esapi/waf/actions/BlockAction
     564: ifeq          602
     567: aload         7
     569: ifnull        587
     572: aload         7
     574: aload_0
     575: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     578: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     581: invokevirtual #66                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.setStatus:(I)V
     584: goto          601
     587: aload         5
     589: aload_0
     590: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     593: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     596: invokeinterface #67,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setStatus:(I)V
     601: return
     602: aload         11
     604: instanceof    #68                 // class org/owasp/esapi/waf/actions/RedirectAction
     607: ifeq          627
     610: aload_0
     611: aload         7
     613: aload         5
     615: aload         11
     617: checkcast     #68                 // class org/owasp/esapi/waf/actions/RedirectAction
     620: invokevirtual #69                 // Method org/owasp/esapi/waf/actions/RedirectAction.getRedirectURL:()Ljava/lang/String;
     623: invokespecial #70                 // Method sendRedirect:(Lorg/owasp/esapi/waf/internal/InterceptingHTTPServletResponse;Ljavax/servlet/http/HttpServletResponse;Ljava/lang/String;)V
     626: return
     627: aload         11
     629: instanceof    #71                 // class org/owasp/esapi/waf/actions/DefaultAction
     632: ifeq          708
     635: getstatic     #72                 // Field org/owasp/esapi/waf/configuration/AppGuardianConfiguration.DEFAULT_FAIL_ACTION:I
     638: lookupswitch  { // 2
                     1: 699
                     2: 664
               default: 708
          }
     664: aload         7
     666: ifnull        684
     669: aload         7
     671: aload_0
     672: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     675: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     678: invokevirtual #66                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.setStatus:(I)V
     681: goto          698
     684: aload         5
     686: aload_0
     687: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     690: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     693: invokeinterface #67,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setStatus:(I)V
     698: return
     699: aload_0
     700: aload         7
     702: aload         5
     704: invokespecial #73                 // Method sendRedirect:(Lorg/owasp/esapi/waf/internal/InterceptingHTTPServletResponse;Ljavax/servlet/http/HttpServletResponse;)V
     707: return
     708: iinc          9, 1
     711: goto          474
     714: aload_0
     715: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
     718: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     721: new           #26                 // class java/lang/StringBuilder
     724: dup
     725: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     728: ldc           #82                 // String >> Calling the FilterChain:
     730: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     733: aload_3
     734: invokevirtual #83                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     737: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     740: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     745: aload_3
     746: aload         6
     748: aload         7
     750: ifnull        758
     753: aload         7
     755: goto          760
     758: aload         5
     760: invokeinterface #84,  3           // InterfaceMethod javax/servlet/FilterChain.doFilter:(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V
     765: aload_0
     766: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
     769: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     772: ldc           #85                 // String >> Starting Stage 3
     774: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     779: aload_0
     780: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     783: invokevirtual #52                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getBeforeResponseRules:()Ljava/util/List;
     786: astore        8
     788: iconst_0
     789: istore        9
     791: iload         9
     793: aload         8
     795: invokeinterface #51,  1           // InterfaceMethod java/util/List.size:()I
     800: if_icmpge     1030
     803: aload         8
     805: iload         9
     807: invokeinterface #57,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     812: checkcast     #58                 // class org/owasp/esapi/waf/rules/Rule
     815: astore        10
     817: aload_0
     818: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
     821: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     824: new           #26                 // class java/lang/StringBuilder
     827: dup
     828: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     831: ldc           #86                 // String   Applying AFTER CHAIN rule:
     833: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     836: aload         10
     838: invokevirtual #60                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
     841: invokevirtual #61                 // Method java/lang/Class.getName:()Ljava/lang/String;
     844: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     847: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     850: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     855: aload         10
     857: aload         6
     859: aload         7
     861: aload         5
     863: invokevirtual #62                 // Method org/owasp/esapi/waf/rules/Rule.check:(Ljavax/servlet/http/HttpServletRequest;Lorg/owasp/esapi/waf/internal/InterceptingHTTPServletResponse;Ljavax/servlet/http/HttpServletResponse;)Lorg/owasp/esapi/waf/actions/Action;
     866: astore        11
     868: aload         11
     870: invokevirtual #63                 // Method org/owasp/esapi/waf/actions/Action.isActionNecessary:()Z
     873: ifeq          1024
     876: aload         11
     878: instanceof    #64                 // class org/owasp/esapi/waf/actions/BlockAction
     881: ifeq          919
     884: aload         7
     886: ifnull        904
     889: aload         7
     891: aload_0
     892: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     895: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     898: invokevirtual #66                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.setStatus:(I)V
     901: goto          918
     904: aload         5
     906: aload_0
     907: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     910: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     913: invokeinterface #67,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setStatus:(I)V
     918: return
     919: aload         11
     921: instanceof    #68                 // class org/owasp/esapi/waf/actions/RedirectAction
     924: ifeq          944
     927: aload_0
     928: aload         7
     930: aload         5
     932: aload         11
     934: checkcast     #68                 // class org/owasp/esapi/waf/actions/RedirectAction
     937: invokevirtual #69                 // Method org/owasp/esapi/waf/actions/RedirectAction.getRedirectURL:()Ljava/lang/String;
     940: invokespecial #70                 // Method sendRedirect:(Lorg/owasp/esapi/waf/internal/InterceptingHTTPServletResponse;Ljavax/servlet/http/HttpServletResponse;Ljava/lang/String;)V
     943: return
     944: aload         11
     946: instanceof    #71                 // class org/owasp/esapi/waf/actions/DefaultAction
     949: ifeq          1024
     952: getstatic     #72                 // Field org/owasp/esapi/waf/configuration/AppGuardianConfiguration.DEFAULT_FAIL_ACTION:I
     955: lookupswitch  { // 2
                     1: 1015
                     2: 980
               default: 1024
          }
     980: aload         7
     982: ifnull        1000
     985: aload         7
     987: aload_0
     988: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
     991: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
     994: invokevirtual #66                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.setStatus:(I)V
     997: goto          1014
    1000: aload         5
    1002: aload_0
    1003: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
    1006: invokevirtual #65                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultResponseCode:()I
    1009: invokeinterface #67,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.setStatus:(I)V
    1014: return
    1015: aload_0
    1016: aload         7
    1018: aload         5
    1020: invokespecial #73                 // Method sendRedirect:(Lorg/owasp/esapi/waf/internal/InterceptingHTTPServletResponse;Ljavax/servlet/http/HttpServletResponse;)V
    1023: return
    1024: iinc          9, 1
    1027: goto          791
    1030: aload         7
    1032: ifnull        1054
    1035: aload_0
    1036: getfield      #5                  // Field logger:Lorg/owasp/esapi/Logger;
    1039: getstatic     #17                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
    1042: ldc           #87                 // String >>> committing reponse
    1044: invokeinterface #19,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
    1049: aload         7
    1051: invokevirtual #88                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.commit:()V
    1054: return
    Exception table:
       from    to  target type
         414   427   430   Class org/apache/commons/fileupload/FileUploadException

  private void sendRedirect(org.owasp.esapi.waf.internal.InterceptingHTTPServletResponse, javax.servlet.http.HttpServletResponse, java.lang.String) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnull        24
       4: aload_1
       5: invokevirtual #89                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.reset:()V
       8: aload_1
       9: invokevirtual #90                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.resetBuffer:()V
      12: aload_1
      13: aload_3
      14: invokevirtual #91                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.sendRedirect:(Ljava/lang/String;)V
      17: aload_1
      18: invokevirtual #88                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.commit:()V
      21: goto          31
      24: aload_2
      25: aload_3
      26: invokeinterface #92,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendRedirect:(Ljava/lang/String;)V
      31: return

  public void destroy();
    Code:
       0: return

  private void sendRedirect(org.owasp.esapi.waf.internal.InterceptingHTTPServletResponse, javax.servlet.http.HttpServletResponse) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnull        26
       4: aload_1
       5: invokevirtual #89                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.reset:()V
       8: aload_1
       9: invokevirtual #90                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.resetBuffer:()V
      12: aload_1
      13: aload_0
      14: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
      17: invokevirtual #93                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultErrorPage:()Ljava/lang/String;
      20: invokevirtual #91                 // Method org/owasp/esapi/waf/internal/InterceptingHTTPServletResponse.sendRedirect:(Ljava/lang/String;)V
      23: goto          48
      26: aload_2
      27: invokeinterface #94,  1           // InterfaceMethod javax/servlet/http/HttpServletResponse.isCommitted:()Z
      32: ifne          48
      35: aload_2
      36: aload_0
      37: getfield      #11                 // Field appGuardConfig:Lorg/owasp/esapi/waf/configuration/AppGuardianConfiguration;
      40: invokevirtual #93                 // Method org/owasp/esapi/waf/configuration/AppGuardianConfiguration.getDefaultErrorPage:()Ljava/lang/String;
      43: invokeinterface #92,  2           // InterfaceMethod javax/servlet/http/HttpServletResponse.sendRedirect:(Ljava/lang/String;)V
      48: return
}
