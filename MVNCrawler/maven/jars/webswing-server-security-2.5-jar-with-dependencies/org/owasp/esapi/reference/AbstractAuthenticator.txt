Compiled from "AbstractAuthenticator.java"
public abstract class org.owasp.esapi.reference.AbstractAuthenticator implements org.owasp.esapi.Authenticator {
  protected static final java.lang.String USER;

  private final org.owasp.esapi.Logger logger;

  private final org.owasp.esapi.reference.AbstractAuthenticator$ThreadLocalUser currentUser;

  public org.owasp.esapi.reference.AbstractAuthenticator();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc           #2                  // String Authenticator
       7: invokestatic  #3                  // Method org/owasp/esapi/ESAPI.getLogger:(Ljava/lang/String;)Lorg/owasp/esapi/Logger;
      10: putfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
      13: aload_0
      14: new           #5                  // class org/owasp/esapi/reference/AbstractAuthenticator$ThreadLocalUser
      17: dup
      18: aload_0
      19: aconst_null
      20: invokespecial #6                  // Method org/owasp/esapi/reference/AbstractAuthenticator$ThreadLocalUser."<init>":(Lorg/owasp/esapi/reference/AbstractAuthenticator;Lorg/owasp/esapi/reference/AbstractAuthenticator$1;)V
      23: putfield      #7                  // Field currentUser:Lorg/owasp/esapi/reference/AbstractAuthenticator$ThreadLocalUser;
      26: return

  public void clearCurrent();
    Code:
       0: aload_0
       1: getfield      #7                  // Field currentUser:Lorg/owasp/esapi/reference/AbstractAuthenticator$ThreadLocalUser;
       4: aconst_null
       5: invokevirtual #8                  // Method org/owasp/esapi/reference/AbstractAuthenticator$ThreadLocalUser.setUser:(Lorg/owasp/esapi/User;)V
       8: return

  public boolean exists(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #9                  // Method getUser:(Ljava/lang/String;)Lorg/owasp/esapi/User;
       5: ifnull        12
       8: iconst_1
       9: goto          13
      12: iconst_0
      13: ireturn

  public org.owasp.esapi.User getCurrentUser();
    Code:
       0: aload_0
       1: getfield      #7                  // Field currentUser:Lorg/owasp/esapi/reference/AbstractAuthenticator$ThreadLocalUser;
       4: invokevirtual #10                 // Method org/owasp/esapi/reference/AbstractAuthenticator$ThreadLocalUser.get:()Ljava/lang/Object;
       7: checkcast     #11                 // class org/owasp/esapi/User
      10: astore_1
      11: aload_1
      12: ifnonnull     19
      15: getstatic     #12                 // Field org/owasp/esapi/User.ANONYMOUS:Lorg/owasp/esapi/User;
      18: astore_1
      19: aload_1
      20: areturn

  protected org.owasp.esapi.User getUserFromSession();
    Code:
       0: invokestatic  #13                 // Method org/owasp/esapi/ESAPI.httpUtilities:()Lorg/owasp/esapi/HTTPUtilities;
       3: invokeinterface #14,  1           // InterfaceMethod org/owasp/esapi/HTTPUtilities.getCurrentRequest:()Ljavax/servlet/http/HttpServletRequest;
       8: iconst_0
       9: invokeinterface #15,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getSession:(Z)Ljavax/servlet/http/HttpSession;
      14: astore_1
      15: aload_1
      16: ifnonnull     21
      19: aconst_null
      20: areturn
      21: invokestatic  #13                 // Method org/owasp/esapi/ESAPI.httpUtilities:()Lorg/owasp/esapi/HTTPUtilities;
      24: ldc           #16                 // String ESAPIUserSessionKey
      26: invokeinterface #17,  2           // InterfaceMethod org/owasp/esapi/HTTPUtilities.getSessionAttribute:(Ljava/lang/String;)Ljava/lang/Object;
      31: checkcast     #11                 // class org/owasp/esapi/User
      34: areturn

  protected org.owasp.esapi.reference.DefaultUser getUserFromRememberToken();
    Code:
       0: invokestatic  #13                 // Method org/owasp/esapi/ESAPI.httpUtilities:()Lorg/owasp/esapi/HTTPUtilities;
       3: invokestatic  #18                 // Method org/owasp/esapi/ESAPI.currentRequest:()Ljavax/servlet/http/HttpServletRequest;
       6: ldc           #19                 // String rtoken
       8: invokeinterface #20,  3           // InterfaceMethod org/owasp/esapi/HTTPUtilities.getCookie:(Ljavax/servlet/http/HttpServletRequest;Ljava/lang/String;)Ljava/lang/String;
      13: astore_1
      14: aload_1
      15: ifnonnull     20
      18: aconst_null
      19: areturn
      20: invokestatic  #21                 // Method org/owasp/esapi/ESAPI.encryptor:()Lorg/owasp/esapi/Encryptor;
      23: aload_1
      24: invokeinterface #22,  2           // InterfaceMethod org/owasp/esapi/Encryptor.unseal:(Ljava/lang/String;)Ljava/lang/String;
      29: ldc           #23                 // String \\|
      31: invokevirtual #24                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
      34: astore_2
      35: aload_2
      36: arraylength
      37: iconst_2
      38: if_icmpeq     73
      41: aload_0
      42: getfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
      45: getstatic     #25                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
      48: ldc           #26                 // String Found corrupt or expired remember token
      50: invokeinterface #27,  3           // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      55: invokestatic  #13                 // Method org/owasp/esapi/ESAPI.httpUtilities:()Lorg/owasp/esapi/HTTPUtilities;
      58: invokestatic  #18                 // Method org/owasp/esapi/ESAPI.currentRequest:()Ljavax/servlet/http/HttpServletRequest;
      61: invokestatic  #28                 // Method org/owasp/esapi/ESAPI.currentResponse:()Ljavax/servlet/http/HttpServletResponse;
      64: ldc           #19                 // String rtoken
      66: invokeinterface #29,  4           // InterfaceMethod org/owasp/esapi/HTTPUtilities.killCookie:(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;Ljava/lang/String;)V
      71: aconst_null
      72: areturn
      73: aload_2
      74: iconst_0
      75: aaload
      76: astore_3
      77: aload_2
      78: iconst_1
      79: aaload
      80: astore        4
      82: aload_0
      83: aload_3
      84: invokevirtual #9                  // Method getUser:(Ljava/lang/String;)Lorg/owasp/esapi/User;
      87: checkcast     #30                 // class org/owasp/esapi/reference/DefaultUser
      90: astore        5
      92: aload         5
      94: ifnonnull     130
      97: aload_0
      98: getfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
     101: getstatic     #25                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     104: new           #31                 // class java/lang/StringBuilder
     107: dup
     108: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     111: ldc           #33                 // String Found valid remember token but no user matching
     113: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     116: aload_3
     117: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     120: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     123: invokeinterface #27,  3           // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     128: aconst_null
     129: areturn
     130: aload_0
     131: getfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
     134: getstatic     #36                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     137: new           #31                 // class java/lang/StringBuilder
     140: dup
     141: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     144: ldc           #37                 // String Logging in user with remember token:
     146: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     149: aload         5
     151: invokevirtual #38                 // Method org/owasp/esapi/reference/DefaultUser.getAccountName:()Ljava/lang/String;
     154: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     157: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     160: invokeinterface #39,  3           // InterfaceMethod org/owasp/esapi/Logger.info:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     165: aload         5
     167: aload         4
     169: invokevirtual #40                 // Method org/owasp/esapi/reference/DefaultUser.loginWithPassword:(Ljava/lang/String;)V
     172: aload         5
     174: areturn
     175: astore_1
     176: aload_0
     177: getfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
     180: getstatic     #25                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     183: ldc           #42                 // String Login via remember me cookie failed
     185: aload_1
     186: invokeinterface #43,  4           // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     191: goto          209
     194: astore_1
     195: aload_0
     196: getfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
     199: getstatic     #25                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     202: ldc           #45                 // String Remember token was missing, corrupt, or expired
     204: invokeinterface #27,  3           // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     209: invokestatic  #13                 // Method org/owasp/esapi/ESAPI.httpUtilities:()Lorg/owasp/esapi/HTTPUtilities;
     212: invokestatic  #18                 // Method org/owasp/esapi/ESAPI.currentRequest:()Ljavax/servlet/http/HttpServletRequest;
     215: invokestatic  #28                 // Method org/owasp/esapi/ESAPI.currentResponse:()Ljavax/servlet/http/HttpServletResponse;
     218: ldc           #19                 // String rtoken
     220: invokeinterface #29,  4           // InterfaceMethod org/owasp/esapi/HTTPUtilities.killCookie:(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;Ljava/lang/String;)V
     225: aconst_null
     226: areturn
    Exception table:
       from    to  target type
           0    19   175   Class org/owasp/esapi/errors/AuthenticationException
          20    72   175   Class org/owasp/esapi/errors/AuthenticationException
          73   129   175   Class org/owasp/esapi/errors/AuthenticationException
         130   174   175   Class org/owasp/esapi/errors/AuthenticationException
           0    19   194   Class org/owasp/esapi/errors/EnterpriseSecurityException
          20    72   194   Class org/owasp/esapi/errors/EnterpriseSecurityException
          73   129   194   Class org/owasp/esapi/errors/EnterpriseSecurityException
         130   174   194   Class org/owasp/esapi/errors/EnterpriseSecurityException

  private org.owasp.esapi.User loginWithUsernameAndPassword(javax.servlet.http.HttpServletRequest) throws org.owasp.esapi.errors.AuthenticationException;
    Code:
       0: aload_1
       1: invokestatic  #46                 // Method org/owasp/esapi/ESAPI.securityConfiguration:()Lorg/owasp/esapi/SecurityConfiguration;
       4: invokeinterface #47,  1           // InterfaceMethod org/owasp/esapi/SecurityConfiguration.getUsernameParameterName:()Ljava/lang/String;
       9: invokeinterface #48,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameter:(Ljava/lang/String;)Ljava/lang/String;
      14: astore_2
      15: aload_1
      16: invokestatic  #46                 // Method org/owasp/esapi/ESAPI.securityConfiguration:()Lorg/owasp/esapi/SecurityConfiguration;
      19: invokeinterface #49,  1           // InterfaceMethod org/owasp/esapi/SecurityConfiguration.getPasswordParameterName:()Ljava/lang/String;
      24: invokeinterface #48,  2           // InterfaceMethod javax/servlet/http/HttpServletRequest.getParameter:(Ljava/lang/String;)Ljava/lang/String;
      29: astore_3
      30: aload_0
      31: invokevirtual #50                 // Method getCurrentUser:()Lorg/owasp/esapi/User;
      34: astore        4
      36: aload         4
      38: ifnull        72
      41: aload         4
      43: invokeinterface #51,  1           // InterfaceMethod org/owasp/esapi/User.isAnonymous:()Z
      48: ifne          72
      51: aload_0
      52: getfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
      55: getstatic     #36                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      58: ldc           #52                 // String User requested relogin. Performing logout then authentication
      60: invokeinterface #27,  3           // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      65: aload         4
      67: invokeinterface #53,  1           // InterfaceMethod org/owasp/esapi/User.logout:()V
      72: aload_2
      73: ifnull        80
      76: aload_3
      77: ifnonnull     121
      80: aload_2
      81: ifnonnull     87
      84: ldc           #54                 // String unspecified user
      86: astore_2
      87: new           #55                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
      90: dup
      91: ldc           #56                 // String Authentication failed
      93: new           #31                 // class java/lang/StringBuilder
      96: dup
      97: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     100: ldc           #57                 // String Authentication failed for
     102: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     105: aload_2
     106: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     109: ldc           #58                 // String  because of null username or password
     111: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     114: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     117: invokespecial #59                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     120: athrow
     121: aload_0
     122: aload_2
     123: invokevirtual #9                  // Method getUser:(Ljava/lang/String;)Lorg/owasp/esapi/User;
     126: astore        4
     128: aload         4
     130: ifnonnull     167
     133: new           #55                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
     136: dup
     137: ldc           #56                 // String Authentication failed
     139: new           #31                 // class java/lang/StringBuilder
     142: dup
     143: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     146: ldc           #60                 // String Authentication failed because user
     148: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     151: aload_2
     152: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     155: ldc           #61                 // String  doesn\'t exist
     157: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     160: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     163: invokespecial #59                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     166: athrow
     167: aload         4
     169: aload_3
     170: invokeinterface #62,  2           // InterfaceMethod org/owasp/esapi/User.loginWithPassword:(Ljava/lang/String;)V
     175: aload_1
     176: aload         4
     178: invokeinterface #63,  1           // InterfaceMethod org/owasp/esapi/User.getCSRFToken:()Ljava/lang/String;
     183: ldc           #64                 // String authenticated
     185: invokeinterface #65,  3           // InterfaceMethod javax/servlet/http/HttpServletRequest.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
     190: aload         4
     192: areturn

  public org.owasp.esapi.User login() throws org.owasp.esapi.errors.AuthenticationException;
    Code:
       0: aload_0
       1: invokestatic  #18                 // Method org/owasp/esapi/ESAPI.currentRequest:()Ljavax/servlet/http/HttpServletRequest;
       4: invokestatic  #28                 // Method org/owasp/esapi/ESAPI.currentResponse:()Ljavax/servlet/http/HttpServletResponse;
       7: invokevirtual #66                 // Method login:(Ljavax/servlet/http/HttpServletRequest;Ljavax/servlet/http/HttpServletResponse;)Lorg/owasp/esapi/User;
      10: areturn

  public org.owasp.esapi.User login(javax.servlet.http.HttpServletRequest, javax.servlet.http.HttpServletResponse) throws org.owasp.esapi.errors.AuthenticationException;
    Code:
       0: aload_1
       1: ifnull        8
       4: aload_2
       5: ifnonnull     20
       8: new           #55                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
      11: dup
      12: ldc           #67                 // String Invalid request
      14: ldc           #68                 // String Request or response objects were null
      16: invokespecial #59                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      19: athrow
      20: aload_0
      21: invokevirtual #69                 // Method getUserFromSession:()Lorg/owasp/esapi/User;
      24: checkcast     #30                 // class org/owasp/esapi/reference/DefaultUser
      27: astore_3
      28: aload_3
      29: ifnonnull     37
      32: aload_0
      33: invokevirtual #70                 // Method getUserFromRememberToken:()Lorg/owasp/esapi/reference/DefaultUser;
      36: astore_3
      37: aload_3
      38: ifnonnull     50
      41: aload_0
      42: aload_1
      43: invokespecial #71                 // Method loginWithUsernameAndPassword:(Ljavax/servlet/http/HttpServletRequest;)Lorg/owasp/esapi/User;
      46: checkcast     #30                 // class org/owasp/esapi/reference/DefaultUser
      49: astore_3
      50: aload_3
      51: aload_1
      52: invokeinterface #72,  1           // InterfaceMethod javax/servlet/http/HttpServletRequest.getRemoteHost:()Ljava/lang/String;
      57: invokevirtual #73                 // Method org/owasp/esapi/reference/DefaultUser.setLastHostAddress:(Ljava/lang/String;)V
      60: invokestatic  #13                 // Method org/owasp/esapi/ESAPI.httpUtilities:()Lorg/owasp/esapi/HTTPUtilities;
      63: invokestatic  #18                 // Method org/owasp/esapi/ESAPI.currentRequest:()Ljavax/servlet/http/HttpServletRequest;
      66: invokeinterface #74,  2           // InterfaceMethod org/owasp/esapi/HTTPUtilities.assertSecureRequest:(Ljavax/servlet/http/HttpServletRequest;)V
      71: goto          93
      74: astore        4
      76: new           #41                 // class org/owasp/esapi/errors/AuthenticationException
      79: dup
      80: ldc           #76                 // String Attempt to login with an insecure request
      82: aload         4
      84: invokevirtual #77                 // Method org/owasp/esapi/errors/AccessControlException.getLogMessage:()Ljava/lang/String;
      87: aload         4
      89: invokespecial #78                 // Method org/owasp/esapi/errors/AuthenticationException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
      92: athrow
      93: aload_3
      94: invokevirtual #79                 // Method org/owasp/esapi/reference/DefaultUser.isAnonymous:()Z
      97: ifeq          136
     100: aload_3
     101: invokevirtual #80                 // Method org/owasp/esapi/reference/DefaultUser.logout:()V
     104: new           #81                 // class org/owasp/esapi/errors/AuthenticationLoginException
     107: dup
     108: ldc           #82                 // String Login failed
     110: new           #31                 // class java/lang/StringBuilder
     113: dup
     114: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     117: ldc           #83                 // String Anonymous user cannot be set to current user. User:
     119: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     122: aload_3
     123: invokevirtual #38                 // Method org/owasp/esapi/reference/DefaultUser.getAccountName:()Ljava/lang/String;
     126: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     129: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     132: invokespecial #84                 // Method org/owasp/esapi/errors/AuthenticationLoginException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     135: athrow
     136: aload_3
     137: invokevirtual #85                 // Method org/owasp/esapi/reference/DefaultUser.isEnabled:()Z
     140: ifne          194
     143: aload_3
     144: invokevirtual #80                 // Method org/owasp/esapi/reference/DefaultUser.logout:()V
     147: aload_3
     148: invokevirtual #86                 // Method org/owasp/esapi/reference/DefaultUser.incrementFailedLoginCount:()V
     151: aload_3
     152: new           #87                 // class java/util/Date
     155: dup
     156: invokespecial #88                 // Method java/util/Date."<init>":()V
     159: invokevirtual #89                 // Method org/owasp/esapi/reference/DefaultUser.setLastFailedLoginTime:(Ljava/util/Date;)V
     162: new           #81                 // class org/owasp/esapi/errors/AuthenticationLoginException
     165: dup
     166: ldc           #82                 // String Login failed
     168: new           #31                 // class java/lang/StringBuilder
     171: dup
     172: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     175: ldc           #90                 // String Disabled user cannot be set to current user. User:
     177: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     180: aload_3
     181: invokevirtual #38                 // Method org/owasp/esapi/reference/DefaultUser.getAccountName:()Ljava/lang/String;
     184: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     187: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     190: invokespecial #84                 // Method org/owasp/esapi/errors/AuthenticationLoginException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     193: athrow
     194: aload_3
     195: invokevirtual #91                 // Method org/owasp/esapi/reference/DefaultUser.isLocked:()Z
     198: ifeq          252
     201: aload_3
     202: invokevirtual #80                 // Method org/owasp/esapi/reference/DefaultUser.logout:()V
     205: aload_3
     206: invokevirtual #86                 // Method org/owasp/esapi/reference/DefaultUser.incrementFailedLoginCount:()V
     209: aload_3
     210: new           #87                 // class java/util/Date
     213: dup
     214: invokespecial #88                 // Method java/util/Date."<init>":()V
     217: invokevirtual #89                 // Method org/owasp/esapi/reference/DefaultUser.setLastFailedLoginTime:(Ljava/util/Date;)V
     220: new           #81                 // class org/owasp/esapi/errors/AuthenticationLoginException
     223: dup
     224: ldc           #82                 // String Login failed
     226: new           #31                 // class java/lang/StringBuilder
     229: dup
     230: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     233: ldc           #92                 // String Locked user cannot be set to current user. User:
     235: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     238: aload_3
     239: invokevirtual #38                 // Method org/owasp/esapi/reference/DefaultUser.getAccountName:()Ljava/lang/String;
     242: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     245: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     248: invokespecial #84                 // Method org/owasp/esapi/errors/AuthenticationLoginException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     251: athrow
     252: aload_3
     253: invokevirtual #93                 // Method org/owasp/esapi/reference/DefaultUser.isExpired:()Z
     256: ifeq          310
     259: aload_3
     260: invokevirtual #80                 // Method org/owasp/esapi/reference/DefaultUser.logout:()V
     263: aload_3
     264: invokevirtual #86                 // Method org/owasp/esapi/reference/DefaultUser.incrementFailedLoginCount:()V
     267: aload_3
     268: new           #87                 // class java/util/Date
     271: dup
     272: invokespecial #88                 // Method java/util/Date."<init>":()V
     275: invokevirtual #89                 // Method org/owasp/esapi/reference/DefaultUser.setLastFailedLoginTime:(Ljava/util/Date;)V
     278: new           #81                 // class org/owasp/esapi/errors/AuthenticationLoginException
     281: dup
     282: ldc           #82                 // String Login failed
     284: new           #31                 // class java/lang/StringBuilder
     287: dup
     288: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     291: ldc           #94                 // String Expired user cannot be set to current user. User:
     293: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     296: aload_3
     297: invokevirtual #38                 // Method org/owasp/esapi/reference/DefaultUser.getAccountName:()Ljava/lang/String;
     300: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     303: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     306: invokespecial #84                 // Method org/owasp/esapi/errors/AuthenticationLoginException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     309: athrow
     310: aload_3
     311: invokevirtual #95                 // Method org/owasp/esapi/reference/DefaultUser.isSessionTimeout:()Z
     314: ifeq          368
     317: aload_3
     318: invokevirtual #80                 // Method org/owasp/esapi/reference/DefaultUser.logout:()V
     321: aload_3
     322: invokevirtual #86                 // Method org/owasp/esapi/reference/DefaultUser.incrementFailedLoginCount:()V
     325: aload_3
     326: new           #87                 // class java/util/Date
     329: dup
     330: invokespecial #88                 // Method java/util/Date."<init>":()V
     333: invokevirtual #89                 // Method org/owasp/esapi/reference/DefaultUser.setLastFailedLoginTime:(Ljava/util/Date;)V
     336: new           #81                 // class org/owasp/esapi/errors/AuthenticationLoginException
     339: dup
     340: ldc           #82                 // String Login failed
     342: new           #31                 // class java/lang/StringBuilder
     345: dup
     346: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     349: ldc           #96                 // String Session inactivity timeout:
     351: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     354: aload_3
     355: invokevirtual #38                 // Method org/owasp/esapi/reference/DefaultUser.getAccountName:()Ljava/lang/String;
     358: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     361: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     364: invokespecial #84                 // Method org/owasp/esapi/errors/AuthenticationLoginException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     367: athrow
     368: aload_3
     369: invokevirtual #97                 // Method org/owasp/esapi/reference/DefaultUser.isSessionAbsoluteTimeout:()Z
     372: ifeq          426
     375: aload_3
     376: invokevirtual #80                 // Method org/owasp/esapi/reference/DefaultUser.logout:()V
     379: aload_3
     380: invokevirtual #86                 // Method org/owasp/esapi/reference/DefaultUser.incrementFailedLoginCount:()V
     383: aload_3
     384: new           #87                 // class java/util/Date
     387: dup
     388: invokespecial #88                 // Method java/util/Date."<init>":()V
     391: invokevirtual #89                 // Method org/owasp/esapi/reference/DefaultUser.setLastFailedLoginTime:(Ljava/util/Date;)V
     394: new           #81                 // class org/owasp/esapi/errors/AuthenticationLoginException
     397: dup
     398: ldc           #82                 // String Login failed
     400: new           #31                 // class java/lang/StringBuilder
     403: dup
     404: invokespecial #32                 // Method java/lang/StringBuilder."<init>":()V
     407: ldc           #98                 // String Session absolute timeout:
     409: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     412: aload_3
     413: invokevirtual #38                 // Method org/owasp/esapi/reference/DefaultUser.getAccountName:()Ljava/lang/String;
     416: invokevirtual #34                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     419: invokevirtual #35                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     422: invokespecial #84                 // Method org/owasp/esapi/errors/AuthenticationLoginException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     425: athrow
     426: aload_3
     427: aload_1
     428: invokeinterface #99,  1           // InterfaceMethod javax/servlet/http/HttpServletRequest.getLocale:()Ljava/util/Locale;
     433: invokevirtual #100                // Method org/owasp/esapi/reference/DefaultUser.setLocale:(Ljava/util/Locale;)V
     436: aload_1
     437: invokeinterface #101,  1          // InterfaceMethod javax/servlet/http/HttpServletRequest.getSession:()Ljavax/servlet/http/HttpSession;
     442: astore        4
     444: aload_3
     445: aload         4
     447: invokevirtual #102                // Method org/owasp/esapi/reference/DefaultUser.addSession:(Ljavax/servlet/http/HttpSession;)V
     450: aload         4
     452: ldc           #16                 // String ESAPIUserSessionKey
     454: aload_3
     455: invokeinterface #103,  3          // InterfaceMethod javax/servlet/http/HttpSession.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
     460: aload_0
     461: aload_3
     462: invokevirtual #104                // Method setCurrentUser:(Lorg/owasp/esapi/User;)V
     465: aload_3
     466: areturn
    Exception table:
       from    to  target type
          60    71    74   Class org/owasp/esapi/errors/AccessControlException

  public void logout();
    Code:
       0: aload_0
       1: invokevirtual #50                 // Method getCurrentUser:()Lorg/owasp/esapi/User;
       4: astore_1
       5: aload_1
       6: ifnull        24
       9: aload_1
      10: invokeinterface #51,  1           // InterfaceMethod org/owasp/esapi/User.isAnonymous:()Z
      15: ifne          24
      18: aload_1
      19: invokeinterface #53,  1           // InterfaceMethod org/owasp/esapi/User.logout:()V
      24: return

  public void setCurrentUser(org.owasp.esapi.User);
    Code:
       0: aload_0
       1: getfield      #7                  // Field currentUser:Lorg/owasp/esapi/reference/AbstractAuthenticator$ThreadLocalUser;
       4: aload_1
       5: invokevirtual #8                  // Method org/owasp/esapi/reference/AbstractAuthenticator$ThreadLocalUser.setUser:(Lorg/owasp/esapi/User;)V
       8: return
}
