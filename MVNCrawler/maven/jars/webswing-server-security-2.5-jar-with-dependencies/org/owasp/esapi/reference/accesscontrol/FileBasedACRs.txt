Compiled from "FileBasedACRs.java"
public class org.owasp.esapi.reference.accesscontrol.FileBasedACRs {
  private java.util.Map urlMap;

  private java.util.Map functionMap;

  private java.util.Map dataMap;

  private java.util.Map fileMap;

  private java.util.Map serviceMap;

  private org.owasp.esapi.reference.accesscontrol.FileBasedACRs$Rule deny;

  private org.owasp.esapi.Logger logger;

  public org.owasp.esapi.reference.accesscontrol.FileBasedACRs();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #2                  // class java/util/HashMap
       8: dup
       9: invokespecial #3                  // Method java/util/HashMap."<init>":()V
      12: putfield      #4                  // Field urlMap:Ljava/util/Map;
      15: aload_0
      16: new           #2                  // class java/util/HashMap
      19: dup
      20: invokespecial #3                  // Method java/util/HashMap."<init>":()V
      23: putfield      #5                  // Field functionMap:Ljava/util/Map;
      26: aload_0
      27: new           #2                  // class java/util/HashMap
      30: dup
      31: invokespecial #3                  // Method java/util/HashMap."<init>":()V
      34: putfield      #6                  // Field dataMap:Ljava/util/Map;
      37: aload_0
      38: new           #2                  // class java/util/HashMap
      41: dup
      42: invokespecial #3                  // Method java/util/HashMap."<init>":()V
      45: putfield      #7                  // Field fileMap:Ljava/util/Map;
      48: aload_0
      49: new           #2                  // class java/util/HashMap
      52: dup
      53: invokespecial #3                  // Method java/util/HashMap."<init>":()V
      56: putfield      #8                  // Field serviceMap:Ljava/util/Map;
      59: aload_0
      60: new           #9                  // class org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule
      63: dup
      64: aload_0
      65: invokespecial #10                 // Method org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule."<init>":(Lorg/owasp/esapi/reference/accesscontrol/FileBasedACRs;)V
      68: putfield      #11                 // Field deny:Lorg/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule;
      71: aload_0
      72: ldc           #12                 // String FileBasedACRs
      74: invokestatic  #13                 // Method org/owasp/esapi/ESAPI.getLogger:(Ljava/lang/String;)Lorg/owasp/esapi/Logger;
      77: putfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
      80: return

  public boolean isAuthorizedForURL(java.lang.String);
    Code:
       0: aload_0
       1: getfield      #4                  // Field urlMap:Ljava/util/Map;
       4: ifnull        19
       7: aload_0
       8: getfield      #4                  // Field urlMap:Ljava/util/Map;
      11: invokeinterface #15,  1           // InterfaceMethod java/util/Map.isEmpty:()Z
      16: ifeq          29
      19: aload_0
      20: aload_0
      21: ldc           #16                 // String URLAccessRules.txt
      23: invokespecial #17                 // Method loadRules:(Ljava/lang/String;)Ljava/util/Map;
      26: putfield      #4                  // Field urlMap:Ljava/util/Map;
      29: aload_0
      30: aload_0
      31: getfield      #4                  // Field urlMap:Ljava/util/Map;
      34: aload_1
      35: invokespecial #18                 // Method matchRule:(Ljava/util/Map;Ljava/lang/String;)Z
      38: ireturn

  public boolean isAuthorizedForFunction(java.lang.String) throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: aload_0
       1: getfield      #5                  // Field functionMap:Ljava/util/Map;
       4: ifnull        19
       7: aload_0
       8: getfield      #5                  // Field functionMap:Ljava/util/Map;
      11: invokeinterface #15,  1           // InterfaceMethod java/util/Map.isEmpty:()Z
      16: ifeq          29
      19: aload_0
      20: aload_0
      21: ldc           #19                 // String FunctionAccessRules.txt
      23: invokespecial #17                 // Method loadRules:(Ljava/lang/String;)Ljava/util/Map;
      26: putfield      #5                  // Field functionMap:Ljava/util/Map;
      29: aload_0
      30: aload_0
      31: getfield      #5                  // Field functionMap:Ljava/util/Map;
      34: aload_1
      35: invokespecial #18                 // Method matchRule:(Ljava/util/Map;Ljava/lang/String;)Z
      38: ireturn

  public boolean isAuthorizedForData(java.lang.String, java.lang.Object) throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: aload_0
       1: getfield      #6                  // Field dataMap:Ljava/util/Map;
       4: ifnull        19
       7: aload_0
       8: getfield      #6                  // Field dataMap:Ljava/util/Map;
      11: invokeinterface #15,  1           // InterfaceMethod java/util/Map.isEmpty:()Z
      16: ifeq          29
      19: aload_0
      20: aload_0
      21: ldc           #20                 // String DataAccessRules.txt
      23: invokespecial #21                 // Method loadDataRules:(Ljava/lang/String;)Ljava/util/Map;
      26: putfield      #6                  // Field dataMap:Ljava/util/Map;
      29: aload_0
      30: aload_0
      31: getfield      #6                  // Field dataMap:Ljava/util/Map;
      34: aload_2
      35: checkcast     #22                 // class java/lang/Class
      38: aload_1
      39: invokespecial #23                 // Method matchRule:(Ljava/util/Map;Ljava/lang/Class;Ljava/lang/String;)Z
      42: ireturn

  public boolean isAuthorizedForFile(java.lang.String) throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: aload_0
       1: getfield      #7                  // Field fileMap:Ljava/util/Map;
       4: ifnull        19
       7: aload_0
       8: getfield      #7                  // Field fileMap:Ljava/util/Map;
      11: invokeinterface #15,  1           // InterfaceMethod java/util/Map.isEmpty:()Z
      16: ifeq          29
      19: aload_0
      20: aload_0
      21: ldc           #24                 // String FileAccessRules.txt
      23: invokespecial #17                 // Method loadRules:(Ljava/lang/String;)Ljava/util/Map;
      26: putfield      #7                  // Field fileMap:Ljava/util/Map;
      29: aload_0
      30: aload_0
      31: getfield      #7                  // Field fileMap:Ljava/util/Map;
      34: aload_1
      35: ldc           #25                 // String \\\\
      37: ldc           #26                 // String /
      39: invokevirtual #27                 // Method java/lang/String.replaceAll:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      42: invokespecial #18                 // Method matchRule:(Ljava/util/Map;Ljava/lang/String;)Z
      45: ireturn

  public boolean isAuthorizedForService(java.lang.String) throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: aload_0
       1: getfield      #8                  // Field serviceMap:Ljava/util/Map;
       4: ifnull        19
       7: aload_0
       8: getfield      #8                  // Field serviceMap:Ljava/util/Map;
      11: invokeinterface #15,  1           // InterfaceMethod java/util/Map.isEmpty:()Z
      16: ifeq          29
      19: aload_0
      20: aload_0
      21: ldc           #28                 // String ServiceAccessRules.txt
      23: invokespecial #17                 // Method loadRules:(Ljava/lang/String;)Ljava/util/Map;
      26: putfield      #8                  // Field serviceMap:Ljava/util/Map;
      29: aload_0
      30: aload_0
      31: getfield      #8                  // Field serviceMap:Ljava/util/Map;
      34: aload_1
      35: invokespecial #18                 // Method matchRule:(Ljava/util/Map;Ljava/lang/String;)Z
      38: ireturn

  private boolean matchRule(java.util.Map, java.lang.String);
    Code:
       0: invokestatic  #29                 // Method org/owasp/esapi/ESAPI.authenticator:()Lorg/owasp/esapi/Authenticator;
       3: invokeinterface #30,  1           // InterfaceMethod org/owasp/esapi/Authenticator.getCurrentUser:()Lorg/owasp/esapi/User;
       8: astore_3
       9: aload_3
      10: invokeinterface #31,  1           // InterfaceMethod org/owasp/esapi/User.getRoles:()Ljava/util/Set;
      15: astore        4
      17: aload_0
      18: aload_1
      19: aload         4
      21: aload_2
      22: invokespecial #32                 // Method searchForRule:(Ljava/util/Map;Ljava/util/Set;Ljava/lang/String;)Lorg/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule;
      25: astore        5
      27: aload         5
      29: getfield      #33                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.allow:Z
      32: ireturn

  private boolean matchRule(java.util.Map, java.lang.Class, java.lang.String);
    Code:
       0: invokestatic  #29                 // Method org/owasp/esapi/ESAPI.authenticator:()Lorg/owasp/esapi/Authenticator;
       3: invokeinterface #30,  1           // InterfaceMethod org/owasp/esapi/Authenticator.getCurrentUser:()Lorg/owasp/esapi/User;
       8: astore        4
      10: aload         4
      12: invokeinterface #31,  1           // InterfaceMethod org/owasp/esapi/User.getRoles:()Ljava/util/Set;
      17: astore        5
      19: aload_0
      20: aload_1
      21: aload         5
      23: aload_2
      24: aload_3
      25: invokespecial #34                 // Method searchForRule:(Ljava/util/Map;Ljava/util/Set;Ljava/lang/Class;Ljava/lang/String;)Lorg/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule;
      28: astore        6
      30: aload         6
      32: ifnull        39
      35: iconst_1
      36: goto          40
      39: iconst_0
      40: ireturn

  private org.owasp.esapi.reference.accesscontrol.FileBasedACRs$Rule searchForRule(java.util.Map, java.util.Set, java.lang.String);
    Code:
       0: invokestatic  #35                 // Method org/owasp/esapi/ESAPI.encoder:()Lorg/owasp/esapi/Encoder;
       3: aload_3
       4: invokeinterface #36,  2           // InterfaceMethod org/owasp/esapi/Encoder.canonicalize:(Ljava/lang/String;)Ljava/lang/String;
       9: astore        4
      11: aload         4
      13: astore        5
      15: aload         5
      17: ifnonnull     24
      20: ldc           #37                 // String
      22: astore        5
      24: aload         5
      26: ldc           #26                 // String /
      28: invokevirtual #38                 // Method java/lang/String.endsWith:(Ljava/lang/String;)Z
      31: ifeq          52
      34: aload         5
      36: iconst_0
      37: aload         5
      39: invokevirtual #39                 // Method java/lang/String.length:()I
      42: iconst_1
      43: isub
      44: invokevirtual #40                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      47: astore        5
      49: goto          24
      52: aload         5
      54: ldc           #41                 // String ..
      56: invokevirtual #42                 // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      59: iconst_m1
      60: if_icmpeq     92
      63: new           #43                 // class org/owasp/esapi/errors/IntrusionException
      66: dup
      67: ldc           #44                 // String Attempt to manipulate access control path
      69: new           #45                 // class java/lang/StringBuilder
      72: dup
      73: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
      76: ldc           #47                 // String Attempt to manipulate access control path:
      78: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      81: aload_3
      82: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      85: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      88: invokespecial #50                 // Method org/owasp/esapi/errors/IntrusionException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      91: athrow
      92: ldc           #37                 // String
      94: astore        6
      96: aload         5
      98: ldc           #51                 // String .
     100: invokevirtual #52                 // Method java/lang/String.lastIndexOf:(Ljava/lang/String;)I
     103: istore        7
     105: iload         7
     107: iconst_m1
     108: if_icmpeq     122
     111: aload         5
     113: iload         7
     115: iconst_1
     116: iadd
     117: invokevirtual #53                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     120: astore        6
     122: aload_1
     123: aload         5
     125: invokeinterface #54,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     130: checkcast     #9                  // class org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule
     133: astore        8
     135: aload         8
     137: ifnonnull     171
     140: aload_1
     141: new           #45                 // class java/lang/StringBuilder
     144: dup
     145: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     148: aload         5
     150: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     153: ldc           #55                 // String /*
     155: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     158: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     161: invokeinterface #54,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     166: checkcast     #9                  // class org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule
     169: astore        8
     171: aload         8
     173: ifnonnull     207
     176: aload_1
     177: new           #45                 // class java/lang/StringBuilder
     180: dup
     181: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     184: ldc           #56                 // String *.
     186: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     189: aload         6
     191: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     194: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     197: invokeinterface #54,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     202: checkcast     #9                  // class org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule
     205: astore        8
     207: aload         8
     209: ifnull        228
     212: aload_0
     213: aload         8
     215: getfield      #57                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.roles:Ljava/util/Set;
     218: aload_2
     219: invokespecial #58                 // Method overlap:(Ljava/util/Set;Ljava/util/Set;)Z
     222: ifeq          228
     225: aload         8
     227: areturn
     228: aload         5
     230: bipush        47
     232: invokevirtual #59                 // Method java/lang/String.lastIndexOf:(I)I
     235: istore        9
     237: iload         9
     239: iconst_m1
     240: if_icmpne     248
     243: aload_0
     244: getfield      #11                 // Field deny:Lorg/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule;
     247: areturn
     248: aload         5
     250: iconst_0
     251: aload         5
     253: bipush        47
     255: invokevirtual #59                 // Method java/lang/String.lastIndexOf:(I)I
     258: invokevirtual #40                 // Method java/lang/String.substring:(II)Ljava/lang/String;
     261: astore        5
     263: aload         5
     265: invokevirtual #39                 // Method java/lang/String.length:()I
     268: iconst_1
     269: if_icmpgt     277
     272: aload_0
     273: getfield      #11                 // Field deny:Lorg/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule;
     276: areturn
     277: aload_0
     278: aload_1
     279: aload_2
     280: aload         5
     282: invokespecial #32                 // Method searchForRule:(Ljava/util/Map;Ljava/util/Set;Ljava/lang/String;)Lorg/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule;
     285: areturn

  private org.owasp.esapi.reference.accesscontrol.FileBasedACRs$Rule searchForRule(java.util.Map, java.util.Set, java.lang.Class, java.lang.String);
    Code:
       0: aload_1
       1: aload_3
       2: invokeinterface #54,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
       7: checkcast     #9                  // class org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule
      10: astore        5
      12: aload         5
      14: ifnull        47
      17: aload_0
      18: aload         5
      20: getfield      #60                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.actions:Ljava/util/List;
      23: aload         4
      25: invokespecial #61                 // Method overlap:(Ljava/util/List;Ljava/lang/String;)Z
      28: ifeq          47
      31: aload_0
      32: aload         5
      34: getfield      #57                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.roles:Ljava/util/Set;
      37: aload_2
      38: invokespecial #58                 // Method overlap:(Ljava/util/Set;Ljava/util/Set;)Z
      41: ifeq          47
      44: aload         5
      46: areturn
      47: aconst_null
      48: areturn

  private boolean overlap(java.util.Set, java.util.Set);
    Code:
       0: aload_1
       1: ldc           #62                 // String any
       3: invokeinterface #63,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
       8: ifeq          13
      11: iconst_1
      12: ireturn
      13: aload_2
      14: invokeinterface #64,  1           // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      19: astore_3
      20: aload_3
      21: invokeinterface #65,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      26: ifeq          56
      29: aload_3
      30: invokeinterface #66,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      35: checkcast     #67                 // class java/lang/String
      38: astore        4
      40: aload_1
      41: aload         4
      43: invokeinterface #63,  2           // InterfaceMethod java/util/Set.contains:(Ljava/lang/Object;)Z
      48: ifeq          53
      51: iconst_1
      52: ireturn
      53: goto          20
      56: iconst_0
      57: ireturn

  private boolean overlap(java.util.List, java.lang.String);
    Code:
       0: aload_1
       1: aload_2
       2: invokeinterface #68,  2           // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
       7: ifeq          12
      10: iconst_1
      11: ireturn
      12: iconst_0
      13: ireturn

  private java.util.List validateRoles(java.util.List);
    Code:
       0: new           #69                 // class java/util/ArrayList
       3: dup
       4: invokespecial #70                 // Method java/util/ArrayList."<init>":()V
       7: astore_2
       8: iconst_0
       9: istore_3
      10: iload_3
      11: aload_1
      12: invokeinterface #71,  1           // InterfaceMethod java/util/List.size:()I
      17: if_icmpge     132
      20: invokestatic  #35                 // Method org/owasp/esapi/ESAPI.encoder:()Lorg/owasp/esapi/Encoder;
      23: aload_1
      24: iload_3
      25: invokeinterface #72,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      30: checkcast     #67                 // class java/lang/String
      33: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
      36: invokeinterface #36,  2           // InterfaceMethod org/owasp/esapi/Encoder.canonicalize:(Ljava/lang/String;)Ljava/lang/String;
      41: astore        4
      43: invokestatic  #74                 // Method org/owasp/esapi/ESAPI.validator:()Lorg/owasp/esapi/Validator;
      46: ldc           #75                 // String Validating user roles in FileBasedAccessController
      48: aload         4
      50: ldc           #76                 // String RoleName
      52: bipush        20
      54: iconst_0
      55: invokeinterface #77,  6           // InterfaceMethod org/owasp/esapi/Validator.isValidInput:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IZ)Z
      60: ifne          114
      63: aload_0
      64: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
      67: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
      70: new           #45                 // class java/lang/StringBuilder
      73: dup
      74: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
      77: ldc           #79                 // String Role:
      79: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      82: aload_1
      83: iload_3
      84: invokeinterface #72,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      89: checkcast     #67                 // class java/lang/String
      92: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
      95: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      98: ldc           #80                 // String  is invalid, so was not added to the list of roles for this Rule.
     100: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     103: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     106: invokeinterface #81,  3           // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     111: goto          126
     114: aload_2
     115: aload         4
     117: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
     120: invokeinterface #82,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     125: pop
     126: iinc          3, 1
     129: goto          10
     132: aload_2
     133: areturn

  private java.util.Map loadRules(java.lang.String);
    Code:
       0: new           #45                 // class java/lang/StringBuilder
       3: dup
       4: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
       7: ldc           #83                 // String fbac-policies/
       9: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      12: aload_1
      13: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      16: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      19: astore_1
      20: new           #2                  // class java/util/HashMap
      23: dup
      24: invokespecial #3                  // Method java/util/HashMap."<init>":()V
      27: astore_2
      28: aconst_null
      29: astore_3
      30: invokestatic  #84                 // Method org/owasp/esapi/ESAPI.securityConfiguration:()Lorg/owasp/esapi/SecurityConfiguration;
      33: aload_1
      34: invokeinterface #85,  2           // InterfaceMethod org/owasp/esapi/SecurityConfiguration.getResourceStream:(Ljava/lang/String;)Ljava/io/InputStream;
      39: astore_3
      40: ldc           #37                 // String
      42: astore        4
      44: invokestatic  #74                 // Method org/owasp/esapi/ESAPI.validator:()Lorg/owasp/esapi/Validator;
      47: aload_3
      48: sipush        500
      51: invokeinterface #86,  3           // InterfaceMethod org/owasp/esapi/Validator.safeReadLine:(Ljava/io/InputStream;I)Ljava/lang/String;
      56: dup
      57: astore        4
      59: ifnull        277
      62: aload         4
      64: invokevirtual #39                 // Method java/lang/String.length:()I
      67: ifle          44
      70: aload         4
      72: iconst_0
      73: invokevirtual #87                 // Method java/lang/String.charAt:(I)C
      76: bipush        35
      78: if_icmpeq     44
      81: new           #9                  // class org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule
      84: dup
      85: aload_0
      86: invokespecial #10                 // Method org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule."<init>":(Lorg/owasp/esapi/reference/accesscontrol/FileBasedACRs;)V
      89: astore        5
      91: aload         4
      93: ldc           #88                 // String \\|
      95: invokevirtual #89                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
      98: astore        6
     100: aload         5
     102: aload         6
     104: iconst_0
     105: aaload
     106: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
     109: ldc           #25                 // String \\\\
     111: ldc           #26                 // String /
     113: invokevirtual #27                 // Method java/lang/String.replaceAll:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     116: putfield      #90                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.path:Ljava/lang/String;
     119: aload_0
     120: aload         6
     122: iconst_1
     123: aaload
     124: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
     127: invokevirtual #91                 // Method java/lang/String.toLowerCase:()Ljava/lang/String;
     130: invokespecial #92                 // Method commaSplit:(Ljava/lang/String;)Ljava/util/List;
     133: astore        7
     135: aload_0
     136: aload         7
     138: invokespecial #93                 // Method validateRoles:(Ljava/util/List;)Ljava/util/List;
     141: astore        7
     143: iconst_0
     144: istore        8
     146: iload         8
     148: aload         7
     150: invokeinterface #71,  1           // InterfaceMethod java/util/List.size:()I
     155: if_icmpge     190
     158: aload         5
     160: getfield      #57                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.roles:Ljava/util/Set;
     163: aload         7
     165: iload         8
     167: invokeinterface #72,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     172: checkcast     #67                 // class java/lang/String
     175: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
     178: invokeinterface #94,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     183: pop
     184: iinc          8, 1
     187: goto          146
     190: aload         6
     192: iconst_2
     193: aaload
     194: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
     197: astore        8
     199: aload         5
     201: aload         8
     203: ldc           #95                 // String allow
     205: invokevirtual #96                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     208: putfield      #33                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.allow:Z
     211: aload_2
     212: aload         5
     214: getfield      #90                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.path:Ljava/lang/String;
     217: invokeinterface #97,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     222: ifeq          260
     225: aload_0
     226: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
     229: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     232: new           #45                 // class java/lang/StringBuilder
     235: dup
     236: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     239: ldc           #98                 // String Problem in access control file. Duplicate rule ignored:
     241: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     244: aload         5
     246: invokevirtual #99                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     249: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     252: invokeinterface #81,  3           // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     257: goto          274
     260: aload_2
     261: aload         5
     263: getfield      #90                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.path:Ljava/lang/String;
     266: aload         5
     268: invokeinterface #100,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     273: pop
     274: goto          44
     277: aload_3
     278: ifnull        285
     281: aload_3
     282: invokevirtual #101                // Method java/io/InputStream.close:()V
     285: goto          461
     288: astore        4
     290: aload_0
     291: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
     294: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     297: new           #45                 // class java/lang/StringBuilder
     300: dup
     301: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     304: ldc           #103                // String Failure closing access control file:
     306: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     309: aload_1
     310: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     313: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     316: aload         4
     318: invokeinterface #104,  4          // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     323: goto          461
     326: astore        4
     328: aload_0
     329: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
     332: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     335: new           #45                 // class java/lang/StringBuilder
     338: dup
     339: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     342: ldc           #106                // String Problem in access control file:
     344: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     347: aload_1
     348: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     351: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     354: aload         4
     356: invokeinterface #104,  4          // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     361: aload_3
     362: ifnull        369
     365: aload_3
     366: invokevirtual #101                // Method java/io/InputStream.close:()V
     369: goto          461
     372: astore        4
     374: aload_0
     375: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
     378: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     381: new           #45                 // class java/lang/StringBuilder
     384: dup
     385: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     388: ldc           #103                // String Failure closing access control file:
     390: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     393: aload_1
     394: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     397: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     400: aload         4
     402: invokeinterface #104,  4          // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     407: goto          461
     410: astore        9
     412: aload_3
     413: ifnull        420
     416: aload_3
     417: invokevirtual #101                // Method java/io/InputStream.close:()V
     420: goto          458
     423: astore        10
     425: aload_0
     426: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
     429: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     432: new           #45                 // class java/lang/StringBuilder
     435: dup
     436: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     439: ldc           #103                // String Failure closing access control file:
     441: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     444: aload_1
     445: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     448: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     451: aload         10
     453: invokeinterface #104,  4          // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     458: aload         9
     460: athrow
     461: aload_2
     462: areturn
    Exception table:
       from    to  target type
         277   285   288   Class java/io/IOException
          30   277   326   Class java/lang/Exception
         361   369   372   Class java/io/IOException
          30   277   410   any
         326   361   410   any
         412   420   423   Class java/io/IOException
         410   412   410   any

  private java.util.Map loadDataRules(java.lang.String);
    Code:
       0: new           #2                  // class java/util/HashMap
       3: dup
       4: invokespecial #3                  // Method java/util/HashMap."<init>":()V
       7: astore_2
       8: aconst_null
       9: astore_3
      10: new           #45                 // class java/lang/StringBuilder
      13: dup
      14: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
      17: ldc           #83                 // String fbac-policies/
      19: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      22: aload_1
      23: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      26: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      29: astore_1
      30: invokestatic  #84                 // Method org/owasp/esapi/ESAPI.securityConfiguration:()Lorg/owasp/esapi/SecurityConfiguration;
      33: aload_1
      34: invokeinterface #85,  2           // InterfaceMethod org/owasp/esapi/SecurityConfiguration.getResourceStream:(Ljava/lang/String;)Ljava/io/InputStream;
      39: astore_3
      40: ldc           #37                 // String
      42: astore        4
      44: invokestatic  #74                 // Method org/owasp/esapi/ESAPI.validator:()Lorg/owasp/esapi/Validator;
      47: aload_3
      48: sipush        500
      51: invokeinterface #86,  3           // InterfaceMethod org/owasp/esapi/Validator.safeReadLine:(Ljava/io/InputStream;I)Ljava/lang/String;
      56: dup
      57: astore        4
      59: ifnull        315
      62: aload         4
      64: invokevirtual #39                 // Method java/lang/String.length:()I
      67: ifle          44
      70: aload         4
      72: iconst_0
      73: invokevirtual #87                 // Method java/lang/String.charAt:(I)C
      76: bipush        35
      78: if_icmpeq     44
      81: new           #9                  // class org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule
      84: dup
      85: aload_0
      86: invokespecial #10                 // Method org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule."<init>":(Lorg/owasp/esapi/reference/accesscontrol/FileBasedACRs;)V
      89: astore        5
      91: aload         4
      93: ldc           #88                 // String \\|
      95: invokevirtual #89                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
      98: astore        6
     100: aload         5
     102: aload         6
     104: iconst_0
     105: aaload
     106: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
     109: invokestatic  #107                // Method java/lang/Class.forName:(Ljava/lang/String;)Ljava/lang/Class;
     112: putfield      #108                // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.clazz:Ljava/lang/Class;
     115: aload_0
     116: aload         6
     118: iconst_1
     119: aaload
     120: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
     123: invokevirtual #91                 // Method java/lang/String.toLowerCase:()Ljava/lang/String;
     126: invokespecial #92                 // Method commaSplit:(Ljava/lang/String;)Ljava/util/List;
     129: astore        7
     131: aload_0
     132: aload         7
     134: invokespecial #93                 // Method validateRoles:(Ljava/util/List;)Ljava/util/List;
     137: astore        7
     139: iconst_0
     140: istore        8
     142: iload         8
     144: aload         7
     146: invokeinterface #71,  1           // InterfaceMethod java/util/List.size:()I
     151: if_icmpge     186
     154: aload         5
     156: getfield      #57                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.roles:Ljava/util/Set;
     159: aload         7
     161: iload         8
     163: invokeinterface #72,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     168: checkcast     #67                 // class java/lang/String
     171: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
     174: invokeinterface #94,  2           // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     179: pop
     180: iinc          8, 1
     183: goto          142
     186: aload_0
     187: aload         6
     189: iconst_2
     190: aaload
     191: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
     194: invokevirtual #91                 // Method java/lang/String.toLowerCase:()Ljava/lang/String;
     197: invokespecial #92                 // Method commaSplit:(Ljava/lang/String;)Ljava/util/List;
     200: astore        8
     202: iconst_0
     203: istore        9
     205: iload         9
     207: aload         8
     209: invokeinterface #71,  1           // InterfaceMethod java/util/List.size:()I
     214: if_icmpge     249
     217: aload         5
     219: getfield      #60                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.actions:Ljava/util/List;
     222: aload         8
     224: iload         9
     226: invokeinterface #72,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
     231: checkcast     #67                 // class java/lang/String
     234: invokevirtual #73                 // Method java/lang/String.trim:()Ljava/lang/String;
     237: invokeinterface #82,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     242: pop
     243: iinc          9, 1
     246: goto          205
     249: aload_2
     250: aload         5
     252: getfield      #90                 // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.path:Ljava/lang/String;
     255: invokeinterface #97,  2           // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
     260: ifeq          298
     263: aload_0
     264: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
     267: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     270: new           #45                 // class java/lang/StringBuilder
     273: dup
     274: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     277: ldc           #98                 // String Problem in access control file. Duplicate rule ignored:
     279: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     282: aload         5
     284: invokevirtual #99                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     287: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     290: invokeinterface #81,  3           // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     295: goto          312
     298: aload_2
     299: aload         5
     301: getfield      #108                // Field org/owasp/esapi/reference/accesscontrol/FileBasedACRs$Rule.clazz:Ljava/lang/Class;
     304: aload         5
     306: invokeinterface #100,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     311: pop
     312: goto          44
     315: aload_3
     316: ifnull        323
     319: aload_3
     320: invokevirtual #101                // Method java/io/InputStream.close:()V
     323: goto          499
     326: astore        4
     328: aload_0
     329: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
     332: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     335: new           #45                 // class java/lang/StringBuilder
     338: dup
     339: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     342: ldc           #109                // String Failure closing access control file :
     344: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     347: aload_1
     348: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     351: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     354: aload         4
     356: invokeinterface #104,  4          // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     361: goto          499
     364: astore        4
     366: aload_0
     367: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
     370: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     373: new           #45                 // class java/lang/StringBuilder
     376: dup
     377: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     380: ldc           #110                // String Problem in access control file :
     382: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     385: aload_1
     386: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     389: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     392: aload         4
     394: invokeinterface #104,  4          // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     399: aload_3
     400: ifnull        407
     403: aload_3
     404: invokevirtual #101                // Method java/io/InputStream.close:()V
     407: goto          499
     410: astore        4
     412: aload_0
     413: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
     416: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     419: new           #45                 // class java/lang/StringBuilder
     422: dup
     423: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     426: ldc           #109                // String Failure closing access control file :
     428: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     431: aload_1
     432: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     435: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     438: aload         4
     440: invokeinterface #104,  4          // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     445: goto          499
     448: astore        10
     450: aload_3
     451: ifnull        458
     454: aload_3
     455: invokevirtual #101                // Method java/io/InputStream.close:()V
     458: goto          496
     461: astore        11
     463: aload_0
     464: getfield      #14                 // Field logger:Lorg/owasp/esapi/Logger;
     467: getstatic     #78                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     470: new           #45                 // class java/lang/StringBuilder
     473: dup
     474: invokespecial #46                 // Method java/lang/StringBuilder."<init>":()V
     477: ldc           #109                // String Failure closing access control file :
     479: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     482: aload_1
     483: invokevirtual #48                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     486: invokevirtual #49                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     489: aload         11
     491: invokeinterface #104,  4          // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     496: aload         10
     498: athrow
     499: aload_2
     500: areturn
    Exception table:
       from    to  target type
         315   323   326   Class java/io/IOException
          10   315   364   Class java/lang/Exception
         399   407   410   Class java/io/IOException
          10   315   448   any
         364   399   448   any
         450   458   461   Class java/io/IOException
         448   450   448   any

  private java.util.List commaSplit(java.lang.String);
    Code:
       0: aload_1
       1: ldc           #111                // String ,
       3: invokevirtual #89                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
       6: astore_2
       7: aload_2
       8: invokestatic  #112                // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
      11: areturn
}
