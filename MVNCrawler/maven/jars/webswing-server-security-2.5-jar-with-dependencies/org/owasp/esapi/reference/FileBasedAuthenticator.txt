Compiled from "FileBasedAuthenticator.java"
public class org.owasp.esapi.reference.FileBasedAuthenticator extends org.owasp.esapi.reference.AbstractAuthenticator {
  private static volatile org.owasp.esapi.Authenticator singletonInstance;

  private final org.owasp.esapi.Logger logger;

  private java.io.File userDB;

  private long checkInterval;

  private long lastModified;

  private long lastChecked;

  private static final int MAX_ACCOUNT_NAME_LENGTH;

  private java.util.Map<java.lang.Long, org.owasp.esapi.User> userMap;

  private java.util.Map<org.owasp.esapi.User, java.util.List<java.lang.String>> passwordMap;

  public static org.owasp.esapi.Authenticator getInstance();
    Code:
       0: getstatic     #1                  // Field singletonInstance:Lorg/owasp/esapi/Authenticator;
       3: ifnonnull     38
       6: ldc_w         #2                  // class org/owasp/esapi/reference/FileBasedAuthenticator
       9: dup
      10: astore_0
      11: monitorenter
      12: getstatic     #1                  // Field singletonInstance:Lorg/owasp/esapi/Authenticator;
      15: ifnonnull     28
      18: new           #2                  // class org/owasp/esapi/reference/FileBasedAuthenticator
      21: dup
      22: invokespecial #3                  // Method "<init>":()V
      25: putstatic     #1                  // Field singletonInstance:Lorg/owasp/esapi/Authenticator;
      28: aload_0
      29: monitorexit
      30: goto          38
      33: astore_1
      34: aload_0
      35: monitorexit
      36: aload_1
      37: athrow
      38: getstatic     #1                  // Field singletonInstance:Lorg/owasp/esapi/Authenticator;
      41: areturn
    Exception table:
       from    to  target type
          12    30    33   any
          33    36    33   any

  public static void main(java.lang.String[]) throws java.lang.Exception;
    Code:
       0: aload_0
       1: arraylength
       2: iconst_3
       3: if_icmpeq     15
       6: getstatic     #4                  // Field java/lang/System.out:Ljava/io/PrintStream;
       9: ldc           #5                  // String Usage: Authenticator accountname password role
      11: invokevirtual #6                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
      14: return
      15: new           #2                  // class org/owasp/esapi/reference/FileBasedAuthenticator
      18: dup
      19: invokespecial #3                  // Method "<init>":()V
      22: astore_1
      23: aload_0
      24: iconst_0
      25: aaload
      26: invokevirtual #7                  // Method java/lang/String.toLowerCase:()Ljava/lang/String;
      29: astore_2
      30: aload_0
      31: iconst_1
      32: aaload
      33: astore_3
      34: aload_0
      35: iconst_2
      36: aaload
      37: astore        4
      39: aload_1
      40: aload_0
      41: iconst_0
      42: aaload
      43: invokevirtual #8                  // Method getUser:(Ljava/lang/String;)Lorg/owasp/esapi/User;
      46: checkcast     #9                  // class org/owasp/esapi/reference/DefaultUser
      49: astore        5
      51: aload         5
      53: ifnonnull     185
      56: new           #9                  // class org/owasp/esapi/reference/DefaultUser
      59: dup
      60: aload_2
      61: invokespecial #10                 // Method org/owasp/esapi/reference/DefaultUser."<init>":(Ljava/lang/String;)V
      64: astore        5
      66: aload_1
      67: aload_3
      68: aload_2
      69: invokevirtual #11                 // Method hashPassword:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      72: astore        6
      74: aload_1
      75: aload         5
      77: aload         6
      79: invokespecial #12                 // Method setHashedPassword:(Lorg/owasp/esapi/User;Ljava/lang/String;)V
      82: aload         5
      84: aload         4
      86: invokevirtual #13                 // Method org/owasp/esapi/reference/DefaultUser.addRole:(Ljava/lang/String;)V
      89: aload         5
      91: invokevirtual #14                 // Method org/owasp/esapi/reference/DefaultUser.enable:()V
      94: aload         5
      96: invokevirtual #15                 // Method org/owasp/esapi/reference/DefaultUser.unlock:()V
      99: aload_1
     100: getfield      #16                 // Field userMap:Ljava/util/Map;
     103: aload         5
     105: invokevirtual #17                 // Method org/owasp/esapi/reference/DefaultUser.getAccountId:()J
     108: invokestatic  #18                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     111: aload         5
     113: invokeinterface #19,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     118: pop
     119: getstatic     #4                  // Field java/lang/System.out:Ljava/io/PrintStream;
     122: new           #20                 // class java/lang/StringBuilder
     125: dup
     126: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     129: ldc           #22                 // String New user created:
     131: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     134: aload_2
     135: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     138: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     141: invokevirtual #6                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
     144: aload_1
     145: invokevirtual #25                 // Method saveUsers:()V
     148: getstatic     #4                  // Field java/lang/System.out:Ljava/io/PrintStream;
     151: new           #20                 // class java/lang/StringBuilder
     154: dup
     155: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     158: ldc           #26                 // String User account
     160: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     163: aload         5
     165: invokevirtual #27                 // Method org/owasp/esapi/reference/DefaultUser.getAccountName:()Ljava/lang/String;
     168: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     171: ldc           #28                 // String  updated
     173: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     176: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     179: invokevirtual #6                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
     182: goto          219
     185: getstatic     #29                 // Field java/lang/System.err:Ljava/io/PrintStream;
     188: new           #20                 // class java/lang/StringBuilder
     191: dup
     192: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     195: ldc           #26                 // String User account
     197: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     200: aload         5
     202: invokevirtual #27                 // Method org/owasp/esapi/reference/DefaultUser.getAccountName:()Ljava/lang/String;
     205: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     208: ldc           #30                 // String  already exists!
     210: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     213: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     216: invokevirtual #6                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
     219: return

  private void setHashedPassword(org.owasp.esapi.User, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: iconst_1
       3: invokevirtual #31                 // Method getAllHashedPasswords:(Lorg/owasp/esapi/User;Z)Ljava/util/List;
       6: astore_3
       7: aload_3
       8: iconst_0
       9: aload_2
      10: invokeinterface #32,  3           // InterfaceMethod java/util/List.add:(ILjava/lang/Object;)V
      15: aload_3
      16: invokeinterface #33,  1           // InterfaceMethod java/util/List.size:()I
      21: invokestatic  #34                 // Method org/owasp/esapi/ESAPI.securityConfiguration:()Lorg/owasp/esapi/SecurityConfiguration;
      24: invokeinterface #35,  1           // InterfaceMethod org/owasp/esapi/SecurityConfiguration.getMaxOldPasswordHashes:()I
      29: if_icmple     47
      32: aload_3
      33: aload_3
      34: invokeinterface #33,  1           // InterfaceMethod java/util/List.size:()I
      39: iconst_1
      40: isub
      41: invokeinterface #36,  2           // InterfaceMethod java/util/List.remove:(I)Ljava/lang/Object;
      46: pop
      47: aload_0
      48: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
      51: getstatic     #38                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      54: new           #20                 // class java/lang/StringBuilder
      57: dup
      58: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      61: ldc           #39                 // String New hashed password stored for
      63: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      66: aload_1
      67: invokeinterface #40,  1           // InterfaceMethod org/owasp/esapi/User.getAccountName:()Ljava/lang/String;
      72: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      75: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      78: invokeinterface #41,  3           // InterfaceMethod org/owasp/esapi/Logger.info:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      83: return

  java.lang.String getHashedPassword(org.owasp.esapi.User);
    Code:
       0: aload_0
       1: aload_1
       2: iconst_0
       3: invokevirtual #31                 // Method getAllHashedPasswords:(Lorg/owasp/esapi/User;Z)Ljava/util/List;
       6: astore_2
       7: aload_2
       8: iconst_0
       9: invokeinterface #42,  2           // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
      14: checkcast     #43                 // class java/lang/String
      17: areturn

  void setOldPasswordHashes(org.owasp.esapi.User, java.util.List<java.lang.String>);
    Code:
       0: aload_0
       1: aload_1
       2: iconst_1
       3: invokevirtual #31                 // Method getAllHashedPasswords:(Lorg/owasp/esapi/User;Z)Ljava/util/List;
       6: astore_3
       7: aload_3
       8: invokeinterface #33,  1           // InterfaceMethod java/util/List.size:()I
      13: iconst_1
      14: if_icmple     39
      17: aload_3
      18: aload_3
      19: iconst_1
      20: aload_3
      21: invokeinterface #33,  1           // InterfaceMethod java/util/List.size:()I
      26: iconst_1
      27: isub
      28: invokeinterface #44,  3           // InterfaceMethod java/util/List.subList:(II)Ljava/util/List;
      33: invokeinterface #45,  2           // InterfaceMethod java/util/List.removeAll:(Ljava/util/Collection;)Z
      38: pop
      39: aload_3
      40: aload_2
      41: invokeinterface #46,  2           // InterfaceMethod java/util/List.addAll:(Ljava/util/Collection;)Z
      46: pop
      47: return

  java.util.List<java.lang.String> getAllHashedPasswords(org.owasp.esapi.User, boolean);
    Code:
       0: aload_0
       1: getfield      #47                 // Field passwordMap:Ljava/util/Map;
       4: aload_1
       5: invokeinterface #48,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      10: checkcast     #49                 // class java/util/List
      13: astore_3
      14: aload_3
      15: ifnull        20
      18: aload_3
      19: areturn
      20: iload_2
      21: ifeq          46
      24: new           #50                 // class java/util/ArrayList
      27: dup
      28: invokespecial #51                 // Method java/util/ArrayList."<init>":()V
      31: astore_3
      32: aload_0
      33: getfield      #47                 // Field passwordMap:Ljava/util/Map;
      36: aload_1
      37: aload_3
      38: invokeinterface #19,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      43: pop
      44: aload_3
      45: areturn
      46: new           #52                 // class java/lang/RuntimeException
      49: dup
      50: new           #20                 // class java/lang/StringBuilder
      53: dup
      54: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      57: ldc           #53                 // String No hashes found for
      59: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      62: aload_1
      63: invokeinterface #40,  1           // InterfaceMethod org/owasp/esapi/User.getAccountName:()Ljava/lang/String;
      68: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      71: ldc           #54                 // String . Is User.hashcode() and equals() implemented correctly?
      73: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      76: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      79: invokespecial #55                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
      82: athrow

  java.util.List<java.lang.String> getOldPasswordHashes(org.owasp.esapi.User);
    Code:
       0: aload_0
       1: aload_1
       2: iconst_0
       3: invokevirtual #31                 // Method getAllHashedPasswords:(Lorg/owasp/esapi/User;Z)Ljava/util/List;
       6: astore_2
       7: aload_2
       8: invokeinterface #33,  1           // InterfaceMethod java/util/List.size:()I
      13: iconst_1
      14: if_icmple     36
      17: aload_2
      18: iconst_1
      19: aload_2
      20: invokeinterface #33,  1           // InterfaceMethod java/util/List.size:()I
      25: iconst_1
      26: isub
      27: invokeinterface #44,  3           // InterfaceMethod java/util/List.subList:(II)Ljava/util/List;
      32: invokestatic  #56                 // Method java/util/Collections.unmodifiableList:(Ljava/util/List;)Ljava/util/List;
      35: areturn
      36: invokestatic  #57                 // Method java/util/Collections.emptyList:()Ljava/util/List;
      39: areturn

  private org.owasp.esapi.reference.FileBasedAuthenticator();
    Code:
       0: aload_0
       1: invokespecial #58                 // Method org/owasp/esapi/reference/AbstractAuthenticator."<init>":()V
       4: aload_0
       5: ldc           #59                 // String Authenticator
       7: invokestatic  #60                 // Method org/owasp/esapi/ESAPI.getLogger:(Ljava/lang/String;)Lorg/owasp/esapi/Logger;
      10: putfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
      13: aload_0
      14: aconst_null
      15: putfield      #61                 // Field userDB:Ljava/io/File;
      18: aload_0
      19: ldc2_w        #62                 // long 60000l
      22: putfield      #64                 // Field checkInterval:J
      25: aload_0
      26: lconst_0
      27: putfield      #65                 // Field lastModified:J
      30: aload_0
      31: lconst_0
      32: putfield      #66                 // Field lastChecked:J
      35: aload_0
      36: new           #67                 // class java/util/HashMap
      39: dup
      40: invokespecial #68                 // Method java/util/HashMap."<init>":()V
      43: putfield      #16                 // Field userMap:Ljava/util/Map;
      46: aload_0
      47: new           #69                 // class java/util/Hashtable
      50: dup
      51: invokespecial #70                 // Method java/util/Hashtable."<init>":()V
      54: putfield      #47                 // Field passwordMap:Ljava/util/Map;
      57: return

  public synchronized org.owasp.esapi.User createUser(java.lang.String, java.lang.String, java.lang.String) throws org.owasp.esapi.errors.AuthenticationException;
    Code:
       0: aload_0
       1: invokevirtual #71                 // Method loadUsersIfNecessary:()V
       4: aload_1
       5: ifnonnull     20
       8: new           #72                 // class org/owasp/esapi/errors/AuthenticationAccountsException
      11: dup
      12: ldc           #73                 // String Account creation failed
      14: ldc           #74                 // String Attempt to create user with null accountName
      16: invokespecial #75                 // Method org/owasp/esapi/errors/AuthenticationAccountsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      19: athrow
      20: aload_0
      21: aload_1
      22: invokevirtual #8                  // Method getUser:(Ljava/lang/String;)Lorg/owasp/esapi/User;
      25: ifnull        57
      28: new           #72                 // class org/owasp/esapi/errors/AuthenticationAccountsException
      31: dup
      32: ldc           #73                 // String Account creation failed
      34: new           #20                 // class java/lang/StringBuilder
      37: dup
      38: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      41: ldc           #76                 // String Duplicate user creation denied for
      43: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      46: aload_1
      47: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      50: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      53: invokespecial #75                 // Method org/owasp/esapi/errors/AuthenticationAccountsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      56: athrow
      57: aload_0
      58: aload_1
      59: invokevirtual #77                 // Method verifyAccountNameStrength:(Ljava/lang/String;)V
      62: aload_2
      63: ifnonnull     100
      66: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
      69: dup
      70: ldc           #79                 // String Invalid account name
      72: new           #20                 // class java/lang/StringBuilder
      75: dup
      76: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      79: ldc           #80                 // String Attempt to create account
      81: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      84: aload_1
      85: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      88: ldc           #81                 // String  with a null password
      90: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      93: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      96: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      99: athrow
     100: new           #9                  // class org/owasp/esapi/reference/DefaultUser
     103: dup
     104: aload_1
     105: invokespecial #10                 // Method org/owasp/esapi/reference/DefaultUser."<init>":(Ljava/lang/String;)V
     108: astore        4
     110: aload_0
     111: aconst_null
     112: aload_2
     113: aload         4
     115: invokevirtual #83                 // Method verifyPasswordStrength:(Ljava/lang/String;Ljava/lang/String;Lorg/owasp/esapi/User;)V
     118: aload_2
     119: aload_3
     120: invokevirtual #84                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     123: ifne          160
     126: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
     129: dup
     130: ldc           #85                 // String Passwords do not match
     132: new           #20                 // class java/lang/StringBuilder
     135: dup
     136: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     139: ldc           #86                 // String Passwords for
     141: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     144: aload_1
     145: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     148: ldc           #87                 // String  do not match
     150: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     153: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     156: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     159: athrow
     160: aload_0
     161: aload         4
     163: aload_0
     164: aload_2
     165: aload_1
     166: invokevirtual #11                 // Method hashPassword:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     169: invokespecial #12                 // Method setHashedPassword:(Lorg/owasp/esapi/User;Ljava/lang/String;)V
     172: goto          208
     175: astore        5
     177: new           #89                 // class org/owasp/esapi/errors/AuthenticationException
     180: dup
     181: ldc           #90                 // String Internal error
     183: new           #20                 // class java/lang/StringBuilder
     186: dup
     187: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     190: ldc           #91                 // String Error hashing password for
     192: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     195: aload_1
     196: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     199: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     202: aload         5
     204: invokespecial #92                 // Method org/owasp/esapi/errors/AuthenticationException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
     207: athrow
     208: aload_0
     209: getfield      #16                 // Field userMap:Ljava/util/Map;
     212: aload         4
     214: invokevirtual #17                 // Method org/owasp/esapi/reference/DefaultUser.getAccountId:()J
     217: invokestatic  #18                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     220: aload         4
     222: invokeinterface #19,  3           // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     227: pop
     228: aload_0
     229: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
     232: getstatic     #38                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     235: new           #20                 // class java/lang/StringBuilder
     238: dup
     239: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     242: ldc           #22                 // String New user created:
     244: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     247: aload_1
     248: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     251: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     254: invokeinterface #41,  3           // InterfaceMethod org/owasp/esapi/Logger.info:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     259: aload_0
     260: invokevirtual #25                 // Method saveUsers:()V
     263: aload         4
     265: areturn
    Exception table:
       from    to  target type
         160   172   175   Class org/owasp/esapi/errors/EncryptionException

  public java.lang.String generateStrongPassword();
    Code:
       0: aload_0
       1: ldc           #93                 // String
       3: invokespecial #94                 // Method generateStrongPassword:(Ljava/lang/String;)Ljava/lang/String;
       6: areturn

  private java.lang.String generateStrongPassword(java.lang.String);
    Code:
       0: invokestatic  #95                 // Method org/owasp/esapi/ESAPI.randomizer:()Lorg/owasp/esapi/Randomizer;
       3: astore_2
       4: aload_2
       5: iconst_4
       6: bipush        6
       8: invokeinterface #96,  3           // InterfaceMethod org/owasp/esapi/Randomizer.getRandomInteger:(II)I
      13: istore_3
      14: bipush        7
      16: iload_3
      17: isub
      18: istore        4
      20: aload_2
      21: iload_3
      22: getstatic     #97                 // Field org/owasp/esapi/EncoderConstants.CHAR_PASSWORD_LETTERS:[C
      25: invokeinterface #98,  3           // InterfaceMethod org/owasp/esapi/Randomizer.getRandomString:(I[C)Ljava/lang/String;
      30: astore        5
      32: aload_2
      33: iload         4
      35: getstatic     #99                 // Field org/owasp/esapi/EncoderConstants.CHAR_PASSWORD_DIGITS:[C
      38: invokeinterface #98,  3           // InterfaceMethod org/owasp/esapi/Randomizer.getRandomString:(I[C)Ljava/lang/String;
      43: astore        6
      45: aload_2
      46: iconst_1
      47: getstatic     #100                // Field org/owasp/esapi/EncoderConstants.CHAR_PASSWORD_SPECIALS:[C
      50: invokeinterface #98,  3           // InterfaceMethod org/owasp/esapi/Randomizer.getRandomString:(I[C)Ljava/lang/String;
      55: astore        7
      57: new           #20                 // class java/lang/StringBuilder
      60: dup
      61: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      64: aload         5
      66: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      69: aload         7
      71: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      74: aload         6
      76: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      79: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      82: astore        8
      84: aload_1
      85: aload         8
      87: invokestatic  #101                // Method org/owasp/esapi/StringUtilities.getLevenshteinDistance:(Ljava/lang/String;Ljava/lang/String;)I
      90: iconst_5
      91: if_icmple     97
      94: aload         8
      96: areturn
      97: aload_0
      98: aload_1
      99: invokespecial #94                 // Method generateStrongPassword:(Ljava/lang/String;)Ljava/lang/String;
     102: areturn

  public void changePassword(org.owasp.esapi.User, java.lang.String, java.lang.String, java.lang.String) throws org.owasp.esapi.errors.AuthenticationException;
    Code:
       0: aload_1
       1: invokeinterface #40,  1           // InterfaceMethod org/owasp/esapi/User.getAccountName:()Ljava/lang/String;
       6: astore        5
       8: aload_0
       9: aload_1
      10: invokevirtual #102                // Method getHashedPassword:(Lorg/owasp/esapi/User;)Ljava/lang/String;
      13: astore        6
      15: aload_0
      16: aload_2
      17: aload         5
      19: invokevirtual #11                 // Method hashPassword:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      22: astore        7
      24: aload         6
      26: aload         7
      28: invokevirtual #84                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      31: ifne          64
      34: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
      37: dup
      38: ldc           #103                // String Password change failed
      40: new           #20                 // class java/lang/StringBuilder
      43: dup
      44: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      47: ldc           #104                // String Authentication failed for password change on user:
      49: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      52: aload         5
      54: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      57: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      60: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      63: athrow
      64: aload_3
      65: ifnull        82
      68: aload         4
      70: ifnull        82
      73: aload_3
      74: aload         4
      76: invokevirtual #84                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      79: ifne          112
      82: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
      85: dup
      86: ldc           #103                // String Password change failed
      88: new           #20                 // class java/lang/StringBuilder
      91: dup
      92: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      95: ldc           #105                // String Passwords do not match for password change on user:
      97: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     100: aload         5
     102: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     105: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     108: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     111: athrow
     112: aload_0
     113: aload_2
     114: aload_3
     115: aload_1
     116: invokevirtual #83                 // Method verifyPasswordStrength:(Ljava/lang/String;Ljava/lang/String;Lorg/owasp/esapi/User;)V
     119: aload_1
     120: new           #106                // class java/util/Date
     123: dup
     124: invokespecial #107                // Method java/util/Date."<init>":()V
     127: invokeinterface #108,  2          // InterfaceMethod org/owasp/esapi/User.setLastPasswordChangeTime:(Ljava/util/Date;)V
     132: aload_0
     133: aload_3
     134: aload         5
     136: invokevirtual #11                 // Method hashPassword:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     139: astore        8
     141: aload_0
     142: aload_1
     143: invokevirtual #109                // Method getOldPasswordHashes:(Lorg/owasp/esapi/User;)Ljava/util/List;
     146: aload         8
     148: invokeinterface #110,  2          // InterfaceMethod java/util/List.contains:(Ljava/lang/Object;)Z
     153: ifeq          186
     156: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
     159: dup
     160: ldc           #103                // String Password change failed
     162: new           #20                 // class java/lang/StringBuilder
     165: dup
     166: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     169: ldc           #111                // String Password change matches a recent password for user:
     171: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     174: aload         5
     176: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     179: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     182: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     185: athrow
     186: aload_0
     187: aload_1
     188: aload         8
     190: invokespecial #12                 // Method setHashedPassword:(Lorg/owasp/esapi/User;Ljava/lang/String;)V
     193: aload_0
     194: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
     197: getstatic     #38                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     200: new           #20                 // class java/lang/StringBuilder
     203: dup
     204: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     207: ldc           #112                // String Password changed for user:
     209: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     212: aload         5
     214: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     217: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     220: invokeinterface #41,  3           // InterfaceMethod org/owasp/esapi/Logger.info:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     225: aload_0
     226: invokevirtual #25                 // Method saveUsers:()V
     229: goto          266
     232: astore        6
     234: new           #89                 // class org/owasp/esapi/errors/AuthenticationException
     237: dup
     238: ldc           #103                // String Password change failed
     240: new           #20                 // class java/lang/StringBuilder
     243: dup
     244: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     247: ldc           #113                // String Encryption exception changing password for
     249: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     252: aload         5
     254: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     257: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     260: aload         6
     262: invokespecial #92                 // Method org/owasp/esapi/errors/AuthenticationException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
     265: athrow
     266: return
    Exception table:
       from    to  target type
           8   229   232   Class org/owasp/esapi/errors/EncryptionException

  public boolean verifyPassword(org.owasp.esapi.User, java.lang.String);
    Code:
       0: aload_1
       1: invokeinterface #40,  1           // InterfaceMethod org/owasp/esapi/User.getAccountName:()Ljava/lang/String;
       6: astore_3
       7: aload_0
       8: aload_2
       9: aload_3
      10: invokevirtual #11                 // Method hashPassword:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      13: astore        4
      15: aload_0
      16: aload_1
      17: invokevirtual #102                // Method getHashedPassword:(Lorg/owasp/esapi/User;)Ljava/lang/String;
      20: astore        5
      22: aload         4
      24: aload         5
      26: invokevirtual #84                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      29: ifeq          86
      32: aload_1
      33: new           #106                // class java/util/Date
      36: dup
      37: invokespecial #107                // Method java/util/Date."<init>":()V
      40: invokeinterface #114,  2          // InterfaceMethod org/owasp/esapi/User.setLastLoginTime:(Ljava/util/Date;)V
      45: aload_1
      46: checkcast     #9                  // class org/owasp/esapi/reference/DefaultUser
      49: iconst_0
      50: invokevirtual #115                // Method org/owasp/esapi/reference/DefaultUser.setFailedLoginCount:(I)V
      53: aload_0
      54: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
      57: getstatic     #38                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      60: new           #20                 // class java/lang/StringBuilder
      63: dup
      64: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      67: ldc           #116                // String Password verified for
      69: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      72: aload_3
      73: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      76: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      79: invokeinterface #41,  3           // InterfaceMethod org/owasp/esapi/Logger.info:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      84: iconst_1
      85: ireturn
      86: goto          122
      89: astore        4
      91: aload_0
      92: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
      95: getstatic     #117                // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
      98: new           #20                 // class java/lang/StringBuilder
     101: dup
     102: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     105: ldc           #118                // String Encryption error verifying password for
     107: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     110: aload_3
     111: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     114: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     117: invokeinterface #119,  3          // InterfaceMethod org/owasp/esapi/Logger.fatal:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     122: aload_0
     123: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
     126: getstatic     #117                // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     129: new           #20                 // class java/lang/StringBuilder
     132: dup
     133: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     136: ldc           #120                // String Password verification failed for
     138: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     141: aload_3
     142: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     145: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     148: invokeinterface #119,  3          // InterfaceMethod org/owasp/esapi/Logger.fatal:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     153: iconst_0
     154: ireturn
    Exception table:
       from    to  target type
           7    85    89   Class org/owasp/esapi/errors/EncryptionException

  public java.lang.String generateStrongPassword(org.owasp.esapi.User, java.lang.String);
    Code:
       0: aload_0
       1: aload_2
       2: invokespecial #94                 // Method generateStrongPassword:(Ljava/lang/String;)Ljava/lang/String;
       5: astore_3
       6: aload_3
       7: ifnull        46
      10: aload_0
      11: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
      14: getstatic     #38                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      17: new           #20                 // class java/lang/StringBuilder
      20: dup
      21: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      24: ldc           #121                // String Generated strong password for
      26: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      29: aload_1
      30: invokeinterface #40,  1           // InterfaceMethod org/owasp/esapi/User.getAccountName:()Ljava/lang/String;
      35: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      38: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      41: invokeinterface #41,  3           // InterfaceMethod org/owasp/esapi/Logger.info:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      46: aload_3
      47: areturn

  public synchronized org.owasp.esapi.User getUser(long);
    Code:
       0: lload_1
       1: lconst_0
       2: lcmp
       3: ifne          10
       6: getstatic     #122                // Field org/owasp/esapi/User.ANONYMOUS:Lorg/owasp/esapi/User;
       9: areturn
      10: aload_0
      11: invokevirtual #71                 // Method loadUsersIfNecessary:()V
      14: aload_0
      15: getfield      #16                 // Field userMap:Ljava/util/Map;
      18: lload_1
      19: invokestatic  #18                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      22: invokeinterface #48,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      27: checkcast     #123                // class org/owasp/esapi/User
      30: areturn

  public synchronized org.owasp.esapi.User getUser(java.lang.String);
    Code:
       0: aload_1
       1: ifnonnull     8
       4: getstatic     #122                // Field org/owasp/esapi/User.ANONYMOUS:Lorg/owasp/esapi/User;
       7: areturn
       8: aload_0
       9: invokevirtual #71                 // Method loadUsersIfNecessary:()V
      12: aload_0
      13: getfield      #16                 // Field userMap:Ljava/util/Map;
      16: invokeinterface #124,  1          // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
      21: invokeinterface #125,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      26: astore_2
      27: aload_2
      28: invokeinterface #126,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      33: ifeq          64
      36: aload_2
      37: invokeinterface #127,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      42: checkcast     #123                // class org/owasp/esapi/User
      45: astore_3
      46: aload_3
      47: invokeinterface #40,  1           // InterfaceMethod org/owasp/esapi/User.getAccountName:()Ljava/lang/String;
      52: aload_1
      53: invokevirtual #128                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
      56: ifeq          61
      59: aload_3
      60: areturn
      61: goto          27
      64: aconst_null
      65: areturn

  public synchronized java.util.Set getUserNames();
    Code:
       0: aload_0
       1: invokevirtual #71                 // Method loadUsersIfNecessary:()V
       4: new           #129                // class java/util/HashSet
       7: dup
       8: invokespecial #130                // Method java/util/HashSet."<init>":()V
      11: astore_1
      12: aload_0
      13: getfield      #16                 // Field userMap:Ljava/util/Map;
      16: invokeinterface #124,  1          // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
      21: invokeinterface #125,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      26: astore_2
      27: aload_2
      28: invokeinterface #126,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      33: ifeq          60
      36: aload_2
      37: invokeinterface #127,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      42: checkcast     #123                // class org/owasp/esapi/User
      45: astore_3
      46: aload_1
      47: aload_3
      48: invokeinterface #40,  1           // InterfaceMethod org/owasp/esapi/User.getAccountName:()Ljava/lang/String;
      53: invokevirtual #131                // Method java/util/HashSet.add:(Ljava/lang/Object;)Z
      56: pop
      57: goto          27
      60: aload_1
      61: areturn

  public java.lang.String hashPassword(java.lang.String, java.lang.String) throws org.owasp.esapi.errors.EncryptionException;
    Code:
       0: aload_2
       1: invokevirtual #7                  // Method java/lang/String.toLowerCase:()Ljava/lang/String;
       4: astore_3
       5: invokestatic  #132                // Method org/owasp/esapi/ESAPI.encryptor:()Lorg/owasp/esapi/Encryptor;
       8: aload_1
       9: aload_3
      10: invokeinterface #133,  3          // InterfaceMethod org/owasp/esapi/Encryptor.hash:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      15: areturn

  protected void loadUsersIfNecessary();
    Code:
       0: aload_0
       1: getfield      #61                 // Field userDB:Ljava/io/File;
       4: ifnonnull     21
       7: aload_0
       8: invokestatic  #34                 // Method org/owasp/esapi/ESAPI.securityConfiguration:()Lorg/owasp/esapi/SecurityConfiguration;
      11: ldc           #134                // String users.txt
      13: invokeinterface #135,  2          // InterfaceMethod org/owasp/esapi/SecurityConfiguration.getResourceFile:(Ljava/lang/String;)Ljava/io/File;
      18: putfield      #61                 // Field userDB:Ljava/io/File;
      21: aload_0
      22: getfield      #61                 // Field userDB:Ljava/io/File;
      25: ifnonnull     163
      28: aload_0
      29: new           #136                // class java/io/File
      32: dup
      33: new           #20                 // class java/lang/StringBuilder
      36: dup
      37: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      40: ldc           #137                // String user.home
      42: invokestatic  #138                // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      45: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      48: ldc           #139                // String /.esapi
      50: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      53: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      56: ldc           #134                // String users.txt
      58: invokespecial #140                // Method java/io/File."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      61: putfield      #61                 // Field userDB:Ljava/io/File;
      64: aload_0
      65: getfield      #61                 // Field userDB:Ljava/io/File;
      68: invokevirtual #141                // Method java/io/File.createNewFile:()Z
      71: ifne          84
      74: new           #142                // class java/io/IOException
      77: dup
      78: ldc           #143                // String Unable to create the user file
      80: invokespecial #144                // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      83: athrow
      84: aload_0
      85: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
      88: getstatic     #38                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      91: new           #20                 // class java/lang/StringBuilder
      94: dup
      95: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      98: ldc           #145                // String Created
     100: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     103: aload_0
     104: getfield      #61                 // Field userDB:Ljava/io/File;
     107: invokevirtual #146                // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
     110: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     113: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     116: invokeinterface #147,  3          // InterfaceMethod org/owasp/esapi/Logger.warning:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     121: goto          163
     124: astore_1
     125: aload_0
     126: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
     129: getstatic     #117                // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     132: new           #20                 // class java/lang/StringBuilder
     135: dup
     136: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     139: ldc           #148                // String Could not create
     141: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     144: aload_0
     145: getfield      #61                 // Field userDB:Ljava/io/File;
     148: invokevirtual #146                // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
     151: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     154: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     157: aload_1
     158: invokeinterface #149,  4          // InterfaceMethod org/owasp/esapi/Logger.fatal:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     163: invokestatic  #150                // Method java/lang/System.currentTimeMillis:()J
     166: lstore_1
     167: lload_1
     168: aload_0
     169: getfield      #66                 // Field lastChecked:J
     172: lsub
     173: aload_0
     174: getfield      #64                 // Field checkInterval:J
     177: lcmp
     178: ifge          182
     181: return
     182: aload_0
     183: lload_1
     184: putfield      #66                 // Field lastChecked:J
     187: aload_0
     188: getfield      #65                 // Field lastModified:J
     191: aload_0
     192: getfield      #61                 // Field userDB:Ljava/io/File;
     195: invokevirtual #151                // Method java/io/File.lastModified:()J
     198: lcmp
     199: ifne          203
     202: return
     203: aload_0
     204: invokevirtual #152                // Method loadUsersImmediately:()V
     207: return
    Exception table:
       from    to  target type
          64   121   124   Class java/io/IOException

  protected void loadUsersImmediately();
    Code:
       0: aload_0
       1: dup
       2: astore_1
       3: monitorenter
       4: aload_0
       5: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
       8: getstatic     #38                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      11: new           #20                 // class java/lang/StringBuilder
      14: dup
      15: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      18: ldc           #153                // String Loading users from
      20: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      23: aload_0
      24: getfield      #61                 // Field userDB:Ljava/io/File;
      27: invokevirtual #146                // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
      30: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      33: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      36: aconst_null
      37: invokeinterface #154,  4          // InterfaceMethod org/owasp/esapi/Logger.trace:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
      42: aconst_null
      43: astore_2
      44: new           #67                 // class java/util/HashMap
      47: dup
      48: invokespecial #68                 // Method java/util/HashMap."<init>":()V
      51: astore_3
      52: new           #155                // class java/io/BufferedReader
      55: dup
      56: new           #156                // class java/io/FileReader
      59: dup
      60: aload_0
      61: getfield      #61                 // Field userDB:Ljava/io/File;
      64: invokespecial #157                // Method java/io/FileReader."<init>":(Ljava/io/File;)V
      67: invokespecial #158                // Method java/io/BufferedReader."<init>":(Ljava/io/Reader;)V
      70: astore_2
      71: aload_2
      72: invokevirtual #159                // Method java/io/BufferedReader.readLine:()Ljava/lang/String;
      75: dup
      76: astore        4
      78: ifnull        178
      81: aload         4
      83: invokevirtual #160                // Method java/lang/String.length:()I
      86: ifle          71
      89: aload         4
      91: iconst_0
      92: invokevirtual #161                // Method java/lang/String.charAt:(I)C
      95: bipush        35
      97: if_icmpeq     71
     100: aload_0
     101: aload         4
     103: invokespecial #162                // Method createUser:(Ljava/lang/String;)Lorg/owasp/esapi/reference/DefaultUser;
     106: astore        5
     108: aload_3
     109: new           #163                // class java/lang/Long
     112: dup
     113: aload         5
     115: invokevirtual #17                 // Method org/owasp/esapi/reference/DefaultUser.getAccountId:()J
     118: invokespecial #164                // Method java/lang/Long."<init>":(J)V
     121: invokevirtual #165                // Method java/util/HashMap.containsKey:(Ljava/lang/Object;)Z
     124: ifeq          160
     127: aload_0
     128: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
     131: getstatic     #117                // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     134: new           #20                 // class java/lang/StringBuilder
     137: dup
     138: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     141: ldc           #166                // String Problem in user file. Skipping duplicate user:
     143: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     146: aload         5
     148: invokevirtual #167                // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     151: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     154: aconst_null
     155: invokeinterface #149,  4          // InterfaceMethod org/owasp/esapi/Logger.fatal:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     160: aload_3
     161: aload         5
     163: invokevirtual #17                 // Method org/owasp/esapi/reference/DefaultUser.getAccountId:()J
     166: invokestatic  #18                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
     169: aload         5
     171: invokevirtual #168                // Method java/util/HashMap.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     174: pop
     175: goto          71
     178: aload_0
     179: aload_3
     180: putfield      #16                 // Field userMap:Ljava/util/Map;
     183: aload_0
     184: invokestatic  #150                // Method java/lang/System.currentTimeMillis:()J
     187: putfield      #65                 // Field lastModified:J
     190: aload_0
     191: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
     194: getstatic     #38                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
     197: new           #20                 // class java/lang/StringBuilder
     200: dup
     201: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     204: ldc           #169                // String User file reloaded:
     206: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     209: aload_3
     210: invokevirtual #170                // Method java/util/HashMap.size:()I
     213: invokevirtual #171                // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     216: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     219: aconst_null
     220: invokeinterface #154,  4          // InterfaceMethod org/owasp/esapi/Logger.trace:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     225: jsr           284
     228: goto          340
     231: astore_3
     232: aload_0
     233: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
     236: getstatic     #117                // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     239: new           #20                 // class java/lang/StringBuilder
     242: dup
     243: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     246: ldc           #173                // String Failure loading user file:
     248: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     251: aload_0
     252: getfield      #61                 // Field userDB:Ljava/io/File;
     255: invokevirtual #146                // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
     258: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     261: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     264: aload_3
     265: invokeinterface #149,  4          // InterfaceMethod org/owasp/esapi/Logger.fatal:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     270: jsr           284
     273: goto          340
     276: astore        6
     278: jsr           284
     281: aload         6
     283: athrow
     284: astore        7
     286: aload_2
     287: ifnull        294
     290: aload_2
     291: invokevirtual #174                // Method java/io/BufferedReader.close:()V
     294: goto          338
     297: astore        8
     299: aload_0
     300: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
     303: getstatic     #117                // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     306: new           #20                 // class java/lang/StringBuilder
     309: dup
     310: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     313: ldc           #175                // String Failure closing user file:
     315: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     318: aload_0
     319: getfield      #61                 // Field userDB:Ljava/io/File;
     322: invokevirtual #146                // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
     325: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     328: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     331: aload         8
     333: invokeinterface #149,  4          // InterfaceMethod org/owasp/esapi/Logger.fatal:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     338: ret           7
     340: aload_1
     341: monitorexit
     342: goto          352
     345: astore        9
     347: aload_1
     348: monitorexit
     349: aload         9
     351: athrow
     352: return
    Exception table:
       from    to  target type
          44   225   231   Class java/lang/Exception
          44   228   276   any
         231   273   276   any
         276   281   276   any
         286   294   297   Class java/io/IOException
           4   342   345   any
         345   349   345   any

  private org.owasp.esapi.reference.DefaultUser createUser(java.lang.String) throws org.owasp.esapi.errors.AuthenticationException;
    Code:
       0: aload_1
       1: ldc           #176                // String  *\\| *
       3: invokevirtual #177                // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
       6: astore_2
       7: aload_2
       8: iconst_0
       9: aaload
      10: astore_3
      11: aload_3
      12: invokestatic  #178                // Method java/lang/Long.parseLong:(Ljava/lang/String;)J
      15: lstore        4
      17: aload_2
      18: iconst_1
      19: aaload
      20: astore        6
      22: aload_0
      23: aload         6
      25: invokevirtual #77                 // Method verifyAccountNameStrength:(Ljava/lang/String;)V
      28: new           #9                  // class org/owasp/esapi/reference/DefaultUser
      31: dup
      32: aload         6
      34: invokespecial #10                 // Method org/owasp/esapi/reference/DefaultUser."<init>":(Ljava/lang/String;)V
      37: astore        7
      39: aload         7
      41: lload         4
      43: putfield      #179                // Field org/owasp/esapi/reference/DefaultUser.accountId:J
      46: aload_2
      47: iconst_2
      48: aaload
      49: astore        8
      51: aload_0
      52: aconst_null
      53: aload         8
      55: aload         7
      57: invokevirtual #83                 // Method verifyPasswordStrength:(Ljava/lang/String;Ljava/lang/String;Lorg/owasp/esapi/User;)V
      60: aload_0
      61: aload         7
      63: aload         8
      65: invokespecial #12                 // Method setHashedPassword:(Lorg/owasp/esapi/User;Ljava/lang/String;)V
      68: aload_2
      69: iconst_3
      70: aaload
      71: invokevirtual #7                  // Method java/lang/String.toLowerCase:()Ljava/lang/String;
      74: ldc           #180                // String  *, *
      76: invokevirtual #177                // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
      79: astore        9
      81: aload         9
      83: astore        10
      85: aload         10
      87: arraylength
      88: istore        11
      90: iconst_0
      91: istore        12
      93: iload         12
      95: iload         11
      97: if_icmpge     130
     100: aload         10
     102: iload         12
     104: aaload
     105: astore        13
     107: ldc           #93                 // String
     109: aload         13
     111: invokevirtual #84                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     114: ifne          124
     117: aload         7
     119: aload         13
     121: invokevirtual #13                 // Method org/owasp/esapi/reference/DefaultUser.addRole:(Ljava/lang/String;)V
     124: iinc          12, 1
     127: goto          93
     130: ldc           #181                // String unlocked
     132: aload_2
     133: iconst_4
     134: aaload
     135: invokevirtual #128                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     138: ifne          146
     141: aload         7
     143: invokevirtual #182                // Method org/owasp/esapi/reference/DefaultUser.lock:()V
     146: ldc           #183                // String enabled
     148: aload_2
     149: iconst_5
     150: aaload
     151: invokevirtual #128                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     154: ifeq          165
     157: aload         7
     159: invokevirtual #14                 // Method org/owasp/esapi/reference/DefaultUser.enable:()V
     162: goto          170
     165: aload         7
     167: invokevirtual #184                // Method org/owasp/esapi/reference/DefaultUser.disable:()V
     170: aload         7
     172: invokevirtual #185                // Method org/owasp/esapi/reference/DefaultUser.resetCSRFToken:()Ljava/lang/String;
     175: pop
     176: aload_0
     177: aload         7
     179: aload_2
     180: bipush        6
     182: aaload
     183: ldc           #180                // String  *, *
     185: invokevirtual #177                // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     188: invokestatic  #186                // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
     191: invokevirtual #187                // Method setOldPasswordHashes:(Lorg/owasp/esapi/User;Ljava/util/List;)V
     194: aload         7
     196: ldc           #188                // String null
     198: aload_2
     199: bipush        7
     201: aaload
     202: invokevirtual #84                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     205: ifeq          212
     208: aconst_null
     209: goto          216
     212: aload_2
     213: bipush        7
     215: aaload
     216: invokevirtual #189                // Method org/owasp/esapi/reference/DefaultUser.setLastHostAddress:(Ljava/lang/String;)V
     219: aload         7
     221: new           #106                // class java/util/Date
     224: dup
     225: aload_2
     226: bipush        8
     228: aaload
     229: invokestatic  #178                // Method java/lang/Long.parseLong:(Ljava/lang/String;)J
     232: invokespecial #190                // Method java/util/Date."<init>":(J)V
     235: invokevirtual #191                // Method org/owasp/esapi/reference/DefaultUser.setLastPasswordChangeTime:(Ljava/util/Date;)V
     238: aload         7
     240: new           #106                // class java/util/Date
     243: dup
     244: aload_2
     245: bipush        9
     247: aaload
     248: invokestatic  #178                // Method java/lang/Long.parseLong:(Ljava/lang/String;)J
     251: invokespecial #190                // Method java/util/Date."<init>":(J)V
     254: invokevirtual #192                // Method org/owasp/esapi/reference/DefaultUser.setLastLoginTime:(Ljava/util/Date;)V
     257: aload         7
     259: new           #106                // class java/util/Date
     262: dup
     263: aload_2
     264: bipush        10
     266: aaload
     267: invokestatic  #178                // Method java/lang/Long.parseLong:(Ljava/lang/String;)J
     270: invokespecial #190                // Method java/util/Date."<init>":(J)V
     273: invokevirtual #193                // Method org/owasp/esapi/reference/DefaultUser.setLastFailedLoginTime:(Ljava/util/Date;)V
     276: aload         7
     278: new           #106                // class java/util/Date
     281: dup
     282: aload_2
     283: bipush        11
     285: aaload
     286: invokestatic  #178                // Method java/lang/Long.parseLong:(Ljava/lang/String;)J
     289: invokespecial #190                // Method java/util/Date."<init>":(J)V
     292: invokevirtual #194                // Method org/owasp/esapi/reference/DefaultUser.setExpirationTime:(Ljava/util/Date;)V
     295: aload         7
     297: aload_2
     298: bipush        12
     300: aaload
     301: invokestatic  #195                // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
     304: invokevirtual #115                // Method org/owasp/esapi/reference/DefaultUser.setFailedLoginCount:(I)V
     307: aload         7
     309: areturn

  public synchronized void removeUser(java.lang.String) throws org.owasp.esapi.errors.AuthenticationException;
    Code:
       0: aload_0
       1: invokevirtual #71                 // Method loadUsersIfNecessary:()V
       4: aload_0
       5: aload_1
       6: invokevirtual #8                  // Method getUser:(Ljava/lang/String;)Lorg/owasp/esapi/User;
       9: astore_2
      10: aload_2
      11: ifnonnull     43
      14: new           #72                 // class org/owasp/esapi/errors/AuthenticationAccountsException
      17: dup
      18: ldc           #196                // String Remove user failed
      20: new           #20                 // class java/lang/StringBuilder
      23: dup
      24: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      27: ldc           #197                // String Can\'t remove invalid accountName
      29: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      32: aload_1
      33: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      36: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      39: invokespecial #75                 // Method org/owasp/esapi/errors/AuthenticationAccountsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      42: athrow
      43: aload_0
      44: getfield      #16                 // Field userMap:Ljava/util/Map;
      47: aload_2
      48: invokeinterface #198,  1          // InterfaceMethod org/owasp/esapi/User.getAccountId:()J
      53: invokestatic  #18                 // Method java/lang/Long.valueOf:(J)Ljava/lang/Long;
      56: invokeinterface #199,  2          // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      61: pop
      62: aload_0
      63: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
      66: getstatic     #38                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      69: new           #20                 // class java/lang/StringBuilder
      72: dup
      73: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      76: ldc           #200                // String Removing user
      78: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      81: aload_2
      82: invokeinterface #40,  1           // InterfaceMethod org/owasp/esapi/User.getAccountName:()Ljava/lang/String;
      87: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      90: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      93: invokeinterface #41,  3           // InterfaceMethod org/owasp/esapi/Logger.info:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      98: aload_0
      99: getfield      #47                 // Field passwordMap:Ljava/util/Map;
     102: aload_2
     103: invokeinterface #199,  2          // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
     108: pop
     109: aload_0
     110: invokevirtual #25                 // Method saveUsers:()V
     113: return

  public synchronized void saveUsers() throws org.owasp.esapi.errors.AuthenticationException;
    Code:
       0: aconst_null
       1: astore_1
       2: new           #201                // class java/io/PrintWriter
       5: dup
       6: new           #202                // class java/io/FileWriter
       9: dup
      10: aload_0
      11: getfield      #61                 // Field userDB:Ljava/io/File;
      14: invokespecial #203                // Method java/io/FileWriter."<init>":(Ljava/io/File;)V
      17: invokespecial #204                // Method java/io/PrintWriter."<init>":(Ljava/io/Writer;)V
      20: astore_1
      21: aload_1
      22: ldc           #205                // String # This is the user file associated with the ESAPI library from http://www.owasp.org
      24: invokevirtual #206                // Method java/io/PrintWriter.println:(Ljava/lang/String;)V
      27: aload_1
      28: ldc           #207                // String # accountId | accountName | hashedPassword | roles | locked | enabled | csrfToken | oldPasswordHashes | lastPasswordChangeTime | lastLoginTime | lastFailedLoginTime | expirationTime | failedLoginCount
      30: invokevirtual #206                // Method java/io/PrintWriter.println:(Ljava/lang/String;)V
      33: aload_1
      34: invokevirtual #208                // Method java/io/PrintWriter.println:()V
      37: aload_0
      38: aload_1
      39: invokevirtual #209                // Method saveUsers:(Ljava/io/PrintWriter;)V
      42: aload_1
      43: invokevirtual #210                // Method java/io/PrintWriter.flush:()V
      46: aload_0
      47: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
      50: getstatic     #38                 // Field org/owasp/esapi/Logger.SECURITY_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      53: ldc           #211                // String User file written to disk
      55: invokeinterface #41,  3           // InterfaceMethod org/owasp/esapi/Logger.info:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      60: jsr           147
      63: goto          178
      66: astore_2
      67: aload_0
      68: getfield      #37                 // Field logger:Lorg/owasp/esapi/Logger;
      71: getstatic     #117                // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
      74: new           #20                 // class java/lang/StringBuilder
      77: dup
      78: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      81: ldc           #212                // String Problem saving user file
      83: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      86: aload_0
      87: getfield      #61                 // Field userDB:Ljava/io/File;
      90: invokevirtual #146                // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
      93: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      96: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      99: aload_2
     100: invokeinterface #149,  4          // InterfaceMethod org/owasp/esapi/Logger.fatal:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;Ljava/lang/Throwable;)V
     105: new           #89                 // class org/owasp/esapi/errors/AuthenticationException
     108: dup
     109: ldc           #213                // String Internal Error
     111: new           #20                 // class java/lang/StringBuilder
     114: dup
     115: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
     118: ldc           #212                // String Problem saving user file
     120: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     123: aload_0
     124: getfield      #61                 // Field userDB:Ljava/io/File;
     127: invokevirtual #146                // Method java/io/File.getAbsolutePath:()Ljava/lang/String;
     130: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     133: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     136: aload_2
     137: invokespecial #92                 // Method org/owasp/esapi/errors/AuthenticationException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
     140: athrow
     141: astore_3
     142: jsr           147
     145: aload_3
     146: athrow
     147: astore        4
     149: aload_1
     150: ifnull        176
     153: aload_1
     154: invokevirtual #214                // Method java/io/PrintWriter.close:()V
     157: aload_0
     158: aload_0
     159: getfield      #61                 // Field userDB:Ljava/io/File;
     162: invokevirtual #151                // Method java/io/File.lastModified:()J
     165: putfield      #65                 // Field lastModified:J
     168: aload_0
     169: aload_0
     170: getfield      #65                 // Field lastModified:J
     173: putfield      #66                 // Field lastChecked:J
     176: ret           4
     178: return
    Exception table:
       from    to  target type
           2    60    66   Class java/io/IOException
           2    63   141   any
          66   145   141   any

  protected synchronized void saveUsers(java.io.PrintWriter) throws org.owasp.esapi.errors.AuthenticationCredentialsException;
    Code:
       0: aload_0
       1: invokevirtual #215                // Method getUserNames:()Ljava/util/Set;
       4: invokeinterface #216,  1          // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
       9: astore_2
      10: aload_2
      11: invokeinterface #126,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      16: ifeq          102
      19: aload_2
      20: invokeinterface #127,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      25: astore_3
      26: aload_3
      27: checkcast     #43                 // class java/lang/String
      30: astore        4
      32: aload_0
      33: aload         4
      35: invokevirtual #8                  // Method getUser:(Ljava/lang/String;)Lorg/owasp/esapi/User;
      38: checkcast     #9                  // class org/owasp/esapi/reference/DefaultUser
      41: astore        5
      43: aload         5
      45: ifnull        69
      48: aload         5
      50: invokevirtual #217                // Method org/owasp/esapi/reference/DefaultUser.isAnonymous:()Z
      53: ifne          69
      56: aload_1
      57: aload_0
      58: aload         5
      60: invokespecial #218                // Method save:(Lorg/owasp/esapi/reference/DefaultUser;)Ljava/lang/String;
      63: invokevirtual #206                // Method java/io/PrintWriter.println:(Ljava/lang/String;)V
      66: goto          99
      69: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
      72: dup
      73: ldc           #219                // String Problem saving user
      75: new           #20                 // class java/lang/StringBuilder
      78: dup
      79: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      82: ldc           #220                // String Skipping save of user
      84: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      87: aload         4
      89: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      92: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      95: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      98: athrow
      99: goto          10
     102: return

  private java.lang.String save(org.owasp.esapi.reference.DefaultUser);
    Code:
       0: new           #20                 // class java/lang/StringBuilder
       3: dup
       4: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
       7: astore_2
       8: aload_2
       9: aload_1
      10: invokevirtual #17                 // Method org/owasp/esapi/reference/DefaultUser.getAccountId:()J
      13: invokevirtual #221                // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
      16: pop
      17: aload_2
      18: ldc           #222                // String  |
      20: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      23: pop
      24: aload_2
      25: aload_1
      26: invokevirtual #27                 // Method org/owasp/esapi/reference/DefaultUser.getAccountName:()Ljava/lang/String;
      29: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      32: pop
      33: aload_2
      34: ldc           #222                // String  |
      36: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      39: pop
      40: aload_2
      41: aload_0
      42: aload_1
      43: invokevirtual #102                // Method getHashedPassword:(Lorg/owasp/esapi/User;)Ljava/lang/String;
      46: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      49: pop
      50: aload_2
      51: ldc           #222                // String  |
      53: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      56: pop
      57: aload_2
      58: aload_0
      59: aload_1
      60: invokevirtual #223                // Method org/owasp/esapi/reference/DefaultUser.getRoles:()Ljava/util/Set;
      63: invokespecial #224                // Method dump:(Ljava/util/Collection;)Ljava/lang/String;
      66: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      69: pop
      70: aload_2
      71: ldc           #222                // String  |
      73: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      76: pop
      77: aload_2
      78: aload_1
      79: invokevirtual #225                // Method org/owasp/esapi/reference/DefaultUser.isLocked:()Z
      82: ifeq          90
      85: ldc           #226                // String locked
      87: goto          92
      90: ldc           #181                // String unlocked
      92: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      95: pop
      96: aload_2
      97: ldc           #222                // String  |
      99: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     102: pop
     103: aload_2
     104: aload_1
     105: invokevirtual #227                // Method org/owasp/esapi/reference/DefaultUser.isEnabled:()Z
     108: ifeq          116
     111: ldc           #183                // String enabled
     113: goto          118
     116: ldc           #228                // String disabled
     118: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     121: pop
     122: aload_2
     123: ldc           #222                // String  |
     125: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     128: pop
     129: aload_2
     130: aload_0
     131: aload_0
     132: aload_1
     133: invokevirtual #109                // Method getOldPasswordHashes:(Lorg/owasp/esapi/User;)Ljava/util/List;
     136: invokespecial #224                // Method dump:(Ljava/util/Collection;)Ljava/lang/String;
     139: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     142: pop
     143: aload_2
     144: ldc           #222                // String  |
     146: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     149: pop
     150: aload_2
     151: aload_1
     152: invokevirtual #229                // Method org/owasp/esapi/reference/DefaultUser.getLastHostAddress:()Ljava/lang/String;
     155: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     158: pop
     159: aload_2
     160: ldc           #222                // String  |
     162: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     165: pop
     166: aload_2
     167: aload_1
     168: invokevirtual #230                // Method org/owasp/esapi/reference/DefaultUser.getLastPasswordChangeTime:()Ljava/util/Date;
     171: invokevirtual #231                // Method java/util/Date.getTime:()J
     174: invokevirtual #221                // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
     177: pop
     178: aload_2
     179: ldc           #222                // String  |
     181: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     184: pop
     185: aload_2
     186: aload_1
     187: invokevirtual #232                // Method org/owasp/esapi/reference/DefaultUser.getLastLoginTime:()Ljava/util/Date;
     190: invokevirtual #231                // Method java/util/Date.getTime:()J
     193: invokevirtual #221                // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
     196: pop
     197: aload_2
     198: ldc           #222                // String  |
     200: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     203: pop
     204: aload_2
     205: aload_1
     206: invokevirtual #233                // Method org/owasp/esapi/reference/DefaultUser.getLastFailedLoginTime:()Ljava/util/Date;
     209: invokevirtual #231                // Method java/util/Date.getTime:()J
     212: invokevirtual #221                // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
     215: pop
     216: aload_2
     217: ldc           #222                // String  |
     219: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     222: pop
     223: aload_2
     224: aload_1
     225: invokevirtual #234                // Method org/owasp/esapi/reference/DefaultUser.getExpirationTime:()Ljava/util/Date;
     228: invokevirtual #231                // Method java/util/Date.getTime:()J
     231: invokevirtual #221                // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
     234: pop
     235: aload_2
     236: ldc           #222                // String  |
     238: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     241: pop
     242: aload_2
     243: aload_1
     244: invokevirtual #235                // Method org/owasp/esapi/reference/DefaultUser.getFailedLoginCount:()I
     247: invokevirtual #171                // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     250: pop
     251: aload_2
     252: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     255: areturn

  private java.lang.String dump(java.util.Collection<java.lang.String>);
    Code:
       0: new           #20                 // class java/lang/StringBuilder
       3: dup
       4: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
       7: astore_2
       8: aload_1
       9: invokeinterface #125,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      14: astore_3
      15: aload_3
      16: invokeinterface #126,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      21: ifeq          50
      24: aload_3
      25: invokeinterface #127,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      30: checkcast     #43                 // class java/lang/String
      33: astore        4
      35: aload_2
      36: aload         4
      38: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      41: ldc           #236                // String ,
      43: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      46: pop
      47: goto          15
      50: aload_1
      51: invokeinterface #237,  1          // InterfaceMethod java/util/Collection.size:()I
      56: ifle          74
      59: aload_2
      60: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      63: iconst_0
      64: aload_2
      65: invokevirtual #238                // Method java/lang/StringBuilder.length:()I
      68: iconst_1
      69: isub
      70: invokevirtual #239                // Method java/lang/String.substring:(II)Ljava/lang/String;
      73: areturn
      74: ldc           #93                 // String
      76: areturn

  public void verifyAccountNameStrength(java.lang.String) throws org.owasp.esapi.errors.AuthenticationException;
    Code:
       0: aload_1
       1: ifnonnull     16
       4: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
       7: dup
       8: ldc           #79                 // String Invalid account name
      10: ldc           #240                // String Attempt to create account with a null account name
      12: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      15: athrow
      16: invokestatic  #241                // Method org/owasp/esapi/ESAPI.validator:()Lorg/owasp/esapi/Validator;
      19: ldc           #242                // String verifyAccountNameStrength
      21: aload_1
      22: ldc           #243                // String AccountName
      24: sipush        250
      27: iconst_0
      28: invokeinterface #244,  6          // InterfaceMethod org/owasp/esapi/Validator.isValidInput:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;IZ)Z
      33: ifne          65
      36: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
      39: dup
      40: ldc           #79                 // String Invalid account name
      42: new           #20                 // class java/lang/StringBuilder
      45: dup
      46: invokespecial #21                 // Method java/lang/StringBuilder."<init>":()V
      49: ldc           #245                // String New account name is not valid:
      51: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      54: aload_1
      55: invokevirtual #23                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      58: invokevirtual #24                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      61: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      64: athrow
      65: return

  public void verifyPasswordStrength(java.lang.String, java.lang.String, org.owasp.esapi.User) throws org.owasp.esapi.errors.AuthenticationException;
    Code:
       0: aload_2
       1: ifnonnull     16
       4: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
       7: dup
       8: ldc           #246                // String Invalid password
      10: ldc           #247                // String New password cannot be null
      12: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      15: athrow
      16: aload_1
      17: ifnull        78
      20: aload_1
      21: invokevirtual #160                // Method java/lang/String.length:()I
      24: istore        4
      26: iconst_0
      27: istore        5
      29: iload         5
      31: iload         4
      33: iconst_2
      34: isub
      35: if_icmpge     78
      38: aload_1
      39: iload         5
      41: iload         5
      43: iconst_3
      44: iadd
      45: invokevirtual #239                // Method java/lang/String.substring:(II)Ljava/lang/String;
      48: astore        6
      50: aload_2
      51: aload         6
      53: invokevirtual #248                // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      56: iconst_m1
      57: if_icmple     72
      60: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
      63: dup
      64: ldc           #246                // String Invalid password
      66: ldc           #249                // String New password cannot contain pieces of old password
      68: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      71: athrow
      72: iinc          5, 1
      75: goto          29
      78: iconst_0
      79: istore        4
      81: iconst_0
      82: istore        5
      84: iload         5
      86: aload_2
      87: invokevirtual #160                // Method java/lang/String.length:()I
      90: if_icmpge     120
      93: getstatic     #250                // Field org/owasp/esapi/EncoderConstants.CHAR_LOWERS:[C
      96: aload_2
      97: iload         5
      99: invokevirtual #161                // Method java/lang/String.charAt:(I)C
     102: invokestatic  #251                // Method java/util/Arrays.binarySearch:([CC)I
     105: iflt          114
     108: iinc          4, 1
     111: goto          120
     114: iinc          5, 1
     117: goto          84
     120: iconst_0
     121: istore        5
     123: iload         5
     125: aload_2
     126: invokevirtual #160                // Method java/lang/String.length:()I
     129: if_icmpge     159
     132: getstatic     #252                // Field org/owasp/esapi/EncoderConstants.CHAR_UPPERS:[C
     135: aload_2
     136: iload         5
     138: invokevirtual #161                // Method java/lang/String.charAt:(I)C
     141: invokestatic  #251                // Method java/util/Arrays.binarySearch:([CC)I
     144: iflt          153
     147: iinc          4, 1
     150: goto          159
     153: iinc          5, 1
     156: goto          123
     159: iconst_0
     160: istore        5
     162: iload         5
     164: aload_2
     165: invokevirtual #160                // Method java/lang/String.length:()I
     168: if_icmpge     198
     171: getstatic     #253                // Field org/owasp/esapi/EncoderConstants.CHAR_DIGITS:[C
     174: aload_2
     175: iload         5
     177: invokevirtual #161                // Method java/lang/String.charAt:(I)C
     180: invokestatic  #251                // Method java/util/Arrays.binarySearch:([CC)I
     183: iflt          192
     186: iinc          4, 1
     189: goto          198
     192: iinc          5, 1
     195: goto          162
     198: iconst_0
     199: istore        5
     201: iload         5
     203: aload_2
     204: invokevirtual #160                // Method java/lang/String.length:()I
     207: if_icmpge     237
     210: getstatic     #254                // Field org/owasp/esapi/EncoderConstants.CHAR_SPECIALS:[C
     213: aload_2
     214: iload         5
     216: invokevirtual #161                // Method java/lang/String.charAt:(I)C
     219: invokestatic  #251                // Method java/util/Arrays.binarySearch:([CC)I
     222: iflt          231
     225: iinc          4, 1
     228: goto          237
     231: iinc          5, 1
     234: goto          201
     237: aload_2
     238: invokevirtual #160                // Method java/lang/String.length:()I
     241: iload         4
     243: imul
     244: istore        5
     246: iload         5
     248: bipush        16
     250: if_icmpge     265
     253: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
     256: dup
     257: ldc           #246                // String Invalid password
     259: ldc           #255                // String New password is not long and complex enough
     261: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     264: athrow
     265: aload_3
     266: invokeinterface #40,  1           // InterfaceMethod org/owasp/esapi/User.getAccountName:()Ljava/lang/String;
     271: astore        6
     273: aload         6
     275: aload_2
     276: invokevirtual #128                // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
     279: ifeq          295
     282: new           #78                 // class org/owasp/esapi/errors/AuthenticationCredentialsException
     285: dup
     286: ldc           #246                // String Invalid password
     288: ldc_w         #256                // String Password matches account name, irrespective of case
     291: invokespecial #82                 // Method org/owasp/esapi/errors/AuthenticationCredentialsException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     294: athrow
     295: return
}
