Compiled from "HTMLValidationRule.java"
public class org.owasp.esapi.reference.validation.HTMLValidationRule extends org.owasp.esapi.reference.validation.StringValidationRule {
  private static org.owasp.validator.html.Policy antiSamyPolicy;

  private static final org.owasp.esapi.Logger LOGGER;

  public org.owasp.esapi.reference.validation.HTMLValidationRule(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #1                  // Method org/owasp/esapi/reference/validation/StringValidationRule."<init>":(Ljava/lang/String;)V
       5: return

  public org.owasp.esapi.reference.validation.HTMLValidationRule(java.lang.String, org.owasp.esapi.Encoder);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #2                  // Method org/owasp/esapi/reference/validation/StringValidationRule."<init>":(Ljava/lang/String;Lorg/owasp/esapi/Encoder;)V
       6: return

  public org.owasp.esapi.reference.validation.HTMLValidationRule(java.lang.String, org.owasp.esapi.Encoder, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: invokespecial #3                  // Method org/owasp/esapi/reference/validation/StringValidationRule."<init>":(Ljava/lang/String;Lorg/owasp/esapi/Encoder;Ljava/lang/String;)V
       7: return

  public java.lang.String getValid(java.lang.String, java.lang.String) throws org.owasp.esapi.errors.ValidationException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #4                  // Method invokeAntiSamy:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
       6: areturn

  public java.lang.String sanitize(java.lang.String, java.lang.String);
    Code:
       0: ldc           #5                  // String
       2: astore_3
       3: aload_0
       4: aload_1
       5: aload_2
       6: invokespecial #4                  // Method invokeAntiSamy:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
       9: astore_3
      10: goto          15
      13: astore        4
      15: aload_3
      16: areturn
    Exception table:
       from    to  target type
           3    10    13   Class org/owasp/esapi/errors/ValidationException

  private java.lang.String invokeAntiSamy(java.lang.String, java.lang.String) throws org.owasp.esapi.errors.ValidationException;
    Code:
       0: aload_2
       1: invokestatic  #7                  // Method org/owasp/esapi/StringUtilities.isEmpty:(Ljava/lang/String;)Z
       4: ifeq          72
       7: aload_0
       8: getfield      #8                  // Field allowNull:Z
      11: ifeq          16
      14: aconst_null
      15: areturn
      16: new           #6                  // class org/owasp/esapi/errors/ValidationException
      19: dup
      20: new           #9                  // class java/lang/StringBuilder
      23: dup
      24: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
      27: aload_1
      28: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      31: ldc           #12                 // String  is required
      33: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      36: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      39: new           #9                  // class java/lang/StringBuilder
      42: dup
      43: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
      46: ldc           #14                 // String AntiSamy validation error: context=
      48: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      51: aload_1
      52: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      55: ldc           #15                 // String , input=
      57: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      60: aload_2
      61: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      64: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      67: aload_1
      68: invokespecial #16                 // Method org/owasp/esapi/errors/ValidationException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
      71: athrow
      72: aload_0
      73: aload_1
      74: aload_2
      75: invokespecial #17                 // Method org/owasp/esapi/reference/validation/StringValidationRule.getValid:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      78: astore_3
      79: new           #18                 // class org/owasp/validator/html/AntiSamy
      82: dup
      83: invokespecial #19                 // Method org/owasp/validator/html/AntiSamy."<init>":()V
      86: astore        4
      88: aload         4
      90: aload_3
      91: getstatic     #20                 // Field antiSamyPolicy:Lorg/owasp/validator/html/Policy;
      94: invokevirtual #21                 // Method org/owasp/validator/html/AntiSamy.scan:(Ljava/lang/String;Lorg/owasp/validator/html/Policy;)Lorg/owasp/validator/html/CleanResults;
      97: astore        5
      99: aload         5
     101: invokevirtual #22                 // Method org/owasp/validator/html/CleanResults.getErrorMessages:()Ljava/util/ArrayList;
     104: astore        6
     106: aload         6
     108: invokeinterface #23,  1           // InterfaceMethod java/util/List.isEmpty:()Z
     113: ifne          147
     116: getstatic     #24                 // Field LOGGER:Lorg/owasp/esapi/Logger;
     119: getstatic     #25                 // Field org/owasp/esapi/Logger.SECURITY_FAILURE:Lorg/owasp/esapi/Logger$EventType;
     122: new           #9                  // class java/lang/StringBuilder
     125: dup
     126: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     129: ldc           #26                 // String Cleaned up invalid HTML input:
     131: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     134: aload         6
     136: invokevirtual #27                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     139: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     142: invokeinterface #28,  3           // InterfaceMethod org/owasp/esapi/Logger.info:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     147: aload         5
     149: invokevirtual #29                 // Method org/owasp/validator/html/CleanResults.getCleanHTML:()Ljava/lang/String;
     152: invokevirtual #30                 // Method java/lang/String.trim:()Ljava/lang/String;
     155: areturn
     156: astore        4
     158: new           #6                  // class org/owasp/esapi/errors/ValidationException
     161: dup
     162: new           #9                  // class java/lang/StringBuilder
     165: dup
     166: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     169: aload_1
     170: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     173: ldc           #32                 // String : Invalid HTML input
     175: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     178: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     181: new           #9                  // class java/lang/StringBuilder
     184: dup
     185: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     188: ldc           #33                 // String Invalid HTML input: context=
     190: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     193: aload_1
     194: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     197: ldc           #34                 // String  error=
     199: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     202: aload         4
     204: invokevirtual #35                 // Method org/owasp/validator/html/ScanException.getMessage:()Ljava/lang/String;
     207: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     210: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     213: aload         4
     215: aload_1
     216: invokespecial #36                 // Method org/owasp/esapi/errors/ValidationException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;Ljava/lang/String;)V
     219: athrow
     220: astore        4
     222: new           #6                  // class org/owasp/esapi/errors/ValidationException
     225: dup
     226: new           #9                  // class java/lang/StringBuilder
     229: dup
     230: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     233: aload_1
     234: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     237: ldc           #32                 // String : Invalid HTML input
     239: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     242: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     245: new           #9                  // class java/lang/StringBuilder
     248: dup
     249: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     252: ldc           #38                 // String Invalid HTML input does not follow rules in antisamy-esapi.xml: context=
     254: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     257: aload_1
     258: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     261: ldc           #34                 // String  error=
     263: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     266: aload         4
     268: invokevirtual #39                 // Method org/owasp/validator/html/PolicyException.getMessage:()Ljava/lang/String;
     271: invokevirtual #11                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     274: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     277: aload         4
     279: aload_1
     280: invokespecial #36                 // Method org/owasp/esapi/errors/ValidationException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;Ljava/lang/String;)V
     283: athrow
    Exception table:
       from    to  target type
          79   155   156   Class org/owasp/validator/html/ScanException
          79   155   220   Class org/owasp/validator/html/PolicyException

  public java.lang.Object sanitize(java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokevirtual #40                 // Method sanitize:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
       6: areturn

  public java.lang.Object getValid(java.lang.String, java.lang.String) throws org.owasp.esapi.errors.ValidationException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokevirtual #41                 // Method getValid:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
       6: areturn

  static {};
    Code:
       0: aconst_null
       1: putstatic     #20                 // Field antiSamyPolicy:Lorg/owasp/validator/html/Policy;
       4: ldc           #42                 // String HTMLValidationRule
       6: invokestatic  #43                 // Method org/owasp/esapi/ESAPI.getLogger:(Ljava/lang/String;)Lorg/owasp/esapi/Logger;
       9: putstatic     #24                 // Field LOGGER:Lorg/owasp/esapi/Logger;
      12: aconst_null
      13: astore_0
      14: invokestatic  #44                 // Method org/owasp/esapi/ESAPI.securityConfiguration:()Lorg/owasp/esapi/SecurityConfiguration;
      17: ldc           #45                 // String antisamy-esapi.xml
      19: invokeinterface #46,  2           // InterfaceMethod org/owasp/esapi/SecurityConfiguration.getResourceStream:(Ljava/lang/String;)Ljava/io/InputStream;
      24: astore_0
      25: goto          40
      28: astore_1
      29: new           #48                 // class org/owasp/esapi/errors/ConfigurationException
      32: dup
      33: ldc           #49                 // String Couldn\'t find antisamy-esapi.xml
      35: aload_1
      36: invokespecial #50                 // Method org/owasp/esapi/errors/ConfigurationException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      39: athrow
      40: aload_0
      41: ifnull        66
      44: aload_0
      45: invokestatic  #51                 // Method org/owasp/validator/html/Policy.getInstance:(Ljava/io/InputStream;)Lorg/owasp/validator/html/Policy;
      48: putstatic     #20                 // Field antiSamyPolicy:Lorg/owasp/validator/html/Policy;
      51: goto          66
      54: astore_1
      55: new           #48                 // class org/owasp/esapi/errors/ConfigurationException
      58: dup
      59: ldc           #52                 // String Couldn\'t parse antisamy policy
      61: aload_1
      62: invokespecial #50                 // Method org/owasp/esapi/errors/ConfigurationException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      65: athrow
      66: return
    Exception table:
       from    to  target type
          14    25    28   Class java/io/IOException
          44    51    54   Class org/owasp/validator/html/PolicyException
}
