Compiled from "ExperimentalAccessController.java"
public class org.owasp.esapi.reference.accesscontrol.ExperimentalAccessController implements org.owasp.esapi.AccessController {
  private java.util.Map ruleMap;

  protected final org.owasp.esapi.Logger logger;

  public org.owasp.esapi.reference.accesscontrol.ExperimentalAccessController(java.util.Map);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc           #2                  // String DefaultAccessController
       7: invokestatic  #3                  // Method org/owasp/esapi/ESAPI.getLogger:(Ljava/lang/String;)Lorg/owasp/esapi/Logger;
      10: putfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
      13: aload_0
      14: aload_1
      15: putfield      #5                  // Field ruleMap:Ljava/util/Map;
      18: return

  public org.owasp.esapi.reference.accesscontrol.ExperimentalAccessController() throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc           #2                  // String DefaultAccessController
       7: invokestatic  #3                  // Method org/owasp/esapi/ESAPI.getLogger:(Ljava/lang/String;)Lorg/owasp/esapi/Logger;
      10: putfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
      13: new           #6                  // class org/owasp/esapi/reference/accesscontrol/policyloader/ACRPolicyFileLoader
      16: dup
      17: invokespecial #7                  // Method org/owasp/esapi/reference/accesscontrol/policyloader/ACRPolicyFileLoader."<init>":()V
      20: astore_1
      21: aload_1
      22: invokevirtual #8                  // Method org/owasp/esapi/reference/accesscontrol/policyloader/ACRPolicyFileLoader.load:()Lorg/owasp/esapi/reference/accesscontrol/policyloader/PolicyDTO;
      25: astore_2
      26: aload_0
      27: aload_2
      28: invokevirtual #9                  // Method org/owasp/esapi/reference/accesscontrol/policyloader/PolicyDTO.getAccessControlRules:()Ljava/util/Map;
      31: putfield      #5                  // Field ruleMap:Ljava/util/Map;
      34: return

  public boolean isAuthorized(java.lang.Object, java.lang.Object);
    Code:
       0: aload_0
       1: getfield      #5                  // Field ruleMap:Ljava/util/Map;
       4: aload_1
       5: invokeinterface #10,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      10: checkcast     #11                 // class org/owasp/esapi/AccessControlRule
      13: astore_3
      14: aload_3
      15: ifnonnull     47
      18: new           #12                 // class org/owasp/esapi/errors/AccessControlException
      21: dup
      22: ldc           #13                 // String Access Denied
      24: new           #14                 // class java/lang/StringBuilder
      27: dup
      28: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
      31: ldc           #16                 // String AccessControlRule was not found for key:
      33: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      36: aload_1
      37: invokevirtual #18                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      40: invokevirtual #19                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      43: invokespecial #20                 // Method org/owasp/esapi/errors/AccessControlException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      46: athrow
      47: aload_0
      48: getfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
      51: invokeinterface #21,  1           // InterfaceMethod org/owasp/esapi/Logger.isDebugEnabled:()Z
      56: ifeq          105
      59: aload_0
      60: getfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
      63: getstatic     #22                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      66: new           #14                 // class java/lang/StringBuilder
      69: dup
      70: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
      73: ldc           #23                 // String Evaluating Authorization Rule \"
      75: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      78: aload_1
      79: invokevirtual #18                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      82: ldc           #24                 // String \" Using class:
      84: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      87: aload_3
      88: invokevirtual #25                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      91: invokevirtual #26                 // Method java/lang/Class.getCanonicalName:()Ljava/lang/String;
      94: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      97: invokevirtual #19                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     100: invokeinterface #27,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     105: aload_3
     106: aload_2
     107: invokeinterface #28,  2           // InterfaceMethod org/owasp/esapi/AccessControlRule.isAuthorized:(Ljava/lang/Object;)Z
     112: ireturn
     113: astore_3
     114: new           #12                 // class org/owasp/esapi/errors/AccessControlException
     117: dup
     118: ldc           #13                 // String Access Denied
     120: ldc           #30                 // String An unhandled Exception was caught, so access is denied.
     122: aload_3
     123: invokespecial #31                 // Method org/owasp/esapi/errors/AccessControlException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
     126: athrow
     127: astore        4
     129: iconst_0
     130: ireturn
    Exception table:
       from    to  target type
           0   112   113   Class java/lang/Exception
         114   127   127   Class org/owasp/esapi/errors/AccessControlException

  public void assertAuthorized(java.lang.Object, java.lang.Object) throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: iconst_0
       1: istore_3
       2: aload_0
       3: getfield      #5                  // Field ruleMap:Ljava/util/Map;
       6: aload_1
       7: invokeinterface #10,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      12: checkcast     #11                 // class org/owasp/esapi/AccessControlRule
      15: astore        4
      17: aload         4
      19: ifnonnull     51
      22: new           #12                 // class org/owasp/esapi/errors/AccessControlException
      25: dup
      26: ldc           #13                 // String Access Denied
      28: new           #14                 // class java/lang/StringBuilder
      31: dup
      32: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
      35: ldc           #16                 // String AccessControlRule was not found for key:
      37: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      40: aload_1
      41: invokevirtual #18                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      44: invokevirtual #19                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      47: invokespecial #20                 // Method org/owasp/esapi/errors/AccessControlException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      50: athrow
      51: aload_0
      52: getfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
      55: invokeinterface #21,  1           // InterfaceMethod org/owasp/esapi/Logger.isDebugEnabled:()Z
      60: ifeq          110
      63: aload_0
      64: getfield      #4                  // Field logger:Lorg/owasp/esapi/Logger;
      67: getstatic     #22                 // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      70: new           #14                 // class java/lang/StringBuilder
      73: dup
      74: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
      77: ldc           #32                 // String Asserting Authorization Rule \"
      79: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      82: aload_1
      83: invokevirtual #18                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      86: ldc           #24                 // String \" Using class:
      88: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      91: aload         4
      93: invokevirtual #25                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      96: invokevirtual #26                 // Method java/lang/Class.getCanonicalName:()Ljava/lang/String;
      99: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     102: invokevirtual #19                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     105: invokeinterface #27,  3           // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
     110: aload         4
     112: aload_2
     113: invokeinterface #28,  2           // InterfaceMethod org/owasp/esapi/AccessControlRule.isAuthorized:(Ljava/lang/Object;)Z
     118: istore_3
     119: goto          138
     122: astore        4
     124: new           #12                 // class org/owasp/esapi/errors/AccessControlException
     127: dup
     128: ldc           #13                 // String Access Denied
     130: ldc           #33                 // String An unhandled Exception was caught, so access is denied.AccessControlException.
     132: aload         4
     134: invokespecial #31                 // Method org/owasp/esapi/errors/AccessControlException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
     137: athrow
     138: iload_3
     139: ifne          180
     142: new           #12                 // class org/owasp/esapi/errors/AccessControlException
     145: dup
     146: ldc           #13                 // String Access Denied
     148: new           #14                 // class java/lang/StringBuilder
     151: dup
     152: invokespecial #15                 // Method java/lang/StringBuilder."<init>":()V
     155: ldc           #34                 // String Access Denied for key:
     157: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     160: aload_1
     161: invokevirtual #18                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     164: ldc           #35                 // String  runtimeParameter:
     166: invokevirtual #17                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     169: aload_2
     170: invokevirtual #18                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     173: invokevirtual #19                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     176: invokespecial #20                 // Method org/owasp/esapi/errors/AccessControlException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     179: athrow
     180: return
    Exception table:
       from    to  target type
           2   119   122   Class java/lang/Exception

  public void assertAuthorizedForData(java.lang.String, java.lang.Object) throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: aload_0
       1: ldc           #36                 // String AC 1.0 Data
       3: iconst_2
       4: anewarray     #37                 // class java/lang/Object
       7: dup
       8: iconst_0
       9: aload_1
      10: aastore
      11: dup
      12: iconst_1
      13: aload_2
      14: aastore
      15: invokevirtual #38                 // Method assertAuthorized:(Ljava/lang/Object;Ljava/lang/Object;)V
      18: return

  public void assertAuthorizedForFile(java.lang.String) throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: aload_0
       1: ldc           #39                 // String AC 1.0 File
       3: iconst_1
       4: anewarray     #37                 // class java/lang/Object
       7: dup
       8: iconst_0
       9: aload_1
      10: aastore
      11: invokevirtual #38                 // Method assertAuthorized:(Ljava/lang/Object;Ljava/lang/Object;)V
      14: return

  public void assertAuthorizedForFunction(java.lang.String) throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: aload_0
       1: ldc           #40                 // String AC 1.0 Function
       3: iconst_1
       4: anewarray     #37                 // class java/lang/Object
       7: dup
       8: iconst_0
       9: aload_1
      10: aastore
      11: invokevirtual #38                 // Method assertAuthorized:(Ljava/lang/Object;Ljava/lang/Object;)V
      14: return

  public void assertAuthorizedForService(java.lang.String) throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: aload_0
       1: ldc           #41                 // String AC 1.0 Service
       3: iconst_1
       4: anewarray     #37                 // class java/lang/Object
       7: dup
       8: iconst_0
       9: aload_1
      10: aastore
      11: invokevirtual #38                 // Method assertAuthorized:(Ljava/lang/Object;Ljava/lang/Object;)V
      14: return

  public void assertAuthorizedForURL(java.lang.String) throws org.owasp.esapi.errors.AccessControlException;
    Code:
       0: aload_0
       1: ldc           #42                 // String AC 1.0 URL
       3: iconst_1
       4: anewarray     #37                 // class java/lang/Object
       7: dup
       8: iconst_0
       9: aload_1
      10: aastore
      11: invokevirtual #38                 // Method assertAuthorized:(Ljava/lang/Object;Ljava/lang/Object;)V
      14: return

  public boolean isAuthorizedForData(java.lang.String, java.lang.Object);
    Code:
       0: aload_0
       1: ldc           #36                 // String AC 1.0 Data
       3: iconst_2
       4: anewarray     #37                 // class java/lang/Object
       7: dup
       8: iconst_0
       9: aload_1
      10: aastore
      11: dup
      12: iconst_1
      13: aload_2
      14: aastore
      15: invokevirtual #43                 // Method isAuthorized:(Ljava/lang/Object;Ljava/lang/Object;)Z
      18: ireturn

  public boolean isAuthorizedForFile(java.lang.String);
    Code:
       0: aload_0
       1: ldc           #39                 // String AC 1.0 File
       3: iconst_1
       4: anewarray     #37                 // class java/lang/Object
       7: dup
       8: iconst_0
       9: aload_1
      10: aastore
      11: invokevirtual #43                 // Method isAuthorized:(Ljava/lang/Object;Ljava/lang/Object;)Z
      14: ireturn

  public boolean isAuthorizedForFunction(java.lang.String);
    Code:
       0: aload_0
       1: ldc           #40                 // String AC 1.0 Function
       3: iconst_1
       4: anewarray     #37                 // class java/lang/Object
       7: dup
       8: iconst_0
       9: aload_1
      10: aastore
      11: invokevirtual #43                 // Method isAuthorized:(Ljava/lang/Object;Ljava/lang/Object;)Z
      14: ireturn

  public boolean isAuthorizedForService(java.lang.String);
    Code:
       0: aload_0
       1: ldc           #41                 // String AC 1.0 Service
       3: iconst_1
       4: anewarray     #37                 // class java/lang/Object
       7: dup
       8: iconst_0
       9: aload_1
      10: aastore
      11: invokevirtual #43                 // Method isAuthorized:(Ljava/lang/Object;Ljava/lang/Object;)Z
      14: ireturn

  public boolean isAuthorizedForURL(java.lang.String);
    Code:
       0: aload_0
       1: ldc           #42                 // String AC 1.0 URL
       3: iconst_1
       4: anewarray     #37                 // class java/lang/Object
       7: dup
       8: iconst_0
       9: aload_1
      10: aastore
      11: invokevirtual #43                 // Method isAuthorized:(Ljava/lang/Object;Ljava/lang/Object;)Z
      14: ireturn
}
