Compiled from "RequestRateThrottleFilter.java"
public class org.owasp.esapi.filters.RequestRateThrottleFilter implements javax.servlet.Filter {
  private int hits;

  private int period;

  private static final java.lang.String HITS;

  private static final java.lang.String PERIOD;

  public org.owasp.esapi.filters.RequestRateThrottleFilter();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iconst_5
       6: putfield      #2                  // Field hits:I
       9: aload_0
      10: bipush        10
      12: putfield      #3                  // Field period:I
      15: return

  public void init(javax.servlet.FilterConfig);
    Code:
       0: aload_0
       1: aload_1
       2: ldc           #4                  // String hits
       4: invokeinterface #5,  2            // InterfaceMethod javax/servlet/FilterConfig.getInitParameter:(Ljava/lang/String;)Ljava/lang/String;
       9: invokestatic  #6                  // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
      12: putfield      #2                  // Field hits:I
      15: aload_0
      16: aload_1
      17: ldc           #7                  // String period
      19: invokeinterface #5,  2            // InterfaceMethod javax/servlet/FilterConfig.getInitParameter:(Ljava/lang/String;)Ljava/lang/String;
      24: invokestatic  #6                  // Method java/lang/Integer.parseInt:(Ljava/lang/String;)I
      27: putfield      #3                  // Field period:I
      30: return

  public void doFilter(javax.servlet.ServletRequest, javax.servlet.ServletResponse, javax.servlet.FilterChain) throws java.io.IOException, javax.servlet.ServletException;
    Code:
       0: aload_1
       1: checkcast     #8                  // class javax/servlet/http/HttpServletRequest
       4: astore        4
       6: aload         4
       8: iconst_1
       9: invokeinterface #9,  2            // InterfaceMethod javax/servlet/http/HttpServletRequest.getSession:(Z)Ljavax/servlet/http/HttpSession;
      14: astore        5
      16: aload         5
      18: invokeinterface #10,  1           // InterfaceMethod javax/servlet/http/HttpSession.getId:()Ljava/lang/String;
      23: invokevirtual #11                 // Method java/lang/String.intern:()Ljava/lang/String;
      26: dup
      27: astore        6
      29: monitorenter
      30: invokestatic  #12                 // Method org/owasp/esapi/ESAPI.httpUtilities:()Lorg/owasp/esapi/HTTPUtilities;
      33: ldc           #13                 // String times
      35: invokeinterface #14,  2           // InterfaceMethod org/owasp/esapi/HTTPUtilities.getSessionAttribute:(Ljava/lang/String;)Ljava/lang/Object;
      40: checkcast     #15                 // class java/util/Stack
      43: astore        7
      45: aload         7
      47: ifnonnull     84
      50: new           #15                 // class java/util/Stack
      53: dup
      54: invokespecial #16                 // Method java/util/Stack."<init>":()V
      57: astore        7
      59: aload         7
      61: new           #17                 // class java/util/Date
      64: dup
      65: lconst_0
      66: invokespecial #18                 // Method java/util/Date."<init>":(J)V
      69: invokevirtual #19                 // Method java/util/Stack.push:(Ljava/lang/Object;)Ljava/lang/Object;
      72: pop
      73: aload         5
      75: ldc           #13                 // String times
      77: aload         7
      79: invokeinterface #20,  3           // InterfaceMethod javax/servlet/http/HttpSession.setAttribute:(Ljava/lang/String;Ljava/lang/Object;)V
      84: aload         7
      86: new           #17                 // class java/util/Date
      89: dup
      90: invokespecial #21                 // Method java/util/Date."<init>":()V
      93: invokevirtual #19                 // Method java/util/Stack.push:(Ljava/lang/Object;)Ljava/lang/Object;
      96: pop
      97: aload         7
      99: invokevirtual #22                 // Method java/util/Stack.size:()I
     102: aload_0
     103: getfield      #2                  // Field hits:I
     106: if_icmplt     115
     109: aload         7
     111: iconst_0
     112: invokevirtual #23                 // Method java/util/Stack.removeElementAt:(I)V
     115: aload         7
     117: aload         7
     119: invokevirtual #22                 // Method java/util/Stack.size:()I
     122: iconst_1
     123: isub
     124: invokevirtual #24                 // Method java/util/Stack.get:(I)Ljava/lang/Object;
     127: checkcast     #17                 // class java/util/Date
     130: astore        8
     132: aload         7
     134: iconst_0
     135: invokevirtual #24                 // Method java/util/Stack.get:(I)Ljava/lang/Object;
     138: checkcast     #17                 // class java/util/Date
     141: astore        9
     143: aload         8
     145: invokevirtual #25                 // Method java/util/Date.getTime:()J
     148: aload         9
     150: invokevirtual #25                 // Method java/util/Date.getTime:()J
     153: lsub
     154: lstore        10
     156: lload         10
     158: aload_0
     159: getfield      #3                  // Field period:I
     162: sipush        1000
     165: imul
     166: i2l
     167: lcmp
     168: ifge          186
     171: aload_2
     172: invokeinterface #26,  1           // InterfaceMethod javax/servlet/ServletResponse.getWriter:()Ljava/io/PrintWriter;
     177: ldc           #27                 // String Request rate too high
     179: invokevirtual #28                 // Method java/io/PrintWriter.println:(Ljava/lang/String;)V
     182: aload         6
     184: monitorexit
     185: return
     186: aload         6
     188: monitorexit
     189: goto          200
     192: astore        12
     194: aload         6
     196: monitorexit
     197: aload         12
     199: athrow
     200: aload_3
     201: aload_1
     202: aload_2
     203: invokeinterface #29,  3           // InterfaceMethod javax/servlet/FilterChain.doFilter:(Ljavax/servlet/ServletRequest;Ljavax/servlet/ServletResponse;)V
     208: return
    Exception table:
       from    to  target type
          30   185   192   any
         186   189   192   any
         192   197   192   any

  public void destroy();
    Code:
       0: return
}
