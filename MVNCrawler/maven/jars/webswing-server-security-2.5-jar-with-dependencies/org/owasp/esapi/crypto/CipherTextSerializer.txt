Compiled from "CipherTextSerializer.java"
public class org.owasp.esapi.crypto.CipherTextSerializer {
  public static final int cipherTextSerializerVersion;

  private static final long serialVersionUID;

  private static final org.owasp.esapi.Logger logger;

  private org.owasp.esapi.crypto.CipherText cipherText_;

  static final boolean $assertionsDisabled;

  public org.owasp.esapi.crypto.CipherTextSerializer(org.owasp.esapi.crypto.CipherText);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
       9: getstatic     #3                  // Field $assertionsDisabled:Z
      12: ifne          29
      15: aload_1
      16: ifnonnull     29
      19: new           #4                  // class java/lang/AssertionError
      22: dup
      23: ldc           #5                  // String CipherText object must not be null.
      25: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      28: athrow
      29: aload_0
      30: aload_1
      31: putfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
      34: return

  public org.owasp.esapi.crypto.CipherTextSerializer(byte[]) throws org.owasp.esapi.errors.EncryptionException;
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
       9: aload_0
      10: aload_0
      11: aload_1
      12: invokespecial #7                  // Method convertToCipherText:([B)Lorg/owasp/esapi/crypto/CipherText;
      15: putfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
      18: return

  public byte[] asSerializedByteArray();
    Code:
       0: aload_0
       1: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
       4: invokevirtual #8                  // Method org/owasp/esapi/crypto/CipherText.getKDFInfo:()I
       7: istore_1
       8: aload_0
       9: new           #9                  // class java/lang/StringBuilder
      12: dup
      13: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
      16: ldc           #11                 // String asSerializedByteArray: kdfInfo =
      18: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      21: iload_1
      22: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      25: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      28: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
      31: aload_0
      32: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
      35: invokevirtual #16                 // Method org/owasp/esapi/crypto/CipherText.getEncryptionTimestamp:()J
      38: lstore_2
      39: aload_0
      40: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
      43: invokevirtual #17                 // Method org/owasp/esapi/crypto/CipherText.getCipherTransformation:()Ljava/lang/String;
      46: astore        4
      48: getstatic     #3                  // Field $assertionsDisabled:Z
      51: ifne          77
      54: aload_0
      55: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
      58: invokevirtual #18                 // Method org/owasp/esapi/crypto/CipherText.getKeySize:()I
      61: sipush        32767
      64: if_icmplt     77
      67: new           #4                  // class java/lang/AssertionError
      70: dup
      71: ldc           #19                 // String Key size too large. Max is 32767
      73: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      76: athrow
      77: aload_0
      78: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
      81: invokevirtual #18                 // Method org/owasp/esapi/crypto/CipherText.getKeySize:()I
      84: i2s
      85: istore        5
      87: getstatic     #3                  // Field $assertionsDisabled:Z
      90: ifne          116
      93: aload_0
      94: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
      97: invokevirtual #20                 // Method org/owasp/esapi/crypto/CipherText.getBlockSize:()I
     100: sipush        32767
     103: if_icmplt     116
     106: new           #4                  // class java/lang/AssertionError
     109: dup
     110: ldc           #21                 // String Block size too large. Max is 32767
     112: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
     115: athrow
     116: aload_0
     117: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
     120: invokevirtual #20                 // Method org/owasp/esapi/crypto/CipherText.getBlockSize:()I
     123: i2s
     124: istore        6
     126: aload_0
     127: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
     130: invokevirtual #22                 // Method org/owasp/esapi/crypto/CipherText.getIV:()[B
     133: astore        7
     135: getstatic     #3                  // Field $assertionsDisabled:Z
     138: ifne          160
     141: aload         7
     143: arraylength
     144: sipush        32767
     147: if_icmplt     160
     150: new           #4                  // class java/lang/AssertionError
     153: dup
     154: ldc           #23                 // String IV size too large. Max is 32767
     156: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
     159: athrow
     160: aload         7
     162: arraylength
     163: i2s
     164: istore        8
     166: aload_0
     167: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
     170: invokevirtual #24                 // Method org/owasp/esapi/crypto/CipherText.getRawCipherText:()[B
     173: astore        9
     175: aload         9
     177: arraylength
     178: istore        10
     180: getstatic     #3                  // Field $assertionsDisabled:Z
     183: ifne          202
     186: iload         10
     188: iconst_1
     189: if_icmpge     202
     192: new           #4                  // class java/lang/AssertionError
     195: dup
     196: ldc           #25                 // String Raw ciphertext length must be >= 1 byte.
     198: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
     201: athrow
     202: aload_0
     203: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
     206: invokevirtual #26                 // Method org/owasp/esapi/crypto/CipherText.getSeparateMAC:()[B
     209: astore        11
     211: getstatic     #3                  // Field $assertionsDisabled:Z
     214: ifne          236
     217: aload         11
     219: arraylength
     220: sipush        32767
     223: if_icmplt     236
     226: new           #4                  // class java/lang/AssertionError
     229: dup
     230: ldc           #27                 // String MAC length too large. Max is 32767
     232: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
     235: athrow
     236: aload         11
     238: arraylength
     239: i2s
     240: istore        12
     242: aload_0
     243: iload_1
     244: lload_2
     245: aload         4
     247: iload         5
     249: iload         6
     251: iload         8
     253: aload         7
     255: iload         10
     257: aload         9
     259: iload         12
     261: aload         11
     263: invokespecial #28                 // Method computeSerialization:(IJLjava/lang/String;SSS[BI[BS[B)[B
     266: astore        13
     268: aload         13
     270: areturn

  public org.owasp.esapi.crypto.CipherText asCipherText();
    Code:
       0: aload_0
       1: getfield      #2                  // Field cipherText_:Lorg/owasp/esapi/crypto/CipherText;
       4: areturn

  private byte[] computeSerialization(int, long, java.lang.String, short, short, short, byte[], int, byte[], short, byte[]);
    Code:
       0: aload_0
       1: new           #9                  // class java/lang/StringBuilder
       4: dup
       5: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
       8: ldc           #29                 // String computeSerialization: kdfInfo =
      10: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      13: iload_1
      14: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      17: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      20: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
      23: aload_0
      24: new           #9                  // class java/lang/StringBuilder
      27: dup
      28: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
      31: ldc           #30                 // String computeSerialization: timestamp =
      33: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      36: new           #31                 // class java/util/Date
      39: dup
      40: lload_2
      41: invokespecial #32                 // Method java/util/Date."<init>":(J)V
      44: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      47: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      50: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
      53: aload_0
      54: new           #9                  // class java/lang/StringBuilder
      57: dup
      58: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
      61: ldc           #34                 // String computeSerialization: cipherXform =
      63: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      66: aload         4
      68: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      71: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      74: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
      77: aload_0
      78: new           #9                  // class java/lang/StringBuilder
      81: dup
      82: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
      85: ldc           #35                 // String computeSerialization: keySize =
      87: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      90: iload         5
      92: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      95: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      98: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     101: aload_0
     102: new           #9                  // class java/lang/StringBuilder
     105: dup
     106: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     109: ldc           #36                 // String computeSerialization: blockSize =
     111: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     114: iload         6
     116: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     119: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     122: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     125: aload_0
     126: new           #9                  // class java/lang/StringBuilder
     129: dup
     130: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     133: ldc           #37                 // String computeSerialization: ivLen =
     135: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     138: iload         7
     140: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     143: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     146: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     149: aload_0
     150: new           #9                  // class java/lang/StringBuilder
     153: dup
     154: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     157: ldc           #38                 // String computeSerialization: ciphertextLen =
     159: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     162: iload         9
     164: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     167: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     170: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     173: aload_0
     174: new           #9                  // class java/lang/StringBuilder
     177: dup
     178: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     181: ldc           #39                 // String computeSerialization: macLen =
     183: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     186: iload         11
     188: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     191: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     194: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     197: new           #40                 // class java/io/ByteArrayOutputStream
     200: dup
     201: invokespecial #41                 // Method java/io/ByteArrayOutputStream."<init>":()V
     204: astore        13
     206: aload_0
     207: aload         13
     209: iload_1
     210: invokespecial #42                 // Method writeInt:(Ljava/io/ByteArrayOutputStream;I)V
     213: aload_0
     214: aload         13
     216: lload_2
     217: invokespecial #43                 // Method writeLong:(Ljava/io/ByteArrayOutputStream;J)V
     220: aload         4
     222: ldc           #44                 // String /
     224: invokevirtual #45                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     227: astore        14
     229: getstatic     #3                  // Field $assertionsDisabled:Z
     232: ifne          252
     235: aload         14
     237: arraylength
     238: iconst_3
     239: if_icmpeq     252
     242: new           #4                  // class java/lang/AssertionError
     245: dup
     246: ldc           #46                 // String Malformed cipher transformation
     248: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
     251: athrow
     252: aload_0
     253: aload         13
     255: aload         4
     257: invokespecial #47                 // Method writeString:(Ljava/io/ByteArrayOutputStream;Ljava/lang/String;)V
     260: aload_0
     261: aload         13
     263: iload         5
     265: invokespecial #48                 // Method writeShort:(Ljava/io/ByteArrayOutputStream;S)V
     268: aload_0
     269: aload         13
     271: iload         6
     273: invokespecial #48                 // Method writeShort:(Ljava/io/ByteArrayOutputStream;S)V
     276: aload_0
     277: aload         13
     279: iload         7
     281: invokespecial #48                 // Method writeShort:(Ljava/io/ByteArrayOutputStream;S)V
     284: iload         7
     286: ifle          300
     289: aload         13
     291: aload         8
     293: iconst_0
     294: aload         8
     296: arraylength
     297: invokevirtual #49                 // Method java/io/ByteArrayOutputStream.write:([BII)V
     300: aload_0
     301: aload         13
     303: iload         9
     305: invokespecial #42                 // Method writeInt:(Ljava/io/ByteArrayOutputStream;I)V
     308: aload         13
     310: aload         10
     312: iconst_0
     313: aload         10
     315: arraylength
     316: invokevirtual #49                 // Method java/io/ByteArrayOutputStream.write:([BII)V
     319: aload_0
     320: aload         13
     322: iload         11
     324: invokespecial #48                 // Method writeShort:(Ljava/io/ByteArrayOutputStream;S)V
     327: iload         11
     329: ifle          343
     332: aload         13
     334: aload         12
     336: iconst_0
     337: aload         12
     339: arraylength
     340: invokevirtual #49                 // Method java/io/ByteArrayOutputStream.write:([BII)V
     343: aload         13
     345: invokevirtual #50                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     348: areturn

  private void writeString(java.io.ByteArrayOutputStream, java.lang.String);
    Code:
       0: getstatic     #3                  // Field $assertionsDisabled:Z
       3: ifne          25
       6: aload_2
       7: ifnull        17
      10: aload_2
      11: invokevirtual #51                 // Method java/lang/String.length:()I
      14: ifgt          25
      17: new           #4                  // class java/lang/AssertionError
      20: dup
      21: invokespecial #52                 // Method java/lang/AssertionError."<init>":()V
      24: athrow
      25: aload_2
      26: ldc           #53                 // String UTF8
      28: invokevirtual #54                 // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
      31: astore_3
      32: getstatic     #3                  // Field $assertionsDisabled:Z
      35: ifne          56
      38: aload_3
      39: arraylength
      40: sipush        32767
      43: if_icmplt     56
      46: new           #4                  // class java/lang/AssertionError
      49: dup
      50: ldc           #55                 // String writeString: String exceeds max length
      52: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      55: athrow
      56: aload_0
      57: aload_1
      58: aload_3
      59: arraylength
      60: i2s
      61: invokespecial #48                 // Method writeShort:(Ljava/io/ByteArrayOutputStream;S)V
      64: aload_1
      65: aload_3
      66: iconst_0
      67: aload_3
      68: arraylength
      69: invokevirtual #49                 // Method java/io/ByteArrayOutputStream.write:([BII)V
      72: goto          90
      75: astore        4
      77: getstatic     #57                 // Field logger:Lorg/owasp/esapi/Logger;
      80: getstatic     #58                 // Field org/owasp/esapi/Logger.EVENT_FAILURE:Lorg/owasp/esapi/Logger$EventType;
      83: ldc           #59                 // String Ignoring caught UnsupportedEncodingException converting string to UTF8 encoding. Results suspect. Corrupt rt.jar????
      85: invokeinterface #60,  3           // InterfaceMethod org/owasp/esapi/Logger.error:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      90: return
    Exception table:
       from    to  target type
           0    72    75   Class java/io/UnsupportedEncodingException

  private java.lang.String readString(java.io.ByteArrayInputStream, short) throws java.lang.NullPointerException, java.io.IOException;
    Code:
       0: iload_2
       1: newarray       byte
       3: astore_3
       4: aload_1
       5: aload_3
       6: iconst_0
       7: iload_2
       8: invokevirtual #61                 // Method java/io/ByteArrayInputStream.read:([BII)I
      11: istore        4
      13: getstatic     #3                  // Field $assertionsDisabled:Z
      16: ifne          57
      19: iload         4
      21: iload_2
      22: if_icmpeq     57
      25: new           #4                  // class java/lang/AssertionError
      28: dup
      29: new           #9                  // class java/lang/StringBuilder
      32: dup
      33: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
      36: ldc           #62                 // String readString: Failed to read
      38: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      41: iload_2
      42: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      45: ldc           #63                 // String  bytes.
      47: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      50: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      53: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      56: athrow
      57: new           #64                 // class java/lang/String
      60: dup
      61: aload_3
      62: ldc           #53                 // String UTF8
      64: invokespecial #65                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
      67: areturn

  private void writeShort(java.io.ByteArrayOutputStream, short);
    Code:
       0: iload_2
       1: invokestatic  #66                 // Method org/owasp/esapi/util/ByteConversionUtil.fromShort:(S)[B
       4: astore_3
       5: getstatic     #3                  // Field $assertionsDisabled:Z
       8: ifne          25
      11: aload_3
      12: arraylength
      13: iconst_2
      14: if_icmpeq     25
      17: new           #4                  // class java/lang/AssertionError
      20: dup
      21: invokespecial #52                 // Method java/lang/AssertionError."<init>":()V
      24: athrow
      25: aload_1
      26: aload_3
      27: iconst_0
      28: iconst_2
      29: invokevirtual #49                 // Method java/io/ByteArrayOutputStream.write:([BII)V
      32: return

  private short readShort(java.io.ByteArrayInputStream) throws java.lang.NullPointerException, java.lang.IndexOutOfBoundsException;
    Code:
       0: iconst_2
       1: newarray       byte
       3: astore_2
       4: aload_1
       5: aload_2
       6: iconst_0
       7: iconst_2
       8: invokevirtual #61                 // Method java/io/ByteArrayInputStream.read:([BII)I
      11: istore_3
      12: getstatic     #3                  // Field $assertionsDisabled:Z
      15: ifne          33
      18: iload_3
      19: iconst_2
      20: if_icmpeq     33
      23: new           #4                  // class java/lang/AssertionError
      26: dup
      27: ldc           #67                 // String readShort: Failed to read 2 bytes.
      29: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      32: athrow
      33: aload_2
      34: invokestatic  #68                 // Method org/owasp/esapi/util/ByteConversionUtil.toShort:([B)S
      37: ireturn

  private void writeInt(java.io.ByteArrayOutputStream, int);
    Code:
       0: iload_2
       1: invokestatic  #69                 // Method org/owasp/esapi/util/ByteConversionUtil.fromInt:(I)[B
       4: astore_3
       5: aload_1
       6: aload_3
       7: iconst_0
       8: iconst_4
       9: invokevirtual #49                 // Method java/io/ByteArrayOutputStream.write:([BII)V
      12: return

  private int readInt(java.io.ByteArrayInputStream) throws java.lang.NullPointerException, java.lang.IndexOutOfBoundsException;
    Code:
       0: iconst_4
       1: newarray       byte
       3: astore_2
       4: aload_1
       5: aload_2
       6: iconst_0
       7: iconst_4
       8: invokevirtual #61                 // Method java/io/ByteArrayInputStream.read:([BII)I
      11: istore_3
      12: getstatic     #3                  // Field $assertionsDisabled:Z
      15: ifne          33
      18: iload_3
      19: iconst_4
      20: if_icmpeq     33
      23: new           #4                  // class java/lang/AssertionError
      26: dup
      27: ldc           #70                 // String readInt: Failed to read 4 bytes.
      29: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      32: athrow
      33: aload_2
      34: invokestatic  #71                 // Method org/owasp/esapi/util/ByteConversionUtil.toInt:([B)I
      37: ireturn

  private void writeLong(java.io.ByteArrayOutputStream, long);
    Code:
       0: lload_2
       1: invokestatic  #72                 // Method org/owasp/esapi/util/ByteConversionUtil.fromLong:(J)[B
       4: astore        4
       6: getstatic     #3                  // Field $assertionsDisabled:Z
       9: ifne          28
      12: aload         4
      14: arraylength
      15: bipush        8
      17: if_icmpeq     28
      20: new           #4                  // class java/lang/AssertionError
      23: dup
      24: invokespecial #52                 // Method java/lang/AssertionError."<init>":()V
      27: athrow
      28: aload_1
      29: aload         4
      31: iconst_0
      32: bipush        8
      34: invokevirtual #49                 // Method java/io/ByteArrayOutputStream.write:([BII)V
      37: return

  private long readLong(java.io.ByteArrayInputStream) throws java.lang.NullPointerException, java.lang.IndexOutOfBoundsException;
    Code:
       0: bipush        8
       2: newarray       byte
       4: astore_2
       5: aload_1
       6: aload_2
       7: iconst_0
       8: bipush        8
      10: invokevirtual #61                 // Method java/io/ByteArrayInputStream.read:([BII)I
      13: istore_3
      14: getstatic     #3                  // Field $assertionsDisabled:Z
      17: ifne          36
      20: iload_3
      21: bipush        8
      23: if_icmpeq     36
      26: new           #4                  // class java/lang/AssertionError
      29: dup
      30: ldc           #73                 // String readLong: Failed to read 8 bytes.
      32: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      35: athrow
      36: aload_2
      37: invokestatic  #74                 // Method org/owasp/esapi/util/ByteConversionUtil.toLong:([B)J
      40: lreturn

  private org.owasp.esapi.crypto.CipherText convertToCipherText(byte[]) throws org.owasp.esapi.errors.EncryptionException;
    Code:
       0: getstatic     #3                  // Field $assertionsDisabled:Z
       3: ifne          20
       6: aload_1
       7: ifnonnull     20
      10: new           #4                  // class java/lang/AssertionError
      13: dup
      14: ldc           #75                 // String cipherTextSerializedBytes cannot be null.
      16: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      19: athrow
      20: getstatic     #3                  // Field $assertionsDisabled:Z
      23: ifne          41
      26: aload_1
      27: arraylength
      28: ifgt          41
      31: new           #4                  // class java/lang/AssertionError
      34: dup
      35: ldc           #76                 // String cipherTextSerializedBytes must be > 0 in length.
      37: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
      40: athrow
      41: new           #77                 // class java/io/ByteArrayInputStream
      44: dup
      45: aload_1
      46: invokespecial #78                 // Method java/io/ByteArrayInputStream."<init>":([B)V
      49: astore_2
      50: aload_0
      51: aload_2
      52: invokespecial #79                 // Method readInt:(Ljava/io/ByteArrayInputStream;)I
      55: istore_3
      56: aload_0
      57: new           #9                  // class java/lang/StringBuilder
      60: dup
      61: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
      64: ldc           #80                 // String kdfInfo:
      66: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      69: iload_3
      70: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
      73: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      76: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
      79: iload_3
      80: bipush        28
      82: iushr
      83: istore        4
      85: aload_0
      86: new           #9                  // class java/lang/StringBuilder
      89: dup
      90: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
      93: ldc           #81                 // String kdfPrf:
      95: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      98: iload         4
     100: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     103: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     106: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     109: getstatic     #3                  // Field $assertionsDisabled:Z
     112: ifne          160
     115: iload         4
     117: iflt          127
     120: iload         4
     122: bipush        15
     124: if_icmple     160
     127: new           #4                  // class java/lang/AssertionError
     130: dup
     131: new           #9                  // class java/lang/StringBuilder
     134: dup
     135: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     138: ldc           #82                 // String kdfPrf ==
     140: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     143: iload         4
     145: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     148: ldc           #83                 // String  must be between 0 and 15.
     150: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     153: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     156: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
     159: athrow
     160: iload_3
     161: ldc           #84                 // int 134217727
     163: iand
     164: istore        5
     166: getstatic     #3                  // Field $assertionsDisabled:Z
     169: ifne          217
     172: iload         5
     174: ifle          184
     177: iload         5
     179: ldc           #85                 // int 99991231
     181: if_icmple     217
     184: new           #4                  // class java/lang/AssertionError
     187: dup
     188: new           #9                  // class java/lang/StringBuilder
     191: dup
     192: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     195: ldc           #86                 // String KDF Version (
     197: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     200: iload         5
     202: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     205: ldc           #87                 // String ) out of range.
     207: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     210: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     213: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
     216: athrow
     217: aload_0
     218: new           #9                  // class java/lang/StringBuilder
     221: dup
     222: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     225: ldc           #88                 // String convertToCipherText: kdfPrf =
     227: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     230: iload         4
     232: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     235: ldc           #89                 // String , kdfVers =
     237: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     240: iload         5
     242: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     245: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     248: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     251: iload         5
     253: ldc           #90                 // int 20110203
     255: if_icmpeq     295
     258: new           #91                 // class java/io/InvalidClassException
     261: dup
     262: new           #9                  // class java/lang/StringBuilder
     265: dup
     266: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     269: ldc           #92                 // String This serialized byte stream not compatible with loaded CipherText class. Version read =
     271: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     274: iload_3
     275: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     278: ldc           #93                 // String ; version from loaded CipherText class =
     280: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     283: ldc           #90                 // int 20110203
     285: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     288: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     291: invokespecial #94                 // Method java/io/InvalidClassException."<init>":(Ljava/lang/String;)V
     294: athrow
     295: aload_0
     296: aload_2
     297: invokespecial #95                 // Method readLong:(Ljava/io/ByteArrayInputStream;)J
     300: lstore        6
     302: aload_0
     303: new           #9                  // class java/lang/StringBuilder
     306: dup
     307: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     310: ldc           #96                 // String convertToCipherText: timestamp =
     312: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     315: new           #31                 // class java/util/Date
     318: dup
     319: lload         6
     321: invokespecial #32                 // Method java/util/Date."<init>":(J)V
     324: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     327: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     330: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     333: aload_0
     334: aload_2
     335: invokespecial #97                 // Method readShort:(Ljava/io/ByteArrayInputStream;)S
     338: istore        8
     340: aload_0
     341: new           #9                  // class java/lang/StringBuilder
     344: dup
     345: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     348: ldc           #98                 // String convertToCipherText: length of cipherXform =
     350: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     353: iload         8
     355: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     358: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     361: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     364: aload_0
     365: aload_2
     366: iload         8
     368: invokespecial #99                 // Method readString:(Ljava/io/ByteArrayInputStream;S)Ljava/lang/String;
     371: astore        9
     373: aload_0
     374: new           #9                  // class java/lang/StringBuilder
     377: dup
     378: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     381: ldc           #100                // String convertToCipherText: cipherXform =
     383: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     386: aload         9
     388: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     391: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     394: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     397: aload         9
     399: ldc           #44                 // String /
     401: invokevirtual #45                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     404: astore        10
     406: getstatic     #3                  // Field $assertionsDisabled:Z
     409: ifne          429
     412: aload         10
     414: arraylength
     415: iconst_3
     416: if_icmpeq     429
     419: new           #4                  // class java/lang/AssertionError
     422: dup
     423: ldc           #46                 // String Malformed cipher transformation
     425: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
     428: athrow
     429: aload         10
     431: iconst_1
     432: aaload
     433: astore        11
     435: aload         11
     437: invokestatic  #101                // Method org/owasp/esapi/crypto/CryptoHelper.isAllowedCipherMode:(Ljava/lang/String;)Z
     440: ifne          482
     443: new           #9                  // class java/lang/StringBuilder
     446: dup
     447: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     450: ldc           #102                // String Cipher mode
     452: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     455: aload         11
     457: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     460: ldc           #103                // String  is not an allowed cipher mode
     462: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     465: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     468: astore        12
     470: new           #104                // class org/owasp/esapi/errors/EncryptionException
     473: dup
     474: aload         12
     476: aload         12
     478: invokespecial #105                // Method org/owasp/esapi/errors/EncryptionException."<init>":(Ljava/lang/String;Ljava/lang/String;)V
     481: athrow
     482: aload_0
     483: aload_2
     484: invokespecial #97                 // Method readShort:(Ljava/io/ByteArrayInputStream;)S
     487: istore        12
     489: aload_0
     490: new           #9                  // class java/lang/StringBuilder
     493: dup
     494: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     497: ldc           #106                // String convertToCipherText: keySize =
     499: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     502: iload         12
     504: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     507: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     510: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     513: aload_0
     514: aload_2
     515: invokespecial #97                 // Method readShort:(Ljava/io/ByteArrayInputStream;)S
     518: istore        13
     520: aload_0
     521: new           #9                  // class java/lang/StringBuilder
     524: dup
     525: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     528: ldc           #107                // String convertToCipherText: blockSize =
     530: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     533: iload         13
     535: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     538: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     541: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     544: aload_0
     545: aload_2
     546: invokespecial #97                 // Method readShort:(Ljava/io/ByteArrayInputStream;)S
     549: istore        14
     551: aload_0
     552: new           #9                  // class java/lang/StringBuilder
     555: dup
     556: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     559: ldc           #108                // String convertToCipherText: ivLen =
     561: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     564: iload         14
     566: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     569: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     572: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     575: aconst_null
     576: astore        15
     578: iload         14
     580: ifle          600
     583: iload         14
     585: newarray       byte
     587: astore        15
     589: aload_2
     590: aload         15
     592: iconst_0
     593: aload         15
     595: arraylength
     596: invokevirtual #61                 // Method java/io/ByteArrayInputStream.read:([BII)I
     599: pop
     600: aload_0
     601: aload_2
     602: invokespecial #79                 // Method readInt:(Ljava/io/ByteArrayInputStream;)I
     605: istore        16
     607: aload_0
     608: new           #9                  // class java/lang/StringBuilder
     611: dup
     612: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     615: ldc           #109                // String convertToCipherText: ciphertextLen =
     617: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     620: iload         16
     622: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     625: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     628: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     631: getstatic     #3                  // Field $assertionsDisabled:Z
     634: ifne          652
     637: iload         16
     639: ifgt          652
     642: new           #4                  // class java/lang/AssertionError
     645: dup
     646: ldc           #110                // String convertToCipherText: Invalid cipher text length
     648: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
     651: athrow
     652: iload         16
     654: newarray       byte
     656: astore        17
     658: aload_2
     659: aload         17
     661: iconst_0
     662: aload         17
     664: arraylength
     665: invokevirtual #61                 // Method java/io/ByteArrayInputStream.read:([BII)I
     668: pop
     669: aload_0
     670: aload_2
     671: invokespecial #97                 // Method readShort:(Ljava/io/ByteArrayInputStream;)S
     674: istore        18
     676: aload_0
     677: new           #9                  // class java/lang/StringBuilder
     680: dup
     681: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     684: ldc           #111                // String convertToCipherText: macLen =
     686: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     689: iload         18
     691: invokevirtual #13                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     694: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     697: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     700: aconst_null
     701: astore        19
     703: iload         18
     705: ifle          725
     708: iload         18
     710: newarray       byte
     712: astore        19
     714: aload_2
     715: aload         19
     717: iconst_0
     718: aload         19
     720: arraylength
     721: invokevirtual #61                 // Method java/io/ByteArrayInputStream.read:([BII)I
     724: pop
     725: new           #112                // class org/owasp/esapi/crypto/CipherSpec
     728: dup
     729: aload         9
     731: iload         12
     733: invokespecial #113                // Method org/owasp/esapi/crypto/CipherSpec."<init>":(Ljava/lang/String;I)V
     736: astore        20
     738: aload         20
     740: iload         13
     742: invokevirtual #114                // Method org/owasp/esapi/crypto/CipherSpec.setBlockSize:(I)Lorg/owasp/esapi/crypto/CipherSpec;
     745: pop
     746: aload         20
     748: aload         15
     750: invokevirtual #115                // Method org/owasp/esapi/crypto/CipherSpec.setIV:([B)Lorg/owasp/esapi/crypto/CipherSpec;
     753: pop
     754: aload_0
     755: new           #9                  // class java/lang/StringBuilder
     758: dup
     759: invokespecial #10                 // Method java/lang/StringBuilder."<init>":()V
     762: ldc           #116                // String convertToCipherText: CipherSpec:
     764: invokevirtual #12                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     767: aload         20
     769: invokevirtual #33                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     772: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     775: invokespecial #15                 // Method debug:(Ljava/lang/String;)V
     778: new           #117                // class org/owasp/esapi/crypto/CipherText
     781: dup
     782: aload         20
     784: invokespecial #118                // Method org/owasp/esapi/crypto/CipherText."<init>":(Lorg/owasp/esapi/crypto/CipherSpec;)V
     787: astore        21
     789: getstatic     #3                  // Field $assertionsDisabled:Z
     792: ifne          818
     795: iload         14
     797: ifle          808
     800: aload         21
     802: invokevirtual #119                // Method org/owasp/esapi/crypto/CipherText.requiresIV:()Z
     805: ifne          818
     808: new           #4                  // class java/lang/AssertionError
     811: dup
     812: ldc           #120                // String convertToCipherText: Mismatch between IV length and cipher mode.
     814: invokespecial #6                  // Method java/lang/AssertionError."<init>":(Ljava/lang/Object;)V
     817: athrow
     818: aload         21
     820: aload         17
     822: invokevirtual #121                // Method org/owasp/esapi/crypto/CipherText.setCiphertext:([B)V
     825: aload         21
     827: lload         6
     829: invokevirtual #122                // Method org/owasp/esapi/crypto/CipherText.setEncryptionTimestamp:(J)V
     832: iload         18
     834: ifle          844
     837: aload         21
     839: aload         19
     841: invokevirtual #123                // Method org/owasp/esapi/crypto/CipherText.storeSeparateMAC:([B)V
     844: aload         21
     846: areturn
     847: astore_2
     848: new           #104                // class org/owasp/esapi/errors/EncryptionException
     851: dup
     852: ldc           #124                // String Cannot deserialize byte array into CipherText object
     854: ldc           #124                // String Cannot deserialize byte array into CipherText object
     856: aload_2
     857: invokespecial #125                // Method org/owasp/esapi/errors/EncryptionException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
     860: athrow
     861: astore_2
     862: new           #104                // class org/owasp/esapi/errors/EncryptionException
     865: dup
     866: ldc           #124                // String Cannot deserialize byte array into CipherText object
     868: ldc           #124                // String Cannot deserialize byte array into CipherText object
     870: aload_2
     871: invokespecial #125                // Method org/owasp/esapi/errors/EncryptionException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
     874: athrow
    Exception table:
       from    to  target type
           0   846   847   Class org/owasp/esapi/errors/EncryptionException
           0   846   861   Class java/io/IOException

  private void debug(java.lang.String);
    Code:
       0: getstatic     #57                 // Field logger:Lorg/owasp/esapi/Logger;
       3: invokeinterface #127,  1          // InterfaceMethod org/owasp/esapi/Logger.isDebugEnabled:()Z
       8: ifeq          23
      11: getstatic     #57                 // Field logger:Lorg/owasp/esapi/Logger;
      14: getstatic     #128                // Field org/owasp/esapi/Logger.EVENT_SUCCESS:Lorg/owasp/esapi/Logger$EventType;
      17: aload_1
      18: invokeinterface #129,  3          // InterfaceMethod org/owasp/esapi/Logger.debug:(Lorg/owasp/esapi/Logger$EventType;Ljava/lang/String;)V
      23: return

  static {};
    Code:
       0: ldc_w         #130                // class org/owasp/esapi/crypto/CipherTextSerializer
       3: invokevirtual #131                // Method java/lang/Class.desiredAssertionStatus:()Z
       6: ifne          13
       9: iconst_1
      10: goto          14
      13: iconst_0
      14: putstatic     #3                  // Field $assertionsDisabled:Z
      17: ldc           #132                // String CipherTextSerializer
      19: invokestatic  #133                // Method org/owasp/esapi/ESAPI.getLogger:(Ljava/lang/String;)Lorg/owasp/esapi/Logger;
      22: putstatic     #57                 // Field logger:Lorg/owasp/esapi/Logger;
      25: return
}
