public class org.bouncycastle.crypto.tls.TlsServerProtocol extends org.bouncycastle.crypto.tls.TlsProtocol {
  protected org.bouncycastle.crypto.tls.TlsServer tlsServer;

  protected org.bouncycastle.crypto.tls.TlsServerContextImpl tlsServerContext;

  protected org.bouncycastle.crypto.tls.TlsKeyExchange keyExchange;

  protected org.bouncycastle.crypto.tls.TlsCredentials serverCredentials;

  protected org.bouncycastle.crypto.tls.CertificateRequest certificateRequest;

  protected short clientCertificateType;

  protected org.bouncycastle.crypto.tls.TlsHandshakeHash prepareFinishHash;

  public org.bouncycastle.crypto.tls.TlsServerProtocol(java.io.InputStream, java.io.OutputStream, java.security.SecureRandom);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: invokespecial #576                // Method org/bouncycastle/crypto/tls/TlsProtocol."<init>":(Ljava/io/InputStream;Ljava/io/OutputStream;Ljava/security/SecureRandom;)V
       7: aload_0
       8: aconst_null
       9: putfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      12: aload_0
      13: aconst_null
      14: putfield      #534                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
      17: aload_0
      18: aconst_null
      19: putfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      22: aload_0
      23: aconst_null
      24: putfield      #530                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
      27: aload_0
      28: aconst_null
      29: putfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      32: aload_0
      33: iconst_m1
      34: putfield      #514                // Field clientCertificateType:S
      37: aload_0
      38: aconst_null
      39: putfield      #531                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      42: return

  public void accept(org.bouncycastle.crypto.tls.TlsServer) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #223                // class java/lang/IllegalArgumentException
       7: dup
       8: ldc           #2                  // String \'tlsServer\' cannot be null
      10: invokespecial #537                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      13: athrow
      14: aload_0
      15: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      18: ifnull        31
      21: new           #224                // class java/lang/IllegalStateException
      24: dup
      25: ldc           #1                  // String \'accept\' can only be called once
      27: invokespecial #539                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      30: athrow
      31: aload_0
      32: aload_1
      33: putfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      36: aload_0
      37: new           #235                // class org/bouncycastle/crypto/tls/SecurityParameters
      40: dup
      41: invokespecial #567                // Method org/bouncycastle/crypto/tls/SecurityParameters."<init>":()V
      44: putfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      47: aload_0
      48: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      51: iconst_0
      52: putfield      #503                // Field org/bouncycastle/crypto/tls/SecurityParameters.entity:I
      55: aload_0
      56: new           #246                // class org/bouncycastle/crypto/tls/TlsServerContextImpl
      59: dup
      60: aload_0
      61: getfield      #523                // Field secureRandom:Ljava/security/SecureRandom;
      64: aload_0
      65: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      68: invokespecial #582                // Method org/bouncycastle/crypto/tls/TlsServerContextImpl."<init>":(Ljava/security/SecureRandom;Lorg/bouncycastle/crypto/tls/SecurityParameters;)V
      71: putfield      #534                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
      74: aload_0
      75: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      78: aload_1
      79: invokeinterface #654,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.shouldUseGMTUnixTime:()Z
      84: aload_0
      85: getfield      #534                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
      88: invokevirtual #581                // Method org/bouncycastle/crypto/tls/TlsServerContextImpl.getNonceRandomGenerator:()Lorg/bouncycastle/crypto/prng/RandomGenerator;
      91: invokestatic  #599                // Method createRandomBlock:(ZLorg/bouncycastle/crypto/prng/RandomGenerator;)[B
      94: putfield      #511                // Field org/bouncycastle/crypto/tls/SecurityParameters.serverRandom:[B
      97: aload_0
      98: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     101: aload_0
     102: getfield      #534                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
     105: invokeinterface #670,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.init:(Lorg/bouncycastle/crypto/tls/TlsServerContext;)V
     110: aload_0
     111: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     114: aload_0
     115: getfield      #534                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
     118: invokevirtual #562                // Method org/bouncycastle/crypto/tls/RecordStream.init:(Lorg/bouncycastle/crypto/tls/TlsContext;)V
     121: aload_0
     122: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     125: iconst_0
     126: invokevirtual #559                // Method org/bouncycastle/crypto/tls/RecordStream.setRestrictReadVersion:(Z)V
     129: aload_0
     130: invokevirtual #583                // Method completeHandshake:()V
     133: return

  protected void cleanupHandshake();
    Code:
       0: aload_0
       1: invokespecial #573                // Method org/bouncycastle/crypto/tls/TlsProtocol.cleanupHandshake:()V
       4: aload_0
       5: aconst_null
       6: putfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
       9: aload_0
      10: aconst_null
      11: putfield      #530                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
      14: aload_0
      15: aconst_null
      16: putfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      19: aload_0
      20: aconst_null
      21: putfield      #531                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      24: return

  protected org.bouncycastle.crypto.tls.AbstractTlsContext getContext();
    Code:
       0: aload_0
       1: getfield      #534                // Field tlsServerContext:Lorg/bouncycastle/crypto/tls/TlsServerContextImpl;
       4: areturn

  protected org.bouncycastle.crypto.tls.TlsPeer getPeer();
    Code:
       0: aload_0
       1: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
       4: areturn

  protected void handleHandshakeMessage(short, byte[]) throws java.io.IOException;
    Code:
       0: new           #220                // class java/io/ByteArrayInputStream
       3: dup
       4: aload_2
       5: invokespecial #536                // Method java/io/ByteArrayInputStream."<init>":([B)V
       8: astore_3
       9: iload_1
      10: tableswitch   { // 0 to 23
                     0: 927
                     1: 120
                     2: 927
                     3: 927
                     4: 927
                     5: 927
                     6: 927
                     7: 927
                     8: 927
                     9: 927
                    10: 927
                    11: 528
                    12: 927
                    13: 927
                    14: 927
                    15: 747
                    16: 611
                    17: 927
                    18: 927
                    19: 927
                    20: 809
                    21: 927
                    22: 927
                    23: 472
               default: 927
          }
     120: aload_0
     121: getfield      #515                // Field connection_state:S
     124: lookupswitch  { // 1
                     0: 144
               default: 462
          }
     144: aload_0
     145: aload_3
     146: invokevirtual #596                // Method receiveClientHelloMessage:(Ljava/io/ByteArrayInputStream;)V
     149: aload_0
     150: iconst_1
     151: putfield      #515                // Field connection_state:S
     154: aload_0
     155: invokevirtual #587                // Method sendServerHelloMessage:()V
     158: aload_0
     159: iconst_2
     160: putfield      #515                // Field connection_state:S
     163: aload_0
     164: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     167: invokeinterface #660,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getServerSupplementalData:()Ljava/util/Vector;
     172: astore        4
     174: aload         4
     176: ifnull        185
     179: aload_0
     180: aload         4
     182: invokevirtual #598                // Method sendSupplementalDataMessage:(Ljava/util/Vector;)V
     185: aload_0
     186: iconst_3
     187: putfield      #515                // Field connection_state:S
     190: aload_0
     191: aload_0
     192: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     195: invokeinterface #669,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getKeyExchange:()Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     200: putfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     203: aload_0
     204: getfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     207: aload_0
     208: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
     211: invokeinterface #648,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.init:(Lorg/bouncycastle/crypto/tls/TlsContext;)V
     216: aload_0
     217: aload_0
     218: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     221: invokeinterface #668,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getCredentials:()Lorg/bouncycastle/crypto/tls/TlsCredentials;
     226: putfield      #530                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     229: aconst_null
     230: astore        5
     232: aload_0
     233: getfield      #530                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     236: ifnonnull     251
     239: aload_0
     240: getfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     243: invokeinterface #643,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.skipServerCredentials:()V
     248: goto          281
     251: aload_0
     252: getfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     255: aload_0
     256: getfield      #530                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     259: invokeinterface #649,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.processServerCredentials:(Lorg/bouncycastle/crypto/tls/TlsCredentials;)V
     264: aload_0
     265: getfield      #530                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     268: invokeinterface #639,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsCredentials.getCertificate:()Lorg/bouncycastle/crypto/tls/Certificate;
     273: astore        5
     275: aload_0
     276: aload         5
     278: invokevirtual #602                // Method sendCertificateMessage:(Lorg/bouncycastle/crypto/tls/Certificate;)V
     281: aload_0
     282: iconst_4
     283: putfield      #515                // Field connection_state:S
     286: aload         5
     288: ifnull        299
     291: aload         5
     293: invokevirtual #545                // Method org/bouncycastle/crypto/tls/Certificate.isEmpty:()Z
     296: ifeq          304
     299: aload_0
     300: iconst_0
     301: putfield      #516                // Field allowCertificateStatus:Z
     304: aload_0
     305: getfield      #516                // Field allowCertificateStatus:Z
     308: ifeq          333
     311: aload_0
     312: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     315: invokeinterface #664,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getCertificateStatus:()Lorg/bouncycastle/crypto/tls/CertificateStatus;
     320: astore        6
     322: aload         6
     324: ifnull        333
     327: aload_0
     328: aload         6
     330: invokevirtual #604                // Method sendCertificateStatusMessage:(Lorg/bouncycastle/crypto/tls/CertificateStatus;)V
     333: aload_0
     334: iconst_5
     335: putfield      #515                // Field connection_state:S
     338: aload_0
     339: getfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     342: invokeinterface #644,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.generateServerKeyExchange:()[B
     347: astore        6
     349: aload         6
     351: ifnull        360
     354: aload_0
     355: aload         6
     357: invokevirtual #589                // Method sendServerKeyExchangeMessage:([B)V
     360: aload_0
     361: bipush        6
     363: putfield      #515                // Field connection_state:S
     366: aload_0
     367: getfield      #530                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
     370: ifnull        431
     373: aload_0
     374: aload_0
     375: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     378: invokeinterface #663,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getCertificateRequest:()Lorg/bouncycastle/crypto/tls/CertificateRequest;
     383: putfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     386: aload_0
     387: getfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     390: ifnull        431
     393: aload_0
     394: getfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     397: aload_0
     398: getfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     401: invokeinterface #647,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.validateCertificateRequest:(Lorg/bouncycastle/crypto/tls/CertificateRequest;)V
     406: aload_0
     407: aload_0
     408: getfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     411: invokevirtual #603                // Method sendCertificateRequestMessage:(Lorg/bouncycastle/crypto/tls/CertificateRequest;)V
     414: aload_0
     415: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     418: invokevirtual #563                // Method org/bouncycastle/crypto/tls/RecordStream.getHandshakeHash:()Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
     421: aload_0
     422: getfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     425: invokevirtual #549                // Method org/bouncycastle/crypto/tls/CertificateRequest.getSupportedSignatureAlgorithms:()Ljava/util/Vector;
     428: invokestatic  #632                // Method org/bouncycastle/crypto/tls/TlsUtils.trackHashAlgorithms:(Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;Ljava/util/Vector;)V
     431: aload_0
     432: bipush        7
     434: putfield      #515                // Field connection_state:S
     437: aload_0
     438: invokevirtual #586                // Method sendServerHelloDoneMessage:()V
     441: aload_0
     442: bipush        8
     444: putfield      #515                // Field connection_state:S
     447: aload_0
     448: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     451: invokevirtual #563                // Method org/bouncycastle/crypto/tls/RecordStream.getHandshakeHash:()Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
     454: invokeinterface #640,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsHandshakeHash.sealHashAlgorithms:()V
     459: goto          937
     462: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     465: dup
     466: bipush        10
     468: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     471: athrow
     472: aload_0
     473: getfield      #515                // Field connection_state:S
     476: lookupswitch  { // 1
                     8: 496
               default: 518
          }
     496: aload_0
     497: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     500: aload_3
     501: invokestatic  #611                // Method readSupplementalDataMessage:(Ljava/io/ByteArrayInputStream;)Ljava/util/Vector;
     504: invokeinterface #661,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientSupplementalData:(Ljava/util/Vector;)V
     509: aload_0
     510: bipush        9
     512: putfield      #515                // Field connection_state:S
     515: goto          937
     518: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     521: dup
     522: bipush        10
     524: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     527: athrow
     528: aload_0
     529: getfield      #515                // Field connection_state:S
     532: lookupswitch  { // 2
                     8: 560
                     9: 570
               default: 601
          }
     560: aload_0
     561: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     564: aconst_null
     565: invokeinterface #661,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientSupplementalData:(Ljava/util/Vector;)V
     570: aload_0
     571: getfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     574: ifnonnull     587
     577: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     580: dup
     581: bipush        10
     583: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     586: athrow
     587: aload_0
     588: aload_3
     589: invokevirtual #594                // Method receiveCertificateMessage:(Ljava/io/ByteArrayInputStream;)V
     592: aload_0
     593: bipush        10
     595: putfield      #515                // Field connection_state:S
     598: goto          937
     601: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     604: dup
     605: bipush        10
     607: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     610: athrow
     611: aload_0
     612: getfield      #515                // Field connection_state:S
     615: tableswitch   { // 8 to 10
                     8: 640
                     9: 650
                    10: 723
               default: 737
          }
     640: aload_0
     641: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     644: aconst_null
     645: invokeinterface #661,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientSupplementalData:(Ljava/util/Vector;)V
     650: aload_0
     651: getfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
     654: ifnonnull     669
     657: aload_0
     658: getfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
     661: invokeinterface #642,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.skipClientCredentials:()V
     666: goto          723
     669: aload_0
     670: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
     673: invokestatic  #627                // Method org/bouncycastle/crypto/tls/TlsUtils.isTLSv12:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
     676: ifeq          689
     679: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     682: dup
     683: bipush        10
     685: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     688: athrow
     689: aload_0
     690: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
     693: invokestatic  #626                // Method org/bouncycastle/crypto/tls/TlsUtils.isSSL:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
     696: ifeq          716
     699: aload_0
     700: getfield      #526                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
     703: ifnonnull     723
     706: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     709: dup
     710: bipush        10
     712: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     715: athrow
     716: aload_0
     717: getstatic     #501                // Field org/bouncycastle/crypto/tls/Certificate.EMPTY_CHAIN:Lorg/bouncycastle/crypto/tls/Certificate;
     720: invokevirtual #601                // Method notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
     723: aload_0
     724: aload_3
     725: invokevirtual #597                // Method receiveClientKeyExchangeMessage:(Ljava/io/ByteArrayInputStream;)V
     728: aload_0
     729: bipush        11
     731: putfield      #515                // Field connection_state:S
     734: goto          937
     737: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     740: dup
     741: bipush        10
     743: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     746: athrow
     747: aload_0
     748: getfield      #515                // Field connection_state:S
     751: lookupswitch  { // 1
                    11: 768
               default: 799
          }
     768: aload_0
     769: invokevirtual #588                // Method expectCertificateVerifyMessage:()Z
     772: ifne          785
     775: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     778: dup
     779: bipush        10
     781: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     784: athrow
     785: aload_0
     786: aload_3
     787: invokevirtual #595                // Method receiveCertificateVerifyMessage:(Ljava/io/ByteArrayInputStream;)V
     790: aload_0
     791: bipush        12
     793: putfield      #515                // Field connection_state:S
     796: goto          937
     799: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     802: dup
     803: bipush        10
     805: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     808: athrow
     809: aload_0
     810: getfield      #515                // Field connection_state:S
     813: lookupswitch  { // 2
                    11: 840
                    12: 857
               default: 917
          }
     840: aload_0
     841: invokevirtual #588                // Method expectCertificateVerifyMessage:()Z
     844: ifeq          857
     847: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     850: dup
     851: bipush        10
     853: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     856: athrow
     857: aload_0
     858: aload_3
     859: invokevirtual #593                // Method processFinishedMessage:(Ljava/io/ByteArrayInputStream;)V
     862: aload_0
     863: bipush        13
     865: putfield      #515                // Field connection_state:S
     868: aload_0
     869: getfield      #517                // Field expectSessionTicket:Z
     872: ifeq          892
     875: aload_0
     876: aload_0
     877: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     880: invokeinterface #665,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getNewSessionTicket:()Lorg/bouncycastle/crypto/tls/NewSessionTicket;
     885: invokevirtual #605                // Method sendNewSessionTicketMessage:(Lorg/bouncycastle/crypto/tls/NewSessionTicket;)V
     888: aload_0
     889: invokevirtual #584                // Method sendChangeCipherSpecMessage:()V
     892: aload_0
     893: bipush        14
     895: putfield      #515                // Field connection_state:S
     898: aload_0
     899: invokevirtual #585                // Method sendFinishedMessage:()V
     902: aload_0
     903: bipush        15
     905: putfield      #515                // Field connection_state:S
     908: aload_0
     909: bipush        16
     911: putfield      #515                // Field connection_state:S
     914: goto          937
     917: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     920: dup
     921: bipush        10
     923: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     926: athrow
     927: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     930: dup
     931: bipush        10
     933: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     936: athrow
     937: return

  protected void handleWarningMessage(short) throws java.io.IOException;
    Code:
       0: iload_1
       1: lookupswitch  { // 1
                    41: 20
               default: 47
          }
      20: aload_0
      21: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
      24: invokestatic  #626                // Method org/bouncycastle/crypto/tls/TlsUtils.isSSL:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
      27: ifeq          52
      30: aload_0
      31: getfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
      34: ifnull        52
      37: aload_0
      38: getstatic     #501                // Field org/bouncycastle/crypto/tls/Certificate.EMPTY_CHAIN:Lorg/bouncycastle/crypto/tls/Certificate;
      41: invokevirtual #601                // Method notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      44: goto          52
      47: aload_0
      48: iload_1
      49: invokespecial #574                // Method org/bouncycastle/crypto/tls/TlsProtocol.handleWarningMessage:(S)V
      52: return

  protected void notifyClientCertificate(org.bouncycastle.crypto.tls.Certificate) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #527                // Field certificateRequest:Lorg/bouncycastle/crypto/tls/CertificateRequest;
       4: ifnonnull     15
       7: new           #224                // class java/lang/IllegalStateException
      10: dup
      11: invokespecial #538                // Method java/lang/IllegalStateException."<init>":()V
      14: athrow
      15: aload_0
      16: getfield      #526                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
      19: ifnull        32
      22: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      25: dup
      26: bipush        10
      28: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      31: athrow
      32: aload_0
      33: aload_1
      34: putfield      #526                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
      37: aload_1
      38: invokevirtual #545                // Method org/bouncycastle/crypto/tls/Certificate.isEmpty:()Z
      41: ifeq          56
      44: aload_0
      45: getfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      48: invokeinterface #642,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.skipClientCredentials:()V
      53: goto          83
      56: aload_0
      57: aload_1
      58: aload_0
      59: getfield      #530                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsCredentials;
      62: invokeinterface #639,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsCredentials.getCertificate:()Lorg/bouncycastle/crypto/tls/Certificate;
      67: invokestatic  #633                // Method org/bouncycastle/crypto/tls/TlsUtils.getClientCertificateType:(Lorg/bouncycastle/crypto/tls/Certificate;Lorg/bouncycastle/crypto/tls/Certificate;)S
      70: putfield      #514                // Field clientCertificateType:S
      73: aload_0
      74: getfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      77: aload_1
      78: invokeinterface #646,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.processClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      83: aload_0
      84: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      87: aload_1
      88: invokeinterface #662,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      93: return

  protected void receiveCertificateMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokestatic  #547                // Method org/bouncycastle/crypto/tls/Certificate.parse:(Ljava/io/InputStream;)Lorg/bouncycastle/crypto/tls/Certificate;
       4: astore_2
       5: aload_1
       6: invokestatic  #592                // Method assertEmpty:(Ljava/io/ByteArrayInputStream;)V
       9: aload_0
      10: aload_2
      11: invokevirtual #601                // Method notifyClientCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      14: return

  protected void receiveCertificateVerifyMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
       4: aload_1
       5: invokestatic  #553                // Method org/bouncycastle/crypto/tls/DigitallySigned.parse:(Lorg/bouncycastle/crypto/tls/TlsContext;Ljava/io/InputStream;)Lorg/bouncycastle/crypto/tls/DigitallySigned;
       8: astore_2
       9: aload_1
      10: invokestatic  #592                // Method assertEmpty:(Ljava/io/ByteArrayInputStream;)V
      13: iconst_0
      14: istore_3
      15: aload_0
      16: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
      19: invokestatic  #627                // Method org/bouncycastle/crypto/tls/TlsUtils.isTLSv12:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
      22: ifeq          46
      25: aload_0
      26: getfield      #531                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      29: aload_2
      30: invokevirtual #552                // Method org/bouncycastle/crypto/tls/DigitallySigned.getAlgorithm:()Lorg/bouncycastle/crypto/tls/SignatureAndHashAlgorithm;
      33: invokevirtual #568                // Method org/bouncycastle/crypto/tls/SignatureAndHashAlgorithm.getHash:()S
      36: invokeinterface #641,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsHandshakeHash.getFinalHash:(S)[B
      41: astore        4
      43: goto          60
      46: aload_0
      47: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
      50: aload_0
      51: getfield      #531                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      54: aconst_null
      55: invokestatic  #575                // Method org/bouncycastle/crypto/tls/TlsProtocol.getCurrentPRFHash:(Lorg/bouncycastle/crypto/tls/TlsContext;Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;[B)[B
      58: astore        4
      60: aload_0
      61: getfield      #526                // Field peerCertificate:Lorg/bouncycastle/crypto/tls/Certificate;
      64: iconst_0
      65: invokevirtual #546                // Method org/bouncycastle/crypto/tls/Certificate.getCertificateAt:(I)Lorg/bouncycastle/asn1/x509/Certificate;
      68: astore        5
      70: aload         5
      72: invokevirtual #541                // Method org/bouncycastle/asn1/x509/Certificate.getSubjectPublicKeyInfo:()Lorg/bouncycastle/asn1/x509/SubjectPublicKeyInfo;
      75: astore        6
      77: aload         6
      79: invokestatic  #635                // Method org/bouncycastle/crypto/util/PublicKeyFactory.createKey:(Lorg/bouncycastle/asn1/x509/SubjectPublicKeyInfo;)Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      82: astore        7
      84: aload_0
      85: getfield      #514                // Field clientCertificateType:S
      88: invokestatic  #628                // Method org/bouncycastle/crypto/tls/TlsUtils.createTlsSigner:(S)Lorg/bouncycastle/crypto/tls/TlsSigner;
      91: astore        8
      93: aload         8
      95: aload_0
      96: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
      99: invokeinterface #671,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsSigner.init:(Lorg/bouncycastle/crypto/tls/TlsContext;)V
     104: aload         8
     106: aload_2
     107: invokevirtual #552                // Method org/bouncycastle/crypto/tls/DigitallySigned.getAlgorithm:()Lorg/bouncycastle/crypto/tls/SignatureAndHashAlgorithm;
     110: aload_2
     111: invokevirtual #551                // Method org/bouncycastle/crypto/tls/DigitallySigned.getSignature:()[B
     114: aload         7
     116: aload         4
     118: invokeinterface #672,  5          // InterfaceMethod org/bouncycastle/crypto/tls/TlsSigner.verifyRawSignature:(Lorg/bouncycastle/crypto/tls/SignatureAndHashAlgorithm;[BLorg/bouncycastle/crypto/params/AsymmetricKeyParameter;[B)Z
     123: istore_3
     124: goto          129
     127: astore        4
     129: iload_3
     130: ifne          143
     133: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     136: dup
     137: bipush        51
     139: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     142: athrow
     143: return
    Exception table:
       from    to  target type
          15   124   127   Class java/lang/Exception

  protected void receiveClientHelloMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokestatic  #634                // Method org/bouncycastle/crypto/tls/TlsUtils.readVersion:(Ljava/io/InputStream;)Lorg/bouncycastle/crypto/tls/ProtocolVersion;
       4: astore_2
       5: aload_2
       6: invokevirtual #555                // Method org/bouncycastle/crypto/tls/ProtocolVersion.isDTLS:()Z
       9: ifeq          22
      12: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      15: dup
      16: bipush        47
      18: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      21: athrow
      22: bipush        32
      24: aload_1
      25: invokestatic  #616                // Method org/bouncycastle/crypto/tls/TlsUtils.readFully:(ILjava/io/InputStream;)[B
      28: astore_3
      29: aload_1
      30: invokestatic  #621                // Method org/bouncycastle/crypto/tls/TlsUtils.readOpaque8:(Ljava/io/InputStream;)[B
      33: astore        4
      35: aload         4
      37: arraylength
      38: bipush        32
      40: if_icmple     53
      43: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      46: dup
      47: bipush        47
      49: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      52: athrow
      53: aload_1
      54: invokestatic  #619                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint16:(Ljava/io/InputStream;)I
      57: istore        5
      59: iload         5
      61: iconst_2
      62: if_icmplt     72
      65: iload         5
      67: iconst_1
      68: iand
      69: ifeq          82
      72: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      75: dup
      76: bipush        50
      78: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      81: athrow
      82: aload_0
      83: iload         5
      85: iconst_2
      86: idiv
      87: aload_1
      88: invokestatic  #617                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint16Array:(ILjava/io/InputStream;)[I
      91: putfield      #520                // Field offeredCipherSuites:[I
      94: aload_1
      95: invokestatic  #620                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint8:(Ljava/io/InputStream;)S
      98: istore        6
     100: iload         6
     102: iconst_1
     103: if_icmpge     116
     106: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     109: dup
     110: bipush        47
     112: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     115: athrow
     116: aload_0
     117: iload         6
     119: aload_1
     120: invokestatic  #618                // Method org/bouncycastle/crypto/tls/TlsUtils.readUint8Array:(ILjava/io/InputStream;)[S
     123: putfield      #521                // Field offeredCompressionMethods:[S
     126: aload_0
     127: aload_1
     128: invokestatic  #608                // Method readExtensions:(Ljava/io/ByteArrayInputStream;)Ljava/util/Hashtable;
     131: putfield      #524                // Field clientExtensions:Ljava/util/Hashtable;
     134: aload_0
     135: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
     138: aload_2
     139: invokevirtual #543                // Method org/bouncycastle/crypto/tls/AbstractTlsContext.setClientVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
     142: aload_0
     143: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     146: aload_2
     147: invokeinterface #667,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyClientVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
     152: aload_0
     153: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     156: aload_3
     157: putfield      #510                // Field org/bouncycastle/crypto/tls/SecurityParameters.clientRandom:[B
     160: aload_0
     161: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     164: aload_0
     165: getfield      #520                // Field offeredCipherSuites:[I
     168: invokeinterface #656,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyOfferedCipherSuites:([I)V
     173: aload_0
     174: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     177: aload_0
     178: getfield      #521                // Field offeredCompressionMethods:[S
     181: invokeinterface #657,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifyOfferedCompressionMethods:([S)V
     186: aload_0
     187: getfield      #520                // Field offeredCipherSuites:[I
     190: sipush        255
     193: invokestatic  #637                // Method org/bouncycastle/util/Arrays.contains:([II)Z
     196: ifeq          204
     199: aload_0
     200: iconst_1
     201: putfield      #519                // Field secure_renegotiation:Z
     204: aload_0
     205: getfield      #524                // Field clientExtensions:Ljava/util/Hashtable;
     208: getstatic     #522                // Field EXT_RenegotiationInfo:Ljava/lang/Integer;
     211: invokestatic  #630                // Method org/bouncycastle/crypto/tls/TlsUtils.getExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;)[B
     214: astore        7
     216: aload         7
     218: ifnull        250
     221: aload_0
     222: iconst_1
     223: putfield      #519                // Field secure_renegotiation:Z
     226: aload         7
     228: getstatic     #535                // Field org/bouncycastle/crypto/tls/TlsUtils.EMPTY_BYTES:[B
     231: invokestatic  #590                // Method createRenegotiationInfo:([B)[B
     234: invokestatic  #636                // Method org/bouncycastle/util/Arrays.constantTimeAreEqual:([B[B)Z
     237: ifne          250
     240: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     243: dup
     244: bipush        40
     246: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     249: athrow
     250: aload_0
     251: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     254: aload_0
     255: getfield      #519                // Field secure_renegotiation:Z
     258: invokeinterface #655,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.notifySecureRenegotiation:(Z)V
     263: aload_0
     264: getfield      #524                // Field clientExtensions:Ljava/util/Hashtable;
     267: ifnull        283
     270: aload_0
     271: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     274: aload_0
     275: getfield      #524                // Field clientExtensions:Ljava/util/Hashtable;
     278: invokeinterface #659,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.processClientExtensions:(Ljava/util/Hashtable;)V
     283: return

  protected void receiveClientKeyExchangeMessage(java.io.ByteArrayInputStream) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
       4: aload_1
       5: invokeinterface #645,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsKeyExchange.processClientKeyExchange:(Ljava/io/InputStream;)V
      10: aload_1
      11: invokestatic  #592                // Method assertEmpty:(Ljava/io/ByteArrayInputStream;)V
      14: aload_0
      15: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
      18: aload_0
      19: getfield      #532                // Field keyExchange:Lorg/bouncycastle/crypto/tls/TlsKeyExchange;
      22: invokestatic  #612                // Method establishMasterSecret:(Lorg/bouncycastle/crypto/tls/TlsContext;Lorg/bouncycastle/crypto/tls/TlsKeyExchange;)V
      25: aload_0
      26: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      29: aload_0
      30: invokevirtual #607                // Method getPeer:()Lorg/bouncycastle/crypto/tls/TlsPeer;
      33: invokeinterface #651,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsPeer.getCompression:()Lorg/bouncycastle/crypto/tls/TlsCompression;
      38: aload_0
      39: invokevirtual #607                // Method getPeer:()Lorg/bouncycastle/crypto/tls/TlsPeer;
      42: invokeinterface #650,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsPeer.getCipher:()Lorg/bouncycastle/crypto/tls/TlsCipher;
      47: invokevirtual #565                // Method org/bouncycastle/crypto/tls/RecordStream.setPendingConnectionState:(Lorg/bouncycastle/crypto/tls/TlsCompression;Lorg/bouncycastle/crypto/tls/TlsCipher;)V
      50: aload_0
      51: aload_0
      52: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      55: invokevirtual #564                // Method org/bouncycastle/crypto/tls/RecordStream.prepareToFinish:()Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      58: putfield      #531                // Field prepareFinishHash:Lorg/bouncycastle/crypto/tls/TlsHandshakeHash;
      61: aload_0
      62: getfield      #517                // Field expectSessionTicket:Z
      65: ifne          72
      68: aload_0
      69: invokevirtual #584                // Method sendChangeCipherSpecMessage:()V
      72: return

  protected void sendCertificateRequestMessage(org.bouncycastle.crypto.tls.CertificateRequest) throws java.io.IOException;
    Code:
       0: new           #244                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: bipush        13
       7: invokespecial #579                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
      10: astore_2
      11: aload_1
      12: aload_2
      13: invokevirtual #548                // Method org/bouncycastle/crypto/tls/CertificateRequest.encode:(Ljava/io/OutputStream;)V
      16: aload_2
      17: invokevirtual #577                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      20: return

  protected void sendCertificateStatusMessage(org.bouncycastle.crypto.tls.CertificateStatus) throws java.io.IOException;
    Code:
       0: new           #244                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: bipush        22
       7: invokespecial #579                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
      10: astore_2
      11: aload_1
      12: aload_2
      13: invokevirtual #550                // Method org/bouncycastle/crypto/tls/CertificateStatus.encode:(Ljava/io/OutputStream;)V
      16: aload_2
      17: invokevirtual #577                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      20: return

  protected void sendNewSessionTicketMessage(org.bouncycastle.crypto.tls.NewSessionTicket) throws java.io.IOException;
    Code:
       0: aload_1
       1: ifnonnull     14
       4: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
       7: dup
       8: bipush        80
      10: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      13: athrow
      14: new           #244                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
      17: dup
      18: aload_0
      19: iconst_4
      20: invokespecial #579                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
      23: astore_2
      24: aload_1
      25: aload_2
      26: invokevirtual #554                // Method org/bouncycastle/crypto/tls/NewSessionTicket.encode:(Ljava/io/OutputStream;)V
      29: aload_2
      30: invokevirtual #577                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      33: return

  protected void sendServerHelloMessage() throws java.io.IOException;
    Code:
       0: new           #244                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: iconst_2
       6: invokespecial #579                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;S)V
       9: astore_1
      10: aload_0
      11: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
      14: invokeinterface #666,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getServerVersion:()Lorg/bouncycastle/crypto/tls/ProtocolVersion;
      19: astore_2
      20: aload_2
      21: aload_0
      22: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
      25: invokevirtual #542                // Method org/bouncycastle/crypto/tls/AbstractTlsContext.getClientVersion:()Lorg/bouncycastle/crypto/tls/ProtocolVersion;
      28: invokevirtual #556                // Method org/bouncycastle/crypto/tls/ProtocolVersion.isEqualOrEarlierVersionOf:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)Z
      31: ifne          44
      34: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      37: dup
      38: bipush        80
      40: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      43: athrow
      44: aload_0
      45: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      48: aload_2
      49: invokevirtual #560                // Method org/bouncycastle/crypto/tls/RecordStream.setReadVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      52: aload_0
      53: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      56: aload_2
      57: invokevirtual #561                // Method org/bouncycastle/crypto/tls/RecordStream.setWriteVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      60: aload_0
      61: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
      64: iconst_1
      65: invokevirtual #559                // Method org/bouncycastle/crypto/tls/RecordStream.setRestrictReadVersion:(Z)V
      68: aload_0
      69: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
      72: aload_2
      73: invokevirtual #544                // Method org/bouncycastle/crypto/tls/AbstractTlsContext.setServerVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;)V
      76: aload_2
      77: aload_1
      78: invokestatic  #629                // Method org/bouncycastle/crypto/tls/TlsUtils.writeVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;Ljava/io/OutputStream;)V
      81: aload_1
      82: aload_0
      83: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
      86: getfield      #511                // Field org/bouncycastle/crypto/tls/SecurityParameters.serverRandom:[B
      89: invokevirtual #578                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.write:([B)V
      92: getstatic     #535                // Field org/bouncycastle/crypto/tls/TlsUtils.EMPTY_BYTES:[B
      95: aload_1
      96: invokestatic  #624                // Method org/bouncycastle/crypto/tls/TlsUtils.writeOpaque8:([BLjava/io/OutputStream;)V
      99: aload_0
     100: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     103: invokeinterface #652,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getSelectedCipherSuite:()I
     108: istore_3
     109: aload_0
     110: getfield      #520                // Field offeredCipherSuites:[I
     113: iload_3
     114: invokestatic  #637                // Method org/bouncycastle/util/Arrays.contains:([II)Z
     117: ifeq          139
     120: iload_3
     121: ifeq          139
     124: iload_3
     125: sipush        255
     128: if_icmpeq     139
     131: iload_3
     132: aload_2
     133: invokestatic  #625                // Method org/bouncycastle/crypto/tls/TlsUtils.isValidCipherSuiteForVersion:(ILorg/bouncycastle/crypto/tls/ProtocolVersion;)Z
     136: ifne          149
     139: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     142: dup
     143: bipush        80
     145: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     148: athrow
     149: aload_0
     150: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     153: iload_3
     154: putfield      #502                // Field org/bouncycastle/crypto/tls/SecurityParameters.cipherSuite:I
     157: aload_0
     158: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     161: invokeinterface #653,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getSelectedCompressionMethod:()S
     166: istore        4
     168: aload_0
     169: getfield      #521                // Field offeredCompressionMethods:[S
     172: iload         4
     174: invokestatic  #638                // Method org/bouncycastle/util/Arrays.contains:([SS)Z
     177: ifne          190
     180: new           #239                // class org/bouncycastle/crypto/tls/TlsFatalAlert
     183: dup
     184: bipush        80
     186: invokespecial #572                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     189: athrow
     190: aload_0
     191: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     194: iload         4
     196: putfield      #506                // Field org/bouncycastle/crypto/tls/SecurityParameters.compressionAlgorithm:S
     199: iload_3
     200: aload_1
     201: invokestatic  #622                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint16:(ILjava/io/OutputStream;)V
     204: iload         4
     206: aload_1
     207: invokestatic  #623                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint8:(SLjava/io/OutputStream;)V
     210: aload_0
     211: aload_0
     212: getfield      #533                // Field tlsServer:Lorg/bouncycastle/crypto/tls/TlsServer;
     215: invokeinterface #658,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsServer.getServerExtensions:()Ljava/util/Hashtable;
     220: putfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     223: aload_0
     224: getfield      #519                // Field secure_renegotiation:Z
     227: ifeq          288
     230: aload_0
     231: getfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     234: getstatic     #522                // Field EXT_RenegotiationInfo:Ljava/lang/Integer;
     237: invokestatic  #630                // Method org/bouncycastle/crypto/tls/TlsUtils.getExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;)[B
     240: astore        5
     242: aconst_null
     243: aload         5
     245: if_acmpne     252
     248: iconst_1
     249: goto          253
     252: iconst_0
     253: istore        6
     255: iload         6
     257: ifeq          288
     260: aload_0
     261: aload_0
     262: getfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     265: invokestatic  #571                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.ensureExtensionsInitialised:(Ljava/util/Hashtable;)Ljava/util/Hashtable;
     268: putfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     271: aload_0
     272: getfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     275: getstatic     #522                // Field EXT_RenegotiationInfo:Ljava/lang/Integer;
     278: getstatic     #535                // Field org/bouncycastle/crypto/tls/TlsUtils.EMPTY_BYTES:[B
     281: invokestatic  #590                // Method createRenegotiationInfo:([B)[B
     284: invokevirtual #540                // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     287: pop
     288: aload_0
     289: getfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     292: ifnull        414
     295: aload_0
     296: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     299: aload_0
     300: getfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     303: invokestatic  #569                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.hasEncryptThenMACExtension:(Ljava/util/Hashtable;)Z
     306: putfield      #508                // Field org/bouncycastle/crypto/tls/SecurityParameters.encryptThenMAC:Z
     309: aload_0
     310: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     313: aload_0
     314: aload_0
     315: getfield      #524                // Field clientExtensions:Ljava/util/Hashtable;
     318: aload_0
     319: getfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     322: bipush        80
     324: invokevirtual #610                // Method processMaxFragmentLengthExtension:(Ljava/util/Hashtable;Ljava/util/Hashtable;S)S
     327: putfield      #507                // Field org/bouncycastle/crypto/tls/SecurityParameters.maxFragmentLength:S
     330: aload_0
     331: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     334: aload_0
     335: getfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     338: invokestatic  #570                // Method org/bouncycastle/crypto/tls/TlsExtensionsUtils.hasTruncatedHMacExtension:(Ljava/util/Hashtable;)Z
     341: putfield      #509                // Field org/bouncycastle/crypto/tls/SecurityParameters.truncatedHMac:Z
     344: aload_0
     345: aload_0
     346: getfield      #518                // Field resumedSession:Z
     349: ifne          371
     352: aload_0
     353: getfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     356: getstatic     #512                // Field org/bouncycastle/crypto/tls/TlsExtensionsUtils.EXT_status_request:Ljava/lang/Integer;
     359: bipush        80
     361: invokestatic  #631                // Method org/bouncycastle/crypto/tls/TlsUtils.hasExpectedEmptyExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;S)Z
     364: ifeq          371
     367: iconst_1
     368: goto          372
     371: iconst_0
     372: putfield      #516                // Field allowCertificateStatus:Z
     375: aload_0
     376: aload_0
     377: getfield      #518                // Field resumedSession:Z
     380: ifne          402
     383: aload_0
     384: getfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     387: getstatic     #513                // Field org/bouncycastle/crypto/tls/TlsProtocol.EXT_SessionTicket:Ljava/lang/Integer;
     390: bipush        80
     392: invokestatic  #631                // Method org/bouncycastle/crypto/tls/TlsUtils.hasExpectedEmptyExtensionData:(Ljava/util/Hashtable;Ljava/lang/Integer;S)Z
     395: ifeq          402
     398: iconst_1
     399: goto          403
     402: iconst_0
     403: putfield      #517                // Field expectSessionTicket:Z
     406: aload_1
     407: aload_0
     408: getfield      #525                // Field serverExtensions:Ljava/util/Hashtable;
     411: invokestatic  #609                // Method writeExtensions:(Ljava/io/OutputStream;Ljava/util/Hashtable;)V
     414: aload_0
     415: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     418: getfield      #507                // Field org/bouncycastle/crypto/tls/SecurityParameters.maxFragmentLength:S
     421: iflt          447
     424: iconst_1
     425: bipush        8
     427: aload_0
     428: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     431: getfield      #507                // Field org/bouncycastle/crypto/tls/SecurityParameters.maxFragmentLength:S
     434: iadd
     435: ishl
     436: istore        5
     438: aload_0
     439: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     442: iload         5
     444: invokevirtual #558                // Method org/bouncycastle/crypto/tls/RecordStream.setPlaintextLimit:(I)V
     447: aload_0
     448: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     451: aload_0
     452: invokevirtual #600                // Method getContext:()Lorg/bouncycastle/crypto/tls/AbstractTlsContext;
     455: aload_0
     456: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     459: invokevirtual #566                // Method org/bouncycastle/crypto/tls/SecurityParameters.getCipherSuite:()I
     462: invokestatic  #606                // Method getPRFAlgorithm:(Lorg/bouncycastle/crypto/tls/TlsContext;I)I
     465: putfield      #504                // Field org/bouncycastle/crypto/tls/SecurityParameters.prfAlgorithm:I
     468: aload_0
     469: getfield      #529                // Field securityParameters:Lorg/bouncycastle/crypto/tls/SecurityParameters;
     472: bipush        12
     474: putfield      #505                // Field org/bouncycastle/crypto/tls/SecurityParameters.verifyDataLength:I
     477: aload_1
     478: invokevirtual #577                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
     481: aload_0
     482: getfield      #528                // Field recordStream:Lorg/bouncycastle/crypto/tls/RecordStream;
     485: invokevirtual #557                // Method org/bouncycastle/crypto/tls/RecordStream.notifyHelloComplete:()V
     488: return

  protected void sendServerHelloDoneMessage() throws java.io.IOException;
    Code:
       0: iconst_4
       1: newarray       byte
       3: astore_1
       4: bipush        14
       6: aload_1
       7: iconst_0
       8: invokestatic  #615                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint8:(S[BI)V
      11: iconst_0
      12: aload_1
      13: iconst_1
      14: invokestatic  #613                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint24:(I[BI)V
      17: aload_0
      18: aload_1
      19: iconst_0
      20: aload_1
      21: arraylength
      22: invokevirtual #591                // Method writeHandshakeMessage:([BII)V
      25: return

  protected void sendServerKeyExchangeMessage(byte[]) throws java.io.IOException;
    Code:
       0: new           #244                // class org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage
       3: dup
       4: aload_0
       5: bipush        12
       7: aload_1
       8: arraylength
       9: invokespecial #580                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage."<init>":(Lorg/bouncycastle/crypto/tls/TlsProtocol;SI)V
      12: astore_2
      13: aload_2
      14: aload_1
      15: invokevirtual #578                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.write:([B)V
      18: aload_2
      19: invokevirtual #577                // Method org/bouncycastle/crypto/tls/TlsProtocol$HandshakeMessage.writeToRecordStream:()V
      22: return

  protected boolean expectCertificateVerifyMessage();
    Code:
       0: aload_0
       1: getfield      #514                // Field clientCertificateType:S
       4: iflt          21
       7: aload_0
       8: getfield      #514                // Field clientCertificateType:S
      11: invokestatic  #614                // Method org/bouncycastle/crypto/tls/TlsUtils.hasSigningCapability:(S)Z
      14: ifeq          21
      17: iconst_1
      18: goto          22
      21: iconst_0
      22: ireturn
}
