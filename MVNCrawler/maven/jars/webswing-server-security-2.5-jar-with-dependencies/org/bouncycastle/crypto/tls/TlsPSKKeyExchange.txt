public class org.bouncycastle.crypto.tls.TlsPSKKeyExchange extends org.bouncycastle.crypto.tls.AbstractTlsKeyExchange {
  protected org.bouncycastle.crypto.tls.TlsPSKIdentity pskIdentity;

  protected org.bouncycastle.crypto.params.DHParameters dhParameters;

  protected int[] namedCurves;

  protected short[] clientECPointFormats;

  protected short[] serverECPointFormats;

  protected byte[] psk_identity_hint;

  protected org.bouncycastle.crypto.params.DHPrivateKeyParameters dhAgreePrivateKey;

  protected org.bouncycastle.crypto.params.DHPublicKeyParameters dhAgreePublicKey;

  protected org.bouncycastle.crypto.params.AsymmetricKeyParameter serverPublicKey;

  protected org.bouncycastle.crypto.params.RSAKeyParameters rsaServerPublicKey;

  protected org.bouncycastle.crypto.tls.TlsEncryptionCredentials serverCredentials;

  protected byte[] premasterSecret;

  public org.bouncycastle.crypto.tls.TlsPSKKeyExchange(int, java.util.Vector, org.bouncycastle.crypto.tls.TlsPSKIdentity, org.bouncycastle.crypto.params.DHParameters, int[], short[], short[]);
    Code:
       0: aload_0
       1: iload_1
       2: aload_2
       3: invokespecial #218                // Method org/bouncycastle/crypto/tls/AbstractTlsKeyExchange."<init>":(ILjava/util/Vector;)V
       6: aload_0
       7: aconst_null
       8: putfield      #196                // Field psk_identity_hint:[B
      11: aload_0
      12: aconst_null
      13: putfield      #202                // Field dhAgreePrivateKey:Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
      16: aload_0
      17: aconst_null
      18: putfield      #203                // Field dhAgreePublicKey:Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
      21: aload_0
      22: aconst_null
      23: putfield      #200                // Field serverPublicKey:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      26: aload_0
      27: aconst_null
      28: putfield      #204                // Field rsaServerPublicKey:Lorg/bouncycastle/crypto/params/RSAKeyParameters;
      31: aload_0
      32: aconst_null
      33: putfield      #206                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsEncryptionCredentials;
      36: iload_1
      37: lookupswitch  { // 4
                    13: 80
                    14: 80
                    15: 80
                    24: 80
               default: 83
          }
      80: goto          93
      83: new           #92                 // class java/lang/IllegalArgumentException
      86: dup
      87: ldc           #1                  // String unsupported key exchange algorithm
      89: invokespecial #212                // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      92: athrow
      93: aload_0
      94: aload_3
      95: putfield      #207                // Field pskIdentity:Lorg/bouncycastle/crypto/tls/TlsPSKIdentity;
      98: aload_0
      99: aload         4
     101: putfield      #201                // Field dhParameters:Lorg/bouncycastle/crypto/params/DHParameters;
     104: aload_0
     105: aload         5
     107: putfield      #197                // Field namedCurves:[I
     110: aload_0
     111: aload         6
     113: putfield      #198                // Field clientECPointFormats:[S
     116: aload_0
     117: aload         7
     119: putfield      #199                // Field serverECPointFormats:[S
     122: return

  public void skipServerCredentials() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #194                // Field keyExchange:I
       4: bipush        15
       6: if_icmpne     19
       9: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      12: dup
      13: bipush        10
      15: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      18: athrow
      19: return

  public void processServerCredentials(org.bouncycastle.crypto.tls.TlsCredentials) throws java.io.IOException;
    Code:
       0: aload_1
       1: instanceof    #105                // class org/bouncycastle/crypto/tls/TlsEncryptionCredentials
       4: ifne          17
       7: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      10: dup
      11: bipush        80
      13: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      16: athrow
      17: aload_0
      18: aload_1
      19: invokeinterface #239,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsCredentials.getCertificate:()Lorg/bouncycastle/crypto/tls/Certificate;
      24: invokevirtual #231                // Method processServerCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
      27: aload_0
      28: aload_1
      29: checkcast     #105                // class org/bouncycastle/crypto/tls/TlsEncryptionCredentials
      32: putfield      #206                // Field serverCredentials:Lorg/bouncycastle/crypto/tls/TlsEncryptionCredentials;
      35: return

  public byte[] generateServerKeyExchange() throws java.io.IOException;
    Code:
       0: aload_0
       1: aconst_null
       2: putfield      #196                // Field psk_identity_hint:[B
       5: aload_0
       6: getfield      #196                // Field psk_identity_hint:[B
       9: ifnonnull     21
      12: aload_0
      13: invokevirtual #229                // Method requiresServerKeyExchange:()Z
      16: ifne          21
      19: aconst_null
      20: areturn
      21: new           #90                 // class java/io/ByteArrayOutputStream
      24: dup
      25: invokespecial #209                // Method java/io/ByteArrayOutputStream."<init>":()V
      28: astore_1
      29: aload_0
      30: getfield      #196                // Field psk_identity_hint:[B
      33: ifnonnull     46
      36: getstatic     #208                // Field org/bouncycastle/crypto/tls/TlsUtils.EMPTY_BYTES:[B
      39: aload_1
      40: invokestatic  #235                // Method org/bouncycastle/crypto/tls/TlsUtils.writeOpaque16:([BLjava/io/OutputStream;)V
      43: goto          54
      46: aload_0
      47: getfield      #196                // Field psk_identity_hint:[B
      50: aload_1
      51: invokestatic  #235                // Method org/bouncycastle/crypto/tls/TlsUtils.writeOpaque16:([BLjava/io/OutputStream;)V
      54: aload_0
      55: getfield      #194                // Field keyExchange:I
      58: bipush        14
      60: if_icmpne     104
      63: aload_0
      64: getfield      #201                // Field dhParameters:Lorg/bouncycastle/crypto/params/DHParameters;
      67: ifnonnull     80
      70: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      73: dup
      74: bipush        80
      76: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      79: athrow
      80: aload_0
      81: aload_0
      82: getfield      #205                // Field context:Lorg/bouncycastle/crypto/tls/TlsContext;
      85: invokeinterface #238,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.getSecureRandom:()Ljava/security/SecureRandom;
      90: aload_0
      91: getfield      #201                // Field dhParameters:Lorg/bouncycastle/crypto/params/DHParameters;
      94: aload_1
      95: invokestatic  #227                // Method org/bouncycastle/crypto/tls/TlsDHUtils.generateEphemeralServerKeyExchange:(Ljava/security/SecureRandom;Lorg/bouncycastle/crypto/params/DHParameters;Ljava/io/OutputStream;)Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
      98: putfield      #202                // Field dhAgreePrivateKey:Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
     101: goto          113
     104: aload_0
     105: getfield      #194                // Field keyExchange:I
     108: bipush        24
     110: if_icmpne     113
     113: aload_1
     114: invokevirtual #210                // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     117: areturn

  public void processServerCertificate(org.bouncycastle.crypto.tls.Certificate) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #194                // Field keyExchange:I
       4: bipush        15
       6: if_icmpeq     19
       9: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      12: dup
      13: bipush        10
      15: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      18: athrow
      19: aload_1
      20: invokevirtual #220                // Method org/bouncycastle/crypto/tls/Certificate.isEmpty:()Z
      23: ifeq          36
      26: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      29: dup
      30: bipush        42
      32: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      35: athrow
      36: aload_1
      37: iconst_0
      38: invokevirtual #221                // Method org/bouncycastle/crypto/tls/Certificate.getCertificateAt:(I)Lorg/bouncycastle/asn1/x509/Certificate;
      41: astore_2
      42: aload_2
      43: invokevirtual #214                // Method org/bouncycastle/asn1/x509/Certificate.getSubjectPublicKeyInfo:()Lorg/bouncycastle/asn1/x509/SubjectPublicKeyInfo;
      46: astore_3
      47: aload_0
      48: aload_3
      49: invokestatic  #237                // Method org/bouncycastle/crypto/util/PublicKeyFactory.createKey:(Lorg/bouncycastle/asn1/x509/SubjectPublicKeyInfo;)Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      52: putfield      #200                // Field serverPublicKey:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      55: goto          70
      58: astore        4
      60: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      63: dup
      64: bipush        43
      66: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      69: athrow
      70: aload_0
      71: getfield      #200                // Field serverPublicKey:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      74: invokevirtual #215                // Method org/bouncycastle/crypto/params/AsymmetricKeyParameter.isPrivate:()Z
      77: ifeq          90
      80: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      83: dup
      84: bipush        80
      86: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      89: athrow
      90: aload_0
      91: aload_0
      92: aload_0
      93: getfield      #200                // Field serverPublicKey:Lorg/bouncycastle/crypto/params/AsymmetricKeyParameter;
      96: checkcast     #98                 // class org/bouncycastle/crypto/params/RSAKeyParameters
      99: invokevirtual #232                // Method validateRSAPublicKey:(Lorg/bouncycastle/crypto/params/RSAKeyParameters;)Lorg/bouncycastle/crypto/params/RSAKeyParameters;
     102: putfield      #204                // Field rsaServerPublicKey:Lorg/bouncycastle/crypto/params/RSAKeyParameters;
     105: aload_2
     106: bipush        32
     108: invokestatic  #236                // Method org/bouncycastle/crypto/tls/TlsUtils.validateKeyUsage:(Lorg/bouncycastle/asn1/x509/Certificate;I)V
     111: aload_0
     112: aload_1
     113: invokespecial #219                // Method org/bouncycastle/crypto/tls/AbstractTlsKeyExchange.processServerCertificate:(Lorg/bouncycastle/crypto/tls/Certificate;)V
     116: return
    Exception table:
       from    to  target type
          47    55    58   Class java/lang/RuntimeException

  public boolean requiresServerKeyExchange();
    Code:
       0: aload_0
       1: getfield      #194                // Field keyExchange:I
       4: lookupswitch  { // 2
                    14: 32
                    24: 32
               default: 34
          }
      32: iconst_1
      33: ireturn
      34: iconst_0
      35: ireturn

  public void processServerKeyExchange(java.io.InputStream) throws java.io.IOException;
    Code:
       0: aload_0
       1: aload_1
       2: invokestatic  #234                // Method org/bouncycastle/crypto/tls/TlsUtils.readOpaque16:(Ljava/io/InputStream;)[B
       5: putfield      #196                // Field psk_identity_hint:[B
       8: aload_0
       9: getfield      #194                // Field keyExchange:I
      12: bipush        14
      14: if_icmpne     36
      17: aload_1
      18: invokestatic  #223                // Method org/bouncycastle/crypto/tls/ServerDHParams.parse:(Ljava/io/InputStream;)Lorg/bouncycastle/crypto/tls/ServerDHParams;
      21: astore_2
      22: aload_0
      23: aload_2
      24: invokevirtual #222                // Method org/bouncycastle/crypto/tls/ServerDHParams.getPublicKey:()Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
      27: invokestatic  #225                // Method org/bouncycastle/crypto/tls/TlsDHUtils.validateDHPublicKey:(Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;)Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
      30: putfield      #203                // Field dhAgreePublicKey:Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
      33: goto          45
      36: aload_0
      37: getfield      #194                // Field keyExchange:I
      40: bipush        24
      42: if_icmpne     45
      45: return

  public void validateCertificateRequest(org.bouncycastle.crypto.tls.CertificateRequest) throws java.io.IOException;
    Code:
       0: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
       3: dup
       4: bipush        10
       6: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
       9: athrow

  public void processClientCredentials(org.bouncycastle.crypto.tls.TlsCredentials) throws java.io.IOException;
    Code:
       0: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
       3: dup
       4: bipush        80
       6: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
       9: athrow

  public void generateClientKeyExchange(java.io.OutputStream) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #196                // Field psk_identity_hint:[B
       4: ifnonnull     19
       7: aload_0
       8: getfield      #207                // Field pskIdentity:Lorg/bouncycastle/crypto/tls/TlsPSKIdentity;
      11: invokeinterface #240,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsPSKIdentity.skipIdentityHint:()V
      16: goto          32
      19: aload_0
      20: getfield      #207                // Field pskIdentity:Lorg/bouncycastle/crypto/tls/TlsPSKIdentity;
      23: aload_0
      24: getfield      #196                // Field psk_identity_hint:[B
      27: invokeinterface #243,  2          // InterfaceMethod org/bouncycastle/crypto/tls/TlsPSKIdentity.notifyIdentityHint:([B)V
      32: aload_0
      33: getfield      #207                // Field pskIdentity:Lorg/bouncycastle/crypto/tls/TlsPSKIdentity;
      36: invokeinterface #242,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsPSKIdentity.getPSKIdentity:()[B
      41: astore_2
      42: aload_2
      43: aload_1
      44: invokestatic  #235                // Method org/bouncycastle/crypto/tls/TlsUtils.writeOpaque16:([BLjava/io/OutputStream;)V
      47: aload_0
      48: getfield      #194                // Field keyExchange:I
      51: bipush        14
      53: if_icmpne     83
      56: aload_0
      57: aload_0
      58: getfield      #205                // Field context:Lorg/bouncycastle/crypto/tls/TlsContext;
      61: invokeinterface #238,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.getSecureRandom:()Ljava/security/SecureRandom;
      66: aload_0
      67: getfield      #203                // Field dhAgreePublicKey:Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
      70: invokevirtual #216                // Method org/bouncycastle/crypto/params/DHPublicKeyParameters.getParameters:()Lorg/bouncycastle/crypto/params/DHParameters;
      73: aload_1
      74: invokestatic  #226                // Method org/bouncycastle/crypto/tls/TlsDHUtils.generateEphemeralClientKeyExchange:(Ljava/security/SecureRandom;Lorg/bouncycastle/crypto/params/DHParameters;Ljava/io/OutputStream;)Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
      77: putfield      #202                // Field dhAgreePrivateKey:Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
      80: goto          127
      83: aload_0
      84: getfield      #194                // Field keyExchange:I
      87: bipush        24
      89: if_icmpne     102
      92: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      95: dup
      96: bipush        80
      98: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     101: athrow
     102: aload_0
     103: getfield      #194                // Field keyExchange:I
     106: bipush        15
     108: if_icmpne     127
     111: aload_0
     112: aload_0
     113: getfield      #205                // Field context:Lorg/bouncycastle/crypto/tls/TlsContext;
     116: aload_0
     117: getfield      #204                // Field rsaServerPublicKey:Lorg/bouncycastle/crypto/params/RSAKeyParameters;
     120: aload_1
     121: invokestatic  #233                // Method org/bouncycastle/crypto/tls/TlsRSAUtils.generateEncryptedPreMasterSecret:(Lorg/bouncycastle/crypto/tls/TlsContext;Lorg/bouncycastle/crypto/params/RSAKeyParameters;Ljava/io/OutputStream;)[B
     124: putfield      #195                // Field premasterSecret:[B
     127: return

  public byte[] generatePremasterSecret() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #207                // Field pskIdentity:Lorg/bouncycastle/crypto/tls/TlsPSKIdentity;
       4: invokeinterface #241,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsPSKIdentity.getPSK:()[B
       9: astore_1
      10: aload_0
      11: aload_1
      12: arraylength
      13: invokevirtual #230                // Method generateOtherSecret:(I)[B
      16: astore_2
      17: new           #90                 // class java/io/ByteArrayOutputStream
      20: dup
      21: iconst_4
      22: aload_2
      23: arraylength
      24: iadd
      25: aload_1
      26: arraylength
      27: iadd
      28: invokespecial #211                // Method java/io/ByteArrayOutputStream."<init>":(I)V
      31: astore_3
      32: aload_2
      33: aload_3
      34: invokestatic  #235                // Method org/bouncycastle/crypto/tls/TlsUtils.writeOpaque16:([BLjava/io/OutputStream;)V
      37: aload_1
      38: aload_3
      39: invokestatic  #235                // Method org/bouncycastle/crypto/tls/TlsUtils.writeOpaque16:([BLjava/io/OutputStream;)V
      42: aload_3
      43: invokevirtual #210                // Method java/io/ByteArrayOutputStream.toByteArray:()[B
      46: areturn

  protected byte[] generateOtherSecret(int) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #194                // Field keyExchange:I
       4: bipush        14
       6: if_icmpne     38
       9: aload_0
      10: getfield      #202                // Field dhAgreePrivateKey:Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
      13: ifnull        28
      16: aload_0
      17: getfield      #203                // Field dhAgreePublicKey:Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;
      20: aload_0
      21: getfield      #202                // Field dhAgreePrivateKey:Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
      24: invokestatic  #224                // Method org/bouncycastle/crypto/tls/TlsDHUtils.calculateDHBasicAgreement:(Lorg/bouncycastle/crypto/params/DHPublicKeyParameters;Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;)[B
      27: areturn
      28: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      31: dup
      32: bipush        80
      34: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      37: athrow
      38: aload_0
      39: getfield      #194                // Field keyExchange:I
      42: bipush        24
      44: if_icmpne     57
      47: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      50: dup
      51: bipush        80
      53: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      56: athrow
      57: aload_0
      58: getfield      #194                // Field keyExchange:I
      61: bipush        15
      63: if_icmpne     71
      66: aload_0
      67: getfield      #195                // Field premasterSecret:[B
      70: areturn
      71: iload_1
      72: newarray       byte
      74: areturn

  protected org.bouncycastle.crypto.params.RSAKeyParameters validateRSAPublicKey(org.bouncycastle.crypto.params.RSAKeyParameters) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokevirtual #217                // Method org/bouncycastle/crypto/params/RSAKeyParameters.getExponent:()Ljava/math/BigInteger;
       4: iconst_2
       5: invokevirtual #213                // Method java/math/BigInteger.isProbablePrime:(I)Z
       8: ifne          21
      11: new           #106                // class org/bouncycastle/crypto/tls/TlsFatalAlert
      14: dup
      15: bipush        47
      17: invokespecial #228                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      20: athrow
      21: aload_1
      22: areturn
}
