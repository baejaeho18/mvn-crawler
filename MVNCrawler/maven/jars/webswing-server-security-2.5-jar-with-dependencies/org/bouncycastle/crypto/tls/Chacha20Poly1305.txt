public class org.bouncycastle.crypto.tls.Chacha20Poly1305 implements org.bouncycastle.crypto.tls.TlsCipher {
  protected org.bouncycastle.crypto.tls.TlsContext context;

  protected org.bouncycastle.crypto.engines.ChaChaEngine encryptCipher;

  protected org.bouncycastle.crypto.engines.ChaChaEngine decryptCipher;

  public org.bouncycastle.crypto.tls.Chacha20Poly1305(org.bouncycastle.crypto.tls.TlsContext) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokespecial #134                // Method java/lang/Object."<init>":()V
       4: aload_1
       5: invokestatic  #154                // Method org/bouncycastle/crypto/tls/TlsUtils.isTLSv12:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
       8: ifne          21
      11: new           #80                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
      14: dup
      15: bipush        80
      17: invokespecial #149                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      20: athrow
      21: aload_0
      22: aload_1
      23: putfield      #133                // Field context:Lorg/bouncycastle/crypto/tls/TlsContext;
      26: aload_1
      27: bipush        64
      29: invokestatic  #155                // Method org/bouncycastle/crypto/tls/TlsUtils.calculateKeyBlock:(Lorg/bouncycastle/crypto/tls/TlsContext;I)[B
      32: astore_2
      33: new           #75                 // class org/bouncycastle/crypto/params/KeyParameter
      36: dup
      37: aload_2
      38: iconst_0
      39: bipush        32
      41: invokespecial #142                // Method org/bouncycastle/crypto/params/KeyParameter."<init>":([BII)V
      44: astore_3
      45: new           #75                 // class org/bouncycastle/crypto/params/KeyParameter
      48: dup
      49: aload_2
      50: bipush        32
      52: bipush        32
      54: invokespecial #142                // Method org/bouncycastle/crypto/params/KeyParameter."<init>":([BII)V
      57: astore        4
      59: aload_0
      60: new           #72                 // class org/bouncycastle/crypto/engines/ChaChaEngine
      63: dup
      64: bipush        20
      66: invokespecial #136                // Method org/bouncycastle/crypto/engines/ChaChaEngine."<init>":(I)V
      69: putfield      #132                // Field encryptCipher:Lorg/bouncycastle/crypto/engines/ChaChaEngine;
      72: aload_0
      73: new           #72                 // class org/bouncycastle/crypto/engines/ChaChaEngine
      76: dup
      77: bipush        20
      79: invokespecial #136                // Method org/bouncycastle/crypto/engines/ChaChaEngine."<init>":(I)V
      82: putfield      #131                // Field decryptCipher:Lorg/bouncycastle/crypto/engines/ChaChaEngine;
      85: aload_1
      86: invokeinterface #163,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.isServer:()Z
      91: ifeq          104
      94: aload         4
      96: astore        5
      98: aload_3
      99: astore        6
     101: goto          111
     104: aload_3
     105: astore        5
     107: aload         4
     109: astore        6
     111: bipush        8
     113: newarray       byte
     115: astore        7
     117: aload_0
     118: getfield      #132                // Field encryptCipher:Lorg/bouncycastle/crypto/engines/ChaChaEngine;
     121: iconst_1
     122: new           #76                 // class org/bouncycastle/crypto/params/ParametersWithIV
     125: dup
     126: aload         5
     128: aload         7
     130: invokespecial #143                // Method org/bouncycastle/crypto/params/ParametersWithIV."<init>":(Lorg/bouncycastle/crypto/CipherParameters;[B)V
     133: invokevirtual #138                // Method org/bouncycastle/crypto/engines/ChaChaEngine.init:(ZLorg/bouncycastle/crypto/CipherParameters;)V
     136: aload_0
     137: getfield      #131                // Field decryptCipher:Lorg/bouncycastle/crypto/engines/ChaChaEngine;
     140: iconst_0
     141: new           #76                 // class org/bouncycastle/crypto/params/ParametersWithIV
     144: dup
     145: aload         6
     147: aload         7
     149: invokespecial #143                // Method org/bouncycastle/crypto/params/ParametersWithIV."<init>":(Lorg/bouncycastle/crypto/CipherParameters;[B)V
     152: invokevirtual #138                // Method org/bouncycastle/crypto/engines/ChaChaEngine.init:(ZLorg/bouncycastle/crypto/CipherParameters;)V
     155: return

  public int getPlaintextLimit(int);
    Code:
       0: iload_1
       1: bipush        16
       3: isub
       4: ireturn

  public byte[] encodePlaintext(long, short, byte[], int, int) throws java.io.IOException;
    Code:
       0: iload         6
       2: bipush        16
       4: iadd
       5: istore        7
       7: aload_0
       8: aload_0
       9: getfield      #132                // Field encryptCipher:Lorg/bouncycastle/crypto/engines/ChaChaEngine;
      12: iconst_1
      13: lload_1
      14: invokevirtual #148                // Method initRecordMAC:(Lorg/bouncycastle/crypto/engines/ChaChaEngine;ZJ)Lorg/bouncycastle/crypto/params/KeyParameter;
      17: astore        8
      19: iload         7
      21: newarray       byte
      23: astore        9
      25: aload_0
      26: getfield      #132                // Field encryptCipher:Lorg/bouncycastle/crypto/engines/ChaChaEngine;
      29: aload         4
      31: iload         5
      33: iload         6
      35: aload         9
      37: iconst_0
      38: invokevirtual #137                // Method org/bouncycastle/crypto/engines/ChaChaEngine.processBytes:([BII[BI)I
      41: pop
      42: aload_0
      43: lload_1
      44: iload_3
      45: iload         6
      47: invokevirtual #145                // Method getAdditionalData:(JSI)[B
      50: astore        10
      52: aload_0
      53: aload         8
      55: aload         10
      57: aload         9
      59: iconst_0
      60: iload         6
      62: invokevirtual #147                // Method calculateRecordMAC:(Lorg/bouncycastle/crypto/params/KeyParameter;[B[BII)[B
      65: astore        11
      67: aload         11
      69: iconst_0
      70: aload         9
      72: iload         6
      74: aload         11
      76: arraylength
      77: invokestatic  #135                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      80: aload         9
      82: areturn

  public byte[] decodeCiphertext(long, short, byte[], int, int) throws java.io.IOException;
    Code:
       0: aload_0
       1: iload         6
       3: invokevirtual #144                // Method getPlaintextLimit:(I)I
       6: ifge          19
       9: new           #80                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
      12: dup
      13: bipush        50
      15: invokespecial #149                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      18: athrow
      19: iload         6
      21: bipush        16
      23: isub
      24: istore        7
      26: aload         4
      28: iload         5
      30: iload         7
      32: iadd
      33: iload         5
      35: iload         6
      37: iadd
      38: invokestatic  #156                // Method org/bouncycastle/util/Arrays.copyOfRange:([BII)[B
      41: astore        8
      43: aload_0
      44: aload_0
      45: getfield      #131                // Field decryptCipher:Lorg/bouncycastle/crypto/engines/ChaChaEngine;
      48: iconst_0
      49: lload_1
      50: invokevirtual #148                // Method initRecordMAC:(Lorg/bouncycastle/crypto/engines/ChaChaEngine;ZJ)Lorg/bouncycastle/crypto/params/KeyParameter;
      53: astore        9
      55: aload_0
      56: lload_1
      57: iload_3
      58: iload         7
      60: invokevirtual #145                // Method getAdditionalData:(JSI)[B
      63: astore        10
      65: aload_0
      66: aload         9
      68: aload         10
      70: aload         4
      72: iload         5
      74: iload         7
      76: invokevirtual #147                // Method calculateRecordMAC:(Lorg/bouncycastle/crypto/params/KeyParameter;[B[BII)[B
      79: astore        11
      81: aload         11
      83: aload         8
      85: invokestatic  #157                // Method org/bouncycastle/util/Arrays.constantTimeAreEqual:([B[B)Z
      88: ifne          101
      91: new           #80                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
      94: dup
      95: bipush        20
      97: invokespecial #149                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     100: athrow
     101: iload         7
     103: newarray       byte
     105: astore        12
     107: aload_0
     108: getfield      #131                // Field decryptCipher:Lorg/bouncycastle/crypto/engines/ChaChaEngine;
     111: aload         4
     113: iload         5
     115: iload         7
     117: aload         12
     119: iconst_0
     120: invokevirtual #137                // Method org/bouncycastle/crypto/engines/ChaChaEngine.processBytes:([BII[BI)I
     123: pop
     124: aload         12
     126: areturn

  protected org.bouncycastle.crypto.params.KeyParameter initRecordMAC(org.bouncycastle.crypto.engines.ChaChaEngine, boolean, long);
    Code:
       0: bipush        8
       2: newarray       byte
       4: astore        5
       6: lload_3
       7: aload         5
       9: iconst_0
      10: invokestatic  #151                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint64:(J[BI)V
      13: aload_1
      14: iload_2
      15: new           #76                 // class org/bouncycastle/crypto/params/ParametersWithIV
      18: dup
      19: aconst_null
      20: aload         5
      22: invokespecial #143                // Method org/bouncycastle/crypto/params/ParametersWithIV."<init>":(Lorg/bouncycastle/crypto/CipherParameters;[B)V
      25: invokevirtual #138                // Method org/bouncycastle/crypto/engines/ChaChaEngine.init:(ZLorg/bouncycastle/crypto/CipherParameters;)V
      28: bipush        64
      30: newarray       byte
      32: astore        6
      34: aload_1
      35: aload         6
      37: iconst_0
      38: aload         6
      40: arraylength
      41: aload         6
      43: iconst_0
      44: invokevirtual #137                // Method org/bouncycastle/crypto/engines/ChaChaEngine.processBytes:([BII[BI)I
      47: pop
      48: aload         6
      50: iconst_0
      51: aload         6
      53: bipush        32
      55: bipush        16
      57: invokestatic  #135                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      60: new           #75                 // class org/bouncycastle/crypto/params/KeyParameter
      63: dup
      64: aload         6
      66: bipush        16
      68: bipush        32
      70: invokespecial #142                // Method org/bouncycastle/crypto/params/KeyParameter."<init>":([BII)V
      73: astore        7
      75: aload         7
      77: invokevirtual #141                // Method org/bouncycastle/crypto/params/KeyParameter.getKey:()[B
      80: invokestatic  #139                // Method org/bouncycastle/crypto/generators/Poly1305KeyGenerator.clamp:([B)V
      83: aload         7
      85: areturn

  protected byte[] calculateRecordMAC(org.bouncycastle.crypto.params.KeyParameter, byte[], byte[], int, int);
    Code:
       0: new           #74                 // class org/bouncycastle/crypto/macs/Poly1305
       3: dup
       4: invokespecial #140                // Method org/bouncycastle/crypto/macs/Poly1305."<init>":()V
       7: astore        6
       9: aload         6
      11: aload_1
      12: invokeinterface #162,  2          // InterfaceMethod org/bouncycastle/crypto/Mac.init:(Lorg/bouncycastle/crypto/CipherParameters;)V
      17: aload_0
      18: aload         6
      20: aload_2
      21: iconst_0
      22: aload_2
      23: arraylength
      24: invokevirtual #146                // Method updateRecordMAC:(Lorg/bouncycastle/crypto/Mac;[BII)V
      27: aload_0
      28: aload         6
      30: aload_3
      31: iload         4
      33: iload         5
      35: invokevirtual #146                // Method updateRecordMAC:(Lorg/bouncycastle/crypto/Mac;[BII)V
      38: aload         6
      40: invokeinterface #159,  1          // InterfaceMethod org/bouncycastle/crypto/Mac.getMacSize:()I
      45: newarray       byte
      47: astore        7
      49: aload         6
      51: aload         7
      53: iconst_0
      54: invokeinterface #160,  3          // InterfaceMethod org/bouncycastle/crypto/Mac.doFinal:([BI)I
      59: pop
      60: aload         7
      62: areturn

  protected void updateRecordMAC(org.bouncycastle.crypto.Mac, byte[], int, int);
    Code:
       0: aload_1
       1: aload_2
       2: iload_3
       3: iload         4
       5: invokeinterface #161,  4          // InterfaceMethod org/bouncycastle/crypto/Mac.update:([BII)V
      10: iload         4
      12: i2l
      13: ldc2_w        #66                 // long 4294967295l
      16: land
      17: invokestatic  #158                // Method org/bouncycastle/util/Pack.longToLittleEndian:(J)[B
      20: astore        5
      22: aload_1
      23: aload         5
      25: iconst_0
      26: aload         5
      28: arraylength
      29: invokeinterface #161,  4          // InterfaceMethod org/bouncycastle/crypto/Mac.update:([BII)V
      34: return

  protected byte[] getAdditionalData(long, short, int) throws java.io.IOException;
    Code:
       0: bipush        13
       2: newarray       byte
       4: astore        5
       6: lload_1
       7: aload         5
       9: iconst_0
      10: invokestatic  #151                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint64:(J[BI)V
      13: iload_3
      14: aload         5
      16: bipush        8
      18: invokestatic  #152                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint8:(S[BI)V
      21: aload_0
      22: getfield      #133                // Field context:Lorg/bouncycastle/crypto/tls/TlsContext;
      25: invokeinterface #164,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.getServerVersion:()Lorg/bouncycastle/crypto/tls/ProtocolVersion;
      30: aload         5
      32: bipush        9
      34: invokestatic  #153                // Method org/bouncycastle/crypto/tls/TlsUtils.writeVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;[BI)V
      37: iload         4
      39: aload         5
      41: bipush        11
      43: invokestatic  #150                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint16:(I[BI)V
      46: aload         5
      48: areturn
}
