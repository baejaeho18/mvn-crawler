Compiled from "DataDroppedPayloadSetter.java"
class io.mantisrx.server.worker.DataDroppedPayloadSetter {
  private static final java.lang.String metricNamePrefix;

  private static final org.slf4j.Logger logger;

  private static final double bigIncreaseThreshold;

  private final io.mantisrx.server.worker.Heartbeat heartbeat;

  private final java.util.concurrent.atomic.AtomicLong prevDroppedCount;

  private final java.util.concurrent.atomic.AtomicLong prevOnNextCount;

  private final com.fasterxml.jackson.databind.ObjectMapper objectMapper;

  private final java.util.concurrent.ScheduledThreadPoolExecutor executor;

  private final io.mantisrx.common.metrics.Gauge dropCountGauge;

  private final io.mantisrx.common.metrics.Gauge onNextCountGauge;

  io.mantisrx.server.worker.DataDroppedPayloadSetter(io.mantisrx.server.worker.Heartbeat);
    Code:
       0: aload_0
       1: invokespecial #3                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: new           #4                  // class java/util/concurrent/atomic/AtomicLong
       8: dup
       9: ldc2_w        #5                  // long -1l
      12: invokespecial #7                  // Method java/util/concurrent/atomic/AtomicLong."<init>":(J)V
      15: putfield      #8                  // Field prevDroppedCount:Ljava/util/concurrent/atomic/AtomicLong;
      18: aload_0
      19: new           #4                  // class java/util/concurrent/atomic/AtomicLong
      22: dup
      23: lconst_0
      24: invokespecial #7                  // Method java/util/concurrent/atomic/AtomicLong."<init>":(J)V
      27: putfield      #9                  // Field prevOnNextCount:Ljava/util/concurrent/atomic/AtomicLong;
      30: aload_0
      31: new           #10                 // class com/fasterxml/jackson/databind/ObjectMapper
      34: dup
      35: invokespecial #11                 // Method com/fasterxml/jackson/databind/ObjectMapper."<init>":()V
      38: putfield      #12                 // Field objectMapper:Lcom/fasterxml/jackson/databind/ObjectMapper;
      41: aload_0
      42: aload_1
      43: putfield      #13                 // Field heartbeat:Lio/mantisrx/server/worker/Heartbeat;
      46: aload_0
      47: getfield      #12                 // Field objectMapper:Lcom/fasterxml/jackson/databind/ObjectMapper;
      50: getstatic     #14                 // Field com/fasterxml/jackson/databind/DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES:Lcom/fasterxml/jackson/databind/DeserializationFeature;
      53: iconst_0
      54: invokevirtual #15                 // Method com/fasterxml/jackson/databind/ObjectMapper.configure:(Lcom/fasterxml/jackson/databind/DeserializationFeature;Z)Lcom/fasterxml/jackson/databind/ObjectMapper;
      57: pop
      58: aload_0
      59: new           #16                 // class java/util/concurrent/ScheduledThreadPoolExecutor
      62: dup
      63: iconst_1
      64: invokespecial #17                 // Method java/util/concurrent/ScheduledThreadPoolExecutor."<init>":(I)V
      67: putfield      #18                 // Field executor:Ljava/util/concurrent/ScheduledThreadPoolExecutor;
      70: new           #19                 // class io/mantisrx/common/metrics/Metrics$Builder
      73: dup
      74: invokespecial #20                 // Method io/mantisrx/common/metrics/Metrics$Builder."<init>":()V
      77: ldc           #21                 // String DataDrop
      79: invokevirtual #22                 // Method io/mantisrx/common/metrics/Metrics$Builder.name:(Ljava/lang/String;)Lio/mantisrx/common/metrics/Metrics$Builder;
      82: ldc           #23                 // String dropCount
      84: invokevirtual #24                 // Method io/mantisrx/common/metrics/Metrics$Builder.addGauge:(Ljava/lang/String;)Lio/mantisrx/common/metrics/Metrics$Builder;
      87: ldc           #25                 // String onNextCount
      89: invokevirtual #24                 // Method io/mantisrx/common/metrics/Metrics$Builder.addGauge:(Ljava/lang/String;)Lio/mantisrx/common/metrics/Metrics$Builder;
      92: invokevirtual #26                 // Method io/mantisrx/common/metrics/Metrics$Builder.build:()Lio/mantisrx/common/metrics/Metrics;
      95: astore_2
      96: invokestatic  #27                 // Method io/mantisrx/common/metrics/MetricsRegistry.getInstance:()Lio/mantisrx/common/metrics/MetricsRegistry;
      99: aload_2
     100: invokevirtual #28                 // Method io/mantisrx/common/metrics/MetricsRegistry.registerAndGet:(Lio/mantisrx/common/metrics/Metrics;)Lio/mantisrx/common/metrics/Metrics;
     103: astore_2
     104: aload_0
     105: aload_2
     106: ldc           #23                 // String dropCount
     108: invokevirtual #29                 // Method io/mantisrx/common/metrics/Metrics.getGauge:(Ljava/lang/String;)Lio/mantisrx/common/metrics/Gauge;
     111: putfield      #30                 // Field dropCountGauge:Lio/mantisrx/common/metrics/Gauge;
     114: aload_0
     115: aload_2
     116: ldc           #25                 // String onNextCount
     118: invokevirtual #29                 // Method io/mantisrx/common/metrics/Metrics.getGauge:(Ljava/lang/String;)Lio/mantisrx/common/metrics/Gauge;
     121: putfield      #31                 // Field onNextCountGauge:Lio/mantisrx/common/metrics/Gauge;
     124: return

  private void setPayload(long);
    Code:
       0: invokestatic  #27                 // Method io/mantisrx/common/metrics/MetricsRegistry.getInstance:()Lio/mantisrx/common/metrics/MetricsRegistry;
       3: getstatic     #32                 // Field metricNamePrefix:Ljava/lang/String;
       6: invokevirtual #33                 // Method io/mantisrx/common/metrics/MetricsRegistry.getMetrics:(Ljava/lang/String;)Ljava/util/Collection;
       9: astore_3
      10: lconst_0
      11: lstore        4
      13: lconst_0
      14: lstore        6
      16: lload_1
      17: lstore        8
      19: aload_3
      20: ifnull        404
      23: aload_3
      24: invokeinterface #34,  1           // InterfaceMethod java/util/Collection.isEmpty:()Z
      29: ifne          404
      32: aload_3
      33: invokeinterface #35,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      38: astore        10
      40: aload         10
      42: invokeinterface #36,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      47: ifeq          229
      50: aload         10
      52: invokeinterface #37,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      57: checkcast     #38                 // class io/mantisrx/common/metrics/Metrics
      60: astore        11
      62: aload         11
      64: new           #39                 // class java/lang/StringBuilder
      67: dup
      68: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
      71: ldc           #41                 // String
      73: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      76: getstatic     #43                 // Field io/reactivx/mantis/operators/DropOperator$Counters.dropped:Lio/reactivx/mantis/operators/DropOperator$Counters;
      79: invokevirtual #44                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      82: invokevirtual #45                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      85: invokevirtual #46                 // Method io/mantisrx/common/metrics/Metrics.getCounter:(Ljava/lang/String;)Lio/mantisrx/common/metrics/Counter;
      88: astore        12
      90: aload         11
      92: new           #39                 // class java/lang/StringBuilder
      95: dup
      96: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
      99: ldc           #41                 // String
     101: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     104: getstatic     #47                 // Field io/reactivx/mantis/operators/DropOperator$Counters.onNext:Lio/reactivx/mantis/operators/DropOperator$Counters;
     107: invokevirtual #44                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     110: invokevirtual #45                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     113: invokevirtual #46                 // Method io/mantisrx/common/metrics/Metrics.getCounter:(Ljava/lang/String;)Lio/mantisrx/common/metrics/Counter;
     116: astore        13
     118: aload         12
     120: ifnull        138
     123: lload         4
     125: aload         12
     127: invokeinterface #48,  1           // InterfaceMethod io/mantisrx/common/metrics/Counter.value:()J
     132: ladd
     133: lstore        4
     135: goto          172
     138: getstatic     #49                 // Field logger:Lorg/slf4j/Logger;
     141: new           #39                 // class java/lang/StringBuilder
     144: dup
     145: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
     148: ldc           #50                 // String Unexpected to get null dropped counter for metric
     150: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     153: aload         11
     155: invokevirtual #51                 // Method io/mantisrx/common/metrics/Metrics.getMetricGroupId:()Lio/mantisrx/common/metrics/spectator/MetricGroupId;
     158: invokevirtual #52                 // Method io/mantisrx/common/metrics/spectator/MetricGroupId.id:()Ljava/lang/String;
     161: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     164: invokevirtual #45                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     167: invokeinterface #53,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     172: aload         13
     174: ifnull        192
     177: lload         6
     179: aload         13
     181: invokeinterface #48,  1           // InterfaceMethod io/mantisrx/common/metrics/Counter.value:()J
     186: ladd
     187: lstore        6
     189: goto          226
     192: getstatic     #49                 // Field logger:Lorg/slf4j/Logger;
     195: new           #39                 // class java/lang/StringBuilder
     198: dup
     199: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
     202: ldc           #54                 // String Unexpected to get null onNext counter for metric
     204: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     207: aload         11
     209: invokevirtual #51                 // Method io/mantisrx/common/metrics/Metrics.getMetricGroupId:()Lio/mantisrx/common/metrics/spectator/MetricGroupId;
     212: invokevirtual #52                 // Method io/mantisrx/common/metrics/spectator/MetricGroupId.id:()Ljava/lang/String;
     215: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     218: invokevirtual #45                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     221: invokeinterface #53,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     226: goto          40
     229: aload_0
     230: aload_0
     231: getfield      #8                  // Field prevDroppedCount:Ljava/util/concurrent/atomic/AtomicLong;
     234: invokevirtual #55                 // Method java/util/concurrent/atomic/AtomicLong.get:()J
     237: lload         4
     239: invokespecial #56                 // Method isBigChange:(JJ)Z
     242: ifne          253
     245: lload         8
     247: ldc2_w        #57                 // long 2l
     250: lmul
     251: lstore        8
     253: new           #59                 // class io/mantisrx/server/core/StatusPayloads$DataDropCounts
     256: dup
     257: lload         6
     259: aload_0
     260: getfield      #9                  // Field prevOnNextCount:Ljava/util/concurrent/atomic/AtomicLong;
     263: invokevirtual #55                 // Method java/util/concurrent/atomic/AtomicLong.get:()J
     266: lsub
     267: lload         4
     269: aload_0
     270: getfield      #8                  // Field prevDroppedCount:Ljava/util/concurrent/atomic/AtomicLong;
     273: invokevirtual #55                 // Method java/util/concurrent/atomic/AtomicLong.get:()J
     276: lsub
     277: invokespecial #60                 // Method io/mantisrx/server/core/StatusPayloads$DataDropCounts."<init>":(JJ)V
     280: astore        10
     282: aload_0
     283: getfield      #13                 // Field heartbeat:Lio/mantisrx/server/worker/Heartbeat;
     286: new           #39                 // class java/lang/StringBuilder
     289: dup
     290: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
     293: ldc           #41                 // String
     295: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     298: getstatic     #61                 // Field io/mantisrx/server/core/StatusPayloads$Type.IncomingDataDrop:Lio/mantisrx/server/core/StatusPayloads$Type;
     301: invokevirtual #44                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     304: invokevirtual #45                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     307: aload_0
     308: getfield      #12                 // Field objectMapper:Lcom/fasterxml/jackson/databind/ObjectMapper;
     311: aload         10
     313: invokevirtual #62                 // Method com/fasterxml/jackson/databind/ObjectMapper.writeValueAsString:(Ljava/lang/Object;)Ljava/lang/String;
     316: invokevirtual #63                 // Method io/mantisrx/server/worker/Heartbeat.addSingleUsePayload:(Ljava/lang/String;Ljava/lang/String;)V
     319: goto          355
     322: astore        11
     324: getstatic     #49                 // Field logger:Lorg/slf4j/Logger;
     327: new           #39                 // class java/lang/StringBuilder
     330: dup
     331: invokespecial #40                 // Method java/lang/StringBuilder."<init>":()V
     334: ldc           #65                 // String Error writing json for dataDrop payload:
     336: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     339: aload         11
     341: invokevirtual #66                 // Method com/fasterxml/jackson/core/JsonProcessingException.getMessage:()Ljava/lang/String;
     344: invokevirtual #42                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     347: invokevirtual #45                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     350: invokeinterface #53,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     355: aload_0
     356: getfield      #30                 // Field dropCountGauge:Lio/mantisrx/common/metrics/Gauge;
     359: aload         10
     361: invokevirtual #67                 // Method io/mantisrx/server/core/StatusPayloads$DataDropCounts.getDroppedCount:()J
     364: invokeinterface #68,  3           // InterfaceMethod io/mantisrx/common/metrics/Gauge.set:(J)V
     369: aload_0
     370: getfield      #31                 // Field onNextCountGauge:Lio/mantisrx/common/metrics/Gauge;
     373: aload         10
     375: invokevirtual #69                 // Method io/mantisrx/server/core/StatusPayloads$DataDropCounts.getOnNextCount:()J
     378: invokeinterface #68,  3           // InterfaceMethod io/mantisrx/common/metrics/Gauge.set:(J)V
     383: aload_0
     384: getfield      #8                  // Field prevDroppedCount:Ljava/util/concurrent/atomic/AtomicLong;
     387: lload         4
     389: invokevirtual #70                 // Method java/util/concurrent/atomic/AtomicLong.set:(J)V
     392: aload_0
     393: getfield      #9                  // Field prevOnNextCount:Ljava/util/concurrent/atomic/AtomicLong;
     396: lload         6
     398: invokevirtual #70                 // Method java/util/concurrent/atomic/AtomicLong.set:(J)V
     401: goto          414
     404: getstatic     #49                 // Field logger:Lorg/slf4j/Logger;
     407: ldc           #71                 // String Got no metrics from DropOperator
     409: invokeinterface #53,  2           // InterfaceMethod org/slf4j/Logger.warn:(Ljava/lang/String;)V
     414: goto          434
     417: astore        10
     419: getstatic     #49                 // Field logger:Lorg/slf4j/Logger;
     422: aload         10
     424: invokevirtual #73                 // Method java/lang/Exception.getMessage:()Ljava/lang/String;
     427: aload         10
     429: invokeinterface #74,  3           // InterfaceMethod org/slf4j/Logger.error:(Ljava/lang/String;Ljava/lang/Throwable;)V
     434: aload_0
     435: getfield      #18                 // Field executor:Ljava/util/concurrent/ScheduledThreadPoolExecutor;
     438: new           #75                 // class io/mantisrx/server/worker/DataDroppedPayloadSetter$1
     441: dup
     442: aload_0
     443: lload_1
     444: invokespecial #76                 // Method io/mantisrx/server/worker/DataDroppedPayloadSetter$1."<init>":(Lio/mantisrx/server/worker/DataDroppedPayloadSetter;J)V
     447: lload         8
     449: getstatic     #77                 // Field java/util/concurrent/TimeUnit.SECONDS:Ljava/util/concurrent/TimeUnit;
     452: invokevirtual #78                 // Method java/util/concurrent/ScheduledThreadPoolExecutor.schedule:(Ljava/lang/Runnable;JLjava/util/concurrent/TimeUnit;)Ljava/util/concurrent/ScheduledFuture;
     455: pop
     456: return
    Exception table:
       from    to  target type
         282   319   322   Class com/fasterxml/jackson/core/JsonProcessingException
          19   414   417   Class java/lang/Exception

  private boolean isBigChange(long, long);
    Code:
       0: lload_1
       1: lconst_0
       2: lcmp
       3: ifge          8
       6: iconst_1
       7: ireturn
       8: lload_1
       9: lconst_0
      10: lcmp
      11: ifne          26
      14: lload_3
      15: lconst_0
      16: lcmp
      17: ifeq          24
      20: iconst_1
      21: goto          25
      24: iconst_0
      25: ireturn
      26: lload_3
      27: lconst_0
      28: lcmp
      29: ifne          34
      32: iconst_1
      33: ireturn
      34: lload_3
      35: lload_1
      36: lsub
      37: invokestatic  #79                 // Method java/lang/Math.abs:(J)J
      40: l2d
      41: lload_3
      42: l2d
      43: ddiv
      44: ldc2_w        #81                 // double 0.05d
      47: dcmpl
      48: ifle          55
      51: iconst_1
      52: goto          56
      55: iconst_0
      56: ireturn

  void start(long);
    Code:
       0: aload_0
       1: getfield      #18                 // Field executor:Ljava/util/concurrent/ScheduledThreadPoolExecutor;
       4: new           #83                 // class io/mantisrx/server/worker/DataDroppedPayloadSetter$2
       7: dup
       8: aload_0
       9: lload_1
      10: invokespecial #84                 // Method io/mantisrx/server/worker/DataDroppedPayloadSetter$2."<init>":(Lio/mantisrx/server/worker/DataDroppedPayloadSetter;J)V
      13: lload_1
      14: getstatic     #77                 // Field java/util/concurrent/TimeUnit.SECONDS:Ljava/util/concurrent/TimeUnit;
      17: invokevirtual #78                 // Method java/util/concurrent/ScheduledThreadPoolExecutor.schedule:(Ljava/lang/Runnable;JLjava/util/concurrent/TimeUnit;)Ljava/util/concurrent/ScheduledFuture;
      20: pop
      21: return

  static void access$000(io.mantisrx.server.worker.DataDroppedPayloadSetter, long);
    Code:
       0: aload_0
       1: lload_1
       2: invokespecial #2                  // Method setPayload:(J)V
       5: return

  static {};
    Code:
       0: getstatic     #85                 // Field com/mantisrx/common/utils/MantisMetricStringConstants.DROP_OPERATOR_INCOMING_METRIC_GROUP:Ljava/lang/String;
       3: putstatic     #32                 // Field metricNamePrefix:Ljava/lang/String;
       6: ldc           #80                 // class io/mantisrx/server/worker/DataDroppedPayloadSetter
       8: invokestatic  #86                 // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      11: putstatic     #49                 // Field logger:Lorg/slf4j/Logger;
      14: return
}
