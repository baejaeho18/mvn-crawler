Compiled from "IdentityApplyCallback.java"
class org.jboss.as.patching.runner.IdentityApplyCallback implements org.jboss.as.patching.runner.IdentityPatchContext$FinalizeCallback {
  private final java.lang.String patchId;

  private final org.jboss.as.patching.metadata.Patch original;

  private final org.jboss.as.patching.DirectoryStructure structure;

  public org.jboss.as.patching.runner.IdentityApplyCallback(org.jboss.as.patching.metadata.Patch, org.jboss.as.patching.DirectoryStructure);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: invokeinterface #2,  1            // InterfaceMethod org/jboss/as/patching/metadata/Patch.getPatchId:()Ljava/lang/String;
      11: putfield      #3                  // Field patchId:Ljava/lang/String;
      14: aload_0
      15: aload_1
      16: putfield      #4                  // Field original:Lorg/jboss/as/patching/metadata/Patch;
      19: aload_0
      20: aload_2
      21: putfield      #5                  // Field structure:Lorg/jboss/as/patching/DirectoryStructure;
      24: return

  public org.jboss.as.patching.metadata.Patch getPatch();
    Code:
       0: aload_0
       1: getfield      #4                  // Field original:Lorg/jboss/as/patching/metadata/Patch;
       4: areturn

  public void finishPatch(org.jboss.as.patching.metadata.Patch, org.jboss.as.patching.metadata.RollbackPatch, org.jboss.as.patching.runner.IdentityPatchContext) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #5                  // Field structure:Lorg/jboss/as/patching/DirectoryStructure;
       4: invokevirtual #6                  // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
       7: aload_0
       8: getfield      #3                  // Field patchId:Ljava/lang/String;
      11: invokeinterface #7,  2            // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getPatchHistoryDir:(Ljava/lang/String;)Ljava/io/File;
      16: astore        4
      18: aload         4
      20: invokevirtual #8                  // Method java/io/File.exists:()Z
      23: ifne          32
      26: aload         4
      28: invokevirtual #9                  // Method java/io/File.mkdirs:()Z
      31: pop
      32: new           #10                 // class java/io/File
      35: dup
      36: aload         4
      38: ldc           #12                 // String timestamp
      40: invokespecial #13                 // Method java/io/File."<init>":(Ljava/io/File;Ljava/lang/String;)V
      43: astore        5
      45: aload         5
      47: invokestatic  #14                 // Method org/jboss/as/patching/runner/PatchUtils.generateTimestamp:()Ljava/lang/String;
      50: invokestatic  #15                 // Method org/jboss/as/patching/runner/PatchUtils.writeRef:(Ljava/io/File;Ljava/lang/String;)V
      53: new           #10                 // class java/io/File
      56: dup
      57: aload         4
      59: ldc           #17                 // String patch.xml
      61: invokespecial #13                 // Method java/io/File."<init>":(Ljava/io/File;Ljava/lang/String;)V
      64: astore        6
      66: aload_1
      67: aload         6
      69: invokestatic  #18                 // Method org/jboss/as/patching/runner/IdentityPatchContext.writePatch:(Lorg/jboss/as/patching/metadata/Patch;Ljava/io/File;)V
      72: new           #10                 // class java/io/File
      75: dup
      76: aload         4
      78: ldc           #19                 // String rollback.xml
      80: invokespecial #13                 // Method java/io/File."<init>":(Ljava/io/File;Ljava/lang/String;)V
      83: astore        7
      85: aload_2
      86: aload         7
      88: invokestatic  #18                 // Method org/jboss/as/patching/runner/IdentityPatchContext.writePatch:(Lorg/jboss/as/patching/metadata/Patch;Ljava/io/File;)V
      91: aload_3
      92: invokevirtual #20                 // Method org/jboss/as/patching/runner/IdentityPatchContext.backupConfiguration:()V
      95: return

  public void completed(org.jboss.as.patching.runner.IdentityPatchContext);
    Code:
       0: return

  public void operationCancelled(org.jboss.as.patching.runner.IdentityPatchContext);
    Code:
       0: aload_0
       1: getfield      #5                  // Field structure:Lorg/jboss/as/patching/DirectoryStructure;
       4: invokevirtual #6                  // Method org/jboss/as/patching/DirectoryStructure.getInstalledImage:()Lorg/jboss/as/patching/installation/InstalledImage;
       7: astore_2
       8: aload_2
       9: aload_0
      10: getfield      #3                  // Field patchId:Ljava/lang/String;
      13: invokeinterface #7,  2            // InterfaceMethod org/jboss/as/patching/installation/InstalledImage.getPatchHistoryDir:(Ljava/lang/String;)Ljava/io/File;
      18: invokestatic  #21                 // Method org/jboss/as/patching/IoUtils.recursiveDelete:(Ljava/io/File;)Z
      21: pop
      22: aload_0
      23: getfield      #5                  // Field structure:Lorg/jboss/as/patching/DirectoryStructure;
      26: aload_0
      27: getfield      #3                  // Field patchId:Ljava/lang/String;
      30: invokevirtual #22                 // Method org/jboss/as/patching/DirectoryStructure.getBundlesPatchDirectory:(Ljava/lang/String;)Ljava/io/File;
      33: invokestatic  #21                 // Method org/jboss/as/patching/IoUtils.recursiveDelete:(Ljava/io/File;)Z
      36: pop
      37: aload_0
      38: getfield      #5                  // Field structure:Lorg/jboss/as/patching/DirectoryStructure;
      41: aload_0
      42: getfield      #3                  // Field patchId:Ljava/lang/String;
      45: invokevirtual #23                 // Method org/jboss/as/patching/DirectoryStructure.getModulePatchDirectory:(Ljava/lang/String;)Ljava/io/File;
      48: invokestatic  #21                 // Method org/jboss/as/patching/IoUtils.recursiveDelete:(Ljava/io/File;)Z
      51: pop
      52: aload_0
      53: getfield      #4                  // Field original:Lorg/jboss/as/patching/metadata/Patch;
      56: invokeinterface #24,  1           // InterfaceMethod org/jboss/as/patching/metadata/Patch.getElements:()Ljava/util/List;
      61: invokeinterface #25,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      66: astore_3
      67: aload_3
      68: invokeinterface #26,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      73: ifeq          163
      76: aload_3
      77: invokeinterface #27,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      82: checkcast     #28                 // class org/jboss/as/patching/metadata/PatchElement
      85: astore        4
      87: aload         4
      89: invokeinterface #29,  1           // InterfaceMethod org/jboss/as/patching/metadata/PatchElement.getProvider:()Lorg/jboss/as/patching/metadata/PatchElementProvider;
      94: invokeinterface #30,  1           // InterfaceMethod org/jboss/as/patching/metadata/PatchElementProvider.isAddOn:()Z
      99: istore        5
     101: aload_1
     102: aload         4
     104: invokeinterface #29,  1           // InterfaceMethod org/jboss/as/patching/metadata/PatchElement.getProvider:()Lorg/jboss/as/patching/metadata/PatchElementProvider;
     109: invokeinterface #31,  1           // InterfaceMethod org/jboss/as/patching/metadata/PatchElementProvider.getName:()Ljava/lang/String;
     114: iload         5
     116: invokevirtual #32                 // Method org/jboss/as/patching/runner/IdentityPatchContext.getEntry:(Ljava/lang/String;Z)Lorg/jboss/as/patching/runner/IdentityPatchContext$PatchEntry;
     119: astore        6
     121: aload         6
     123: invokevirtual #33                 // Method org/jboss/as/patching/runner/IdentityPatchContext$PatchEntry.getDirectoryStructure:()Lorg/jboss/as/patching/DirectoryStructure;
     126: astore        7
     128: aload         7
     130: aload         4
     132: invokeinterface #34,  1           // InterfaceMethod org/jboss/as/patching/metadata/PatchElement.getId:()Ljava/lang/String;
     137: invokevirtual #22                 // Method org/jboss/as/patching/DirectoryStructure.getBundlesPatchDirectory:(Ljava/lang/String;)Ljava/io/File;
     140: invokestatic  #21                 // Method org/jboss/as/patching/IoUtils.recursiveDelete:(Ljava/io/File;)Z
     143: pop
     144: aload         7
     146: aload         4
     148: invokeinterface #34,  1           // InterfaceMethod org/jboss/as/patching/metadata/PatchElement.getId:()Ljava/lang/String;
     153: invokevirtual #23                 // Method org/jboss/as/patching/DirectoryStructure.getModulePatchDirectory:(Ljava/lang/String;)Ljava/io/File;
     156: invokestatic  #21                 // Method org/jboss/as/patching/IoUtils.recursiveDelete:(Ljava/io/File;)Z
     159: pop
     160: goto          67
     163: return
}
