Compiled from "SecurityService.java"
public class org.jumpmind.symmetric.service.impl.SecurityService implements org.jumpmind.symmetric.service.ISecurityService {
  protected org.slf4j.Logger log;

  protected javax.crypto.SecretKey secretKey;

  protected java.security.SecureRandom secRand;

  public org.jumpmind.symmetric.service.impl.SecurityService();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_0
       6: invokevirtual #2                  // Method java/lang/Object.getClass:()Ljava/lang/Class;
       9: invokestatic  #3                  // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
      12: putfield      #4                  // Field log:Lorg/slf4j/Logger;
      15: return

  public void init();
    Code:
       0: return

  public java.lang.String encrypt(java.lang.String);
    Code:
       0: aload_1
       1: ldc           #5                  // String UTF8
       3: invokevirtual #6                  // Method java/lang/String.getBytes:(Ljava/lang/String;)[B
       6: astore_2
       7: aload_0
       8: iconst_1
       9: invokevirtual #7                  // Method getCipher:(I)Ljavax/crypto/Cipher;
      12: aload_2
      13: invokevirtual #8                  // Method javax/crypto/Cipher.doFinal:([B)[B
      16: astore_3
      17: new           #9                  // class java/lang/String
      20: dup
      21: aload_3
      22: invokestatic  #10                 // Method org/apache/commons/codec/binary/Base64.encodeBase64:([B)[B
      25: ldc           #5                  // String UTF8
      27: invokespecial #11                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
      30: areturn
      31: astore_2
      32: new           #13                 // class java/lang/RuntimeException
      35: dup
      36: aload_2
      37: invokespecial #14                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
      40: athrow
    Exception table:
       from    to  target type
           0    30    31   Class java/lang/Exception

  public java.lang.String decrypt(java.lang.String);
    Code:
       0: aload_1
       1: invokevirtual #15                 // Method java/lang/String.getBytes:()[B
       4: invokestatic  #16                 // Method org/apache/commons/codec/binary/Base64.decodeBase64:([B)[B
       7: astore_2
       8: aload_0
       9: iconst_2
      10: invokevirtual #7                  // Method getCipher:(I)Ljavax/crypto/Cipher;
      13: aload_2
      14: invokevirtual #8                  // Method javax/crypto/Cipher.doFinal:([B)[B
      17: astore_3
      18: new           #9                  // class java/lang/String
      21: dup
      22: aload_3
      23: ldc           #5                  // String UTF8
      25: invokespecial #11                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
      28: areturn
      29: astore_2
      30: new           #13                 // class java/lang/RuntimeException
      33: dup
      34: aload_2
      35: invokespecial #14                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
      38: athrow
    Exception table:
       from    to  target type
           0    28    29   Class java/lang/Exception

  protected javax.crypto.Cipher getCipher(int) throws java.lang.Exception;
    Code:
       0: aload_0
       1: getfield      #17                 // Field secretKey:Ljavax/crypto/SecretKey;
       4: ifnonnull     15
       7: aload_0
       8: aload_0
       9: invokevirtual #18                 // Method getSecretKey:()Ljavax/crypto/SecretKey;
      12: putfield      #17                 // Field secretKey:Ljavax/crypto/SecretKey;
      15: aload_0
      16: getfield      #17                 // Field secretKey:Ljavax/crypto/SecretKey;
      19: invokeinterface #19,  1           // InterfaceMethod javax/crypto/SecretKey.getAlgorithm:()Ljava/lang/String;
      24: invokestatic  #20                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
      27: astore_2
      28: aload_0
      29: aload_2
      30: iload_1
      31: invokevirtual #21                 // Method initializeCipher:(Ljavax/crypto/Cipher;I)V
      34: aload_0
      35: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      38: ldc           #22                 // String Using {} algorithm provided by {}.
      40: aload_2
      41: invokevirtual #23                 // Method javax/crypto/Cipher.getAlgorithm:()Ljava/lang/String;
      44: aload_2
      45: invokevirtual #24                 // Method javax/crypto/Cipher.getProvider:()Ljava/security/Provider;
      48: invokevirtual #25                 // Method java/security/Provider.getName:()Ljava/lang/String;
      51: invokeinterface #26,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      56: aload_2
      57: areturn

  protected void initializeCipher(javax.crypto.Cipher, int) throws java.lang.Exception;
    Code:
       0: aload_1
       1: invokevirtual #23                 // Method javax/crypto/Cipher.getAlgorithm:()Ljava/lang/String;
       4: invokestatic  #27                 // Method javax/crypto/Cipher.getMaxAllowedParameterSpec:(Ljava/lang/String;)Ljava/security/spec/AlgorithmParameterSpec;
       7: astore_3
       8: aload_3
       9: instanceof    #28                 // class javax/crypto/spec/PBEParameterSpec
      12: ifne          31
      15: aload_3
      16: ifnonnull     56
      19: aload_1
      20: invokevirtual #23                 // Method javax/crypto/Cipher.getAlgorithm:()Ljava/lang/String;
      23: ldc           #29                 // String PBE
      25: invokevirtual #30                 // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      28: ifeq          56
      31: new           #28                 // class javax/crypto/spec/PBEParameterSpec
      34: dup
      35: getstatic     #31                 // Field org/jumpmind/symmetric/common/SecurityConstants.SALT:[B
      38: iconst_3
      39: invokespecial #32                 // Method javax/crypto/spec/PBEParameterSpec."<init>":([BI)V
      42: astore_3
      43: aload_1
      44: iload_2
      45: aload_0
      46: getfield      #17                 // Field secretKey:Ljavax/crypto/SecretKey;
      49: aload_3
      50: invokevirtual #33                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
      53: goto          100
      56: aload_3
      57: instanceof    #34                 // class javax/crypto/spec/IvParameterSpec
      60: ifeq          87
      63: new           #34                 // class javax/crypto/spec/IvParameterSpec
      66: dup
      67: getstatic     #31                 // Field org/jumpmind/symmetric/common/SecurityConstants.SALT:[B
      70: invokespecial #35                 // Method javax/crypto/spec/IvParameterSpec."<init>":([B)V
      73: astore_3
      74: aload_1
      75: iload_2
      76: aload_0
      77: getfield      #17                 // Field secretKey:Ljavax/crypto/SecretKey;
      80: aload_3
      81: invokevirtual #33                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
      84: goto          100
      87: aload_1
      88: iload_2
      89: aload_0
      90: getfield      #17                 // Field secretKey:Ljavax/crypto/SecretKey;
      93: aconst_null
      94: checkcast     #36                 // class java/security/spec/AlgorithmParameterSpec
      97: invokevirtual #33                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
     100: return

  protected javax.crypto.SecretKey getSecretKey() throws java.lang.Exception;
    Code:
       0: ldc           #37                 // String javax.net.ssl.keyStorePassword
       2: invokestatic  #38                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       5: astore_1
       6: aload_1
       7: ifnull        14
      10: aload_1
      11: goto          16
      14: ldc           #39                 // String changeit
      16: astore_1
      17: new           #40                 // class java/security/KeyStore$PasswordProtection
      20: dup
      21: aload_1
      22: invokevirtual #41                 // Method java/lang/String.toCharArray:()[C
      25: invokespecial #42                 // Method java/security/KeyStore$PasswordProtection."<init>":([C)V
      28: astore_2
      29: aload_0
      30: aload_1
      31: invokevirtual #43                 // Method getKeyStore:(Ljava/lang/String;)Ljava/security/KeyStore;
      34: astore_3
      35: aload_3
      36: ldc           #44                 // String sym.secret
      38: aload_2
      39: invokevirtual #45                 // Method java/security/KeyStore.getEntry:(Ljava/lang/String;Ljava/security/KeyStore$ProtectionParameter;)Ljava/security/KeyStore$Entry;
      42: checkcast     #46                 // class java/security/KeyStore$SecretKeyEntry
      45: astore        4
      47: aload         4
      49: ifnonnull     94
      52: aload_0
      53: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      56: ldc           #47                 // String Generating secret key
      58: invokeinterface #48,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
      63: new           #46                 // class java/security/KeyStore$SecretKeyEntry
      66: dup
      67: aload_0
      68: invokevirtual #49                 // Method getDefaultSecretKey:()Ljavax/crypto/SecretKey;
      71: invokespecial #50                 // Method java/security/KeyStore$SecretKeyEntry."<init>":(Ljavax/crypto/SecretKey;)V
      74: astore        4
      76: aload_3
      77: ldc           #44                 // String sym.secret
      79: aload         4
      81: aload_2
      82: invokevirtual #51                 // Method java/security/KeyStore.setEntry:(Ljava/lang/String;Ljava/security/KeyStore$Entry;Ljava/security/KeyStore$ProtectionParameter;)V
      85: aload_0
      86: aload_3
      87: aload_1
      88: invokevirtual #52                 // Method saveKeyStore:(Ljava/security/KeyStore;Ljava/lang/String;)V
      91: goto          105
      94: aload_0
      95: getfield      #4                  // Field log:Lorg/slf4j/Logger;
      98: ldc           #53                 // String Retrieving secret key
     100: invokeinterface #48,  2           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;)V
     105: aload         4
     107: invokevirtual #54                 // Method java/security/KeyStore$SecretKeyEntry.getSecretKey:()Ljavax/crypto/SecretKey;
     110: areturn

  private java.security.SecureRandom getSecRan();
    Code:
       0: aload_0
       1: getfield      #55                 // Field secRand:Ljava/security/SecureRandom;
       4: ifnonnull     28
       7: aload_0
       8: new           #56                 // class java/security/SecureRandom
      11: dup
      12: invokespecial #57                 // Method java/security/SecureRandom."<init>":()V
      15: putfield      #55                 // Field secRand:Ljava/security/SecureRandom;
      18: aload_0
      19: getfield      #55                 // Field secRand:Ljava/security/SecureRandom;
      22: invokestatic  #58                 // Method java/lang/System.currentTimeMillis:()J
      25: invokevirtual #59                 // Method java/security/SecureRandom.setSeed:(J)V
      28: aload_0
      29: getfield      #55                 // Field secRand:Ljava/security/SecureRandom;
      32: areturn

  public java.lang.String nextSecureHexString(int);
    Code:
       0: iload_1
       1: ifgt          14
       4: new           #60                 // class java/lang/IllegalArgumentException
       7: dup
       8: ldc           #61                 // String length must be positive
      10: invokespecial #62                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      13: athrow
      14: aload_0
      15: invokespecial #63                 // Method getSecRan:()Ljava/security/SecureRandom;
      18: astore_2
      19: aconst_null
      20: astore_3
      21: ldc           #64                 // String SHA-1
      23: invokestatic  #65                 // Method java/security/MessageDigest.getInstance:(Ljava/lang/String;)Ljava/security/MessageDigest;
      26: astore_3
      27: goto          34
      30: astore        4
      32: aconst_null
      33: areturn
      34: aload_3
      35: invokevirtual #67                 // Method java/security/MessageDigest.reset:()V
      38: iload_1
      39: bipush        40
      41: idiv
      42: iconst_1
      43: iadd
      44: istore        4
      46: new           #68                 // class java/lang/StringBuffer
      49: dup
      50: invokespecial #69                 // Method java/lang/StringBuffer."<init>":()V
      53: astore        5
      55: iconst_1
      56: istore        6
      58: iload         6
      60: iload         4
      62: iconst_1
      63: iadd
      64: if_icmpge     181
      67: bipush        40
      69: newarray       byte
      71: astore        7
      73: aload_2
      74: aload         7
      76: invokevirtual #70                 // Method java/security/SecureRandom.nextBytes:([B)V
      79: aload_3
      80: aload         7
      82: invokevirtual #71                 // Method java/security/MessageDigest.update:([B)V
      85: aload_3
      86: invokevirtual #72                 // Method java/security/MessageDigest.digest:()[B
      89: astore        8
      91: iconst_0
      92: istore        9
      94: iload         9
      96: aload         8
      98: arraylength
      99: if_icmpge     175
     102: new           #73                 // class java/lang/Integer
     105: dup
     106: aload         8
     108: iload         9
     110: baload
     111: invokespecial #74                 // Method java/lang/Integer."<init>":(I)V
     114: astore        10
     116: aload         10
     118: invokevirtual #75                 // Method java/lang/Integer.intValue:()I
     121: sipush        128
     124: iadd
     125: invokestatic  #76                 // Method java/lang/Integer.toHexString:(I)Ljava/lang/String;
     128: astore        11
     130: aload         11
     132: invokevirtual #77                 // Method java/lang/String.length:()I
     135: iconst_1
     136: if_icmpne     161
     139: new           #78                 // class java/lang/StringBuilder
     142: dup
     143: invokespecial #79                 // Method java/lang/StringBuilder."<init>":()V
     146: ldc           #80                 // String 0
     148: invokevirtual #81                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     151: aload         11
     153: invokevirtual #81                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     156: invokevirtual #82                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     159: astore        11
     161: aload         5
     163: aload         11
     165: invokevirtual #83                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     168: pop
     169: iinc          9, 1
     172: goto          94
     175: iinc          6, 1
     178: goto          58
     181: aload         5
     183: invokevirtual #84                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
     186: iconst_0
     187: iload_1
     188: invokevirtual #85                 // Method java/lang/String.substring:(II)Ljava/lang/String;
     191: areturn
    Exception table:
       from    to  target type
          21    27    30   Class java/security/NoSuchAlgorithmException

  protected javax.crypto.SecretKey getDefaultSecretKey() throws java.lang.Exception;
    Code:
       0: aload_0
       1: bipush        8
       3: invokevirtual #86                 // Method nextSecureHexString:(I)Ljava/lang/String;
       6: astore_1
       7: new           #87                 // class javax/crypto/spec/PBEKeySpec
      10: dup
      11: aload_1
      12: invokevirtual #41                 // Method java/lang/String.toCharArray:()[C
      15: getstatic     #31                 // Field org/jumpmind/symmetric/common/SecurityConstants.SALT:[B
      18: iconst_3
      19: bipush        56
      21: invokespecial #88                 // Method javax/crypto/spec/PBEKeySpec."<init>":([C[BII)V
      24: astore_2
      25: getstatic     #89                 // Field org/jumpmind/symmetric/common/SecurityConstants.ALGORITHM:Ljava/lang/String;
      28: invokestatic  #90                 // Method javax/crypto/SecretKeyFactory.getInstance:(Ljava/lang/String;)Ljavax/crypto/SecretKeyFactory;
      31: aload_2
      32: invokevirtual #91                 // Method javax/crypto/SecretKeyFactory.generateSecret:(Ljava/security/spec/KeySpec;)Ljavax/crypto/SecretKey;
      35: astore_3
      36: getstatic     #92                 // Field java/lang/System.err:Ljava/io/PrintStream;
      39: aload_2
      40: invokevirtual #93                 // Method java/io/PrintStream.println:(Ljava/lang/Object;)V
      43: getstatic     #92                 // Field java/lang/System.err:Ljava/io/PrintStream;
      46: aload_3
      47: invokevirtual #93                 // Method java/io/PrintStream.println:(Ljava/lang/Object;)V
      50: aload_3
      51: areturn

  protected java.security.KeyStore getKeyStore(java.lang.String) throws java.lang.Exception;
    Code:
       0: ldc           #94                 // String JCEKS
       2: invokestatic  #95                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;)Ljava/security/KeyStore;
       5: astore_2
       6: new           #96                 // class java/io/FileInputStream
       9: dup
      10: ldc           #97                 // String sym.keystore.file
      12: invokestatic  #38                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
      15: invokespecial #98                 // Method java/io/FileInputStream."<init>":(Ljava/lang/String;)V
      18: astore_3
      19: aload_2
      20: aload_3
      21: aload_1
      22: invokevirtual #41                 // Method java/lang/String.toCharArray:()[C
      25: invokevirtual #99                 // Method java/security/KeyStore.load:(Ljava/io/InputStream;[C)V
      28: aload_3
      29: invokevirtual #100                // Method java/io/FileInputStream.close:()V
      32: aload_2
      33: areturn

  protected void saveKeyStore(java.security.KeyStore, java.lang.String) throws java.lang.Exception;
    Code:
       0: new           #101                // class java/io/FileOutputStream
       3: dup
       4: ldc           #97                 // String sym.keystore.file
       6: invokestatic  #38                 // Method java/lang/System.getProperty:(Ljava/lang/String;)Ljava/lang/String;
       9: invokespecial #102                // Method java/io/FileOutputStream."<init>":(Ljava/lang/String;)V
      12: astore_3
      13: aload_1
      14: aload_3
      15: aload_2
      16: invokevirtual #41                 // Method java/lang/String.toCharArray:()[C
      19: invokevirtual #103                // Method java/security/KeyStore.store:(Ljava/io/OutputStream;[C)V
      22: aload_3
      23: invokevirtual #104                // Method java/io/FileOutputStream.close:()V
      26: return
}
