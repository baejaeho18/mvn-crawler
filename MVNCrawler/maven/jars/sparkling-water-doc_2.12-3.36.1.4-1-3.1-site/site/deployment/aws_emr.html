

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Use Sparkling Water with Amazon EMR &mdash; H2O Sparkling Water 3.36.1.4-1-3.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/contentui.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Use Sparkling Water with Amazon EMR from the Edge Node" href="aws_emr_edge_node.html" />
    <link rel="prev" title="Deploying PySparkling Pipeline Models" href="pysparkling_pipeline.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.36.1.4-1-3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About Sparkling Water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typical_use_case.html">Typical Use Case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Sparkling Water Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/install_and_start.html">Installing and Starting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/configuration.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="deployment.html">Deployment</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="backends.html">Sparkling Water Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="load_mojo.html">Importing H2O MOJOs from H2O-3</a></li>
<li class="toctree-l2"><a class="reference internal" href="load_mojo_pipeline.html">Importing MOJO Pipelines from Driverless AI</a></li>
<li class="toctree-l2"><a class="reference internal" href="pysparkling_pipeline.html">Deploying PySparkling Pipeline Models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Use Sparkling Water with Amazon EMR</a></li>
<li class="toctree-l2"><a class="reference internal" href="aws_emr_edge_node.html">Use Sparkling Water with Amazon EMR from the Edge Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="terraform_emr.html">Start Sparkling Water on Amazon EMR using our Terraform Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="kubernetes.html">Running Sparkling Water in Kubernetes</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_azure_dbc.html">Running Sparkling Water on Databricks Azure Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="rsparkling_azure_dbc.html">Running RSparkling on Databricks Azure Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="pysparkling_azure_dbc.html">Running PySparkling on Databricks Azure Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="databricks_logs.html">Download H2O Logs from Databricks Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_google_cloud_dataproc.html">Running Sparkling Water on Google Cloud Dataproc</a></li>
<li class="toctree-l2"><a class="reference internal" href="azure_hdi.html">Using Sparkling Water with Microsoft Azure HDInsight - Beta</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_on_windows.html">Use Sparkling Water in Windows Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="rsparkling_on_windows.html">Use RSparkling in Windows Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="use_on_zeppelin.html">Sparkling Water and Zeppelin</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ml/ml.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/metrics.html">Metric Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_details/model_details.html">Model Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parameters/parameters.html">Algorithm Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorials.html">How to…</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devel/devel.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pysparkling.html">PySparkling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rsparkling.html">RSparkling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Change Log</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">H2O Sparkling Water</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="deployment.html">Deployment</a> &raquo;</li>
        
      <li>Use Sparkling Water with Amazon EMR</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/deployment/aws_emr.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="use-sparkling-water-with-amazon-emr">
<h1>Use Sparkling Water with Amazon EMR<a class="headerlink" href="#use-sparkling-water-with-amazon-emr" title="Permalink to this headline">¶</a></h1>
<p>This section describes how to use Sparkling Water with Amazon EMR via the Web Services UI. An example describing how to do this using the AWS CLI is available in the <a class="reference external" href="https://redoakstrategic.com/h2oaws/">Analytics at Scale: H2O, Apache Spark and R on AWS EMR</a> blog post (courtesy of Red Oak Strategic).</p>
<p>To use Sparkling Water with an EMR cluster, you can use a premade H2O template.</p>
<ol class="arabic">
<li><p>Log in to the <a class="reference external" href="https://aws.amazon.com/marketplace/">AWS Marketplace</a>.</p></li>
<li><p>In the AMI &amp; SaaS search bar, search for H2O, and select <strong>H2O Artificial Intelligence</strong> to open H2O in the marketplace. Review the information on this page. Note that the Delivery Methods section provides two options:</p>
<ul class="simple">
<li><p><strong>H2O Cluster of VM</strong>: All the VPC, subnets, and network security groups are created for you.</p></li>
<li><p><strong>H2O Cluster of VM - Bring your own VPC</strong>: All the networks security groups, subnets, and internet gateways are created by the user.</p></li>
</ul>
<p>Click <strong>Continue</strong> after reviewing to open the Launch on the EC2 page.</p>
</li>
</ol>
<blockquote>
<div><div class="figure align-default">
<img alt="H2O Artificial Intelligence" src="../_images/aws_h2oai.png" />
</div>
</div></blockquote>
<ol class="arabic" start="3">
<li><p>The Launch on the EC2 page provides information about launch options. On the Manual Launch tab:</p>
<ul class="simple">
<li><p>Select the offering that you prefer.</p></li>
<li><p>Select the region to launch.</p></li>
<li><p>Specify a Deployment option.</p></li>
</ul>
<p>Click <strong>Launch with CloudFormation Console</strong> to begin creating your stack.</p>
</li>
</ol>
<blockquote>
<div><div class="figure align-default">
<img alt="Launch On EC2 page" src="../_images/aws_launch_on_ec2.png" />
</div>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>On the Select Template page, enter <a class="reference external" href="https://s3-us-west-2.amazonaws.com/h2o-cloud/aws-template/TemplateEMR.json">https://s3-us-west-2.amazonaws.com/h2o-cloud/aws-template/TemplateEMR.json</a> in the <strong>Specify an Amazon S3 template URL</strong> field.</p></li>
</ol>
<blockquote>
<div><p>This template requires an install script, which is available here: <a class="reference external" href="https://s3.amazonaws.com/h2o-release/sparkling-water/spark-3.1/3.36.1.4-1-3.1/templates/aws/install_sparkling_water_3.36.1.4-1-3.1.sh">https://s3.amazonaws.com/h2o-release/sparkling-water/spark-3.1/3.36.1.4-1-3.1/templates/aws/install_sparkling_water_3.36.1.4-1-3.1.sh</a>. This script can be added using one of the following methods:</p>
<blockquote>
<div><ul class="simple">
<li><p>Download and place the script in the following s3 path: s3://h2o-cloud/aws-template/install_sparkling_water_3.36.1.4-1-3.1.sh</p></li>
</ul>
<blockquote>
<div><p>or</p>
</div></blockquote>
<ul class="simple">
<li><p>Modify the s3 path to the script in the TemplateEMR.json file</p></li>
</ul>
<p>Click <strong>Next</strong> when you are done.</p>
<div class="figure align-default">
<img alt="Select template - EMR" src="../_images/aws_select_template_emr.png" />
</div>
</div></blockquote>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Note that the Specify Details page now includes an EMR Options section. Enter a name for the stack, update any options as desired, and then click <strong>Next</strong> to continue.</p></li>
</ol>
<blockquote>
<div><div class="figure align-default">
<img alt="Specify details - EMR" src="../_images/aws_specify_details_emr.png" />
</div>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>Enter any optional tags and/or permissions on the Options page. Click <strong>Next</strong> to continue.</p></li>
</ol>
<blockquote>
<div><div class="figure align-default">
<img alt="Options page" src="../_images/aws_options.png" />
</div>
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>Review the Stack configuration. Click <strong>Create</strong> to create the Stack or click <strong>Previous</strong> to return to another page and edit any information.</p></li>
</ol>
<p>After your EMR cluster is created, you can ssh into your head node. In the head node, you will find an H2O folder with Sparkling Water inside. To start any H2O jobs with Sparkling Water, follow the instructions located on the download page (<a class="reference external" href="https://www.h2o.ai/download/">https://www.h2o.ai/download/</a>).</p>
<p><strong>Note</strong>: It is important to add the following Spark configuration to any of your EMR jobs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">conf</span> <span class="n">spark</span><span class="o">.</span><span class="n">dynamicAllocation</span><span class="o">.</span><span class="n">enabled</span><span class="o">=</span><span class="n">false</span>  <span class="o">--</span><span class="n">conf</span> <span class="n">spark</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">minRegisteredResourcesRatio</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>and for EMR 5.x (<code class="docutils literal notranslate"><span class="pre">5.32.0</span></code> and newer) also:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">conf</span> <span class="n">spark</span><span class="o">.</span><span class="n">yarn</span><span class="o">.</span><span class="n">heterogeneousExecutors</span><span class="o">.</span><span class="n">enabled</span><span class="o">=</span><span class="n">false</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="aws_emr_edge_node.html" class="btn btn-neutral float-right" title="Use Sparkling Water with Amazon EMR from the Edge Node" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pysparkling_pipeline.html" class="btn btn-neutral float-left" title="Deploying PySparkling Pipeline Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2020 H2O.ai
      <span class="lastupdated">
        Last updated on Aug 04, 2022.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>