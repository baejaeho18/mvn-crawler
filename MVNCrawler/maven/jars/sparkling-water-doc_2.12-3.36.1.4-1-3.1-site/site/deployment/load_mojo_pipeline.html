

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Importing MOJO Pipelines from Driverless AI &mdash; H2O Sparkling Water 3.36.1.4-1-3.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/contentui.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Deploying PySparkling Pipeline Models" href="pysparkling_pipeline.html" />
    <link rel="prev" title="Importing H2O MOJOs from H2O-3" href="load_mojo.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.36.1.4-1-3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About Sparkling Water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typical_use_case.html">Typical Use Case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Sparkling Water Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/install_and_start.html">Installing and Starting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/configuration.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="deployment.html">Deployment</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="backends.html">Sparkling Water Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="load_mojo.html">Importing H2O MOJOs from H2O-3</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Importing MOJO Pipelines from Driverless AI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#starting-a-scoring-environment">Starting a Scoring Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-and-usage-of-driverless-ai-mojo-model">Loading and Usage of Driverless AI MOJO Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#predictions-format">Predictions Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overriding-mojo-library">Overriding MOJO library</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customizing-the-mojo-settings">Customizing the MOJO Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pysparkling_pipeline.html">Deploying PySparkling Pipeline Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="aws_emr.html">Use Sparkling Water with Amazon EMR</a></li>
<li class="toctree-l2"><a class="reference internal" href="aws_emr_edge_node.html">Use Sparkling Water with Amazon EMR from the Edge Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="terraform_emr.html">Start Sparkling Water on Amazon EMR using our Terraform Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="kubernetes.html">Running Sparkling Water in Kubernetes</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_azure_dbc.html">Running Sparkling Water on Databricks Azure Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="rsparkling_azure_dbc.html">Running RSparkling on Databricks Azure Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="pysparkling_azure_dbc.html">Running PySparkling on Databricks Azure Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="databricks_logs.html">Download H2O Logs from Databricks Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_google_cloud_dataproc.html">Running Sparkling Water on Google Cloud Dataproc</a></li>
<li class="toctree-l2"><a class="reference internal" href="azure_hdi.html">Using Sparkling Water with Microsoft Azure HDInsight - Beta</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_on_windows.html">Use Sparkling Water in Windows Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="rsparkling_on_windows.html">Use RSparkling in Windows Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="use_on_zeppelin.html">Sparkling Water and Zeppelin</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ml/ml.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/metrics.html">Metric Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_details/model_details.html">Model Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parameters/parameters.html">Algorithm Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorials.html">How to…</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devel/devel.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pysparkling.html">PySparkling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rsparkling.html">RSparkling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Change Log</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">H2O Sparkling Water</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="deployment.html">Deployment</a> &raquo;</li>
        
      <li>Importing MOJO Pipelines from Driverless AI</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/deployment/load_mojo_pipeline.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="importing-mojo-pipelines-from-driverless-ai">
<h1>Importing MOJO Pipelines from Driverless AI<a class="headerlink" href="#importing-mojo-pipelines-from-driverless-ai" title="Permalink to this headline">¶</a></h1>
<p>MOJO scoring pipeline artifacts, created in Driverless AI, can be used in Spark to carry out predictions in parallel
using the Sparkling Water API. This section shows how to load and run predictions on the MOJO scoring pipeline in
Sparkling Water.</p>
<p><strong>Note</strong>: Sparkling Water is backward compatible with MOJO versions produced by different Driverless AI versions.</p>
<p>One advantage of scoring the MOJO artifacts is that <code class="docutils literal notranslate"><span class="pre">H2OContext</span></code> does not have to be created if we only want to
run predictions on MOJOs using Spark. It is also important to mention that the format of prediction on MOJOs
from Driverless AI differs from predictions on H2O-3 MOJOs. The format of Driverless AI prediction is explained bellow.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>To use the MOJO scoring pipeline, a Driverless AI license has to be passed to Spark.
This can be achieved via <code class="docutils literal notranslate"><span class="pre">--jars</span></code> argument of the Spark launcher scripts.</p>
<p><strong>Note</strong>: In Local Spark mode, please use <code class="docutils literal notranslate"><span class="pre">--driver-class-path</span></code> to specify the path to the license file.</p>
<p>We also need Sparkling Water distribution which can be obtained from <a class="reference external" href="https://www.h2o.ai/download/">H2O Download page</a>.
After we downloaded the Sparkling Water distribution, extract it, and go to the extracted directory.</p>
<p>The MOJO scoring pipeline is included in the <code class="docutils literal notranslate"><span class="pre">mojo.zip</span></code> archive downloaded from Driverless AI. The archive also contains
a mojo runtime library, examples and other files. The only file which is important for scoring with Sparkling Water is
<code class="docutils literal notranslate"><span class="pre">pipeline.mojo</span></code>. Thus before running Sparkling Water, extract the <code class="docutils literal notranslate"><span class="pre">mojo.zip</span></code> archive and copy <code class="docutils literal notranslate"><span class="pre">pipeline.mojo</span></code> to a
location of your choice.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>unzip /path/to/mojo.zip -d /tmp/mojo.zip.extracted
cp /tmp/mojo.zip.extracted/mojo-pipeline/pipeline.mojo /path/to/pipeline.mojo
</pre></div>
</div>
</div>
<div class="section" id="starting-a-scoring-environment">
<h2>Starting a Scoring Environment<a class="headerlink" href="#starting-a-scoring-environment" title="Permalink to this headline">¶</a></h2>
<p>First, we need to start a scoring environment for the desired language with a Driverless AI license. There are two variants.
We can use Sparkling Water prepared scripts which put required dependencies on the Spark classpath or we can use Spark
directly and add the dependencies manually.</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/spark-shell --jars license.sig,jars/sparkling-water-assembly-scoring_2.12-3.36.1.4-1-3.1-all.jar
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/sparkling-shell --jars license.sig
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/pyspark --jars license.sig --py-files py/h2o_pysparkling_scoring_3.1-3.36.1.4-1-3.1.zip
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/pysparkling --jars license.sig
</pre></div>
</div>
</div>
</div>
<p>At this point, we have a Spark interactive terminal where we can carry out predictions. If we don’t require an interactive environment,
we can deploy our scoring logic with <code class="docutils literal notranslate"><span class="pre">./bin/spark-submit</span></code>. The parameters will be the same as in the example above.</p>
</div>
<div class="section" id="loading-and-usage-of-driverless-ai-mojo-model">
<h2>Loading and Usage of Driverless AI MOJO Model<a class="headerlink" href="#loading-and-usage-of-driverless-ai-mojo-model" title="Permalink to this headline">¶</a></h2>
<p>The Pipeline MOJO model could be loaded as:</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">ai.h2o.sparkling.ml.models._</span>
<span class="k">val</span> <span class="n">settings</span> <span class="k">=</span> <span class="n">H2OMOJOSettings</span><span class="o">(</span><span class="n">predictionCol</span> <span class="k">=</span> <span class="s">&quot;fruit_type&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">mojo</span> <span class="k">=</span> <span class="n">H2OMOJOPipelineModel</span><span class="o">.</span><span class="n">createFromMojo</span><span class="o">(</span><span class="s">&quot;file:///path/to/pipeline.mojo&quot;</span><span class="o">,</span> <span class="n">settings</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysparkling.ml</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">settings</span> <span class="o">=</span> <span class="n">H2OMOJOSettings</span><span class="p">(</span><span class="n">predictionCol</span> <span class="o">=</span> <span class="s2">&quot;fruit_type&quot;</span><span class="p">)</span>
<span class="n">mojo</span> <span class="o">=</span> <span class="n">H2OMOJOPipelineModel</span><span class="o">.</span><span class="n">createFromMojo</span><span class="p">(</span><span class="s2">&quot;file:///path/to/pipeline.mojo&quot;</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the examples above <code class="docutils literal notranslate"><span class="pre">settings</span></code> is an optional argument. If it’s not specified, the default values are used.</p>
<p>Prepare the dataset to score on:</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">dataFrame</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;header&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">).</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;inferSchema&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">).</span><span class="n">csv</span><span class="o">(</span><span class="s">&quot;file:///path/to/data.csv&quot;</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataFrame</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;inferSchema&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s2">&quot;file:///path/to/data.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And finally, score the mojo on the loaded dataset:</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">predictions</span> <span class="k">=</span> <span class="n">mojo</span><span class="o">.</span><span class="n">transform</span><span class="o">(</span><span class="n">dataFrame</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">mojo</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dataFrame</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can select the predictions as:</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">&quot;prediction&quot;</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;prediction&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The output data frame contains all the original columns plus the prediction column which is by default named
<code class="docutils literal notranslate"><span class="pre">prediction</span></code>. The prediction column contains all the prediction detail. Its name can be modified via the <code class="docutils literal notranslate"><span class="pre">H2OMOJOSettings</span></code>
object.</p>
</div>
<div class="section" id="predictions-format">
<h2>Predictions Format<a class="headerlink" href="#predictions-format" title="Permalink to this headline">¶</a></h2>
<p>When the option <code class="docutils literal notranslate"><span class="pre">namedMojoOutputColumns</span></code> is enabled on <code class="docutils literal notranslate"><span class="pre">H2OMOJOSettings</span></code>, the <code class="docutils literal notranslate"><span class="pre">predictionCol</span></code> contains sub-columns with
names corresponding to the columns Driverless AI identified as output columns. For example, if Driverless API MOJO
pipeline contains one output column <cite>AGE</cite> ( for example regression problem), the prediction column contains another sub-column
named <cite>AGE</cite>. If The MOJO pipeline contains multiple output columns, such as <cite>VALID.0</cite> and <cite>VALID.1</cite> (for example classification problems),
the prediction column contains two sub-columns with the aforementioned names.</p>
<p>If this option is disabled, the <code class="docutils literal notranslate"><span class="pre">predictionCol</span></code> contains the array of predictions without
the column names. For example, if the Driverless API MOJO pipeline contains one output column <cite>AGE</cite> ( for example regression problem),
the prediction column contains an array of size 1 with the predicted value.
If The MOJO pipeline contains multiple output columns, such as <cite>VALID.0</cite> and <cite>VALID.1</cite> (for example classification problems),
the prediction column contains an array of size 2 containing predicted probabilities for each class.</p>
<p>By default, this option is enabled.</p>
</div>
<div class="section" id="overriding-mojo-library">
<h2>Overriding MOJO library<a class="headerlink" href="#overriding-mojo-library" title="Permalink to this headline">¶</a></h2>
<p>Both full distribution and the scoring package include MOJO2 Runtime Implementation (<code class="docutils literal notranslate"><span class="pre">ai.h2o:mojo2-runtime-impl</span></code>) so you don’t have to worry about it.
We try to update it to the newest possible version when releasing Sparkling Water, however in some cases you might want to override the dependency yourself.</p>
<p>To do that add the MOJO2 jar to the jars list <strong>before</strong> the Sparkling Water scoring jar:</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/spark-shell --jars license.sig,mojo2-runtime-impl-2.7.5.jar,jars/sparkling-water-assembly-scoring_2.12-3.36.1.4-1-3.1-all.jar
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/sparkling-shell --jars license.sig,mojo2-runtime-impl-2.7.5.jar,jars/sparkling-water-assembly-scoring_2.12-3.36.1.4-1-3.1-all.jar
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/pyspark --jars license.sig,mojo2-runtime-impl-2.7.5.jar --py-files py/h2o_pysparkling_scoring_3.1-3.36.1.4-1-3.1.zip
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/pysparkling --jars license.sig,mojo2-runtime-impl-2.7.5.jar
</pre></div>
</div>
</div>
</div>
<p>As mentioned above, in local Spark mode, please use <code class="docutils literal notranslate"><span class="pre">--driver-class-path</span></code>.</p>
</div>
<div class="section" id="customizing-the-mojo-settings">
<h2>Customizing the MOJO Settings<a class="headerlink" href="#customizing-the-mojo-settings" title="Permalink to this headline">¶</a></h2>
<p>We can configure the output and format of predictions via the H2OMOJOSettings. The available options are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">predictionCol</span></code> - Specifies the name of the generated prediction column. The default value is <cite>prediction</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">namedMojoOutputColumns</span></code> - Enables or disables named output columns. By default, it is enabled.</p></li>
</ul>
</div>
<div class="section" id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>If you see the following exception during loading the MOJO pipeline:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">MOJO</span> <span class="pre">doesn't</span> <span class="pre">contain</span> <span class="pre">resource</span> <span class="pre">mojo/pipeline.pb</span></code>, then it means you are adding
incompatible mojo-runtime.jar on your classpath. It is not required and also not suggested
to put the JAR on the classpath as Sparkling Water already bundles the correct dependencies.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">java.io.IOException:</span> <span class="pre">None</span> <span class="pre">of</span> <span class="pre">2</span> <span class="pre">available</span> <span class="pre">pipeline</span> <span class="pre">factories</span> <span class="pre">[pbuf,</span> <span class="pre">toml]</span> <span class="pre">can</span> <span class="pre">read</span> <span class="pre">this</span> <span class="pre">mojo.</span></code>, then you most-likely
passed the whole <code class="docutils literal notranslate"><span class="pre">mojo.zip</span></code> archive to the createFromMojo method instead of the <code class="docutils literal notranslate"><span class="pre">pipeline.mojo</span></code> file, which is contained
in the archive.</p></li>
<li><p>A similar error to <code class="docutils literal notranslate"><span class="pre">java.lang.ClassCastException:</span> <span class="pre">Mojo</span> <span class="pre">column</span> <span class="pre">of</span> <span class="pre">type</span> <span class="pre">Float32</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">assigned</span> <span class="pre">Java</span> <span class="pre">values</span> <span class="pre">only</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">types:</span> <span class="pre">[class</span> <span class="pre">java.lang.Short,</span> <span class="pre">class</span> <span class="pre">java.lang.Double,</span> <span class="pre">class</span> <span class="pre">java.lang.Byte,</span> <span class="pre">class</span> <span class="pre">java.lang.Integer,</span> <span class="pre">class</span> <span class="pre">java.lang.Float],</span> <span class="pre">Java</span> <span class="pre">class</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">input</span> <span class="pre">was:</span> <span class="pre">Long</span></code>,
then call the method <code class="docutils literal notranslate"><span class="pre">getFeatureTypes()</span></code> to get a map/dictionary from feature names to expected types. Identify a feature
with the expected type <code class="docutils literal notranslate"><span class="pre">Float32`</span> <span class="pre">and</span> <span class="pre">``Long`</span> <span class="pre">type</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">dataset</span> <span class="pre">for</span> <span class="pre">scoring</span> <span class="pre">and</span> <span class="pre">manually</span> <span class="pre">cast</span> <span class="pre">the</span> <span class="pre">feature</span> <span class="pre">column</span>
<span class="pre">from</span> <span class="pre">``Long</span></code> to <code class="docutils literal notranslate"><span class="pre">Double</span></code> or <code class="docutils literal notranslate"><span class="pre">Integer</span></code>.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pysparkling_pipeline.html" class="btn btn-neutral float-right" title="Deploying PySparkling Pipeline Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="load_mojo.html" class="btn btn-neutral float-left" title="Importing H2O MOJOs from H2O-3" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2020 H2O.ai
      <span class="lastupdated">
        Last updated on Aug 04, 2022.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>