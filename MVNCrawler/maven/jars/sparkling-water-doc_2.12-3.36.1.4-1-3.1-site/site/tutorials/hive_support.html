

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Hive Support in Sparkling Water &mdash; H2O Sparkling Water 3.36.1.4-1-3.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/contentui.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sparkling Water Logging" href="logs.html" />
    <link rel="prev" title="Changing the Default Port" href="change_default_port.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.36.1.4-1-3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About Sparkling Water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typical_use_case.html">Typical Use Case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Sparkling Water Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/install_and_start.html">Installing and Starting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ml/ml.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/metrics.html">Metric Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_details/model_details.html">Model Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parameters/parameters.html">Algorithm Parameters</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">How to…</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="run_sparkling_water.html">Running Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="change_default_port.html">Changing the Default Port</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Hive Support in Sparkling Water</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#import-data-from-hive-via-hive-metastore">Import Data from Hive via Hive Metastore</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-data-from-hive-via-jdbc-connection">Import Data from Hive via JDBC connection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#obtain-the-hive-jdbc-client-jar">Obtain the Hive JDBC Client JAR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#import-data-from-a-non-kerberized-hive">Import Data from a non-Kerberized Hive</a></li>
<li class="toctree-l4"><a class="reference internal" href="#import-data-from-kerberized-hive-in-a-kerberized-hadoop-cluster">Import Data from Kerberized Hive in a Kerberized Hadoop Cluster</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="logs.html">Sparkling Water Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="ssl.html">Enabling SSL</a></li>
<li class="toctree-l2"><a class="reference internal" href="ldap.html">Enabling LDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="kerberos_auth.html">Enabling Kerberos Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="kerberized_cluster.html">Running Sparkling Water on Kerberized Hadoop Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="secured_flow.html">Using SSL to secure H2O Flow UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="spark_h2o_conversions.html">Spark Frame &lt;–&gt; H2O Frame Conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="h2oframe_as_data_source.html">H2O Frame as Spark’s Data Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="import_export_s3.html">Import &amp; Export H2O Frames from/to S3</a></li>
<li class="toctree-l2"><a class="reference internal" href="use_as_spark_package.html">Use Sparkling Water via Spark Packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../devel/devel.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pysparkling.html">PySparkling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rsparkling.html">RSparkling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Change Log</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">H2O Sparkling Water</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="tutorials.html">How to…</a> &raquo;</li>
        
      <li>Hive Support in Sparkling Water</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/hive_support.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="hive-support-in-sparkling-water">
<h1>Hive Support in Sparkling Water<a class="headerlink" href="#hive-support-in-sparkling-water" title="Permalink to this headline">¶</a></h1>
<p>Spark supports reading data natively from Hive and H2O supports that in a Hadoop environment as well.
In Sparkling Water you can decide which tool you want to use for this task. This tutorial explains what is needed
to use H2O to read data from Hive in the Sparkling Water environment.</p>
<div class="section" id="import-data-from-hive-via-hive-metastore">
<h2>Import Data from Hive via Hive Metastore<a class="headerlink" href="#import-data-from-hive-via-hive-metastore" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Make sure <code class="docutils literal notranslate"><span class="pre">$SPARK_HOME/conf</span></code> contains the hive-site.xml with your Hive configuration.</p></li>
<li><p>In YARN client mode or any local mode, please copy the required connector jars for your Metastore to <code class="docutils literal notranslate"><span class="pre">$SPARK_HOME/jars</span></code>.
You can find these jars in <code class="docutils literal notranslate"><span class="pre">$HIVE_HOME/lib</span> <span class="pre">directory</span></code>. For example, if you are using MySQL as a Metastore for Hive,
copy MySQL metastore JDBC connector. This is not required in the YARN cluster mode.</p></li>
</ul>
<p>This is all preparation we need to do. The following code shows how to import the table.</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<p>To read data from Hive in Sparkling Water, you can use the method:</p>
<div class="highlight-Scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">airlinesTable</span> <span class="k">=</span> <span class="n">h2oContext</span><span class="o">.</span><span class="n">importHiveTable</span><span class="o">(</span><span class="s">&quot;default&quot;</span><span class="o">,</span> <span class="s">&quot;airlines&quot;</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<p>To read data from Hive in PySparkling, you can use the method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">airlines_frame</span> <span class="o">=</span> <span class="n">h2oContext</span><span class="o">.</span><span class="n">importHiveTable</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;airlines&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-R">
<p class="tab-title">R</p>
<p>To read data from Hive in RSparkling, you can use the method:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">airlines_frame</span> <span class="o">&lt;-</span> <span class="n">h2oContext</span><span class="o">$</span><span class="nf">importHiveTable</span><span class="p">(</span><span class="s">&quot;default&quot;</span><span class="p">,</span> <span class="s">&quot;airlines&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This call reads the airlines table from the default database.</p>
</div>
<div class="section" id="import-data-from-hive-via-jdbc-connection">
<h2>Import Data from Hive via JDBC connection<a class="headerlink" href="#import-data-from-hive-via-jdbc-connection" title="Permalink to this headline">¶</a></h2>
<p>This feature reads data from Hive via a standard JDBC connection.</p>
<div class="section" id="obtain-the-hive-jdbc-client-jar">
<h3>Obtain the Hive JDBC Client JAR<a class="headerlink" href="#obtain-the-hive-jdbc-client-jar" title="Permalink to this headline">¶</a></h3>
<p>To be able to connect to Hive, Sparkling Water will need Hive JDBC Client JAR on the class-path. The jar can be obtained
from in the following ways.</p>
<ul class="simple">
<li><p>For Hortonworks, Hive JDBC client jars can be found at
<code class="docutils literal notranslate"><span class="pre">/usr/hdp/current/hive-client/lib/hive-jdbc-&lt;version&gt;-standalone.jar</span></code> on one of the edge nodes after you have
installed HDP. For more information, see Hortenworks documentation
<a class="reference external" href="https://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.6.4/bk_data-access/content/hive-jdbc-odbc-drivers.html">https://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.6.4/bk_data-access/content/hive-jdbc-odbc-drivers.html</a>.</p></li>
<li><p>For Cloudera, install the JDBC package for your operating system according to instructions stated on Cloudera documentation
<a class="reference external" href="https://www.cloudera.com/documentation/enterprise/5-3-x/topics/cdh_ig_hive_jdbc_install.html">https://www.cloudera.com/documentation/enterprise/5-3-x/topics/cdh_ig_hive_jdbc_install.html</a>.
The path to the jar then will be <code class="docutils literal notranslate"><span class="pre">/usr/lib/hive/lib/hive-jdbc-&lt;version&gt;-standalone.jar</span></code></p></li>
<li><p>You can also retrieve this from Maven for the desired version using
<code class="docutils literal notranslate"><span class="pre">mvn</span> <span class="pre">dependency:get</span> <span class="pre">-Dartifact=groupId:artifactId:version</span></code>.</p></li>
</ul>
</div>
<div class="section" id="import-data-from-a-non-kerberized-hive">
<h3>Import Data from a non-Kerberized Hive<a class="headerlink" href="#import-data-from-a-non-kerberized-hive" title="Permalink to this headline">¶</a></h3>
<p>Sparkling Water can import data from the non-Kerberized hive. This also applies for the case when
your Hadoop cluster is Kerberized but Hive is not.</p>
<p>To import data from non-Kerberized Hive, run:</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<p>First, start Sparkling Shell with the  Hive JDBC client JAR on the class-path</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/sparkling-shell --jars /path/to/hive-jdbc-&lt;version&gt;-standalone.jar
</pre></div>
</div>
<p>Create <code class="docutils literal notranslate"><span class="pre">H2OContext</span></code> with properties ensuring connectivity to Hive</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">ai.h2o.sparkling._</span>
<span class="k">val</span> <span class="n">hc</span> <span class="k">=</span> <span class="n">H2OContext</span><span class="o">.</span><span class="n">getOrCreate</span><span class="o">()</span>
</pre></div>
</div>
<p>Import data table from Hive</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">frame</span> <span class="k">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">importHiveTable</span><span class="o">(</span><span class="s">&quot;jdbc:hive2://hostname:10000/default&quot;</span><span class="o">,</span> <span class="s">&quot;airlines&quot;</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<p>First, start PySparkling Shell with the  Hive JDBC client JAR on the class-path</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/pysparkling --jars /path/to/hive-jdbc-&lt;version&gt;-standalone.jar
</pre></div>
</div>
<p>Create <code class="docutils literal notranslate"><span class="pre">H2OContext</span></code> with properties ensuring connectivity to Hive</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysparkling</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">H2OContext</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</pre></div>
</div>
<p>Import data table from Hive</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">importHiveTable</span><span class="p">(</span><span class="s2">&quot;jdbc:hive2://hostname:10000/default&quot;</span><span class="p">,</span> <span class="s2">&quot;airlines&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-R">
<p class="tab-title">R</p>
<p>Run your R environment and install required libraries according to <a class="reference internal" href="../rsparkling.html#rsparkling"><span class="std std-ref">RSparkling</span></a> tutorial and then create
Spark context with the Hive JDBC client JAR on the class-path.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">sparklyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">rsparkling</span><span class="p">)</span>
<span class="n">conf</span> <span class="o">&lt;-</span> <span class="nf">spark_config</span><span class="p">()</span>
<span class="n">conf</span><span class="o">$</span><span class="n">sparklyr.jars.default</span> <span class="o">&lt;-</span> <span class="s">&quot;/path/to/hive-jdbc-&lt;version&gt;-standalone.jar&quot;</span>
<span class="n">sc</span> <span class="o">&lt;-</span> <span class="nf">spark_connect</span><span class="p">(</span><span class="n">master</span> <span class="o">=</span> <span class="s">&quot;yarn-client&quot;</span><span class="p">,</span> <span class="n">config</span> <span class="o">=</span> <span class="n">conf</span><span class="p">)</span>
<span class="n">hc</span> <span class="o">&lt;-</span> <span class="nf">H2OContext.getOrCreate</span><span class="p">()</span>
</pre></div>
</div>
<p>Import data table from Hive</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">&lt;-</span> <span class="n">hc</span><span class="o">$</span><span class="nf">importHiveTable</span><span class="p">(</span><span class="s">&quot;jdbc:hive2://hostname:10000/default&quot;</span><span class="p">,</span> <span class="s">&quot;airlines&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="import-data-from-kerberized-hive-in-a-kerberized-hadoop-cluster">
<h3>Import Data from Kerberized Hive in a Kerberized Hadoop Cluster<a class="headerlink" href="#import-data-from-kerberized-hive-in-a-kerberized-hadoop-cluster" title="Permalink to this headline">¶</a></h3>
<p>Before a given connection to Hive is made, a user has to be authenticated with the Hive instance
via a delegation token and pass the delegation token to Sparkling Water.
Sparkling Water ensures that the delegation token is being automatically refreshed, thus delegation token never expires
in long-running Sparkling Water applications.</p>
<p>First, we need to generate the initial token, which can be generated with the following steps.</p>
<p>Authenticate your user against Kerberos.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kinit &lt;your_user_name&gt;
</pre></div>
</div>
<p>Put Hive JDBC client JAR on the Hadoop class-path.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">HADOOP_CLASSPATH</span><span class="o">=</span>/path/to/hive-jdbc-&lt;version&gt;-standalone.jar
</pre></div>
</div>
<p>Set path to sparkling-water-assembly-3.36.1.4-1-3.1-all.jar which is bundled in Sparkling Water archive.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">SW_ASSEMBLY</span><span class="o">=</span>/path/to/sparkling-water-3.36.1.4-1-3.1/jars/sparkling-water-assembly_2.12-3.36.1.4-1-3.1-all.jar
</pre></div>
</div>
<dl class="simple">
<dt>Get the delegation token generated with arguments:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hiveHost</span></code> - The full address of HiveServer2, for example <code class="docutils literal notranslate"><span class="pre">hostname:10000</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hivePrincipal</span></code> - Hiveserver2 Kerberos principal, for example <code class="docutils literal notranslate"><span class="pre">hive/hostname&#64;DOMAIN.COM</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tokenFile</span></code> - The output file which the delegation token will be generated to</p></li>
</ul>
</dd>
</dl>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hadoop jar <span class="nv">$SW_ASSEMBLY</span> water.hive.GenerateHiveToken -hiveHost &lt;your_hive_host&gt; -hivePrincipal &lt;your_hive_principal&gt; -tokenFile hive.token
</pre></div>
</div>
<p>With the token generated, we can run Sparkling Water with Hive support for the Kerberized
Hadoop cluster as:</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<p>First, start Sparkling Shell with the  Hive JDBC client JAR on the class-path</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/sparkling-shell --jars /path/to/hive-jdbc-&lt;version&gt;-standalone.jar
</pre></div>
</div>
<p>Create <code class="docutils literal notranslate"><span class="pre">H2OContext</span></code> with properties ensuring connectivity to Hive</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">ai.h2o.sparkling._</span>
<span class="k">val</span> <span class="n">conf</span> <span class="k">=</span> <span class="k">new</span> <span class="n">H2OConf</span><span class="o">()</span>
<span class="n">conf</span><span class="o">.</span><span class="n">setKerberizedHiveEnabled</span><span class="o">()</span>
<span class="n">conf</span><span class="o">.</span><span class="n">setHiveHost</span><span class="o">(</span><span class="s">&quot;hostname:10000&quot;</span><span class="o">)</span> <span class="c1">// The full address of HiveServer2</span>
<span class="n">conf</span><span class="o">.</span><span class="n">setHivePrincipal</span><span class="o">(</span><span class="s">&quot;hive/hostname@DOMAIN.COM&quot;</span><span class="o">)</span> <span class="c1">// Hiveserver2 Kerberos principal</span>
<span class="n">conf</span><span class="o">.</span><span class="n">setHiveJdbcUrlPattern</span><span class="o">(</span><span class="s">&quot;jdbc:hive2://{{host}}/;{{auth}}&quot;</span><span class="o">)</span> <span class="c1">// Doesn&#39;t have to be specified if host is set</span>
<span class="k">val</span> <span class="n">source</span> <span class="k">=</span> <span class="n">scala</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">Source</span><span class="o">.</span><span class="n">fromFile</span><span class="o">(</span><span class="s">&quot;hive.token&quot;</span><span class="o">)</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">setHiveToken</span><span class="o">(</span><span class="n">source</span><span class="o">.</span><span class="n">mkString</span><span class="o">())</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
    <span class="n">source</span><span class="o">.</span><span class="n">close</span><span class="o">()</span>
<span class="o">}</span>
<span class="k">val</span> <span class="n">hc</span> <span class="k">=</span> <span class="n">H2OContext</span><span class="o">.</span><span class="n">getOrCreate</span><span class="o">(</span><span class="n">conf</span><span class="o">)</span>
</pre></div>
</div>
<p>Import data table from Hive</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">frame</span> <span class="k">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">importHiveTable</span><span class="o">(</span><span class="s">&quot;jdbc:hive2://hostname:10000/default;auth=delegationToken&quot;</span><span class="o">,</span> <span class="s">&quot;airlines&quot;</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<p>First, start PySparkling Shell with the  Hive JDBC client JAR on the class-path</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bin/pysparkling --jars /path/to/hive-jdbc-&lt;version&gt;-standalone.jar
</pre></div>
</div>
<p>Create <code class="docutils literal notranslate"><span class="pre">H2OContext</span></code> with properties ensuring connectivity to Hive</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysparkling</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">conf</span> <span class="o">=</span> <span class="n">H2OConf</span><span class="p">()</span>
<span class="n">conf</span><span class="o">.</span><span class="n">setKerberizedHiveEnabled</span><span class="p">()</span>
<span class="n">conf</span><span class="o">.</span><span class="n">setHiveHost</span><span class="p">(</span><span class="s2">&quot;hostname:10000&quot;</span><span class="p">)</span> <span class="c1"># The full address of HiveServer2</span>
<span class="n">conf</span><span class="o">.</span><span class="n">setHivePrincipal</span><span class="p">(</span><span class="s2">&quot;hive/hostname@DOMAIN.COM&quot;</span><span class="p">)</span> <span class="c1"># Hiveserver2 Kerberos principal</span>
<span class="n">conf</span><span class="o">.</span><span class="n">setHiveJdbcUrlPattern</span><span class="p">(</span><span class="s2">&quot;jdbc:hive2://{{host}}/;{{auth}}&quot;</span><span class="p">)</span> <span class="c1"># Doesn&#39;t have to be specified if host is set</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;hive.token&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tokenFile</span><span class="p">:</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">tokenFile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">setHiveToken</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">H2OContext</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
</pre></div>
</div>
<p>Import data table from Hive</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">importHiveTable</span><span class="p">(</span><span class="s2">&quot;jdbc:hive2://hostname:10000/default;auth=delegationToken&quot;</span><span class="p">,</span> <span class="s2">&quot;airlines&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="tab-content docutils container" id="tab-R">
<p class="tab-title">R</p>
<p>Run your R environment and install required libraries according to <a class="reference internal" href="../rsparkling.html#rsparkling"><span class="std std-ref">RSparkling</span></a> tutorial and then create
Spark context with the Hive JDBC client JAR on the class-path.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">sparklyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">rsparkling</span><span class="p">)</span>
<span class="n">conf</span> <span class="o">&lt;-</span> <span class="nf">spark_config</span><span class="p">()</span>
<span class="n">conf</span><span class="o">$</span><span class="n">sparklyr.jars.default</span> <span class="o">&lt;-</span> <span class="s">&quot;/path/to/hive-jdbc-&lt;version&gt;-standalone.jar&quot;</span>
<span class="n">sc</span> <span class="o">&lt;-</span> <span class="nf">spark_connect</span><span class="p">(</span><span class="n">master</span> <span class="o">=</span> <span class="s">&quot;yarn-client&quot;</span><span class="p">,</span> <span class="n">config</span> <span class="o">=</span> <span class="n">conf</span><span class="p">)</span>
</pre></div>
</div>
<p>Create <code class="docutils literal notranslate"><span class="pre">H2OContext</span></code> with properties ensuring connectivity to Hive</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">h2oConf</span> <span class="o">&lt;-</span> <span class="nf">H2OConf</span><span class="p">()</span>
<span class="nf">conf.setKerberizedHiveEnabled</span><span class="p">()</span>
<span class="n">h2oConf</span><span class="o">$</span><span class="nf">setHiveHost</span><span class="p">(</span><span class="s">&quot;hostname:10000&quot;</span><span class="p">)</span>
<span class="n">h2oConf</span><span class="o">$</span><span class="nf">setHivePrincipal</span><span class="p">(</span><span class="s">&quot;hive/hostname@DOMAIN.COM&quot;</span><span class="p">)</span>
<span class="n">tokenFile</span> <span class="o">&lt;-</span> <span class="s">&#39;hive.token&#39;</span>
<span class="n">token</span> <span class="o">&lt;-</span> <span class="nf">readChar</span><span class="p">(</span><span class="n">tokenFile</span><span class="p">,</span> <span class="nf">file.info</span><span class="p">(</span><span class="n">tokenFile</span><span class="p">)</span><span class="o">$</span><span class="n">size</span><span class="p">)</span>
<span class="n">h2oConf</span><span class="o">$</span><span class="nf">setHiveToken</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="n">hc</span> <span class="o">&lt;-</span> <span class="nf">H2OContext.getOrCreate</span><span class="p">(</span><span class="n">h2oConf</span><span class="p">)</span>
</pre></div>
</div>
<p>Import data table from Hive</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">frame</span> <span class="o">&lt;-</span> <span class="n">hc</span><span class="o">$</span><span class="nf">importHiveTable</span><span class="p">(</span><span class="s">&quot;jdbc:hive2://hostname:10000/default;auth=delegationToken&quot;</span><span class="p">,</span> <span class="s">&quot;airlines&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="logs.html" class="btn btn-neutral float-right" title="Sparkling Water Logging" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="change_default_port.html" class="btn btn-neutral float-left" title="Changing the Default Port" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2020 H2O.ai
      <span class="lastupdated">
        Last updated on Aug 04, 2022.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>