

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Train Isolation Forest Model in Sparkling Water &mdash; H2O Sparkling Water 3.36.1.4-1-3.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/contentui.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Train CoxPH Model in Sparkling Water" href="sw_coxph.html" />
    <link rel="prev" title="Train XGBoost Model in Sparkling Water" href="sw_xgboost.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.36.1.4-1-3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About Sparkling Water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../typical_use_case.html">Typical Use Case</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Sparkling Water Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/install_and_start.html">Installing and Starting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/deployment.html">Deployment</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="ml.html">Machine Learning</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sw_automl.html">Train AutoML Model in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_gam.html">Train GAM Model in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_glm.html">Train GLM Model in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_drf.html">Train DRF Model in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_grid.html">Train Sparkling Water Algorithms with Grid Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_kmeans.html">Train KMeans Model in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_xgboost.html">Train XGBoost Model in Sparkling Water</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Train Isolation Forest Model in Sparkling Water</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#train-isolation-forest-with-h2ogridsearch">Train Isolation Forest with H2OGridSearch</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sw_coxph.html">Train CoxPH Model in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_deep_learning.html">Train Deep Learning Model in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_rule_fit.html">Train RuleFit Model in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_stacked_ensemble.html">Train Stacked Ensemble Model in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_auto_encoder.html">Autoencoder in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_target_encoder.html">Target Encoding in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_w2v.html">Train Word2Vec Model in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_pca.html">Principal Component Analysis (PCA) in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="sw_glrm.html">Generalized Low Rank Models (GLRM) in Sparkling Water</a></li>
<li class="toctree-l2"><a class="reference internal" href="shap_values.html">Obtain SHAP values from MOJO model</a></li>
<li class="toctree-l2"><a class="reference internal" href="binary_model.html">Using H2O Binary Model in Sparkling Water</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../metrics/metrics.html">Metric Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_details/model_details.html">Model Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parameters/parameters.html">Algorithm Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorials.html">How to…</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devel/devel.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pysparkling.html">PySparkling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rsparkling.html">RSparkling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Change Log</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">H2O Sparkling Water</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="ml.html">Machine Learning</a> &raquo;</li>
        
      <li>Train Isolation Forest Model in Sparkling Water</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ml/sw_isolation_forest.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="train-isolation-forest-model-in-sparkling-water">
<span id="isolation-forest"></span><h1>Train Isolation Forest Model in Sparkling Water<a class="headerlink" href="#train-isolation-forest-model-in-sparkling-water" title="Permalink to this headline">¶</a></h1>
<p>Sparkling Water provides API for H2O Isolation Forest in Scala and Python.
The following sections describe how to train the Isolation Forest model in Sparkling Water in both languages.
See also <a class="reference internal" href="../parameters/parameters_H2OIsolationForest.html#parameters-h2oisolationforest"><span class="std std-ref">Parameters of H2OIsolationForest</span></a> and <a class="reference internal" href="../model_details/model_details_H2OIsolationForestMOJOModel.html#model-details-h2oisolationforestmojomodel"><span class="std std-ref">Details of H2OIsolationForestMOJOModel</span></a>.</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<p>First, let’s start Sparkling Shell as</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>./bin/sparkling-shell
</pre></div>
</div>
<p>Start H2O cluster inside the Spark environment</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">ai.h2o.sparkling._</span>
<span class="k">import</span> <span class="nn">java.net.URI</span>
<span class="k">val</span> <span class="n">hc</span> <span class="k">=</span> <span class="n">H2OContext</span><span class="o">.</span><span class="n">getOrCreate</span><span class="o">()</span>
</pre></div>
</div>
<p>Parse the data using H2O and convert them to Spark Frame</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">org.apache.spark.SparkFiles</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">.</span><span class="n">addFile</span><span class="o">(</span><span class="s">&quot;https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/anomaly/ecg_discord_train.csv&quot;</span><span class="o">)</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">.</span><span class="n">addFile</span><span class="o">(</span><span class="s">&quot;https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/anomaly/ecg_discord_test.csv&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">trainingDF</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;header&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">).</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;inferSchema&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">).</span><span class="n">csv</span><span class="o">(</span><span class="nc">SparkFiles</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;ecg_discord_train.csv&quot;</span><span class="o">))</span>
<span class="k">val</span> <span class="n">testingDF</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;header&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">).</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;inferSchema&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">).</span><span class="n">csv</span><span class="o">(</span><span class="nc">SparkFiles</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;ecg_discord_test.csv&quot;</span><span class="o">))</span>
</pre></div>
</div>
<p>Train the model. You can configure all the available Isolation Forest arguments using provided setters.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">ai.h2o.sparkling.ml.algos.H2OIsolationForest</span>
<span class="k">val</span> <span class="n">estimator</span> <span class="k">=</span> <span class="k">new</span> <span class="n">H2OIsolationForest</span><span class="o">()</span>
<span class="k">val</span> <span class="n">model</span> <span class="k">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="o">(</span><span class="n">trainingDF</span><span class="o">)</span>
</pre></div>
</div>
<p>Run Predictions</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">transform</span><span class="o">(</span><span class="n">testingDF</span><span class="o">).</span><span class="n">show</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>
</pre></div>
</div>
<p>You can also get model details via calling methods listed in <a class="reference internal" href="../model_details/model_details_H2OIsolationForestMOJOModel.html#model-details-h2oisolationforestmojomodel"><span class="std std-ref">Details of H2OIsolationForestMOJOModel</span></a>.</p>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<p>First, let’s start PySparkling Shell as</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>./bin/pysparkling
</pre></div>
</div>
<p>Start H2O cluster inside the Spark environment</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysparkling</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">H2OContext</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</pre></div>
</div>
<p>Parse the data using H2O and convert them to Spark Frame</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h2o</span>
<span class="n">trainingFrame</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">import_file</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/anomaly/ecg_discord_train.csv&quot;</span><span class="p">)</span>
<span class="n">trainingDF</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">asSparkFrame</span><span class="p">(</span><span class="n">trainingFrame</span><span class="p">)</span>
<span class="n">testingFrame</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">import_file</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/anomaly/ecg_discord_test.csv&quot;</span><span class="p">)</span>
<span class="n">testingDF</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">asSparkFrame</span><span class="p">(</span><span class="n">testingFrame</span><span class="p">)</span>
</pre></div>
</div>
<p>Train the model. You can configure all the available Isolation Forest arguments using provided setters or constructor parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysparkling.ml</span> <span class="kn">import</span> <span class="n">H2OIsolationForest</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">H2OIsolationForest</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainingDF</span><span class="p">)</span>
</pre></div>
</div>
<p>Run Predictions</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">testingDF</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">truncate</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also get model details via calling methods listed in <a class="reference internal" href="../model_details/model_details_H2OIsolationForestMOJOModel.html#model-details-h2oisolationforestmojomodel"><span class="std std-ref">Details of H2OIsolationForestMOJOModel</span></a>.</p>
</div>
</div>
<div class="section" id="train-isolation-forest-with-h2ogridsearch">
<h2>Train Isolation Forest with H2OGridSearch<a class="headerlink" href="#train-isolation-forest-with-h2ogridsearch" title="Permalink to this headline">¶</a></h2>
<p>If you’re not sure about exact values for hyper-parameters of Isolation Forest, you can plug <code class="docutils literal notranslate"><span class="pre">H2OIsolationForest</span></code> to
<code class="docutils literal notranslate"><span class="pre">H2OGridSearch</span></code> and define a hyper-parameter space to be walked through. Unlike other Sparkling Water algorithms used in
<code class="docutils literal notranslate"><span class="pre">H2OGridSearch</span></code>, you must pass <code class="docutils literal notranslate"><span class="pre">validationDataFrame</span></code> to <code class="docutils literal notranslate"><span class="pre">H2OIsolationForest</span></code> as a parameter in order to
<code class="docutils literal notranslate"><span class="pre">H2OGridSearch</span></code> be able to evaluate produced models. The validation data frame has to have an extra column identifying
whether the row represents an anomaly or not. The column can contain only two string values, where a value for the negative
case, must be alphabetically smaller then the value for the positive case. E.g.: <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code>/<code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;no&quot;</span></code>/<code class="docutils literal notranslate"><span class="pre">&quot;yes&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;false&quot;</span></code>/<code class="docutils literal notranslate"><span class="pre">&quot;true&quot;</span></code>, etc.</p>
<div class="content-tabs docutils container">
<div class="tab-content docutils container" id="tab-Scala">
<p class="tab-title">Scala</p>
<p>Let’s load a training and validation dataset at first:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">org.apache.spark.SparkFiles</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">.</span><span class="n">addFile</span><span class="o">(</span><span class="s">&quot;https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/prostate/prostate.csv&quot;</span><span class="o">)</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">.</span><span class="n">addFile</span><span class="o">(</span><span class="s">&quot;https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/prostate/prostate_anomaly_validation.csv&quot;</span><span class="o">)</span>
<span class="k">val</span> <span class="n">trainingDF</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;header&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">).</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;inferSchema&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">).</span><span class="n">csv</span><span class="o">(</span><span class="nc">SparkFiles</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;prostate.csv&quot;</span><span class="o">))</span>
<span class="k">val</span> <span class="n">validationDF</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;header&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">).</span><span class="n">option</span><span class="o">(</span><span class="s">&quot;inferSchema&quot;</span><span class="o">,</span> <span class="s">&quot;true&quot;</span><span class="o">).</span><span class="n">csv</span><span class="o">(</span><span class="nc">SparkFiles</span><span class="o">.</span><span class="n">get</span><span class="o">(</span><span class="s">&quot;prostate_anomaly_validation.csv&quot;</span><span class="o">))</span>
</pre></div>
</div>
<p>Create an algorithm instance, pass validation data frame, and specify a column identifying an anomaly:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">ai.h2o.sparkling.ml.algos.H2OIsolationForest</span>
<span class="k">val</span> <span class="n">algorithm</span> <span class="k">=</span> <span class="k">new</span> <span class="n">H2OIsolationForest</span><span class="o">()</span>
<span class="n">algorithm</span><span class="o">.</span><span class="n">setValidationDataFrame</span><span class="o">(</span><span class="n">validationDF</span><span class="o">)</span>
<span class="n">algorithm</span><span class="o">.</span><span class="n">setValidationLabelCol</span><span class="o">(</span><span class="s">&quot;isAnomaly&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Define a hyper-parameter space:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">scala.collection.mutable</span>
<span class="k">val</span> <span class="n">hyperParams</span><span class="k">:</span> <span class="kt">mutable.HashMap</span><span class="o">[</span><span class="kt">String</span><span class="p">,</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">AnyRef</span><span class="o">]]</span> <span class="k">=</span> <span class="n">mutable</span><span class="o">.</span><span class="nc">HashMap</span><span class="o">()</span>
<span class="n">hyperParams</span> <span class="o">+=</span> <span class="s">&quot;ntrees&quot;</span> <span class="o">-&gt;</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">30</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="o">[</span><span class="kt">AnyRef</span><span class="o">])</span>
<span class="n">hyperParams</span> <span class="o">+=</span> <span class="s">&quot;maxDepth&quot;</span> <span class="o">-&gt;</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">20</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">asInstanceOf</span><span class="o">[</span><span class="kt">AnyRef</span><span class="o">])</span>
</pre></div>
</div>
<p>Pass the prepared hyper-parameter space and algorithm to <code class="docutils literal notranslate"><span class="pre">H2OGridSearch</span></code> and run it:</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">ai.h2o.sparkling.ml.algos.H2OGridSearch</span>
<span class="k">val</span> <span class="n">grid</span> <span class="k">=</span> <span class="k">new</span> <span class="n">H2OGridSearch</span><span class="o">()</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setAlgo</span><span class="o">(</span><span class="n">algorithm</span><span class="o">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">setHyperParameters</span><span class="o">(</span><span class="n">hyperParams</span><span class="o">)</span>
<span class="k">val</span> <span class="n">model</span> <span class="k">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="o">(</span><span class="n">trainingDF</span><span class="o">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Logloss</span></code> is a default metric for the model comparision produced by grids and can be changed via the method
<code class="docutils literal notranslate"><span class="pre">setSelectBestModelBy</span></code> on <code class="docutils literal notranslate"><span class="pre">H2OGridSearch</span></code>.</p>
</div>
<div class="tab-content docutils container" id="tab-Python">
<p class="tab-title">Python</p>
<p>Let’s load a training and validation dataset at first:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h2o</span>
<span class="n">trainingFrame</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">import_file</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/prostate/prostate.csv&quot;</span><span class="p">)</span>
<span class="n">trainingDF</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">asSparkFrame</span><span class="p">(</span><span class="n">trainingFrame</span><span class="p">)</span>
<span class="n">validationFrame</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">import_file</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/h2oai/sparkling-water/master/examples/smalldata/prostate/prostate_anomaly_validation.csv&quot;</span><span class="p">)</span>
<span class="n">validationDF</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">asSparkFrame</span><span class="p">(</span><span class="n">validationFrame</span><span class="p">)</span>
</pre></div>
</div>
<p>Create an algorithm instance, pass validation data frame, and specify a column identifying an anomaly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysparkling.ml</span> <span class="kn">import</span> <span class="n">H2OIsolationForest</span>
<span class="n">algorithm</span> <span class="o">=</span> <span class="n">H2OIsolationForest</span><span class="p">(</span><span class="n">validationDataFrame</span><span class="o">=</span><span class="n">validationDF</span><span class="p">,</span> <span class="n">validationLabelCol</span><span class="o">=</span><span class="s2">&quot;isAnomaly&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Define a hyper-parameter space:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hyperSpace</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ntrees&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="s2">&quot;maxDepth&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]}</span>
</pre></div>
</div>
<p>Pass the prepared hyper-parameter space and algorithm to <code class="docutils literal notranslate"><span class="pre">H2OGridSearch</span></code> and run it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysparkling.ml</span> <span class="kn">import</span> <span class="n">H2OGridSearch</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">H2OGridSearch</span><span class="p">(</span><span class="n">hyperParameters</span><span class="o">=</span><span class="n">hyperSpace</span><span class="p">,</span> <span class="n">algo</span><span class="o">=</span><span class="n">algorithm</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainingDF</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Logloss</span></code> is a default metric for the model comparision produced by grids and can be changed via the method
<code class="docutils literal notranslate"><span class="pre">setSelectBestModelBy</span></code> on <code class="docutils literal notranslate"><span class="pre">H2OGridSearch</span></code>.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sw_coxph.html" class="btn btn-neutral float-right" title="Train CoxPH Model in Sparkling Water" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sw_xgboost.html" class="btn btn-neutral float-left" title="Train XGBoost Model in Sparkling Water" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2020 H2O.ai
      <span class="lastupdated">
        Last updated on Aug 04, 2022.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>