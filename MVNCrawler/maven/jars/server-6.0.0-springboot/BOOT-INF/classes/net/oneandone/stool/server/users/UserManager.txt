Compiled from "UserManager.java"
public class net.oneandone.stool.server.users.UserManager {
  public static final net.oneandone.stool.server.users.User ANONYMOUS;

  private final net.oneandone.sushi.fs.file.FileNode file;

  private final java.util.Map<java.lang.String, net.oneandone.stool.server.users.Pair> tokens;

  private final java.util.Random random;

  public static net.oneandone.stool.server.users.UserManager loadOpt(net.oneandone.sushi.fs.file.FileNode) throws java.io.IOException;
    Code:
       0: new           #1                  // class net/oneandone/stool/server/users/UserManager
       3: dup
       4: aload_0
       5: invokespecial #3                  // Method "<init>":(Lnet/oneandone/sushi/fs/file/FileNode;)V
       8: astore_1
       9: aload_0
      10: invokevirtual #7                  // Method net/oneandone/sushi/fs/file/FileNode.exists:()Z
      13: ifeq          20
      16: aload_1
      17: invokevirtual #13                 // Method load:()V
      20: aload_1
      21: areturn

  public net.oneandone.stool.server.users.UserManager(net.oneandone.sushi.fs.file.FileNode);
    Code:
       0: aload_0
       1: invokespecial #17                 // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #21                 // Field file:Lnet/oneandone/sushi/fs/file/FileNode;
       9: aload_0
      10: new           #25                 // class java/util/HashMap
      13: dup
      14: invokespecial #27                 // Method java/util/HashMap."<init>":()V
      17: putfield      #28                 // Field tokens:Ljava/util/Map;
      20: aload_0
      21: new           #32                 // class java/security/SecureRandom
      24: dup
      25: invokespecial #34                 // Method java/security/SecureRandom."<init>":()V
      28: putfield      #35                 // Field random:Ljava/util/Random;
      31: return

  public synchronized net.oneandone.stool.server.users.User byLogin(java.lang.String) throws net.oneandone.stool.server.users.UserNotFound;
    Code:
       0: aload_1
       1: getstatic     #39                 // Field ANONYMOUS:Lnet/oneandone/stool/server/users/User;
       4: getfield      #43                 // Field net/oneandone/stool/server/users/User.login:Ljava/lang/String;
       7: invokevirtual #49                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      10: ifeq          17
      13: getstatic     #39                 // Field ANONYMOUS:Lnet/oneandone/stool/server/users/User;
      16: areturn
      17: aload_0
      18: getfield      #28                 // Field tokens:Ljava/util/Map;
      21: invokeinterface #55,  1           // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
      26: invokeinterface #61,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      31: astore_2
      32: aload_2
      33: invokeinterface #67,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      38: ifeq          73
      41: aload_2
      42: invokeinterface #72,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      47: checkcast     #76                 // class net/oneandone/stool/server/users/Pair
      50: astore_3
      51: aload_1
      52: aload_3
      53: getfield      #78                 // Field net/oneandone/stool/server/users/Pair.user:Lnet/oneandone/stool/server/users/User;
      56: getfield      #43                 // Field net/oneandone/stool/server/users/User.login:Ljava/lang/String;
      59: invokevirtual #49                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      62: ifeq          70
      65: aload_3
      66: getfield      #78                 // Field net/oneandone/stool/server/users/Pair.user:Lnet/oneandone/stool/server/users/User;
      69: areturn
      70: goto          32
      73: new           #81                 // class net/oneandone/stool/server/users/UserNotFound
      76: dup
      77: aload_1
      78: invokespecial #83                 // Method net/oneandone/stool/server/users/UserNotFound."<init>":(Ljava/lang/String;)V
      81: athrow

  public java.lang.String checkedByLogin(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: invokevirtual #86                 // Method byLogin:(Ljava/lang/String;)Lnet/oneandone/stool/server/users/User;
       5: invokevirtual #90                 // Method net/oneandone/stool/server/users/User.toStatus:()Ljava/lang/String;
       8: areturn
       9: astore_2
      10: aload_2
      11: invokevirtual #94                 // Method net/oneandone/stool/server/users/UserNotFound.getMessage:()Ljava/lang/String;
      14: invokedynamic #97,  0             // InvokeDynamic #0:makeConcatWithConstants:(Ljava/lang/String;)Ljava/lang/String;
      19: areturn
    Exception table:
       from    to  target type
           0     8     9   Class net/oneandone/stool/server/users/UserNotFound

  public synchronized net.oneandone.stool.server.users.User authentication(java.lang.String) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #28                 // Field tokens:Ljava/util/Map;
       4: aload_1
       5: invokeinterface #101,  2          // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      10: checkcast     #76                 // class net/oneandone/stool/server/users/Pair
      13: astore_2
      14: aload_2
      15: ifnonnull     20
      18: aconst_null
      19: areturn
      20: aload_2
      21: getfield      #105                // Field net/oneandone/stool/server/users/Pair.token:Lnet/oneandone/stool/server/users/Token;
      24: getfield      #109                // Field net/oneandone/stool/server/users/Token.created:Ljava/time/LocalDateTime;
      27: ldc2_w        #115                // long 7l
      30: invokevirtual #117                // Method java/time/LocalDateTime.plusDays:(J)Ljava/time/LocalDateTime;
      33: invokestatic  #123                // Method java/time/LocalDateTime.now:()Ljava/time/LocalDateTime;
      36: invokevirtual #127                // Method java/time/LocalDateTime.isBefore:(Ljava/time/chrono/ChronoLocalDateTime;)Z
      39: ifeq          80
      42: getstatic     #131                // Field net/oneandone/stool/server/Server.LOGGER:Lorg/slf4j/Logger;
      45: aload_2
      46: getfield      #105                // Field net/oneandone/stool/server/users/Pair.token:Lnet/oneandone/stool/server/users/Token;
      49: aload_2
      50: getfield      #78                 // Field net/oneandone/stool/server/users/Pair.user:Lnet/oneandone/stool/server/users/User;
      53: invokedynamic #137,  0            // InvokeDynamic #1:makeConcatWithConstants:(Lnet/oneandone/stool/server/users/Token;Lnet/oneandone/stool/server/users/User;)Ljava/lang/String;
      58: invokeinterface #140,  2          // InterfaceMethod org/slf4j/Logger.info:(Ljava/lang/String;)V
      63: aload_0
      64: getfield      #28                 // Field tokens:Ljava/util/Map;
      67: aload_1
      68: invokeinterface #145,  2          // InterfaceMethod java/util/Map.remove:(Ljava/lang/Object;)Ljava/lang/Object;
      73: pop
      74: aload_0
      75: invokevirtual #148                // Method save:()V
      78: aconst_null
      79: areturn
      80: aload_2
      81: getfield      #78                 // Field net/oneandone/stool/server/users/Pair.user:Lnet/oneandone/stool/server/users/User;
      84: areturn

  public synchronized java.lang.String generateToken(net.oneandone.stool.server.users.User) throws java.io.IOException;
    Code:
       0: aload_0
       1: aload_1
       2: getfield      #43                 // Field net/oneandone/stool/server/users/User.login:Ljava/lang/String;
       5: invokevirtual #151                // Method remove:(Ljava/lang/String;)Z
       8: pop
       9: aload_0
      10: getfield      #35                 // Field random:Ljava/util/Random;
      13: invokestatic  #154                // Method net/oneandone/stool/server/users/Token.generate:(Ljava/util/Random;)Lnet/oneandone/stool/server/users/Token;
      16: astore_2
      17: aload_0
      18: getfield      #28                 // Field tokens:Ljava/util/Map;
      21: aload_2
      22: getfield      #158                // Field net/oneandone/stool/server/users/Token.value:Ljava/lang/String;
      25: invokeinterface #161,  2          // InterfaceMethod java/util/Map.containsKey:(Ljava/lang/Object;)Z
      30: ifeq          47
      33: new           #164                // class java/lang/IllegalStateException
      36: dup
      37: aload_2
      38: invokedynamic #166,  0            // InvokeDynamic #2:makeConcatWithConstants:(Lnet/oneandone/stool/server/users/Token;)Ljava/lang/String;
      43: invokespecial #169                // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      46: athrow
      47: aload_0
      48: getfield      #28                 // Field tokens:Ljava/util/Map;
      51: aload_2
      52: getfield      #158                // Field net/oneandone/stool/server/users/Token.value:Ljava/lang/String;
      55: new           #76                 // class net/oneandone/stool/server/users/Pair
      58: dup
      59: aload_2
      60: aload_1
      61: invokespecial #170                // Method net/oneandone/stool/server/users/Pair."<init>":(Lnet/oneandone/stool/server/users/Token;Lnet/oneandone/stool/server/users/User;)V
      64: invokeinterface #173,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      69: pop
      70: aload_0
      71: invokevirtual #148                // Method save:()V
      74: aload_2
      75: getfield      #158                // Field net/oneandone/stool/server/users/Token.value:Ljava/lang/String;
      78: areturn

  public synchronized boolean remove(java.lang.String);
    Code:
       0: aload_0
       1: getfield      #28                 // Field tokens:Ljava/util/Map;
       4: invokeinterface #177,  1          // InterfaceMethod java/util/Map.entrySet:()Ljava/util/Set;
       9: invokeinterface #181,  1          // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      14: astore_2
      15: aload_2
      16: invokeinterface #67,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      21: ifeq          64
      24: aload_2
      25: invokeinterface #72,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      30: checkcast     #184                // class java/util/Map$Entry
      33: astore_3
      34: aload_1
      35: aload_3
      36: invokeinterface #186,  1          // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
      41: checkcast     #76                 // class net/oneandone/stool/server/users/Pair
      44: getfield      #78                 // Field net/oneandone/stool/server/users/Pair.user:Lnet/oneandone/stool/server/users/User;
      47: getfield      #43                 // Field net/oneandone/stool/server/users/User.login:Ljava/lang/String;
      50: invokevirtual #49                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      53: ifeq          15
      56: aload_2
      57: invokeinterface #189,  1          // InterfaceMethod java/util/Iterator.remove:()V
      62: iconst_1
      63: ireturn
      64: iconst_0
      65: ireturn

  private synchronized void save() throws java.io.IOException;
    Code:
       0: new           #191                // class com/google/gson/JsonObject
       3: dup
       4: invokespecial #193                // Method com/google/gson/JsonObject."<init>":()V
       7: astore_1
       8: aload_0
       9: getfield      #28                 // Field tokens:Ljava/util/Map;
      12: invokeinterface #55,  1           // InterfaceMethod java/util/Map.values:()Ljava/util/Collection;
      17: invokeinterface #61,  1           // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      22: astore_2
      23: aload_2
      24: invokeinterface #67,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      29: ifeq          63
      32: aload_2
      33: invokeinterface #72,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      38: checkcast     #76                 // class net/oneandone/stool/server/users/Pair
      41: astore_3
      42: aload_1
      43: aload_3
      44: getfield      #105                // Field net/oneandone/stool/server/users/Pair.token:Lnet/oneandone/stool/server/users/Token;
      47: invokevirtual #194                // Method net/oneandone/stool/server/users/Token.toString:()Ljava/lang/String;
      50: aload_3
      51: getfield      #78                 // Field net/oneandone/stool/server/users/Pair.user:Lnet/oneandone/stool/server/users/User;
      54: invokevirtual #197                // Method net/oneandone/stool/server/users/User.toJson:()Lcom/google/gson/JsonObject;
      57: invokevirtual #201                // Method com/google/gson/JsonObject.add:(Ljava/lang/String;Lcom/google/gson/JsonElement;)V
      60: goto          23
      63: aload_0
      64: getfield      #21                 // Field file:Lnet/oneandone/sushi/fs/file/FileNode;
      67: aload_1
      68: invokevirtual #205                // Method com/google/gson/JsonObject.toString:()Ljava/lang/String;
      71: invokevirtual #206                // Method net/oneandone/sushi/fs/file/FileNode.writeString:(Ljava/lang/String;)Lnet/oneandone/sushi/fs/Node;
      74: pop
      75: return

  private synchronized void load() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #28                 // Field tokens:Ljava/util/Map;
       4: invokeinterface #210,  1          // InterfaceMethod java/util/Map.clear:()V
       9: aload_0
      10: getfield      #21                 // Field file:Lnet/oneandone/sushi/fs/file/FileNode;
      13: invokevirtual #213                // Method net/oneandone/sushi/fs/file/FileNode.newReader:()Lnet/oneandone/sushi/fs/NodeReader;
      16: astore_3
      17: aload_3
      18: invokestatic  #217                // Method com/google/gson/JsonParser.parseReader:(Ljava/io/Reader;)Lcom/google/gson/JsonElement;
      21: invokevirtual #223                // Method com/google/gson/JsonElement.getAsJsonObject:()Lcom/google/gson/JsonObject;
      24: astore_1
      25: aload_3
      26: ifnull        61
      29: aload_3
      30: invokevirtual #228                // Method java/io/Reader.close:()V
      33: goto          61
      36: astore        4
      38: aload_3
      39: ifnull        58
      42: aload_3
      43: invokevirtual #228                // Method java/io/Reader.close:()V
      46: goto          58
      49: astore        5
      51: aload         4
      53: aload         5
      55: invokevirtual #235                // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
      58: aload         4
      60: athrow
      61: aload_1
      62: invokevirtual #239                // Method com/google/gson/JsonObject.entrySet:()Ljava/util/Set;
      65: invokeinterface #181,  1          // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      70: astore_3
      71: aload_3
      72: invokeinterface #67,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
      77: ifeq          146
      80: aload_3
      81: invokeinterface #72,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      86: checkcast     #184                // class java/util/Map$Entry
      89: astore        4
      91: aload         4
      93: invokeinterface #240,  1          // InterfaceMethod java/util/Map$Entry.getKey:()Ljava/lang/Object;
      98: checkcast     #50                 // class java/lang/String
     101: invokestatic  #243                // Method net/oneandone/stool/server/users/Token.fromString:(Ljava/lang/String;)Lnet/oneandone/stool/server/users/Token;
     104: astore_2
     105: aload_0
     106: getfield      #28                 // Field tokens:Ljava/util/Map;
     109: aload_2
     110: getfield      #158                // Field net/oneandone/stool/server/users/Token.value:Ljava/lang/String;
     113: new           #76                 // class net/oneandone/stool/server/users/Pair
     116: dup
     117: aload_2
     118: aload         4
     120: invokeinterface #186,  1          // InterfaceMethod java/util/Map$Entry.getValue:()Ljava/lang/Object;
     125: checkcast     #224                // class com/google/gson/JsonElement
     128: invokevirtual #223                // Method com/google/gson/JsonElement.getAsJsonObject:()Lcom/google/gson/JsonObject;
     131: invokestatic  #247                // Method net/oneandone/stool/server/users/User.fromJson:(Lcom/google/gson/JsonObject;)Lnet/oneandone/stool/server/users/User;
     134: invokespecial #170                // Method net/oneandone/stool/server/users/Pair."<init>":(Lnet/oneandone/stool/server/users/Token;Lnet/oneandone/stool/server/users/User;)V
     137: invokeinterface #173,  3          // InterfaceMethod java/util/Map.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
     142: pop
     143: goto          71
     146: return
    Exception table:
       from    to  target type
          17    25    36   Class java/lang/Throwable
          42    46    49   Class java/lang/Throwable

  static {};
    Code:
       0: new           #44                 // class net/oneandone/stool/server/users/User
       3: dup
       4: ldc           #251                // String anonymous
       6: ldc           #253                // String Anonymous
       8: aconst_null
       9: invokespecial #255                // Method net/oneandone/stool/server/users/User."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V
      12: putstatic     #39                 // Field ANONYMOUS:Lnet/oneandone/stool/server/users/User;
      15: return
}
