Compiled from "EcdhKeyAgreementAlgorithm.java"
public class org.jose4j.jwe.EcdhKeyAgreementAlgorithm extends org.jose4j.jwa.AlgorithmInfo implements org.jose4j.jwe.KeyManagementAlgorithm {
  java.lang.String algorithmIdHeaderName;

  public org.jose4j.jwe.EcdhKeyAgreementAlgorithm();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/jose4j/jwa/AlgorithmInfo."<init>":()V
       4: aload_0
       5: ldc           #2                  // String enc
       7: putfield      #3                  // Field algorithmIdHeaderName:Ljava/lang/String;
      10: aload_0
      11: ldc           #4                  // String ECDH-ES
      13: invokevirtual #5                  // Method setAlgorithmIdentifier:(Ljava/lang/String;)V
      16: aload_0
      17: ldc           #6                  // String ECDH
      19: invokevirtual #7                  // Method setJavaAlgorithm:(Ljava/lang/String;)V
      22: aload_0
      23: ldc           #8                  // String EC
      25: invokevirtual #9                  // Method setKeyType:(Ljava/lang/String;)V
      28: aload_0
      29: getstatic     #10                 // Field org/jose4j/keys/KeyPersuasion.ASYMMETRIC:Lorg/jose4j/keys/KeyPersuasion;
      32: invokevirtual #11                 // Method setKeyPersuasion:(Lorg/jose4j/keys/KeyPersuasion;)V
      35: return

  public org.jose4j.jwe.EcdhKeyAgreementAlgorithm(java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #12                 // Method "<init>":()V
       4: aload_0
       5: aload_1
       6: putfield      #3                  // Field algorithmIdHeaderName:Ljava/lang/String;
       9: return

  public org.jose4j.jwe.ContentEncryptionKeys manageForEncrypt(java.security.Key, org.jose4j.jwe.ContentEncryptionKeyDescriptor, org.jose4j.jwx.Headers, byte[], org.jose4j.jca.ProviderContext) throws org.jose4j.lang.JoseException;
    Code:
       0: aload         4
       2: aload_0
       3: invokevirtual #13                 // Method getAlgorithmIdentifier:()Ljava/lang/String;
       6: invokestatic  #14                 // Method org/jose4j/jwx/KeyValidationSupport.cekNotAllowed:([BLjava/lang/String;)V
       9: aload_1
      10: checkcast     #15                 // class java/security/interfaces/ECPublicKey
      13: astore        6
      15: aload         5
      17: invokevirtual #16                 // Method org/jose4j/jca/ProviderContext.getGeneralProviderContext:()Lorg/jose4j/jca/ProviderContext$Context;
      20: invokevirtual #17                 // Method org/jose4j/jca/ProviderContext$Context.getKeyPairGeneratorProvider:()Ljava/lang/String;
      23: astore        7
      25: aload         5
      27: invokevirtual #18                 // Method org/jose4j/jca/ProviderContext.getSecureRandom:()Ljava/security/SecureRandom;
      30: astore        8
      32: aload         6
      34: invokeinterface #19,  1           // InterfaceMethod java/security/interfaces/ECPublicKey.getParams:()Ljava/security/spec/ECParameterSpec;
      39: aload         7
      41: aload         8
      43: invokestatic  #20                 // Method org/jose4j/jwk/EcJwkGenerator.generateJwk:(Ljava/security/spec/ECParameterSpec;Ljava/lang/String;Ljava/security/SecureRandom;)Lorg/jose4j/jwk/EllipticCurveJsonWebKey;
      46: astore        9
      48: aload_0
      49: aload_1
      50: aload_2
      51: aload_3
      52: aload         9
      54: aload         5
      56: invokevirtual #21                 // Method manageForEncrypt:(Ljava/security/Key;Lorg/jose4j/jwe/ContentEncryptionKeyDescriptor;Lorg/jose4j/jwx/Headers;Lorg/jose4j/jwk/PublicJsonWebKey;Lorg/jose4j/jca/ProviderContext;)Lorg/jose4j/jwe/ContentEncryptionKeys;
      59: areturn

  org.jose4j.jwe.ContentEncryptionKeys manageForEncrypt(java.security.Key, org.jose4j.jwe.ContentEncryptionKeyDescriptor, org.jose4j.jwx.Headers, org.jose4j.jwk.PublicJsonWebKey, org.jose4j.jca.ProviderContext) throws org.jose4j.lang.JoseException;
    Code:
       0: aload_3
       1: ldc           #22                 // String epk
       3: aload         4
       5: invokevirtual #23                 // Method org/jose4j/jwx/Headers.setJwkHeaderValue:(Ljava/lang/String;Lorg/jose4j/jwk/JsonWebKey;)V
       8: aload_0
       9: aload         4
      11: invokevirtual #24                 // Method org/jose4j/jwk/PublicJsonWebKey.getPrivateKey:()Ljava/security/PrivateKey;
      14: aload_1
      15: checkcast     #25                 // class java/security/PublicKey
      18: aload         5
      20: invokespecial #26                 // Method generateEcdhSecret:(Ljava/security/PrivateKey;Ljava/security/PublicKey;Lorg/jose4j/jca/ProviderContext;)[B
      23: astore        6
      25: aload_0
      26: aload_2
      27: aload_3
      28: aload         6
      30: aload         5
      32: invokespecial #27                 // Method kdf:(Lorg/jose4j/jwe/ContentEncryptionKeyDescriptor;Lorg/jose4j/jwx/Headers;[BLorg/jose4j/jca/ProviderContext;)[B
      35: astore        7
      37: new           #28                 // class org/jose4j/jwe/ContentEncryptionKeys
      40: dup
      41: aload         7
      43: aconst_null
      44: invokespecial #29                 // Method org/jose4j/jwe/ContentEncryptionKeys."<init>":([B[B)V
      47: areturn

  public java.security.Key manageForDecrypt(java.security.Key, byte[], org.jose4j.jwe.ContentEncryptionKeyDescriptor, org.jose4j.jwx.Headers, org.jose4j.jca.ProviderContext) throws org.jose4j.lang.JoseException;
    Code:
       0: aload         5
       2: invokevirtual #16                 // Method org/jose4j/jca/ProviderContext.getGeneralProviderContext:()Lorg/jose4j/jca/ProviderContext$Context;
       5: invokevirtual #30                 // Method org/jose4j/jca/ProviderContext$Context.getKeyFactoryProvider:()Ljava/lang/String;
       8: astore        6
      10: aload         4
      12: ldc           #22                 // String epk
      14: aload         6
      16: invokevirtual #31                 // Method org/jose4j/jwx/Headers.getPublicJwkHeaderValue:(Ljava/lang/String;Ljava/lang/String;)Lorg/jose4j/jwk/PublicJsonWebKey;
      19: astore        7
      21: aload         7
      23: invokevirtual #32                 // Method org/jose4j/jwk/JsonWebKey.getKey:()Ljava/security/Key;
      26: checkcast     #15                 // class java/security/interfaces/ECPublicKey
      29: astore        8
      31: aload_1
      32: checkcast     #33                 // class java/security/interfaces/ECPrivateKey
      35: astore        9
      37: aload_0
      38: aload         8
      40: aload         9
      42: invokespecial #34                 // Method checkPointIsOnCurve:(Ljava/security/interfaces/ECPublicKey;Ljava/security/interfaces/ECPrivateKey;)V
      45: aload_0
      46: aload_1
      47: checkcast     #33                 // class java/security/interfaces/ECPrivateKey
      50: aload         8
      52: aload         5
      54: invokespecial #26                 // Method generateEcdhSecret:(Ljava/security/PrivateKey;Ljava/security/PublicKey;Lorg/jose4j/jca/ProviderContext;)[B
      57: astore        10
      59: aload_0
      60: aload_3
      61: aload         4
      63: aload         10
      65: aload         5
      67: invokespecial #27                 // Method kdf:(Lorg/jose4j/jwe/ContentEncryptionKeyDescriptor;Lorg/jose4j/jwx/Headers;[BLorg/jose4j/jca/ProviderContext;)[B
      70: astore        11
      72: aload_3
      73: invokevirtual #35                 // Method org/jose4j/jwe/ContentEncryptionKeyDescriptor.getContentEncryptionKeyAlgorithm:()Ljava/lang/String;
      76: astore        12
      78: new           #36                 // class javax/crypto/spec/SecretKeySpec
      81: dup
      82: aload         11
      84: aload         12
      86: invokespecial #37                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      89: areturn

  private void checkPointIsOnCurve(java.security.interfaces.ECPublicKey, java.security.interfaces.ECPrivateKey) throws org.jose4j.lang.JoseException;
    Code:
       0: aload_2
       1: invokeinterface #38,  1           // InterfaceMethod java/security/interfaces/ECPrivateKey.getParams:()Ljava/security/spec/ECParameterSpec;
       6: astore_3
       7: aload_3
       8: invokevirtual #39                 // Method java/security/spec/ECParameterSpec.getCurve:()Ljava/security/spec/EllipticCurve;
      11: astore        4
      13: aload_1
      14: invokeinterface #40,  1           // InterfaceMethod java/security/interfaces/ECPublicKey.getW:()Ljava/security/spec/ECPoint;
      19: astore        5
      21: aload         5
      23: invokevirtual #41                 // Method java/security/spec/ECPoint.getAffineX:()Ljava/math/BigInteger;
      26: astore        6
      28: aload         5
      30: invokevirtual #42                 // Method java/security/spec/ECPoint.getAffineY:()Ljava/math/BigInteger;
      33: astore        7
      35: aload         4
      37: invokevirtual #43                 // Method java/security/spec/EllipticCurve.getA:()Ljava/math/BigInteger;
      40: astore        8
      42: aload         4
      44: invokevirtual #44                 // Method java/security/spec/EllipticCurve.getB:()Ljava/math/BigInteger;
      47: astore        9
      49: aload         4
      51: invokevirtual #45                 // Method java/security/spec/EllipticCurve.getField:()Ljava/security/spec/ECField;
      54: checkcast     #46                 // class java/security/spec/ECFieldFp
      57: invokevirtual #47                 // Method java/security/spec/ECFieldFp.getP:()Ljava/math/BigInteger;
      60: astore        10
      62: aload         7
      64: iconst_2
      65: invokevirtual #48                 // Method java/math/BigInteger.pow:(I)Ljava/math/BigInteger;
      68: aload         10
      70: invokevirtual #49                 // Method java/math/BigInteger.mod:(Ljava/math/BigInteger;)Ljava/math/BigInteger;
      73: astore        11
      75: aload         6
      77: iconst_3
      78: invokevirtual #48                 // Method java/math/BigInteger.pow:(I)Ljava/math/BigInteger;
      81: aload         8
      83: aload         6
      85: invokevirtual #50                 // Method java/math/BigInteger.multiply:(Ljava/math/BigInteger;)Ljava/math/BigInteger;
      88: invokevirtual #51                 // Method java/math/BigInteger.add:(Ljava/math/BigInteger;)Ljava/math/BigInteger;
      91: aload         9
      93: invokevirtual #51                 // Method java/math/BigInteger.add:(Ljava/math/BigInteger;)Ljava/math/BigInteger;
      96: aload         10
      98: invokevirtual #49                 // Method java/math/BigInteger.mod:(Ljava/math/BigInteger;)Ljava/math/BigInteger;
     101: astore        12
     103: aload         11
     105: aload         12
     107: invokevirtual #52                 // Method java/math/BigInteger.equals:(Ljava/lang/Object;)Z
     110: istore        13
     112: iload         13
     114: ifne          148
     117: new           #53                 // class org/jose4j/lang/JoseException
     120: dup
     121: new           #54                 // class java/lang/StringBuilder
     124: dup
     125: invokespecial #55                 // Method java/lang/StringBuilder."<init>":()V
     128: ldc           #56                 // String epk is invalid for
     130: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     133: aload         4
     135: invokestatic  #58                 // Method org/jose4j/keys/EllipticCurves.getName:(Ljava/security/spec/EllipticCurve;)Ljava/lang/String;
     138: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     141: invokevirtual #59                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     144: invokespecial #60                 // Method org/jose4j/lang/JoseException."<init>":(Ljava/lang/String;)V
     147: athrow
     148: return

  private byte[] kdf(org.jose4j.jwe.ContentEncryptionKeyDescriptor, org.jose4j.jwx.Headers, byte[], org.jose4j.jca.ProviderContext);
    Code:
       0: aload         4
       2: invokevirtual #16                 // Method org/jose4j/jca/ProviderContext.getGeneralProviderContext:()Lorg/jose4j/jca/ProviderContext$Context;
       5: invokevirtual #61                 // Method org/jose4j/jca/ProviderContext$Context.getMessageDigestProvider:()Ljava/lang/String;
       8: astore        5
      10: new           #62                 // class org/jose4j/jwe/kdf/KdfUtil
      13: dup
      14: aload         5
      16: invokespecial #63                 // Method org/jose4j/jwe/kdf/KdfUtil."<init>":(Ljava/lang/String;)V
      19: astore        6
      21: aload_1
      22: invokevirtual #64                 // Method org/jose4j/jwe/ContentEncryptionKeyDescriptor.getContentEncryptionKeyByteLength:()I
      25: invokestatic  #65                 // Method org/jose4j/lang/ByteUtil.bitLength:(I)I
      28: istore        7
      30: aload_2
      31: aload_0
      32: getfield      #3                  // Field algorithmIdHeaderName:Ljava/lang/String;
      35: invokevirtual #66                 // Method org/jose4j/jwx/Headers.getStringHeaderValue:(Ljava/lang/String;)Ljava/lang/String;
      38: astore        8
      40: aload_2
      41: ldc           #67                 // String apu
      43: invokevirtual #66                 // Method org/jose4j/jwx/Headers.getStringHeaderValue:(Ljava/lang/String;)Ljava/lang/String;
      46: astore        9
      48: aload_2
      49: ldc           #68                 // String apv
      51: invokevirtual #66                 // Method org/jose4j/jwx/Headers.getStringHeaderValue:(Ljava/lang/String;)Ljava/lang/String;
      54: astore        10
      56: aload         6
      58: aload_3
      59: iload         7
      61: aload         8
      63: aload         9
      65: aload         10
      67: invokevirtual #69                 // Method org/jose4j/jwe/kdf/KdfUtil.kdf:([BILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)[B
      70: areturn

  private javax.crypto.KeyAgreement getKeyAgreement(java.lang.String) throws org.jose4j.lang.JoseException;
    Code:
       0: aload_0
       1: invokevirtual #70                 // Method getJavaAlgorithm:()Ljava/lang/String;
       4: astore_2
       5: aload_1
       6: ifnonnull     16
       9: aload_2
      10: invokestatic  #71                 // Method javax/crypto/KeyAgreement.getInstance:(Ljava/lang/String;)Ljavax/crypto/KeyAgreement;
      13: goto          21
      16: aload_2
      17: aload_1
      18: invokestatic  #72                 // Method javax/crypto/KeyAgreement.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljavax/crypto/KeyAgreement;
      21: areturn
      22: astore_3
      23: new           #74                 // class org/jose4j/lang/UncheckedJoseException
      26: dup
      27: new           #54                 // class java/lang/StringBuilder
      30: dup
      31: invokespecial #55                 // Method java/lang/StringBuilder."<init>":()V
      34: ldc           #75                 // String No
      36: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      39: aload_2
      40: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      43: ldc           #76                 // String  KeyAgreement available.
      45: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      48: invokevirtual #59                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      51: aload_3
      52: invokespecial #77                 // Method org/jose4j/lang/UncheckedJoseException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      55: athrow
      56: astore_3
      57: new           #53                 // class org/jose4j/lang/JoseException
      60: dup
      61: new           #54                 // class java/lang/StringBuilder
      64: dup
      65: invokespecial #55                 // Method java/lang/StringBuilder."<init>":()V
      68: ldc           #79                 // String Cannot get
      70: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      73: aload_2
      74: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      77: ldc           #80                 // String  KeyAgreement with provider
      79: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      82: aload_1
      83: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      86: invokevirtual #59                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      89: aload_3
      90: invokespecial #81                 // Method org/jose4j/lang/JoseException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      93: athrow
    Exception table:
       from    to  target type
           5    21    22   Class java/security/NoSuchAlgorithmException
           5    21    56   Class java/security/NoSuchProviderException

  private byte[] generateEcdhSecret(java.security.PrivateKey, java.security.PublicKey, org.jose4j.jca.ProviderContext) throws org.jose4j.lang.JoseException;
    Code:
       0: aload_3
       1: invokevirtual #82                 // Method org/jose4j/jca/ProviderContext.getSuppliedKeyProviderContext:()Lorg/jose4j/jca/ProviderContext$Context;
       4: invokevirtual #83                 // Method org/jose4j/jca/ProviderContext$Context.getKeyAgreementProvider:()Ljava/lang/String;
       7: astore        4
       9: aload_0
      10: aload         4
      12: invokespecial #84                 // Method getKeyAgreement:(Ljava/lang/String;)Ljavax/crypto/KeyAgreement;
      15: astore        5
      17: aload         5
      19: aload_1
      20: invokevirtual #85                 // Method javax/crypto/KeyAgreement.init:(Ljava/security/Key;)V
      23: aload         5
      25: aload_2
      26: iconst_1
      27: invokevirtual #86                 // Method javax/crypto/KeyAgreement.doPhase:(Ljava/security/Key;Z)Ljava/security/Key;
      30: pop
      31: goto          78
      34: astore        6
      36: new           #88                 // class org/jose4j/lang/InvalidKeyException
      39: dup
      40: new           #54                 // class java/lang/StringBuilder
      43: dup
      44: invokespecial #55                 // Method java/lang/StringBuilder."<init>":()V
      47: ldc           #89                 // String Invalid Key for
      49: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      52: aload_0
      53: invokevirtual #70                 // Method getJavaAlgorithm:()Ljava/lang/String;
      56: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      59: ldc           #90                 // String  key agreement -
      61: invokevirtual #57                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      64: aload         6
      66: invokevirtual #91                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      69: invokevirtual #59                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      72: aload         6
      74: invokespecial #92                 // Method org/jose4j/lang/InvalidKeyException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      77: athrow
      78: aload         5
      80: invokevirtual #93                 // Method javax/crypto/KeyAgreement.generateSecret:()[B
      83: areturn
    Exception table:
       from    to  target type
          17    31    34   Class java/security/InvalidKeyException

  public void validateEncryptionKey(java.security.Key, org.jose4j.jwe.ContentEncryptionAlgorithm) throws org.jose4j.lang.InvalidKeyException;
    Code:
       0: aload_1
       1: ldc_w         #15                 // class java/security/interfaces/ECPublicKey
       4: invokestatic  #94                 // Method org/jose4j/jwx/KeyValidationSupport.castKey:(Ljava/security/Key;Ljava/lang/Class;)Ljava/security/Key;
       7: pop
       8: return

  public void validateDecryptionKey(java.security.Key, org.jose4j.jwe.ContentEncryptionAlgorithm) throws org.jose4j.lang.InvalidKeyException;
    Code:
       0: aload_1
       1: ldc_w         #33                 // class java/security/interfaces/ECPrivateKey
       4: invokestatic  #94                 // Method org/jose4j/jwx/KeyValidationSupport.castKey:(Ljava/security/Key;Ljava/lang/Class;)Ljava/security/Key;
       7: pop
       8: return

  public boolean isAvailable();
    Code:
       0: new           #95                 // class org/jose4j/keys/EcKeyUtil
       3: dup
       4: invokespecial #96                 // Method org/jose4j/keys/EcKeyUtil."<init>":()V
       7: astore_1
       8: aload_1
       9: invokevirtual #97                 // Method org/jose4j/keys/EcKeyUtil.isAvailable:()Z
      12: ifeq          31
      15: ldc           #98                 // String KeyAgreement
      17: aload_0
      18: invokevirtual #70                 // Method getJavaAlgorithm:()Ljava/lang/String;
      21: invokestatic  #99                 // Method org/jose4j/jwa/AlgorithmAvailability.isAvailable:(Ljava/lang/String;Ljava/lang/String;)Z
      24: ifeq          31
      27: iconst_1
      28: goto          32
      31: iconst_0
      32: ireturn
}
