public class org.bouncycastle.crypto.tls.TlsAEADCipher implements org.bouncycastle.crypto.tls.TlsCipher {
  public static final int NONCE_RFC5288;

  static final int NONCE_DRAFT_CHACHA20_POLY1305;

  protected org.bouncycastle.crypto.tls.TlsContext context;

  protected int macSize;

  protected int record_iv_length;

  protected org.bouncycastle.crypto.modes.AEADBlockCipher encryptCipher;

  protected org.bouncycastle.crypto.modes.AEADBlockCipher decryptCipher;

  protected byte[] encryptImplicitNonce;

  protected byte[] decryptImplicitNonce;

  protected int nonceMode;

  public org.bouncycastle.crypto.tls.TlsAEADCipher(org.bouncycastle.crypto.tls.TlsContext, org.bouncycastle.crypto.modes.AEADBlockCipher, org.bouncycastle.crypto.modes.AEADBlockCipher, int, int) throws java.io.IOException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: iload         4
       6: iload         5
       8: iconst_1
       9: invokespecial #132                // Method "<init>":(Lorg/bouncycastle/crypto/tls/TlsContext;Lorg/bouncycastle/crypto/modes/AEADBlockCipher;Lorg/bouncycastle/crypto/modes/AEADBlockCipher;III)V
      12: return

  org.bouncycastle.crypto.tls.TlsAEADCipher(org.bouncycastle.crypto.tls.TlsContext, org.bouncycastle.crypto.modes.AEADBlockCipher, org.bouncycastle.crypto.modes.AEADBlockCipher, int, int, int) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokespecial #125                // Method java/lang/Object."<init>":()V
       4: aload_1
       5: invokestatic  #139                // Method org/bouncycastle/crypto/tls/TlsUtils.isTLSv12:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
       8: ifne          21
      11: new           #70                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
      14: dup
      15: bipush        80
      17: invokespecial #133                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      20: athrow
      21: aload_0
      22: iload         6
      24: putfield      #118                // Field nonceMode:I
      27: iload         6
      29: lookupswitch  { // 2
                     1: 56
                     2: 68
               default: 80
          }
      56: iconst_4
      57: istore        7
      59: aload_0
      60: bipush        8
      62: putfield      #119                // Field record_iv_length:I
      65: goto          90
      68: bipush        12
      70: istore        7
      72: aload_0
      73: iconst_0
      74: putfield      #119                // Field record_iv_length:I
      77: goto          90
      80: new           #70                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
      83: dup
      84: bipush        80
      86: invokespecial #133                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      89: athrow
      90: aload_0
      91: aload_1
      92: putfield      #124                // Field context:Lorg/bouncycastle/crypto/tls/TlsContext;
      95: aload_0
      96: iload         5
      98: putfield      #117                // Field macSize:I
     101: iconst_2
     102: iload         4
     104: imul
     105: iconst_2
     106: iload         7
     108: imul
     109: iadd
     110: istore        8
     112: aload_1
     113: iload         8
     115: invokestatic  #140                // Method org/bouncycastle/crypto/tls/TlsUtils.calculateKeyBlock:(Lorg/bouncycastle/crypto/tls/TlsContext;I)[B
     118: astore        9
     120: iconst_0
     121: istore        10
     123: new           #66                 // class org/bouncycastle/crypto/params/KeyParameter
     126: dup
     127: aload         9
     129: iload         10
     131: iload         4
     133: invokespecial #129                // Method org/bouncycastle/crypto/params/KeyParameter."<init>":([BII)V
     136: astore        11
     138: iload         10
     140: iload         4
     142: iadd
     143: istore        10
     145: new           #66                 // class org/bouncycastle/crypto/params/KeyParameter
     148: dup
     149: aload         9
     151: iload         10
     153: iload         4
     155: invokespecial #129                // Method org/bouncycastle/crypto/params/KeyParameter."<init>":([BII)V
     158: astore        12
     160: iload         10
     162: iload         4
     164: iadd
     165: istore        10
     167: aload         9
     169: iload         10
     171: iload         10
     173: iload         7
     175: iadd
     176: invokestatic  #141                // Method org/bouncycastle/util/Arrays.copyOfRange:([BII)[B
     179: astore        13
     181: iload         10
     183: iload         7
     185: iadd
     186: istore        10
     188: aload         9
     190: iload         10
     192: iload         10
     194: iload         7
     196: iadd
     197: invokestatic  #141                // Method org/bouncycastle/util/Arrays.copyOfRange:([BII)[B
     200: astore        14
     202: iload         10
     204: iload         7
     206: iadd
     207: istore        10
     209: iload         10
     211: iload         8
     213: if_icmpeq     226
     216: new           #70                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
     219: dup
     220: bipush        80
     222: invokespecial #133                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     225: athrow
     226: aload_1
     227: invokeinterface #146,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.isServer:()Z
     232: ifeq          268
     235: aload_0
     236: aload_3
     237: putfield      #123                // Field encryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     240: aload_0
     241: aload_2
     242: putfield      #122                // Field decryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     245: aload_0
     246: aload         14
     248: putfield      #121                // Field encryptImplicitNonce:[B
     251: aload_0
     252: aload         13
     254: putfield      #120                // Field decryptImplicitNonce:[B
     257: aload         12
     259: astore        15
     261: aload         11
     263: astore        16
     265: goto          298
     268: aload_0
     269: aload_2
     270: putfield      #123                // Field encryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     273: aload_0
     274: aload_3
     275: putfield      #122                // Field decryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     278: aload_0
     279: aload         13
     281: putfield      #121                // Field encryptImplicitNonce:[B
     284: aload_0
     285: aload         14
     287: putfield      #120                // Field decryptImplicitNonce:[B
     290: aload         11
     292: astore        15
     294: aload         12
     296: astore        16
     298: iload         7
     300: aload_0
     301: getfield      #119                // Field record_iv_length:I
     304: iadd
     305: newarray       byte
     307: astore        17
     309: aload_0
     310: getfield      #123                // Field encryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     313: iconst_1
     314: new           #65                 // class org/bouncycastle/crypto/params/AEADParameters
     317: dup
     318: aload         15
     320: bipush        8
     322: iload         5
     324: imul
     325: aload         17
     327: invokespecial #127                // Method org/bouncycastle/crypto/params/AEADParameters."<init>":(Lorg/bouncycastle/crypto/params/KeyParameter;I[B)V
     330: invokeinterface #145,  3          // InterfaceMethod org/bouncycastle/crypto/modes/AEADBlockCipher.init:(ZLorg/bouncycastle/crypto/CipherParameters;)V
     335: aload_0
     336: getfield      #122                // Field decryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     339: iconst_0
     340: new           #65                 // class org/bouncycastle/crypto/params/AEADParameters
     343: dup
     344: aload         16
     346: bipush        8
     348: iload         5
     350: imul
     351: aload         17
     353: invokespecial #127                // Method org/bouncycastle/crypto/params/AEADParameters."<init>":(Lorg/bouncycastle/crypto/params/KeyParameter;I[B)V
     356: invokeinterface #145,  3          // InterfaceMethod org/bouncycastle/crypto/modes/AEADBlockCipher.init:(ZLorg/bouncycastle/crypto/CipherParameters;)V
     361: return

  public int getPlaintextLimit(int);
    Code:
       0: iload_1
       1: aload_0
       2: getfield      #117                // Field macSize:I
       5: isub
       6: aload_0
       7: getfield      #119                // Field record_iv_length:I
      10: isub
      11: ireturn

  public byte[] encodePlaintext(long, short, byte[], int, int) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #121                // Field encryptImplicitNonce:[B
       4: arraylength
       5: aload_0
       6: getfield      #119                // Field record_iv_length:I
       9: iadd
      10: newarray       byte
      12: astore        7
      14: aload_0
      15: getfield      #118                // Field nonceMode:I
      18: lookupswitch  { // 2
                     1: 44
                     2: 74
               default: 124
          }
      44: aload_0
      45: getfield      #121                // Field encryptImplicitNonce:[B
      48: iconst_0
      49: aload         7
      51: iconst_0
      52: aload_0
      53: getfield      #121                // Field encryptImplicitNonce:[B
      56: arraylength
      57: invokestatic  #126                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      60: lload_1
      61: aload         7
      63: aload_0
      64: getfield      #121                // Field encryptImplicitNonce:[B
      67: arraylength
      68: invokestatic  #136                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint64:(J[BI)V
      71: goto          134
      74: lload_1
      75: aload         7
      77: aload         7
      79: arraylength
      80: bipush        8
      82: isub
      83: invokestatic  #136                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint64:(J[BI)V
      86: iconst_0
      87: istore        8
      89: iload         8
      91: aload_0
      92: getfield      #121                // Field encryptImplicitNonce:[B
      95: arraylength
      96: if_icmpge     121
      99: aload         7
     101: iload         8
     103: dup2
     104: baload
     105: aload_0
     106: getfield      #121                // Field encryptImplicitNonce:[B
     109: iload         8
     111: baload
     112: ixor
     113: i2b
     114: bastore
     115: iinc          8, 1
     118: goto          89
     121: goto          134
     124: new           #70                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
     127: dup
     128: bipush        80
     130: invokespecial #133                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     133: athrow
     134: iload         5
     136: istore        8
     138: iload         6
     140: istore        9
     142: aload_0
     143: getfield      #123                // Field encryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     146: iload         9
     148: invokeinterface #142,  2          // InterfaceMethod org/bouncycastle/crypto/modes/AEADBlockCipher.getOutputSize:(I)I
     153: istore        10
     155: aload_0
     156: getfield      #119                // Field record_iv_length:I
     159: iload         10
     161: iadd
     162: newarray       byte
     164: astore        11
     166: aload_0
     167: getfield      #119                // Field record_iv_length:I
     170: ifeq          193
     173: aload         7
     175: aload         7
     177: arraylength
     178: aload_0
     179: getfield      #119                // Field record_iv_length:I
     182: isub
     183: aload         11
     185: iconst_0
     186: aload_0
     187: getfield      #119                // Field record_iv_length:I
     190: invokestatic  #126                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     193: aload_0
     194: getfield      #119                // Field record_iv_length:I
     197: istore        12
     199: aload_0
     200: lload_1
     201: iload_3
     202: iload         9
     204: invokevirtual #131                // Method getAdditionalData:(JSI)[B
     207: astore        13
     209: new           #65                 // class org/bouncycastle/crypto/params/AEADParameters
     212: dup
     213: aconst_null
     214: bipush        8
     216: aload_0
     217: getfield      #117                // Field macSize:I
     220: imul
     221: aload         7
     223: aload         13
     225: invokespecial #128                // Method org/bouncycastle/crypto/params/AEADParameters."<init>":(Lorg/bouncycastle/crypto/params/KeyParameter;I[B[B)V
     228: astore        14
     230: aload_0
     231: getfield      #123                // Field encryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     234: iconst_1
     235: aload         14
     237: invokeinterface #145,  3          // InterfaceMethod org/bouncycastle/crypto/modes/AEADBlockCipher.init:(ZLorg/bouncycastle/crypto/CipherParameters;)V
     242: iload         12
     244: aload_0
     245: getfield      #123                // Field encryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     248: aload         4
     250: iload         8
     252: iload         9
     254: aload         11
     256: iload         12
     258: invokeinterface #144,  6          // InterfaceMethod org/bouncycastle/crypto/modes/AEADBlockCipher.processBytes:([BII[BI)I
     263: iadd
     264: istore        12
     266: iload         12
     268: aload_0
     269: getfield      #123                // Field encryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     272: aload         11
     274: iload         12
     276: invokeinterface #143,  3          // InterfaceMethod org/bouncycastle/crypto/modes/AEADBlockCipher.doFinal:([BI)I
     281: iadd
     282: istore        12
     284: goto          301
     287: astore        15
     289: new           #70                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
     292: dup
     293: bipush        80
     295: aload         15
     297: invokespecial #134                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(SLjava/lang/Throwable;)V
     300: athrow
     301: iload         12
     303: aload         11
     305: arraylength
     306: if_icmpeq     319
     309: new           #70                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
     312: dup
     313: bipush        80
     315: invokespecial #133                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     318: athrow
     319: aload         11
     321: areturn
    Exception table:
       from    to  target type
         230   284   287   Class java/lang/Exception

  public byte[] decodeCiphertext(long, short, byte[], int, int) throws java.io.IOException;
    Code:
       0: aload_0
       1: iload         6
       3: invokevirtual #130                // Method getPlaintextLimit:(I)I
       6: ifge          19
       9: new           #70                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
      12: dup
      13: bipush        50
      15: invokespecial #133                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      18: athrow
      19: aload_0
      20: getfield      #120                // Field decryptImplicitNonce:[B
      23: arraylength
      24: aload_0
      25: getfield      #119                // Field record_iv_length:I
      28: iadd
      29: newarray       byte
      31: astore        7
      33: aload_0
      34: getfield      #118                // Field nonceMode:I
      37: lookupswitch  { // 2
                     1: 64
                     2: 104
               default: 154
          }
      64: aload_0
      65: getfield      #120                // Field decryptImplicitNonce:[B
      68: iconst_0
      69: aload         7
      71: iconst_0
      72: aload_0
      73: getfield      #120                // Field decryptImplicitNonce:[B
      76: arraylength
      77: invokestatic  #126                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      80: aload         4
      82: iload         5
      84: aload         7
      86: aload         7
      88: arraylength
      89: aload_0
      90: getfield      #119                // Field record_iv_length:I
      93: isub
      94: aload_0
      95: getfield      #119                // Field record_iv_length:I
      98: invokestatic  #126                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     101: goto          164
     104: lload_1
     105: aload         7
     107: aload         7
     109: arraylength
     110: bipush        8
     112: isub
     113: invokestatic  #136                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint64:(J[BI)V
     116: iconst_0
     117: istore        8
     119: iload         8
     121: aload_0
     122: getfield      #120                // Field decryptImplicitNonce:[B
     125: arraylength
     126: if_icmpge     151
     129: aload         7
     131: iload         8
     133: dup2
     134: baload
     135: aload_0
     136: getfield      #120                // Field decryptImplicitNonce:[B
     139: iload         8
     141: baload
     142: ixor
     143: i2b
     144: bastore
     145: iinc          8, 1
     148: goto          119
     151: goto          164
     154: new           #70                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
     157: dup
     158: bipush        80
     160: invokespecial #133                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     163: athrow
     164: iload         5
     166: aload_0
     167: getfield      #119                // Field record_iv_length:I
     170: iadd
     171: istore        8
     173: iload         6
     175: aload_0
     176: getfield      #119                // Field record_iv_length:I
     179: isub
     180: istore        9
     182: aload_0
     183: getfield      #122                // Field decryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     186: iload         9
     188: invokeinterface #142,  2          // InterfaceMethod org/bouncycastle/crypto/modes/AEADBlockCipher.getOutputSize:(I)I
     193: istore        10
     195: iload         10
     197: newarray       byte
     199: astore        11
     201: iconst_0
     202: istore        12
     204: aload_0
     205: lload_1
     206: iload_3
     207: iload         10
     209: invokevirtual #131                // Method getAdditionalData:(JSI)[B
     212: astore        13
     214: new           #65                 // class org/bouncycastle/crypto/params/AEADParameters
     217: dup
     218: aconst_null
     219: bipush        8
     221: aload_0
     222: getfield      #117                // Field macSize:I
     225: imul
     226: aload         7
     228: aload         13
     230: invokespecial #128                // Method org/bouncycastle/crypto/params/AEADParameters."<init>":(Lorg/bouncycastle/crypto/params/KeyParameter;I[B[B)V
     233: astore        14
     235: aload_0
     236: getfield      #122                // Field decryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     239: iconst_0
     240: aload         14
     242: invokeinterface #145,  3          // InterfaceMethod org/bouncycastle/crypto/modes/AEADBlockCipher.init:(ZLorg/bouncycastle/crypto/CipherParameters;)V
     247: iload         12
     249: aload_0
     250: getfield      #122                // Field decryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     253: aload         4
     255: iload         8
     257: iload         9
     259: aload         11
     261: iload         12
     263: invokeinterface #144,  6          // InterfaceMethod org/bouncycastle/crypto/modes/AEADBlockCipher.processBytes:([BII[BI)I
     268: iadd
     269: istore        12
     271: iload         12
     273: aload_0
     274: getfield      #122                // Field decryptCipher:Lorg/bouncycastle/crypto/modes/AEADBlockCipher;
     277: aload         11
     279: iload         12
     281: invokeinterface #143,  3          // InterfaceMethod org/bouncycastle/crypto/modes/AEADBlockCipher.doFinal:([BI)I
     286: iadd
     287: istore        12
     289: goto          306
     292: astore        15
     294: new           #70                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
     297: dup
     298: bipush        20
     300: aload         15
     302: invokespecial #134                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(SLjava/lang/Throwable;)V
     305: athrow
     306: iload         12
     308: aload         11
     310: arraylength
     311: if_icmpeq     324
     314: new           #70                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
     317: dup
     318: bipush        80
     320: invokespecial #133                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     323: athrow
     324: aload         11
     326: areturn
    Exception table:
       from    to  target type
         235   289   292   Class java/lang/Exception

  protected byte[] getAdditionalData(long, short, int) throws java.io.IOException;
    Code:
       0: bipush        13
       2: newarray       byte
       4: astore        5
       6: lload_1
       7: aload         5
       9: iconst_0
      10: invokestatic  #136                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint64:(J[BI)V
      13: iload_3
      14: aload         5
      16: bipush        8
      18: invokestatic  #137                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint8:(S[BI)V
      21: aload_0
      22: getfield      #124                // Field context:Lorg/bouncycastle/crypto/tls/TlsContext;
      25: invokeinterface #147,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.getServerVersion:()Lorg/bouncycastle/crypto/tls/ProtocolVersion;
      30: aload         5
      32: bipush        9
      34: invokestatic  #138                // Method org/bouncycastle/crypto/tls/TlsUtils.writeVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;[BI)V
      37: iload         4
      39: aload         5
      41: bipush        11
      43: invokestatic  #135                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint16:(I[BI)V
      46: aload         5
      48: areturn
}
