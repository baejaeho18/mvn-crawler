Compiled from "SecureNioChannel.java"
public class org.apache.tomcat.util.net.SecureNioChannel extends org.apache.tomcat.util.net.NioChannel {
  private static final org.apache.juli.logging.Log log;

  private static final org.apache.tomcat.util.res.StringManager sm;

  private static final int DEFAULT_NET_BUFFER_SIZE;

  private final org.apache.tomcat.util.net.NioEndpoint endpoint;

  protected java.nio.ByteBuffer netInBuffer;

  protected java.nio.ByteBuffer netOutBuffer;

  protected javax.net.ssl.SSLEngine sslEngine;

  protected boolean sniComplete;

  protected boolean handshakeComplete;

  protected javax.net.ssl.SSLEngineResult$HandshakeStatus handshakeStatus;

  protected boolean closed;

  protected boolean closing;

  protected org.apache.tomcat.util.net.NioSelectorPool pool;

  public org.apache.tomcat.util.net.SecureNioChannel(org.apache.tomcat.util.net.SocketBufferHandler, org.apache.tomcat.util.net.NioSelectorPool, org.apache.tomcat.util.net.NioEndpoint);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #1                  // Method org/apache/tomcat/util/net/NioChannel."<init>":(Lorg/apache/tomcat/util/net/SocketBufferHandler;)V
       5: aload_0
       6: iconst_0
       7: putfield      #2                  // Field sniComplete:Z
      10: aload_0
      11: iconst_0
      12: putfield      #3                  // Field handshakeComplete:Z
      15: aload_0
      16: iconst_0
      17: putfield      #4                  // Field closed:Z
      20: aload_0
      21: iconst_0
      22: putfield      #5                  // Field closing:Z
      25: aload_3
      26: invokevirtual #6                  // Method org/apache/tomcat/util/net/NioEndpoint.getSocketProperties:()Lorg/apache/tomcat/util/net/SocketProperties;
      29: invokevirtual #7                  // Method org/apache/tomcat/util/net/SocketProperties.getDirectSslBuffer:()Z
      32: ifeq          58
      35: aload_0
      36: sipush        16921
      39: invokestatic  #9                  // Method java/nio/ByteBuffer.allocateDirect:(I)Ljava/nio/ByteBuffer;
      42: putfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      45: aload_0
      46: sipush        16921
      49: invokestatic  #9                  // Method java/nio/ByteBuffer.allocateDirect:(I)Ljava/nio/ByteBuffer;
      52: putfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      55: goto          78
      58: aload_0
      59: sipush        16921
      62: invokestatic  #12                 // Method java/nio/ByteBuffer.allocate:(I)Ljava/nio/ByteBuffer;
      65: putfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      68: aload_0
      69: sipush        16921
      72: invokestatic  #12                 // Method java/nio/ByteBuffer.allocate:(I)Ljava/nio/ByteBuffer;
      75: putfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      78: aload_0
      79: aload_2
      80: putfield      #13                 // Field pool:Lorg/apache/tomcat/util/net/NioSelectorPool;
      83: aload_0
      84: aload_3
      85: putfield      #14                 // Field endpoint:Lorg/apache/tomcat/util/net/NioEndpoint;
      88: return

  public void reset(java.nio.channels.SocketChannel, org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper) throws java.io.IOException;
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #15                 // Method org/apache/tomcat/util/net/NioChannel.reset:(Ljava/nio/channels/SocketChannel;Lorg/apache/tomcat/util/net/NioEndpoint$NioSocketWrapper;)V
       6: aload_0
       7: aconst_null
       8: putfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
      11: aload_0
      12: iconst_0
      13: putfield      #2                  // Field sniComplete:Z
      16: aload_0
      17: iconst_0
      18: putfield      #3                  // Field handshakeComplete:Z
      21: aload_0
      22: iconst_0
      23: putfield      #4                  // Field closed:Z
      26: aload_0
      27: iconst_0
      28: putfield      #5                  // Field closing:Z
      31: aload_0
      32: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      35: invokevirtual #17                 // Method java/nio/ByteBuffer.clear:()Ljava/nio/Buffer;
      38: pop
      39: return

  public void free();
    Code:
       0: aload_0
       1: invokespecial #18                 // Method org/apache/tomcat/util/net/NioChannel.free:()V
       4: aload_0
       5: getfield      #14                 // Field endpoint:Lorg/apache/tomcat/util/net/NioEndpoint;
       8: invokevirtual #6                  // Method org/apache/tomcat/util/net/NioEndpoint.getSocketProperties:()Lorg/apache/tomcat/util/net/SocketProperties;
      11: invokevirtual #7                  // Method org/apache/tomcat/util/net/SocketProperties.getDirectSslBuffer:()Z
      14: ifeq          31
      17: aload_0
      18: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      21: invokestatic  #19                 // Method org/apache/tomcat/util/buf/ByteBufferUtils.cleanDirectBuffer:(Ljava/nio/ByteBuffer;)V
      24: aload_0
      25: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      28: invokestatic  #19                 // Method org/apache/tomcat/util/buf/ByteBufferUtils.cleanDirectBuffer:(Ljava/nio/ByteBuffer;)V
      31: return

  public boolean flush(boolean, java.nio.channels.Selector, long) throws java.io.IOException;
    Code:
       0: iload_1
       1: ifne          16
       4: aload_0
       5: aload_0
       6: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
       9: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
      12: pop
      13: goto          31
      16: aload_0
      17: getfield      #13                 // Field pool:Lorg/apache/tomcat/util/net/NioSelectorPool;
      20: aload_0
      21: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      24: aload_0
      25: aload_2
      26: lload_3
      27: invokevirtual #21                 // Method org/apache/tomcat/util/net/NioSelectorPool.write:(Ljava/nio/ByteBuffer;Lorg/apache/tomcat/util/net/NioChannel;Ljava/nio/channels/Selector;J)I
      30: pop
      31: aload_0
      32: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      35: invokevirtual #22                 // Method java/nio/ByteBuffer.hasRemaining:()Z
      38: ifne          45
      41: iconst_1
      42: goto          46
      45: iconst_0
      46: ireturn

  protected boolean flush(java.nio.ByteBuffer) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokevirtual #23                 // Method java/nio/ByteBuffer.remaining:()I
       4: istore_2
       5: iload_2
       6: ifle          27
       9: aload_0
      10: getfield      #24                 // Field sc:Ljava/nio/channels/SocketChannel;
      13: aload_1
      14: invokevirtual #25                 // Method java/nio/channels/SocketChannel.write:(Ljava/nio/ByteBuffer;)I
      17: iload_2
      18: if_icmplt     25
      21: iconst_1
      22: goto          26
      25: iconst_0
      26: ireturn
      27: iconst_1
      28: ireturn

  public int handshake(boolean, boolean) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #3                  // Field handshakeComplete:Z
       4: ifeq          9
       7: iconst_0
       8: ireturn
       9: aload_0
      10: getfield      #2                  // Field sniComplete:Z
      13: ifne          35
      16: aload_0
      17: invokespecial #26                 // Method processSNI:()I
      20: istore_3
      21: iload_3
      22: ifne          33
      25: aload_0
      26: iconst_1
      27: putfield      #2                  // Field sniComplete:Z
      30: goto          35
      33: iload_3
      34: ireturn
      35: aload_0
      36: aload_0
      37: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      40: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
      43: ifne          48
      46: iconst_4
      47: ireturn
      48: aconst_null
      49: astore_3
      50: aload_0
      51: getfield      #3                  // Field handshakeComplete:Z
      54: ifne          479
      57: getstatic     #28                 // Field org/apache/tomcat/util/net/SecureNioChannel$1.$SwitchMap$javax$net$ssl$SSLEngineResult$HandshakeStatus:[I
      60: aload_0
      61: getfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
      64: invokevirtual #30                 // Method javax/net/ssl/SSLEngineResult$HandshakeStatus.ordinal:()I
      67: iaload
      68: tableswitch   { // 1 to 5
                     1: 104
                     2: 120
                     3: 217
                     4: 365
                     5: 441
               default: 452
          }
     104: new           #31                 // class java/io/IOException
     107: dup
     108: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     111: ldc           #33                 // String channel.nio.ssl.notHandshaking
     113: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     116: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     119: athrow
     120: aload_0
     121: getfield      #14                 // Field endpoint:Lorg/apache/tomcat/util/net/NioEndpoint;
     124: invokevirtual #36                 // Method org/apache/tomcat/util/net/NioEndpoint.hasNegotiableProtocols:()Z
     127: ifeq          185
     130: aload_0
     131: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     134: instanceof    #37                 // class org/apache/tomcat/util/net/SSLUtil$ProtocolInfo
     137: ifeq          162
     140: aload_0
     141: getfield      #38                 // Field socketWrapper:Lorg/apache/tomcat/util/net/NioEndpoint$NioSocketWrapper;
     144: aload_0
     145: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     148: checkcast     #37                 // class org/apache/tomcat/util/net/SSLUtil$ProtocolInfo
     151: invokeinterface #39,  1           // InterfaceMethod org/apache/tomcat/util/net/SSLUtil$ProtocolInfo.getNegotiatedProtocol:()Ljava/lang/String;
     156: invokevirtual #40                 // Method org/apache/tomcat/util/net/NioEndpoint$NioSocketWrapper.setNegotiatedProtocol:(Ljava/lang/String;)V
     159: goto          185
     162: invokestatic  #41                 // Method org/apache/tomcat/util/compat/JreCompat.isAlpnSupported:()Z
     165: ifeq          185
     168: aload_0
     169: getfield      #38                 // Field socketWrapper:Lorg/apache/tomcat/util/net/NioEndpoint$NioSocketWrapper;
     172: invokestatic  #42                 // Method org/apache/tomcat/util/compat/JreCompat.getInstance:()Lorg/apache/tomcat/util/compat/JreCompat;
     175: aload_0
     176: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     179: invokevirtual #43                 // Method org/apache/tomcat/util/compat/JreCompat.getApplicationProtocol:(Ljavax/net/ssl/SSLEngine;)Ljava/lang/String;
     182: invokevirtual #40                 // Method org/apache/tomcat/util/net/NioEndpoint$NioSocketWrapper.setNegotiatedProtocol:(Ljava/lang/String;)V
     185: aload_0
     186: aload_0
     187: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     190: invokevirtual #22                 // Method java/nio/ByteBuffer.hasRemaining:()Z
     193: ifne          200
     196: iconst_1
     197: goto          201
     200: iconst_0
     201: putfield      #3                  // Field handshakeComplete:Z
     204: aload_0
     205: getfield      #3                  // Field handshakeComplete:Z
     208: ifeq          215
     211: iconst_0
     212: goto          216
     215: iconst_4
     216: ireturn
     217: aload_0
     218: iload_2
     219: invokevirtual #44                 // Method handshakeWrap:(Z)Ljavax/net/ssl/SSLEngineResult;
     222: astore_3
     223: goto          263
     226: astore        4
     228: getstatic     #46                 // Field log:Lorg/apache/juli/logging/Log;
     231: invokeinterface #47,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     236: ifeq          257
     239: getstatic     #46                 // Field log:Lorg/apache/juli/logging/Log;
     242: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     245: ldc           #48                 // String channel.nio.ssl.wrapException
     247: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     250: aload         4
     252: invokeinterface #49,  3           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     257: aload_0
     258: iload_2
     259: invokevirtual #44                 // Method handshakeWrap:(Z)Ljavax/net/ssl/SSLEngineResult;
     262: astore_3
     263: aload_3
     264: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     267: getstatic     #51                 // Field javax/net/ssl/SSLEngineResult$Status.OK:Ljavax/net/ssl/SSLEngineResult$Status;
     270: if_acmpne     294
     273: aload_0
     274: getfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     277: getstatic     #52                 // Field javax/net/ssl/SSLEngineResult$HandshakeStatus.NEED_TASK:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     280: if_acmpne     342
     283: aload_0
     284: aload_0
     285: invokevirtual #53                 // Method tasks:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     288: putfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     291: goto          342
     294: aload_3
     295: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     298: getstatic     #54                 // Field javax/net/ssl/SSLEngineResult$Status.CLOSED:Ljavax/net/ssl/SSLEngineResult$Status;
     301: if_acmpne     315
     304: aload_0
     305: aload_0
     306: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     309: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
     312: pop
     313: iconst_m1
     314: ireturn
     315: new           #31                 // class java/io/IOException
     318: dup
     319: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     322: ldc           #55                 // String channel.nio.ssl.unexpectedStatusDuringWrap
     324: iconst_1
     325: anewarray     #56                 // class java/lang/Object
     328: dup
     329: iconst_0
     330: aload_3
     331: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     334: aastore
     335: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     338: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     341: athrow
     342: aload_0
     343: getfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     346: getstatic     #58                 // Field javax/net/ssl/SSLEngineResult$HandshakeStatus.NEED_UNWRAP:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     349: if_acmpne     363
     352: aload_0
     353: aload_0
     354: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     357: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
     360: ifne          365
     363: iconst_4
     364: ireturn
     365: aload_0
     366: iload_1
     367: invokevirtual #59                 // Method handshakeUnwrap:(Z)Ljavax/net/ssl/SSLEngineResult;
     370: astore_3
     371: aload_3
     372: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     375: getstatic     #51                 // Field javax/net/ssl/SSLEngineResult$Status.OK:Ljavax/net/ssl/SSLEngineResult$Status;
     378: if_acmpne     402
     381: aload_0
     382: getfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     385: getstatic     #52                 // Field javax/net/ssl/SSLEngineResult$HandshakeStatus.NEED_TASK:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     388: if_acmpne     50
     391: aload_0
     392: aload_0
     393: invokevirtual #53                 // Method tasks:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     396: putfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     399: goto          50
     402: aload_3
     403: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     406: getstatic     #60                 // Field javax/net/ssl/SSLEngineResult$Status.BUFFER_UNDERFLOW:Ljavax/net/ssl/SSLEngineResult$Status;
     409: if_acmpne     414
     412: iconst_1
     413: ireturn
     414: new           #31                 // class java/io/IOException
     417: dup
     418: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     421: ldc           #55                 // String channel.nio.ssl.unexpectedStatusDuringWrap
     423: iconst_1
     424: anewarray     #56                 // class java/lang/Object
     427: dup
     428: iconst_0
     429: aload_3
     430: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     433: aastore
     434: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     437: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     440: athrow
     441: aload_0
     442: aload_0
     443: invokevirtual #53                 // Method tasks:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     446: putfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     449: goto          50
     452: new           #61                 // class java/lang/IllegalStateException
     455: dup
     456: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     459: ldc           #62                 // String channel.nio.ssl.invalidStatus
     461: iconst_1
     462: anewarray     #56                 // class java/lang/Object
     465: dup
     466: iconst_0
     467: aload_0
     468: getfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     471: aastore
     472: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     475: invokespecial #63                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     478: athrow
     479: iconst_0
     480: ireturn
    Exception table:
       from    to  target type
         217   223   226   Class javax/net/ssl/SSLException

  private int processSNI() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #24                 // Field sc:Ljava/nio/channels/SocketChannel;
       4: aload_0
       5: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
       8: invokevirtual #64                 // Method java/nio/channels/SocketChannel.read:(Ljava/nio/ByteBuffer;)I
      11: istore_1
      12: iload_1
      13: iconst_m1
      14: if_icmpne     19
      17: iconst_m1
      18: ireturn
      19: new           #65                 // class org/apache/tomcat/util/net/TLSClientHelloExtractor
      22: dup
      23: aload_0
      24: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      27: invokespecial #66                 // Method org/apache/tomcat/util/net/TLSClientHelloExtractor."<init>":(Ljava/nio/ByteBuffer;)V
      30: astore_2
      31: aload_2
      32: invokevirtual #67                 // Method org/apache/tomcat/util/net/TLSClientHelloExtractor.getResult:()Lorg/apache/tomcat/util/net/TLSClientHelloExtractor$ExtractorResult;
      35: getstatic     #68                 // Field org/apache/tomcat/util/net/TLSClientHelloExtractor$ExtractorResult.UNDERFLOW:Lorg/apache/tomcat/util/net/TLSClientHelloExtractor$ExtractorResult;
      38: if_acmpne     144
      41: aload_0
      42: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      45: invokevirtual #69                 // Method java/nio/ByteBuffer.capacity:()I
      48: aload_0
      49: getfield      #14                 // Field endpoint:Lorg/apache/tomcat/util/net/NioEndpoint;
      52: invokevirtual #70                 // Method org/apache/tomcat/util/net/NioEndpoint.getSniParseLimit:()I
      55: if_icmpge     144
      58: aload_0
      59: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      62: invokevirtual #69                 // Method java/nio/ByteBuffer.capacity:()I
      65: iconst_2
      66: imul
      67: aload_0
      68: getfield      #14                 // Field endpoint:Lorg/apache/tomcat/util/net/NioEndpoint;
      71: invokevirtual #70                 // Method org/apache/tomcat/util/net/NioEndpoint.getSniParseLimit:()I
      74: invokestatic  #71                 // Method java/lang/Math.min:(II)I
      77: istore_3
      78: getstatic     #46                 // Field log:Lorg/apache/juli/logging/Log;
      81: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      84: ldc           #72                 // String channel.nio.ssl.expandNetInBuffer
      86: iconst_1
      87: anewarray     #56                 // class java/lang/Object
      90: dup
      91: iconst_0
      92: iload_3
      93: invokestatic  #73                 // Method java/lang/Integer.toString:(I)Ljava/lang/String;
      96: aastore
      97: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     100: invokeinterface #74,  2           // InterfaceMethod org/apache/juli/logging/Log.info:(Ljava/lang/Object;)V
     105: aload_0
     106: aload_0
     107: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     110: iload_3
     111: invokestatic  #75                 // Method org/apache/tomcat/util/buf/ByteBufferUtils.expand:(Ljava/nio/ByteBuffer;I)Ljava/nio/ByteBuffer;
     114: putfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     117: aload_0
     118: getfield      #24                 // Field sc:Ljava/nio/channels/SocketChannel;
     121: aload_0
     122: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     125: invokevirtual #64                 // Method java/nio/channels/SocketChannel.read:(Ljava/nio/ByteBuffer;)I
     128: pop
     129: new           #65                 // class org/apache/tomcat/util/net/TLSClientHelloExtractor
     132: dup
     133: aload_0
     134: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     137: invokespecial #66                 // Method org/apache/tomcat/util/net/TLSClientHelloExtractor."<init>":(Ljava/nio/ByteBuffer;)V
     140: astore_2
     141: goto          31
     144: aconst_null
     145: astore_3
     146: aconst_null
     147: astore        4
     149: aconst_null
     150: astore        5
     152: getstatic     #76                 // Field org/apache/tomcat/util/net/SecureNioChannel$1.$SwitchMap$org$apache$tomcat$util$net$TLSClientHelloExtractor$ExtractorResult:[I
     155: aload_2
     156: invokevirtual #67                 // Method org/apache/tomcat/util/net/TLSClientHelloExtractor.getResult:()Lorg/apache/tomcat/util/net/TLSClientHelloExtractor$ExtractorResult;
     159: invokevirtual #77                 // Method org/apache/tomcat/util/net/TLSClientHelloExtractor$ExtractorResult.ordinal:()I
     162: iaload
     163: tableswitch   { // 1 to 5
                     1: 196
                     2: 207
                     3: 216
                     4: 218
                     5: 261
               default: 309
          }
     196: aload_2
     197: invokevirtual #78                 // Method org/apache/tomcat/util/net/TLSClientHelloExtractor.getSNIValue:()Ljava/lang/String;
     200: astore_3
     201: aload_2
     202: invokevirtual #79                 // Method org/apache/tomcat/util/net/TLSClientHelloExtractor.getClientRequestedApplicationProtocols:()Ljava/util/List;
     205: astore        5
     207: aload_2
     208: invokevirtual #80                 // Method org/apache/tomcat/util/net/TLSClientHelloExtractor.getClientRequestedCiphers:()Ljava/util/List;
     211: astore        4
     213: goto          309
     216: iconst_1
     217: ireturn
     218: getstatic     #46                 // Field log:Lorg/apache/juli/logging/Log;
     221: invokeinterface #47,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     226: ifeq          245
     229: getstatic     #46                 // Field log:Lorg/apache/juli/logging/Log;
     232: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     235: ldc           #81                 // String channel.nio.ssl.sniDefault
     237: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     240: invokeinterface #82,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     245: aload_0
     246: getfield      #14                 // Field endpoint:Lorg/apache/tomcat/util/net/NioEndpoint;
     249: invokevirtual #83                 // Method org/apache/tomcat/util/net/NioEndpoint.getDefaultSSLHostConfigName:()Ljava/lang/String;
     252: astore_3
     253: invokestatic  #84                 // Method java/util/Collections.emptyList:()Ljava/util/List;
     256: astore        4
     258: goto          309
     261: aload_0
     262: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     265: invokevirtual #17                 // Method java/nio/ByteBuffer.clear:()Ljava/nio/Buffer;
     268: pop
     269: aload_0
     270: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     273: getstatic     #85                 // Field org/apache/tomcat/util/net/TLSClientHelloExtractor.USE_TLS_RESPONSE:[B
     276: invokevirtual #86                 // Method java/nio/ByteBuffer.put:([B)Ljava/nio/ByteBuffer;
     279: pop
     280: aload_0
     281: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     284: invokevirtual #87                 // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
     287: pop
     288: aload_0
     289: invokevirtual #88                 // Method flushOutbound:()Z
     292: pop
     293: new           #31                 // class java/io/IOException
     296: dup
     297: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     300: ldc           #89                 // String channel.nio.ssl.foundHttp
     302: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     305: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     308: athrow
     309: getstatic     #46                 // Field log:Lorg/apache/juli/logging/Log;
     312: invokeinterface #47,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
     317: ifeq          351
     320: getstatic     #46                 // Field log:Lorg/apache/juli/logging/Log;
     323: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     326: ldc           #90                 // String channel.nio.ssl.sniHostName
     328: iconst_2
     329: anewarray     #56                 // class java/lang/Object
     332: dup
     333: iconst_0
     334: aload_0
     335: getfield      #24                 // Field sc:Ljava/nio/channels/SocketChannel;
     338: aastore
     339: dup
     340: iconst_1
     341: aload_3
     342: aastore
     343: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     346: invokeinterface #82,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     351: aload_0
     352: aload_0
     353: getfield      #14                 // Field endpoint:Lorg/apache/tomcat/util/net/NioEndpoint;
     356: aload_3
     357: aload         4
     359: aload         5
     361: invokevirtual #91                 // Method org/apache/tomcat/util/net/NioEndpoint.createSSLEngine:(Ljava/lang/String;Ljava/util/List;Ljava/util/List;)Ljavax/net/ssl/SSLEngine;
     364: putfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     367: aload_0
     368: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     371: aload_0
     372: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     375: invokevirtual #93                 // Method javax/net/ssl/SSLEngine.getSession:()Ljavax/net/ssl/SSLSession;
     378: invokeinterface #94,  1           // InterfaceMethod javax/net/ssl/SSLSession.getApplicationBufferSize:()I
     383: invokevirtual #95                 // Method org/apache/tomcat/util/net/SocketBufferHandler.expand:(I)V
     386: aload_0
     387: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     390: invokevirtual #69                 // Method java/nio/ByteBuffer.capacity:()I
     393: aload_0
     394: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     397: invokevirtual #93                 // Method javax/net/ssl/SSLEngine.getSession:()Ljavax/net/ssl/SSLSession;
     400: invokeinterface #94,  1           // InterfaceMethod javax/net/ssl/SSLSession.getApplicationBufferSize:()I
     405: if_icmpge     446
     408: getstatic     #46                 // Field log:Lorg/apache/juli/logging/Log;
     411: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     414: ldc           #96                 // String channel.nio.ssl.expandNetOutBuffer
     416: iconst_1
     417: anewarray     #56                 // class java/lang/Object
     420: dup
     421: iconst_0
     422: aload_0
     423: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     426: invokevirtual #93                 // Method javax/net/ssl/SSLEngine.getSession:()Ljavax/net/ssl/SSLSession;
     429: invokeinterface #94,  1           // InterfaceMethod javax/net/ssl/SSLSession.getApplicationBufferSize:()I
     434: invokestatic  #73                 // Method java/lang/Integer.toString:(I)Ljava/lang/String;
     437: aastore
     438: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     441: invokeinterface #74,  2           // InterfaceMethod org/apache/juli/logging/Log.info:(Ljava/lang/Object;)V
     446: aload_0
     447: aload_0
     448: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     451: aload_0
     452: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     455: invokevirtual #93                 // Method javax/net/ssl/SSLEngine.getSession:()Ljavax/net/ssl/SSLSession;
     458: invokeinterface #97,  1           // InterfaceMethod javax/net/ssl/SSLSession.getPacketBufferSize:()I
     463: invokestatic  #75                 // Method org/apache/tomcat/util/buf/ByteBufferUtils.expand:(Ljava/nio/ByteBuffer;I)Ljava/nio/ByteBuffer;
     466: putfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     469: aload_0
     470: aload_0
     471: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     474: aload_0
     475: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     478: invokevirtual #93                 // Method javax/net/ssl/SSLEngine.getSession:()Ljavax/net/ssl/SSLSession;
     481: invokeinterface #97,  1           // InterfaceMethod javax/net/ssl/SSLSession.getPacketBufferSize:()I
     486: invokestatic  #75                 // Method org/apache/tomcat/util/buf/ByteBufferUtils.expand:(Ljava/nio/ByteBuffer;I)Ljava/nio/ByteBuffer;
     489: putfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     492: aload_0
     493: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     496: iconst_0
     497: invokevirtual #98                 // Method java/nio/ByteBuffer.position:(I)Ljava/nio/Buffer;
     500: pop
     501: aload_0
     502: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     505: iconst_0
     506: invokevirtual #99                 // Method java/nio/ByteBuffer.limit:(I)Ljava/nio/Buffer;
     509: pop
     510: aload_0
     511: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     514: invokevirtual #100                // Method javax/net/ssl/SSLEngine.beginHandshake:()V
     517: aload_0
     518: aload_0
     519: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     522: invokevirtual #101                // Method javax/net/ssl/SSLEngine.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     525: putfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     528: iconst_0
     529: ireturn

  public void rehandshake(long) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
       4: invokevirtual #102                // Method java/nio/ByteBuffer.position:()I
       7: ifle          43
      10: aload_0
      11: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      14: invokevirtual #102                // Method java/nio/ByteBuffer.position:()I
      17: aload_0
      18: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      21: invokevirtual #103                // Method java/nio/ByteBuffer.limit:()I
      24: if_icmpge     43
      27: new           #31                 // class java/io/IOException
      30: dup
      31: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      34: ldc           #104                // String channel.nio.ssl.netInputNotEmpty
      36: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      39: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      42: athrow
      43: aload_0
      44: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      47: invokevirtual #102                // Method java/nio/ByteBuffer.position:()I
      50: ifle          86
      53: aload_0
      54: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      57: invokevirtual #102                // Method java/nio/ByteBuffer.position:()I
      60: aload_0
      61: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      64: invokevirtual #103                // Method java/nio/ByteBuffer.limit:()I
      67: if_icmpge     86
      70: new           #31                 // class java/io/IOException
      73: dup
      74: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      77: ldc           #105                // String channel.nio.ssl.netOutputNotEmpty
      79: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      82: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      85: athrow
      86: aload_0
      87: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
      90: invokevirtual #106                // Method org/apache/tomcat/util/net/SocketBufferHandler.isReadBufferEmpty:()Z
      93: ifne          112
      96: new           #31                 // class java/io/IOException
      99: dup
     100: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     103: ldc           #107                // String channel.nio.ssl.appInputNotEmpty
     105: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     108: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     111: athrow
     112: aload_0
     113: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     116: invokevirtual #108                // Method org/apache/tomcat/util/net/SocketBufferHandler.isWriteBufferEmpty:()Z
     119: ifne          138
     122: new           #31                 // class java/io/IOException
     125: dup
     126: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     129: ldc           #109                // String channel.nio.ssl.appOutputNotEmpty
     131: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     134: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     137: athrow
     138: aload_0
     139: iconst_0
     140: putfield      #3                  // Field handshakeComplete:Z
     143: iconst_0
     144: istore_3
     145: iconst_0
     146: istore        4
     148: iconst_1
     149: istore        5
     151: aconst_null
     152: astore        6
     154: aconst_null
     155: astore        7
     157: aload_0
     158: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     161: invokevirtual #100                // Method javax/net/ssl/SSLEngine.beginHandshake:()V
     164: aload_0
     165: aload_0
     166: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     169: invokevirtual #101                // Method javax/net/ssl/SSLEngine.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     172: putfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     175: iload         5
     177: ifeq          333
     180: aload_0
     181: iload_3
     182: iload         4
     184: invokevirtual #110                // Method handshake:(ZZ)I
     187: istore        8
     189: iload         8
     191: lookupswitch  { // 2
                    -1: 216
                     0: 232
               default: 238
          }
     216: new           #111                // class java/io/EOFException
     219: dup
     220: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     223: ldc           #112                // String channel.nio.ssl.eofDuringHandshake
     225: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     228: invokespecial #113                // Method java/io/EOFException."<init>":(Ljava/lang/String;)V
     231: athrow
     232: iconst_0
     233: istore        5
     235: goto          330
     238: invokestatic  #114                // Method java/lang/System.currentTimeMillis:()J
     241: lstore        9
     243: aload         6
     245: ifnonnull     269
     248: invokestatic  #115                // Method java/nio/channels/Selector.open:()Ljava/nio/channels/Selector;
     251: astore        6
     253: aload_0
     254: invokevirtual #116                // Method getIOChannel:()Ljava/nio/channels/SocketChannel;
     257: aload         6
     259: iload         8
     261: invokevirtual #117                // Method java/nio/channels/SocketChannel.register:(Ljava/nio/channels/Selector;I)Ljava/nio/channels/SelectionKey;
     264: astore        7
     266: goto          277
     269: aload         7
     271: iload         8
     273: invokevirtual #118                // Method java/nio/channels/SelectionKey.interestOps:(I)Ljava/nio/channels/SelectionKey;
     276: pop
     277: aload         6
     279: lload_1
     280: invokevirtual #119                // Method java/nio/channels/Selector.select:(J)I
     283: istore        11
     285: iload         11
     287: ifne          317
     290: invokestatic  #114                // Method java/lang/System.currentTimeMillis:()J
     293: lload         9
     295: lsub
     296: lload_1
     297: lcmp
     298: iflt          317
     301: new           #120                // class java/net/SocketTimeoutException
     304: dup
     305: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     308: ldc           #121                // String channel.nio.ssl.timeoutDuringHandshake
     310: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
     313: invokespecial #122                // Method java/net/SocketTimeoutException."<init>":(Ljava/lang/String;)V
     316: athrow
     317: aload         7
     319: invokevirtual #123                // Method java/nio/channels/SelectionKey.isReadable:()Z
     322: istore_3
     323: aload         7
     325: invokevirtual #124                // Method java/nio/channels/SelectionKey.isWritable:()Z
     328: istore        4
     330: goto          175
     333: aload         7
     335: ifnull        348
     338: aload         7
     340: invokevirtual #125                // Method java/nio/channels/SelectionKey.cancel:()V
     343: goto          348
     346: astore        8
     348: aload         6
     350: ifnull        430
     353: aload         6
     355: invokevirtual #127                // Method java/nio/channels/Selector.close:()V
     358: goto          430
     361: astore        8
     363: goto          430
     366: astore        8
     368: aload_0
     369: invokespecial #128                // Method closeSilently:()V
     372: aload         8
     374: athrow
     375: astore        8
     377: aload_0
     378: invokespecial #128                // Method closeSilently:()V
     381: new           #31                 // class java/io/IOException
     384: dup
     385: aload         8
     387: invokespecial #129                // Method java/io/IOException."<init>":(Ljava/lang/Throwable;)V
     390: astore        9
     392: aload         9
     394: athrow
     395: astore        12
     397: aload         7
     399: ifnull        412
     402: aload         7
     404: invokevirtual #125                // Method java/nio/channels/SelectionKey.cancel:()V
     407: goto          412
     410: astore        13
     412: aload         6
     414: ifnull        427
     417: aload         6
     419: invokevirtual #127                // Method java/nio/channels/Selector.close:()V
     422: goto          427
     425: astore        13
     427: aload         12
     429: athrow
     430: return
    Exception table:
       from    to  target type
         338   343   346   Class java/lang/Exception
         353   358   361   Class java/lang/Exception
         157   333   366   Class java/io/IOException
         157   333   375   Class java/lang/Exception
         157   333   395   any
         402   407   410   Class java/lang/Exception
         417   422   425   Class java/lang/Exception
         366   397   395   any

  protected javax.net.ssl.SSLEngineResult$HandshakeStatus tasks();
    Code:
       0: aconst_null
       1: astore_1
       2: aload_0
       3: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
       6: invokevirtual #130                // Method javax/net/ssl/SSLEngine.getDelegatedTask:()Ljava/lang/Runnable;
       9: dup
      10: astore_1
      11: ifnull        23
      14: aload_1
      15: invokeinterface #131,  1          // InterfaceMethod java/lang/Runnable.run:()V
      20: goto          2
      23: aload_0
      24: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
      27: invokevirtual #101                // Method javax/net/ssl/SSLEngine.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
      30: areturn

  protected javax.net.ssl.SSLEngineResult handshakeWrap(boolean) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
       4: invokevirtual #17                 // Method java/nio/ByteBuffer.clear:()Ljava/nio/Buffer;
       7: pop
       8: aload_0
       9: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
      12: invokevirtual #132                // Method org/apache/tomcat/util/net/SocketBufferHandler.configureWriteBufferForRead:()V
      15: aload_0
      16: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
      19: aload_0
      20: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
      23: invokevirtual #133                // Method org/apache/tomcat/util/net/SocketBufferHandler.getWriteBuffer:()Ljava/nio/ByteBuffer;
      26: aload_0
      27: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      30: invokevirtual #134                // Method javax/net/ssl/SSLEngine.wrap:(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Ljavax/net/ssl/SSLEngineResult;
      33: astore_2
      34: aload_0
      35: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      38: invokevirtual #87                 // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
      41: pop
      42: aload_0
      43: aload_2
      44: invokevirtual #135                // Method javax/net/ssl/SSLEngineResult.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
      47: putfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
      50: iload_1
      51: ifeq          63
      54: aload_0
      55: aload_0
      56: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      59: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
      62: pop
      63: aload_2
      64: areturn

  protected javax.net.ssl.SSLEngineResult handshakeUnwrap(boolean) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
       4: invokevirtual #102                // Method java/nio/ByteBuffer.position:()I
       7: aload_0
       8: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      11: invokevirtual #103                // Method java/nio/ByteBuffer.limit:()I
      14: if_icmpne     25
      17: aload_0
      18: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      21: invokevirtual #17                 // Method java/nio/ByteBuffer.clear:()Ljava/nio/Buffer;
      24: pop
      25: iload_1
      26: ifeq          62
      29: aload_0
      30: getfield      #24                 // Field sc:Ljava/nio/channels/SocketChannel;
      33: aload_0
      34: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      37: invokevirtual #64                 // Method java/nio/channels/SocketChannel.read:(Ljava/nio/ByteBuffer;)I
      40: istore_2
      41: iload_2
      42: iconst_m1
      43: if_icmpne     62
      46: new           #31                 // class java/io/IOException
      49: dup
      50: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      53: ldc           #112                // String channel.nio.ssl.eofDuringHandshake
      55: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      58: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      61: athrow
      62: iconst_0
      63: istore_3
      64: aload_0
      65: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      68: invokevirtual #87                 // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
      71: pop
      72: aload_0
      73: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
      76: invokevirtual #136                // Method org/apache/tomcat/util/net/SocketBufferHandler.configureReadBufferForWrite:()V
      79: aload_0
      80: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
      83: aload_0
      84: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      87: aload_0
      88: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
      91: invokevirtual #137                // Method org/apache/tomcat/util/net/SocketBufferHandler.getReadBuffer:()Ljava/nio/ByteBuffer;
      94: invokevirtual #138                // Method javax/net/ssl/SSLEngine.unwrap:(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Ljavax/net/ssl/SSLEngineResult;
      97: astore_2
      98: aload_0
      99: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     102: invokevirtual #139                // Method java/nio/ByteBuffer.compact:()Ljava/nio/ByteBuffer;
     105: pop
     106: aload_0
     107: aload_2
     108: invokevirtual #135                // Method javax/net/ssl/SSLEngineResult.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     111: putfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     114: aload_2
     115: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     118: getstatic     #51                 // Field javax/net/ssl/SSLEngineResult$Status.OK:Ljavax/net/ssl/SSLEngineResult$Status;
     121: if_acmpne     142
     124: aload_2
     125: invokevirtual #135                // Method javax/net/ssl/SSLEngineResult.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     128: getstatic     #52                 // Field javax/net/ssl/SSLEngineResult$HandshakeStatus.NEED_TASK:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     131: if_acmpne     142
     134: aload_0
     135: aload_0
     136: invokevirtual #53                 // Method tasks:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     139: putfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     142: aload_2
     143: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     146: getstatic     #51                 // Field javax/net/ssl/SSLEngineResult$Status.OK:Ljavax/net/ssl/SSLEngineResult$Status;
     149: if_acmpne     166
     152: aload_0
     153: getfield      #29                 // Field handshakeStatus:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     156: getstatic     #58                 // Field javax/net/ssl/SSLEngineResult$HandshakeStatus.NEED_UNWRAP:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     159: if_acmpne     166
     162: iconst_1
     163: goto          167
     166: iconst_0
     167: istore_3
     168: iload_3
     169: ifne          64
     172: aload_2
     173: areturn

  public void close() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #5                  // Field closing:Z
       4: ifeq          8
       7: return
       8: aload_0
       9: iconst_1
      10: putfield      #5                  // Field closing:Z
      13: aload_0
      14: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
      17: invokevirtual #140                // Method javax/net/ssl/SSLEngine.closeOutbound:()V
      20: aload_0
      21: aload_0
      22: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      25: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
      28: ifne          47
      31: new           #31                 // class java/io/IOException
      34: dup
      35: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      38: ldc           #141                // String channel.nio.ssl.remainingDataDuringClose
      40: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      43: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      46: athrow
      47: aload_0
      48: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      51: invokevirtual #17                 // Method java/nio/ByteBuffer.clear:()Ljava/nio/Buffer;
      54: pop
      55: aload_0
      56: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
      59: aload_0
      60: invokevirtual #142                // Method getEmptyBuf:()Ljava/nio/ByteBuffer;
      63: aload_0
      64: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      67: invokevirtual #134                // Method javax/net/ssl/SSLEngine.wrap:(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Ljavax/net/ssl/SSLEngineResult;
      70: astore_1
      71: aload_1
      72: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
      75: getstatic     #54                 // Field javax/net/ssl/SSLEngineResult$Status.CLOSED:Ljavax/net/ssl/SSLEngineResult$Status;
      78: if_acmpeq     97
      81: new           #31                 // class java/io/IOException
      84: dup
      85: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      88: ldc           #143                // String channel.nio.ssl.invalidCloseState
      90: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      93: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      96: athrow
      97: aload_0
      98: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     101: invokevirtual #87                 // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
     104: pop
     105: aload_0
     106: aload_0
     107: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     110: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
     113: pop
     114: aload_0
     115: aload_0
     116: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     119: invokevirtual #22                 // Method java/nio/ByteBuffer.hasRemaining:()Z
     122: ifne          139
     125: aload_1
     126: invokevirtual #135                // Method javax/net/ssl/SSLEngineResult.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     129: getstatic     #144                // Field javax/net/ssl/SSLEngineResult$HandshakeStatus.NEED_WRAP:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     132: if_acmpeq     139
     135: iconst_1
     136: goto          140
     139: iconst_0
     140: putfield      #4                  // Field closed:Z
     143: return

  public void close(boolean) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokevirtual #145                // Method close:()V
       4: iload_1
       5: ifne          15
       8: aload_0
       9: getfield      #4                  // Field closed:Z
      12: ifeq          56
      15: aload_0
      16: iconst_1
      17: putfield      #4                  // Field closed:Z
      20: aload_0
      21: getfield      #24                 // Field sc:Ljava/nio/channels/SocketChannel;
      24: invokevirtual #146                // Method java/nio/channels/SocketChannel.close:()V
      27: goto          56
      30: astore_2
      31: iload_1
      32: ifne          42
      35: aload_0
      36: getfield      #4                  // Field closed:Z
      39: ifeq          54
      42: aload_0
      43: iconst_1
      44: putfield      #4                  // Field closed:Z
      47: aload_0
      48: getfield      #24                 // Field sc:Ljava/nio/channels/SocketChannel;
      51: invokevirtual #146                // Method java/nio/channels/SocketChannel.close:()V
      54: aload_2
      55: athrow
      56: return
    Exception table:
       from    to  target type
           0     4    30   any

  private void closeSilently();
    Code:
       0: aload_0
       1: iconst_1
       2: invokevirtual #147                // Method close:(Z)V
       5: goto          26
       8: astore_1
       9: getstatic     #46                 // Field log:Lorg/apache/juli/logging/Log;
      12: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      15: ldc           #148                // String channel.nio.ssl.closeSilentError
      17: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      20: aload_1
      21: invokeinterface #49,  3           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
      26: return
    Exception table:
       from    to  target type
           0     5     8   Class java/io/IOException

  public int read(java.nio.ByteBuffer) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #5                  // Field closing:Z
       4: ifne          14
       7: aload_0
       8: getfield      #4                  // Field closed:Z
      11: ifeq          16
      14: iconst_m1
      15: ireturn
      16: aload_0
      17: getfield      #3                  // Field handshakeComplete:Z
      20: ifne          39
      23: new           #61                 // class java/lang/IllegalStateException
      26: dup
      27: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      30: ldc           #149                // String channel.nio.ssl.incompleteHandshake
      32: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      35: invokespecial #63                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      38: athrow
      39: aload_0
      40: getfield      #24                 // Field sc:Ljava/nio/channels/SocketChannel;
      43: aload_0
      44: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      47: invokevirtual #64                 // Method java/nio/channels/SocketChannel.read:(Ljava/nio/ByteBuffer;)I
      50: istore_2
      51: iload_2
      52: iconst_m1
      53: if_icmpne     58
      56: iconst_m1
      57: ireturn
      58: iconst_0
      59: istore_3
      60: aload_0
      61: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      64: invokevirtual #87                 // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
      67: pop
      68: aload_0
      69: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
      72: aload_0
      73: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      76: aload_1
      77: invokevirtual #138                // Method javax/net/ssl/SSLEngine.unwrap:(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Ljavax/net/ssl/SSLEngineResult;
      80: astore        4
      82: aload_0
      83: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      86: invokevirtual #139                // Method java/nio/ByteBuffer.compact:()Ljava/nio/ByteBuffer;
      89: pop
      90: aload         4
      92: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
      95: getstatic     #51                 // Field javax/net/ssl/SSLEngineResult$Status.OK:Ljavax/net/ssl/SSLEngineResult$Status;
      98: if_acmpeq     112
     101: aload         4
     103: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     106: getstatic     #60                 // Field javax/net/ssl/SSLEngineResult$Status.BUFFER_UNDERFLOW:Ljavax/net/ssl/SSLEngineResult$Status;
     109: if_acmpne     150
     112: iload_3
     113: aload         4
     115: invokevirtual #150                // Method javax/net/ssl/SSLEngineResult.bytesProduced:()I
     118: iadd
     119: istore_3
     120: aload         4
     122: invokevirtual #135                // Method javax/net/ssl/SSLEngineResult.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     125: getstatic     #52                 // Field javax/net/ssl/SSLEngineResult$HandshakeStatus.NEED_TASK:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     128: if_acmpne     136
     131: aload_0
     132: invokevirtual #53                 // Method tasks:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     135: pop
     136: aload         4
     138: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     141: getstatic     #60                 // Field javax/net/ssl/SSLEngineResult$Status.BUFFER_UNDERFLOW:Ljavax/net/ssl/SSLEngineResult$Status;
     144: if_acmpne     319
     147: goto          329
     150: aload         4
     152: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     155: getstatic     #151                // Field javax/net/ssl/SSLEngineResult$Status.BUFFER_OVERFLOW:Ljavax/net/ssl/SSLEngineResult$Status;
     158: if_acmpne     291
     161: iload_3
     162: ifle          168
     165: goto          329
     168: aload_1
     169: aload_0
     170: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     173: invokevirtual #137                // Method org/apache/tomcat/util/net/SocketBufferHandler.getReadBuffer:()Ljava/nio/ByteBuffer;
     176: if_acmpne     209
     179: aload_0
     180: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     183: aload_0
     184: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     187: invokevirtual #93                 // Method javax/net/ssl/SSLEngine.getSession:()Ljavax/net/ssl/SSLSession;
     190: invokeinterface #94,  1           // InterfaceMethod javax/net/ssl/SSLSession.getApplicationBufferSize:()I
     195: invokevirtual #95                 // Method org/apache/tomcat/util/net/SocketBufferHandler.expand:(I)V
     198: aload_0
     199: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     202: invokevirtual #137                // Method org/apache/tomcat/util/net/SocketBufferHandler.getReadBuffer:()Ljava/nio/ByteBuffer;
     205: astore_1
     206: goto          319
     209: aload_0
     210: invokevirtual #152                // Method getAppReadBufHandler:()Lorg/apache/tomcat/util/net/ApplicationBufferHandler;
     213: ifnull        263
     216: aload_1
     217: aload_0
     218: invokevirtual #152                // Method getAppReadBufHandler:()Lorg/apache/tomcat/util/net/ApplicationBufferHandler;
     221: invokeinterface #153,  1          // InterfaceMethod org/apache/tomcat/util/net/ApplicationBufferHandler.getByteBuffer:()Ljava/nio/ByteBuffer;
     226: if_acmpne     263
     229: aload_0
     230: invokevirtual #152                // Method getAppReadBufHandler:()Lorg/apache/tomcat/util/net/ApplicationBufferHandler;
     233: aload_0
     234: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     237: invokevirtual #93                 // Method javax/net/ssl/SSLEngine.getSession:()Ljavax/net/ssl/SSLSession;
     240: invokeinterface #94,  1           // InterfaceMethod javax/net/ssl/SSLSession.getApplicationBufferSize:()I
     245: invokeinterface #154,  2          // InterfaceMethod org/apache/tomcat/util/net/ApplicationBufferHandler.expand:(I)V
     250: aload_0
     251: invokevirtual #152                // Method getAppReadBufHandler:()Lorg/apache/tomcat/util/net/ApplicationBufferHandler;
     254: invokeinterface #153,  1          // InterfaceMethod org/apache/tomcat/util/net/ApplicationBufferHandler.getByteBuffer:()Ljava/nio/ByteBuffer;
     259: astore_1
     260: goto          319
     263: new           #31                 // class java/io/IOException
     266: dup
     267: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     270: ldc           #155                // String channel.nio.ssl.unwrapFailResize
     272: iconst_1
     273: anewarray     #56                 // class java/lang/Object
     276: dup
     277: iconst_0
     278: aload         4
     280: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     283: aastore
     284: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     287: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     290: athrow
     291: new           #31                 // class java/io/IOException
     294: dup
     295: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     298: ldc           #156                // String channel.nio.ssl.unwrapFail
     300: iconst_1
     301: anewarray     #56                 // class java/lang/Object
     304: dup
     305: iconst_0
     306: aload         4
     308: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     311: aastore
     312: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     315: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     318: athrow
     319: aload_0
     320: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     323: invokevirtual #102                // Method java/nio/ByteBuffer.position:()I
     326: ifne          60
     329: iload_3
     330: ireturn

  public long read(java.nio.ByteBuffer[], int, int) throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #5                  // Field closing:Z
       4: ifne          14
       7: aload_0
       8: getfield      #4                  // Field closed:Z
      11: ifeq          18
      14: ldc2_w        #157                // long -1l
      17: lreturn
      18: aload_0
      19: getfield      #3                  // Field handshakeComplete:Z
      22: ifne          41
      25: new           #61                 // class java/lang/IllegalStateException
      28: dup
      29: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      32: ldc           #149                // String channel.nio.ssl.incompleteHandshake
      34: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      37: invokespecial #63                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      40: athrow
      41: aload_0
      42: getfield      #24                 // Field sc:Ljava/nio/channels/SocketChannel;
      45: aload_0
      46: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      49: invokevirtual #64                 // Method java/nio/channels/SocketChannel.read:(Ljava/nio/ByteBuffer;)I
      52: istore        4
      54: iload         4
      56: iconst_m1
      57: if_icmpne     64
      60: ldc2_w        #157                // long -1l
      63: lreturn
      64: iconst_0
      65: istore        5
      67: getstatic     #159                // Field org/apache/tomcat/util/net/SecureNioChannel$OverflowState.NONE:Lorg/apache/tomcat/util/net/SecureNioChannel$OverflowState;
      70: astore        7
      72: aload         7
      74: getstatic     #160                // Field org/apache/tomcat/util/net/SecureNioChannel$OverflowState.PROCESSING:Lorg/apache/tomcat/util/net/SecureNioChannel$OverflowState;
      77: if_acmpne     85
      80: getstatic     #161                // Field org/apache/tomcat/util/net/SecureNioChannel$OverflowState.DONE:Lorg/apache/tomcat/util/net/SecureNioChannel$OverflowState;
      83: astore        7
      85: aload_0
      86: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
      89: invokevirtual #87                 // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
      92: pop
      93: aload_0
      94: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
      97: aload_0
      98: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     101: aload_1
     102: iload_2
     103: iload_3
     104: invokevirtual #162                // Method javax/net/ssl/SSLEngine.unwrap:(Ljava/nio/ByteBuffer;[Ljava/nio/ByteBuffer;II)Ljavax/net/ssl/SSLEngineResult;
     107: astore        6
     109: aload_0
     110: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     113: invokevirtual #139                // Method java/nio/ByteBuffer.compact:()Ljava/nio/ByteBuffer;
     116: pop
     117: aload         6
     119: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     122: getstatic     #51                 // Field javax/net/ssl/SSLEngineResult$Status.OK:Ljavax/net/ssl/SSLEngineResult$Status;
     125: if_acmpeq     139
     128: aload         6
     130: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     133: getstatic     #60                 // Field javax/net/ssl/SSLEngineResult$Status.BUFFER_UNDERFLOW:Ljavax/net/ssl/SSLEngineResult$Status;
     136: if_acmpne     202
     139: iload         5
     141: aload         6
     143: invokevirtual #150                // Method javax/net/ssl/SSLEngineResult.bytesProduced:()I
     146: iadd
     147: istore        5
     149: aload         7
     151: getstatic     #161                // Field org/apache/tomcat/util/net/SecureNioChannel$OverflowState.DONE:Lorg/apache/tomcat/util/net/SecureNioChannel$OverflowState;
     154: if_acmpne     172
     157: iload         5
     159: aload_0
     160: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     163: invokevirtual #137                // Method org/apache/tomcat/util/net/SocketBufferHandler.getReadBuffer:()Ljava/nio/ByteBuffer;
     166: invokevirtual #102                // Method java/nio/ByteBuffer.position:()I
     169: isub
     170: istore        5
     172: aload         6
     174: invokevirtual #135                // Method javax/net/ssl/SSLEngineResult.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     177: getstatic     #52                 // Field javax/net/ssl/SSLEngineResult$HandshakeStatus.NEED_TASK:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     180: if_acmpne     188
     183: aload_0
     184: invokevirtual #53                 // Method tasks:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     187: pop
     188: aload         6
     190: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     193: getstatic     #60                 // Field javax/net/ssl/SSLEngineResult$Status.BUFFER_UNDERFLOW:Ljavax/net/ssl/SSLEngineResult$Status;
     196: if_acmpne     559
     199: goto          585
     202: aload         6
     204: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     207: getstatic     #151                // Field javax/net/ssl/SSLEngineResult$Status.BUFFER_OVERFLOW:Ljavax/net/ssl/SSLEngineResult$Status;
     210: if_acmpne     531
     213: iload         5
     215: ifle          221
     218: goto          585
     221: aload_0
     222: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     225: invokevirtual #137                // Method org/apache/tomcat/util/net/SocketBufferHandler.getReadBuffer:()Ljava/nio/ByteBuffer;
     228: astore        8
     230: iconst_0
     231: istore        9
     233: iconst_1
     234: istore        10
     236: iconst_0
     237: istore        11
     239: iload         11
     241: iload_3
     242: if_icmpge     409
     245: aload_1
     246: iload_2
     247: iload         11
     249: iadd
     250: aaload
     251: aload_0
     252: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     255: invokevirtual #137                // Method org/apache/tomcat/util/net/SocketBufferHandler.getReadBuffer:()Ljava/nio/ByteBuffer;
     258: if_acmpne     318
     261: aload_0
     262: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     265: aload_0
     266: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     269: invokevirtual #93                 // Method javax/net/ssl/SSLEngine.getSession:()Ljavax/net/ssl/SSLSession;
     272: invokeinterface #94,  1           // InterfaceMethod javax/net/ssl/SSLSession.getApplicationBufferSize:()I
     277: invokevirtual #95                 // Method org/apache/tomcat/util/net/SocketBufferHandler.expand:(I)V
     280: aload_1
     281: iload_2
     282: iload         11
     284: iadd
     285: aaload
     286: aload_0
     287: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     290: invokevirtual #137                // Method org/apache/tomcat/util/net/SocketBufferHandler.getReadBuffer:()Ljava/nio/ByteBuffer;
     293: if_acmpne     299
     296: iconst_0
     297: istore        10
     299: aload_1
     300: iload_2
     301: iload         11
     303: iadd
     304: aload_0
     305: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     308: invokevirtual #137                // Method org/apache/tomcat/util/net/SocketBufferHandler.getReadBuffer:()Ljava/nio/ByteBuffer;
     311: aastore
     312: iconst_1
     313: istore        9
     315: goto          403
     318: aload_0
     319: invokevirtual #152                // Method getAppReadBufHandler:()Lorg/apache/tomcat/util/net/ApplicationBufferHandler;
     322: ifnull        403
     325: aload_1
     326: iload_2
     327: iload         11
     329: iadd
     330: aaload
     331: aload_0
     332: invokevirtual #152                // Method getAppReadBufHandler:()Lorg/apache/tomcat/util/net/ApplicationBufferHandler;
     335: invokeinterface #153,  1          // InterfaceMethod org/apache/tomcat/util/net/ApplicationBufferHandler.getByteBuffer:()Ljava/nio/ByteBuffer;
     340: if_acmpne     403
     343: aload_0
     344: invokevirtual #152                // Method getAppReadBufHandler:()Lorg/apache/tomcat/util/net/ApplicationBufferHandler;
     347: aload_0
     348: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
     351: invokevirtual #93                 // Method javax/net/ssl/SSLEngine.getSession:()Ljavax/net/ssl/SSLSession;
     354: invokeinterface #94,  1           // InterfaceMethod javax/net/ssl/SSLSession.getApplicationBufferSize:()I
     359: invokeinterface #154,  2          // InterfaceMethod org/apache/tomcat/util/net/ApplicationBufferHandler.expand:(I)V
     364: aload_1
     365: iload_2
     366: iload         11
     368: iadd
     369: aaload
     370: aload_0
     371: invokevirtual #152                // Method getAppReadBufHandler:()Lorg/apache/tomcat/util/net/ApplicationBufferHandler;
     374: invokeinterface #153,  1          // InterfaceMethod org/apache/tomcat/util/net/ApplicationBufferHandler.getByteBuffer:()Ljava/nio/ByteBuffer;
     379: if_acmpne     385
     382: iconst_0
     383: istore        10
     385: aload_1
     386: iload_2
     387: iload         11
     389: iadd
     390: aload_0
     391: invokevirtual #152                // Method getAppReadBufHandler:()Lorg/apache/tomcat/util/net/ApplicationBufferHandler;
     394: invokeinterface #153,  1          // InterfaceMethod org/apache/tomcat/util/net/ApplicationBufferHandler.getByteBuffer:()Ljava/nio/ByteBuffer;
     399: aastore
     400: iconst_1
     401: istore        9
     403: iinc          11, 1
     406: goto          239
     409: iload         9
     411: ifeq          447
     414: iload         10
     416: ifne          528
     419: new           #31                 // class java/io/IOException
     422: dup
     423: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     426: ldc           #156                // String channel.nio.ssl.unwrapFail
     428: iconst_1
     429: anewarray     #56                 // class java/lang/Object
     432: dup
     433: iconst_0
     434: aload         6
     436: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     439: aastore
     440: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     443: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     446: athrow
     447: aload_1
     448: arraylength
     449: iconst_1
     450: iadd
     451: anewarray     #163                // class java/nio/ByteBuffer
     454: astore        11
     456: iconst_0
     457: istore        12
     459: iconst_0
     460: istore        13
     462: iload         13
     464: aload_1
     465: arraylength
     466: iconst_1
     467: iadd
     468: if_icmpge     510
     471: iload         13
     473: iload_2
     474: iload_3
     475: iadd
     476: if_icmpne     492
     479: aload         11
     481: iload         13
     483: aload         8
     485: aastore
     486: iconst_m1
     487: istore        12
     489: goto          504
     492: aload         11
     494: iload         13
     496: aload_1
     497: iload         13
     499: iload         12
     501: iadd
     502: aaload
     503: aastore
     504: iinc          13, 1
     507: goto          462
     510: aload         11
     512: astore_1
     513: iinc          3, 1
     516: aload_0
     517: invokevirtual #92                 // Method getBufHandler:()Lorg/apache/tomcat/util/net/SocketBufferHandler;
     520: invokevirtual #136                // Method org/apache/tomcat/util/net/SocketBufferHandler.configureReadBufferForWrite:()V
     523: getstatic     #160                // Field org/apache/tomcat/util/net/SecureNioChannel$OverflowState.PROCESSING:Lorg/apache/tomcat/util/net/SecureNioChannel$OverflowState;
     526: astore        7
     528: goto          559
     531: new           #31                 // class java/io/IOException
     534: dup
     535: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     538: ldc           #156                // String channel.nio.ssl.unwrapFail
     540: iconst_1
     541: anewarray     #56                 // class java/lang/Object
     544: dup
     545: iconst_0
     546: aload         6
     548: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     551: aastore
     552: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     555: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     558: athrow
     559: aload_0
     560: getfield      #10                 // Field netInBuffer:Ljava/nio/ByteBuffer;
     563: invokevirtual #102                // Method java/nio/ByteBuffer.position:()I
     566: ifne          577
     569: aload         7
     571: getstatic     #160                // Field org/apache/tomcat/util/net/SecureNioChannel$OverflowState.PROCESSING:Lorg/apache/tomcat/util/net/SecureNioChannel$OverflowState;
     574: if_acmpne     585
     577: aload         7
     579: getstatic     #161                // Field org/apache/tomcat/util/net/SecureNioChannel$OverflowState.DONE:Lorg/apache/tomcat/util/net/SecureNioChannel$OverflowState;
     582: if_acmpne     72
     585: iload         5
     587: i2l
     588: lreturn

  public int write(java.nio.ByteBuffer) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokevirtual #164                // Method checkInterruptStatus:()V
       4: aload_1
       5: aload_0
       6: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
       9: if_acmpne     23
      12: aload_0
      13: getfield      #24                 // Field sc:Ljava/nio/channels/SocketChannel;
      16: aload_1
      17: invokevirtual #25                 // Method java/nio/channels/SocketChannel.write:(Ljava/nio/ByteBuffer;)I
      20: istore_2
      21: iload_2
      22: ireturn
      23: aload_0
      24: getfield      #5                  // Field closing:Z
      27: ifne          37
      30: aload_0
      31: getfield      #4                  // Field closed:Z
      34: ifeq          53
      37: new           #31                 // class java/io/IOException
      40: dup
      41: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      44: ldc           #165                // String channel.nio.ssl.closing
      46: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      49: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      52: athrow
      53: aload_0
      54: aload_0
      55: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      58: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
      61: ifne          66
      64: iconst_0
      65: ireturn
      66: aload_0
      67: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      70: invokevirtual #17                 // Method java/nio/ByteBuffer.clear:()Ljava/nio/Buffer;
      73: pop
      74: aload_0
      75: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
      78: aload_1
      79: aload_0
      80: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      83: invokevirtual #134                // Method javax/net/ssl/SSLEngine.wrap:(Ljava/nio/ByteBuffer;Ljava/nio/ByteBuffer;)Ljavax/net/ssl/SSLEngineResult;
      86: astore_2
      87: aload_2
      88: invokevirtual #166                // Method javax/net/ssl/SSLEngineResult.bytesConsumed:()I
      91: istore_3
      92: aload_0
      93: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      96: invokevirtual #87                 // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
      99: pop
     100: aload_2
     101: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     104: getstatic     #51                 // Field javax/net/ssl/SSLEngineResult$Status.OK:Ljavax/net/ssl/SSLEngineResult$Status;
     107: if_acmpne     128
     110: aload_2
     111: invokevirtual #135                // Method javax/net/ssl/SSLEngineResult.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     114: getstatic     #52                 // Field javax/net/ssl/SSLEngineResult$HandshakeStatus.NEED_TASK:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     117: if_acmpne     155
     120: aload_0
     121: invokevirtual #53                 // Method tasks:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     124: pop
     125: goto          155
     128: new           #31                 // class java/io/IOException
     131: dup
     132: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     135: ldc           #167                // String channel.nio.ssl.wrapFail
     137: iconst_1
     138: anewarray     #56                 // class java/lang/Object
     141: dup
     142: iconst_0
     143: aload_2
     144: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     147: aastore
     148: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     151: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     154: athrow
     155: aload_0
     156: aload_0
     157: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     160: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
     163: pop
     164: iload_3
     165: ireturn

  public long write(java.nio.ByteBuffer[], int, int) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokevirtual #164                // Method checkInterruptStatus:()V
       4: aload_0
       5: getfield      #5                  // Field closing:Z
       8: ifne          18
      11: aload_0
      12: getfield      #4                  // Field closed:Z
      15: ifeq          34
      18: new           #31                 // class java/io/IOException
      21: dup
      22: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      25: ldc           #165                // String channel.nio.ssl.closing
      27: invokevirtual #34                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;)Ljava/lang/String;
      30: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      33: athrow
      34: aload_0
      35: aload_0
      36: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      39: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
      42: ifne          47
      45: lconst_0
      46: lreturn
      47: aload_0
      48: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      51: invokevirtual #17                 // Method java/nio/ByteBuffer.clear:()Ljava/nio/Buffer;
      54: pop
      55: aload_0
      56: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
      59: aload_1
      60: iload_2
      61: iload_3
      62: aload_0
      63: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      66: invokevirtual #168                // Method javax/net/ssl/SSLEngine.wrap:([Ljava/nio/ByteBuffer;IILjava/nio/ByteBuffer;)Ljavax/net/ssl/SSLEngineResult;
      69: astore        4
      71: aload         4
      73: invokevirtual #166                // Method javax/net/ssl/SSLEngineResult.bytesConsumed:()I
      76: istore        5
      78: aload_0
      79: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      82: invokevirtual #87                 // Method java/nio/ByteBuffer.flip:()Ljava/nio/Buffer;
      85: pop
      86: aload         4
      88: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
      91: getstatic     #51                 // Field javax/net/ssl/SSLEngineResult$Status.OK:Ljavax/net/ssl/SSLEngineResult$Status;
      94: if_acmpne     116
      97: aload         4
      99: invokevirtual #135                // Method javax/net/ssl/SSLEngineResult.getHandshakeStatus:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     102: getstatic     #52                 // Field javax/net/ssl/SSLEngineResult$HandshakeStatus.NEED_TASK:Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     105: if_acmpne     144
     108: aload_0
     109: invokevirtual #53                 // Method tasks:()Ljavax/net/ssl/SSLEngineResult$HandshakeStatus;
     112: pop
     113: goto          144
     116: new           #31                 // class java/io/IOException
     119: dup
     120: getstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     123: ldc           #167                // String channel.nio.ssl.wrapFail
     125: iconst_1
     126: anewarray     #56                 // class java/lang/Object
     129: dup
     130: iconst_0
     131: aload         4
     133: invokevirtual #50                 // Method javax/net/ssl/SSLEngineResult.getStatus:()Ljavax/net/ssl/SSLEngineResult$Status;
     136: aastore
     137: invokevirtual #57                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     140: invokespecial #35                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     143: athrow
     144: aload_0
     145: aload_0
     146: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
     149: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
     152: pop
     153: iload         5
     155: i2l
     156: lreturn

  public int getOutboundRemaining();
    Code:
       0: aload_0
       1: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
       4: invokevirtual #23                 // Method java/nio/ByteBuffer.remaining:()I
       7: ireturn

  public boolean flushOutbound() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
       4: invokevirtual #23                 // Method java/nio/ByteBuffer.remaining:()I
       7: istore_1
       8: aload_0
       9: aload_0
      10: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      13: invokevirtual #20                 // Method flush:(Ljava/nio/ByteBuffer;)Z
      16: pop
      17: aload_0
      18: getfield      #11                 // Field netOutBuffer:Ljava/nio/ByteBuffer;
      21: invokevirtual #23                 // Method java/nio/ByteBuffer.remaining:()I
      24: istore_2
      25: iload_2
      26: iload_1
      27: if_icmpge     34
      30: iconst_1
      31: goto          35
      34: iconst_0
      35: ireturn

  public boolean isHandshakeComplete();
    Code:
       0: aload_0
       1: getfield      #3                  // Field handshakeComplete:Z
       4: ireturn

  public boolean isClosing();
    Code:
       0: aload_0
       1: getfield      #5                  // Field closing:Z
       4: ireturn

  public javax.net.ssl.SSLEngine getSslEngine();
    Code:
       0: aload_0
       1: getfield      #16                 // Field sslEngine:Ljavax/net/ssl/SSLEngine;
       4: areturn

  public java.nio.ByteBuffer getEmptyBuf();
    Code:
       0: getstatic     #169                // Field emptyBuf:Ljava/nio/ByteBuffer;
       3: areturn

  static {};
    Code:
       0: ldc           #8                  // class org/apache/tomcat/util/net/SecureNioChannel
       2: invokestatic  #170                // Method org/apache/juli/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/juli/logging/Log;
       5: putstatic     #46                 // Field log:Lorg/apache/juli/logging/Log;
       8: ldc           #8                  // class org/apache/tomcat/util/net/SecureNioChannel
      10: invokestatic  #171                // Method org/apache/tomcat/util/res/StringManager.getManager:(Ljava/lang/Class;)Lorg/apache/tomcat/util/res/StringManager;
      13: putstatic     #32                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      16: return
}
