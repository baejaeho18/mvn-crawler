Compiled from "Rfc6265CookieProcessor.java"
public class org.apache.tomcat.util.http.Rfc6265CookieProcessor extends org.apache.tomcat.util.http.CookieProcessorBase {
  private static final org.apache.juli.logging.Log log;

  private static final org.apache.tomcat.util.res.StringManager sm;

  private static final java.util.BitSet domainValid;

  public org.apache.tomcat.util.http.Rfc6265CookieProcessor();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/apache/tomcat/util/http/CookieProcessorBase."<init>":()V
       4: return

  public java.nio.charset.Charset getCharset();
    Code:
       0: getstatic     #2                  // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
       3: areturn

  public void parseCookieHeader(org.apache.tomcat.util.http.MimeHeaders, org.apache.tomcat.util.http.ServerCookies);
    Code:
       0: aload_1
       1: ifnonnull     5
       4: return
       5: aload_1
       6: ldc           #3                  // String Cookie
       8: iconst_0
       9: invokevirtual #4                  // Method org/apache/tomcat/util/http/MimeHeaders.findHeader:(Ljava/lang/String;I)I
      12: istore_3
      13: iload_3
      14: iflt          165
      17: aload_1
      18: iload_3
      19: invokevirtual #5                  // Method org/apache/tomcat/util/http/MimeHeaders.getValue:(I)Lorg/apache/tomcat/util/buf/MessageBytes;
      22: astore        4
      24: aload         4
      26: ifnull        151
      29: aload         4
      31: invokevirtual #6                  // Method org/apache/tomcat/util/buf/MessageBytes.isNull:()Z
      34: ifne          151
      37: aload         4
      39: invokevirtual #7                  // Method org/apache/tomcat/util/buf/MessageBytes.getType:()I
      42: iconst_2
      43: if_icmpeq     83
      46: getstatic     #9                  // Field log:Lorg/apache/juli/logging/Log;
      49: invokeinterface #10,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
      54: ifeq          78
      57: new           #11                 // class java/lang/Exception
      60: dup
      61: invokespecial #12                 // Method java/lang/Exception."<init>":()V
      64: astore        5
      66: getstatic     #9                  // Field log:Lorg/apache/juli/logging/Log;
      69: ldc           #13                 // String Cookies: Parsing cookie as String. Expected bytes.
      71: aload         5
      73: invokeinterface #14,  3           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
      78: aload         4
      80: invokevirtual #15                 // Method org/apache/tomcat/util/buf/MessageBytes.toBytes:()V
      83: getstatic     #9                  // Field log:Lorg/apache/juli/logging/Log;
      86: invokeinterface #10,  1           // InterfaceMethod org/apache/juli/logging/Log.isDebugEnabled:()Z
      91: ifeq          125
      94: getstatic     #9                  // Field log:Lorg/apache/juli/logging/Log;
      97: new           #16                 // class java/lang/StringBuilder
     100: dup
     101: invokespecial #17                 // Method java/lang/StringBuilder."<init>":()V
     104: ldc           #18                 // String Cookies: Parsing b[]:
     106: invokevirtual #19                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     109: aload         4
     111: invokevirtual #20                 // Method org/apache/tomcat/util/buf/MessageBytes.toString:()Ljava/lang/String;
     114: invokevirtual #19                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     117: invokevirtual #21                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     120: invokeinterface #22,  2           // InterfaceMethod org/apache/juli/logging/Log.debug:(Ljava/lang/Object;)V
     125: aload         4
     127: invokevirtual #23                 // Method org/apache/tomcat/util/buf/MessageBytes.getByteChunk:()Lorg/apache/tomcat/util/buf/ByteChunk;
     130: astore        5
     132: aload         5
     134: invokevirtual #24                 // Method org/apache/tomcat/util/buf/ByteChunk.getBytes:()[B
     137: aload         5
     139: invokevirtual #25                 // Method org/apache/tomcat/util/buf/ByteChunk.getOffset:()I
     142: aload         5
     144: invokevirtual #26                 // Method org/apache/tomcat/util/buf/ByteChunk.getLength:()I
     147: aload_2
     148: invokestatic  #27                 // Method org/apache/tomcat/util/http/parser/Cookie.parseCookie:([BIILorg/apache/tomcat/util/http/ServerCookies;)V
     151: aload_1
     152: ldc           #3                  // String Cookie
     154: iinc          3, 1
     157: iload_3
     158: invokevirtual #4                  // Method org/apache/tomcat/util/http/MimeHeaders.findHeader:(Ljava/lang/String;I)I
     161: istore_3
     162: goto          13
     165: return

  public java.lang.String generateHeader(javax.servlet.http.Cookie);
    Code:
       0: aload_0
       1: aload_1
       2: aconst_null
       3: invokevirtual #28                 // Method generateHeader:(Ljavax/servlet/http/Cookie;Ljavax/servlet/http/HttpServletRequest;)Ljava/lang/String;
       6: areturn

  public java.lang.String generateHeader(javax.servlet.http.Cookie, javax.servlet.http.HttpServletRequest);
    Code:
       0: new           #29                 // class java/lang/StringBuffer
       3: dup
       4: invokespecial #30                 // Method java/lang/StringBuffer."<init>":()V
       7: astore_3
       8: aload_3
       9: aload_1
      10: invokevirtual #31                 // Method javax/servlet/http/Cookie.getName:()Ljava/lang/String;
      13: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      16: pop
      17: aload_3
      18: bipush        61
      20: invokevirtual #33                 // Method java/lang/StringBuffer.append:(C)Ljava/lang/StringBuffer;
      23: pop
      24: aload_1
      25: invokevirtual #34                 // Method javax/servlet/http/Cookie.getValue:()Ljava/lang/String;
      28: astore        4
      30: aload         4
      32: ifnull        56
      35: aload         4
      37: invokevirtual #35                 // Method java/lang/String.length:()I
      40: ifle          56
      43: aload_0
      44: aload         4
      46: invokespecial #36                 // Method validateCookieValue:(Ljava/lang/String;)V
      49: aload_3
      50: aload         4
      52: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      55: pop
      56: aload_1
      57: invokevirtual #37                 // Method javax/servlet/http/Cookie.getMaxAge:()I
      60: istore        5
      62: iload         5
      64: iconst_m1
      65: if_icmple     145
      68: aload_3
      69: ldc           #38                 // String ; Max-Age=
      71: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      74: pop
      75: aload_3
      76: iload         5
      78: invokevirtual #39                 // Method java/lang/StringBuffer.append:(I)Ljava/lang/StringBuffer;
      81: pop
      82: aload_3
      83: ldc           #40                 // String ; Expires=
      85: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      88: pop
      89: iload         5
      91: ifne          105
      94: aload_3
      95: getstatic     #41                 // Field ANCIENT_DATE:Ljava/lang/String;
      98: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     101: pop
     102: goto          145
     105: getstatic     #42                 // Field COOKIE_DATE_FORMAT:Ljava/lang/ThreadLocal;
     108: invokevirtual #43                 // Method java/lang/ThreadLocal.get:()Ljava/lang/Object;
     111: checkcast     #44                 // class java/text/DateFormat
     114: new           #45                 // class java/util/Date
     117: dup
     118: invokestatic  #46                 // Method java/lang/System.currentTimeMillis:()J
     121: iload         5
     123: i2l
     124: ldc2_w        #47                 // long 1000l
     127: lmul
     128: ladd
     129: invokespecial #49                 // Method java/util/Date."<init>":(J)V
     132: aload_3
     133: new           #50                 // class java/text/FieldPosition
     136: dup
     137: iconst_0
     138: invokespecial #51                 // Method java/text/FieldPosition."<init>":(I)V
     141: invokevirtual #52                 // Method java/text/DateFormat.format:(Ljava/util/Date;Ljava/lang/StringBuffer;Ljava/text/FieldPosition;)Ljava/lang/StringBuffer;
     144: pop
     145: aload_1
     146: invokevirtual #53                 // Method javax/servlet/http/Cookie.getDomain:()Ljava/lang/String;
     149: astore        6
     151: aload         6
     153: ifnull        184
     156: aload         6
     158: invokevirtual #35                 // Method java/lang/String.length:()I
     161: ifle          184
     164: aload_0
     165: aload         6
     167: invokespecial #54                 // Method validateDomain:(Ljava/lang/String;)V
     170: aload_3
     171: ldc           #55                 // String ; Domain=
     173: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     176: pop
     177: aload_3
     178: aload         6
     180: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     183: pop
     184: aload_1
     185: invokevirtual #56                 // Method javax/servlet/http/Cookie.getPath:()Ljava/lang/String;
     188: astore        7
     190: aload         7
     192: ifnull        223
     195: aload         7
     197: invokevirtual #35                 // Method java/lang/String.length:()I
     200: ifle          223
     203: aload_0
     204: aload         7
     206: invokespecial #57                 // Method validatePath:(Ljava/lang/String;)V
     209: aload_3
     210: ldc           #58                 // String ; Path=
     212: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     215: pop
     216: aload_3
     217: aload         7
     219: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     222: pop
     223: aload_1
     224: invokevirtual #59                 // Method javax/servlet/http/Cookie.getSecure:()Z
     227: ifeq          237
     230: aload_3
     231: ldc           #60                 // String ; Secure
     233: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     236: pop
     237: aload_1
     238: invokevirtual #61                 // Method javax/servlet/http/Cookie.isHttpOnly:()Z
     241: ifeq          251
     244: aload_3
     245: ldc           #62                 // String ; HttpOnly
     247: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     250: pop
     251: aload_0
     252: invokevirtual #63                 // Method getSameSiteCookies:()Lorg/apache/tomcat/util/http/SameSiteCookies;
     255: astore        8
     257: aload         8
     259: getstatic     #64                 // Field org/apache/tomcat/util/http/SameSiteCookies.UNSET:Lorg/apache/tomcat/util/http/SameSiteCookies;
     262: invokevirtual #65                 // Method org/apache/tomcat/util/http/SameSiteCookies.equals:(Ljava/lang/Object;)Z
     265: ifne          285
     268: aload_3
     269: ldc           #66                 // String ; SameSite=
     271: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     274: pop
     275: aload_3
     276: aload         8
     278: invokevirtual #67                 // Method org/apache/tomcat/util/http/SameSiteCookies.getValue:()Ljava/lang/String;
     281: invokevirtual #32                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     284: pop
     285: aload_3
     286: invokevirtual #68                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
     289: areturn

  private void validateCookieValue(java.lang.String);
    Code:
       0: iconst_0
       1: istore_2
       2: aload_1
       3: invokevirtual #35                 // Method java/lang/String.length:()I
       6: istore_3
       7: iload_3
       8: iconst_1
       9: if_icmple     39
      12: aload_1
      13: iconst_0
      14: invokevirtual #69                 // Method java/lang/String.charAt:(I)C
      17: bipush        34
      19: if_icmpne     39
      22: aload_1
      23: iload_3
      24: iconst_1
      25: isub
      26: invokevirtual #69                 // Method java/lang/String.charAt:(I)C
      29: bipush        34
      31: if_icmpne     39
      34: iconst_1
      35: istore_2
      36: iinc          3, -1
      39: aload_1
      40: invokevirtual #70                 // Method java/lang/String.toCharArray:()[C
      43: astore        4
      45: iload_2
      46: istore        5
      48: iload         5
      50: iload_3
      51: if_icmpge     137
      54: aload         4
      56: iload         5
      58: caload
      59: istore        6
      61: iload         6
      63: bipush        33
      65: if_icmplt     103
      68: iload         6
      70: bipush        34
      72: if_icmpeq     103
      75: iload         6
      77: bipush        44
      79: if_icmpeq     103
      82: iload         6
      84: bipush        59
      86: if_icmpeq     103
      89: iload         6
      91: bipush        92
      93: if_icmpeq     103
      96: iload         6
      98: bipush        127
     100: if_icmpne     131
     103: new           #71                 // class java/lang/IllegalArgumentException
     106: dup
     107: getstatic     #72                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     110: ldc           #73                 // String rfc6265CookieProcessor.invalidCharInValue
     112: iconst_1
     113: anewarray     #74                 // class java/lang/Object
     116: dup
     117: iconst_0
     118: iload         6
     120: invokestatic  #75                 // Method java/lang/Integer.toString:(I)Ljava/lang/String;
     123: aastore
     124: invokevirtual #76                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     127: invokespecial #77                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     130: athrow
     131: iinc          5, 1
     134: goto          48
     137: return

  private void validateDomain(java.lang.String);
    Code:
       0: iconst_0
       1: istore_2
       2: iconst_m1
       3: istore_3
       4: iconst_m1
       5: istore        4
       7: aload_1
       8: invokevirtual #70                 // Method java/lang/String.toCharArray:()[C
      11: astore        5
      13: iload_2
      14: aload         5
      16: arraylength
      17: if_icmpge     156
      20: iload         4
      22: istore_3
      23: aload         5
      25: iload_2
      26: caload
      27: istore        4
      29: getstatic     #78                 // Field domainValid:Ljava/util/BitSet;
      32: iload         4
      34: invokevirtual #79                 // Method java/util/BitSet.get:(I)Z
      37: ifne          64
      40: new           #71                 // class java/lang/IllegalArgumentException
      43: dup
      44: getstatic     #72                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      47: ldc           #80                 // String rfc6265CookieProcessor.invalidDomain
      49: iconst_1
      50: anewarray     #74                 // class java/lang/Object
      53: dup
      54: iconst_0
      55: aload_1
      56: aastore
      57: invokevirtual #76                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      60: invokespecial #77                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      63: athrow
      64: iload_3
      65: bipush        46
      67: if_icmpeq     75
      70: iload_3
      71: iconst_m1
      72: if_icmpne     113
      75: iload         4
      77: bipush        46
      79: if_icmpeq     89
      82: iload         4
      84: bipush        45
      86: if_icmpne     113
      89: new           #71                 // class java/lang/IllegalArgumentException
      92: dup
      93: getstatic     #72                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      96: ldc           #80                 // String rfc6265CookieProcessor.invalidDomain
      98: iconst_1
      99: anewarray     #74                 // class java/lang/Object
     102: dup
     103: iconst_0
     104: aload_1
     105: aastore
     106: invokevirtual #76                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     109: invokespecial #77                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     112: athrow
     113: iload_3
     114: bipush        45
     116: if_icmpne     150
     119: iload         4
     121: bipush        46
     123: if_icmpne     150
     126: new           #71                 // class java/lang/IllegalArgumentException
     129: dup
     130: getstatic     #72                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     133: ldc           #80                 // String rfc6265CookieProcessor.invalidDomain
     135: iconst_1
     136: anewarray     #74                 // class java/lang/Object
     139: dup
     140: iconst_0
     141: aload_1
     142: aastore
     143: invokevirtual #76                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     146: invokespecial #77                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     149: athrow
     150: iinc          2, 1
     153: goto          13
     156: iload         4
     158: bipush        46
     160: if_icmpeq     170
     163: iload         4
     165: bipush        45
     167: if_icmpne     194
     170: new           #71                 // class java/lang/IllegalArgumentException
     173: dup
     174: getstatic     #72                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
     177: ldc           #80                 // String rfc6265CookieProcessor.invalidDomain
     179: iconst_1
     180: anewarray     #74                 // class java/lang/Object
     183: dup
     184: iconst_0
     185: aload_1
     186: aastore
     187: invokevirtual #76                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
     190: invokespecial #77                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     193: athrow
     194: return

  private void validatePath(java.lang.String);
    Code:
       0: aload_1
       1: invokevirtual #70                 // Method java/lang/String.toCharArray:()[C
       4: astore_2
       5: aload_2
       6: astore_3
       7: aload_3
       8: arraylength
       9: istore        4
      11: iconst_0
      12: istore        5
      14: iload         5
      16: iload         4
      18: if_icmpge     78
      21: aload_3
      22: iload         5
      24: caload
      25: istore        6
      27: iload         6
      29: bipush        32
      31: if_icmplt     48
      34: iload         6
      36: bipush        126
      38: if_icmpgt     48
      41: iload         6
      43: bipush        59
      45: if_icmpne     72
      48: new           #71                 // class java/lang/IllegalArgumentException
      51: dup
      52: getstatic     #72                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      55: ldc           #81                 // String rfc6265CookieProcessor.invalidPath
      57: iconst_1
      58: anewarray     #74                 // class java/lang/Object
      61: dup
      62: iconst_0
      63: aload_1
      64: aastore
      65: invokevirtual #76                 // Method org/apache/tomcat/util/res/StringManager.getString:(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;
      68: invokespecial #77                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      71: athrow
      72: iinc          5, 1
      75: goto          14
      78: return

  static {};
    Code:
       0: ldc           #82                 // class org/apache/tomcat/util/http/Rfc6265CookieProcessor
       2: invokestatic  #83                 // Method org/apache/juli/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/juli/logging/Log;
       5: putstatic     #9                  // Field log:Lorg/apache/juli/logging/Log;
       8: ldc           #82                 // class org/apache/tomcat/util/http/Rfc6265CookieProcessor
      10: invokevirtual #84                 // Method java/lang/Class.getPackage:()Ljava/lang/Package;
      13: invokevirtual #85                 // Method java/lang/Package.getName:()Ljava/lang/String;
      16: invokestatic  #86                 // Method org/apache/tomcat/util/res/StringManager.getManager:(Ljava/lang/String;)Lorg/apache/tomcat/util/res/StringManager;
      19: putstatic     #72                 // Field sm:Lorg/apache/tomcat/util/res/StringManager;
      22: new           #87                 // class java/util/BitSet
      25: dup
      26: sipush        128
      29: invokespecial #88                 // Method java/util/BitSet."<init>":(I)V
      32: putstatic     #78                 // Field domainValid:Ljava/util/BitSet;
      35: bipush        48
      37: istore_0
      38: iload_0
      39: bipush        57
      41: if_icmpgt     59
      44: getstatic     #78                 // Field domainValid:Ljava/util/BitSet;
      47: iload_0
      48: invokevirtual #89                 // Method java/util/BitSet.set:(I)V
      51: iload_0
      52: iconst_1
      53: iadd
      54: i2c
      55: istore_0
      56: goto          38
      59: bipush        97
      61: istore_0
      62: iload_0
      63: bipush        122
      65: if_icmpgt     83
      68: getstatic     #78                 // Field domainValid:Ljava/util/BitSet;
      71: iload_0
      72: invokevirtual #89                 // Method java/util/BitSet.set:(I)V
      75: iload_0
      76: iconst_1
      77: iadd
      78: i2c
      79: istore_0
      80: goto          62
      83: bipush        65
      85: istore_0
      86: iload_0
      87: bipush        90
      89: if_icmpgt     107
      92: getstatic     #78                 // Field domainValid:Ljava/util/BitSet;
      95: iload_0
      96: invokevirtual #89                 // Method java/util/BitSet.set:(I)V
      99: iload_0
     100: iconst_1
     101: iadd
     102: i2c
     103: istore_0
     104: goto          86
     107: getstatic     #78                 // Field domainValid:Ljava/util/BitSet;
     110: bipush        46
     112: invokevirtual #89                 // Method java/util/BitSet.set:(I)V
     115: getstatic     #78                 // Field domainValid:Ljava/util/BitSet;
     118: bipush        45
     120: invokevirtual #89                 // Method java/util/BitSet.set:(I)V
     123: return
}
