public class org.bouncycastle.crypto.agreement.DHBasicAgreement implements org.bouncycastle.crypto.BasicAgreement {
  private static final java.math.BigInteger ONE;

  private org.bouncycastle.crypto.params.DHPrivateKeyParameters key;

  private org.bouncycastle.crypto.params.DHParameters dhParams;

  public org.bouncycastle.crypto.agreement.DHBasicAgreement();
    Code:
       0: aload_0
       1: invokespecial #86                 // Method java/lang/Object."<init>":()V
       4: return

  public void init(org.bouncycastle.crypto.CipherParameters);
    Code:
       0: aload_1
       1: instanceof    #50                 // class org/bouncycastle/crypto/params/ParametersWithRandom
       4: ifeq          23
       7: aload_1
       8: checkcast     #50                 // class org/bouncycastle/crypto/params/ParametersWithRandom
      11: astore_3
      12: aload_3
      13: invokevirtual #99                 // Method org/bouncycastle/crypto/params/ParametersWithRandom.getParameters:()Lorg/bouncycastle/crypto/CipherParameters;
      16: checkcast     #46                 // class org/bouncycastle/crypto/params/AsymmetricKeyParameter
      19: astore_2
      20: goto          28
      23: aload_1
      24: checkcast     #46                 // class org/bouncycastle/crypto/params/AsymmetricKeyParameter
      27: astore_2
      28: aload_2
      29: instanceof    #48                 // class org/bouncycastle/crypto/params/DHPrivateKeyParameters
      32: ifne          45
      35: new           #40                 // class java/lang/IllegalArgumentException
      38: dup
      39: ldc           #1                  // String DHEngine expects DHPrivateKeyParameters
      41: invokespecial #84                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      44: athrow
      45: aload_0
      46: aload_2
      47: checkcast     #48                 // class org/bouncycastle/crypto/params/DHPrivateKeyParameters
      50: putfield      #83                 // Field key:Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
      53: aload_0
      54: aload_0
      55: getfield      #83                 // Field key:Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
      58: invokevirtual #96                 // Method org/bouncycastle/crypto/params/DHPrivateKeyParameters.getParameters:()Lorg/bouncycastle/crypto/params/DHParameters;
      61: putfield      #82                 // Field dhParams:Lorg/bouncycastle/crypto/params/DHParameters;
      64: return

  public int getFieldSize();
    Code:
       0: aload_0
       1: getfield      #83                 // Field key:Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
       4: invokevirtual #96                 // Method org/bouncycastle/crypto/params/DHPrivateKeyParameters.getParameters:()Lorg/bouncycastle/crypto/params/DHParameters;
       7: invokevirtual #94                 // Method org/bouncycastle/crypto/params/DHParameters.getP:()Ljava/math/BigInteger;
      10: invokevirtual #87                 // Method java/math/BigInteger.bitLength:()I
      13: bipush        7
      15: iadd
      16: bipush        8
      18: idiv
      19: ireturn

  public java.math.BigInteger calculateAgreement(org.bouncycastle.crypto.CipherParameters);
    Code:
       0: aload_1
       1: checkcast     #49                 // class org/bouncycastle/crypto/params/DHPublicKeyParameters
       4: astore_2
       5: aload_2
       6: invokevirtual #98                 // Method org/bouncycastle/crypto/params/DHPublicKeyParameters.getParameters:()Lorg/bouncycastle/crypto/params/DHParameters;
       9: aload_0
      10: getfield      #82                 // Field dhParams:Lorg/bouncycastle/crypto/params/DHParameters;
      13: invokevirtual #93                 // Method org/bouncycastle/crypto/params/DHParameters.equals:(Ljava/lang/Object;)Z
      16: ifne          29
      19: new           #40                 // class java/lang/IllegalArgumentException
      22: dup
      23: ldc           #2                  // String Diffie-Hellman public key has wrong parameters.
      25: invokespecial #84                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      28: athrow
      29: aload_0
      30: getfield      #82                 // Field dhParams:Lorg/bouncycastle/crypto/params/DHParameters;
      33: invokevirtual #94                 // Method org/bouncycastle/crypto/params/DHParameters.getP:()Ljava/math/BigInteger;
      36: astore_3
      37: aload_2
      38: invokevirtual #97                 // Method org/bouncycastle/crypto/params/DHPublicKeyParameters.getY:()Ljava/math/BigInteger;
      41: astore        4
      43: aload         4
      45: ifnull        74
      48: aload         4
      50: getstatic     #81                 // Field ONE:Ljava/math/BigInteger;
      53: invokevirtual #90                 // Method java/math/BigInteger.compareTo:(Ljava/math/BigInteger;)I
      56: ifle          74
      59: aload         4
      61: aload_3
      62: getstatic     #81                 // Field ONE:Ljava/math/BigInteger;
      65: invokevirtual #91                 // Method java/math/BigInteger.subtract:(Ljava/math/BigInteger;)Ljava/math/BigInteger;
      68: invokevirtual #90                 // Method java/math/BigInteger.compareTo:(Ljava/math/BigInteger;)I
      71: iflt          84
      74: new           #40                 // class java/lang/IllegalArgumentException
      77: dup
      78: ldc           #3                  // String Diffie-Hellman public key is weak
      80: invokespecial #84                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
      83: athrow
      84: aload         4
      86: aload_0
      87: getfield      #83                 // Field key:Lorg/bouncycastle/crypto/params/DHPrivateKeyParameters;
      90: invokevirtual #95                 // Method org/bouncycastle/crypto/params/DHPrivateKeyParameters.getX:()Ljava/math/BigInteger;
      93: aload_3
      94: invokevirtual #92                 // Method java/math/BigInteger.modPow:(Ljava/math/BigInteger;Ljava/math/BigInteger;)Ljava/math/BigInteger;
      97: astore        5
      99: aload         5
     101: getstatic     #81                 // Field ONE:Ljava/math/BigInteger;
     104: invokevirtual #88                 // Method java/math/BigInteger.equals:(Ljava/lang/Object;)Z
     107: ifeq          120
     110: new           #41                 // class java/lang/IllegalStateException
     113: dup
     114: ldc           #4                  // String Shared key can\'t be 1
     116: invokespecial #85                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     119: athrow
     120: aload         5
     122: areturn

  static {};
    Code:
       0: lconst_1
       1: invokestatic  #89                 // Method java/math/BigInteger.valueOf:(J)Ljava/math/BigInteger;
       4: putstatic     #81                 // Field ONE:Ljava/math/BigInteger;
       7: return
}
