public class org.bouncycastle.jce.provider.X509LDAPCertStoreSpi extends java.security.cert.CertStoreSpi {
  private org.bouncycastle.jce.X509LDAPCertStoreParameters params;

  private static java.lang.String LDAP_PROVIDER;

  private static java.lang.String REFERRALS_IGNORE;

  private static final java.lang.String SEARCH_SECURITY_LEVEL;

  private static final java.lang.String URL_CONTEXT_PREFIX;

  public org.bouncycastle.jce.provider.X509LDAPCertStoreSpi(java.security.cert.CertStoreParameters) throws java.security.InvalidAlgorithmParameterException;
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #360                // Method java/security/cert/CertStoreSpi."<init>":(Ljava/security/cert/CertStoreParameters;)V
       5: aload_1
       6: instanceof    #31                 // class org/bouncycastle/jce/X509LDAPCertStoreParameters
       9: ifne          63
      12: new           #192                // class java/security/InvalidAlgorithmParameterException
      15: dup
      16: new           #190                // class java/lang/StringBuilder
      19: dup
      20: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
      23: ldc           #32                 // class org/bouncycastle/jce/provider/X509LDAPCertStoreSpi
      25: invokevirtual #341                // Method java/lang/Class.getName:()Ljava/lang/String;
      28: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      31: ldc           #8                  // String : parameter must be a
      33: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      36: ldc           #31                 // class org/bouncycastle/jce/X509LDAPCertStoreParameters
      38: invokevirtual #341                // Method java/lang/Class.getName:()Ljava/lang/String;
      41: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      44: ldc           #1                  // String  object\n
      46: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      49: aload_1
      50: invokevirtual #342                // Method java/lang/Object.toString:()Ljava/lang/String;
      53: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      56: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      59: invokespecial #358                // Method java/security/InvalidAlgorithmParameterException."<init>":(Ljava/lang/String;)V
      62: athrow
      63: aload_0
      64: aload_1
      65: checkcast     #31                 // class org/bouncycastle/jce/X509LDAPCertStoreParameters
      68: putfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      71: return

  private javax.naming.directory.DirContext connectLDAP() throws javax.naming.NamingException;
    Code:
       0: new           #204                // class java/util/Properties
       3: dup
       4: invokespecial #374                // Method java/util/Properties."<init>":()V
       7: astore_1
       8: aload_1
       9: ldc           #23                 // String java.naming.factory.initial
      11: getstatic     #337                // Field LDAP_PROVIDER:Ljava/lang/String;
      14: invokevirtual #375                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      17: pop
      18: aload_1
      19: ldc           #22                 // String java.naming.batchsize
      21: ldc           #7                  // String 0
      23: invokevirtual #375                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      26: pop
      27: aload_1
      28: ldc           #25                 // String java.naming.provider.url
      30: aload_0
      31: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      34: invokevirtual #400                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getLdapURL:()Ljava/lang/String;
      37: invokevirtual #375                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      40: pop
      41: aload_1
      42: ldc           #24                 // String java.naming.factory.url.pkgs
      44: ldc           #19                 // String com.sun.jndi.url
      46: invokevirtual #375                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      49: pop
      50: aload_1
      51: ldc           #26                 // String java.naming.referral
      53: getstatic     #338                // Field REFERRALS_IGNORE:Ljava/lang/String;
      56: invokevirtual #375                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      59: pop
      60: aload_1
      61: ldc           #27                 // String java.naming.security.authentication
      63: ldc           #28                 // String none
      65: invokevirtual #375                // Method java/util/Properties.setProperty:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Object;
      68: pop
      69: new           #211                // class javax/naming/directory/InitialDirContext
      72: dup
      73: aload_1
      74: invokespecial #376                // Method javax/naming/directory/InitialDirContext."<init>":(Ljava/util/Hashtable;)V
      77: astore_2
      78: aload_2
      79: areturn

  private java.lang.String parseDN(java.lang.String, java.lang.String);
    Code:
       0: aload_1
       1: astore_3
       2: aload_3
       3: invokevirtual #347                // Method java/lang/String.toLowerCase:()Ljava/lang/String;
       6: aload_2
       7: invokevirtual #347                // Method java/lang/String.toLowerCase:()Ljava/lang/String;
      10: invokevirtual #350                // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      13: istore        4
      15: aload_3
      16: iload         4
      18: aload_2
      19: invokevirtual #343                // Method java/lang/String.length:()I
      22: iadd
      23: invokevirtual #348                // Method java/lang/String.substring:(I)Ljava/lang/String;
      26: astore_3
      27: aload_3
      28: bipush        44
      30: invokevirtual #345                // Method java/lang/String.indexOf:(I)I
      33: istore        5
      35: iload         5
      37: iconst_m1
      38: if_icmpne     47
      41: aload_3
      42: invokevirtual #343                // Method java/lang/String.length:()I
      45: istore        5
      47: aload_3
      48: iload         5
      50: iconst_1
      51: isub
      52: invokevirtual #344                // Method java/lang/String.charAt:(I)C
      55: bipush        92
      57: if_icmpne     87
      60: aload_3
      61: bipush        44
      63: iload         5
      65: iconst_1
      66: iadd
      67: invokevirtual #346                // Method java/lang/String.indexOf:(II)I
      70: istore        5
      72: iload         5
      74: iconst_m1
      75: if_icmpne     47
      78: aload_3
      79: invokevirtual #343                // Method java/lang/String.length:()I
      82: istore        5
      84: goto          47
      87: aload_3
      88: iconst_0
      89: iload         5
      91: invokevirtual #349                // Method java/lang/String.substring:(II)Ljava/lang/String;
      94: astore_3
      95: aload_3
      96: bipush        61
      98: invokevirtual #345                // Method java/lang/String.indexOf:(I)I
     101: istore        4
     103: aload_3
     104: iload         4
     106: iconst_1
     107: iadd
     108: invokevirtual #348                // Method java/lang/String.substring:(I)Ljava/lang/String;
     111: astore_3
     112: aload_3
     113: iconst_0
     114: invokevirtual #344                // Method java/lang/String.charAt:(I)C
     117: bipush        32
     119: if_icmpne     128
     122: aload_3
     123: iconst_1
     124: invokevirtual #348                // Method java/lang/String.substring:(I)Ljava/lang/String;
     127: astore_3
     128: aload_3
     129: ldc           #2                  // String \"
     131: invokevirtual #352                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
     134: ifeq          143
     137: aload_3
     138: iconst_1
     139: invokevirtual #348                // Method java/lang/String.substring:(I)Ljava/lang/String;
     142: astore_3
     143: aload_3
     144: ldc           #2                  // String \"
     146: invokevirtual #351                // Method java/lang/String.endsWith:(Ljava/lang/String;)Z
     149: ifeq          164
     152: aload_3
     153: iconst_0
     154: aload_3
     155: invokevirtual #343                // Method java/lang/String.length:()I
     158: iconst_1
     159: isub
     160: invokevirtual #349                // Method java/lang/String.substring:(II)Ljava/lang/String;
     163: astore_3
     164: aload_3
     165: areturn

  public java.util.Collection engineGetCertificates(java.security.cert.CertSelector) throws java.security.cert.CertStoreException;
    Code:
       0: aload_1
       1: instanceof    #197                // class java/security/cert/X509CertSelector
       4: ifne          17
       7: new           #193                // class java/security/cert/CertStoreException
      10: dup
      11: ldc           #30                 // String selector is not a X509CertSelector
      13: invokespecial #359                // Method java/security/cert/CertStoreException."<init>":(Ljava/lang/String;)V
      16: athrow
      17: aload_1
      18: checkcast     #197                // class java/security/cert/X509CertSelector
      21: astore_2
      22: new           #201                // class java/util/HashSet
      25: dup
      26: invokespecial #373                // Method java/util/HashSet."<init>":()V
      29: astore_3
      30: aload_0
      31: aload_2
      32: invokespecial #408                // Method getEndCertificates:(Ljava/security/cert/X509CertSelector;)Ljava/util/Set;
      35: astore        4
      37: aload         4
      39: aload_0
      40: aload_2
      41: invokespecial #406                // Method getCACertificates:(Ljava/security/cert/X509CertSelector;)Ljava/util/Set;
      44: invokeinterface #420,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
      49: pop
      50: aload         4
      52: aload_0
      53: aload_2
      54: invokespecial #407                // Method getCrossCertificates:(Ljava/security/cert/X509CertSelector;)Ljava/util/Set;
      57: invokeinterface #420,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
      62: pop
      63: aload         4
      65: invokeinterface #421,  1          // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
      70: astore        5
      72: ldc           #16                 // String X.509
      74: ldc           #12                 // String BC
      76: invokestatic  #363                // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
      79: astore        6
      81: aload         5
      83: invokeinterface #413,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      88: ifeq          300
      91: aload         5
      93: invokeinterface #414,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      98: checkcast     #182                // class "[B"
     101: checkcast     #182                // class "[B"
     104: astore        7
     106: aload         7
     108: ifnull        81
     111: aload         7
     113: arraylength
     114: ifne          120
     117: goto          81
     120: new           #199                // class java/util/ArrayList
     123: dup
     124: invokespecial #372                // Method java/util/ArrayList."<init>":()V
     127: astore        8
     129: aload         8
     131: aload         7
     133: invokeinterface #416,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     138: pop
     139: new           #215                // class org/bouncycastle/asn1/ASN1InputStream
     142: dup
     143: aload         7
     145: invokespecial #384                // Method org/bouncycastle/asn1/ASN1InputStream."<init>":([B)V
     148: invokevirtual #385                // Method org/bouncycastle/asn1/ASN1InputStream.readObject:()Lorg/bouncycastle/asn1/ASN1Primitive;
     151: invokestatic  #389                // Method org/bouncycastle/asn1/x509/CertificatePair.getInstance:(Ljava/lang/Object;)Lorg/bouncycastle/asn1/x509/CertificatePair;
     154: astore        9
     156: aload         8
     158: invokeinterface #415,  1          // InterfaceMethod java/util/List.clear:()V
     163: aload         9
     165: invokevirtual #387                // Method org/bouncycastle/asn1/x509/CertificatePair.getForward:()Lorg/bouncycastle/asn1/x509/Certificate;
     168: ifnull        187
     171: aload         8
     173: aload         9
     175: invokevirtual #387                // Method org/bouncycastle/asn1/x509/CertificatePair.getForward:()Lorg/bouncycastle/asn1/x509/Certificate;
     178: invokevirtual #386                // Method org/bouncycastle/asn1/x509/Certificate.getEncoded:()[B
     181: invokeinterface #416,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     186: pop
     187: aload         9
     189: invokevirtual #388                // Method org/bouncycastle/asn1/x509/CertificatePair.getReverse:()Lorg/bouncycastle/asn1/x509/Certificate;
     192: ifnull        211
     195: aload         8
     197: aload         9
     199: invokevirtual #388                // Method org/bouncycastle/asn1/x509/CertificatePair.getReverse:()Lorg/bouncycastle/asn1/x509/Certificate;
     202: invokevirtual #386                // Method org/bouncycastle/asn1/x509/Certificate.getEncoded:()[B
     205: invokeinterface #416,  2          // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
     210: pop
     211: goto          221
     214: astore        9
     216: goto          221
     219: astore        9
     221: aload         8
     223: invokeinterface #417,  1          // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
     228: astore        9
     230: aload         9
     232: invokeinterface #413,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     237: ifeq          297
     240: new           #183                // class java/io/ByteArrayInputStream
     243: dup
     244: aload         9
     246: invokeinterface #414,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     251: checkcast     #182                // class "[B"
     254: checkcast     #182                // class "[B"
     257: invokespecial #340                // Method java/io/ByteArrayInputStream."<init>":([B)V
     260: astore        10
     262: aload         6
     264: aload         10
     266: invokevirtual #362                // Method java/security/cert/CertificateFactory.generateCertificate:(Ljava/io/InputStream;)Ljava/security/cert/Certificate;
     269: astore        11
     271: aload_2
     272: aload         11
     274: invokevirtual #368                // Method java/security/cert/X509CertSelector.match:(Ljava/security/cert/Certificate;)Z
     277: ifeq          289
     280: aload_3
     281: aload         11
     283: invokeinterface #419,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     288: pop
     289: goto          294
     292: astore        11
     294: goto          230
     297: goto          81
     300: goto          333
     303: astore        6
     305: new           #193                // class java/security/cert/CertStoreException
     308: dup
     309: new           #190                // class java/lang/StringBuilder
     312: dup
     313: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
     316: ldc           #17                 // String certificate cannot be constructed from LDAP result:
     318: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     321: aload         6
     323: invokevirtual #355                // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     326: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     329: invokespecial #359                // Method java/security/cert/CertStoreException."<init>":(Ljava/lang/String;)V
     332: athrow
     333: aload_3
     334: areturn
    Exception table:
       from    to  target type
         139   211   214   Class java/io/IOException
         139   211   219   Class java/lang/IllegalArgumentException
         262   289   292   Class java/lang/Exception
          72   300   303   Class java/lang/Exception

  private java.util.Set certSubjectSerialSearch(java.security.cert.X509CertSelector, java.lang.String[], java.lang.String, java.lang.String) throws java.security.cert.CertStoreException;
    Code:
       0: new           #201                // class java/util/HashSet
       3: dup
       4: invokespecial #373                // Method java/util/HashSet."<init>":()V
       7: astore        5
       9: aload_1
      10: invokevirtual #366                // Method java/security/cert/X509CertSelector.getSubjectAsBytes:()[B
      13: ifnonnull     30
      16: aload_1
      17: invokevirtual #367                // Method java/security/cert/X509CertSelector.getSubjectAsString:()Ljava/lang/String;
      20: ifnonnull     30
      23: aload_1
      24: invokevirtual #369                // Method java/security/cert/X509CertSelector.getCertificate:()Ljava/security/cert/X509Certificate;
      27: ifnull        224
      30: aconst_null
      31: astore        6
      33: aconst_null
      34: astore        7
      36: aload_1
      37: invokevirtual #369                // Method java/security/cert/X509CertSelector.getCertificate:()Ljava/security/cert/X509Certificate;
      40: ifnull        72
      43: aload_1
      44: invokevirtual #369                // Method java/security/cert/X509CertSelector.getCertificate:()Ljava/security/cert/X509Certificate;
      47: invokevirtual #371                // Method java/security/cert/X509Certificate.getSubjectX500Principal:()Ljavax/security/auth/x500/X500Principal;
      50: ldc           #15                 // String RFC1779
      52: invokevirtual #383                // Method javax/security/auth/x500/X500Principal.getName:(Ljava/lang/String;)Ljava/lang/String;
      55: astore        6
      57: aload_1
      58: invokevirtual #369                // Method java/security/cert/X509CertSelector.getCertificate:()Ljava/security/cert/X509Certificate;
      61: invokevirtual #370                // Method java/security/cert/X509Certificate.getSerialNumber:()Ljava/math/BigInteger;
      64: invokevirtual #357                // Method java/math/BigInteger.toString:()Ljava/lang/String;
      67: astore        7
      69: goto          106
      72: aload_1
      73: invokevirtual #366                // Method java/security/cert/X509CertSelector.getSubjectAsBytes:()[B
      76: ifnull        100
      79: new           #214                // class javax/security/auth/x500/X500Principal
      82: dup
      83: aload_1
      84: invokevirtual #366                // Method java/security/cert/X509CertSelector.getSubjectAsBytes:()[B
      87: invokespecial #382                // Method javax/security/auth/x500/X500Principal."<init>":([B)V
      90: ldc           #15                 // String RFC1779
      92: invokevirtual #383                // Method javax/security/auth/x500/X500Principal.getName:(Ljava/lang/String;)Ljava/lang/String;
      95: astore        6
      97: goto          106
     100: aload_1
     101: invokevirtual #367                // Method java/security/cert/X509CertSelector.getSubjectAsString:()Ljava/lang/String;
     104: astore        6
     106: aload_0
     107: aload         6
     109: aload         4
     111: invokespecial #409                // Method parseDN:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     114: astore        8
     116: aload         5
     118: aload_0
     119: aload_3
     120: new           #190                // class java/lang/StringBuilder
     123: dup
     124: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
     127: ldc           #6                  // String *
     129: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     132: aload         8
     134: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     137: ldc           #6                  // String *
     139: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     142: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     145: aload_2
     146: invokespecial #410                // Method search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Ljava/util/Set;
     149: invokeinterface #420,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     154: pop
     155: aload         7
     157: ifnull        221
     160: aload_0
     161: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
     164: invokevirtual #402                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getSearchForSerialNumberIn:()Ljava/lang/String;
     167: ifnull        221
     170: aload         7
     172: astore        8
     174: aload_0
     175: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
     178: invokevirtual #402                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getSearchForSerialNumberIn:()Ljava/lang/String;
     181: astore_3
     182: aload         5
     184: aload_0
     185: aload_3
     186: new           #190                // class java/lang/StringBuilder
     189: dup
     190: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
     193: ldc           #6                  // String *
     195: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     198: aload         8
     200: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     203: ldc           #6                  // String *
     205: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     208: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     211: aload_2
     212: invokespecial #410                // Method search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Ljava/util/Set;
     215: invokeinterface #420,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     220: pop
     221: goto          240
     224: aload         5
     226: aload_0
     227: aload_3
     228: ldc           #6                  // String *
     230: aload_2
     231: invokespecial #410                // Method search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Ljava/util/Set;
     234: invokeinterface #420,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     239: pop
     240: goto          273
     243: astore        6
     245: new           #193                // class java/security/cert/CertStoreException
     248: dup
     249: new           #190                // class java/lang/StringBuilder
     252: dup
     253: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
     256: ldc           #20                 // String exception processing selector:
     258: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     261: aload         6
     263: invokevirtual #355                // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     266: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     269: invokespecial #359                // Method java/security/cert/CertStoreException."<init>":(Ljava/lang/String;)V
     272: athrow
     273: aload         5
     275: areturn
    Exception table:
       from    to  target type
           9   240   243   Class java/io/IOException

  private java.util.Set getEndCertificates(java.security.cert.X509CertSelector) throws java.security.cert.CertStoreException;
    Code:
       0: iconst_1
       1: anewarray     #189                // class java/lang/String
       4: dup
       5: iconst_0
       6: aload_0
       7: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      10: invokevirtual #403                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getUserCertificateAttribute:()Ljava/lang/String;
      13: aastore
      14: astore_2
      15: aload_0
      16: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      19: invokevirtual #401                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getLdapUserCertificateAttributeName:()Ljava/lang/String;
      22: astore_3
      23: aload_0
      24: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      27: invokevirtual #404                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getUserCertificateSubjectAttributeName:()Ljava/lang/String;
      30: astore        4
      32: aload_0
      33: aload_1
      34: aload_2
      35: aload_3
      36: aload         4
      38: invokespecial #411                // Method certSubjectSerialSearch:(Ljava/security/cert/X509CertSelector;[Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/util/Set;
      41: astore        5
      43: aload         5
      45: areturn

  private java.util.Set getCACertificates(java.security.cert.X509CertSelector) throws java.security.cert.CertStoreException;
    Code:
       0: iconst_1
       1: anewarray     #189                // class java/lang/String
       4: dup
       5: iconst_0
       6: aload_0
       7: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      10: invokevirtual #391                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getCACertificateAttribute:()Ljava/lang/String;
      13: aastore
      14: astore_2
      15: aload_0
      16: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      19: invokevirtual #397                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getLdapCACertificateAttributeName:()Ljava/lang/String;
      22: astore_3
      23: aload_0
      24: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      27: invokevirtual #392                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getCACertificateSubjectAttributeName:()Ljava/lang/String;
      30: astore        4
      32: aload_0
      33: aload_1
      34: aload_2
      35: aload_3
      36: aload         4
      38: invokespecial #411                // Method certSubjectSerialSearch:(Ljava/security/cert/X509CertSelector;[Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/util/Set;
      41: astore        5
      43: aload         5
      45: invokeinterface #418,  1          // InterfaceMethod java/util/Set.isEmpty:()Z
      50: ifeq          69
      53: aload         5
      55: aload_0
      56: aconst_null
      57: ldc           #6                  // String *
      59: aload_2
      60: invokespecial #410                // Method search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Ljava/util/Set;
      63: invokeinterface #420,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
      68: pop
      69: aload         5
      71: areturn

  private java.util.Set getCrossCertificates(java.security.cert.X509CertSelector) throws java.security.cert.CertStoreException;
    Code:
       0: iconst_1
       1: anewarray     #189                // class java/lang/String
       4: dup
       5: iconst_0
       6: aload_0
       7: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      10: invokevirtual #395                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getCrossCertificateAttribute:()Ljava/lang/String;
      13: aastore
      14: astore_2
      15: aload_0
      16: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      19: invokevirtual #399                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getLdapCrossCertificateAttributeName:()Ljava/lang/String;
      22: astore_3
      23: aload_0
      24: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      27: invokevirtual #396                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getCrossCertificateSubjectAttributeName:()Ljava/lang/String;
      30: astore        4
      32: aload_0
      33: aload_1
      34: aload_2
      35: aload_3
      36: aload         4
      38: invokespecial #411                // Method certSubjectSerialSearch:(Ljava/security/cert/X509CertSelector;[Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/util/Set;
      41: astore        5
      43: aload         5
      45: invokeinterface #418,  1          // InterfaceMethod java/util/Set.isEmpty:()Z
      50: ifeq          69
      53: aload         5
      55: aload_0
      56: aconst_null
      57: ldc           #6                  // String *
      59: aload_2
      60: invokespecial #410                // Method search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Ljava/util/Set;
      63: invokeinterface #420,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
      68: pop
      69: aload         5
      71: areturn

  public java.util.Collection engineGetCRLs(java.security.cert.CRLSelector) throws java.security.cert.CertStoreException;
    Code:
       0: iconst_1
       1: anewarray     #189                // class java/lang/String
       4: dup
       5: iconst_0
       6: aload_0
       7: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      10: invokevirtual #393                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getCertificateRevocationListAttribute:()Ljava/lang/String;
      13: aastore
      14: astore_2
      15: aload_1
      16: instanceof    #196                // class java/security/cert/X509CRLSelector
      19: ifne          32
      22: new           #193                // class java/security/cert/CertStoreException
      25: dup
      26: ldc           #29                 // String selector is not a X509CRLSelector
      28: invokespecial #359                // Method java/security/cert/CertStoreException."<init>":(Ljava/lang/String;)V
      31: athrow
      32: aload_1
      33: checkcast     #196                // class java/security/cert/X509CRLSelector
      36: astore_3
      37: new           #201                // class java/util/HashSet
      40: dup
      41: invokespecial #373                // Method java/util/HashSet."<init>":()V
      44: astore        4
      46: aload_0
      47: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
      50: invokevirtual #398                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getLdapCertificateRevocationListAttributeName:()Ljava/lang/String;
      53: astore        5
      55: new           #201                // class java/util/HashSet
      58: dup
      59: invokespecial #373                // Method java/util/HashSet."<init>":()V
      62: astore        6
      64: aload_3
      65: invokevirtual #365                // Method java/security/cert/X509CRLSelector.getIssuerNames:()Ljava/util/Collection;
      68: ifnull        220
      71: aload_3
      72: invokevirtual #365                // Method java/security/cert/X509CRLSelector.getIssuerNames:()Ljava/util/Collection;
      75: invokeinterface #412,  1          // InterfaceMethod java/util/Collection.iterator:()Ljava/util/Iterator;
      80: astore        7
      82: aload         7
      84: invokeinterface #413,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
      89: ifeq          217
      92: aload         7
      94: invokeinterface #414,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
      99: astore        8
     101: aconst_null
     102: astore        9
     104: aload         8
     106: instanceof    #189                // class java/lang/String
     109: ifeq          137
     112: aload_0
     113: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
     116: invokevirtual #394                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getCertificateRevocationListIssuerAttributeName:()Ljava/lang/String;
     119: astore        10
     121: aload_0
     122: aload         8
     124: checkcast     #189                // class java/lang/String
     127: aload         10
     129: invokespecial #409                // Method parseDN:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     132: astore        9
     134: goto          174
     137: aload_0
     138: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
     141: invokevirtual #394                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getCertificateRevocationListIssuerAttributeName:()Ljava/lang/String;
     144: astore        10
     146: aload_0
     147: new           #214                // class javax/security/auth/x500/X500Principal
     150: dup
     151: aload         8
     153: checkcast     #182                // class "[B"
     156: checkcast     #182                // class "[B"
     159: invokespecial #382                // Method javax/security/auth/x500/X500Principal."<init>":([B)V
     162: ldc           #15                 // String RFC1779
     164: invokevirtual #383                // Method javax/security/auth/x500/X500Principal.getName:(Ljava/lang/String;)Ljava/lang/String;
     167: aload         10
     169: invokespecial #409                // Method parseDN:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     172: astore        9
     174: aload         6
     176: aload_0
     177: aload         5
     179: new           #190                // class java/lang/StringBuilder
     182: dup
     183: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
     186: ldc           #6                  // String *
     188: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     191: aload         9
     193: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     196: ldc           #6                  // String *
     198: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     201: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     204: aload_2
     205: invokespecial #410                // Method search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Ljava/util/Set;
     208: invokeinterface #420,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     213: pop
     214: goto          82
     217: goto          237
     220: aload         6
     222: aload_0
     223: aload         5
     225: ldc           #6                  // String *
     227: aload_2
     228: invokespecial #410                // Method search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Ljava/util/Set;
     231: invokeinterface #420,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     236: pop
     237: aload         6
     239: aload_0
     240: aconst_null
     241: ldc           #6                  // String *
     243: aload_2
     244: invokespecial #410                // Method search:(Ljava/lang/String;Ljava/lang/String;[Ljava/lang/String;)Ljava/util/Set;
     247: invokeinterface #420,  2          // InterfaceMethod java/util/Set.addAll:(Ljava/util/Collection;)Z
     252: pop
     253: aload         6
     255: invokeinterface #421,  1          // InterfaceMethod java/util/Set.iterator:()Ljava/util/Iterator;
     260: astore        7
     262: ldc           #16                 // String X.509
     264: ldc           #12                 // String BC
     266: invokestatic  #363                // Method java/security/cert/CertificateFactory.getInstance:(Ljava/lang/String;Ljava/lang/String;)Ljava/security/cert/CertificateFactory;
     269: astore        8
     271: aload         7
     273: invokeinterface #413,  1          // InterfaceMethod java/util/Iterator.hasNext:()Z
     278: ifeq          330
     281: aload         8
     283: new           #183                // class java/io/ByteArrayInputStream
     286: dup
     287: aload         7
     289: invokeinterface #414,  1          // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     294: checkcast     #182                // class "[B"
     297: checkcast     #182                // class "[B"
     300: invokespecial #340                // Method java/io/ByteArrayInputStream."<init>":([B)V
     303: invokevirtual #361                // Method java/security/cert/CertificateFactory.generateCRL:(Ljava/io/InputStream;)Ljava/security/cert/CRL;
     306: astore        9
     308: aload_3
     309: aload         9
     311: invokevirtual #364                // Method java/security/cert/X509CRLSelector.match:(Ljava/security/cert/CRL;)Z
     314: ifeq          327
     317: aload         4
     319: aload         9
     321: invokeinterface #419,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     326: pop
     327: goto          271
     330: goto          363
     333: astore        8
     335: new           #193                // class java/security/cert/CertStoreException
     338: dup
     339: new           #190                // class java/lang/StringBuilder
     342: dup
     343: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
     346: ldc           #13                 // String CRL cannot be constructed from LDAP result
     348: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     351: aload         8
     353: invokevirtual #355                // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     356: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     359: invokespecial #359                // Method java/security/cert/CertStoreException."<init>":(Ljava/lang/String;)V
     362: athrow
     363: aload         4
     365: areturn
    Exception table:
       from    to  target type
         262   330   333   Class java/lang/Exception

  private java.util.Set search(java.lang.String, java.lang.String, java.lang.String[]) throws java.security.cert.CertStoreException;
    Code:
       0: new           #190                // class java/lang/StringBuilder
       3: dup
       4: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
       7: aload_1
       8: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      11: ldc           #9                  // String =
      13: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      16: aload_2
      17: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      20: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      23: astore        4
      25: aload_1
      26: ifnonnull     32
      29: aconst_null
      30: astore        4
      32: aconst_null
      33: astore        5
      35: new           #201                // class java/util/HashSet
      38: dup
      39: invokespecial #373                // Method java/util/HashSet."<init>":()V
      42: astore        6
      44: aload_0
      45: invokespecial #405                // Method connectLDAP:()Ljavax/naming/directory/DirContext;
      48: astore        5
      50: new           #212                // class javax/naming/directory/SearchControls
      53: dup
      54: invokespecial #377                // Method javax/naming/directory/SearchControls."<init>":()V
      57: astore        7
      59: aload         7
      61: iconst_2
      62: invokevirtual #378                // Method javax/naming/directory/SearchControls.setSearchScope:(I)V
      65: aload         7
      67: lconst_0
      68: invokevirtual #379                // Method javax/naming/directory/SearchControls.setCountLimit:(J)V
      71: iconst_0
      72: istore        8
      74: iload         8
      76: aload_3
      77: arraylength
      78: if_icmpge     283
      81: iconst_1
      82: anewarray     #189                // class java/lang/String
      85: astore        9
      87: aload         9
      89: iconst_0
      90: aload_3
      91: iload         8
      93: aaload
      94: aastore
      95: aload         7
      97: aload         9
      99: invokevirtual #380                // Method javax/naming/directory/SearchControls.setReturningAttributes:([Ljava/lang/String;)V
     102: new           #190                // class java/lang/StringBuilder
     105: dup
     106: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
     109: ldc           #4                  // String (&(
     111: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     114: aload         4
     116: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     119: ldc           #5                  // String )(
     121: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     124: aload         9
     126: iconst_0
     127: aaload
     128: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     131: ldc           #11                 // String =*))
     133: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     136: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     139: astore        10
     141: aload         4
     143: ifnonnull     175
     146: new           #190                // class java/lang/StringBuilder
     149: dup
     150: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
     153: ldc           #3                  // String (
     155: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     158: aload         9
     160: iconst_0
     161: aaload
     162: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     165: ldc           #10                 // String =*)
     167: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     170: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     173: astore        10
     175: aload         5
     177: aload_0
     178: getfield      #339                // Field params:Lorg/bouncycastle/jce/X509LDAPCertStoreParameters;
     181: invokevirtual #390                // Method org/bouncycastle/jce/X509LDAPCertStoreParameters.getBaseDN:()Ljava/lang/String;
     184: aload         10
     186: aload         7
     188: invokeinterface #428,  4          // InterfaceMethod javax/naming/directory/DirContext.search:(Ljava/lang/String;Ljava/lang/String;Ljavax/naming/directory/SearchControls;)Ljavax/naming/NamingEnumeration;
     193: astore        11
     195: aload         11
     197: invokeinterface #423,  1          // InterfaceMethod javax/naming/NamingEnumeration.hasMoreElements:()Z
     202: ifeq          277
     205: aload         11
     207: invokeinterface #424,  1          // InterfaceMethod javax/naming/NamingEnumeration.next:()Ljava/lang/Object;
     212: checkcast     #213                // class javax/naming/directory/SearchResult
     215: astore        12
     217: aload         12
     219: invokevirtual #381                // Method javax/naming/directory/SearchResult.getAttributes:()Ljavax/naming/directory/Attributes;
     222: invokeinterface #426,  1          // InterfaceMethod javax/naming/directory/Attributes.getAll:()Ljavax/naming/NamingEnumeration;
     227: invokeinterface #424,  1          // InterfaceMethod javax/naming/NamingEnumeration.next:()Ljava/lang/Object;
     232: checkcast     #208                // class javax/naming/directory/Attribute
     235: invokeinterface #425,  1          // InterfaceMethod javax/naming/directory/Attribute.getAll:()Ljavax/naming/NamingEnumeration;
     240: astore        13
     242: aload         13
     244: invokeinterface #422,  1          // InterfaceMethod javax/naming/NamingEnumeration.hasMore:()Z
     249: ifeq          274
     252: aload         13
     254: invokeinterface #424,  1          // InterfaceMethod javax/naming/NamingEnumeration.next:()Ljava/lang/Object;
     259: astore        14
     261: aload         6
     263: aload         14
     265: invokeinterface #419,  2          // InterfaceMethod java/util/Set.add:(Ljava/lang/Object;)Z
     270: pop
     271: goto          242
     274: goto          195
     277: iinc          8, 1
     280: goto          74
     283: aconst_null
     284: aload         5
     286: if_acmpeq     296
     289: aload         5
     291: invokeinterface #427,  1          // InterfaceMethod javax/naming/directory/DirContext.close:()V
     296: goto          357
     299: astore        7
     301: goto          357
     304: astore        7
     306: new           #193                // class java/security/cert/CertStoreException
     309: dup
     310: new           #190                // class java/lang/StringBuilder
     313: dup
     314: invokespecial #353                // Method java/lang/StringBuilder."<init>":()V
     317: ldc           #14                 // String Error getting results from LDAP directory
     319: invokevirtual #356                // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     322: aload         7
     324: invokevirtual #355                // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     327: invokevirtual #354                // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     330: invokespecial #359                // Method java/security/cert/CertStoreException."<init>":(Ljava/lang/String;)V
     333: athrow
     334: astore        15
     336: aconst_null
     337: aload         5
     339: if_acmpeq     349
     342: aload         5
     344: invokeinterface #427,  1          // InterfaceMethod javax/naming/directory/DirContext.close:()V
     349: goto          354
     352: astore        16
     354: aload         15
     356: athrow
     357: aload         6
     359: areturn
    Exception table:
       from    to  target type
         283   296   299   Class java/lang/Exception
          44   283   304   Class java/lang/Exception
          44   283   334   any
         336   349   352   Class java/lang/Exception
         304   336   334   any

  static {};
    Code:
       0: ldc           #18                 // String com.sun.jndi.ldap.LdapCtxFactory
       2: putstatic     #337                // Field LDAP_PROVIDER:Ljava/lang/String;
       5: ldc           #21                 // String ignore
       7: putstatic     #338                // Field REFERRALS_IGNORE:Ljava/lang/String;
      10: return
}
