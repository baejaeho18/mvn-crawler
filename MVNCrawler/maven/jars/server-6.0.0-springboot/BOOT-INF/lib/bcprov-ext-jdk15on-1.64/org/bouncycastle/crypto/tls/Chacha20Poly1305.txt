public class org.bouncycastle.crypto.tls.Chacha20Poly1305 implements org.bouncycastle.crypto.tls.TlsCipher {
  private static final byte[] ZEROES;

  protected org.bouncycastle.crypto.tls.TlsContext context;

  protected org.bouncycastle.crypto.engines.ChaCha7539Engine encryptCipher;

  protected org.bouncycastle.crypto.engines.ChaCha7539Engine decryptCipher;

  protected byte[] encryptIV;

  protected byte[] decryptIV;

  public org.bouncycastle.crypto.tls.Chacha20Poly1305(org.bouncycastle.crypto.tls.TlsContext) throws java.io.IOException;
    Code:
       0: aload_0
       1: invokespecial #149                // Method java/lang/Object."<init>":()V
       4: aload_1
       5: invokestatic  #170                // Method org/bouncycastle/crypto/tls/TlsUtils.isTLSv12:(Lorg/bouncycastle/crypto/tls/TlsContext;)Z
       8: ifne          21
      11: new           #86                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
      14: dup
      15: bipush        80
      17: invokespecial #165                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      20: athrow
      21: aload_0
      22: aload_1
      23: putfield      #148                // Field context:Lorg/bouncycastle/crypto/tls/TlsContext;
      26: bipush        32
      28: istore_2
      29: bipush        12
      31: istore_3
      32: iconst_2
      33: iload_2
      34: imul
      35: iconst_2
      36: iload_3
      37: imul
      38: iadd
      39: istore        4
      41: aload_1
      42: iload         4
      44: invokestatic  #171                // Method org/bouncycastle/crypto/tls/TlsUtils.calculateKeyBlock:(Lorg/bouncycastle/crypto/tls/TlsContext;I)[B
      47: astore        5
      49: iconst_0
      50: istore        6
      52: new           #81                 // class org/bouncycastle/crypto/params/KeyParameter
      55: dup
      56: aload         5
      58: iload         6
      60: iload_2
      61: invokespecial #155                // Method org/bouncycastle/crypto/params/KeyParameter."<init>":([BII)V
      64: astore        7
      66: iload         6
      68: iload_2
      69: iadd
      70: istore        6
      72: new           #81                 // class org/bouncycastle/crypto/params/KeyParameter
      75: dup
      76: aload         5
      78: iload         6
      80: iload_2
      81: invokespecial #155                // Method org/bouncycastle/crypto/params/KeyParameter."<init>":([BII)V
      84: astore        8
      86: iload         6
      88: iload_2
      89: iadd
      90: istore        6
      92: aload         5
      94: iload         6
      96: iload         6
      98: iload_3
      99: iadd
     100: invokestatic  #173                // Method org/bouncycastle/util/Arrays.copyOfRange:([BII)[B
     103: astore        9
     105: iload         6
     107: iload_3
     108: iadd
     109: istore        6
     111: aload         5
     113: iload         6
     115: iload         6
     117: iload_3
     118: iadd
     119: invokestatic  #173                // Method org/bouncycastle/util/Arrays.copyOfRange:([BII)[B
     122: astore        10
     124: iload         6
     126: iload_3
     127: iadd
     128: istore        6
     130: iload         6
     132: iload         4
     134: if_icmpeq     147
     137: new           #86                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
     140: dup
     141: bipush        80
     143: invokespecial #165                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     146: athrow
     147: aload_0
     148: new           #79                 // class org/bouncycastle/crypto/engines/ChaCha7539Engine
     151: dup
     152: invokespecial #151                // Method org/bouncycastle/crypto/engines/ChaCha7539Engine."<init>":()V
     155: putfield      #147                // Field encryptCipher:Lorg/bouncycastle/crypto/engines/ChaCha7539Engine;
     158: aload_0
     159: new           #79                 // class org/bouncycastle/crypto/engines/ChaCha7539Engine
     162: dup
     163: invokespecial #151                // Method org/bouncycastle/crypto/engines/ChaCha7539Engine."<init>":()V
     166: putfield      #146                // Field decryptCipher:Lorg/bouncycastle/crypto/engines/ChaCha7539Engine;
     169: aload_1
     170: invokeinterface #182,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.isServer:()Z
     175: ifeq          201
     178: aload         8
     180: astore        11
     182: aload         7
     184: astore        12
     186: aload_0
     187: aload         10
     189: putfield      #145                // Field encryptIV:[B
     192: aload_0
     193: aload         9
     195: putfield      #144                // Field decryptIV:[B
     198: goto          221
     201: aload         7
     203: astore        11
     205: aload         8
     207: astore        12
     209: aload_0
     210: aload         9
     212: putfield      #145                // Field encryptIV:[B
     215: aload_0
     216: aload         10
     218: putfield      #144                // Field decryptIV:[B
     221: aload_0
     222: getfield      #147                // Field encryptCipher:Lorg/bouncycastle/crypto/engines/ChaCha7539Engine;
     225: iconst_1
     226: new           #82                 // class org/bouncycastle/crypto/params/ParametersWithIV
     229: dup
     230: aload         11
     232: aload_0
     233: getfield      #145                // Field encryptIV:[B
     236: invokespecial #156                // Method org/bouncycastle/crypto/params/ParametersWithIV."<init>":(Lorg/bouncycastle/crypto/CipherParameters;[B)V
     239: invokevirtual #153                // Method org/bouncycastle/crypto/engines/ChaCha7539Engine.init:(ZLorg/bouncycastle/crypto/CipherParameters;)V
     242: aload_0
     243: getfield      #146                // Field decryptCipher:Lorg/bouncycastle/crypto/engines/ChaCha7539Engine;
     246: iconst_0
     247: new           #82                 // class org/bouncycastle/crypto/params/ParametersWithIV
     250: dup
     251: aload         12
     253: aload_0
     254: getfield      #144                // Field decryptIV:[B
     257: invokespecial #156                // Method org/bouncycastle/crypto/params/ParametersWithIV."<init>":(Lorg/bouncycastle/crypto/CipherParameters;[B)V
     260: invokevirtual #153                // Method org/bouncycastle/crypto/engines/ChaCha7539Engine.init:(ZLorg/bouncycastle/crypto/CipherParameters;)V
     263: return

  public int getPlaintextLimit(int);
    Code:
       0: iload_1
       1: bipush        16
       3: isub
       4: ireturn

  public byte[] encodePlaintext(long, short, byte[], int, int) throws java.io.IOException;
    Code:
       0: aload_0
       1: aload_0
       2: getfield      #147                // Field encryptCipher:Lorg/bouncycastle/crypto/engines/ChaCha7539Engine;
       5: iconst_1
       6: lload_1
       7: aload_0
       8: getfield      #145                // Field encryptIV:[B
      11: invokevirtual #164                // Method initRecord:(Lorg/bouncycastle/crypto/StreamCipher;ZJ[B)Lorg/bouncycastle/crypto/params/KeyParameter;
      14: astore        7
      16: iload         6
      18: bipush        16
      20: iadd
      21: newarray       byte
      23: astore        8
      25: aload_0
      26: getfield      #147                // Field encryptCipher:Lorg/bouncycastle/crypto/engines/ChaCha7539Engine;
      29: aload         4
      31: iload         5
      33: iload         6
      35: aload         8
      37: iconst_0
      38: invokevirtual #152                // Method org/bouncycastle/crypto/engines/ChaCha7539Engine.processBytes:([BII[BI)I
      41: pop
      42: aload_0
      43: lload_1
      44: iload_3
      45: iload         6
      47: invokevirtual #158                // Method getAdditionalData:(JSI)[B
      50: astore        9
      52: aload_0
      53: aload         7
      55: aload         9
      57: aload         8
      59: iconst_0
      60: iload         6
      62: invokevirtual #162                // Method calculateRecordMAC:(Lorg/bouncycastle/crypto/params/KeyParameter;[B[BII)[B
      65: astore        10
      67: aload         10
      69: iconst_0
      70: aload         8
      72: iload         6
      74: aload         10
      76: arraylength
      77: invokestatic  #150                // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
      80: aload         8
      82: areturn

  public byte[] decodeCiphertext(long, short, byte[], int, int) throws java.io.IOException;
    Code:
       0: aload_0
       1: iload         6
       3: invokevirtual #157                // Method getPlaintextLimit:(I)I
       6: ifge          19
       9: new           #86                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
      12: dup
      13: bipush        50
      15: invokespecial #165                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
      18: athrow
      19: aload_0
      20: aload_0
      21: getfield      #146                // Field decryptCipher:Lorg/bouncycastle/crypto/engines/ChaCha7539Engine;
      24: iconst_0
      25: lload_1
      26: aload_0
      27: getfield      #144                // Field decryptIV:[B
      30: invokevirtual #164                // Method initRecord:(Lorg/bouncycastle/crypto/StreamCipher;ZJ[B)Lorg/bouncycastle/crypto/params/KeyParameter;
      33: astore        7
      35: iload         6
      37: bipush        16
      39: isub
      40: istore        8
      42: aload_0
      43: lload_1
      44: iload_3
      45: iload         8
      47: invokevirtual #158                // Method getAdditionalData:(JSI)[B
      50: astore        9
      52: aload_0
      53: aload         7
      55: aload         9
      57: aload         4
      59: iload         5
      61: iload         8
      63: invokevirtual #162                // Method calculateRecordMAC:(Lorg/bouncycastle/crypto/params/KeyParameter;[B[BII)[B
      66: astore        10
      68: aload         4
      70: iload         5
      72: iload         8
      74: iadd
      75: iload         5
      77: iload         6
      79: iadd
      80: invokestatic  #173                // Method org/bouncycastle/util/Arrays.copyOfRange:([BII)[B
      83: astore        11
      85: aload         10
      87: aload         11
      89: invokestatic  #174                // Method org/bouncycastle/util/Arrays.constantTimeAreEqual:([B[B)Z
      92: ifne          105
      95: new           #86                 // class org/bouncycastle/crypto/tls/TlsFatalAlert
      98: dup
      99: bipush        20
     101: invokespecial #165                // Method org/bouncycastle/crypto/tls/TlsFatalAlert."<init>":(S)V
     104: athrow
     105: iload         8
     107: newarray       byte
     109: astore        12
     111: aload_0
     112: getfield      #146                // Field decryptCipher:Lorg/bouncycastle/crypto/engines/ChaCha7539Engine;
     115: aload         4
     117: iload         5
     119: iload         8
     121: aload         12
     123: iconst_0
     124: invokevirtual #152                // Method org/bouncycastle/crypto/engines/ChaCha7539Engine.processBytes:([BII[BI)I
     127: pop
     128: aload         12
     130: areturn

  protected org.bouncycastle.crypto.params.KeyParameter initRecord(org.bouncycastle.crypto.StreamCipher, boolean, long, byte[]);
    Code:
       0: aload_0
       1: lload_3
       2: aload         5
       4: invokevirtual #159                // Method calculateNonce:(J[B)[B
       7: astore        6
       9: aload_1
      10: iload_2
      11: new           #82                 // class org/bouncycastle/crypto/params/ParametersWithIV
      14: dup
      15: aconst_null
      16: aload         6
      18: invokespecial #156                // Method org/bouncycastle/crypto/params/ParametersWithIV."<init>":(Lorg/bouncycastle/crypto/CipherParameters;[B)V
      21: invokeinterface #181,  3          // InterfaceMethod org/bouncycastle/crypto/StreamCipher.init:(ZLorg/bouncycastle/crypto/CipherParameters;)V
      26: aload_0
      27: aload_1
      28: invokevirtual #163                // Method generateRecordMACKey:(Lorg/bouncycastle/crypto/StreamCipher;)Lorg/bouncycastle/crypto/params/KeyParameter;
      31: areturn

  protected byte[] calculateNonce(long, byte[]);
    Code:
       0: bipush        12
       2: newarray       byte
       4: astore        4
       6: lload_1
       7: aload         4
       9: iconst_4
      10: invokestatic  #167                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint64:(J[BI)V
      13: iconst_0
      14: istore        5
      16: iload         5
      18: bipush        12
      20: if_icmpge     42
      23: aload         4
      25: iload         5
      27: dup2
      28: baload
      29: aload_3
      30: iload         5
      32: baload
      33: ixor
      34: i2b
      35: bastore
      36: iinc          5, 1
      39: goto          16
      42: aload         4
      44: areturn

  protected org.bouncycastle.crypto.params.KeyParameter generateRecordMACKey(org.bouncycastle.crypto.StreamCipher);
    Code:
       0: bipush        64
       2: newarray       byte
       4: astore_2
       5: aload_1
       6: aload_2
       7: iconst_0
       8: aload_2
       9: arraylength
      10: aload_2
      11: iconst_0
      12: invokeinterface #180,  6          // InterfaceMethod org/bouncycastle/crypto/StreamCipher.processBytes:([BII[BI)I
      17: pop
      18: new           #81                 // class org/bouncycastle/crypto/params/KeyParameter
      21: dup
      22: aload_2
      23: iconst_0
      24: bipush        32
      26: invokespecial #155                // Method org/bouncycastle/crypto/params/KeyParameter."<init>":([BII)V
      29: astore_3
      30: aload_2
      31: iconst_0
      32: invokestatic  #172                // Method org/bouncycastle/util/Arrays.fill:([BB)V
      35: aload_3
      36: areturn

  protected byte[] calculateRecordMAC(org.bouncycastle.crypto.params.KeyParameter, byte[], byte[], int, int);
    Code:
       0: new           #80                 // class org/bouncycastle/crypto/macs/Poly1305
       3: dup
       4: invokespecial #154                // Method org/bouncycastle/crypto/macs/Poly1305."<init>":()V
       7: astore        6
       9: aload         6
      11: aload_1
      12: invokeinterface #179,  2          // InterfaceMethod org/bouncycastle/crypto/Mac.init:(Lorg/bouncycastle/crypto/CipherParameters;)V
      17: aload_0
      18: aload         6
      20: aload_2
      21: iconst_0
      22: aload_2
      23: arraylength
      24: invokevirtual #161                // Method updateRecordMACText:(Lorg/bouncycastle/crypto/Mac;[BII)V
      27: aload_0
      28: aload         6
      30: aload_3
      31: iload         4
      33: iload         5
      35: invokevirtual #161                // Method updateRecordMACText:(Lorg/bouncycastle/crypto/Mac;[BII)V
      38: aload_0
      39: aload         6
      41: aload_2
      42: arraylength
      43: invokevirtual #160                // Method updateRecordMACLength:(Lorg/bouncycastle/crypto/Mac;I)V
      46: aload_0
      47: aload         6
      49: iload         5
      51: invokevirtual #160                // Method updateRecordMACLength:(Lorg/bouncycastle/crypto/Mac;I)V
      54: aload         6
      56: invokeinterface #176,  1          // InterfaceMethod org/bouncycastle/crypto/Mac.getMacSize:()I
      61: newarray       byte
      63: astore        7
      65: aload         6
      67: aload         7
      69: iconst_0
      70: invokeinterface #177,  3          // InterfaceMethod org/bouncycastle/crypto/Mac.doFinal:([BI)I
      75: pop
      76: aload         7
      78: areturn

  protected void updateRecordMACLength(org.bouncycastle.crypto.Mac, int);
    Code:
       0: iload_2
       1: i2l
       2: ldc2_w        #72                 // long 4294967295l
       5: land
       6: invokestatic  #175                // Method org/bouncycastle/util/Pack.longToLittleEndian:(J)[B
       9: astore_3
      10: aload_1
      11: aload_3
      12: iconst_0
      13: aload_3
      14: arraylength
      15: invokeinterface #178,  4          // InterfaceMethod org/bouncycastle/crypto/Mac.update:([BII)V
      20: return

  protected void updateRecordMACText(org.bouncycastle.crypto.Mac, byte[], int, int);
    Code:
       0: aload_1
       1: aload_2
       2: iload_3
       3: iload         4
       5: invokeinterface #178,  4          // InterfaceMethod org/bouncycastle/crypto/Mac.update:([BII)V
      10: iload         4
      12: bipush        16
      14: irem
      15: istore        5
      17: iload         5
      19: ifeq          37
      22: aload_1
      23: getstatic     #143                // Field ZEROES:[B
      26: iconst_0
      27: bipush        16
      29: iload         5
      31: isub
      32: invokeinterface #178,  4          // InterfaceMethod org/bouncycastle/crypto/Mac.update:([BII)V
      37: return

  protected byte[] getAdditionalData(long, short, int) throws java.io.IOException;
    Code:
       0: bipush        13
       2: newarray       byte
       4: astore        5
       6: lload_1
       7: aload         5
       9: iconst_0
      10: invokestatic  #167                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint64:(J[BI)V
      13: iload_3
      14: aload         5
      16: bipush        8
      18: invokestatic  #168                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint8:(S[BI)V
      21: aload_0
      22: getfield      #148                // Field context:Lorg/bouncycastle/crypto/tls/TlsContext;
      25: invokeinterface #183,  1          // InterfaceMethod org/bouncycastle/crypto/tls/TlsContext.getServerVersion:()Lorg/bouncycastle/crypto/tls/ProtocolVersion;
      30: aload         5
      32: bipush        9
      34: invokestatic  #169                // Method org/bouncycastle/crypto/tls/TlsUtils.writeVersion:(Lorg/bouncycastle/crypto/tls/ProtocolVersion;[BI)V
      37: iload         4
      39: aload         5
      41: bipush        11
      43: invokestatic  #166                // Method org/bouncycastle/crypto/tls/TlsUtils.writeUint16:(I[BI)V
      46: aload         5
      48: areturn

  static {};
    Code:
       0: bipush        15
       2: newarray       byte
       4: putstatic     #143                // Field ZEROES:[B
       7: return
}
