Compiled from "PasswordPolicyAwareContextSource.java"
public class org.springframework.security.ldap.ppolicy.PasswordPolicyAwareContextSource extends org.springframework.security.ldap.DefaultSpringSecurityContextSource {
  public org.springframework.security.ldap.ppolicy.PasswordPolicyAwareContextSource(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #1                  // Method org/springframework/security/ldap/DefaultSpringSecurityContextSource."<init>":(Ljava/lang/String;)V
       5: return

  public javax.naming.directory.DirContext getContext(java.lang.String, java.lang.String) throws org.springframework.security.ldap.ppolicy.PasswordPolicyException;
    Code:
       0: aload_1
       1: aload_0
       2: getfield      #2                  // Field userDn:Ljava/lang/String;
       5: invokevirtual #3                  // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       8: ifeq          18
      11: aload_0
      12: aload_1
      13: aload_2
      14: invokespecial #4                  // Method org/springframework/security/ldap/DefaultSpringSecurityContextSource.getContext:(Ljava/lang/String;Ljava/lang/String;)Ljavax/naming/directory/DirContext;
      17: areturn
      18: aload_0
      19: getfield      #5                  // Field logger:Lorg/apache/commons/logging/Log;
      22: invokeinterface #6,  1            // InterfaceMethod org/apache/commons/logging/Log.isDebugEnabled:()Z
      27: istore_3
      28: iload_3
      29: ifeq          77
      32: aload_0
      33: getfield      #5                  // Field logger:Lorg/apache/commons/logging/Log;
      36: new           #7                  // class java/lang/StringBuilder
      39: dup
      40: invokespecial #8                  // Method java/lang/StringBuilder."<init>":()V
      43: ldc           #9                  // String Binding as \'
      45: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      48: aload_0
      49: getfield      #2                  // Field userDn:Ljava/lang/String;
      52: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      55: ldc           #11                 // String \', prior to reconnect as user \'
      57: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      60: aload_1
      61: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      64: ldc           #12                 // String \'
      66: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      69: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      72: invokeinterface #14,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
      77: aload_0
      78: aload_0
      79: getfield      #2                  // Field userDn:Ljava/lang/String;
      82: aload_0
      83: getfield      #15                 // Field password:Ljava/lang/String;
      86: invokespecial #4                  // Method org/springframework/security/ldap/DefaultSpringSecurityContextSource.getContext:(Ljava/lang/String;Ljava/lang/String;)Ljavax/naming/directory/DirContext;
      89: checkcast     #16                 // class javax/naming/ldap/LdapContext
      92: astore        4
      94: iconst_1
      95: anewarray     #17                 // class javax/naming/ldap/Control
      98: dup
      99: iconst_0
     100: new           #18                 // class org/springframework/security/ldap/ppolicy/PasswordPolicyControl
     103: dup
     104: iconst_0
     105: invokespecial #19                 // Method org/springframework/security/ldap/ppolicy/PasswordPolicyControl."<init>":(Z)V
     108: aastore
     109: astore        5
     111: aload         4
     113: ldc           #21                 // String java.naming.security.principal
     115: aload_1
     116: invokeinterface #22,  3           // InterfaceMethod javax/naming/ldap/LdapContext.addToEnvironment:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     121: pop
     122: aload         4
     124: ldc           #23                 // String java.naming.security.credentials
     126: aload_2
     127: invokeinterface #22,  3           // InterfaceMethod javax/naming/ldap/LdapContext.addToEnvironment:(Ljava/lang/String;Ljava/lang/Object;)Ljava/lang/Object;
     132: pop
     133: aload         4
     135: aload         5
     137: invokeinterface #24,  2           // InterfaceMethod javax/naming/ldap/LdapContext.reconnect:([Ljavax/naming/ldap/Control;)V
     142: goto          237
     145: astore        6
     147: aload         4
     149: invokestatic  #26                 // Method org/springframework/security/ldap/ppolicy/PasswordPolicyControlExtractor.extractControl:(Ljavax/naming/directory/DirContext;)Lorg/springframework/security/ldap/ppolicy/PasswordPolicyResponseControl;
     152: astore        7
     154: iload_3
     155: ifeq          200
     158: aload_0
     159: getfield      #5                  // Field logger:Lorg/apache/commons/logging/Log;
     162: ldc           #27                 // String Failed to obtain context
     164: aload         6
     166: invokeinterface #28,  3           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;Ljava/lang/Throwable;)V
     171: aload_0
     172: getfield      #5                  // Field logger:Lorg/apache/commons/logging/Log;
     175: new           #7                  // class java/lang/StringBuilder
     178: dup
     179: invokespecial #8                  // Method java/lang/StringBuilder."<init>":()V
     182: ldc           #29                 // String Password policy response:
     184: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     187: aload         7
     189: invokevirtual #30                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     192: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     195: invokeinterface #14,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
     200: aload         4
     202: invokestatic  #31                 // Method org/springframework/ldap/support/LdapUtils.closeContext:(Ljavax/naming/directory/DirContext;)V
     205: aload         7
     207: ifnull        231
     210: aload         7
     212: invokevirtual #32                 // Method org/springframework/security/ldap/ppolicy/PasswordPolicyResponseControl.isLocked:()Z
     215: ifeq          231
     218: new           #33                 // class org/springframework/security/ldap/ppolicy/PasswordPolicyException
     221: dup
     222: aload         7
     224: invokevirtual #34                 // Method org/springframework/security/ldap/ppolicy/PasswordPolicyResponseControl.getErrorStatus:()Lorg/springframework/security/ldap/ppolicy/PasswordPolicyErrorStatus;
     227: invokespecial #35                 // Method org/springframework/security/ldap/ppolicy/PasswordPolicyException."<init>":(Lorg/springframework/security/ldap/ppolicy/PasswordPolicyErrorStatus;)V
     230: athrow
     231: aload         6
     233: invokestatic  #36                 // Method org/springframework/ldap/support/LdapUtils.convertLdapException:(Ljavax/naming/NamingException;)Lorg/springframework/ldap/NamingException;
     236: athrow
     237: iload_3
     238: ifeq          273
     241: aload_0
     242: getfield      #5                  // Field logger:Lorg/apache/commons/logging/Log;
     245: new           #7                  // class java/lang/StringBuilder
     248: dup
     249: invokespecial #8                  // Method java/lang/StringBuilder."<init>":()V
     252: ldc           #37                 // String PPolicy control returned:
     254: invokevirtual #10                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     257: aload         4
     259: invokestatic  #26                 // Method org/springframework/security/ldap/ppolicy/PasswordPolicyControlExtractor.extractControl:(Ljavax/naming/directory/DirContext;)Lorg/springframework/security/ldap/ppolicy/PasswordPolicyResponseControl;
     262: invokevirtual #30                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
     265: invokevirtual #13                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     268: invokeinterface #14,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
     273: aload         4
     275: areturn
    Exception table:
       from    to  target type
         111   142   145   Class javax/naming/NamingException

  protected java.util.Hashtable getAuthenticatedEnv(java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: invokespecial #38                 // Method org/springframework/security/ldap/DefaultSpringSecurityContextSource.getAuthenticatedEnv:(Ljava/lang/String;Ljava/lang/String;)Ljava/util/Hashtable;
       6: astore_3
       7: aload_3
       8: ldc           #39                 // String java.naming.factory.control
      10: ldc           #40                 // class org/springframework/security/ldap/ppolicy/PasswordPolicyControlFactory
      12: invokevirtual #41                 // Method java/lang/Class.getName:()Ljava/lang/String;
      15: invokevirtual #42                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      18: pop
      19: aload_3
      20: areturn
}
