Compiled from "BindAuthenticator.java"
public class org.springframework.security.ldap.authentication.BindAuthenticator extends org.springframework.security.ldap.authentication.AbstractLdapAuthenticator {
  private static final org.apache.commons.logging.Log logger;

  public org.springframework.security.ldap.authentication.BindAuthenticator(org.springframework.ldap.core.support.BaseLdapPathContextSource);
    Code:
       0: aload_0
       1: aload_1
       2: invokespecial #1                  // Method org/springframework/security/ldap/authentication/AbstractLdapAuthenticator."<init>":(Lorg/springframework/ldap/core/ContextSource;)V
       5: return

  public org.springframework.ldap.core.DirContextOperations authenticate(org.springframework.security.core.Authentication);
    Code:
       0: aconst_null
       1: astore_2
       2: ldc           #2                  // class org/springframework/security/authentication/UsernamePasswordAuthenticationToken
       4: aload_1
       5: ldc           #3                  // String Can only process UsernamePasswordAuthenticationToken objects
       7: invokestatic  #4                  // Method org/springframework/util/Assert.isInstanceOf:(Ljava/lang/Class;Ljava/lang/Object;Ljava/lang/String;)V
      10: aload_1
      11: invokeinterface #5,  1            // InterfaceMethod org/springframework/security/core/Authentication.getName:()Ljava/lang/String;
      16: astore_3
      17: aload_1
      18: invokeinterface #6,  1            // InterfaceMethod org/springframework/security/core/Authentication.getCredentials:()Ljava/lang/Object;
      23: checkcast     #7                  // class java/lang/String
      26: astore        4
      28: aload         4
      30: invokestatic  #8                  // Method org/springframework/util/StringUtils.hasLength:(Ljava/lang/String;)Z
      33: ifne          82
      36: getstatic     #9                  // Field logger:Lorg/apache/commons/logging/Log;
      39: new           #10                 // class java/lang/StringBuilder
      42: dup
      43: invokespecial #11                 // Method java/lang/StringBuilder."<init>":()V
      46: ldc           #12                 // String Rejecting empty password for user
      48: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      51: aload_3
      52: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      55: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      58: invokeinterface #15,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
      63: new           #16                 // class org/springframework/security/authentication/BadCredentialsException
      66: dup
      67: aload_0
      68: getfield      #17                 // Field messages:Lorg/springframework/context/support/MessageSourceAccessor;
      71: ldc           #18                 // String BindAuthenticator.emptyPassword
      73: ldc           #19                 // String Empty Password
      75: invokevirtual #20                 // Method org/springframework/context/support/MessageSourceAccessor.getMessage:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      78: invokespecial #21                 // Method org/springframework/security/authentication/BadCredentialsException."<init>":(Ljava/lang/String;)V
      81: athrow
      82: aload_0
      83: aload_3
      84: invokevirtual #22                 // Method getUserDns:(Ljava/lang/String;)Ljava/util/List;
      87: invokeinterface #23,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator;
      92: astore        5
      94: aload         5
      96: invokeinterface #24,  1           // InterfaceMethod java/util/Iterator.hasNext:()Z
     101: ifeq          136
     104: aload         5
     106: invokeinterface #25,  1           // InterfaceMethod java/util/Iterator.next:()Ljava/lang/Object;
     111: checkcast     #7                  // class java/lang/String
     114: astore        6
     116: aload_0
     117: aload         6
     119: aload_3
     120: aload         4
     122: invokespecial #26                 // Method bindWithDn:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/springframework/ldap/core/DirContextOperations;
     125: astore_2
     126: aload_2
     127: ifnull        133
     130: goto          136
     133: goto          94
     136: aload_2
     137: ifnonnull     184
     140: aload_0
     141: invokevirtual #27                 // Method getUserSearch:()Lorg/springframework/security/ldap/search/LdapUserSearch;
     144: ifnull        184
     147: aload_0
     148: invokevirtual #27                 // Method getUserSearch:()Lorg/springframework/security/ldap/search/LdapUserSearch;
     151: aload_3
     152: invokeinterface #28,  2           // InterfaceMethod org/springframework/security/ldap/search/LdapUserSearch.searchForUser:(Ljava/lang/String;)Lorg/springframework/ldap/core/DirContextOperations;
     157: astore        5
     159: aload_0
     160: aload         5
     162: invokeinterface #29,  1           // InterfaceMethod org/springframework/ldap/core/DirContextOperations.getDn:()Ljavax/naming/Name;
     167: invokevirtual #30                 // Method java/lang/Object.toString:()Ljava/lang/String;
     170: aload_3
     171: aload         4
     173: aload         5
     175: invokeinterface #31,  1           // InterfaceMethod org/springframework/ldap/core/DirContextOperations.getAttributes:()Ljavax/naming/directory/Attributes;
     180: invokespecial #32                 // Method bindWithDn:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljavax/naming/directory/Attributes;)Lorg/springframework/ldap/core/DirContextOperations;
     183: astore_2
     184: aload_2
     185: ifnonnull     207
     188: new           #16                 // class org/springframework/security/authentication/BadCredentialsException
     191: dup
     192: aload_0
     193: getfield      #17                 // Field messages:Lorg/springframework/context/support/MessageSourceAccessor;
     196: ldc           #33                 // String BindAuthenticator.badCredentials
     198: ldc           #34                 // String Bad credentials
     200: invokevirtual #20                 // Method org/springframework/context/support/MessageSourceAccessor.getMessage:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     203: invokespecial #21                 // Method org/springframework/security/authentication/BadCredentialsException."<init>":(Ljava/lang/String;)V
     206: athrow
     207: aload_2
     208: areturn

  private org.springframework.ldap.core.DirContextOperations bindWithDn(java.lang.String, java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: aload_2
       3: aload_3
       4: aconst_null
       5: invokespecial #32                 // Method bindWithDn:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljavax/naming/directory/Attributes;)Lorg/springframework/ldap/core/DirContextOperations;
       8: areturn

  private org.springframework.ldap.core.DirContextOperations bindWithDn(java.lang.String, java.lang.String, java.lang.String, javax.naming.directory.Attributes);
    Code:
       0: aload_0
       1: invokevirtual #35                 // Method getContextSource:()Lorg/springframework/ldap/core/ContextSource;
       4: checkcast     #36                 // class org/springframework/ldap/core/support/BaseLdapPathContextSource
       7: astore        5
       9: new           #37                 // class org/springframework/ldap/core/DistinguishedName
      12: dup
      13: aload_1
      14: invokespecial #38                 // Method org/springframework/ldap/core/DistinguishedName."<init>":(Ljava/lang/String;)V
      17: astore        6
      19: new           #37                 // class org/springframework/ldap/core/DistinguishedName
      22: dup
      23: aload         6
      25: invokespecial #39                 // Method org/springframework/ldap/core/DistinguishedName."<init>":(Ljavax/naming/Name;)V
      28: astore        7
      30: aload         7
      32: aload         5
      34: invokeinterface #40,  1           // InterfaceMethod org/springframework/ldap/core/support/BaseLdapPathContextSource.getBaseLdapPath:()Lorg/springframework/ldap/core/DistinguishedName;
      39: invokevirtual #41                 // Method org/springframework/ldap/core/DistinguishedName.prepend:(Lorg/springframework/ldap/core/DistinguishedName;)V
      42: getstatic     #9                  // Field logger:Lorg/apache/commons/logging/Log;
      45: new           #10                 // class java/lang/StringBuilder
      48: dup
      49: invokespecial #11                 // Method java/lang/StringBuilder."<init>":()V
      52: ldc           #42                 // String Attempting to bind as
      54: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      57: aload         7
      59: invokevirtual #43                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      62: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      65: invokeinterface #15,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
      70: aconst_null
      71: astore        8
      73: aload_0
      74: invokevirtual #35                 // Method getContextSource:()Lorg/springframework/ldap/core/ContextSource;
      77: aload         7
      79: invokevirtual #44                 // Method org/springframework/ldap/core/DistinguishedName.toString:()Ljava/lang/String;
      82: aload_3
      83: invokeinterface #45,  3           // InterfaceMethod org/springframework/ldap/core/ContextSource.getContext:(Ljava/lang/String;Ljava/lang/String;)Ljavax/naming/directory/DirContext;
      88: astore        8
      90: aload         8
      92: invokestatic  #46                 // Method org/springframework/security/ldap/ppolicy/PasswordPolicyControlExtractor.extractControl:(Ljavax/naming/directory/DirContext;)Lorg/springframework/security/ldap/ppolicy/PasswordPolicyResponseControl;
      95: astore        9
      97: getstatic     #9                  // Field logger:Lorg/apache/commons/logging/Log;
     100: ldc           #47                 // String Retrieving attributes...
     102: invokeinterface #15,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
     107: aload         4
     109: ifnull        122
     112: aload         4
     114: invokeinterface #48,  1           // InterfaceMethod javax/naming/directory/Attributes.size:()I
     119: ifne          137
     122: aload         8
     124: aload         6
     126: aload_0
     127: invokevirtual #49                 // Method getUserAttributes:()[Ljava/lang/String;
     130: invokeinterface #50,  3           // InterfaceMethod javax/naming/directory/DirContext.getAttributes:(Ljavax/naming/Name;[Ljava/lang/String;)Ljavax/naming/directory/Attributes;
     135: astore        4
     137: new           #51                 // class org/springframework/ldap/core/DirContextAdapter
     140: dup
     141: aload         4
     143: aload         6
     145: aload         5
     147: invokeinterface #40,  1           // InterfaceMethod org/springframework/ldap/core/support/BaseLdapPathContextSource.getBaseLdapPath:()Lorg/springframework/ldap/core/DistinguishedName;
     152: invokespecial #52                 // Method org/springframework/ldap/core/DirContextAdapter."<init>":(Ljavax/naming/directory/Attributes;Ljavax/naming/Name;Ljavax/naming/Name;)V
     155: astore        10
     157: aload         9
     159: ifnull        174
     162: aload         10
     164: aload         9
     166: invokevirtual #53                 // Method org/springframework/security/ldap/ppolicy/PasswordPolicyControl.getID:()Ljava/lang/String;
     169: aload         9
     171: invokevirtual #54                 // Method org/springframework/ldap/core/DirContextAdapter.setAttributeValue:(Ljava/lang/String;Ljava/lang/Object;)V
     174: aload         10
     176: astore        11
     178: aload         8
     180: invokestatic  #55                 // Method org/springframework/ldap/support/LdapUtils.closeContext:(Ljavax/naming/directory/DirContext;)V
     183: aload         11
     185: areturn
     186: astore        9
     188: aload         9
     190: instanceof    #57                 // class org/springframework/ldap/AuthenticationException
     193: ifne          204
     196: aload         9
     198: instanceof    #58                 // class org/springframework/ldap/OperationNotSupportedException
     201: ifeq          215
     204: aload_0
     205: aload_1
     206: aload_2
     207: aload         9
     209: invokevirtual #59                 // Method handleBindException:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
     212: goto          218
     215: aload         9
     217: athrow
     218: aload         8
     220: invokestatic  #55                 // Method org/springframework/ldap/support/LdapUtils.closeContext:(Ljavax/naming/directory/DirContext;)V
     223: goto          244
     226: astore        9
     228: aload         9
     230: invokestatic  #61                 // Method org/springframework/ldap/support/LdapUtils.convertLdapException:(Ljavax/naming/NamingException;)Lorg/springframework/ldap/NamingException;
     233: athrow
     234: astore        12
     236: aload         8
     238: invokestatic  #55                 // Method org/springframework/ldap/support/LdapUtils.closeContext:(Ljavax/naming/directory/DirContext;)V
     241: aload         12
     243: athrow
     244: aconst_null
     245: areturn
    Exception table:
       from    to  target type
          73   178   186   Class org/springframework/ldap/NamingException
          73   178   226   Class javax/naming/NamingException
          73   178   234   any
         186   218   234   any
         226   236   234   any

  protected void handleBindException(java.lang.String, java.lang.String, java.lang.Throwable);
    Code:
       0: getstatic     #9                  // Field logger:Lorg/apache/commons/logging/Log;
       3: invokeinterface #62,  1           // InterfaceMethod org/apache/commons/logging/Log.isDebugEnabled:()Z
       8: ifeq          47
      11: getstatic     #9                  // Field logger:Lorg/apache/commons/logging/Log;
      14: new           #10                 // class java/lang/StringBuilder
      17: dup
      18: invokespecial #11                 // Method java/lang/StringBuilder."<init>":()V
      21: ldc           #63                 // String Failed to bind as
      23: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      26: aload_1
      27: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      30: ldc           #64                 // String :
      32: invokevirtual #13                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      35: aload_3
      36: invokevirtual #43                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      39: invokevirtual #14                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      42: invokeinterface #15,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
      47: return

  static {};
    Code:
       0: ldc           #65                 // class org/springframework/security/ldap/authentication/BindAuthenticator
       2: invokestatic  #66                 // Method org/apache/commons/logging/LogFactory.getLog:(Ljava/lang/Class;)Lorg/apache/commons/logging/Log;
       5: putstatic     #9                  // Field logger:Lorg/apache/commons/logging/Log;
       8: return
}
