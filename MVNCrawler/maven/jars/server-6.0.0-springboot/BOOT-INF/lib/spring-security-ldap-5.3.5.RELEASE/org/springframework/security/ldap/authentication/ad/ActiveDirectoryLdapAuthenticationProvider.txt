Compiled from "ActiveDirectoryLdapAuthenticationProvider.java"
public final class org.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProvider extends org.springframework.security.ldap.authentication.AbstractLdapAuthenticationProvider {
  private static final java.util.regex.Pattern SUB_ERROR_CODE;

  private static final int USERNAME_NOT_FOUND;

  private static final int INVALID_PASSWORD;

  private static final int NOT_PERMITTED;

  private static final int PASSWORD_EXPIRED;

  private static final int ACCOUNT_DISABLED;

  private static final int ACCOUNT_EXPIRED;

  private static final int PASSWORD_NEEDS_RESET;

  private static final int ACCOUNT_LOCKED;

  private final java.lang.String domain;

  private final java.lang.String rootDn;

  private final java.lang.String url;

  private boolean convertSubErrorCodesToExceptions;

  private java.lang.String searchFilter;

  private java.util.Map<java.lang.String, java.lang.Object> contextEnvironmentProperties;

  org.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProvider$ContextFactory contextFactory;

  public org.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProvider(java.lang.String, java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/springframework/security/ldap/authentication/AbstractLdapAuthenticationProvider."<init>":()V
       4: aload_0
       5: ldc           #2                  // String (&(objectClass=user)(userPrincipalName={0}))
       7: putfield      #3                  // Field searchFilter:Ljava/lang/String;
      10: aload_0
      11: new           #4                  // class java/util/HashMap
      14: dup
      15: invokespecial #5                  // Method java/util/HashMap."<init>":()V
      18: putfield      #6                  // Field contextEnvironmentProperties:Ljava/util/Map;
      21: aload_0
      22: new           #7                  // class org/springframework/security/ldap/authentication/ad/ActiveDirectoryLdapAuthenticationProvider$ContextFactory
      25: dup
      26: invokespecial #8                  // Method org/springframework/security/ldap/authentication/ad/ActiveDirectoryLdapAuthenticationProvider$ContextFactory."<init>":()V
      29: putfield      #9                  // Field contextFactory:Lorg/springframework/security/ldap/authentication/ad/ActiveDirectoryLdapAuthenticationProvider$ContextFactory;
      32: aload_2
      33: invokestatic  #10                 // Method org/springframework/util/StringUtils.hasText:(Ljava/lang/String;)Z
      36: ldc           #11                 // String Url cannot be empty
      38: invokestatic  #12                 // Method org/springframework/util/Assert.isTrue:(ZLjava/lang/String;)V
      41: aload_0
      42: aload_1
      43: invokestatic  #10                 // Method org/springframework/util/StringUtils.hasText:(Ljava/lang/String;)Z
      46: ifeq          56
      49: aload_1
      50: invokevirtual #13                 // Method java/lang/String.toLowerCase:()Ljava/lang/String;
      53: goto          57
      56: aconst_null
      57: putfield      #14                 // Field domain:Ljava/lang/String;
      60: aload_0
      61: aload_2
      62: putfield      #15                 // Field url:Ljava/lang/String;
      65: aload_0
      66: aload_3
      67: invokestatic  #10                 // Method org/springframework/util/StringUtils.hasText:(Ljava/lang/String;)Z
      70: ifeq          80
      73: aload_3
      74: invokevirtual #13                 // Method java/lang/String.toLowerCase:()Ljava/lang/String;
      77: goto          81
      80: aconst_null
      81: putfield      #16                 // Field rootDn:Ljava/lang/String;
      84: return

  public org.springframework.security.ldap.authentication.ad.ActiveDirectoryLdapAuthenticationProvider(java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method org/springframework/security/ldap/authentication/AbstractLdapAuthenticationProvider."<init>":()V
       4: aload_0
       5: ldc           #2                  // String (&(objectClass=user)(userPrincipalName={0}))
       7: putfield      #3                  // Field searchFilter:Ljava/lang/String;
      10: aload_0
      11: new           #4                  // class java/util/HashMap
      14: dup
      15: invokespecial #5                  // Method java/util/HashMap."<init>":()V
      18: putfield      #6                  // Field contextEnvironmentProperties:Ljava/util/Map;
      21: aload_0
      22: new           #7                  // class org/springframework/security/ldap/authentication/ad/ActiveDirectoryLdapAuthenticationProvider$ContextFactory
      25: dup
      26: invokespecial #8                  // Method org/springframework/security/ldap/authentication/ad/ActiveDirectoryLdapAuthenticationProvider$ContextFactory."<init>":()V
      29: putfield      #9                  // Field contextFactory:Lorg/springframework/security/ldap/authentication/ad/ActiveDirectoryLdapAuthenticationProvider$ContextFactory;
      32: aload_2
      33: invokestatic  #10                 // Method org/springframework/util/StringUtils.hasText:(Ljava/lang/String;)Z
      36: ldc           #11                 // String Url cannot be empty
      38: invokestatic  #12                 // Method org/springframework/util/Assert.isTrue:(ZLjava/lang/String;)V
      41: aload_0
      42: aload_1
      43: invokestatic  #10                 // Method org/springframework/util/StringUtils.hasText:(Ljava/lang/String;)Z
      46: ifeq          56
      49: aload_1
      50: invokevirtual #13                 // Method java/lang/String.toLowerCase:()Ljava/lang/String;
      53: goto          57
      56: aconst_null
      57: putfield      #14                 // Field domain:Ljava/lang/String;
      60: aload_0
      61: aload_2
      62: putfield      #15                 // Field url:Ljava/lang/String;
      65: aload_0
      66: aload_0
      67: getfield      #14                 // Field domain:Ljava/lang/String;
      70: ifnonnull     77
      73: aconst_null
      74: goto          85
      77: aload_0
      78: aload_0
      79: getfield      #14                 // Field domain:Ljava/lang/String;
      82: invokespecial #17                 // Method rootDnFromDomain:(Ljava/lang/String;)Ljava/lang/String;
      85: putfield      #16                 // Field rootDn:Ljava/lang/String;
      88: return

  protected org.springframework.ldap.core.DirContextOperations doAuthentication(org.springframework.security.authentication.UsernamePasswordAuthenticationToken);
    Code:
       0: aload_1
       1: invokevirtual #18                 // Method org/springframework/security/authentication/UsernamePasswordAuthenticationToken.getName:()Ljava/lang/String;
       4: astore_2
       5: aload_1
       6: invokevirtual #19                 // Method org/springframework/security/authentication/UsernamePasswordAuthenticationToken.getCredentials:()Ljava/lang/Object;
       9: checkcast     #20                 // class java/lang/String
      12: astore_3
      13: aload_0
      14: aload_2
      15: aload_3
      16: invokespecial #21                 // Method bindAsUser:(Ljava/lang/String;Ljava/lang/String;)Ljavax/naming/directory/DirContext;
      19: astore        4
      21: aload_0
      22: aload         4
      24: aload_2
      25: invokespecial #22                 // Method searchForUser:(Ljavax/naming/directory/DirContext;Ljava/lang/String;)Lorg/springframework/ldap/core/DirContextOperations;
      28: astore        5
      30: aload         4
      32: invokestatic  #23                 // Method org/springframework/ldap/support/LdapUtils.closeContext:(Ljavax/naming/directory/DirContext;)V
      35: aload         5
      37: areturn
      38: astore        5
      40: aload_0
      41: getfield      #25                 // Field logger:Lorg/apache/commons/logging/Log;
      44: new           #26                 // class java/lang/StringBuilder
      47: dup
      48: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      51: ldc           #28                 // String Failed to locate directory entry for authenticated user:
      53: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      56: aload_2
      57: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      60: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      63: aload         5
      65: invokeinterface #31,  3           // InterfaceMethod org/apache/commons/logging/Log.error:(Ljava/lang/Object;Ljava/lang/Throwable;)V
      70: aload_0
      71: aload         5
      73: invokespecial #32                 // Method badCredentials:(Ljava/lang/Throwable;)Lorg/springframework/security/authentication/BadCredentialsException;
      76: athrow
      77: astore        6
      79: aload         4
      81: invokestatic  #23                 // Method org/springframework/ldap/support/LdapUtils.closeContext:(Ljavax/naming/directory/DirContext;)V
      84: aload         6
      86: athrow
    Exception table:
       from    to  target type
          21    30    38   Class javax/naming/NamingException
          21    30    77   any
          38    79    77   any

  protected java.util.Collection<? extends org.springframework.security.core.GrantedAuthority> loadUserAuthorities(org.springframework.ldap.core.DirContextOperations, java.lang.String, java.lang.String);
    Code:
       0: aload_1
       1: ldc           #33                 // String memberOf
       3: invokeinterface #34,  2           // InterfaceMethod org/springframework/ldap/core/DirContextOperations.getStringAttributes:(Ljava/lang/String;)[Ljava/lang/String;
       8: astore        4
      10: aload         4
      12: ifnonnull     30
      15: aload_0
      16: getfield      #25                 // Field logger:Lorg/apache/commons/logging/Log;
      19: ldc           #35                 // String No values for \'memberOf\' attribute.
      21: invokeinterface #36,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
      26: getstatic     #37                 // Field org/springframework/security/core/authority/AuthorityUtils.NO_AUTHORITIES:Ljava/util/List;
      29: areturn
      30: aload_0
      31: getfield      #25                 // Field logger:Lorg/apache/commons/logging/Log;
      34: invokeinterface #38,  1           // InterfaceMethod org/apache/commons/logging/Log.isDebugEnabled:()Z
      39: ifeq          74
      42: aload_0
      43: getfield      #25                 // Field logger:Lorg/apache/commons/logging/Log;
      46: new           #26                 // class java/lang/StringBuilder
      49: dup
      50: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      53: ldc           #39                 // String \'memberOf\' attribute values:
      55: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      58: aload         4
      60: invokestatic  #40                 // Method java/util/Arrays.asList:([Ljava/lang/Object;)Ljava/util/List;
      63: invokevirtual #41                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      66: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      69: invokeinterface #36,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
      74: new           #42                 // class java/util/ArrayList
      77: dup
      78: aload         4
      80: arraylength
      81: invokespecial #43                 // Method java/util/ArrayList."<init>":(I)V
      84: astore        5
      86: aload         4
      88: astore        6
      90: aload         6
      92: arraylength
      93: istore        7
      95: iconst_0
      96: istore        8
      98: iload         8
     100: iload         7
     102: if_icmpge     146
     105: aload         6
     107: iload         8
     109: aaload
     110: astore        9
     112: aload         5
     114: new           #44                 // class org/springframework/security/core/authority/SimpleGrantedAuthority
     117: dup
     118: new           #45                 // class org/springframework/ldap/core/DistinguishedName
     121: dup
     122: aload         9
     124: invokespecial #46                 // Method org/springframework/ldap/core/DistinguishedName."<init>":(Ljava/lang/String;)V
     127: invokevirtual #47                 // Method org/springframework/ldap/core/DistinguishedName.removeLast:()Lorg/springframework/ldap/core/LdapRdn;
     130: invokevirtual #48                 // Method org/springframework/ldap/core/LdapRdn.getValue:()Ljava/lang/String;
     133: invokespecial #49                 // Method org/springframework/security/core/authority/SimpleGrantedAuthority."<init>":(Ljava/lang/String;)V
     136: invokevirtual #50                 // Method java/util/ArrayList.add:(Ljava/lang/Object;)Z
     139: pop
     140: iinc          8, 1
     143: goto          98
     146: aload         5
     148: areturn

  private javax.naming.directory.DirContext bindAsUser(java.lang.String, java.lang.String);
    Code:
       0: aload_0
       1: getfield      #15                 // Field url:Ljava/lang/String;
       4: astore_3
       5: new           #51                 // class java/util/Hashtable
       8: dup
       9: invokespecial #52                 // Method java/util/Hashtable."<init>":()V
      12: astore        4
      14: aload         4
      16: ldc           #54                 // String java.naming.security.authentication
      18: ldc           #55                 // String simple
      20: invokevirtual #56                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      23: pop
      24: aload_0
      25: aload_1
      26: invokevirtual #57                 // Method createBindPrincipal:(Ljava/lang/String;)Ljava/lang/String;
      29: astore        5
      31: aload         4
      33: ldc           #58                 // String java.naming.security.principal
      35: aload         5
      37: invokevirtual #56                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      40: pop
      41: aload         4
      43: ldc           #59                 // String java.naming.provider.url
      45: aload_3
      46: invokevirtual #56                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      49: pop
      50: aload         4
      52: ldc           #60                 // String java.naming.security.credentials
      54: aload_2
      55: invokevirtual #56                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      58: pop
      59: aload         4
      61: ldc           #61                 // String java.naming.factory.initial
      63: ldc           #62                 // String com.sun.jndi.ldap.LdapCtxFactory
      65: invokevirtual #56                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      68: pop
      69: aload         4
      71: ldc           #63                 // String java.naming.factory.object
      73: ldc           #64                 // class org/springframework/ldap/core/support/DefaultDirObjectFactory
      75: invokevirtual #65                 // Method java/lang/Class.getName:()Ljava/lang/String;
      78: invokevirtual #56                 // Method java/util/Hashtable.put:(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
      81: pop
      82: aload         4
      84: aload_0
      85: getfield      #6                  // Field contextEnvironmentProperties:Ljava/util/Map;
      88: invokevirtual #66                 // Method java/util/Hashtable.putAll:(Ljava/util/Map;)V
      91: aload_0
      92: getfield      #9                  // Field contextFactory:Lorg/springframework/security/ldap/authentication/ad/ActiveDirectoryLdapAuthenticationProvider$ContextFactory;
      95: aload         4
      97: invokevirtual #67                 // Method org/springframework/security/ldap/authentication/ad/ActiveDirectoryLdapAuthenticationProvider$ContextFactory.createContext:(Ljava/util/Hashtable;)Ljavax/naming/directory/DirContext;
     100: areturn
     101: astore        6
     103: aload         6
     105: instanceof    #68                 // class javax/naming/AuthenticationException
     108: ifne          119
     111: aload         6
     113: instanceof    #69                 // class javax/naming/OperationNotSupportedException
     116: ifeq          134
     119: aload_0
     120: aload         5
     122: aload         6
     124: invokespecial #70                 // Method handleBindException:(Ljava/lang/String;Ljavax/naming/NamingException;)V
     127: aload_0
     128: aload         6
     130: invokespecial #32                 // Method badCredentials:(Ljava/lang/Throwable;)Lorg/springframework/security/authentication/BadCredentialsException;
     133: athrow
     134: aload         6
     136: invokestatic  #71                 // Method org/springframework/ldap/support/LdapUtils.convertLdapException:(Ljavax/naming/NamingException;)Lorg/springframework/ldap/NamingException;
     139: athrow
    Exception table:
       from    to  target type
          91   100   101   Class javax/naming/NamingException

  private void handleBindException(java.lang.String, javax.naming.NamingException);
    Code:
       0: aload_0
       1: getfield      #25                 // Field logger:Lorg/apache/commons/logging/Log;
       4: invokeinterface #38,  1           // InterfaceMethod org/apache/commons/logging/Log.isDebugEnabled:()Z
       9: ifeq          49
      12: aload_0
      13: getfield      #25                 // Field logger:Lorg/apache/commons/logging/Log;
      16: new           #26                 // class java/lang/StringBuilder
      19: dup
      20: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      23: ldc           #72                 // String Authentication for
      25: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      28: aload_1
      29: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      32: ldc           #73                 // String  failed:
      34: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      37: aload_2
      38: invokevirtual #41                 // Method java/lang/StringBuilder.append:(Ljava/lang/Object;)Ljava/lang/StringBuilder;
      41: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      44: invokeinterface #36,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
      49: aload_0
      50: aload_2
      51: invokespecial #74                 // Method handleResolveObj:(Ljavax/naming/NamingException;)V
      54: aload_0
      55: aload_2
      56: invokevirtual #75                 // Method javax/naming/NamingException.getMessage:()Ljava/lang/String;
      59: invokespecial #76                 // Method parseSubErrorCode:(Ljava/lang/String;)I
      62: istore_3
      63: iload_3
      64: ifgt          79
      67: aload_0
      68: getfield      #25                 // Field logger:Lorg/apache/commons/logging/Log;
      71: ldc           #77                 // String Failed to locate AD-specific sub-error code in message
      73: invokeinterface #36,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
      78: return
      79: aload_0
      80: getfield      #25                 // Field logger:Lorg/apache/commons/logging/Log;
      83: new           #26                 // class java/lang/StringBuilder
      86: dup
      87: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      90: ldc           #78                 // String Active Directory authentication failed:
      92: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      95: aload_0
      96: iload_3
      97: invokespecial #79                 // Method subCodeToLogMessage:(I)Ljava/lang/String;
     100: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     103: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     106: invokeinterface #80,  2           // InterfaceMethod org/apache/commons/logging/Log.info:(Ljava/lang/Object;)V
     111: aload_0
     112: getfield      #81                 // Field convertSubErrorCodesToExceptions:Z
     115: ifeq          124
     118: aload_0
     119: iload_3
     120: aload_2
     121: invokespecial #82                 // Method raiseExceptionForErrorCode:(ILjavax/naming/NamingException;)V
     124: return

  private void handleResolveObj(javax.naming.NamingException);
    Code:
       0: aload_1
       1: invokevirtual #83                 // Method javax/naming/NamingException.getResolvedObj:()Ljava/lang/Object;
       4: astore_2
       5: aload_2
       6: instanceof    #84                 // class java/io/Serializable
       9: istore_3
      10: aload_2
      11: ifnull        23
      14: iload_3
      15: ifne          23
      18: aload_1
      19: aconst_null
      20: invokevirtual #85                 // Method javax/naming/NamingException.setResolvedObj:(Ljava/lang/Object;)V
      23: return

  private int parseSubErrorCode(java.lang.String);
    Code:
       0: getstatic     #86                 // Field SUB_ERROR_CODE:Ljava/util/regex/Pattern;
       3: aload_1
       4: invokevirtual #87                 // Method java/util/regex/Pattern.matcher:(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;
       7: astore_2
       8: aload_2
       9: invokevirtual #88                 // Method java/util/regex/Matcher.matches:()Z
      12: ifeq          26
      15: aload_2
      16: iconst_1
      17: invokevirtual #89                 // Method java/util/regex/Matcher.group:(I)Ljava/lang/String;
      20: bipush        16
      22: invokestatic  #90                 // Method java/lang/Integer.parseInt:(Ljava/lang/String;I)I
      25: ireturn
      26: iconst_m1
      27: ireturn

  private void raiseExceptionForErrorCode(int, javax.naming.NamingException);
    Code:
       0: iload_1
       1: invokestatic  #91                 // Method java/lang/Integer.toHexString:(I)Ljava/lang/String;
       4: astore_3
       5: new           #92                 // class org/springframework/security/ldap/authentication/ad/ActiveDirectoryAuthenticationException
       8: dup
       9: aload_3
      10: aload_2
      11: invokevirtual #75                 // Method javax/naming/NamingException.getMessage:()Ljava/lang/String;
      14: aload_2
      15: invokespecial #93                 // Method org/springframework/security/ldap/authentication/ad/ActiveDirectoryAuthenticationException."<init>":(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)V
      18: astore        4
      20: iload_1
      21: lookupswitch  { // 4
                  1330: 64
                  1331: 85
                  1793: 106
                  1909: 127
               default: 148
          }
      64: new           #94                 // class org/springframework/security/authentication/CredentialsExpiredException
      67: dup
      68: aload_0
      69: getfield      #95                 // Field messages:Lorg/springframework/context/support/MessageSourceAccessor;
      72: ldc           #96                 // String LdapAuthenticationProvider.credentialsExpired
      74: ldc           #97                 // String User credentials have expired
      76: invokevirtual #98                 // Method org/springframework/context/support/MessageSourceAccessor.getMessage:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      79: aload         4
      81: invokespecial #99                 // Method org/springframework/security/authentication/CredentialsExpiredException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
      84: athrow
      85: new           #100                // class org/springframework/security/authentication/DisabledException
      88: dup
      89: aload_0
      90: getfield      #95                 // Field messages:Lorg/springframework/context/support/MessageSourceAccessor;
      93: ldc           #101                // String LdapAuthenticationProvider.disabled
      95: ldc           #102                // String User is disabled
      97: invokevirtual #98                 // Method org/springframework/context/support/MessageSourceAccessor.getMessage:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     100: aload         4
     102: invokespecial #103                // Method org/springframework/security/authentication/DisabledException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     105: athrow
     106: new           #104                // class org/springframework/security/authentication/AccountExpiredException
     109: dup
     110: aload_0
     111: getfield      #95                 // Field messages:Lorg/springframework/context/support/MessageSourceAccessor;
     114: ldc           #105                // String LdapAuthenticationProvider.expired
     116: ldc           #106                // String User account has expired
     118: invokevirtual #98                 // Method org/springframework/context/support/MessageSourceAccessor.getMessage:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     121: aload         4
     123: invokespecial #107                // Method org/springframework/security/authentication/AccountExpiredException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     126: athrow
     127: new           #108                // class org/springframework/security/authentication/LockedException
     130: dup
     131: aload_0
     132: getfield      #95                 // Field messages:Lorg/springframework/context/support/MessageSourceAccessor;
     135: ldc           #109                // String LdapAuthenticationProvider.locked
     137: ldc           #110                // String User account is locked
     139: invokevirtual #98                 // Method org/springframework/context/support/MessageSourceAccessor.getMessage:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
     142: aload         4
     144: invokespecial #111                // Method org/springframework/security/authentication/LockedException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     147: athrow
     148: aload_0
     149: aload         4
     151: invokespecial #32                 // Method badCredentials:(Ljava/lang/Throwable;)Lorg/springframework/security/authentication/BadCredentialsException;
     154: athrow

  private java.lang.String subCodeToLogMessage(int);
    Code:
       0: iload_1
       1: lookupswitch  { // 8
                  1317: 76
                  1326: 79
                  1328: 82
                  1330: 85
                  1331: 88
                  1793: 91
                  1907: 94
                  1909: 97
               default: 100
          }
      76: ldc           #112                // String User was not found in directory
      78: areturn
      79: ldc           #113                // String Supplied password was invalid
      81: areturn
      82: ldc           #114                // String User not permitted to logon at this time
      84: areturn
      85: ldc           #115                // String Password has expired
      87: areturn
      88: ldc           #116                // String Account is disabled
      90: areturn
      91: ldc           #117                // String Account expired
      93: areturn
      94: ldc           #118                // String User must reset password
      96: areturn
      97: ldc           #119                // String Account locked
      99: areturn
     100: new           #26                 // class java/lang/StringBuilder
     103: dup
     104: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
     107: ldc           #120                // String Unknown (error code
     109: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     112: iload_1
     113: invokestatic  #91                 // Method java/lang/Integer.toHexString:(I)Ljava/lang/String;
     116: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     119: ldc           #121                // String )
     121: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     124: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     127: areturn

  private org.springframework.security.authentication.BadCredentialsException badCredentials();
    Code:
       0: new           #122                // class org/springframework/security/authentication/BadCredentialsException
       3: dup
       4: aload_0
       5: getfield      #95                 // Field messages:Lorg/springframework/context/support/MessageSourceAccessor;
       8: ldc           #123                // String LdapAuthenticationProvider.badCredentials
      10: ldc           #124                // String Bad credentials
      12: invokevirtual #98                 // Method org/springframework/context/support/MessageSourceAccessor.getMessage:(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
      15: invokespecial #125                // Method org/springframework/security/authentication/BadCredentialsException."<init>":(Ljava/lang/String;)V
      18: areturn

  private org.springframework.security.authentication.BadCredentialsException badCredentials(java.lang.Throwable);
    Code:
       0: aload_0
       1: invokespecial #126                // Method badCredentials:()Lorg/springframework/security/authentication/BadCredentialsException;
       4: aload_1
       5: invokevirtual #127                // Method org/springframework/security/authentication/BadCredentialsException.initCause:(Ljava/lang/Throwable;)Ljava/lang/Throwable;
       8: checkcast     #122                // class org/springframework/security/authentication/BadCredentialsException
      11: areturn

  private org.springframework.ldap.core.DirContextOperations searchForUser(javax.naming.directory.DirContext, java.lang.String) throws javax.naming.NamingException;
    Code:
       0: new           #128                // class javax/naming/directory/SearchControls
       3: dup
       4: invokespecial #129                // Method javax/naming/directory/SearchControls."<init>":()V
       7: astore_3
       8: aload_3
       9: iconst_2
      10: invokevirtual #130                // Method javax/naming/directory/SearchControls.setSearchScope:(I)V
      13: aload_0
      14: aload_2
      15: invokevirtual #57                 // Method createBindPrincipal:(Ljava/lang/String;)Ljava/lang/String;
      18: astore        4
      20: aload_0
      21: getfield      #16                 // Field rootDn:Ljava/lang/String;
      24: ifnull        34
      27: aload_0
      28: getfield      #16                 // Field rootDn:Ljava/lang/String;
      31: goto          40
      34: aload_0
      35: aload         4
      37: invokespecial #131                // Method searchRootFromPrincipal:(Ljava/lang/String;)Ljava/lang/String;
      40: astore        5
      42: aload_1
      43: aload_3
      44: aload         5
      46: aload_0
      47: getfield      #3                  // Field searchFilter:Ljava/lang/String;
      50: iconst_2
      51: anewarray     #132                // class java/lang/Object
      54: dup
      55: iconst_0
      56: aload         4
      58: aastore
      59: dup
      60: iconst_1
      61: aload_2
      62: aastore
      63: invokestatic  #133                // Method org/springframework/security/ldap/SpringSecurityLdapTemplate.searchForSingleEntryInternal:(Ljavax/naming/directory/DirContext;Ljavax/naming/directory/SearchControls;Ljava/lang/String;Ljava/lang/String;[Ljava/lang/Object;)Lorg/springframework/ldap/core/DirContextOperations;
      66: areturn
      67: astore        6
      69: aload         6
      71: invokevirtual #135                // Method org/springframework/dao/IncorrectResultSizeDataAccessException.getActualSize:()I
      74: ifeq          80
      77: aload         6
      79: athrow
      80: new           #136                // class org/springframework/security/core/userdetails/UsernameNotFoundException
      83: dup
      84: new           #26                 // class java/lang/StringBuilder
      87: dup
      88: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      91: ldc           #137                // String User
      93: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      96: aload_2
      97: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     100: ldc           #138                // String  not found in directory.
     102: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     105: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     108: aload         6
     110: invokespecial #139                // Method org/springframework/security/core/userdetails/UsernameNotFoundException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     113: astore        7
     115: aload_0
     116: aload         7
     118: invokespecial #32                 // Method badCredentials:(Ljava/lang/Throwable;)Lorg/springframework/security/authentication/BadCredentialsException;
     121: athrow
    Exception table:
       from    to  target type
          42    66    67   Class org/springframework/dao/IncorrectResultSizeDataAccessException

  private java.lang.String searchRootFromPrincipal(java.lang.String);
    Code:
       0: aload_1
       1: bipush        64
       3: invokevirtual #140                // Method java/lang/String.lastIndexOf:(I)I
       6: istore_2
       7: iload_2
       8: ifge          49
      11: aload_0
      12: getfield      #25                 // Field logger:Lorg/apache/commons/logging/Log;
      15: new           #26                 // class java/lang/StringBuilder
      18: dup
      19: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      22: ldc           #141                // String User principal \'
      24: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      27: aload_1
      28: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      31: ldc           #142                // String \' does not contain the domain, and no domain has been configured
      33: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      36: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      39: invokeinterface #36,  2           // InterfaceMethod org/apache/commons/logging/Log.debug:(Ljava/lang/Object;)V
      44: aload_0
      45: invokespecial #126                // Method badCredentials:()Lorg/springframework/security/authentication/BadCredentialsException;
      48: athrow
      49: aload_0
      50: aload_1
      51: iload_2
      52: iconst_1
      53: iadd
      54: aload_1
      55: invokevirtual #143                // Method java/lang/String.length:()I
      58: invokevirtual #144                // Method java/lang/String.substring:(II)Ljava/lang/String;
      61: invokespecial #17                 // Method rootDnFromDomain:(Ljava/lang/String;)Ljava/lang/String;
      64: areturn

  private java.lang.String rootDnFromDomain(java.lang.String);
    Code:
       0: aload_1
       1: ldc           #145                // String .
       3: invokestatic  #146                // Method org/springframework/util/StringUtils.tokenizeToStringArray:(Ljava/lang/String;Ljava/lang/String;)[Ljava/lang/String;
       6: astore_2
       7: new           #26                 // class java/lang/StringBuilder
      10: dup
      11: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      14: astore_3
      15: aload_2
      16: astore        4
      18: aload         4
      20: arraylength
      21: istore        5
      23: iconst_0
      24: istore        6
      26: iload         6
      28: iload         5
      30: if_icmpge     72
      33: aload         4
      35: iload         6
      37: aaload
      38: astore        7
      40: aload_3
      41: invokevirtual #147                // Method java/lang/StringBuilder.length:()I
      44: ifle          54
      47: aload_3
      48: bipush        44
      50: invokevirtual #148                // Method java/lang/StringBuilder.append:(C)Ljava/lang/StringBuilder;
      53: pop
      54: aload_3
      55: ldc           #149                // String dc=
      57: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      60: aload         7
      62: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      65: pop
      66: iinc          6, 1
      69: goto          26
      72: aload_3
      73: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      76: areturn

  java.lang.String createBindPrincipal(java.lang.String);
    Code:
       0: aload_0
       1: getfield      #14                 // Field domain:Ljava/lang/String;
       4: ifnull        21
       7: aload_1
       8: invokevirtual #13                 // Method java/lang/String.toLowerCase:()Ljava/lang/String;
      11: aload_0
      12: getfield      #14                 // Field domain:Ljava/lang/String;
      15: invokevirtual #150                // Method java/lang/String.endsWith:(Ljava/lang/String;)Z
      18: ifeq          23
      21: aload_1
      22: areturn
      23: new           #26                 // class java/lang/StringBuilder
      26: dup
      27: invokespecial #27                 // Method java/lang/StringBuilder."<init>":()V
      30: aload_1
      31: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      34: ldc           #151                // String @
      36: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      39: aload_0
      40: getfield      #14                 // Field domain:Ljava/lang/String;
      43: invokevirtual #29                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      46: invokevirtual #30                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      49: areturn

  public void setConvertSubErrorCodesToExceptions(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #81                 // Field convertSubErrorCodesToExceptions:Z
       5: return

  public void setSearchFilter(java.lang.String);
    Code:
       0: aload_1
       1: ldc           #152                // String searchFilter must have text
       3: invokestatic  #153                // Method org/springframework/util/Assert.hasText:(Ljava/lang/String;Ljava/lang/String;)V
       6: aload_0
       7: aload_1
       8: putfield      #3                  // Field searchFilter:Ljava/lang/String;
      11: return

  public void setContextEnvironmentProperties(java.util.Map<java.lang.String, java.lang.Object>);
    Code:
       0: aload_1
       1: ldc           #154                // String environment must not be empty
       3: invokestatic  #155                // Method org/springframework/util/Assert.notEmpty:(Ljava/util/Map;Ljava/lang/String;)V
       6: aload_0
       7: new           #51                 // class java/util/Hashtable
      10: dup
      11: aload_1
      12: invokespecial #156                // Method java/util/Hashtable."<init>":(Ljava/util/Map;)V
      15: putfield      #6                  // Field contextEnvironmentProperties:Ljava/util/Map;
      18: return

  static {};
    Code:
       0: ldc           #157                // String .*data\\s([0-9a-f]{3,4}).*
       2: invokestatic  #158                // Method java/util/regex/Pattern.compile:(Ljava/lang/String;)Ljava/util/regex/Pattern;
       5: putstatic     #86                 // Field SUB_ERROR_CODE:Ljava/util/regex/Pattern;
       8: return
}
