Compiled from "SASLServerHandler.java"
public class com.sun.jmx.remote.opt.security.SASLServerHandler implements com.sun.jmx.remote.generic.ProfileServer {
  private javax.security.sasl.SaslServer saslServer;

  private byte[] blob;

  private java.util.Map env;

  private javax.management.remote.generic.MessageConnection mc;

  private java.net.Socket socket;

  private java.lang.String mechanism;

  private java.lang.String profile;

  private javax.security.auth.Subject subject;

  private static final com.sun.jmx.remote.opt.util.ClassLogger logger;

  public com.sun.jmx.remote.opt.security.SASLServerHandler(java.lang.String, java.util.Map);
    Code:
       0: aload_0
       1: invokespecial #2                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
       9: aload_0
      10: aconst_null
      11: putfield      #4                  // Field blob:[B
      14: aload_0
      15: aconst_null
      16: putfield      #5                  // Field env:Ljava/util/Map;
      19: aload_0
      20: aconst_null
      21: putfield      #6                  // Field mc:Ljavax/management/remote/generic/MessageConnection;
      24: aload_0
      25: aconst_null
      26: putfield      #7                  // Field socket:Ljava/net/Socket;
      29: aload_0
      30: aconst_null
      31: putfield      #8                  // Field mechanism:Ljava/lang/String;
      34: aload_0
      35: aconst_null
      36: putfield      #9                  // Field profile:Ljava/lang/String;
      39: aload_0
      40: aconst_null
      41: putfield      #1                  // Field subject:Ljavax/security/auth/Subject;
      44: aload_0
      45: aload_1
      46: putfield      #9                  // Field profile:Ljava/lang/String;
      49: aload_0
      50: aload_2
      51: putfield      #5                  // Field env:Ljava/util/Map;
      54: return

  public void initialize(javax.management.remote.generic.MessageConnection, javax.security.auth.Subject) throws java.io.IOException;
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #6                  // Field mc:Ljavax/management/remote/generic/MessageConnection;
       5: aload_0
       6: aload_2
       7: putfield      #1                  // Field subject:Ljavax/security/auth/Subject;
      10: aload_1
      11: instanceof    #10                 // class com/sun/jmx/remote/socket/SocketConnectionIf
      14: ifeq          33
      17: aload_0
      18: aload_1
      19: checkcast     #10                 // class com/sun/jmx/remote/socket/SocketConnectionIf
      22: invokeinterface #11,  1           // InterfaceMethod com/sun/jmx/remote/socket/SocketConnectionIf.getSocket:()Ljava/net/Socket;
      27: putfield      #7                  // Field socket:Ljava/net/Socket;
      30: goto          43
      33: new           #12                 // class java/io/IOException
      36: dup
      37: ldc           #13                 // String Not an instance of SocketConnectionIf
      39: invokespecial #14                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      42: athrow
      43: aload_0
      44: aload_0
      45: getfield      #9                  // Field profile:Ljava/lang/String;
      48: aload_0
      49: getfield      #9                  // Field profile:Ljava/lang/String;
      52: ldc           #15                 // String SASL/
      54: invokevirtual #16                 // Method java/lang/String.indexOf:(Ljava/lang/String;)I
      57: iconst_5
      58: iadd
      59: invokevirtual #17                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      62: putfield      #8                  // Field mechanism:Ljava/lang/String;
      65: aload_0
      66: getfield      #5                  // Field env:Ljava/util/Map;
      69: ldc           #18                 // String jmx.remote.x.sasl.server.name
      71: invokeinterface #19,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
      76: checkcast     #20                 // class java/lang/String
      79: astore_3
      80: aload_3
      81: ifnonnull     95
      84: aload_0
      85: getfield      #7                  // Field socket:Ljava/net/Socket;
      88: invokevirtual #21                 // Method java/net/Socket.getLocalAddress:()Ljava/net/InetAddress;
      91: invokevirtual #22                 // Method java/net/InetAddress.getHostName:()Ljava/lang/String;
      94: astore_3
      95: aload_0
      96: getfield      #5                  // Field env:Ljava/util/Map;
      99: ldc           #23                 // String jmx.remote.sasl.callback.handler
     101: invokeinterface #19,  2           // InterfaceMethod java/util/Map.get:(Ljava/lang/Object;)Ljava/lang/Object;
     106: checkcast     #24                 // class javax/security/auth/callback/CallbackHandler
     109: astore        4
     111: aload_0
     112: aload_0
     113: getfield      #8                  // Field mechanism:Ljava/lang/String;
     116: ldc           #25                 // String jmxmp
     118: aload_3
     119: aload_0
     120: getfield      #5                  // Field env:Ljava/util/Map;
     123: aload         4
     125: invokestatic  #26                 // Method javax/security/sasl/Sasl.createSaslServer:(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/util/Map;Ljavax/security/auth/callback/CallbackHandler;)Ljavax/security/sasl/SaslServer;
     128: putfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
     131: aload_0
     132: getfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
     135: ifnonnull     177
     138: new           #27                 // class java/lang/StringBuffer
     141: dup
     142: invokespecial #28                 // Method java/lang/StringBuffer."<init>":()V
     145: ldc           #29                 // String Unable to create SASL server connection for authentication mechanism [
     147: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     150: aload_0
     151: getfield      #8                  // Field mechanism:Ljava/lang/String;
     154: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     157: ldc           #31                 // String ]
     159: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     162: invokevirtual #32                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
     165: astore        5
     167: new           #12                 // class java/io/IOException
     170: dup
     171: aload         5
     173: invokespecial #14                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     176: athrow
     177: return

  public javax.management.remote.message.ProfileMessage produceMessage() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
       4: invokeinterface #33,  1           // InterfaceMethod javax/security/sasl/SaslServer.isComplete:()Z
       9: ifeq          17
      12: iconst_2
      13: istore_1
      14: goto          19
      17: iconst_1
      18: istore_1
      19: new           #34                 // class javax/management/remote/message/SASLMessage
      22: dup
      23: aload_0
      24: getfield      #8                  // Field mechanism:Ljava/lang/String;
      27: iload_1
      28: aload_0
      29: getfield      #4                  // Field blob:[B
      32: invokespecial #35                 // Method javax/management/remote/message/SASLMessage."<init>":(Ljava/lang/String;I[B)V
      35: astore_2
      36: getstatic     #36                 // Field logger:Lcom/sun/jmx/remote/opt/util/ClassLogger;
      39: invokevirtual #37                 // Method com/sun/jmx/remote/opt/util/ClassLogger.traceOn:()Z
      42: ifeq          115
      45: getstatic     #36                 // Field logger:Lcom/sun/jmx/remote/opt/util/ClassLogger;
      48: ldc           #38                 // String produceMessage
      50: ldc           #39                 // String >>>>> SASL server message <<<<<
      52: invokevirtual #40                 // Method com/sun/jmx/remote/opt/util/ClassLogger.trace:(Ljava/lang/String;Ljava/lang/String;)V
      55: getstatic     #36                 // Field logger:Lcom/sun/jmx/remote/opt/util/ClassLogger;
      58: ldc           #38                 // String produceMessage
      60: new           #27                 // class java/lang/StringBuffer
      63: dup
      64: invokespecial #28                 // Method java/lang/StringBuffer."<init>":()V
      67: ldc           #41                 // String Profile Name :
      69: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      72: aload_2
      73: invokevirtual #42                 // Method javax/management/remote/message/SASLMessage.getProfileName:()Ljava/lang/String;
      76: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      79: invokevirtual #32                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
      82: invokevirtual #40                 // Method com/sun/jmx/remote/opt/util/ClassLogger.trace:(Ljava/lang/String;Ljava/lang/String;)V
      85: getstatic     #36                 // Field logger:Lcom/sun/jmx/remote/opt/util/ClassLogger;
      88: ldc           #38                 // String produceMessage
      90: new           #27                 // class java/lang/StringBuffer
      93: dup
      94: invokespecial #28                 // Method java/lang/StringBuffer."<init>":()V
      97: ldc           #43                 // String Status :
      99: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     102: aload_2
     103: invokevirtual #44                 // Method javax/management/remote/message/SASLMessage.getStatus:()I
     106: invokevirtual #45                 // Method java/lang/StringBuffer.append:(I)Ljava/lang/StringBuffer;
     109: invokevirtual #32                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
     112: invokevirtual #40                 // Method com/sun/jmx/remote/opt/util/ClassLogger.trace:(Ljava/lang/String;Ljava/lang/String;)V
     115: aload_2
     116: areturn

  public void consumeMessage(javax.management.remote.message.ProfileMessage) throws java.io.IOException;
    Code:
       0: aload_1
       1: instanceof    #34                 // class javax/management/remote/message/SASLMessage
       4: ifne          40
       7: new           #12                 // class java/io/IOException
      10: dup
      11: new           #27                 // class java/lang/StringBuffer
      14: dup
      15: invokespecial #28                 // Method java/lang/StringBuffer."<init>":()V
      18: ldc           #46                 // String Unexpected profile message type:
      20: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      23: aload_1
      24: invokevirtual #47                 // Method java/lang/Object.getClass:()Ljava/lang/Class;
      27: invokevirtual #48                 // Method java/lang/Class.getName:()Ljava/lang/String;
      30: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      33: invokevirtual #32                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
      36: invokespecial #14                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      39: athrow
      40: aload_1
      41: checkcast     #34                 // class javax/management/remote/message/SASLMessage
      44: astore_2
      45: getstatic     #36                 // Field logger:Lcom/sun/jmx/remote/opt/util/ClassLogger;
      48: invokevirtual #37                 // Method com/sun/jmx/remote/opt/util/ClassLogger.traceOn:()Z
      51: ifeq          124
      54: getstatic     #36                 // Field logger:Lcom/sun/jmx/remote/opt/util/ClassLogger;
      57: ldc           #49                 // String consumeMessage
      59: ldc           #50                 // String >>>>> SASL client message <<<<<
      61: invokevirtual #40                 // Method com/sun/jmx/remote/opt/util/ClassLogger.trace:(Ljava/lang/String;Ljava/lang/String;)V
      64: getstatic     #36                 // Field logger:Lcom/sun/jmx/remote/opt/util/ClassLogger;
      67: ldc           #49                 // String consumeMessage
      69: new           #27                 // class java/lang/StringBuffer
      72: dup
      73: invokespecial #28                 // Method java/lang/StringBuffer."<init>":()V
      76: ldc           #41                 // String Profile Name :
      78: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      81: aload_2
      82: invokevirtual #42                 // Method javax/management/remote/message/SASLMessage.getProfileName:()Ljava/lang/String;
      85: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
      88: invokevirtual #32                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
      91: invokevirtual #40                 // Method com/sun/jmx/remote/opt/util/ClassLogger.trace:(Ljava/lang/String;Ljava/lang/String;)V
      94: getstatic     #36                 // Field logger:Lcom/sun/jmx/remote/opt/util/ClassLogger;
      97: ldc           #49                 // String consumeMessage
      99: new           #27                 // class java/lang/StringBuffer
     102: dup
     103: invokespecial #28                 // Method java/lang/StringBuffer."<init>":()V
     106: ldc           #43                 // String Status :
     108: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     111: aload_2
     112: invokevirtual #44                 // Method javax/management/remote/message/SASLMessage.getStatus:()I
     115: invokevirtual #45                 // Method java/lang/StringBuffer.append:(I)Ljava/lang/StringBuffer;
     118: invokevirtual #32                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
     121: invokevirtual #40                 // Method com/sun/jmx/remote/opt/util/ClassLogger.trace:(Ljava/lang/String;Ljava/lang/String;)V
     124: aload_2
     125: invokevirtual #44                 // Method javax/management/remote/message/SASLMessage.getStatus:()I
     128: iconst_1
     129: if_icmpeq     167
     132: new           #12                 // class java/io/IOException
     135: dup
     136: new           #27                 // class java/lang/StringBuffer
     139: dup
     140: invokespecial #28                 // Method java/lang/StringBuffer."<init>":()V
     143: ldc           #51                 // String Unexpected SASL status [
     145: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     148: aload_2
     149: invokevirtual #44                 // Method javax/management/remote/message/SASLMessage.getStatus:()I
     152: invokevirtual #45                 // Method java/lang/StringBuffer.append:(I)Ljava/lang/StringBuffer;
     155: ldc           #31                 // String ]
     157: invokevirtual #30                 // Method java/lang/StringBuffer.append:(Ljava/lang/String;)Ljava/lang/StringBuffer;
     160: invokevirtual #32                 // Method java/lang/StringBuffer.toString:()Ljava/lang/String;
     163: invokespecial #14                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     166: athrow
     167: aload_0
     168: getfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
     171: invokeinterface #33,  1           // InterfaceMethod javax/security/sasl/SaslServer.isComplete:()Z
     176: ifne          199
     179: aload_0
     180: aload_0
     181: getfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
     184: aload_2
     185: invokevirtual #52                 // Method javax/management/remote/message/SASLMessage.getBlob:()[B
     188: invokeinterface #53,  2           // InterfaceMethod javax/security/sasl/SaslServer.evaluateResponse:([B)[B
     193: putfield      #4                  // Field blob:[B
     196: goto          209
     199: new           #12                 // class java/io/IOException
     202: dup
     203: ldc           #54                 // String SASL authentication complete despite the client claim for non-completion
     205: invokespecial #14                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     208: athrow
     209: return

  public boolean isComplete();
    Code:
       0: aload_0
       1: getfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
       4: invokeinterface #33,  1           // InterfaceMethod javax/security/sasl/SaslServer.isComplete:()Z
       9: ireturn

  public javax.security.auth.Subject activate() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
       4: ldc           #55                 // String javax.security.sasl.qop
       6: invokeinterface #56,  2           // InterfaceMethod javax/security/sasl/SaslServer.getNegotiatedProperty:(Ljava/lang/String;)Ljava/lang/Object;
      11: checkcast     #20                 // class java/lang/String
      14: astore_1
      15: aload_1
      16: ifnull        89
      19: aload_1
      20: ldc           #57                 // String auth-int
      22: invokevirtual #58                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
      25: ifne          37
      28: aload_1
      29: ldc           #59                 // String auth-conf
      31: invokevirtual #58                 // Method java/lang/String.equalsIgnoreCase:(Ljava/lang/String;)Z
      34: ifeq          89
      37: new           #60                 // class com/sun/jmx/remote/opt/security/SASLInputStream
      40: dup
      41: aload_0
      42: getfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
      45: aload_0
      46: getfield      #7                  // Field socket:Ljava/net/Socket;
      49: invokevirtual #61                 // Method java/net/Socket.getInputStream:()Ljava/io/InputStream;
      52: invokespecial #62                 // Method com/sun/jmx/remote/opt/security/SASLInputStream."<init>":(Ljavax/security/sasl/SaslServer;Ljava/io/InputStream;)V
      55: astore_2
      56: new           #63                 // class com/sun/jmx/remote/opt/security/SASLOutputStream
      59: dup
      60: aload_0
      61: getfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
      64: aload_0
      65: getfield      #7                  // Field socket:Ljava/net/Socket;
      68: invokevirtual #64                 // Method java/net/Socket.getOutputStream:()Ljava/io/OutputStream;
      71: invokespecial #65                 // Method com/sun/jmx/remote/opt/security/SASLOutputStream."<init>":(Ljavax/security/sasl/SaslServer;Ljava/io/OutputStream;)V
      74: astore_3
      75: aload_0
      76: getfield      #6                  // Field mc:Ljavax/management/remote/generic/MessageConnection;
      79: checkcast     #10                 // class com/sun/jmx/remote/socket/SocketConnectionIf
      82: aload_2
      83: aload_3
      84: invokeinterface #66,  3           // InterfaceMethod com/sun/jmx/remote/socket/SocketConnectionIf.replaceStreams:(Ljava/io/InputStream;Ljava/io/OutputStream;)V
      89: aload_0
      90: getfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
      93: invokeinterface #67,  1           // InterfaceMethod javax/security/sasl/SaslServer.getAuthorizationID:()Ljava/lang/String;
      98: astore_2
      99: new           #68                 // class javax/management/remote/JMXPrincipal
     102: dup
     103: aload_2
     104: invokespecial #69                 // Method javax/management/remote/JMXPrincipal."<init>":(Ljava/lang/String;)V
     107: astore_3
     108: aload_0
     109: getfield      #1                  // Field subject:Ljavax/security/auth/Subject;
     112: ifnonnull     126
     115: aload_0
     116: new           #70                 // class javax/security/auth/Subject
     119: dup
     120: invokespecial #71                 // Method javax/security/auth/Subject."<init>":()V
     123: putfield      #1                  // Field subject:Ljavax/security/auth/Subject;
     126: new           #72                 // class com/sun/jmx/remote/opt/security/SASLServerHandler$1
     129: dup
     130: aload_0
     131: aload_3
     132: invokespecial #73                 // Method com/sun/jmx/remote/opt/security/SASLServerHandler$1."<init>":(Lcom/sun/jmx/remote/opt/security/SASLServerHandler;Ljava/security/Principal;)V
     135: invokestatic  #74                 // Method java/security/AccessController.doPrivileged:(Ljava/security/PrivilegedAction;)Ljava/lang/Object;
     138: pop
     139: aload_0
     140: getfield      #1                  // Field subject:Ljavax/security/auth/Subject;
     143: areturn

  public void terminate() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #3                  // Field saslServer:Ljavax/security/sasl/SaslServer;
       4: invokeinterface #75,  1           // InterfaceMethod javax/security/sasl/SaslServer.dispose:()V
       9: return

  public java.lang.String getName();
    Code:
       0: aload_0
       1: getfield      #9                  // Field profile:Ljava/lang/String;
       4: areturn

  static javax.security.auth.Subject access$000(com.sun.jmx.remote.opt.security.SASLServerHandler);
    Code:
       0: aload_0
       1: getfield      #1                  // Field subject:Ljavax/security/auth/Subject;
       4: areturn

  static {};
    Code:
       0: new           #76                 // class com/sun/jmx/remote/opt/util/ClassLogger
       3: dup
       4: ldc           #77                 // String javax.management.remote.misc
       6: ldc           #78                 // String SASLServerHandler
       8: invokespecial #79                 // Method com/sun/jmx/remote/opt/util/ClassLogger."<init>":(Ljava/lang/String;Ljava/lang/String;)V
      11: putstatic     #36                 // Field logger:Lcom/sun/jmx/remote/opt/util/ClassLogger;
      14: return
}
