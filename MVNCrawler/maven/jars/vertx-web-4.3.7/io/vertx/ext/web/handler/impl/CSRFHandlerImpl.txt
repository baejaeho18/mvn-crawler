Compiled from "CSRFHandlerImpl.java"
public class io.vertx.ext.web.handler.impl.CSRFHandlerImpl implements io.vertx.ext.web.handler.CSRFHandler {
  private static final io.vertx.core.impl.logging.Logger LOG;

  private final io.vertx.ext.auth.VertxContextPRNG random;

  private final javax.crypto.Mac mac;

  private boolean nagHttps;

  private java.lang.String cookieName;

  private java.lang.String cookiePath;

  private java.lang.String headerName;

  private long timeout;

  private io.vertx.ext.web.impl.Origin origin;

  private boolean httpOnly;

  private boolean cookieSecure;

  public io.vertx.ext.web.handler.impl.CSRFHandlerImpl(io.vertx.core.Vertx, java.lang.String);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: ldc           #3                  // String XSRF-TOKEN
       7: putfield      #4                  // Field cookieName:Ljava/lang/String;
      10: aload_0
      11: ldc           #5                  // String /
      13: putfield      #6                  // Field cookiePath:Ljava/lang/String;
      16: aload_0
      17: ldc           #7                  // String X-XSRF-TOKEN
      19: putfield      #8                  // Field headerName:Ljava/lang/String;
      22: aload_0
      23: ldc2_w        #10                 // long 1800000l
      26: putfield      #12                 // Field timeout:J
      29: aload_2
      30: invokevirtual #13                 // Method java/lang/String.length:()I
      33: bipush        8
      35: if_icmpgt     48
      38: getstatic     #14                 // Field LOG:Lio/vertx/core/impl/logging/Logger;
      41: ldc           #15                 // String CSRF secret is very short (<= 8 bytes)
      43: invokeinterface #16,  2           // InterfaceMethod io/vertx/core/impl/logging/Logger.warn:(Ljava/lang/Object;)V
      48: aload_0
      49: aload_1
      50: invokestatic  #17                 // InterfaceMethod io/vertx/ext/auth/VertxContextPRNG.current:(Lio/vertx/core/Vertx;)Lio/vertx/ext/auth/VertxContextPRNG;
      53: putfield      #18                 // Field random:Lio/vertx/ext/auth/VertxContextPRNG;
      56: aload_0
      57: ldc           #19                 // String HmacSHA256
      59: invokestatic  #20                 // Method javax/crypto/Mac.getInstance:(Ljava/lang/String;)Ljavax/crypto/Mac;
      62: putfield      #21                 // Field mac:Ljavax/crypto/Mac;
      65: aload_0
      66: getfield      #21                 // Field mac:Ljavax/crypto/Mac;
      69: new           #22                 // class javax/crypto/spec/SecretKeySpec
      72: dup
      73: aload_2
      74: getstatic     #23                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
      77: invokevirtual #24                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
      80: ldc           #19                 // String HmacSHA256
      82: invokespecial #25                 // Method javax/crypto/spec/SecretKeySpec."<init>":([BLjava/lang/String;)V
      85: invokevirtual #26                 // Method javax/crypto/Mac.init:(Ljava/security/Key;)V
      88: goto          101
      91: astore_3
      92: new           #29                 // class java/lang/RuntimeException
      95: dup
      96: aload_3
      97: invokespecial #30                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/Throwable;)V
     100: athrow
     101: return
    Exception table:
       from    to  target type
          29    88    91   Class java/security/NoSuchAlgorithmException
          29    88    91   Class java/security/InvalidKeyException

  public io.vertx.ext.web.handler.CSRFHandler setOrigin(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: invokestatic  #31                 // Method io/vertx/ext/web/impl/Origin.parse:(Ljava/lang/String;)Lio/vertx/ext/web/impl/Origin;
       5: putfield      #32                 // Field origin:Lio/vertx/ext/web/impl/Origin;
       8: aload_0
       9: areturn

  public io.vertx.ext.web.handler.CSRFHandler setCookieName(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #4                  // Field cookieName:Ljava/lang/String;
       5: aload_0
       6: areturn

  public io.vertx.ext.web.handler.CSRFHandler setCookiePath(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #6                  // Field cookiePath:Ljava/lang/String;
       5: aload_0
       6: areturn

  public io.vertx.ext.web.handler.CSRFHandler setCookieHttpOnly(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #33                 // Field httpOnly:Z
       5: aload_0
       6: areturn

  public io.vertx.ext.web.handler.CSRFHandler setCookieSecure(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #34                 // Field cookieSecure:Z
       5: aload_0
       6: areturn

  public io.vertx.ext.web.handler.CSRFHandler setHeaderName(java.lang.String);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #8                  // Field headerName:Ljava/lang/String;
       5: aload_0
       6: areturn

  public io.vertx.ext.web.handler.CSRFHandler setTimeout(long);
    Code:
       0: aload_0
       1: lload_1
       2: putfield      #12                 // Field timeout:J
       5: aload_0
       6: areturn

  public io.vertx.ext.web.handler.CSRFHandler setNagHttps(boolean);
    Code:
       0: aload_0
       1: iload_1
       2: putfield      #35                 // Field nagHttps:Z
       5: aload_0
       6: areturn

  private java.lang.String generateAndStoreToken(io.vertx.ext.web.RoutingContext);
    Code:
       0: bipush        32
       2: newarray       byte
       4: astore_2
       5: aload_0
       6: getfield      #18                 // Field random:Lio/vertx/ext/auth/VertxContextPRNG;
       9: aload_2
      10: invokeinterface #36,  2           // InterfaceMethod io/vertx/ext/auth/VertxContextPRNG.nextBytes:([B)V
      15: new           #37                 // class java/lang/StringBuilder
      18: dup
      19: invokespecial #38                 // Method java/lang/StringBuilder."<init>":()V
      22: aload_2
      23: invokestatic  #39                 // Method io/vertx/ext/auth/impl/Codec.base64UrlEncode:([B)Ljava/lang/String;
      26: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      29: ldc           #41                 // String .
      31: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      34: invokestatic  #42                 // Method java/lang/System.currentTimeMillis:()J
      37: invokevirtual #43                 // Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
      40: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      43: astore_3
      44: aload_0
      45: getfield      #21                 // Field mac:Ljavax/crypto/Mac;
      48: aload_3
      49: getstatic     #45                 // Field java/nio/charset/StandardCharsets.US_ASCII:Ljava/nio/charset/Charset;
      52: invokevirtual #24                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
      55: invokevirtual #46                 // Method javax/crypto/Mac.doFinal:([B)[B
      58: invokestatic  #39                 // Method io/vertx/ext/auth/impl/Codec.base64UrlEncode:([B)Ljava/lang/String;
      61: astore        4
      63: new           #37                 // class java/lang/StringBuilder
      66: dup
      67: invokespecial #38                 // Method java/lang/StringBuilder."<init>":()V
      70: aload_3
      71: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      74: ldc           #41                 // String .
      76: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      79: aload         4
      81: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      84: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      87: astore        5
      89: aload_1
      90: invokeinterface #47,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.response:()Lio/vertx/core/http/HttpServerResponse;
      95: aload_0
      96: getfield      #4                  // Field cookieName:Ljava/lang/String;
      99: aload         5
     101: invokestatic  #48                 // InterfaceMethod io/vertx/core/http/Cookie.cookie:(Ljava/lang/String;Ljava/lang/String;)Lio/vertx/core/http/Cookie;
     104: aload_0
     105: getfield      #6                  // Field cookiePath:Ljava/lang/String;
     108: invokeinterface #49,  2           // InterfaceMethod io/vertx/core/http/Cookie.setPath:(Ljava/lang/String;)Lio/vertx/core/http/Cookie;
     113: aload_0
     114: getfield      #33                 // Field httpOnly:Z
     117: invokeinterface #50,  2           // InterfaceMethod io/vertx/core/http/Cookie.setHttpOnly:(Z)Lio/vertx/core/http/Cookie;
     122: aload_0
     123: getfield      #34                 // Field cookieSecure:Z
     126: invokeinterface #51,  2           // InterfaceMethod io/vertx/core/http/Cookie.setSecure:(Z)Lio/vertx/core/http/Cookie;
     131: getstatic     #52                 // Field io/vertx/core/http/CookieSameSite.STRICT:Lio/vertx/core/http/CookieSameSite;
     134: invokeinterface #53,  2           // InterfaceMethod io/vertx/core/http/Cookie.setSameSite:(Lio/vertx/core/http/CookieSameSite;)Lio/vertx/core/http/Cookie;
     139: invokeinterface #54,  2           // InterfaceMethod io/vertx/core/http/HttpServerResponse.addCookie:(Lio/vertx/core/http/Cookie;)Lio/vertx/core/http/HttpServerResponse;
     144: pop
     145: aload_1
     146: invokeinterface #55,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.session:()Lio/vertx/ext/web/Session;
     151: astore        6
     153: aload         6
     155: ifnull        200
     158: aload         6
     160: aload_0
     161: getfield      #8                  // Field headerName:Ljava/lang/String;
     164: new           #37                 // class java/lang/StringBuilder
     167: dup
     168: invokespecial #38                 // Method java/lang/StringBuilder."<init>":()V
     171: aload         6
     173: invokeinterface #56,  1           // InterfaceMethod io/vertx/ext/web/Session.id:()Ljava/lang/String;
     178: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     181: ldc           #5                  // String /
     183: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     186: aload         5
     188: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     191: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     194: invokeinterface #57,  3           // InterfaceMethod io/vertx/ext/web/Session.put:(Ljava/lang/String;Ljava/lang/Object;)Lio/vertx/ext/web/Session;
     199: pop
     200: aload         5
     202: areturn

  private java.lang.String getTokenFromSession(io.vertx.ext.web.RoutingContext);
    Code:
       0: aload_1
       1: invokeinterface #55,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.session:()Lio/vertx/ext/web/Session;
       6: astore_2
       7: aload_2
       8: ifnonnull     13
      11: aconst_null
      12: areturn
      13: aload_2
      14: aload_0
      15: getfield      #8                  // Field headerName:Ljava/lang/String;
      18: invokeinterface #58,  2           // InterfaceMethod io/vertx/ext/web/Session.get:(Ljava/lang/String;)Ljava/lang/Object;
      23: checkcast     #59                 // class java/lang/String
      26: astore_3
      27: aload_3
      28: ifnull        82
      31: aload_3
      32: bipush        47
      34: invokevirtual #60                 // Method java/lang/String.indexOf:(I)I
      37: istore        4
      39: iload         4
      41: iconst_m1
      42: if_icmpeq     82
      45: aload_2
      46: invokeinterface #56,  1           // InterfaceMethod io/vertx/ext/web/Session.id:()Ljava/lang/String;
      51: ifnull        82
      54: aload_2
      55: invokeinterface #56,  1           // InterfaceMethod io/vertx/ext/web/Session.id:()Ljava/lang/String;
      60: aload_3
      61: iconst_0
      62: iload         4
      64: invokevirtual #61                 // Method java/lang/String.substring:(II)Ljava/lang/String;
      67: invokevirtual #62                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      70: ifeq          82
      73: aload_3
      74: iload         4
      76: iconst_1
      77: iadd
      78: invokevirtual #63                 // Method java/lang/String.substring:(I)Ljava/lang/String;
      81: areturn
      82: aconst_null
      83: areturn

  private static boolean isBlank(java.lang.String);
    Code:
       0: aload_0
       1: ifnull        14
       4: aload_0
       5: invokevirtual #64                 // Method java/lang/String.trim:()Ljava/lang/String;
       8: invokevirtual #65                 // Method java/lang/String.isEmpty:()Z
      11: ifeq          18
      14: iconst_1
      15: goto          19
      18: iconst_0
      19: ireturn

  private static long parseLong(java.lang.String);
    Code:
       0: aload_0
       1: invokestatic  #66                 // Method isBlank:(Ljava/lang/String;)Z
       4: ifeq          11
       7: ldc2_w        #67                 // long -1l
      10: lreturn
      11: aload_0
      12: invokestatic  #69                 // Method java/lang/Long.parseLong:(Ljava/lang/String;)J
      15: lreturn
      16: astore_1
      17: getstatic     #14                 // Field LOG:Lio/vertx/core/impl/logging/Logger;
      20: ldc           #71                 // String Invalid Token format
      22: aload_1
      23: invokeinterface #72,  3           // InterfaceMethod io/vertx/core/impl/logging/Logger.trace:(Ljava/lang/Object;Ljava/lang/Throwable;)V
      28: ldc2_w        #67                 // long -1l
      31: lreturn
    Exception table:
       from    to  target type
          11    15    16   Class java/lang/NumberFormatException

  private boolean isValidRequest(io.vertx.ext.web.RoutingContext);
    Code:
       0: aload_1
       1: invokeinterface #73,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.request:()Lio/vertx/core/http/HttpServerRequest;
       6: aload_0
       7: getfield      #4                  // Field cookieName:Ljava/lang/String;
      10: invokeinterface #74,  2           // InterfaceMethod io/vertx/core/http/HttpServerRequest.getCookie:(Ljava/lang/String;)Lio/vertx/core/http/Cookie;
      15: astore_2
      16: aload_1
      17: invokeinterface #73,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.request:()Lio/vertx/core/http/HttpServerRequest;
      22: aload_0
      23: getfield      #8                  // Field headerName:Ljava/lang/String;
      26: invokeinterface #75,  2           // InterfaceMethod io/vertx/core/http/HttpServerRequest.getHeader:(Ljava/lang/String;)Ljava/lang/String;
      31: astore_3
      32: aload_3
      33: ifnonnull     86
      36: aload_1
      37: invokeinterface #76,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.body:()Lio/vertx/ext/web/RequestBody;
      42: invokeinterface #77,  1           // InterfaceMethod io/vertx/ext/web/RequestBody.available:()Z
      47: ifeq          69
      50: aload_1
      51: invokeinterface #73,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.request:()Lio/vertx/core/http/HttpServerRequest;
      56: aload_0
      57: getfield      #8                  // Field headerName:Ljava/lang/String;
      60: invokeinterface #78,  2           // InterfaceMethod io/vertx/core/http/HttpServerRequest.getFormAttribute:(Ljava/lang/String;)Ljava/lang/String;
      65: astore_3
      66: goto          86
      69: aload_1
      70: new           #79                 // class java/lang/IllegalStateException
      73: dup
      74: ldc           #80                 // String BodyHandler is required to process POST requests
      76: invokespecial #81                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
      79: invokeinterface #82,  2           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(Ljava/lang/Throwable;)V
      84: iconst_0
      85: ireturn
      86: aload_3
      87: ifnull        101
      90: aload_2
      91: ifnull        101
      94: aload_3
      95: invokestatic  #66                 // Method isBlank:(Ljava/lang/String;)Z
      98: ifeq          121
     101: aload_1
     102: sipush        403
     105: new           #83                 // class java/lang/IllegalArgumentException
     108: dup
     109: ldc           #84                 // String Token provided via HTTP Header/Form is absent/empty
     111: invokespecial #85                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     114: invokeinterface #86,  3           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(ILjava/lang/Throwable;)V
     119: iconst_0
     120: ireturn
     121: aload_2
     122: invokeinterface #87,  1           // InterfaceMethod io/vertx/core/http/Cookie.getValue:()Ljava/lang/String;
     127: astore        4
     129: aload         4
     131: ifnull        142
     134: aload         4
     136: invokestatic  #66                 // Method isBlank:(Ljava/lang/String;)Z
     139: ifeq          162
     142: aload_1
     143: sipush        403
     146: new           #83                 // class java/lang/IllegalArgumentException
     149: dup
     150: ldc           #84                 // String Token provided via HTTP Header/Form is absent/empty
     152: invokespecial #85                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     155: invokeinterface #86,  3           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(ILjava/lang/Throwable;)V
     160: iconst_0
     161: ireturn
     162: aload_3
     163: getstatic     #23                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     166: invokevirtual #24                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     169: astore        5
     171: aload         4
     173: getstatic     #23                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     176: invokevirtual #24                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     179: astore        6
     181: aload         5
     183: aload         6
     185: invokestatic  #88                 // Method java/security/MessageDigest.isEqual:([B[B)Z
     188: ifne          211
     191: aload_1
     192: sipush        403
     195: new           #83                 // class java/lang/IllegalArgumentException
     198: dup
     199: ldc           #89                 // String Token provided via HTTP Header and via Cookie are not equal
     201: invokespecial #85                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     204: invokeinterface #86,  3           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(ILjava/lang/Throwable;)V
     209: iconst_0
     210: ireturn
     211: aload_1
     212: invokeinterface #55,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.session:()Lio/vertx/ext/web/Session;
     217: astore        7
     219: aload         7
     221: ifnull        384
     224: aload         7
     226: aload_0
     227: getfield      #8                  // Field headerName:Ljava/lang/String;
     230: invokeinterface #58,  2           // InterfaceMethod io/vertx/ext/web/Session.get:(Ljava/lang/String;)Ljava/lang/Object;
     235: checkcast     #59                 // class java/lang/String
     238: astore        8
     240: aload         8
     242: ifnull        364
     245: aload         8
     247: bipush        47
     249: invokevirtual #60                 // Method java/lang/String.indexOf:(I)I
     252: istore        9
     254: iload         9
     256: iconst_m1
     257: if_icmpeq     341
     260: aload         7
     262: invokeinterface #56,  1           // InterfaceMethod io/vertx/ext/web/Session.id:()Ljava/lang/String;
     267: ifnull        341
     270: aload         7
     272: invokeinterface #56,  1           // InterfaceMethod io/vertx/ext/web/Session.id:()Ljava/lang/String;
     277: aload         8
     279: iconst_0
     280: iload         9
     282: invokevirtual #61                 // Method java/lang/String.substring:(II)Ljava/lang/String;
     285: invokevirtual #62                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     288: ifeq          341
     291: aload         8
     293: iload         9
     295: iconst_1
     296: iadd
     297: invokevirtual #63                 // Method java/lang/String.substring:(I)Ljava/lang/String;
     300: astore        10
     302: aload         10
     304: getstatic     #23                 // Field java/nio/charset/StandardCharsets.UTF_8:Ljava/nio/charset/Charset;
     307: invokevirtual #24                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     310: aload         5
     312: invokestatic  #88                 // Method java/security/MessageDigest.isEqual:([B[B)Z
     315: ifne          338
     318: aload_1
     319: sipush        403
     322: new           #83                 // class java/lang/IllegalArgumentException
     325: dup
     326: ldc           #90                 // String Token has been used or is outdated
     328: invokespecial #85                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     331: invokeinterface #86,  3           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(ILjava/lang/Throwable;)V
     336: iconst_0
     337: ireturn
     338: goto          361
     341: aload_1
     342: sipush        403
     345: new           #83                 // class java/lang/IllegalArgumentException
     348: dup
     349: ldc           #91                 // String Token has been issued for a different session
     351: invokespecial #85                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     354: invokeinterface #86,  3           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(ILjava/lang/Throwable;)V
     359: iconst_0
     360: ireturn
     361: goto          384
     364: aload_1
     365: sipush        403
     368: new           #83                 // class java/lang/IllegalArgumentException
     371: dup
     372: ldc           #92                 // String No Token has been added to the session
     374: invokespecial #85                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     377: invokeinterface #86,  3           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(ILjava/lang/Throwable;)V
     382: iconst_0
     383: ireturn
     384: aload_3
     385: ldc           #93                 // String \\.
     387: invokevirtual #94                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     390: astore        8
     392: aload         8
     394: arraylength
     395: iconst_3
     396: if_icmpeq     410
     399: aload_1
     400: sipush        403
     403: invokeinterface #95,  2           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(I)V
     408: iconst_0
     409: ireturn
     410: new           #37                 // class java/lang/StringBuilder
     413: dup
     414: invokespecial #38                 // Method java/lang/StringBuilder."<init>":()V
     417: aload         8
     419: iconst_0
     420: aaload
     421: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     424: ldc           #41                 // String .
     426: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     429: aload         8
     431: iconst_1
     432: aaload
     433: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     436: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     439: getstatic     #45                 // Field java/nio/charset/StandardCharsets.US_ASCII:Ljava/nio/charset/Charset;
     442: invokevirtual #24                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     445: astore        9
     447: aload_0
     448: getfield      #21                 // Field mac:Ljavax/crypto/Mac;
     451: dup
     452: astore        10
     454: monitorenter
     455: aload_0
     456: getfield      #21                 // Field mac:Ljavax/crypto/Mac;
     459: aload         9
     461: invokevirtual #46                 // Method javax/crypto/Mac.doFinal:([B)[B
     464: astore        9
     466: aload         10
     468: monitorexit
     469: goto          480
     472: astore        11
     474: aload         10
     476: monitorexit
     477: aload         11
     479: athrow
     480: aload         9
     482: invokestatic  #39                 // Method io/vertx/ext/auth/impl/Codec.base64UrlEncode:([B)Ljava/lang/String;
     485: getstatic     #45                 // Field java/nio/charset/StandardCharsets.US_ASCII:Ljava/nio/charset/Charset;
     488: invokevirtual #24                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     491: astore        10
     493: aload         10
     495: aload         8
     497: iconst_2
     498: aaload
     499: getstatic     #45                 // Field java/nio/charset/StandardCharsets.US_ASCII:Ljava/nio/charset/Charset;
     502: invokevirtual #24                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
     505: invokestatic  #88                 // Method java/security/MessageDigest.isEqual:([B[B)Z
     508: ifne          531
     511: aload_1
     512: sipush        403
     515: new           #83                 // class java/lang/IllegalArgumentException
     518: dup
     519: ldc           #96                 // String Token signature does not match
     521: invokespecial #85                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     524: invokeinterface #86,  3           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(ILjava/lang/Throwable;)V
     529: iconst_0
     530: ireturn
     531: aload         7
     533: ifnull        548
     536: aload         7
     538: aload_0
     539: getfield      #8                  // Field headerName:Ljava/lang/String;
     542: invokeinterface #97,  2           // InterfaceMethod io/vertx/ext/web/Session.remove:(Ljava/lang/String;)Ljava/lang/Object;
     547: pop
     548: aload         8
     550: iconst_1
     551: aaload
     552: invokestatic  #98                 // Method parseLong:(Ljava/lang/String;)J
     555: lstore        11
     557: lload         11
     559: ldc2_w        #67                 // long -1l
     562: lcmp
     563: ifne          577
     566: aload_1
     567: sipush        403
     570: invokeinterface #95,  2           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(I)V
     575: iconst_0
     576: ireturn
     577: invokestatic  #42                 // Method java/lang/System.currentTimeMillis:()J
     580: lload         11
     582: aload_0
     583: getfield      #12                 // Field timeout:J
     586: ladd
     587: lcmp
     588: ifle          611
     591: aload_1
     592: sipush        403
     595: new           #83                 // class java/lang/IllegalArgumentException
     598: dup
     599: ldc           #99                 // String CSRF validity expired
     601: invokespecial #85                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     604: invokeinterface #86,  3           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(ILjava/lang/Throwable;)V
     609: iconst_0
     610: ireturn
     611: iconst_1
     612: ireturn
    Exception table:
       from    to  target type
         455   469   472   any
         472   477   472   any

  public void handle(io.vertx.ext.web.RoutingContext);
    Code:
       0: aload_0
       1: getfield      #35                 // Field nagHttps:Z
       4: ifeq          59
       7: aload_1
       8: invokeinterface #73,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.request:()Lio/vertx/core/http/HttpServerRequest;
      13: invokeinterface #100,  1          // InterfaceMethod io/vertx/core/http/HttpServerRequest.absoluteURI:()Ljava/lang/String;
      18: astore_2
      19: aload_2
      20: ifnull        59
      23: aload_2
      24: ldc           #101                // String https:
      26: invokevirtual #102                // Method java/lang/String.startsWith:(Ljava/lang/String;)Z
      29: ifne          59
      32: getstatic     #14                 // Field LOG:Lio/vertx/core/impl/logging/Logger;
      35: new           #37                 // class java/lang/StringBuilder
      38: dup
      39: invokespecial #38                 // Method java/lang/StringBuilder."<init>":()V
      42: ldc           #103                // String Using session cookies without https could make you susceptible to session hijacking:
      44: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      47: aload_2
      48: invokevirtual #40                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
      51: invokevirtual #44                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
      54: invokeinterface #104,  2          // InterfaceMethod io/vertx/core/impl/logging/Logger.trace:(Ljava/lang/Object;)V
      59: aload_1
      60: invokeinterface #73,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.request:()Lio/vertx/core/http/HttpServerRequest;
      65: invokeinterface #105,  1          // InterfaceMethod io/vertx/core/http/HttpServerRequest.method:()Lio/vertx/core/http/HttpMethod;
      70: astore_2
      71: aload_1
      72: invokeinterface #55,  1           // InterfaceMethod io/vertx/ext/web/RoutingContext.session:()Lio/vertx/ext/web/Session;
      77: astore_3
      78: aload_0
      79: getfield      #32                 // Field origin:Lio/vertx/ext/web/impl/Origin;
      82: aload_1
      83: invokestatic  #106                // Method io/vertx/ext/web/impl/Origin.check:(Lio/vertx/ext/web/impl/Origin;Lio/vertx/ext/web/RoutingContext;)Z
      86: ifne          108
      89: aload_1
      90: sipush        403
      93: new           #79                 // class java/lang/IllegalStateException
      96: dup
      97: ldc           #107                // String Invalid Origin
      99: invokespecial #81                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;)V
     102: invokeinterface #86,  3           // InterfaceMethod io/vertx/ext/web/RoutingContext.fail:(ILjava/lang/Throwable;)V
     107: return
     108: aload_2
     109: invokevirtual #108                // Method io/vertx/core/http/HttpMethod.name:()Ljava/lang/String;
     112: astore        4
     114: iconst_m1
     115: istore        5
     117: aload         4
     119: invokevirtual #109                // Method java/lang/String.hashCode:()I
     122: lookupswitch  { // 5
                 70454: 172
                 79599: 204
               2461856: 188
              75900968: 236
            2012838315: 220
               default: 249
          }
     172: aload         4
     174: ldc           #110                // String GET
     176: invokevirtual #62                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     179: ifeq          249
     182: iconst_0
     183: istore        5
     185: goto          249
     188: aload         4
     190: ldc           #111                // String POST
     192: invokevirtual #62                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     195: ifeq          249
     198: iconst_1
     199: istore        5
     201: goto          249
     204: aload         4
     206: ldc           #112                // String PUT
     208: invokevirtual #62                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     211: ifeq          249
     214: iconst_2
     215: istore        5
     217: goto          249
     220: aload         4
     222: ldc           #113                // String DELETE
     224: invokevirtual #62                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     227: ifeq          249
     230: iconst_3
     231: istore        5
     233: goto          249
     236: aload         4
     238: ldc           #114                // String PATCH
     240: invokevirtual #62                 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
     243: ifeq          249
     246: iconst_4
     247: istore        5
     249: iload         5
     251: tableswitch   { // 0 to 4
                     0: 284
                     1: 407
                     2: 407
                     3: 407
                     4: 407
               default: 444
          }
     284: aload_3
     285: ifnonnull     298
     288: aload_0
     289: aload_1
     290: invokespecial #115                // Method generateAndStoreToken:(Lio/vertx/ext/web/RoutingContext;)Ljava/lang/String;
     293: astore        6
     295: goto          385
     298: aload_0
     299: aload_1
     300: invokespecial #116                // Method getTokenFromSession:(Lio/vertx/ext/web/RoutingContext;)Ljava/lang/String;
     303: astore        7
     305: aload         7
     307: ifnonnull     320
     310: aload_0
     311: aload_1
     312: invokespecial #115                // Method generateAndStoreToken:(Lio/vertx/ext/web/RoutingContext;)Ljava/lang/String;
     315: astore        6
     317: goto          385
     320: aload         7
     322: ldc           #93                 // String \\.
     324: invokevirtual #94                 // Method java/lang/String.split:(Ljava/lang/String;)[Ljava/lang/String;
     327: astore        8
     329: aload         8
     331: iconst_1
     332: aaload
     333: invokestatic  #98                 // Method parseLong:(Ljava/lang/String;)J
     336: lstore        9
     338: lload         9
     340: ldc2_w        #67                 // long -1l
     343: lcmp
     344: ifne          357
     347: aload_0
     348: aload_1
     349: invokespecial #115                // Method generateAndStoreToken:(Lio/vertx/ext/web/RoutingContext;)Ljava/lang/String;
     352: astore        6
     354: goto          385
     357: invokestatic  #42                 // Method java/lang/System.currentTimeMillis:()J
     360: lload         9
     362: aload_0
     363: getfield      #12                 // Field timeout:J
     366: ladd
     367: lcmp
     368: ifgt          378
     371: aload         7
     373: astore        6
     375: goto          385
     378: aload_0
     379: aload_1
     380: invokespecial #115                // Method generateAndStoreToken:(Lio/vertx/ext/web/RoutingContext;)Ljava/lang/String;
     383: astore        6
     385: aload_1
     386: aload_0
     387: getfield      #8                  // Field headerName:Ljava/lang/String;
     390: aload         6
     392: invokeinterface #117,  3          // InterfaceMethod io/vertx/ext/web/RoutingContext.put:(Ljava/lang/String;Ljava/lang/Object;)Lio/vertx/ext/web/RoutingContext;
     397: pop
     398: aload_1
     399: invokeinterface #118,  1          // InterfaceMethod io/vertx/ext/web/RoutingContext.next:()V
     404: goto          450
     407: aload_0
     408: aload_1
     409: invokespecial #119                // Method isValidRequest:(Lio/vertx/ext/web/RoutingContext;)Z
     412: ifeq          450
     415: aload_0
     416: aload_1
     417: invokespecial #115                // Method generateAndStoreToken:(Lio/vertx/ext/web/RoutingContext;)Ljava/lang/String;
     420: astore        6
     422: aload_1
     423: aload_0
     424: getfield      #8                  // Field headerName:Ljava/lang/String;
     427: aload         6
     429: invokeinterface #117,  3          // InterfaceMethod io/vertx/ext/web/RoutingContext.put:(Ljava/lang/String;Ljava/lang/Object;)Lio/vertx/ext/web/RoutingContext;
     434: pop
     435: aload_1
     436: invokeinterface #118,  1          // InterfaceMethod io/vertx/ext/web/RoutingContext.next:()V
     441: goto          450
     444: aload_1
     445: invokeinterface #118,  1          // InterfaceMethod io/vertx/ext/web/RoutingContext.next:()V
     450: return

  public void handle(java.lang.Object);
    Code:
       0: aload_0
       1: aload_1
       2: checkcast     #120                // class io/vertx/ext/web/RoutingContext
       5: invokevirtual #121                // Method handle:(Lio/vertx/ext/web/RoutingContext;)V
       8: return

  static {};
    Code:
       0: ldc           #122                // class io/vertx/ext/web/handler/impl/CSRFHandlerImpl
       2: invokestatic  #123                // Method io/vertx/core/impl/logging/LoggerFactory.getLogger:(Ljava/lang/Class;)Lio/vertx/core/impl/logging/Logger;
       5: putstatic     #14                 // Field LOG:Lio/vertx/core/impl/logging/Logger;
       8: return
}
