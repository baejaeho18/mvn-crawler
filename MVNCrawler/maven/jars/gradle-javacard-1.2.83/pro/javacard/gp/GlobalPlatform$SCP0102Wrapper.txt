Compiled from "GlobalPlatform.java"
public class pro.javacard.gp.GlobalPlatform$SCP0102Wrapper extends pro.javacard.gp.GlobalPlatform$SCPWrapper {
  private byte[] icv;

  private byte[] ricv;

  private int scp;

  private final java.io.ByteArrayOutputStream rMac;

  private boolean icvEnc;

  private boolean preAPDU;

  private boolean postAPDU;

  private pro.javacard.gp.GlobalPlatform$SCP0102Wrapper(pro.javacard.gp.GPKeySet, int, java.util.EnumSet<pro.javacard.gp.GlobalPlatform$APDUMode>, byte[], byte[], int);
    Code:
       0: aload_0
       1: invokespecial #3                  // Method pro/javacard/gp/GlobalPlatform$SCPWrapper."<init>":()V
       4: aload_0
       5: aconst_null
       6: putfield      #4                  // Field icv:[B
       9: aload_0
      10: aconst_null
      11: putfield      #5                  // Field ricv:[B
      14: aload_0
      15: iconst_0
      16: putfield      #6                  // Field scp:I
      19: aload_0
      20: new           #7                  // class java/io/ByteArrayOutputStream
      23: dup
      24: invokespecial #8                  // Method java/io/ByteArrayOutputStream."<init>":()V
      27: putfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      30: aload_0
      31: iconst_0
      32: putfield      #10                 // Field icvEnc:Z
      35: aload_0
      36: iconst_0
      37: putfield      #11                 // Field preAPDU:Z
      40: aload_0
      41: iconst_0
      42: putfield      #12                 // Field postAPDU:Z
      45: aload_0
      46: iload         6
      48: putfield      #13                 // Field blockSize:I
      51: aload_0
      52: aload_1
      53: putfield      #14                 // Field sessionKeys:Lpro/javacard/gp/GPKeySet;
      56: aload_0
      57: aload         4
      59: putfield      #4                  // Field icv:[B
      62: aload_0
      63: aload         5
      65: putfield      #5                  // Field ricv:[B
      68: aload_0
      69: iload_2
      70: invokevirtual #15                 // Method setSCPVersion:(I)V
      73: aload_0
      74: aload_3
      75: invokevirtual #16                 // Method setSecurityLevel:(Ljava/util/EnumSet;)V
      78: return

  public void setSCPVersion(int);
    Code:
       0: aload_0
       1: iconst_2
       2: putfield      #6                  // Field scp:I
       5: iload_1
       6: iconst_3
       7: if_icmpge     15
      10: aload_0
      11: iconst_1
      12: putfield      #6                  // Field scp:I
      15: iload_1
      16: iconst_2
      17: if_icmpeq     44
      20: iload_1
      21: bipush        7
      23: if_icmpeq     44
      26: iload_1
      27: bipush        8
      29: if_icmpeq     44
      32: iload_1
      33: bipush        9
      35: if_icmpeq     44
      38: iload_1
      39: bipush        10
      41: if_icmpne     52
      44: aload_0
      45: iconst_1
      46: putfield      #10                 // Field icvEnc:Z
      49: goto          57
      52: aload_0
      53: iconst_0
      54: putfield      #10                 // Field icvEnc:Z
      57: iload_1
      58: iconst_1
      59: if_icmpeq     89
      62: iload_1
      63: iconst_2
      64: if_icmpeq     89
      67: iload_1
      68: iconst_3
      69: if_icmpeq     89
      72: iload_1
      73: iconst_4
      74: if_icmpeq     89
      77: iload_1
      78: bipush        7
      80: if_icmpeq     89
      83: iload_1
      84: bipush        8
      86: if_icmpne     97
      89: aload_0
      90: iconst_1
      91: putfield      #11                 // Field preAPDU:Z
      94: goto          102
      97: aload_0
      98: iconst_0
      99: putfield      #11                 // Field preAPDU:Z
     102: iload_1
     103: iconst_5
     104: if_icmpeq     125
     107: iload_1
     108: bipush        6
     110: if_icmpeq     125
     113: iload_1
     114: bipush        9
     116: if_icmpeq     125
     119: iload_1
     120: bipush        10
     122: if_icmpne     133
     125: aload_0
     126: iconst_1
     127: putfield      #12                 // Field postAPDU:Z
     130: goto          138
     133: aload_0
     134: iconst_0
     135: putfield      #12                 // Field postAPDU:Z
     138: return

  public byte[] getIV();
    Code:
       0: aload_0
       1: getfield      #4                  // Field icv:[B
       4: areturn

  public void setRMACIV(byte[]);
    Code:
       0: aload_0
       1: aload_1
       2: putfield      #5                  // Field ricv:[B
       5: return

  private static byte clearBits(byte, byte);
    Code:
       0: iload_0
       1: iload_1
       2: iconst_m1
       3: ixor
       4: iand
       5: sipush        255
       8: iand
       9: i2b
      10: ireturn

  private static byte setBits(byte, byte);
    Code:
       0: iload_0
       1: iload_1
       2: ior
       3: sipush        255
       6: iand
       7: i2b
       8: ireturn

  public javax.smartcardio.CommandAPDU wrap(javax.smartcardio.CommandAPDU) throws pro.javacard.gp.GPException;
    Code:
       0: aload_0
       1: getfield      #17                 // Field rmac:Z
       4: ifeq          93
       7: aload_0
       8: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      11: invokevirtual #18                 // Method java/io/ByteArrayOutputStream.reset:()V
      14: aload_0
      15: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      18: aload_1
      19: invokevirtual #19                 // Method javax/smartcardio/CommandAPDU.getCLA:()I
      22: i2b
      23: bipush        7
      25: invokestatic  #20                 // Method clearBits:(BB)B
      28: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
      31: aload_0
      32: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      35: aload_1
      36: invokevirtual #22                 // Method javax/smartcardio/CommandAPDU.getINS:()I
      39: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
      42: aload_0
      43: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      46: aload_1
      47: invokevirtual #23                 // Method javax/smartcardio/CommandAPDU.getP1:()I
      50: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
      53: aload_0
      54: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      57: aload_1
      58: invokevirtual #24                 // Method javax/smartcardio/CommandAPDU.getP2:()I
      61: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
      64: aload_1
      65: invokevirtual #25                 // Method javax/smartcardio/CommandAPDU.getNc:()I
      68: iflt          93
      71: aload_0
      72: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      75: aload_1
      76: invokevirtual #25                 // Method javax/smartcardio/CommandAPDU.getNc:()I
      79: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
      82: aload_0
      83: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      86: aload_1
      87: invokevirtual #26                 // Method javax/smartcardio/CommandAPDU.getData:()[B
      90: invokevirtual #27                 // Method java/io/ByteArrayOutputStream.write:([B)V
      93: aload_0
      94: getfield      #28                 // Field mac:Z
      97: ifne          109
     100: aload_0
     101: getfield      #29                 // Field enc:Z
     104: ifne          109
     107: aload_1
     108: areturn
     109: aload_1
     110: invokevirtual #19                 // Method javax/smartcardio/CommandAPDU.getCLA:()I
     113: istore_2
     114: iload_2
     115: istore_3
     116: aload_1
     117: invokevirtual #22                 // Method javax/smartcardio/CommandAPDU.getINS:()I
     120: istore        4
     122: aload_1
     123: invokevirtual #23                 // Method javax/smartcardio/CommandAPDU.getP1:()I
     126: istore        5
     128: aload_1
     129: invokevirtual #24                 // Method javax/smartcardio/CommandAPDU.getP2:()I
     132: istore        6
     134: aload_1
     135: invokevirtual #26                 // Method javax/smartcardio/CommandAPDU.getData:()[B
     138: astore        7
     140: aload_1
     141: invokevirtual #25                 // Method javax/smartcardio/CommandAPDU.getNc:()I
     144: istore        8
     146: iload         8
     148: istore        9
     150: aconst_null
     151: astore        10
     153: aload_1
     154: invokevirtual #30                 // Method javax/smartcardio/CommandAPDU.getNe:()I
     157: istore        11
     159: new           #7                  // class java/io/ByteArrayOutputStream
     162: dup
     163: invokespecial #8                  // Method java/io/ByteArrayOutputStream."<init>":()V
     166: astore        12
     168: iload         8
     170: aload_0
     171: invokevirtual #31                 // Method getBlockSize:()I
     174: if_icmple     187
     177: new           #32                 // class java/lang/IllegalArgumentException
     180: dup
     181: ldc           #33                 // String APDU too long for wrapping.
     183: invokespecial #34                 // Method java/lang/IllegalArgumentException."<init>":(Ljava/lang/String;)V
     186: athrow
     187: aload_0
     188: getfield      #28                 // Field mac:Z
     191: ifeq          461
     194: aload_0
     195: getfield      #4                  // Field icv:[B
     198: ifnonnull     212
     201: aload_0
     202: bipush        8
     204: newarray       byte
     206: putfield      #4                  // Field icv:[B
     209: goto          298
     212: aload_0
     213: getfield      #10                 // Field icvEnc:Z
     216: ifeq          298
     219: aconst_null
     220: astore        13
     222: aload_0
     223: getfield      #6                  // Field scp:I
     226: iconst_1
     227: if_icmpne     256
     230: ldc           #36                 // String DESede/ECB/NoPadding
     232: invokestatic  #37                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
     235: astore        13
     237: aload         13
     239: iconst_1
     240: aload_0
     241: getfield      #14                 // Field sessionKeys:Lpro/javacard/gp/GPKeySet;
     244: getstatic     #39                 // Field pro/javacard/gp/GPData$KeyType.MAC:Lpro/javacard/gp/GPData$KeyType;
     247: invokevirtual #40                 // Method pro/javacard/gp/GPKeySet.getKeyFor:(Lpro/javacard/gp/GPData$KeyType;)Ljava/security/Key;
     250: invokevirtual #41                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;)V
     253: goto          285
     256: ldc           #42                 // String DES/ECB/NoPadding
     258: invokestatic  #37                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
     261: astore        13
     263: aload         13
     265: iconst_1
     266: aload_0
     267: getfield      #14                 // Field sessionKeys:Lpro/javacard/gp/GPKeySet;
     270: getstatic     #39                 // Field pro/javacard/gp/GPData$KeyType.MAC:Lpro/javacard/gp/GPData$KeyType;
     273: invokevirtual #43                 // Method pro/javacard/gp/GPKeySet.getKey:(Lpro/javacard/gp/GPData$KeyType;)Lpro/javacard/gp/GPKeySet$GPKey;
     276: getstatic     #44                 // Field pro/javacard/gp/GPKeySet$GPKey$Type.DES:Lpro/javacard/gp/GPKeySet$GPKey$Type;
     279: invokevirtual #45                 // Method pro/javacard/gp/GPKeySet$GPKey.getKey:(Lpro/javacard/gp/GPKeySet$GPKey$Type;)Ljava/security/Key;
     282: invokevirtual #41                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;)V
     285: aload_0
     286: aload         13
     288: aload_0
     289: getfield      #4                  // Field icv:[B
     292: invokevirtual #46                 // Method javax/crypto/Cipher.doFinal:([B)[B
     295: putfield      #4                  // Field icv:[B
     298: aload_0
     299: getfield      #11                 // Field preAPDU:Z
     302: ifeq          319
     305: iload_3
     306: i2b
     307: iconst_4
     308: invokestatic  #47                 // Method setBits:(BB)B
     311: istore_3
     312: iload         9
     314: bipush        8
     316: iadd
     317: istore        9
     319: aload         12
     321: iload_3
     322: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     325: aload         12
     327: iload         4
     329: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     332: aload         12
     334: iload         5
     336: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     339: aload         12
     341: iload         6
     343: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     346: aload         12
     348: iload         9
     350: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     353: aload         12
     355: aload         7
     357: invokevirtual #27                 // Method java/io/ByteArrayOutputStream.write:([B)V
     360: aload_0
     361: getfield      #6                  // Field scp:I
     364: iconst_1
     365: if_icmpne     397
     368: aload_0
     369: aload_0
     370: getfield      #14                 // Field sessionKeys:Lpro/javacard/gp/GPKeySet;
     373: getstatic     #39                 // Field pro/javacard/gp/GPData$KeyType.MAC:Lpro/javacard/gp/GPData$KeyType;
     376: invokevirtual #43                 // Method pro/javacard/gp/GPKeySet.getKey:(Lpro/javacard/gp/GPData$KeyType;)Lpro/javacard/gp/GPKeySet$GPKey;
     379: aload         12
     381: invokevirtual #48                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     384: aload_0
     385: getfield      #4                  // Field icv:[B
     388: invokestatic  #49                 // Method pro/javacard/gp/GPCrypto.mac_3des:(Lpro/javacard/gp/GPKeySet$GPKey;[B[B)[B
     391: putfield      #4                  // Field icv:[B
     394: goto          431
     397: aload_0
     398: getfield      #6                  // Field scp:I
     401: iconst_2
     402: if_icmpne     431
     405: aload_0
     406: aload_0
     407: getfield      #14                 // Field sessionKeys:Lpro/javacard/gp/GPKeySet;
     410: getstatic     #39                 // Field pro/javacard/gp/GPData$KeyType.MAC:Lpro/javacard/gp/GPData$KeyType;
     413: invokevirtual #43                 // Method pro/javacard/gp/GPKeySet.getKey:(Lpro/javacard/gp/GPData$KeyType;)Lpro/javacard/gp/GPKeySet$GPKey;
     416: aload         12
     418: invokevirtual #48                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     421: aload_0
     422: getfield      #4                  // Field icv:[B
     425: invokestatic  #50                 // Method pro/javacard/gp/GPCrypto.mac_des_3des:(Lpro/javacard/gp/GPKeySet$GPKey;[B[B)[B
     428: putfield      #4                  // Field icv:[B
     431: aload_0
     432: getfield      #12                 // Field postAPDU:Z
     435: ifeq          452
     438: iload_3
     439: i2b
     440: iconst_4
     441: invokestatic  #47                 // Method setBits:(BB)B
     444: istore_3
     445: iload         9
     447: bipush        8
     449: iadd
     450: istore        9
     452: aload         12
     454: invokevirtual #18                 // Method java/io/ByteArrayOutputStream.reset:()V
     457: aload         7
     459: astore        10
     461: aload_0
     462: getfield      #29                 // Field enc:Z
     465: ifeq          602
     468: iload         8
     470: ifle          602
     473: aload_0
     474: getfield      #6                  // Field scp:I
     477: iconst_1
     478: if_icmpne     533
     481: aload         12
     483: iload         8
     485: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     488: aload         12
     490: aload         7
     492: invokevirtual #27                 // Method java/io/ByteArrayOutputStream.write:([B)V
     495: aload         12
     497: invokevirtual #51                 // Method java/io/ByteArrayOutputStream.size:()I
     500: bipush        8
     502: irem
     503: ifeq          545
     506: aload         12
     508: invokevirtual #48                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     511: bipush        8
     513: invokestatic  #52                 // Method pro/javacard/gp/GPCrypto.pad80:([BI)[B
     516: astore        13
     518: aload         12
     520: invokevirtual #18                 // Method java/io/ByteArrayOutputStream.reset:()V
     523: aload         12
     525: aload         13
     527: invokevirtual #27                 // Method java/io/ByteArrayOutputStream.write:([B)V
     530: goto          545
     533: aload         12
     535: aload         7
     537: bipush        8
     539: invokestatic  #52                 // Method pro/javacard/gp/GPCrypto.pad80:([BI)[B
     542: invokevirtual #27                 // Method java/io/ByteArrayOutputStream.write:([B)V
     545: iload         9
     547: aload         12
     549: invokevirtual #51                 // Method java/io/ByteArrayOutputStream.size:()I
     552: aload         7
     554: arraylength
     555: isub
     556: iadd
     557: istore        9
     559: ldc           #53                 // String DESede/CBC/NoPadding
     561: invokestatic  #37                 // Method javax/crypto/Cipher.getInstance:(Ljava/lang/String;)Ljavax/crypto/Cipher;
     564: astore        13
     566: aload         13
     568: iconst_1
     569: aload_0
     570: getfield      #14                 // Field sessionKeys:Lpro/javacard/gp/GPKeySet;
     573: getstatic     #54                 // Field pro/javacard/gp/GPData$KeyType.ENC:Lpro/javacard/gp/GPData$KeyType;
     576: invokevirtual #40                 // Method pro/javacard/gp/GPKeySet.getKeyFor:(Lpro/javacard/gp/GPData$KeyType;)Ljava/security/Key;
     579: getstatic     #55                 // Field pro/javacard/gp/GPCrypto.iv_null_des:Ljavax/crypto/spec/IvParameterSpec;
     582: invokevirtual #56                 // Method javax/crypto/Cipher.init:(ILjava/security/Key;Ljava/security/spec/AlgorithmParameterSpec;)V
     585: aload         13
     587: aload         12
     589: invokevirtual #48                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     592: invokevirtual #46                 // Method javax/crypto/Cipher.doFinal:([B)[B
     595: astore        10
     597: aload         12
     599: invokevirtual #18                 // Method java/io/ByteArrayOutputStream.reset:()V
     602: aload         12
     604: iload_3
     605: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     608: aload         12
     610: iload         4
     612: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     615: aload         12
     617: iload         5
     619: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     622: aload         12
     624: iload         6
     626: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     629: iload         9
     631: ifle          648
     634: aload         12
     636: iload         9
     638: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     641: aload         12
     643: aload         10
     645: invokevirtual #27                 // Method java/io/ByteArrayOutputStream.write:([B)V
     648: aload_0
     649: getfield      #28                 // Field mac:Z
     652: ifeq          664
     655: aload         12
     657: aload_0
     658: getfield      #4                  // Field icv:[B
     661: invokevirtual #27                 // Method java/io/ByteArrayOutputStream.write:([B)V
     664: iload         11
     666: ifle          676
     669: aload         12
     671: iload         11
     673: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     676: new           #57                 // class javax/smartcardio/CommandAPDU
     679: dup
     680: aload         12
     682: invokevirtual #48                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     685: invokespecial #58                 // Method javax/smartcardio/CommandAPDU."<init>":([B)V
     688: astore        13
     690: aload         13
     692: areturn
     693: astore_2
     694: new           #60                 // class java/lang/RuntimeException
     697: dup
     698: ldc           #61                 // String APDU wrapping failed
     700: aload_2
     701: invokespecial #62                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     704: athrow
     705: astore_2
     706: new           #65                 // class java/lang/IllegalStateException
     709: dup
     710: ldc           #61                 // String APDU wrapping failed
     712: aload_2
     713: invokespecial #66                 // Method java/lang/IllegalStateException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     716: athrow
     717: astore_2
     718: new           #71                 // class pro/javacard/gp/GPException
     721: dup
     722: ldc           #61                 // String APDU wrapping failed
     724: aload_2
     725: invokespecial #72                 // Method pro/javacard/gp/GPException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     728: athrow
    Exception table:
       from    to  target type
           0   108   693   Class java/io/IOException
         109   692   693   Class java/io/IOException
           0   108   705   Class java/security/NoSuchAlgorithmException
           0   108   705   Class javax/crypto/NoSuchPaddingException
         109   692   705   Class java/security/NoSuchAlgorithmException
         109   692   705   Class javax/crypto/NoSuchPaddingException
           0   108   717   Class java/security/InvalidKeyException
           0   108   717   Class java/security/InvalidAlgorithmParameterException
           0   108   717   Class javax/crypto/IllegalBlockSizeException
           0   108   717   Class javax/crypto/BadPaddingException
         109   692   717   Class java/security/InvalidKeyException
         109   692   717   Class java/security/InvalidAlgorithmParameterException
         109   692   717   Class javax/crypto/IllegalBlockSizeException
         109   692   717   Class javax/crypto/BadPaddingException

  public javax.smartcardio.ResponseAPDU unwrap(javax.smartcardio.ResponseAPDU) throws pro.javacard.gp.GPException;
    Code:
       0: aload_0
       1: getfield      #17                 // Field rmac:Z
       4: ifeq          201
       7: aload_1
       8: invokevirtual #73                 // Method javax/smartcardio/ResponseAPDU.getData:()[B
      11: arraylength
      12: bipush        8
      14: if_icmpge     27
      17: new           #60                 // class java/lang/RuntimeException
      20: dup
      21: ldc           #74                 // String Wrong response length (too short).
      23: invokespecial #75                 // Method java/lang/RuntimeException."<init>":(Ljava/lang/String;)V
      26: athrow
      27: aload_1
      28: invokevirtual #73                 // Method javax/smartcardio/ResponseAPDU.getData:()[B
      31: arraylength
      32: bipush        8
      34: isub
      35: istore_2
      36: aload_0
      37: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      40: iload_2
      41: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
      44: aload_0
      45: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      48: aload_1
      49: invokevirtual #73                 // Method javax/smartcardio/ResponseAPDU.getData:()[B
      52: iconst_0
      53: iload_2
      54: invokevirtual #76                 // Method java/io/ByteArrayOutputStream.write:([BII)V
      57: aload_0
      58: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      61: aload_1
      62: invokevirtual #77                 // Method javax/smartcardio/ResponseAPDU.getSW1:()I
      65: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
      68: aload_0
      69: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      72: aload_1
      73: invokevirtual #78                 // Method javax/smartcardio/ResponseAPDU.getSW2:()I
      76: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
      79: aload_0
      80: aload_0
      81: getfield      #14                 // Field sessionKeys:Lpro/javacard/gp/GPKeySet;
      84: getstatic     #79                 // Field pro/javacard/gp/GPData$KeyType.RMAC:Lpro/javacard/gp/GPData$KeyType;
      87: invokevirtual #43                 // Method pro/javacard/gp/GPKeySet.getKey:(Lpro/javacard/gp/GPData$KeyType;)Lpro/javacard/gp/GPKeySet$GPKey;
      90: aload_0
      91: getfield      #9                  // Field rMac:Ljava/io/ByteArrayOutputStream;
      94: invokevirtual #48                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
      97: bipush        8
      99: invokestatic  #52                 // Method pro/javacard/gp/GPCrypto.pad80:([BI)[B
     102: aload_0
     103: getfield      #5                  // Field ricv:[B
     106: invokestatic  #50                 // Method pro/javacard/gp/GPCrypto.mac_des_3des:(Lpro/javacard/gp/GPKeySet$GPKey;[B[B)[B
     109: putfield      #5                  // Field ricv:[B
     112: bipush        8
     114: newarray       byte
     116: astore_3
     117: aload_1
     118: invokevirtual #73                 // Method javax/smartcardio/ResponseAPDU.getData:()[B
     121: iload_2
     122: aload_3
     123: iconst_0
     124: bipush        8
     126: invokestatic  #80                 // Method java/lang/System.arraycopy:(Ljava/lang/Object;ILjava/lang/Object;II)V
     129: aload_0
     130: getfield      #5                  // Field ricv:[B
     133: aload_3
     134: invokestatic  #81                 // Method java/util/Arrays.equals:([B[B)Z
     137: ifne          150
     140: new           #71                 // class pro/javacard/gp/GPException
     143: dup
     144: ldc           #82                 // String RMAC invalid.
     146: invokespecial #83                 // Method pro/javacard/gp/GPException."<init>":(Ljava/lang/String;)V
     149: athrow
     150: new           #7                  // class java/io/ByteArrayOutputStream
     153: dup
     154: invokespecial #8                  // Method java/io/ByteArrayOutputStream."<init>":()V
     157: astore        4
     159: aload         4
     161: aload_1
     162: invokevirtual #84                 // Method javax/smartcardio/ResponseAPDU.getBytes:()[B
     165: iconst_0
     166: iload_2
     167: invokevirtual #76                 // Method java/io/ByteArrayOutputStream.write:([BII)V
     170: aload         4
     172: aload_1
     173: invokevirtual #77                 // Method javax/smartcardio/ResponseAPDU.getSW1:()I
     176: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     179: aload         4
     181: aload_1
     182: invokevirtual #78                 // Method javax/smartcardio/ResponseAPDU.getSW2:()I
     185: invokevirtual #21                 // Method java/io/ByteArrayOutputStream.write:(I)V
     188: new           #85                 // class javax/smartcardio/ResponseAPDU
     191: dup
     192: aload         4
     194: invokevirtual #48                 // Method java/io/ByteArrayOutputStream.toByteArray:()[B
     197: invokespecial #86                 // Method javax/smartcardio/ResponseAPDU."<init>":([B)V
     200: astore_1
     201: aload_1
     202: areturn

  pro.javacard.gp.GlobalPlatform$SCP0102Wrapper(pro.javacard.gp.GPKeySet, int, java.util.EnumSet, byte[], byte[], int, pro.javacard.gp.GlobalPlatform$1);
    Code:
       0: aload_0
       1: aload_1
       2: iload_2
       3: aload_3
       4: aload         4
       6: aload         5
       8: iload         6
      10: invokespecial #2                  // Method "<init>":(Lpro/javacard/gp/GPKeySet;ILjava/util/EnumSet;[B[BI)V
      13: return
}
