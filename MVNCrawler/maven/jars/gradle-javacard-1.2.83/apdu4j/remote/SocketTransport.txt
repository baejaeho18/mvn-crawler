Compiled from "SocketTransport.java"
public class apdu4j.remote.SocketTransport implements apdu4j.remote.JSONMessagePipe {
  private static org.slf4j.Logger logger;

  private final java.net.Socket socket;

  private final java.nio.ByteBuffer length;

  public apdu4j.remote.SocketTransport(java.net.Socket);
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0
       5: iconst_4
       6: invokestatic  #4                  // Method java/nio/ByteBuffer.allocate:(I)Ljava/nio/ByteBuffer;
       9: putfield      #5                  // Field length:Ljava/nio/ByteBuffer;
      12: aload_0
      13: aload_1
      14: putfield      #6                  // Field socket:Ljava/net/Socket;
      17: aload_0
      18: getfield      #5                  // Field length:Ljava/nio/ByteBuffer;
      21: getstatic     #7                  // Field java/nio/ByteOrder.BIG_ENDIAN:Ljava/nio/ByteOrder;
      24: invokevirtual #8                  // Method java/nio/ByteBuffer.order:(Ljava/nio/ByteOrder;)Ljava/nio/ByteBuffer;
      27: pop
      28: return

  public static apdu4j.remote.SocketTransport connect_insecure(java.net.InetSocketAddress) throws java.io.IOException;
    Code:
       0: aload_0
       1: aconst_null
       2: invokestatic  #9                  // Method connect:(Ljava/net/InetSocketAddress;Ljava/security/cert/X509Certificate;)Lapdu4j/remote/SocketTransport;
       5: areturn

  public static javax.net.ssl.KeyManagerFactory get_key_manager_factory(java.lang.String, java.lang.String) throws java.io.IOException;
    Code:
       0: new           #10                 // class java/io/FileInputStream
       3: dup
       4: aload_0
       5: invokespecial #11                 // Method java/io/FileInputStream."<init>":(Ljava/lang/String;)V
       8: astore_2
       9: aconst_null
      10: astore_3
      11: ldc           #12                 // String PKCS12
      13: invokestatic  #13                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;)Ljava/security/KeyStore;
      16: astore        4
      18: aload         4
      20: aload_2
      21: aload_1
      22: invokevirtual #14                 // Method java/lang/String.toCharArray:()[C
      25: invokevirtual #15                 // Method java/security/KeyStore.load:(Ljava/io/InputStream;[C)V
      28: invokestatic  #16                 // Method javax/net/ssl/KeyManagerFactory.getDefaultAlgorithm:()Ljava/lang/String;
      31: invokestatic  #17                 // Method javax/net/ssl/KeyManagerFactory.getInstance:(Ljava/lang/String;)Ljavax/net/ssl/KeyManagerFactory;
      34: astore        5
      36: aload         5
      38: aload         4
      40: aload_1
      41: invokevirtual #14                 // Method java/lang/String.toCharArray:()[C
      44: invokevirtual #18                 // Method javax/net/ssl/KeyManagerFactory.init:(Ljava/security/KeyStore;[C)V
      47: aload         5
      49: astore        6
      51: aload_2
      52: ifnull        81
      55: aload_3
      56: ifnull        77
      59: aload_2
      60: invokevirtual #19                 // Method java/io/FileInputStream.close:()V
      63: goto          81
      66: astore        7
      68: aload_3
      69: aload         7
      71: invokevirtual #21                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
      74: goto          81
      77: aload_2
      78: invokevirtual #19                 // Method java/io/FileInputStream.close:()V
      81: aload         6
      83: areturn
      84: astore        4
      86: aload         4
      88: astore_3
      89: aload         4
      91: athrow
      92: astore        8
      94: aload_2
      95: ifnull        124
      98: aload_3
      99: ifnull        120
     102: aload_2
     103: invokevirtual #19                 // Method java/io/FileInputStream.close:()V
     106: goto          124
     109: astore        9
     111: aload_3
     112: aload         9
     114: invokevirtual #21                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
     117: goto          124
     120: aload_2
     121: invokevirtual #19                 // Method java/io/FileInputStream.close:()V
     124: aload         8
     126: athrow
     127: astore_2
     128: new           #26                 // class java/io/IOException
     131: dup
     132: ldc           #27                 // String Could not load client key!
     134: aload_2
     135: invokespecial #28                 // Method java/io/IOException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     138: athrow
    Exception table:
       from    to  target type
          59    63    66   Class java/lang/Throwable
          11    51    84   Class java/lang/Throwable
          11    51    92   any
         102   106   109   Class java/lang/Throwable
          84    94    92   any
           0    81   127   Class java/security/UnrecoverableKeyException
           0    81   127   Class java/security/KeyStoreException
           0    81   127   Class java/security/NoSuchAlgorithmException
           0    81   127   Class java/security/cert/CertificateException
           0    81   127   Class java/io/IOException
          84   127   127   Class java/security/UnrecoverableKeyException
          84   127   127   Class java/security/KeyStoreException
          84   127   127   Class java/security/NoSuchAlgorithmException
          84   127   127   Class java/security/cert/CertificateException
          84   127   127   Class java/io/IOException

  protected static javax.net.ssl.SSLSocketFactory get_ssl_socket_factory(javax.net.ssl.KeyManagerFactory, java.security.cert.X509Certificate) throws java.io.IOException;
    Code:
       0: iconst_1
       1: anewarray     #29                 // class javax/net/ssl/TrustManager
       4: dup
       5: iconst_0
       6: new           #30                 // class apdu4j/remote/SocketTransport$1
       9: dup
      10: invokespecial #31                 // Method apdu4j/remote/SocketTransport$1."<init>":()V
      13: aastore
      14: astore_2
      15: ldc           #32                 // String TLS
      17: invokestatic  #33                 // Method javax/net/ssl/SSLContext.getInstance:(Ljava/lang/String;)Ljavax/net/ssl/SSLContext;
      20: astore_3
      21: aload_0
      22: ifnonnull     29
      25: aconst_null
      26: goto          33
      29: aload_0
      30: invokevirtual #34                 // Method javax/net/ssl/KeyManagerFactory.getKeyManagers:()[Ljavax/net/ssl/KeyManager;
      33: astore        4
      35: aload_1
      36: ifnull        100
      39: ldc           #35                 // String X509
      41: invokestatic  #36                 // Method javax/net/ssl/TrustManagerFactory.getInstance:(Ljava/lang/String;)Ljavax/net/ssl/TrustManagerFactory;
      44: astore        5
      46: aconst_null
      47: astore        6
      49: invokestatic  #37                 // Method java/security/KeyStore.getDefaultType:()Ljava/lang/String;
      52: invokestatic  #13                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;)Ljava/security/KeyStore;
      55: astore        6
      57: aload         6
      59: aconst_null
      60: aconst_null
      61: invokevirtual #15                 // Method java/security/KeyStore.load:(Ljava/io/InputStream;[C)V
      64: aload         6
      66: ldc           #38                 // String pinned
      68: aload_1
      69: invokevirtual #39                 // Method java/security/KeyStore.setCertificateEntry:(Ljava/lang/String;Ljava/security/cert/Certificate;)V
      72: aload         5
      74: aload         6
      76: invokevirtual #40                 // Method javax/net/ssl/TrustManagerFactory.init:(Ljava/security/KeyStore;)V
      79: aload_3
      80: aload         4
      82: aload         5
      84: invokevirtual #41                 // Method javax/net/ssl/TrustManagerFactory.getTrustManagers:()[Ljavax/net/ssl/TrustManager;
      87: new           #42                 // class java/security/SecureRandom
      90: dup
      91: invokespecial #43                 // Method java/security/SecureRandom."<init>":()V
      94: invokevirtual #44                 // Method javax/net/ssl/SSLContext.init:([Ljavax/net/ssl/KeyManager;[Ljavax/net/ssl/TrustManager;Ljava/security/SecureRandom;)V
      97: goto          114
     100: aload_3
     101: aload         4
     103: aload_2
     104: new           #42                 // class java/security/SecureRandom
     107: dup
     108: invokespecial #43                 // Method java/security/SecureRandom."<init>":()V
     111: invokevirtual #44                 // Method javax/net/ssl/SSLContext.init:([Ljavax/net/ssl/KeyManager;[Ljavax/net/ssl/TrustManager;Ljava/security/SecureRandom;)V
     114: aload_3
     115: invokevirtual #45                 // Method javax/net/ssl/SSLContext.getSocketFactory:()Ljavax/net/ssl/SSLSocketFactory;
     118: areturn
     119: astore_2
     120: new           #26                 // class java/io/IOException
     123: dup
     124: ldc           #47                 // String Could not connect
     126: aload_2
     127: invokespecial #28                 // Method java/io/IOException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     130: athrow
    Exception table:
       from    to  target type
           0   118   119   Class java/security/KeyManagementException
           0   118   119   Class java/security/KeyStoreException
           0   118   119   Class java/security/NoSuchAlgorithmException
           0   118   119   Class java/security/cert/CertificateException

  protected static javax.net.ssl.SSLSocketFactory get_ssl_socket_factory(java.security.cert.X509Certificate) throws java.io.IOException;
    Code:
       0: aconst_null
       1: aload_0
       2: invokestatic  #48                 // Method get_ssl_socket_factory:(Ljavax/net/ssl/KeyManagerFactory;Ljava/security/cert/X509Certificate;)Ljavax/net/ssl/SSLSocketFactory;
       5: areturn

  public static apdu4j.remote.SocketTransport connect(java.net.InetSocketAddress, java.security.cert.X509Certificate) throws java.io.IOException;
    Code:
       0: aload_1
       1: invokestatic  #49                 // Method get_ssl_socket_factory:(Ljava/security/cert/X509Certificate;)Ljavax/net/ssl/SSLSocketFactory;
       4: astore_2
       5: aload_2
       6: aload_0
       7: invokevirtual #50                 // Method java/net/InetSocketAddress.getHostString:()Ljava/lang/String;
      10: aload_0
      11: invokevirtual #51                 // Method java/net/InetSocketAddress.getPort:()I
      14: invokevirtual #52                 // Method javax/net/ssl/SSLSocketFactory.createSocket:(Ljava/lang/String;I)Ljava/net/Socket;
      17: astore_3
      18: new           #53                 // class apdu4j/remote/SocketTransport
      21: dup
      22: aload_3
      23: invokespecial #54                 // Method "<init>":(Ljava/net/Socket;)V
      26: areturn

  public static java.net.ServerSocket make_server(int, java.lang.String, java.lang.String) throws java.io.IOException, java.security.KeyStoreException, java.security.NoSuchAlgorithmException, java.security.cert.CertificateException, java.security.UnrecoverableKeyException, java.security.KeyManagementException;
    Code:
       0: new           #10                 // class java/io/FileInputStream
       3: dup
       4: aload_1
       5: invokespecial #11                 // Method java/io/FileInputStream."<init>":(Ljava/lang/String;)V
       8: astore_3
       9: aconst_null
      10: astore        4
      12: iload_0
      13: aload_3
      14: aload_2
      15: invokestatic  #55                 // Method make_server:(ILjava/io/InputStream;Ljava/lang/String;)Ljava/net/ServerSocket;
      18: astore        5
      20: aload_3
      21: ifnull        52
      24: aload         4
      26: ifnull        48
      29: aload_3
      30: invokevirtual #56                 // Method java/io/InputStream.close:()V
      33: goto          52
      36: astore        6
      38: aload         4
      40: aload         6
      42: invokevirtual #21                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
      45: goto          52
      48: aload_3
      49: invokevirtual #56                 // Method java/io/InputStream.close:()V
      52: aload         5
      54: areturn
      55: astore        5
      57: aload         5
      59: astore        4
      61: aload         5
      63: athrow
      64: astore        7
      66: aload_3
      67: ifnull        98
      70: aload         4
      72: ifnull        94
      75: aload_3
      76: invokevirtual #56                 // Method java/io/InputStream.close:()V
      79: goto          98
      82: astore        8
      84: aload         4
      86: aload         8
      88: invokevirtual #21                 // Method java/lang/Throwable.addSuppressed:(Ljava/lang/Throwable;)V
      91: goto          98
      94: aload_3
      95: invokevirtual #56                 // Method java/io/InputStream.close:()V
      98: aload         7
     100: athrow
    Exception table:
       from    to  target type
          29    33    36   Class java/lang/Throwable
          12    20    55   Class java/lang/Throwable
          12    20    64   any
          75    79    82   Class java/lang/Throwable
          55    66    64   any

  private static java.net.ServerSocket make_server(int, java.io.InputStream, java.lang.String) throws java.io.IOException, java.security.KeyStoreException, java.security.NoSuchAlgorithmException, java.security.cert.CertificateException, java.security.UnrecoverableKeyException, java.security.KeyManagementException;
    Code:
       0: ldc           #12                 // String PKCS12
       2: invokestatic  #13                 // Method java/security/KeyStore.getInstance:(Ljava/lang/String;)Ljava/security/KeyStore;
       5: astore_3
       6: aload_3
       7: aload_1
       8: aload_2
       9: invokevirtual #14                 // Method java/lang/String.toCharArray:()[C
      12: invokevirtual #15                 // Method java/security/KeyStore.load:(Ljava/io/InputStream;[C)V
      15: invokestatic  #16                 // Method javax/net/ssl/KeyManagerFactory.getDefaultAlgorithm:()Ljava/lang/String;
      18: invokestatic  #17                 // Method javax/net/ssl/KeyManagerFactory.getInstance:(Ljava/lang/String;)Ljavax/net/ssl/KeyManagerFactory;
      21: astore        4
      23: aload         4
      25: aload_3
      26: aload_2
      27: invokevirtual #14                 // Method java/lang/String.toCharArray:()[C
      30: invokevirtual #18                 // Method javax/net/ssl/KeyManagerFactory.init:(Ljava/security/KeyStore;[C)V
      33: ldc           #32                 // String TLS
      35: invokestatic  #33                 // Method javax/net/ssl/SSLContext.getInstance:(Ljava/lang/String;)Ljavax/net/ssl/SSLContext;
      38: astore        5
      40: aload         5
      42: aload         4
      44: invokevirtual #34                 // Method javax/net/ssl/KeyManagerFactory.getKeyManagers:()[Ljavax/net/ssl/KeyManager;
      47: aconst_null
      48: aconst_null
      49: invokevirtual #44                 // Method javax/net/ssl/SSLContext.init:([Ljavax/net/ssl/KeyManager;[Ljavax/net/ssl/TrustManager;Ljava/security/SecureRandom;)V
      52: aload         5
      54: invokevirtual #57                 // Method javax/net/ssl/SSLContext.getServerSocketFactory:()Ljavax/net/ssl/SSLServerSocketFactory;
      57: iload_0
      58: invokevirtual #58                 // Method javax/net/ssl/SSLServerSocketFactory.createServerSocket:(I)Ljava/net/ServerSocket;
      61: areturn

  public synchronized void send(java.util.Map<java.lang.String, java.lang.Object>) throws java.io.IOException;
    Code:
       0: new           #59                 // class org/json/simple/JSONObject
       3: dup
       4: invokespecial #60                 // Method org/json/simple/JSONObject."<init>":()V
       7: astore_2
       8: aload_2
       9: aload_1
      10: invokevirtual #61                 // Method org/json/simple/JSONObject.putAll:(Ljava/util/Map;)V
      13: aload_2
      14: invokevirtual #62                 // Method org/json/simple/JSONObject.toJSONString:()Ljava/lang/String;
      17: ldc           #63                 // String UTF-8
      19: invokestatic  #64                 // Method java/nio/charset/Charset.forName:(Ljava/lang/String;)Ljava/nio/charset/Charset;
      22: invokevirtual #65                 // Method java/lang/String.getBytes:(Ljava/nio/charset/Charset;)[B
      25: astore_3
      26: aload_0
      27: getfield      #6                  // Field socket:Ljava/net/Socket;
      30: invokevirtual #66                 // Method java/net/Socket.getOutputStream:()Ljava/io/OutputStream;
      33: aload_0
      34: getfield      #5                  // Field length:Ljava/nio/ByteBuffer;
      37: iconst_0
      38: aload_3
      39: arraylength
      40: invokevirtual #67                 // Method java/nio/ByteBuffer.putInt:(II)Ljava/nio/ByteBuffer;
      43: invokevirtual #68                 // Method java/nio/ByteBuffer.array:()[B
      46: invokevirtual #69                 // Method java/io/OutputStream.write:([B)V
      49: aload_0
      50: getfield      #6                  // Field socket:Ljava/net/Socket;
      53: invokevirtual #66                 // Method java/net/Socket.getOutputStream:()Ljava/io/OutputStream;
      56: aload_3
      57: invokevirtual #69                 // Method java/io/OutputStream.write:([B)V
      60: getstatic     #70                 // Field logger:Lorg/slf4j/Logger;
      63: ldc           #71                 // String > ({}) {}
      65: aload_0
      66: getfield      #5                  // Field length:Ljava/nio/ByteBuffer;
      69: invokevirtual #68                 // Method java/nio/ByteBuffer.array:()[B
      72: invokestatic  #72                 // Method apdu4j/HexUtils.bin2hex:([B)Ljava/lang/String;
      75: aload_2
      76: invokevirtual #62                 // Method org/json/simple/JSONObject.toJSONString:()Ljava/lang/String;
      79: invokeinterface #73,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
      84: return

  public synchronized java.util.Map<java.lang.String, java.lang.Object> recv() throws java.io.IOException;
    Code:
       0: aload_0
       1: getfield      #6                  // Field socket:Ljava/net/Socket;
       4: invokevirtual #74                 // Method java/net/Socket.isClosed:()Z
       7: ifeq          20
      10: new           #26                 // class java/io/IOException
      13: dup
      14: ldc           #75                 // String Connection closed
      16: invokespecial #76                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      19: athrow
      20: aload_0
      21: getfield      #5                  // Field length:Ljava/nio/ByteBuffer;
      24: iconst_0
      25: iconst_0
      26: invokevirtual #67                 // Method java/nio/ByteBuffer.putInt:(II)Ljava/nio/ByteBuffer;
      29: pop
      30: aload_0
      31: getfield      #6                  // Field socket:Ljava/net/Socket;
      34: invokevirtual #77                 // Method java/net/Socket.getInputStream:()Ljava/io/InputStream;
      37: aload_0
      38: getfield      #5                  // Field length:Ljava/nio/ByteBuffer;
      41: invokevirtual #68                 // Method java/nio/ByteBuffer.array:()[B
      44: invokevirtual #78                 // Method java/io/InputStream.read:([B)I
      47: aload_0
      48: getfield      #5                  // Field length:Ljava/nio/ByteBuffer;
      51: invokevirtual #79                 // Method java/nio/ByteBuffer.capacity:()I
      54: if_icmpeq     67
      57: new           #26                 // class java/io/IOException
      60: dup
      61: ldc           #80                 // String Failed to read data length
      63: invokespecial #76                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      66: athrow
      67: aload_0
      68: getfield      #5                  // Field length:Ljava/nio/ByteBuffer;
      71: iconst_0
      72: invokevirtual #81                 // Method java/nio/ByteBuffer.getInt:(I)I
      75: istore_1
      76: iload_1
      77: ifne          90
      80: new           #26                 // class java/io/IOException
      83: dup
      84: ldc           #82                 // String Failed to read data (length)
      86: invokespecial #76                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
      89: athrow
      90: iload_1
      91: sipush        1024
      94: if_icmple     107
      97: new           #26                 // class java/io/IOException
     100: dup
     101: ldc           #83                 // String Bad message length > 1024
     103: invokespecial #76                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     106: athrow
     107: iload_1
     108: newarray       byte
     110: astore_2
     111: aload_0
     112: getfield      #6                  // Field socket:Ljava/net/Socket;
     115: invokevirtual #77                 // Method java/net/Socket.getInputStream:()Ljava/io/InputStream;
     118: aload_2
     119: invokevirtual #78                 // Method java/io/InputStream.read:([B)I
     122: istore_3
     123: iload_3
     124: iload_1
     125: if_icmpeq     164
     128: new           #26                 // class java/io/IOException
     131: dup
     132: new           #84                 // class java/lang/StringBuilder
     135: dup
     136: invokespecial #85                 // Method java/lang/StringBuilder."<init>":()V
     139: ldc           #86                 // String Read
     141: invokevirtual #87                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     144: iload_3
     145: invokevirtual #88                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     148: ldc           #89                 // String  instead of
     150: invokevirtual #87                 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
     153: iload_1
     154: invokevirtual #88                 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;
     157: invokevirtual #90                 // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
     160: invokespecial #76                 // Method java/io/IOException."<init>":(Ljava/lang/String;)V
     163: athrow
     164: new           #91                 // class java/lang/String
     167: dup
     168: aload_2
     169: ldc           #63                 // String UTF-8
     171: invokespecial #92                 // Method java/lang/String."<init>":([BLjava/lang/String;)V
     174: invokestatic  #93                 // Method org/json/simple/JSONValue.parseWithException:(Ljava/lang/String;)Ljava/lang/Object;
     177: checkcast     #59                 // class org/json/simple/JSONObject
     180: astore        4
     182: goto          199
     185: astore        5
     187: new           #26                 // class java/io/IOException
     190: dup
     191: ldc           #95                 // String Could not parse JSON
     193: aload         5
     195: invokespecial #28                 // Method java/io/IOException."<init>":(Ljava/lang/String;Ljava/lang/Throwable;)V
     198: athrow
     199: getstatic     #70                 // Field logger:Lorg/slf4j/Logger;
     202: ldc           #96                 // String < ({}) {}
     204: aload_0
     205: getfield      #5                  // Field length:Ljava/nio/ByteBuffer;
     208: invokevirtual #68                 // Method java/nio/ByteBuffer.array:()[B
     211: invokestatic  #72                 // Method apdu4j/HexUtils.bin2hex:([B)Ljava/lang/String;
     214: aload         4
     216: invokevirtual #62                 // Method org/json/simple/JSONObject.toJSONString:()Ljava/lang/String;
     219: invokeinterface #73,  4           // InterfaceMethod org/slf4j/Logger.debug:(Ljava/lang/String;Ljava/lang/Object;Ljava/lang/Object;)V
     224: aload         4
     226: areturn
    Exception table:
       from    to  target type
         164   182   185   Class org/json/simple/parser/ParseException

  public void close();
    Code:
       0: aload_0
       1: getfield      #6                  // Field socket:Ljava/net/Socket;
       4: invokevirtual #97                 // Method java/net/Socket.close:()V
       7: goto          22
      10: astore_1
      11: getstatic     #70                 // Field logger:Lorg/slf4j/Logger;
      14: ldc           #98                 // String Could not close socket
      16: aload_1
      17: invokeinterface #99,  3           // InterfaceMethod org/slf4j/Logger.trace:(Ljava/lang/String;Ljava/lang/Throwable;)V
      22: return
    Exception table:
       from    to  target type
           0     7    10   Class java/io/IOException

  static {};
    Code:
       0: ldc           #53                 // class apdu4j/remote/SocketTransport
       2: invokestatic  #100                // Method org/slf4j/LoggerFactory.getLogger:(Ljava/lang/Class;)Lorg/slf4j/Logger;
       5: putstatic     #70                 // Field logger:Lorg/slf4j/Logger;
       8: return
}
